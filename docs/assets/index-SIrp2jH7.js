var $1=i=>{throw TypeError(i)};var D1=(i,t,e)=>t.has(i)||$1("Cannot "+e);var xe=(i,t,e)=>(D1(i,t,"read from private field"),e?e.call(i):t.get(i)),ro=(i,t,e)=>t.has(i)?$1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),fr=(i,t,e,n)=>(D1(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function T0(i){const t=Object.create(null);for(const e of i.split(","))t[e]=1;return e=>e in t}const se={},wa=[],Os=()=>{},Uv=()=>!1,xd=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),P0=i=>i.startsWith("onUpdate:"),mi=Object.assign,A0=(i,t)=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)},b3=Object.prototype.hasOwnProperty,Ut=(i,t)=>b3.call(i,t),xt=Array.isArray,ka=i=>rh(i)==="[object Map]",ol=i=>rh(i)==="[object Set]",L1=i=>rh(i)==="[object Date]",Pt=i=>typeof i=="function",Le=i=>typeof i=="string",vs=i=>typeof i=="symbol",re=i=>i!==null&&typeof i=="object",Yv=i=>(re(i)||Pt(i))&&Pt(i.then)&&Pt(i.catch),Hv=Object.prototype.toString,rh=i=>Hv.call(i),v3=i=>rh(i).slice(8,-1),Kv=i=>rh(i)==="[object Object]",M0=i=>Le(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,cc=T0(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Sd=i=>{const t=Object.create(null);return(e=>t[e]||(t[e]=i(e)))},_3=/-\w/g,$r=Sd(i=>i.replace(_3,t=>t.slice(1).toUpperCase())),x3=/\B([A-Z])/g,Wo=Sd(i=>i.replace(x3,"-$1").toLowerCase()),Jv=Sd(i=>i.charAt(0).toUpperCase()+i.slice(1)),xp=Sd(i=>i?`on${Jv(i)}`:""),Rr=(i,t)=>!Object.is(i,t),Uu=(i,...t)=>{for(let e=0;e<i.length;e++)i[e](...t)},t_=(i,t,e,n=!1)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:n,value:e})},Of=i=>{const t=parseFloat(i);return isNaN(t)?i:t};let V1;const wd=()=>V1||(V1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function wr(i){if(xt(i)){const t={};for(let e=0;e<i.length;e++){const n=i[e],s=Le(n)?C3(n):wr(n);if(s)for(const r in s)t[r]=s[r]}return t}else if(Le(i)||re(i))return i}const S3=/;(?![^(]*\))/g,w3=/:([^]+)/,k3=/\/\*[^]*?\*\//g;function C3(i){const t={};return i.replace(k3,"").split(S3).forEach(e=>{if(e){const n=e.split(w3);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function Ln(i){let t="";if(Le(i))t=i;else if(xt(i))for(let e=0;e<i.length;e++){const n=Ln(i[e]);n&&(t+=n+" ")}else if(re(i))for(const e in i)i[e]&&(t+=e+" ");return t.trim()}const T3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",P3=T0(T3);function e_(i){return!!i||i===""}function A3(i,t){if(i.length!==t.length)return!1;let e=!0;for(let n=0;e&&n<i.length;n++)e=Io(i[n],t[n]);return e}function Io(i,t){if(i===t)return!0;let e=L1(i),n=L1(t);if(e||n)return e&&n?i.getTime()===t.getTime():!1;if(e=vs(i),n=vs(t),e||n)return i===t;if(e=xt(i),n=xt(t),e||n)return e&&n?A3(i,t):!1;if(e=re(i),n=re(t),e||n){if(!e||!n)return!1;const s=Object.keys(i).length,r=Object.keys(t).length;if(s!==r)return!1;for(const o in i){const a=i.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Io(i[o],t[o]))return!1}}return String(i)===String(t)}function E0(i,t){return i.findIndex(e=>Io(e,t))}const i_=i=>!!(i&&i.__v_isRef===!0),Pe=i=>Le(i)?i:i==null?"":xt(i)||re(i)&&(i.toString===Hv||!Pt(i.toString))?i_(i)?Pe(i.value):JSON.stringify(i,n_,2):String(i),n_=(i,t)=>i_(t)?n_(i,t.value):ka(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[n,s],r)=>(e[Sp(n,r)+" =>"]=s,e),{})}:ol(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>Sp(e))}:vs(t)?Sp(t):re(t)&&!xt(t)&&!Kv(t)?String(t):t,Sp=(i,t="")=>{var e;return vs(i)?`Symbol(${(e=i.description)!=null?e:t})`:i};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Li;class M3{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Li,!t&&Li&&(this.index=(Li.scopes||(Li.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Li;try{return Li=this,t()}finally{Li=e}}}on(){++this._on===1&&(this.prevScope=Li,Li=this)}off(){this._on>0&&--this._on===0&&(Li=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(this.effects.length=0,e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function E3(){return Li}let ce;const wp=new WeakSet;class s_{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Li&&Li.active&&Li.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,wp.has(this)&&(wp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||o_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,B1(this),a_(this);const t=ce,e=Vn;ce=this,Vn=!0;try{return this.fn()}finally{l_(this),ce=t,Vn=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Q0(t);this.deps=this.depsTail=void 0,B1(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?wp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qg(this)&&this.run()}get dirty(){return Qg(this)}}let r_=0,hc,uc;function o_(i,t=!1){if(i.flags|=8,t){i.next=uc,uc=i;return}i.next=hc,hc=i}function R0(){r_++}function I0(){if(--r_>0)return;if(uc){let t=uc;for(uc=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let i;for(;hc;){let t=hc;for(hc=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){i||(i=n)}t=e}}if(i)throw i}function a_(i){for(let t=i.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function l_(i){let t,e=i.depsTail,n=e;for(;n;){const s=n.prevDep;n.version===-1?(n===e&&(e=s),Q0(n),R3(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}i.deps=t,i.depsTail=e}function Qg(i){for(let t=i.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(c_(t.dep.computed)||t.dep.version!==t.version))return!0;return!!i._dirty}function c_(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===Ac)||(i.globalVersion=Ac,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!Qg(i))))return;i.flags|=2;const t=i.dep,e=ce,n=Vn;ce=i,Vn=!0;try{a_(i);const s=i.fn(i._value);(t.version===0||Rr(s,i._value))&&(i.flags|=128,i._value=s,t.version++)}catch(s){throw t.version++,s}finally{ce=e,Vn=n,l_(i),i.flags&=-3}}function Q0(i,t=!1){const{dep:e,prevSub:n,nextSub:s}=i;if(n&&(n.nextSub=s,i.prevSub=void 0),s&&(s.prevSub=n,i.nextSub=void 0),e.subs===i&&(e.subs=n,!n&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)Q0(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function R3(i){const{prevDep:t,nextDep:e}=i;t&&(t.nextDep=e,i.prevDep=void 0),e&&(e.prevDep=t,i.nextDep=void 0)}let Vn=!0;const h_=[];function js(){h_.push(Vn),Vn=!1}function Us(){const i=h_.pop();Vn=i===void 0?!0:i}function B1(i){const{cleanup:t}=i;if(i.cleanup=void 0,t){const e=ce;ce=void 0;try{t()}finally{ce=e}}}let Ac=0;class I3{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class N0{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!ce||!Vn||ce===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==ce)e=this.activeLink=new I3(ce,this),ce.deps?(e.prevDep=ce.depsTail,ce.depsTail.nextDep=e,ce.depsTail=e):ce.deps=ce.depsTail=e,u_(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const n=e.nextDep;n.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=n),e.prevDep=ce.depsTail,e.nextDep=void 0,ce.depsTail.nextDep=e,ce.depsTail=e,ce.deps===e&&(ce.deps=n)}return e}trigger(t){this.version++,Ac++,this.notify(t)}notify(t){R0();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{I0()}}}function u_(i){if(i.dep.sc++,i.sub.flags&4){const t=i.dep.computed;if(t&&!i.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)u_(n)}const e=i.dep.subs;e!==i&&(i.prevSub=e,e&&(e.nextSub=i)),i.dep.subs=i}}const Ng=new WeakMap,ko=Symbol(""),$g=Symbol(""),Mc=Symbol("");function li(i,t,e){if(Vn&&ce){let n=Ng.get(i);n||Ng.set(i,n=new Map);let s=n.get(e);s||(n.set(e,s=new N0),s.map=n,s.key=e),s.track()}}function Zs(i,t,e,n,s,r){const o=Ng.get(i);if(!o){Ac++;return}const a=l=>{l&&l.trigger()};if(R0(),t==="clear")o.forEach(a);else{const l=xt(i),c=l&&M0(e);if(l&&e==="length"){const h=Number(n);o.forEach((u,f)=>{(f==="length"||f===Mc||!vs(f)&&f>=h)&&a(u)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(Mc)),t){case"add":l?c&&a(o.get("length")):(a(o.get(ko)),ka(i)&&a(o.get($g)));break;case"delete":l||(a(o.get(ko)),ka(i)&&a(o.get($g)));break;case"set":ka(i)&&a(o.get(ko));break}}I0()}function ta(i){const t=Gt(i);return t===i?t:(li(t,"iterate",Mc),wn(i)?t:t.map(ei))}function kd(i){return li(i=Gt(i),"iterate",Mc),i}const Q3={__proto__:null,[Symbol.iterator](){return kp(this,Symbol.iterator,ei)},concat(...i){return ta(this).concat(...i.map(t=>xt(t)?ta(t):t))},entries(){return kp(this,"entries",i=>(i[1]=ei(i[1]),i))},every(i,t){return Qs(this,"every",i,t,void 0,arguments)},filter(i,t){return Qs(this,"filter",i,t,e=>e.map(ei),arguments)},find(i,t){return Qs(this,"find",i,t,ei,arguments)},findIndex(i,t){return Qs(this,"findIndex",i,t,void 0,arguments)},findLast(i,t){return Qs(this,"findLast",i,t,ei,arguments)},findLastIndex(i,t){return Qs(this,"findLastIndex",i,t,void 0,arguments)},forEach(i,t){return Qs(this,"forEach",i,t,void 0,arguments)},includes(...i){return Cp(this,"includes",i)},indexOf(...i){return Cp(this,"indexOf",i)},join(i){return ta(this).join(i)},lastIndexOf(...i){return Cp(this,"lastIndexOf",i)},map(i,t){return Qs(this,"map",i,t,void 0,arguments)},pop(){return kl(this,"pop")},push(...i){return kl(this,"push",i)},reduce(i,...t){return Z1(this,"reduce",i,t)},reduceRight(i,...t){return Z1(this,"reduceRight",i,t)},shift(){return kl(this,"shift")},some(i,t){return Qs(this,"some",i,t,void 0,arguments)},splice(...i){return kl(this,"splice",i)},toReversed(){return ta(this).toReversed()},toSorted(i){return ta(this).toSorted(i)},toSpliced(...i){return ta(this).toSpliced(...i)},unshift(...i){return kl(this,"unshift",i)},values(){return kp(this,"values",ei)}};function kp(i,t,e){const n=kd(i),s=n[t]();return n!==i&&!wn(i)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.done||(r.value=e(r.value)),r}),s}const N3=Array.prototype;function Qs(i,t,e,n,s,r){const o=kd(i),a=o!==i&&!wn(i),l=o[t];if(l!==N3[t]){const u=l.apply(i,r);return a?ei(u):u}let c=e;o!==i&&(a?c=function(u,f){return e.call(this,ei(u),f,i)}:e.length>2&&(c=function(u,f){return e.call(this,u,f,i)}));const h=l.call(o,c,n);return a&&s?s(h):h}function Z1(i,t,e,n){const s=kd(i);let r=e;return s!==i&&(wn(i)?e.length>3&&(r=function(o,a,l){return e.call(this,o,a,l,i)}):r=function(o,a,l){return e.call(this,o,ei(a),l,i)}),s[t](r,...n)}function Cp(i,t,e){const n=Gt(i);li(n,"iterate",Mc);const s=n[t](...e);return(s===-1||s===!1)&&L0(e[0])?(e[0]=Gt(e[0]),n[t](...e)):s}function kl(i,t,e=[]){js(),R0();const n=Gt(i)[t].apply(i,e);return I0(),Us(),n}const $3=T0("__proto__,__v_isRef,__isVue"),f_=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(vs));function D3(i){vs(i)||(i=String(i));const t=Gt(this);return li(t,"has",i),t.hasOwnProperty(i)}class d_{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,n){if(e==="__v_skip")return t.__v_skip;const s=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return r;if(e==="__v_raw")return n===(s?r?G3:O_:r?m_:g_).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const o=xt(t);if(!s){let l;if(o&&(l=Q3[e]))return l;if(e==="hasOwnProperty")return D3}const a=Reflect.get(t,e,di(t)?t:n);if((vs(e)?f_.has(e):$3(e))||(s||li(t,"get",e),r))return a;if(di(a)){const l=o&&M0(e)?a:a.value;return s&&re(l)?Lg(l):l}return re(a)?s?Lg(a):Qo(a):a}}class p_ extends d_{constructor(t=!1){super(!1,t)}set(t,e,n,s){let r=t[e];if(!this._isShallow){const l=Dr(r);if(!wn(n)&&!Dr(n)&&(r=Gt(r),n=Gt(n)),!xt(t)&&di(r)&&!di(n))return l||(r.value=n),!0}const o=xt(t)&&M0(e)?Number(e)<t.length:Ut(t,e),a=Reflect.set(t,e,n,di(t)?t:s);return t===Gt(s)&&(o?Rr(n,r)&&Zs(t,"set",e,n):Zs(t,"add",e,n)),a}deleteProperty(t,e){const n=Ut(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&Zs(t,"delete",e,void 0),s}has(t,e){const n=Reflect.has(t,e);return(!vs(e)||!f_.has(e))&&li(t,"has",e),n}ownKeys(t){return li(t,"iterate",xt(t)?"length":ko),Reflect.ownKeys(t)}}class L3 extends d_{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const V3=new p_,B3=new L3,Z3=new p_(!0);const Dg=i=>i,Wh=i=>Reflect.getPrototypeOf(i);function F3(i,t,e){return function(...n){const s=this.__v_raw,r=Gt(s),o=ka(r),a=i==="entries"||i===Symbol.iterator&&o,l=i==="keys"&&o,c=s[i](...n),h=e?Dg:t?yf:ei;return!t&&li(r,"iterate",l?$g:ko),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[h(u[0]),h(u[1])]:h(u),done:f}},[Symbol.iterator](){return this}}}}function qh(i){return function(...t){return i==="delete"?!1:i==="clear"?void 0:this}}function W3(i,t){const e={get(s){const r=this.__v_raw,o=Gt(r),a=Gt(s);i||(Rr(s,a)&&li(o,"get",s),li(o,"get",a));const{has:l}=Wh(o),c=t?Dg:i?yf:ei;if(l.call(o,s))return c(r.get(s));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(s)},get size(){const s=this.__v_raw;return!i&&li(Gt(s),"iterate",ko),s.size},has(s){const r=this.__v_raw,o=Gt(r),a=Gt(s);return i||(Rr(s,a)&&li(o,"has",s),li(o,"has",a)),s===a?r.has(s):r.has(s)||r.has(a)},forEach(s,r){const o=this,a=o.__v_raw,l=Gt(a),c=t?Dg:i?yf:ei;return!i&&li(l,"iterate",ko),a.forEach((h,u)=>s.call(r,c(h),c(u),o))}};return mi(e,i?{add:qh("add"),set:qh("set"),delete:qh("delete"),clear:qh("clear")}:{add(s){!t&&!wn(s)&&!Dr(s)&&(s=Gt(s));const r=Gt(this);return Wh(r).has.call(r,s)||(r.add(s),Zs(r,"add",s,s)),this},set(s,r){!t&&!wn(r)&&!Dr(r)&&(r=Gt(r));const o=Gt(this),{has:a,get:l}=Wh(o);let c=a.call(o,s);c||(s=Gt(s),c=a.call(o,s));const h=l.call(o,s);return o.set(s,r),c?Rr(r,h)&&Zs(o,"set",s,r):Zs(o,"add",s,r),this},delete(s){const r=Gt(this),{has:o,get:a}=Wh(r);let l=o.call(r,s);l||(s=Gt(s),l=o.call(r,s)),a&&a.call(r,s);const c=r.delete(s);return l&&Zs(r,"delete",s,void 0),c},clear(){const s=Gt(this),r=s.size!==0,o=s.clear();return r&&Zs(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=F3(s,i,t)}),e}function $0(i,t){const e=W3(i,t);return(n,s,r)=>s==="__v_isReactive"?!i:s==="__v_isReadonly"?i:s==="__v_raw"?n:Reflect.get(Ut(e,s)&&s in n?e:n,s,r)}const q3={get:$0(!1,!1)},X3={get:$0(!1,!0)},z3={get:$0(!0,!1)};const g_=new WeakMap,m_=new WeakMap,O_=new WeakMap,G3=new WeakMap;function j3(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function U3(i){return i.__v_skip||!Object.isExtensible(i)?0:j3(v3(i))}function Qo(i){return Dr(i)?i:D0(i,!1,V3,q3,g_)}function Y3(i){return D0(i,!1,Z3,X3,m_)}function Lg(i){return D0(i,!0,B3,z3,O_)}function D0(i,t,e,n,s){if(!re(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const r=U3(i);if(r===0)return i;const o=s.get(i);if(o)return o;const a=new Proxy(i,r===2?n:e);return s.set(i,a),a}function Ca(i){return Dr(i)?Ca(i.__v_raw):!!(i&&i.__v_isReactive)}function Dr(i){return!!(i&&i.__v_isReadonly)}function wn(i){return!!(i&&i.__v_isShallow)}function L0(i){return i?!!i.__v_raw:!1}function Gt(i){const t=i&&i.__v_raw;return t?Gt(t):i}function H3(i){return!Ut(i,"__v_skip")&&Object.isExtensible(i)&&t_(i,"__v_skip",!0),i}const ei=i=>re(i)?Qo(i):i,yf=i=>re(i)?Lg(i):i;function di(i){return i?i.__v_isRef===!0:!1}function ue(i){return y_(i,!1)}function Tp(i){return y_(i,!0)}function y_(i,t){return di(i)?i:new K3(i,t)}class K3{constructor(t,e){this.dep=new N0,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Gt(t),this._value=e?t:ei(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,n=this.__v_isShallow||wn(t)||Dr(t);t=n?t:Gt(t),Rr(t,e)&&(this._rawValue=t,this._value=n?t:ei(t),this.dep.trigger())}}function Re(i){return di(i)?i.value:i}const J3={get:(i,t,e)=>t==="__v_raw"?i:Re(Reflect.get(i,t,e)),set:(i,t,e,n)=>{const s=i[t];return di(s)&&!di(e)?(s.value=e,!0):Reflect.set(i,t,e,n)}};function b_(i){return Ca(i)?i:new Proxy(i,J3)}class tT{constructor(t,e,n){this.fn=t,this.setter=e,this._value=void 0,this.dep=new N0(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Ac-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&ce!==this)return o_(this,!0),!0}get value(){const t=this.dep.track();return c_(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function eT(i,t,e=!1){let n,s;return Pt(i)?n=i:(n=i.get,s=i.set),new tT(n,s,e)}const Xh={},bf=new WeakMap;let uo;function iT(i,t=!1,e=uo){if(e){let n=bf.get(e);n||bf.set(e,n=[]),n.push(i)}}function nT(i,t,e=se){const{immediate:n,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=e,c=v=>s?v:wn(v)||s===!1||s===0?Fs(v,1):Fs(v);let h,u,f,d,p=!1,g=!1;if(di(i)?(u=()=>i.value,p=wn(i)):Ca(i)?(u=()=>c(i),p=!0):xt(i)?(g=!0,p=i.some(v=>Ca(v)||wn(v)),u=()=>i.map(v=>{if(di(v))return v.value;if(Ca(v))return c(v);if(Pt(v))return l?l(v,2):v()})):Pt(i)?t?u=l?()=>l(i,2):i:u=()=>{if(f){js();try{f()}finally{Us()}}const v=uo;uo=h;try{return l?l(i,3,[d]):i(d)}finally{uo=v}}:u=Os,t&&s){const v=u,b=s===!0?1/0:s;u=()=>Fs(v(),b)}const m=E3(),O=()=>{h.stop(),m&&m.active&&A0(m.effects,h)};if(r&&t){const v=t;t=(...b)=>{v(...b),O()}}let y=g?new Array(i.length).fill(Xh):Xh;const _=v=>{if(!(!(h.flags&1)||!h.dirty&&!v))if(t){const b=h.run();if(s||p||(g?b.some((k,x)=>Rr(k,y[x])):Rr(b,y))){f&&f();const k=uo;uo=h;try{const x=[b,y===Xh?void 0:g&&y[0]===Xh?[]:y,d];y=b,l?l(t,3,x):t(...x)}finally{uo=k}}}else h.run()};return a&&a(_),h=new s_(u),h.scheduler=o?()=>o(_,!1):_,d=v=>iT(v,!1,h),f=h.onStop=()=>{const v=bf.get(h);if(v){if(l)l(v,4);else for(const b of v)b();bf.delete(h)}},t?n?_(!0):y=h.run():o?o(_.bind(null,!0),!0):h.run(),O.pause=h.pause.bind(h),O.resume=h.resume.bind(h),O.stop=O,O}function Fs(i,t=1/0,e){if(t<=0||!re(i)||i.__v_skip||(e=e||new Map,(e.get(i)||0)>=t))return i;if(e.set(i,t),t--,di(i))Fs(i.value,t,e);else if(xt(i))for(let n=0;n<i.length;n++)Fs(i[n],t,e);else if(ol(i)||ka(i))i.forEach(n=>{Fs(n,t,e)});else if(Kv(i)){for(const n in i)Fs(i[n],t,e);for(const n of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,n)&&Fs(i[n],t,e)}return i}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function oh(i,t,e,n){try{return n?i(...n):i()}catch(s){Cd(s,t,e)}}function _s(i,t,e,n){if(Pt(i)){const s=oh(i,t,e,n);return s&&Yv(s)&&s.catch(r=>{Cd(r,t,e)}),s}if(xt(i)){const s=[];for(let r=0;r<i.length;r++)s.push(_s(i[r],t,e,n));return s}}function Cd(i,t,e,n=!0){const s=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||se;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](i,l,c)===!1)return}a=a.parent}if(r){js(),oh(r,null,10,[i,l,c]),Us();return}}sT(i,e,s,n,o)}function sT(i,t,e,n=!0,s=!1){if(s)throw i;console.error(i)}const wi=[];let rs=-1;const Ta=[];let br=null,ca=0;const v_=Promise.resolve();let vf=null;function Td(i){const t=vf||v_;return i?t.then(this?i.bind(this):i):t}function rT(i){let t=rs+1,e=wi.length;for(;t<e;){const n=t+e>>>1,s=wi[n],r=Ec(s);r<i||r===i&&s.flags&2?t=n+1:e=n}return t}function V0(i){if(!(i.flags&1)){const t=Ec(i),e=wi[wi.length-1];!e||!(i.flags&2)&&t>=Ec(e)?wi.push(i):wi.splice(rT(t),0,i),i.flags|=1,__()}}function __(){vf||(vf=v_.then(S_))}function oT(i){xt(i)?Ta.push(...i):br&&i.id===-1?br.splice(ca+1,0,i):i.flags&1||(Ta.push(i),i.flags|=1),__()}function F1(i,t,e=rs+1){for(;e<wi.length;e++){const n=wi[e];if(n&&n.flags&2){if(i&&n.id!==i.uid)continue;wi.splice(e,1),e--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function x_(i){if(Ta.length){const t=[...new Set(Ta)].sort((e,n)=>Ec(e)-Ec(n));if(Ta.length=0,br){br.push(...t);return}for(br=t,ca=0;ca<br.length;ca++){const e=br[ca];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}br=null,ca=0}}const Ec=i=>i.id==null?i.flags&2?-1:1/0:i.id;function S_(i){try{for(rs=0;rs<wi.length;rs++){const t=wi[rs];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),oh(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;rs<wi.length;rs++){const t=wi[rs];t&&(t.flags&=-2)}rs=-1,wi.length=0,x_(),vf=null,(wi.length||Ta.length)&&S_()}}let vn=null,w_=null;function _f(i){const t=vn;return vn=i,w_=i&&i.type.__scopeId||null,t}function aT(i,t=vn,e){if(!t||i._n)return i;const n=(...s)=>{n._d&&wf(-1);const r=_f(t);let o;try{o=i(...s)}finally{_f(r),n._d&&wf(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Rc(i,t){if(vn===null)return i;const e=Rd(vn),n=i.dirs||(i.dirs=[]);for(let s=0;s<t.length;s++){let[r,o,a,l=se]=t[s];r&&(Pt(r)&&(r={mounted:r,updated:r}),r.deep&&Fs(o),n.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return i}function oo(i,t,e,n){const s=i.dirs,r=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[n];l&&(js(),_s(l,e,8,[i.el,a,i,t]),Us())}}const lT=Symbol("_vte"),cT=i=>i.__isTeleport,hT=Symbol("_leaveCb");function B0(i,t){i.shapeFlag&6&&i.component?(i.transition=t,B0(i.component.subTree,t)):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function al(i,t){return Pt(i)?mi({name:i.name},t,{setup:i}):i}function k_(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const xf=new WeakMap;function fc(i,t,e,n,s=!1){if(xt(i)){i.forEach((p,g)=>fc(p,t&&(xt(t)?t[g]:t),e,n,s));return}if(dc(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&fc(i,t,e,n.component.subTree);return}const r=n.shapeFlag&4?Rd(n.component):n.el,o=s?null:r,{i:a,r:l}=i,c=t&&t.r,h=a.refs===se?a.refs={}:a.refs,u=a.setupState,f=Gt(u),d=u===se?Uv:p=>Ut(f,p);if(c!=null&&c!==l){if(W1(t),Le(c))h[c]=null,d(c)&&(u[c]=null);else if(di(c)){c.value=null;const p=t;p.k&&(h[p.k]=null)}}if(Pt(l))oh(l,a,12,[o,h]);else{const p=Le(l),g=di(l);if(p||g){const m=()=>{if(i.f){const O=p?d(l)?u[l]:h[l]:l.value;if(s)xt(O)&&A0(O,r);else if(xt(O))O.includes(r)||O.push(r);else if(p)h[l]=[r],d(l)&&(u[l]=h[l]);else{const y=[r];l.value=y,i.k&&(h[i.k]=y)}}else p?(h[l]=o,d(l)&&(u[l]=o)):g&&(l.value=o,i.k&&(h[i.k]=o))};if(o){const O=()=>{m(),xf.delete(i)};O.id=-1,xf.set(i,O),sn(O,e)}else W1(i),m()}}}function W1(i){const t=xf.get(i);t&&(t.flags|=8,xf.delete(i))}wd().requestIdleCallback;wd().cancelIdleCallback;const dc=i=>!!i.type.__asyncLoader,C_=i=>i.type.__isKeepAlive;function uT(i,t){T_(i,"a",t)}function fT(i,t){T_(i,"da",t)}function T_(i,t,e=Ti){const n=i.__wdc||(i.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return i()});if(Pd(t,n,e),e){let s=e.parent;for(;s&&s.parent;)C_(s.parent.vnode)&&dT(n,t,e,s),s=s.parent}}function dT(i,t,e,n){const s=Pd(t,i,n,!0);F0(()=>{A0(n[t],s)},e)}function Pd(i,t,e=Ti,n=!1){if(e){const s=e[i]||(e[i]=[]),r=t.__weh||(t.__weh=(...o)=>{js();const a=ah(e),l=_s(t,e,i,o);return a(),Us(),l});return n?s.unshift(r):s.push(r),r}}const ir=i=>(t,e=Ti)=>{(!Qc||i==="sp")&&Pd(i,(...n)=>t(...n),e)},pT=ir("bm"),Ad=ir("m"),gT=ir("bu"),mT=ir("u"),Z0=ir("bum"),F0=ir("um"),OT=ir("sp"),yT=ir("rtg"),bT=ir("rtc");function vT(i,t=Ti){Pd("ec",i,t)}const _T=Symbol.for("v-ndc");function yo(i,t,e,n){let s;const r=e,o=xt(i);if(o||Le(i)){const a=o&&Ca(i);let l=!1,c=!1;a&&(l=!wn(i),c=Dr(i),i=kd(i)),s=new Array(i.length);for(let h=0,u=i.length;h<u;h++)s[h]=t(l?c?yf(ei(i[h])):ei(i[h]):i[h],h,void 0,r)}else if(typeof i=="number"){s=new Array(i);for(let a=0;a<i;a++)s[a]=t(a+1,a,void 0,r)}else if(re(i))if(i[Symbol.iterator])s=Array.from(i,(a,l)=>t(a,l,void 0,r));else{const a=Object.keys(i);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=t(i[h],h,l,r)}}else s=[];return s}const Vg=i=>i?G_(i)?Rd(i):Vg(i.parent):null,pc=mi(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>Vg(i.parent),$root:i=>Vg(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>A_(i),$forceUpdate:i=>i.f||(i.f=()=>{V0(i.update)}),$nextTick:i=>i.n||(i.n=Td.bind(i.proxy)),$watch:i=>WT.bind(i)}),Pp=(i,t)=>i!==se&&!i.__isScriptSetup&&Ut(i,t),xT={get({_:i},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:n,data:s,props:r,accessCache:o,type:a,appContext:l}=i;let c;if(t[0]!=="$"){const d=o[t];if(d!==void 0)switch(d){case 1:return n[t];case 2:return s[t];case 4:return e[t];case 3:return r[t]}else{if(Pp(n,t))return o[t]=1,n[t];if(s!==se&&Ut(s,t))return o[t]=2,s[t];if((c=i.propsOptions[0])&&Ut(c,t))return o[t]=3,r[t];if(e!==se&&Ut(e,t))return o[t]=4,e[t];Bg&&(o[t]=0)}}const h=pc[t];let u,f;if(h)return t==="$attrs"&&li(i.attrs,"get",""),h(i);if((u=a.__cssModules)&&(u=u[t]))return u;if(e!==se&&Ut(e,t))return o[t]=4,e[t];if(f=l.config.globalProperties,Ut(f,t))return f[t]},set({_:i},t,e){const{data:n,setupState:s,ctx:r}=i;return Pp(s,t)?(s[t]=e,!0):n!==se&&Ut(n,t)?(n[t]=e,!0):Ut(i.props,t)||t[0]==="$"&&t.slice(1)in i?!1:(r[t]=e,!0)},has({_:{data:i,setupState:t,accessCache:e,ctx:n,appContext:s,propsOptions:r,type:o}},a){let l,c;return!!(e[a]||i!==se&&a[0]!=="$"&&Ut(i,a)||Pp(t,a)||(l=r[0])&&Ut(l,a)||Ut(n,a)||Ut(pc,a)||Ut(s.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(i,t,e){return e.get!=null?i._.accessCache[t]=0:Ut(e,"value")&&this.set(i,t,e.value,null),Reflect.defineProperty(i,t,e)}};function q1(i){return xt(i)?i.reduce((t,e)=>(t[e]=null,t),{}):i}let Bg=!0;function ST(i){const t=A_(i),e=i.proxy,n=i.ctx;Bg=!1,t.beforeCreate&&X1(t.beforeCreate,i,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:u,mounted:f,beforeUpdate:d,updated:p,activated:g,deactivated:m,beforeDestroy:O,beforeUnmount:y,destroyed:_,unmounted:v,render:b,renderTracked:k,renderTriggered:x,errorCaptured:C,serverPrefetch:I,expose:R,inheritAttrs:$,components:E,directives:Z,filters:F}=t;if(c&&wT(c,n,null),o)for(const U in o){const V=o[U];Pt(V)&&(n[U]=V.bind(e))}if(s){const U=s.call(e,e);re(U)&&(i.data=Qo(U))}if(Bg=!0,r)for(const U in r){const V=r[U],X=Pt(V)?V.bind(e,e):Pt(V.get)?V.get.bind(e,e):Os,j=!Pt(V)&&Pt(V.set)?V.set.bind(e):Os,tt=fs({get:X,set:j});Object.defineProperty(n,U,{enumerable:!0,configurable:!0,get:()=>tt.value,set:it=>tt.value=it})}if(a)for(const U in a)P_(a[U],n,e,U);if(l){const U=Pt(l)?l.call(e):l;Reflect.ownKeys(U).forEach(V=>{MT(V,U[V])})}h&&X1(h,i,"c");function B(U,V){xt(V)?V.forEach(X=>U(X.bind(e))):V&&U(V.bind(e))}if(B(pT,u),B(Ad,f),B(gT,d),B(mT,p),B(uT,g),B(fT,m),B(vT,C),B(bT,k),B(yT,x),B(Z0,y),B(F0,v),B(OT,I),xt(R))if(R.length){const U=i.exposed||(i.exposed={});R.forEach(V=>{Object.defineProperty(U,V,{get:()=>e[V],set:X=>e[V]=X,enumerable:!0})})}else i.exposed||(i.exposed={});b&&i.render===Os&&(i.render=b),$!=null&&(i.inheritAttrs=$),E&&(i.components=E),Z&&(i.directives=Z),I&&k_(i)}function wT(i,t,e=Os){xt(i)&&(i=Zg(i));for(const n in i){const s=i[n];let r;re(s)?"default"in s?r=gc(s.from||n,s.default,!0):r=gc(s.from||n):r=gc(s),di(r)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[n]=r}}function X1(i,t,e){_s(xt(i)?i.map(n=>n.bind(t.proxy)):i.bind(t.proxy),t,e)}function P_(i,t,e,n){let s=n.includes(".")?F_(e,n):()=>e[n];if(Le(i)){const r=t[i];Pt(r)&&ti(s,r)}else if(Pt(i))ti(s,i.bind(e));else if(re(i))if(xt(i))i.forEach(r=>P_(r,t,e,n));else{const r=Pt(i.handler)?i.handler.bind(e):t[i.handler];Pt(r)&&ti(s,r,i)}}function A_(i){const t=i.type,{mixins:e,extends:n}=t,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=i.appContext,a=r.get(t);let l;return a?l=a:!s.length&&!e&&!n?l=t:(l={},s.length&&s.forEach(c=>Sf(l,c,o,!0)),Sf(l,t,o)),re(t)&&r.set(t,l),l}function Sf(i,t,e,n=!1){const{mixins:s,extends:r}=t;r&&Sf(i,r,e,!0),s&&s.forEach(o=>Sf(i,o,e,!0));for(const o in t)if(!(n&&o==="expose")){const a=kT[o]||e&&e[o];i[o]=a?a(i[o],t[o]):t[o]}return i}const kT={data:z1,props:G1,emits:G1,methods:Yl,computed:Yl,beforeCreate:vi,created:vi,beforeMount:vi,mounted:vi,beforeUpdate:vi,updated:vi,beforeDestroy:vi,beforeUnmount:vi,destroyed:vi,unmounted:vi,activated:vi,deactivated:vi,errorCaptured:vi,serverPrefetch:vi,components:Yl,directives:Yl,watch:TT,provide:z1,inject:CT};function z1(i,t){return t?i?function(){return mi(Pt(i)?i.call(this,this):i,Pt(t)?t.call(this,this):t)}:t:i}function CT(i,t){return Yl(Zg(i),Zg(t))}function Zg(i){if(xt(i)){const t={};for(let e=0;e<i.length;e++)t[i[e]]=i[e];return t}return i}function vi(i,t){return i?[...new Set([].concat(i,t))]:t}function Yl(i,t){return i?mi(Object.create(null),i,t):t}function G1(i,t){return i?xt(i)&&xt(t)?[...new Set([...i,...t])]:mi(Object.create(null),q1(i),q1(t??{})):t}function TT(i,t){if(!i)return t;if(!t)return i;const e=mi(Object.create(null),i);for(const n in t)e[n]=vi(i[n],t[n]);return e}function M_(){return{app:null,config:{isNativeTag:Uv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let PT=0;function AT(i,t){return function(n,s=null){Pt(n)||(n=mi({},n)),s!=null&&!re(s)&&(s=null);const r=M_(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:PT++,_component:n,_props:s,_container:null,_context:r,_instance:null,version:pP,get config(){return r.config},set config(h){},use(h,...u){return o.has(h)||(h&&Pt(h.install)?(o.add(h),h.install(c,...u)):Pt(h)&&(o.add(h),h(c,...u))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,u){return u?(r.components[h]=u,c):r.components[h]},directive(h,u){return u?(r.directives[h]=u,c):r.directives[h]},mount(h,u,f){if(!l){const d=c._ceVNode||We(n,s);return d.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),i(d,h,f),l=!0,c._container=h,h.__vue_app__=c,Rd(d.component)}},onUnmount(h){a.push(h)},unmount(){l&&(_s(a,c._instance,16),i(null,c._container),delete c._container.__vue_app__)},provide(h,u){return r.provides[h]=u,c},runWithContext(h){const u=Pa;Pa=c;try{return h()}finally{Pa=u}}};return c}}let Pa=null;function MT(i,t){if(Ti){let e=Ti.provides;const n=Ti.parent&&Ti.parent.provides;n===e&&(e=Ti.provides=Object.create(n)),e[i]=t}}function gc(i,t,e=!1){const n=aP();if(n||Pa){let s=Pa?Pa._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&i in s)return s[i];if(arguments.length>1)return e&&Pt(t)?t.call(n&&n.proxy):t}}const E_={},R_=()=>Object.create(E_),I_=i=>Object.getPrototypeOf(i)===E_;function ET(i,t,e,n=!1){const s={},r=R_();i.propsDefaults=Object.create(null),Q_(i,t,s,r);for(const o in i.propsOptions[0])o in s||(s[o]=void 0);e?i.props=n?s:Y3(s):i.type.props?i.props=s:i.props=r,i.attrs=r}function RT(i,t,e,n){const{props:s,attrs:r,vnode:{patchFlag:o}}=i,a=Gt(s),[l]=i.propsOptions;let c=!1;if((n||o>0)&&!(o&16)){if(o&8){const h=i.vnode.dynamicProps;for(let u=0;u<h.length;u++){let f=h[u];if(Md(i.emitsOptions,f))continue;const d=t[f];if(l)if(Ut(r,f))d!==r[f]&&(r[f]=d,c=!0);else{const p=$r(f);s[p]=Fg(l,a,p,d,i,!1)}else d!==r[f]&&(r[f]=d,c=!0)}}}else{Q_(i,t,s,r)&&(c=!0);let h;for(const u in a)(!t||!Ut(t,u)&&((h=Wo(u))===u||!Ut(t,h)))&&(l?e&&(e[u]!==void 0||e[h]!==void 0)&&(s[u]=Fg(l,a,u,void 0,i,!0)):delete s[u]);if(r!==a)for(const u in r)(!t||!Ut(t,u))&&(delete r[u],c=!0)}c&&Zs(i.attrs,"set","")}function Q_(i,t,e,n){const[s,r]=i.propsOptions;let o=!1,a;if(t)for(let l in t){if(cc(l))continue;const c=t[l];let h;s&&Ut(s,h=$r(l))?!r||!r.includes(h)?e[h]=c:(a||(a={}))[h]=c:Md(i.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,o=!0)}if(r){const l=Gt(e),c=a||se;for(let h=0;h<r.length;h++){const u=r[h];e[u]=Fg(s,l,u,c[u],i,!Ut(c,u))}}return o}function Fg(i,t,e,n,s,r){const o=i[e];if(o!=null){const a=Ut(o,"default");if(a&&n===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Pt(l)){const{propsDefaults:c}=s;if(e in c)n=c[e];else{const h=ah(s);n=c[e]=l.call(null,t),h()}}else n=l;s.ce&&s.ce._setProp(e,n)}o[0]&&(r&&!a?n=!1:o[1]&&(n===""||n===Wo(e))&&(n=!0))}return n}const IT=new WeakMap;function N_(i,t,e=!1){const n=e?IT:t.propsCache,s=n.get(i);if(s)return s;const r=i.props,o={},a=[];let l=!1;if(!Pt(i)){const h=u=>{l=!0;const[f,d]=N_(u,t,!0);mi(o,f),d&&a.push(...d)};!e&&t.mixins.length&&t.mixins.forEach(h),i.extends&&h(i.extends),i.mixins&&i.mixins.forEach(h)}if(!r&&!l)return re(i)&&n.set(i,wa),wa;if(xt(r))for(let h=0;h<r.length;h++){const u=$r(r[h]);j1(u)&&(o[u]=se)}else if(r)for(const h in r){const u=$r(h);if(j1(u)){const f=r[h],d=o[u]=xt(f)||Pt(f)?{type:f}:mi({},f),p=d.type;let g=!1,m=!0;if(xt(p))for(let O=0;O<p.length;++O){const y=p[O],_=Pt(y)&&y.name;if(_==="Boolean"){g=!0;break}else _==="String"&&(m=!1)}else g=Pt(p)&&p.name==="Boolean";d[0]=g,d[1]=m,(g||Ut(d,"default"))&&a.push(u)}}const c=[o,a];return re(i)&&n.set(i,c),c}function j1(i){return i[0]!=="$"&&!cc(i)}const W0=i=>i==="_"||i==="_ctx"||i==="$stable",q0=i=>xt(i)?i.map(ls):[ls(i)],QT=(i,t,e)=>{if(t._n)return t;const n=aT((...s)=>q0(t(...s)),e);return n._c=!1,n},$_=(i,t,e)=>{const n=i._ctx;for(const s in i){if(W0(s))continue;const r=i[s];if(Pt(r))t[s]=QT(s,r,n);else if(r!=null){const o=q0(r);t[s]=()=>o}}},D_=(i,t)=>{const e=q0(t);i.slots.default=()=>e},L_=(i,t,e)=>{for(const n in t)(e||!W0(n))&&(i[n]=t[n])},NT=(i,t,e)=>{const n=i.slots=R_();if(i.vnode.shapeFlag&32){const s=t._;s?(L_(n,t,e),e&&t_(n,"_",s,!0)):$_(t,n)}else t&&D_(i,t)},$T=(i,t,e)=>{const{vnode:n,slots:s}=i;let r=!0,o=se;if(n.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:L_(s,t,e):(r=!t.$stable,$_(t,s)),o=t}else t&&(D_(i,t),o={default:1});if(r)for(const a in s)!W0(a)&&o[a]==null&&delete s[a]},sn=HT;function DT(i){return LT(i)}function LT(i,t){const e=wd();e.__VUE__=!0;const{insert:n,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:u,nextSibling:f,setScopeId:d=Os,insertStaticContent:p}=i,g=(M,Q,G,T=null,S=null,A=null,D=void 0,q=null,K=!!Q.dynamicChildren)=>{if(M===Q)return;M&&!Cl(M,Q)&&(T=Yt(M),it(M,S,A,!0),M=null),Q.patchFlag===-2&&(K=!1,Q.dynamicChildren=null);const{type:J,ref:pt,shapeFlag:rt}=Q;switch(J){case Ed:m(M,Q,G,T);break;case Lr:O(M,Q,G,T);break;case Yu:M==null&&y(Q,G,T,D);break;case ci:E(M,Q,G,T,S,A,D,q,K);break;default:rt&1?b(M,Q,G,T,S,A,D,q,K):rt&6?Z(M,Q,G,T,S,A,D,q,K):(rt&64||rt&128)&&J.process(M,Q,G,T,S,A,D,q,K,bt)}pt!=null&&S?fc(pt,M&&M.ref,A,Q||M,!Q):pt==null&&M&&M.ref!=null&&fc(M.ref,null,A,M,!0)},m=(M,Q,G,T)=>{if(M==null)n(Q.el=a(Q.children),G,T);else{const S=Q.el=M.el;Q.children!==M.children&&c(S,Q.children)}},O=(M,Q,G,T)=>{M==null?n(Q.el=l(Q.children||""),G,T):Q.el=M.el},y=(M,Q,G,T)=>{[M.el,M.anchor]=p(M.children,Q,G,T,M.el,M.anchor)},_=({el:M,anchor:Q},G,T)=>{let S;for(;M&&M!==Q;)S=f(M),n(M,G,T),M=S;n(Q,G,T)},v=({el:M,anchor:Q})=>{let G;for(;M&&M!==Q;)G=f(M),s(M),M=G;s(Q)},b=(M,Q,G,T,S,A,D,q,K)=>{Q.type==="svg"?D="svg":Q.type==="math"&&(D="mathml"),M==null?k(Q,G,T,S,A,D,q,K):I(M,Q,S,A,D,q,K)},k=(M,Q,G,T,S,A,D,q)=>{let K,J;const{props:pt,shapeFlag:rt,transition:yt,dirs:St}=M;if(K=M.el=o(M.type,A,pt&&pt.is,pt),rt&8?h(K,M.children):rt&16&&C(M.children,K,null,T,S,Ap(M,A),D,q),St&&oo(M,null,T,"created"),x(K,M,M.scopeId,D,T),pt){for(const ae in pt)ae!=="value"&&!cc(ae)&&r(K,ae,null,pt[ae],A,T);"value"in pt&&r(K,"value",null,pt.value,A),(J=pt.onVnodeBeforeMount)&&Jn(J,T,M)}St&&oo(M,null,T,"beforeMount");const Lt=VT(S,yt);Lt&&yt.beforeEnter(K),n(K,Q,G),((J=pt&&pt.onVnodeMounted)||Lt||St)&&sn(()=>{J&&Jn(J,T,M),Lt&&yt.enter(K),St&&oo(M,null,T,"mounted")},S)},x=(M,Q,G,T,S)=>{if(G&&d(M,G),T)for(let A=0;A<T.length;A++)d(M,T[A]);if(S){let A=S.subTree;if(Q===A||q_(A.type)&&(A.ssContent===Q||A.ssFallback===Q)){const D=S.vnode;x(M,D,D.scopeId,D.slotScopeIds,S.parent)}}},C=(M,Q,G,T,S,A,D,q,K=0)=>{for(let J=K;J<M.length;J++){const pt=M[J]=q?vr(M[J]):ls(M[J]);g(null,pt,Q,G,T,S,A,D,q)}},I=(M,Q,G,T,S,A,D)=>{const q=Q.el=M.el;let{patchFlag:K,dynamicChildren:J,dirs:pt}=Q;K|=M.patchFlag&16;const rt=M.props||se,yt=Q.props||se;let St;if(G&&ao(G,!1),(St=yt.onVnodeBeforeUpdate)&&Jn(St,G,Q,M),pt&&oo(Q,M,G,"beforeUpdate"),G&&ao(G,!0),(rt.innerHTML&&yt.innerHTML==null||rt.textContent&&yt.textContent==null)&&h(q,""),J?R(M.dynamicChildren,J,q,G,T,Ap(Q,S),A):D||V(M,Q,q,null,G,T,Ap(Q,S),A,!1),K>0){if(K&16)$(q,rt,yt,G,S);else if(K&2&&rt.class!==yt.class&&r(q,"class",null,yt.class,S),K&4&&r(q,"style",rt.style,yt.style,S),K&8){const Lt=Q.dynamicProps;for(let ae=0;ae<Lt.length;ae++){const Ht=Lt[ae],Ii=rt[Ht],Qi=yt[Ht];(Qi!==Ii||Ht==="value")&&r(q,Ht,Ii,Qi,S,G)}}K&1&&M.children!==Q.children&&h(q,Q.children)}else!D&&J==null&&$(q,rt,yt,G,S);((St=yt.onVnodeUpdated)||pt)&&sn(()=>{St&&Jn(St,G,Q,M),pt&&oo(Q,M,G,"updated")},T)},R=(M,Q,G,T,S,A,D)=>{for(let q=0;q<Q.length;q++){const K=M[q],J=Q[q],pt=K.el&&(K.type===ci||!Cl(K,J)||K.shapeFlag&198)?u(K.el):G;g(K,J,pt,null,T,S,A,D,!0)}},$=(M,Q,G,T,S)=>{if(Q!==G){if(Q!==se)for(const A in Q)!cc(A)&&!(A in G)&&r(M,A,Q[A],null,S,T);for(const A in G){if(cc(A))continue;const D=G[A],q=Q[A];D!==q&&A!=="value"&&r(M,A,q,D,S,T)}"value"in G&&r(M,"value",Q.value,G.value,S)}},E=(M,Q,G,T,S,A,D,q,K)=>{const J=Q.el=M?M.el:a(""),pt=Q.anchor=M?M.anchor:a("");let{patchFlag:rt,dynamicChildren:yt,slotScopeIds:St}=Q;St&&(q=q?q.concat(St):St),M==null?(n(J,G,T),n(pt,G,T),C(Q.children||[],G,pt,S,A,D,q,K)):rt>0&&rt&64&&yt&&M.dynamicChildren?(R(M.dynamicChildren,yt,G,S,A,D,q),(Q.key!=null||S&&Q===S.subTree)&&V_(M,Q,!0)):V(M,Q,G,pt,S,A,D,q,K)},Z=(M,Q,G,T,S,A,D,q,K)=>{Q.slotScopeIds=q,M==null?Q.shapeFlag&512?S.ctx.activate(Q,G,T,D,K):F(Q,G,T,S,A,D,K):W(M,Q,K)},F=(M,Q,G,T,S,A,D)=>{const q=M.component=oP(M,T,S);if(C_(M)&&(q.ctx.renderer=bt),lP(q,!1,D),q.asyncDep){if(S&&S.registerDep(q,B,D),!M.el){const K=q.subTree=We(Lr);O(null,K,Q,G),M.placeholder=K.el}}else B(q,M,Q,G,S,A,D)},W=(M,Q,G)=>{const T=Q.component=M.component;if(UT(M,Q,G))if(T.asyncDep&&!T.asyncResolved){U(T,Q,G);return}else T.next=Q,T.update();else Q.el=M.el,T.vnode=Q},B=(M,Q,G,T,S,A,D)=>{const q=()=>{if(M.isMounted){let{next:rt,bu:yt,u:St,parent:Lt,vnode:ae}=M;{const Hn=B_(M);if(Hn){rt&&(rt.el=ae.el,U(M,rt,D)),Hn.asyncDep.then(()=>{M.isUnmounted||q()});return}}let Ht=rt,Ii;ao(M,!1),rt?(rt.el=ae.el,U(M,rt,D)):rt=ae,yt&&Uu(yt),(Ii=rt.props&&rt.props.onVnodeBeforeUpdate)&&Jn(Ii,Lt,rt,ae),ao(M,!0);const Qi=Y1(M),Yn=M.subTree;M.subTree=Qi,g(Yn,Qi,u(Yn.el),Yt(Yn),M,S,A),rt.el=Qi.el,Ht===null&&YT(M,Qi.el),St&&sn(St,S),(Ii=rt.props&&rt.props.onVnodeUpdated)&&sn(()=>Jn(Ii,Lt,rt,ae),S)}else{let rt;const{el:yt,props:St}=Q,{bm:Lt,m:ae,parent:Ht,root:Ii,type:Qi}=M,Yn=dc(Q);ao(M,!1),Lt&&Uu(Lt),!Yn&&(rt=St&&St.onVnodeBeforeMount)&&Jn(rt,Ht,Q),ao(M,!0);{Ii.ce&&Ii.ce._def.shadowRoot!==!1&&Ii.ce._injectChildStyle(Qi);const Hn=M.subTree=Y1(M);g(null,Hn,G,T,M,S,A),Q.el=Hn.el}if(ae&&sn(ae,S),!Yn&&(rt=St&&St.onVnodeMounted)){const Hn=Q;sn(()=>Jn(rt,Ht,Hn),S)}(Q.shapeFlag&256||Ht&&dc(Ht.vnode)&&Ht.vnode.shapeFlag&256)&&M.a&&sn(M.a,S),M.isMounted=!0,Q=G=T=null}};M.scope.on();const K=M.effect=new s_(q);M.scope.off();const J=M.update=K.run.bind(K),pt=M.job=K.runIfDirty.bind(K);pt.i=M,pt.id=M.uid,K.scheduler=()=>V0(pt),ao(M,!0),J()},U=(M,Q,G)=>{Q.component=M;const T=M.vnode.props;M.vnode=Q,M.next=null,RT(M,Q.props,T,G),$T(M,Q.children,G),js(),F1(M),Us()},V=(M,Q,G,T,S,A,D,q,K=!1)=>{const J=M&&M.children,pt=M?M.shapeFlag:0,rt=Q.children,{patchFlag:yt,shapeFlag:St}=Q;if(yt>0){if(yt&128){j(J,rt,G,T,S,A,D,q,K);return}else if(yt&256){X(J,rt,G,T,S,A,D,q,K);return}}St&8?(pt&16&&Mt(J,S,A),rt!==J&&h(G,rt)):pt&16?St&16?j(J,rt,G,T,S,A,D,q,K):Mt(J,S,A,!0):(pt&8&&h(G,""),St&16&&C(rt,G,T,S,A,D,q,K))},X=(M,Q,G,T,S,A,D,q,K)=>{M=M||wa,Q=Q||wa;const J=M.length,pt=Q.length,rt=Math.min(J,pt);let yt;for(yt=0;yt<rt;yt++){const St=Q[yt]=K?vr(Q[yt]):ls(Q[yt]);g(M[yt],St,G,null,S,A,D,q,K)}J>pt?Mt(M,S,A,!0,!1,rt):C(Q,G,T,S,A,D,q,K,rt)},j=(M,Q,G,T,S,A,D,q,K)=>{let J=0;const pt=Q.length;let rt=M.length-1,yt=pt-1;for(;J<=rt&&J<=yt;){const St=M[J],Lt=Q[J]=K?vr(Q[J]):ls(Q[J]);if(Cl(St,Lt))g(St,Lt,G,null,S,A,D,q,K);else break;J++}for(;J<=rt&&J<=yt;){const St=M[rt],Lt=Q[yt]=K?vr(Q[yt]):ls(Q[yt]);if(Cl(St,Lt))g(St,Lt,G,null,S,A,D,q,K);else break;rt--,yt--}if(J>rt){if(J<=yt){const St=yt+1,Lt=St<pt?Q[St].el:T;for(;J<=yt;)g(null,Q[J]=K?vr(Q[J]):ls(Q[J]),G,Lt,S,A,D,q,K),J++}}else if(J>yt)for(;J<=rt;)it(M[J],S,A,!0),J++;else{const St=J,Lt=J,ae=new Map;for(J=Lt;J<=yt;J++){const Hi=Q[J]=K?vr(Q[J]):ls(Q[J]);Hi.key!=null&&ae.set(Hi.key,J)}let Ht,Ii=0;const Qi=yt-Lt+1;let Yn=!1,Hn=0;const wl=new Array(Qi);for(J=0;J<Qi;J++)wl[J]=0;for(J=St;J<=rt;J++){const Hi=M[J];if(Ii>=Qi){it(Hi,S,A,!0);continue}let Kn;if(Hi.key!=null)Kn=ae.get(Hi.key);else for(Ht=Lt;Ht<=yt;Ht++)if(wl[Ht-Lt]===0&&Cl(Hi,Q[Ht])){Kn=Ht;break}Kn===void 0?it(Hi,S,A,!0):(wl[Kn-Lt]=J+1,Kn>=Hn?Hn=Kn:Yn=!0,g(Hi,Q[Kn],G,null,S,A,D,q,K),Ii++)}const I1=Yn?BT(wl):wa;for(Ht=I1.length-1,J=Qi-1;J>=0;J--){const Hi=Lt+J,Kn=Q[Hi],Q1=Q[Hi+1],N1=Hi+1<pt?Q1.el||Q1.placeholder:T;wl[J]===0?g(null,Kn,G,N1,S,A,D,q,K):Yn&&(Ht<0||J!==I1[Ht]?tt(Kn,G,N1,2):Ht--)}}},tt=(M,Q,G,T,S=null)=>{const{el:A,type:D,transition:q,children:K,shapeFlag:J}=M;if(J&6){tt(M.component.subTree,Q,G,T);return}if(J&128){M.suspense.move(Q,G,T);return}if(J&64){D.move(M,Q,G,bt);return}if(D===ci){n(A,Q,G);for(let rt=0;rt<K.length;rt++)tt(K[rt],Q,G,T);n(M.anchor,Q,G);return}if(D===Yu){_(M,Q,G);return}if(T!==2&&J&1&&q)if(T===0)q.beforeEnter(A),n(A,Q,G),sn(()=>q.enter(A),S);else{const{leave:rt,delayLeave:yt,afterLeave:St}=q,Lt=()=>{M.ctx.isUnmounted?s(A):n(A,Q,G)},ae=()=>{A._isLeaving&&A[hT](!0),rt(A,()=>{Lt(),St&&St()})};yt?yt(A,Lt,ae):ae()}else n(A,Q,G)},it=(M,Q,G,T=!1,S=!1)=>{const{type:A,props:D,ref:q,children:K,dynamicChildren:J,shapeFlag:pt,patchFlag:rt,dirs:yt,cacheIndex:St}=M;if(rt===-2&&(S=!1),q!=null&&(js(),fc(q,null,G,M,!0),Us()),St!=null&&(Q.renderCache[St]=void 0),pt&256){Q.ctx.deactivate(M);return}const Lt=pt&1&&yt,ae=!dc(M);let Ht;if(ae&&(Ht=D&&D.onVnodeBeforeUnmount)&&Jn(Ht,Q,M),pt&6)Ot(M.component,G,T);else{if(pt&128){M.suspense.unmount(G,T);return}Lt&&oo(M,null,Q,"beforeUnmount"),pt&64?M.type.remove(M,Q,G,bt,T):J&&!J.hasOnce&&(A!==ci||rt>0&&rt&64)?Mt(J,Q,G,!1,!0):(A===ci&&rt&384||!S&&pt&16)&&Mt(K,Q,G),T&&_t(M)}(ae&&(Ht=D&&D.onVnodeUnmounted)||Lt)&&sn(()=>{Ht&&Jn(Ht,Q,M),Lt&&oo(M,null,Q,"unmounted")},G)},_t=M=>{const{type:Q,el:G,anchor:T,transition:S}=M;if(Q===ci){Nt(G,T);return}if(Q===Yu){v(M);return}const A=()=>{s(G),S&&!S.persisted&&S.afterLeave&&S.afterLeave()};if(M.shapeFlag&1&&S&&!S.persisted){const{leave:D,delayLeave:q}=S,K=()=>D(G,A);q?q(M.el,A,K):K()}else A()},Nt=(M,Q)=>{let G;for(;M!==Q;)G=f(M),s(M),M=G;s(Q)},Ot=(M,Q,G)=>{const{bum:T,scope:S,job:A,subTree:D,um:q,m:K,a:J}=M;U1(K),U1(J),T&&Uu(T),S.stop(),A&&(A.flags|=8,it(D,M,Q,G)),q&&sn(q,Q),sn(()=>{M.isUnmounted=!0},Q)},Mt=(M,Q,G,T=!1,S=!1,A=0)=>{for(let D=A;D<M.length;D++)it(M[D],Q,G,T,S)},Yt=M=>{if(M.shapeFlag&6)return Yt(M.component.subTree);if(M.shapeFlag&128)return M.suspense.next();const Q=f(M.anchor||M.el),G=Q&&Q[lT];return G?f(G):Q};let dt=!1;const Et=(M,Q,G)=>{M==null?Q._vnode&&it(Q._vnode,null,null,!0):g(Q._vnode||null,M,Q,null,null,null,G),Q._vnode=M,dt||(dt=!0,F1(),x_(),dt=!1)},bt={p:g,um:it,m:tt,r:_t,mt:F,mc:C,pc:V,pbc:R,n:Yt,o:i};return{render:Et,hydrate:void 0,createApp:AT(Et)}}function Ap({type:i,props:t},e){return e==="svg"&&i==="foreignObject"||e==="mathml"&&i==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function ao({effect:i,job:t},e){e?(i.flags|=32,t.flags|=4):(i.flags&=-33,t.flags&=-5)}function VT(i,t){return(!i||i&&!i.pendingBranch)&&t&&!t.persisted}function V_(i,t,e=!1){const n=i.children,s=t.children;if(xt(n)&&xt(s))for(let r=0;r<n.length;r++){const o=n[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=vr(s[r]),a.el=o.el),!e&&a.patchFlag!==-2&&V_(o,a)),a.type===Ed&&a.patchFlag!==-1&&(a.el=o.el),a.type===Lr&&!a.el&&(a.el=o.el)}}function BT(i){const t=i.slice(),e=[0];let n,s,r,o,a;const l=i.length;for(n=0;n<l;n++){const c=i[n];if(c!==0){if(s=e[e.length-1],i[s]<c){t[n]=s,e.push(n);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,i[e[a]]<c?r=a+1:o=a;c<i[e[r]]&&(r>0&&(t[n]=e[r-1]),e[r]=n)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function B_(i){const t=i.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:B_(t)}function U1(i){if(i)for(let t=0;t<i.length;t++)i[t].flags|=8}const ZT=Symbol.for("v-scx"),FT=()=>gc(ZT);function ti(i,t,e){return Z_(i,t,e)}function Z_(i,t,e=se){const{immediate:n,deep:s,flush:r,once:o}=e,a=mi({},e),l=t&&n||!t&&r!=="post";let c;if(Qc){if(r==="sync"){const d=FT();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=Os,d.resume=Os,d.pause=Os,d}}const h=Ti;a.call=(d,p,g)=>_s(d,h,p,g);let u=!1;r==="post"?a.scheduler=d=>{sn(d,h&&h.suspense)}:r!=="sync"&&(u=!0,a.scheduler=(d,p)=>{p?d():V0(d)}),a.augmentJob=d=>{t&&(d.flags|=4),u&&(d.flags|=2,h&&(d.id=h.uid,d.i=h))};const f=nT(i,t,a);return Qc&&(c?c.push(f):l&&f()),f}function WT(i,t,e){const n=this.proxy,s=Le(i)?i.includes(".")?F_(n,i):()=>n[i]:i.bind(n,n);let r;Pt(t)?r=t:(r=t.handler,e=t);const o=ah(this),a=Z_(s,r.bind(n),e);return o(),a}function F_(i,t){const e=t.split(".");return()=>{let n=i;for(let s=0;s<e.length&&n;s++)n=n[e[s]];return n}}const qT=(i,t)=>t==="modelValue"||t==="model-value"?i.modelModifiers:i[`${t}Modifiers`]||i[`${$r(t)}Modifiers`]||i[`${Wo(t)}Modifiers`];function XT(i,t,...e){if(i.isUnmounted)return;const n=i.vnode.props||se;let s=e;const r=t.startsWith("update:"),o=r&&qT(n,t.slice(7));o&&(o.trim&&(s=e.map(h=>Le(h)?h.trim():h)),o.number&&(s=e.map(Of)));let a,l=n[a=xp(t)]||n[a=xp($r(t))];!l&&r&&(l=n[a=xp(Wo(t))]),l&&_s(l,i,6,s);const c=n[a+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,_s(c,i,6,s)}}const zT=new WeakMap;function W_(i,t,e=!1){const n=e?zT:t.emitsCache,s=n.get(i);if(s!==void 0)return s;const r=i.emits;let o={},a=!1;if(!Pt(i)){const l=c=>{const h=W_(c,t,!0);h&&(a=!0,mi(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!r&&!a?(re(i)&&n.set(i,null),null):(xt(r)?r.forEach(l=>o[l]=null):mi(o,r),re(i)&&n.set(i,o),o)}function Md(i,t){return!i||!xd(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ut(i,t[0].toLowerCase()+t.slice(1))||Ut(i,Wo(t))||Ut(i,t))}function Y1(i){const{type:t,vnode:e,proxy:n,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:u,data:f,setupState:d,ctx:p,inheritAttrs:g}=i,m=_f(i);let O,y;try{if(e.shapeFlag&4){const v=s||n,b=v;O=ls(c.call(b,v,h,u,d,f,p)),y=a}else{const v=t;O=ls(v.length>1?v(u,{attrs:a,slots:o,emit:l}):v(u,null)),y=t.props?a:GT(a)}}catch(v){mc.length=0,Cd(v,i,1),O=We(Lr)}let _=O;if(y&&g!==!1){const v=Object.keys(y),{shapeFlag:b}=_;v.length&&b&7&&(r&&v.some(P0)&&(y=jT(y,r)),_=Ba(_,y,!1,!0))}return e.dirs&&(_=Ba(_,null,!1,!0),_.dirs=_.dirs?_.dirs.concat(e.dirs):e.dirs),e.transition&&B0(_,e.transition),O=_,_f(m),O}const GT=i=>{let t;for(const e in i)(e==="class"||e==="style"||xd(e))&&((t||(t={}))[e]=i[e]);return t},jT=(i,t)=>{const e={};for(const n in i)(!P0(n)||!(n.slice(9)in t))&&(e[n]=i[n]);return e};function UT(i,t,e){const{props:n,children:s,component:r}=i,{props:o,children:a,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return n?H1(n,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let u=0;u<h.length;u++){const f=h[u];if(o[f]!==n[f]&&!Md(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?H1(n,o,c):!0:!!o;return!1}function H1(i,t,e){const n=Object.keys(t);if(n.length!==Object.keys(i).length)return!0;for(let s=0;s<n.length;s++){const r=n[s];if(t[r]!==i[r]&&!Md(e,r))return!0}return!1}function YT({vnode:i,parent:t},e){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===i&&(n.el=i.el),n===i)(i=t.vnode).el=e,t=t.parent;else break}}const q_=i=>i.__isSuspense;function HT(i,t){t&&t.pendingBranch?xt(i)?t.effects.push(...i):t.effects.push(i):oT(i)}const ci=Symbol.for("v-fgt"),Ed=Symbol.for("v-txt"),Lr=Symbol.for("v-cmt"),Yu=Symbol.for("v-stc"),mc=[];let ln=null;function It(i=!1){mc.push(ln=i?null:[])}function KT(){mc.pop(),ln=mc[mc.length-1]||null}let Ic=1;function wf(i,t=!1){Ic+=i,i<0&&ln&&t&&(ln.hasOnce=!0)}function X_(i){return i.dynamicChildren=Ic>0?ln||wa:null,KT(),Ic>0&&ln&&ln.push(i),i}function $t(i,t,e,n,s,r){return X_(Y(i,t,e,n,s,r,!0))}function JT(i,t,e,n,s){return X_(We(i,t,e,n,s,!0))}function kf(i){return i?i.__v_isVNode===!0:!1}function Cl(i,t){return i.type===t.type&&i.key===t.key}const z_=({key:i})=>i??null,Hu=({ref:i,ref_key:t,ref_for:e})=>(typeof i=="number"&&(i=""+i),i!=null?Le(i)||di(i)||Pt(i)?{i:vn,r:i,k:t,f:!!e}:i:null);function Y(i,t=null,e=null,n=0,s=null,r=i===ci?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&z_(t),ref:t&&Hu(t),scopeId:w_,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:vn};return a?(X0(l,e),r&128&&i.normalize(l)):e&&(l.shapeFlag|=Le(e)?8:16),Ic>0&&!o&&ln&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&ln.push(l),l}const We=tP;function tP(i,t=null,e=null,n=0,s=null,r=!1){if((!i||i===_T)&&(i=Lr),kf(i)){const a=Ba(i,t,!0);return e&&X0(a,e),Ic>0&&!r&&ln&&(a.shapeFlag&6?ln[ln.indexOf(i)]=a:ln.push(a)),a.patchFlag=-2,a}if(fP(i)&&(i=i.__vccOpts),t){t=eP(t);let{class:a,style:l}=t;a&&!Le(a)&&(t.class=Ln(a)),re(l)&&(L0(l)&&!xt(l)&&(l=mi({},l)),t.style=wr(l))}const o=Le(i)?1:q_(i)?128:cT(i)?64:re(i)?4:Pt(i)?2:0;return Y(i,t,e,n,s,o,r,!0)}function eP(i){return i?L0(i)||I_(i)?mi({},i):i:null}function Ba(i,t,e=!1,n=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=i,c=t?nP(s||{},t):s,h={__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&z_(c),ref:t&&t.ref?e&&r?xt(r)?r.concat(Hu(t)):[r,Hu(t)]:Hu(t):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==ci?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:l,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&Ba(i.ssContent),ssFallback:i.ssFallback&&Ba(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return l&&n&&B0(h,l.clone(h)),h}function Fi(i=" ",t=0){return We(Ed,null,i,t)}function iP(i,t){const e=We(Yu,null,i);return e.staticCount=t,e}function oi(i="",t=!1){return t?(It(),JT(Lr,null,i)):We(Lr,null,i)}function ls(i){return i==null||typeof i=="boolean"?We(Lr):xt(i)?We(ci,null,i.slice()):kf(i)?vr(i):We(Ed,null,String(i))}function vr(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:Ba(i)}function X0(i,t){let e=0;const{shapeFlag:n}=i;if(t==null)t=null;else if(xt(t))e=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),X0(i,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!I_(t)?t._ctx=vn:s===3&&vn&&(vn.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else Pt(t)?(t={default:t,_ctx:vn},e=32):(t=String(t),n&64?(e=16,t=[Fi(t)]):e=8);i.children=t,i.shapeFlag|=e}function nP(...i){const t={};for(let e=0;e<i.length;e++){const n=i[e];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=Ln([t.class,n.class]));else if(s==="style")t.style=wr([t.style,n.style]);else if(xd(s)){const r=t[s],o=n[s];o&&r!==o&&!(xt(r)&&r.includes(o))&&(t[s]=r?[].concat(r,o):o)}else s!==""&&(t[s]=n[s])}return t}function Jn(i,t,e,n=null){_s(i,t,7,[e,n])}const sP=M_();let rP=0;function oP(i,t,e){const n=i.type,s=(t?t.appContext:i.appContext)||sP,r={uid:rP++,vnode:i,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new M3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:N_(n,s),emitsOptions:W_(n,s),emit:null,emitted:null,propsDefaults:se,inheritAttrs:n.inheritAttrs,ctx:se,data:se,props:se,attrs:se,slots:se,refs:se,setupState:se,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=XT.bind(null,r),i.ce&&i.ce(r),r}let Ti=null;const aP=()=>Ti||vn;let Cf,Wg;{const i=wd(),t=(e,n)=>{let s;return(s=i[e])||(s=i[e]=[]),s.push(n),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};Cf=t("__VUE_INSTANCE_SETTERS__",e=>Ti=e),Wg=t("__VUE_SSR_SETTERS__",e=>Qc=e)}const ah=i=>{const t=Ti;return Cf(i),i.scope.on(),()=>{i.scope.off(),Cf(t)}},K1=()=>{Ti&&Ti.scope.off(),Cf(null)};function G_(i){return i.vnode.shapeFlag&4}let Qc=!1;function lP(i,t=!1,e=!1){t&&Wg(t);const{props:n,children:s}=i.vnode,r=G_(i);ET(i,n,r,t),NT(i,s,e||t);const o=r?cP(i,t):void 0;return t&&Wg(!1),o}function cP(i,t){const e=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,xT);const{setup:n}=e;if(n){js();const s=i.setupContext=n.length>1?uP(i):null,r=ah(i),o=oh(n,i,0,[i.props,s]),a=Yv(o);if(Us(),r(),(a||i.sp)&&!dc(i)&&k_(i),a){if(o.then(K1,K1),t)return o.then(l=>{J1(i,l)}).catch(l=>{Cd(l,i,0)});i.asyncDep=o}else J1(i,o)}else j_(i)}function J1(i,t,e){Pt(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:re(t)&&(i.setupState=b_(t)),j_(i)}function j_(i,t,e){const n=i.type;i.render||(i.render=n.render||Os);{const s=ah(i);js();try{ST(i)}finally{Us(),s()}}}const hP={get(i,t){return li(i,"get",""),i[t]}};function uP(i){const t=e=>{i.exposed=e||{}};return{attrs:new Proxy(i.attrs,hP),slots:i.slots,emit:i.emit,expose:t}}function Rd(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(b_(H3(i.exposed)),{get(t,e){if(e in t)return t[e];if(e in pc)return pc[e](i)},has(t,e){return e in t||e in pc}})):i.proxy}function fP(i){return Pt(i)&&"__vccOpts"in i}const fs=(i,t)=>eT(i,t,Qc);function dP(i,t,e){try{wf(-1);const n=arguments.length;return n===2?re(t)&&!xt(t)?kf(t)?We(i,null,[t]):We(i,t):We(i,null,t):(n>3?e=Array.prototype.slice.call(arguments,2):n===3&&kf(e)&&(e=[e]),We(i,t,e))}finally{wf(1)}}const pP="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let qg;const ty=typeof window<"u"&&window.trustedTypes;if(ty)try{qg=ty.createPolicy("vue",{createHTML:i=>i})}catch{}const U_=qg?i=>qg.createHTML(i):i=>i,gP="http://www.w3.org/2000/svg",mP="http://www.w3.org/1998/Math/MathML",Ls=typeof document<"u"?document:null,ey=Ls&&Ls.createElement("template"),OP={insert:(i,t,e)=>{t.insertBefore(i,e||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,e,n)=>{const s=t==="svg"?Ls.createElementNS(gP,i):t==="mathml"?Ls.createElementNS(mP,i):e?Ls.createElement(i,{is:e}):Ls.createElement(i);return i==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:i=>Ls.createTextNode(i),createComment:i=>Ls.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Ls.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},insertStaticContent(i,t,e,n,s,r){const o=e?e.previousSibling:t.lastChild;if(s&&(s===r||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===r||!(s=s.nextSibling)););else{ey.innerHTML=U_(n==="svg"?`<svg>${i}</svg>`:n==="mathml"?`<math>${i}</math>`:i);const a=ey.content;if(n==="svg"||n==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},yP=Symbol("_vtc");function bP(i,t,e){const n=i[yP];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?i.removeAttribute("class"):e?i.setAttribute("class",t):i.className=t}const iy=Symbol("_vod"),vP=Symbol("_vsh"),_P=Symbol(""),xP=/(?:^|;)\s*display\s*:/;function SP(i,t,e){const n=i.style,s=Le(e);let r=!1;if(e&&!s){if(t)if(Le(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&Ku(n,a,"")}else for(const o in t)e[o]==null&&Ku(n,o,"");for(const o in e)o==="display"&&(r=!0),Ku(n,o,e[o])}else if(s){if(t!==e){const o=n[_P];o&&(e+=";"+o),n.cssText=e,r=xP.test(e)}}else t&&i.removeAttribute("style");iy in i&&(i[iy]=r?n.display:"",i[vP]&&(n.display="none"))}const ny=/\s*!important$/;function Ku(i,t,e){if(xt(e))e.forEach(n=>Ku(i,t,n));else if(e==null&&(e=""),t.startsWith("--"))i.setProperty(t,e);else{const n=wP(i,t);ny.test(e)?i.setProperty(Wo(n),e.replace(ny,""),"important"):i[n]=e}}const sy=["Webkit","Moz","ms"],Mp={};function wP(i,t){const e=Mp[t];if(e)return e;let n=$r(t);if(n!=="filter"&&n in i)return Mp[t]=n;n=Jv(n);for(let s=0;s<sy.length;s++){const r=sy[s]+n;if(r in i)return Mp[t]=r}return t}const ry="http://www.w3.org/1999/xlink";function oy(i,t,e,n,s,r=P3(t)){n&&t.startsWith("xlink:")?e==null?i.removeAttributeNS(ry,t.slice(6,t.length)):i.setAttributeNS(ry,t,e):e==null||r&&!e_(e)?i.removeAttribute(t):i.setAttribute(t,r?"":vs(e)?String(e):e)}function ay(i,t,e,n,s){if(t==="innerHTML"||t==="textContent"){e!=null&&(i[t]=t==="innerHTML"?U_(e):e);return}const r=i.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?i.getAttribute("value")||"":i.value,l=e==null?i.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in i))&&(i.value=l),e==null&&i.removeAttribute(t),i._value=e;return}let o=!1;if(e===""||e==null){const a=typeof i[t];a==="boolean"?e=e_(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{i[t]=e}catch{}o&&i.removeAttribute(s||t)}function Ws(i,t,e,n){i.addEventListener(t,e,n)}function kP(i,t,e,n){i.removeEventListener(t,e,n)}const ly=Symbol("_vei");function CP(i,t,e,n,s=null){const r=i[ly]||(i[ly]={}),o=r[t];if(n&&o)o.value=n;else{const[a,l]=TP(t);if(n){const c=r[t]=MP(n,s);Ws(i,a,c,l)}else o&&(kP(i,a,o,l),r[t]=void 0)}}const cy=/(?:Once|Passive|Capture)$/;function TP(i){let t;if(cy.test(i)){t={};let n;for(;n=i.match(cy);)i=i.slice(0,i.length-n[0].length),t[n[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):Wo(i.slice(2)),t]}let Ep=0;const PP=Promise.resolve(),AP=()=>Ep||(PP.then(()=>Ep=0),Ep=Date.now());function MP(i,t){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;_s(EP(n,e.value),t,5,[n])};return e.value=i,e.attached=AP(),e}function EP(i,t){if(xt(t)){const e=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{e.call(i),i._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const hy=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,RP=(i,t,e,n,s,r)=>{const o=s==="svg";t==="class"?bP(i,n,o):t==="style"?SP(i,e,n):xd(t)?P0(t)||CP(i,t,e,n,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):IP(i,t,n,o))?(ay(i,t,n),!i.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&oy(i,t,n,o,r,t!=="value")):i._isVueCE&&(/[A-Z]/.test(t)||!Le(n))?ay(i,$r(t),n,r,t):(t==="true-value"?i._trueValue=n:t==="false-value"&&(i._falseValue=n),oy(i,t,n,o))};function IP(i,t,e,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in i&&hy(t)&&Pt(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=i.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return hy(t)&&Le(e)?!1:t in i}const Vr=i=>{const t=i.props["onUpdate:modelValue"]||!1;return xt(t)?e=>Uu(t,e):t};function QP(i){i.target.composing=!0}function uy(i){const t=i.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const kn=Symbol("_assign"),Xg={created(i,{modifiers:{lazy:t,trim:e,number:n}},s){i[kn]=Vr(s);const r=n||s.props&&s.props.type==="number";Ws(i,t?"change":"input",o=>{if(o.target.composing)return;let a=i.value;e&&(a=a.trim()),r&&(a=Of(a)),i[kn](a)}),e&&Ws(i,"change",()=>{i.value=i.value.trim()}),t||(Ws(i,"compositionstart",QP),Ws(i,"compositionend",uy),Ws(i,"change",uy))},mounted(i,{value:t}){i.value=t??""},beforeUpdate(i,{value:t,oldValue:e,modifiers:{lazy:n,trim:s,number:r}},o){if(i[kn]=Vr(o),i.composing)return;const a=(r||i.type==="number")&&!/^0\d/.test(i.value)?Of(i.value):i.value,l=t??"";a!==l&&(document.activeElement===i&&i.type!=="range"&&(n&&t===e||s&&i.value.trim()===l)||(i.value=l))}},Y_={deep:!0,created(i,t,e){i[kn]=Vr(e),Ws(i,"change",()=>{const n=i._modelValue,s=Za(i),r=i.checked,o=i[kn];if(xt(n)){const a=E0(n,s),l=a!==-1;if(r&&!l)o(n.concat(s));else if(!r&&l){const c=[...n];c.splice(a,1),o(c)}}else if(ol(n)){const a=new Set(n);r?a.add(s):a.delete(s),o(a)}else o(H_(i,r))})},mounted:fy,beforeUpdate(i,t,e){i[kn]=Vr(e),fy(i,t,e)}};function fy(i,{value:t,oldValue:e},n){i._modelValue=t;let s;if(xt(t))s=E0(t,n.props.value)>-1;else if(ol(t))s=t.has(n.props.value);else{if(t===e)return;s=Io(t,H_(i,!0))}i.checked!==s&&(i.checked=s)}const NP={created(i,{value:t},e){i.checked=Io(t,e.props.value),i[kn]=Vr(e),Ws(i,"change",()=>{i[kn](Za(i))})},beforeUpdate(i,{value:t,oldValue:e},n){i[kn]=Vr(n),t!==e&&(i.checked=Io(t,n.props.value))}},z0={deep:!0,created(i,{value:t,modifiers:{number:e}},n){const s=ol(t);Ws(i,"change",()=>{const r=Array.prototype.filter.call(i.options,o=>o.selected).map(o=>e?Of(Za(o)):Za(o));i[kn](i.multiple?s?new Set(r):r:r[0]),i._assigning=!0,Td(()=>{i._assigning=!1})}),i[kn]=Vr(n)},mounted(i,{value:t}){dy(i,t)},beforeUpdate(i,t,e){i[kn]=Vr(e)},updated(i,{value:t}){i._assigning||dy(i,t)}};function dy(i,t){const e=i.multiple,n=xt(t);if(!(e&&!n&&!ol(t))){for(let s=0,r=i.options.length;s<r;s++){const o=i.options[s],a=Za(o);if(e)if(n){const l=typeof a;l==="string"||l==="number"?o.selected=t.some(c=>String(c)===String(a)):o.selected=E0(t,a)>-1}else o.selected=t.has(a);else if(Io(Za(o),t)){i.selectedIndex!==s&&(i.selectedIndex=s);return}}!e&&i.selectedIndex!==-1&&(i.selectedIndex=-1)}}function Za(i){return"_value"in i?i._value:i.value}function H_(i,t){const e=t?"_trueValue":"_falseValue";return e in i?i[e]:t}const $P={created(i,t,e){zh(i,t,e,null,"created")},mounted(i,t,e){zh(i,t,e,null,"mounted")},beforeUpdate(i,t,e,n){zh(i,t,e,n,"beforeUpdate")},updated(i,t,e,n){zh(i,t,e,n,"updated")}};function DP(i,t){switch(i){case"SELECT":return z0;case"TEXTAREA":return Xg;default:switch(t){case"checkbox":return Y_;case"radio":return NP;default:return Xg}}}function zh(i,t,e,n,s){const o=DP(i.tagName,e.props&&e.props.type)[s];o&&o(i,t,e,n)}const LP=["ctrl","shift","alt","meta"],VP={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,t)=>LP.some(e=>i[`${e}Key`]&&!t.includes(e))},os=(i,t)=>{const e=i._withMods||(i._withMods={}),n=t.join(".");return e[n]||(e[n]=((s,...r)=>{for(let o=0;o<t.length;o++){const a=VP[t[o]];if(a&&a(s,t))return}return i(s,...r)}))},BP=mi({patchProp:RP},OP);let py;function ZP(){return py||(py=DT(BP))}const FP=((...i)=>{const t=ZP().createApp(...i),{mount:e}=t;return t.mount=n=>{const s=qP(n);if(!s)return;const r=t._component;!Pt(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=e(s,!1,WP(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t});function WP(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function qP(i){return Le(i)?document.querySelector(i):i}const K_="15.1.22",gy=(i,t,e)=>({endTime:t,insertTime:e,type:"exponentialRampToValue",value:i}),my=(i,t,e)=>({endTime:t,insertTime:e,type:"linearRampToValue",value:i}),zg=(i,t)=>({startTime:t,type:"setValue",value:i}),J_=(i,t,e)=>({duration:e,startTime:t,type:"setValueCurve",values:i}),tx=(i,t,{startTime:e,target:n,timeConstant:s})=>n+(t-n)*Math.exp((e-i)/s),ma=i=>i.type==="exponentialRampToValue",Tf=i=>i.type==="linearRampToValue",_r=i=>ma(i)||Tf(i),G0=i=>i.type==="setValue",Vs=i=>i.type==="setValueCurve",Pf=(i,t,e,n)=>{const s=i[t];return s===void 0?n:_r(s)||G0(s)?s.value:Vs(s)?s.values[s.values.length-1]:tx(e,Pf(i,t-1,s.startTime,n),s)},Oy=(i,t,e,n,s)=>e===void 0?[n.insertTime,s]:_r(e)?[e.endTime,e.value]:G0(e)?[e.startTime,e.value]:Vs(e)?[e.startTime+e.duration,e.values[e.values.length-1]]:[e.startTime,Pf(i,t-1,e.startTime,s)],Gg=i=>i.type==="cancelAndHold",jg=i=>i.type==="cancelScheduledValues",dr=i=>Gg(i)||jg(i)?i.cancelTime:ma(i)||Tf(i)?i.endTime:i.startTime,yy=(i,t,e,{endTime:n,value:s})=>e===s?s:0<e&&0<s||e<0&&s<0?e*(s/e)**((i-t)/(n-t)):0,by=(i,t,e,{endTime:n,value:s})=>e+(i-t)/(n-t)*(s-e),XP=(i,t)=>{const e=Math.floor(t),n=Math.ceil(t);return e===n?i[e]:(1-(t-e))*i[e]+(1-(n-t))*i[n]},zP=(i,{duration:t,startTime:e,values:n})=>{const s=(i-e)/t*(n.length-1);return XP(n,s)},Gh=i=>i.type==="setTarget";class GP{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const e=dr(t);if(Gg(t)||jg(t)){const n=this._automationEvents.findIndex(r=>jg(t)&&Vs(r)?r.startTime+r.duration>=e:dr(r)>=e),s=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),Gg(t)){const r=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&_r(s)){if(r!==void 0&&Gh(r))throw new Error("The internal list is malformed.");const o=r===void 0?s.insertTime:Vs(r)?r.startTime+r.duration:dr(r),a=r===void 0?this._defaultValue:Vs(r)?r.values[r.values.length-1]:r.value,l=ma(s)?yy(e,o,a,s):by(e,o,a,s),c=ma(s)?gy(l,e,this._currenTime):my(l,e,this._currenTime);this._automationEvents.push(c)}if(r!==void 0&&Gh(r)&&this._automationEvents.push(zg(this.getValue(e),e)),r!==void 0&&Vs(r)&&r.startTime+r.duration>e){const o=e-r.startTime,a=(r.values.length-1)/r.duration,l=Math.max(2,1+Math.ceil(o*a)),c=o/(l-1)*a,h=r.values.slice(0,l);if(c<1)for(let u=1;u<l;u+=1){const f=c*u%1;h[u]=r.values[u-1]*(1-f)+r.values[u]*f}this._automationEvents[this._automationEvents.length-1]=J_(h,r.startTime,o)}}}else{const n=this._automationEvents.findIndex(o=>dr(o)>e),s=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(s!==void 0&&Vs(s)&&dr(s)+s.duration>e)return!1;const r=ma(t)?gy(t.value,t.endTime,this._currenTime):Tf(t)?my(t.value,e,this._currenTime):t;if(n===-1)this._automationEvents.push(r);else{if(Vs(t)&&e+t.duration>dr(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,r)}}return!0}flush(t){const e=this._automationEvents.findIndex(n=>dr(n)>t);if(e>1){const n=this._automationEvents.slice(e-1),s=n[0];Gh(s)&&n.unshift(zg(Pf(this._automationEvents,e-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const e=this._automationEvents.findIndex(o=>dr(o)>t),n=this._automationEvents[e],s=(e===-1?this._automationEvents.length:e)-1,r=this._automationEvents[s];if(r!==void 0&&Gh(r)&&(n===void 0||!_r(n)||n.insertTime>t))return tx(t,Pf(this._automationEvents,s-1,r.startTime,this._defaultValue),r);if(r!==void 0&&G0(r)&&(n===void 0||!_r(n)))return r.value;if(r!==void 0&&Vs(r)&&(n===void 0||!_r(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?zP(t,r):r.values[r.values.length-1];if(r!==void 0&&_r(r)&&(n===void 0||!_r(n)))return r.value;if(n!==void 0&&ma(n)){const[o,a]=Oy(this._automationEvents,s,r,n,this._defaultValue);return yy(t,o,a,n)}if(n!==void 0&&Tf(n)){const[o,a]=Oy(this._automationEvents,s,r,n,this._defaultValue);return by(t,o,a,n)}return this._defaultValue}}const jP=i=>({cancelTime:i,type:"cancelAndHold"}),UP=i=>({cancelTime:i,type:"cancelScheduledValues"}),YP=(i,t)=>({endTime:t,type:"exponentialRampToValue",value:i}),HP=(i,t)=>({endTime:t,type:"linearRampToValue",value:i}),KP=(i,t,e)=>({startTime:t,target:i,timeConstant:e,type:"setTarget"}),JP=()=>new DOMException("","AbortError"),t4=i=>(t,e,[n,s,r],o)=>{i(t[s],[e,n,r],a=>a[0]===e&&a[1]===n,o)},e4=i=>(t,e,n)=>{const s=[];for(let r=0;r<n.numberOfInputs;r+=1)s.push(new Set);i.set(t,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:e})},i4=i=>(t,e)=>{i.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})},Fa=new WeakSet,ex=new WeakMap,j0=new WeakMap,ix=new WeakMap,U0=new WeakMap,Id=new WeakMap,nx=new WeakMap,Ug=new WeakMap,Yg=new WeakMap,Hg=new WeakMap,sx={construct(){return sx}},n4=i=>{try{const t=new Proxy(i,sx);new t}catch{return!1}return!0},vy=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,_y=(i,t)=>{const e=[];let n=i.replace(/^[\s]+/,""),s=n.match(vy);for(;s!==null;){const r=s[1].slice(1,-1),o=s[0].replace(/([\s]+)?;?$/,"").replace(r,new URL(r,t).toString());e.push(o),n=n.slice(s[0].length).replace(/^[\s]+/,""),s=n.match(vy)}return[e.join(";"),n]},xy=i=>{if(i!==void 0&&!Array.isArray(i))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Sy=i=>{if(!n4(i))throw new TypeError("The given value for processorCtor should be a constructor.");if(i.prototype===null||typeof i.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},s4=(i,t,e,n,s,r,o,a,l,c,h,u,f)=>{let d=0;return(p,g,m={credentials:"omit"})=>{const O=h.get(p);if(O!==void 0&&O.has(g))return Promise.resolve();const y=c.get(p);if(y!==void 0){const b=y.get(g);if(b!==void 0)return b}const _=r(p),v=_.audioWorklet===void 0?s(g).then(([b,k])=>{const[x,C]=_y(b,k),I=`${x};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${C}
})})(window,'_AWGS')`;return e(I)}).then(()=>{const b=f._AWGS.pop();if(b===void 0)throw new SyntaxError;n(_.currentTime,_.sampleRate,()=>b(class{},void 0,(k,x)=>{if(k.trim()==="")throw t();const C=Yg.get(_);if(C!==void 0){if(C.has(k))throw t();Sy(x),xy(x.parameterDescriptors),C.set(k,x)}else Sy(x),xy(x.parameterDescriptors),Yg.set(_,new Map([[k,x]]))},_.sampleRate,void 0,void 0))}):Promise.all([s(g),Promise.resolve(i(u,u))]).then(([[b,k],x])=>{const C=d+1;d=C;const[I,R]=_y(b,k),F=`${I};((AudioWorkletProcessor,registerProcessor)=>{${R}
})(${x?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${x?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${x?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${C}',class extends AudioWorkletProcessor{process(){return !1}})`,W=new Blob([F],{type:"application/javascript; charset=utf-8"}),B=URL.createObjectURL(W);return _.audioWorklet.addModule(B,m).then(()=>{if(a(_))return _;const U=o(_);return U.audioWorklet.addModule(B,m).then(()=>U)}).then(U=>{if(l===null)throw new SyntaxError;try{new l(U,`__sac${C}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(B))});return y===void 0?c.set(p,new Map([[g,v]])):y.set(g,v),v.then(()=>{const b=h.get(p);b===void 0?h.set(p,new Set([g])):b.add(g)}).finally(()=>{const b=c.get(p);b!==void 0&&b.delete(g)}),v}},Zn=(i,t)=>{const e=i.get(t);if(e===void 0)throw new Error("A value with the given key could not be found.");return e},Qd=(i,t)=>{const e=Array.from(i).filter(t);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");const[n]=e;return i.delete(n),n},rx=(i,t,e,n)=>{const s=Zn(i,t),r=Qd(s,o=>o[0]===e&&o[1]===n);return s.size===0&&i.delete(t),r},lh=i=>Zn(nx,i),Wa=i=>{if(Fa.has(i))throw new Error("The AudioNode is already stored.");Fa.add(i),lh(i).forEach(t=>t(!0))},ox=i=>"port"in i,ch=i=>{if(!Fa.has(i))throw new Error("The AudioNode is not stored.");Fa.delete(i),lh(i).forEach(t=>t(!1))},Kg=(i,t)=>{!ox(i)&&t.every(e=>e.size===0)&&ch(i)},r4=(i,t,e,n,s,r,o,a,l,c,h,u,f)=>{const d=new WeakMap;return(p,g,m,O,y)=>{const{activeInputs:_,passiveInputs:v}=r(g),{outputs:b}=r(p),k=a(p),x=C=>{const I=l(g),R=l(p);if(C){const $=rx(v,p,m,O);i(_,p,$,!1),!y&&!u(p)&&e(R,I,m,O),f(g)&&Wa(g)}else{const $=n(_,p,m,O);t(v,O,$,!1),!y&&!u(p)&&s(R,I,m,O);const E=o(g);if(E===0)h(g)&&Kg(g,_);else{const Z=d.get(g);Z!==void 0&&clearTimeout(Z),d.set(g,setTimeout(()=>{h(g)&&Kg(g,_)},E*1e3))}}};return c(b,[g,m,O],C=>C[0]===g&&C[1]===m&&C[2]===O,!0)?(k.add(x),h(p)?i(_,p,[m,O,x],!0):t(v,O,[p,m,x],!0),!0):!1}},o4=i=>(t,e,[n,s,r],o)=>{const a=t.get(n);a===void 0?t.set(n,new Set([[s,e,r]])):i(a,[s,e,r],l=>l[0]===s&&l[1]===e,o)},a4=i=>(t,e)=>{const n=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(n).connect(t.destination);const s=()=>{e.removeEventListener("ended",s),e.disconnect(n),n.disconnect()};e.addEventListener("ended",s)},l4=i=>(t,e)=>{i(t).add(e)},c4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},h4=(i,t,e,n,s,r)=>class extends i{constructor(a,l){const c=s(a),h={...c4,...l},u=n(c,h),f=r(c)?t():null;super(a,!1,u,f),this._nativeAnalyserNode=u}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},yi=(i,t)=>i.context===t,u4=(i,t,e)=>()=>{const n=new WeakMap,s=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=i(o,c)}return n.set(o,a),await e(r,o,a),a};return{render(r,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(r,o)}}},Af=i=>{try{i.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Cs=()=>new DOMException("","IndexSizeError"),Y0=i=>{i.getChannelData=(t=>e=>{try{return t.call(i,e)}catch(n){throw n.code===12?Cs():n}})(i.getChannelData)},f4={numberOfChannels:1},d4=(i,t,e,n,s,r,o,a)=>{let l=null;return class ax{constructor(h){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:f,sampleRate:d}={...f4,...h};l===null&&(l=new s(1,1,44100));const p=n!==null&&t(r,r)?new n({length:u,numberOfChannels:f,sampleRate:d}):l.createBuffer(f,u,d);if(p.numberOfChannels===0)throw e();return typeof p.copyFromChannel!="function"?(o(p),Y0(p)):t(Af,()=>Af(p))||a(p),i.add(p),p}static[Symbol.hasInstance](h){return h!==null&&typeof h=="object"&&Object.getPrototypeOf(h)===ax.prototype||i.has(h)}}},Vi=-34028234663852886e22,ki=-Vi,zs=i=>Fa.has(i),p4={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},g4=(i,t,e,n,s,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f={...p4,...h},d=s(u,f),p=o(u),g=p?t():null;super(c,!1,d,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=e(this,p,d.playbackRate,ki,Vi)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const h=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=h;const u=this._nativeAudioBufferSourceNode.onended;this._onended=u!==null&&u===h?c:u}get playbackRate(){return this._playbackRate}start(c=0,h=0,u){if(this._nativeAudioBufferSourceNode.start(c,h,u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=u===void 0?[c,h]:[c,h,u]),this.context.state!=="closed"){Wa(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),zs(this)&&ch(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},m4=(i,t,e,n,s)=>()=>{const r=new WeakMap;let o=null,a=null;const l=async(c,h)=>{let u=e(c);const f=yi(u,h);if(!f){const d={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=t(h,d),o!==null&&u.start(...o),a!==null&&u.stop(a)}return r.set(h,u),f?await i(h,c.playbackRate,u.playbackRate):await n(h,c.playbackRate,u.playbackRate),await s(c,h,u),u};return{set start(c){o=c},set stop(c){a=c},render(c,h){const u=r.get(h);return u!==void 0?Promise.resolve(u):l(c,h)}}},O4=i=>"playbackRate"in i,y4=i=>"frequency"in i&&"gain"in i,b4=i=>"offset"in i,v4=i=>!("frequency"in i)&&"gain"in i,_4=i=>"detune"in i&&"frequency"in i&&!("gain"in i),x4=i=>"pan"in i,Pi=i=>Zn(ex,i),hh=i=>Zn(ix,i),Jg=(i,t)=>{const{activeInputs:e}=Pi(i);e.forEach(s=>s.forEach(([r])=>{t.includes(i)||Jg(r,[...t,i])}));const n=O4(i)?[i.playbackRate]:ox(i)?Array.from(i.parameters.values()):y4(i)?[i.Q,i.detune,i.frequency,i.gain]:b4(i)?[i.offset]:v4(i)?[i.gain]:_4(i)?[i.detune,i.frequency]:x4(i)?[i.pan]:[];for(const s of n){const r=hh(s);r!==void 0&&r.activeInputs.forEach(([o])=>Jg(o,t))}zs(i)&&ch(i)},lx=i=>{Jg(i.destination,[])},S4=i=>i===void 0||typeof i=="number"||typeof i=="string"&&(i==="balanced"||i==="interactive"||i==="playback"),w4=(i,t,e,n,s,r,o,a,l)=>class extends i{constructor(h={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let u;try{u=new l(h)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?e():p}if(u===null)throw n();if(!S4(h.latencyHint))throw new TypeError(`The provided value '${h.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(h.sampleRate!==void 0&&u.sampleRate!==h.sampleRate)throw e();super(u,2);const{latencyHint:f}=h,{sampleRate:d}=u;if(this._baseLatency=typeof u.baseLatency=="number"?u.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=u,l.name==="webkitAudioContext"?(this._nativeGainNode=u.createGain(),this._nativeOscillatorNode=u.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(u.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,u.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),u.removeEventListener("statechange",p)};u.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),lx(this)}))}createMediaElementSource(h){return new s(this,{mediaElement:h})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(h){return new o(this,{mediaStream:h})}createMediaStreamTrackSource(h){return new a(this,{mediaStreamTrack:h})}resume(){return this._state==="suspended"?new Promise((h,u)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?h():this.resume().then(h,u)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(h=>{throw h===void 0||h.code===15?t():h})}suspend(){return this._nativeAudioContext.suspend().catch(h=>{throw h===void 0?t():h})}},k4=(i,t,e,n,s,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f=o(u),d=s(u,h,f),p=f?t(a):null;super(c,!1,d,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},C4=i=>{const t=new WeakMap,e=async(n,s)=>{const r=s.destination;return t.set(s,r),await i(n,s,r),r};return{render(n,s){const r=t.get(s);return r!==void 0?Promise.resolve(r):e(n,s)}}},T4=(i,t,e,n,s,r,o,a)=>(l,c)=>{const h=c.listener,u=()=>{const b=new Float32Array(1),k=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),x=o(c);let C=!1,I=[0,0,-1,0,1,0],R=[0,0,0];const $=()=>{if(C)return;C=!0;const W=n(c,256,9,0);W.onaudioprocess=({inputBuffer:B})=>{const U=[r(B,b,0),r(B,b,1),r(B,b,2),r(B,b,3),r(B,b,4),r(B,b,5)];U.some((X,j)=>X!==I[j])&&(h.setOrientation(...U),I=U);const V=[r(B,b,6),r(B,b,7),r(B,b,8)];V.some((X,j)=>X!==R[j])&&(h.setPosition(...V),R=V)},k.connect(W)},E=W=>B=>{B!==I[W]&&(I[W]=B,h.setOrientation(...I))},Z=W=>B=>{B!==R[W]&&(R[W]=B,h.setPosition(...R))},F=(W,B,U)=>{const V=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:B});V.connect(k,0,W),V.start(),Object.defineProperty(V.offset,"defaultValue",{get(){return B}});const X=i({context:l},x,V.offset,ki,Vi);return a(X,"value",j=>()=>j.call(X),j=>tt=>{try{j.call(X,tt)}catch(it){if(it.code!==9)throw it}$(),x&&U(tt)}),X.cancelAndHoldAtTime=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.cancelAndHoldAtTime),X.cancelScheduledValues=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.cancelScheduledValues),X.exponentialRampToValueAtTime=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.exponentialRampToValueAtTime),X.linearRampToValueAtTime=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.linearRampToValueAtTime),X.setTargetAtTime=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.setTargetAtTime),X.setValueAtTime=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.setValueAtTime),X.setValueCurveAtTime=(j=>x?()=>{throw s()}:(...tt)=>{const it=j.apply(X,tt);return $(),it})(X.setValueCurveAtTime),X};return{forwardX:F(0,0,E(0)),forwardY:F(1,0,E(1)),forwardZ:F(2,-1,E(2)),positionX:F(6,0,Z(0)),positionY:F(7,0,Z(1)),positionZ:F(8,0,Z(2)),upX:F(3,0,E(3)),upY:F(4,1,E(4)),upZ:F(5,0,E(5))}},{forwardX:f,forwardY:d,forwardZ:p,positionX:g,positionY:m,positionZ:O,upX:y,upY:_,upZ:v}=h.forwardX===void 0?u():h;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return p},get positionX(){return g},get positionY(){return m},get positionZ(){return O},get upX(){return y},get upY(){return _},get upZ(){return v}}},Mf=i=>"context"in i,uh=i=>Mf(i[0]),qo=(i,t,e,n)=>{for(const s of i)if(e(s)){if(n)return!1;throw Error("The set contains at least one similar element.")}return i.add(t),!0},wy=(i,t,[e,n],s)=>{qo(i,[t,e,n],r=>r[0]===t&&r[1]===e,s)},ky=(i,[t,e,n],s)=>{const r=i.get(t);r===void 0?i.set(t,new Set([[e,n]])):qo(r,[e,n],o=>o[0]===e,s)},ll=i=>"inputs"in i,Ef=(i,t,e,n)=>{if(ll(t)){const s=t.inputs[n];return i.connect(s,e,0),[s,e,0]}return i.connect(t,e,n),[t,e,n]},cx=(i,t,e)=>{for(const n of i)if(n[0]===t&&n[1]===e)return i.delete(n),n;return null},P4=(i,t,e)=>Qd(i,n=>n[0]===t&&n[1]===e),hx=(i,t)=>{if(!lh(i).delete(t))throw new Error("Missing the expected event listener.")},ux=(i,t,e)=>{const n=Zn(i,t),s=Qd(n,r=>r[0]===e);return n.size===0&&i.delete(t),s},Rf=(i,t,e,n)=>{ll(t)?i.disconnect(t.inputs[n],e,0):i.disconnect(t,e,n)},me=i=>Zn(j0,i),Nc=i=>Zn(U0,i),No=i=>Ug.has(i),Ju=i=>!Fa.has(i),Cy=(i,t)=>new Promise(e=>{if(t!==null)e(!0);else{const n=i.createScriptProcessor(256,1,1),s=i.createGain(),r=i.createBuffer(1,2,44100),o=r.getChannelData(0);o[0]=1,o[1]=1;const a=i.createBufferSource();a.buffer=r,a.loop=!0,a.connect(n).connect(i.destination),a.connect(s),a.disconnect(s),n.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,h=>h===1)?e(!0):e(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(i.destination)},a.start()}}),Rp=(i,t)=>{const e=new Map;for(const n of i)for(const s of n){const r=e.get(s);e.set(s,r===void 0?1:r+1)}e.forEach((n,s)=>t(s,n))},If=i=>"context"in i,A4=i=>{const t=new Map;i.connect=(e=>(n,s=0,r=0)=>{const o=If(n)?e(n,s,r):e(n,s),a=t.get(n);return a===void 0?t.set(n,[{input:r,output:s}]):a.every(l=>l.input!==r||l.output!==s)&&a.push({input:r,output:s}),o})(i.connect.bind(i)),i.disconnect=(e=>(n,s,r)=>{if(e.apply(i),n===void 0)t.clear();else if(typeof n=="number")for(const[o,a]of t){const l=a.filter(c=>c.output!==n);l.length===0?t.delete(o):t.set(o,l)}else if(t.has(n))if(s===void 0)t.delete(n);else{const o=t.get(n);if(o!==void 0){const a=o.filter(l=>l.output!==s&&(l.input!==r||r===void 0));a.length===0?t.delete(n):t.set(n,a)}}for(const[o,a]of t)a.forEach(l=>{If(o)?i.connect(o,l.output,l.input):i.connect(o,l.output)})})(i.disconnect)},M4=(i,t,e,n)=>{const{activeInputs:s,passiveInputs:r}=hh(t),{outputs:o}=Pi(i),a=lh(i),l=c=>{const h=me(i),u=Nc(t);if(c){const f=ux(r,i,e);wy(s,i,f,!1),!n&&!No(i)&&h.connect(u,e)}else{const f=P4(s,i,e);ky(r,f,!1),!n&&!No(i)&&h.disconnect(u,e)}};return qo(o,[t,e],c=>c[0]===t&&c[1]===e,!0)?(a.add(l),zs(i)?wy(s,i,[e,l],!0):ky(r,[i,e,l],!0),!0):!1},E4=(i,t,e,n)=>{const{activeInputs:s,passiveInputs:r}=Pi(t),o=cx(s[n],i,e);return o===null?[rx(r,i,e,n)[2],!1]:[o[2],!0]},R4=(i,t,e)=>{const{activeInputs:n,passiveInputs:s}=hh(t),r=cx(n,i,e);return r===null?[ux(s,i,e)[1],!1]:[r[2],!0]},H0=(i,t,e,n,s)=>{const[r,o]=E4(i,e,n,s);if(r!==null&&(hx(i,r),o&&!t&&!No(i)&&Rf(me(i),me(e),n,s)),zs(e)){const{activeInputs:a}=Pi(e);Kg(e,a)}},K0=(i,t,e,n)=>{const[s,r]=R4(i,e,n);s!==null&&(hx(i,s),r&&!t&&!No(i)&&me(i).disconnect(Nc(e),n))},I4=(i,t)=>{const e=Pi(i),n=[];for(const s of e.outputs)uh(s)?H0(i,t,...s):K0(i,t,...s),n.push(s[0]);return e.outputs.clear(),n},Q4=(i,t,e)=>{const n=Pi(i),s=[];for(const r of n.outputs)r[1]===e&&(uh(r)?H0(i,t,...r):K0(i,t,...r),s.push(r[0]),n.outputs.delete(r));return s},N4=(i,t,e,n,s)=>{const r=Pi(i);return Array.from(r.outputs).filter(o=>o[0]===e&&(n===void 0||o[1]===n)&&(s===void 0||o[2]===s)).map(o=>(uh(o)?H0(i,t,...o):K0(i,t,...o),r.outputs.delete(o),o[0]))},$4=(i,t,e,n,s,r,o,a,l,c,h,u,f,d,p,g)=>class extends c{constructor(O,y,_,v){super(_),this._context=O,this._nativeAudioNode=_;const b=h(O);u(b)&&e(Cy,()=>Cy(b,g))!==!0&&A4(_),j0.set(this,_),nx.set(this,new Set),O.state!=="closed"&&y&&Wa(this),i(this,v,_)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(O){this._nativeAudioNode.channelCount=O}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(O){this._nativeAudioNode.channelCountMode=O}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(O){this._nativeAudioNode.channelInterpretation=O}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(O,y=0,_=0){if(y<0||y>=this._nativeAudioNode.numberOfOutputs)throw s();const v=h(this._context),b=p(v);if(f(O)||d(O))throw r();if(Mf(O)){const C=me(O);try{const R=Ef(this._nativeAudioNode,C,y,_),$=Ju(this);(b||$)&&this._nativeAudioNode.disconnect(...R),this.context.state!=="closed"&&!$&&Ju(O)&&Wa(O)}catch(R){throw R.code===12?r():R}if(t(this,O,y,_,b)){const R=l([this],O);Rp(R,n(b))}return O}const k=Nc(O);if(k.name==="playbackRate"&&k.maxValue===1024)throw o();try{this._nativeAudioNode.connect(k,y),(b||Ju(this))&&this._nativeAudioNode.disconnect(k,y)}catch(C){throw C.code===12?r():C}if(M4(this,O,y,b)){const C=l([this],O);Rp(C,n(b))}}disconnect(O,y,_){let v;const b=h(this._context),k=p(b);if(O===void 0)v=I4(this,k);else if(typeof O=="number"){if(O<0||O>=this.numberOfOutputs)throw s();v=Q4(this,k,O)}else{if(y!==void 0&&(y<0||y>=this.numberOfOutputs)||Mf(O)&&_!==void 0&&(_<0||_>=O.numberOfInputs))throw s();if(v=N4(this,k,O,y,_),v.length===0)throw r()}for(const x of v){const C=l([this],x);Rp(C,a)}}},D4=(i,t,e,n,s,r,o,a,l,c,h,u,f)=>(d,p,g,m=null,O=null)=>{const y=g.value,_=new GP(y),v=p?n(_):null,b={get defaultValue(){return y},get maxValue(){return m===null?g.maxValue:m},get minValue(){return O===null?g.minValue:O},get value(){return g.value},set value(k){g.value=k,b.setValueAtTime(k,d.context.currentTime)},cancelAndHoldAtTime(k){if(typeof g.cancelAndHoldAtTime=="function")v===null&&_.flush(d.context.currentTime),_.add(s(k)),g.cancelAndHoldAtTime(k);else{const x=Array.from(_).pop();v===null&&_.flush(d.context.currentTime),_.add(s(k));const C=Array.from(_).pop();g.cancelScheduledValues(k),x!==C&&C!==void 0&&(C.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(C.value,C.endTime):C.type==="linearRampToValue"?g.linearRampToValueAtTime(C.value,C.endTime):C.type==="setValue"?g.setValueAtTime(C.value,C.startTime):C.type==="setValueCurve"&&g.setValueCurveAtTime(C.values,C.startTime,C.duration))}return b},cancelScheduledValues(k){return v===null&&_.flush(d.context.currentTime),_.add(r(k)),g.cancelScheduledValues(k),b},exponentialRampToValueAtTime(k,x){if(k===0)throw new RangeError;if(!Number.isFinite(x)||x<0)throw new RangeError;const C=d.context.currentTime;return v===null&&_.flush(C),Array.from(_).length===0&&(_.add(c(y,C)),g.setValueAtTime(y,C)),_.add(o(k,x)),g.exponentialRampToValueAtTime(k,x),b},linearRampToValueAtTime(k,x){const C=d.context.currentTime;return v===null&&_.flush(C),Array.from(_).length===0&&(_.add(c(y,C)),g.setValueAtTime(y,C)),_.add(a(k,x)),g.linearRampToValueAtTime(k,x),b},setTargetAtTime(k,x,C){return v===null&&_.flush(d.context.currentTime),_.add(l(k,x,C)),g.setTargetAtTime(k,x,C),b},setValueAtTime(k,x){return v===null&&_.flush(d.context.currentTime),_.add(c(k,x)),g.setValueAtTime(k,x),b},setValueCurveAtTime(k,x,C){const I=k instanceof Float32Array?k:new Float32Array(k);if(u!==null&&u.name==="webkitAudioContext"){const R=x+C,$=d.context.sampleRate,E=Math.ceil(x*$),Z=Math.floor(R*$),F=Z-E,W=new Float32Array(F);for(let U=0;U<F;U+=1){const V=(I.length-1)/C*((E+U)/$-x),X=Math.floor(V),j=Math.ceil(V);W[U]=X===j?I[X]:(1-(V-X))*I[X]+(1-(j-V))*I[j]}v===null&&_.flush(d.context.currentTime),_.add(h(W,x,C)),g.setValueCurveAtTime(W,x,C);const B=Z/$;B<R&&f(b,W[W.length-1],B),f(b,I[I.length-1],R)}else v===null&&_.flush(d.context.currentTime),_.add(h(I,x,C)),g.setValueCurveAtTime(I,x,C);return b}};return e.set(b,g),t.set(b,d),i(b,v),b},L4=i=>({replay(t){for(const e of i)if(e.type==="exponentialRampToValue"){const{endTime:n,value:s}=e;t.exponentialRampToValueAtTime(s,n)}else if(e.type==="linearRampToValue"){const{endTime:n,value:s}=e;t.linearRampToValueAtTime(s,n)}else if(e.type==="setTarget"){const{startTime:n,target:s,timeConstant:r}=e;t.setTargetAtTime(s,n,r)}else if(e.type==="setValue"){const{startTime:n,value:s}=e;t.setValueAtTime(s,n)}else if(e.type==="setValueCurve"){const{duration:n,startTime:s,values:r}=e;t.setValueCurveAtTime(r,s,n)}else throw new Error("Can't apply an unknown automation.")}});class fx{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((n,s)=>t.call(e,n,s,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const V4={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},B4=(i,t,e,n,s,r,o,a,l,c,h,u,f,d)=>class extends t{constructor(g,m,O){var y;const _=a(g),v=l(_),b=h({...V4,...O});f(b);const k=Yg.get(_),x=k?.get(m),C=v||_.state!=="closed"?_:(y=o(_))!==null&&y!==void 0?y:_,I=s(C,v?null:g.baseLatency,c,m,x,b),R=v?n(m,b,x):null;super(g,!0,I,R);const $=[];I.parameters.forEach((Z,F)=>{const W=e(this,v,Z);$.push([F,W])}),this._nativeAudioWorkletNode=I,this._onprocessorerror=null,this._parameters=new fx($),v&&i(_,this);const{activeInputs:E}=r(this);u(I,E)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const m=typeof g=="function"?d(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=m;const O=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=O!==null&&O===m?g:O}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Qf(i,t,e,n,s){if(typeof i.copyFromChannel=="function")t[e].byteLength===0&&(t[e]=new Float32Array(128)),i.copyFromChannel(t[e],n,s);else{const r=i.getChannelData(n);if(t[e].byteLength===0)t[e]=r.slice(s,s+128);else{const o=new Float32Array(r.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);t[e].set(o)}}}const dx=(i,t,e,n,s)=>{typeof i.copyToChannel=="function"?t[e].byteLength!==0&&i.copyToChannel(t[e],n,s):t[e].byteLength!==0&&i.getChannelData(n).set(t[e],s)},Nf=(i,t)=>{const e=[];for(let n=0;n<i;n+=1){const s=[],r=typeof t=="number"?t:t[n];for(let o=0;o<r;o+=1)s.push(new Float32Array(128));e.push(s)}return e},Z4=(i,t)=>{const e=Zn(Hg,i),n=me(t);return Zn(e,n)},F4=async(i,t,e,n,s,r,o)=>{const a=t===null?Math.ceil(i.context.length/128)*128:t.length,l=n.channelCount*n.numberOfInputs,c=s.reduce((m,O)=>m+O,0),h=c===0?null:e.createBuffer(c,a,e.sampleRate);if(r===void 0)throw new Error("Missing the processor constructor.");const u=Pi(i),f=await Z4(e,i),d=Nf(n.numberOfInputs,n.channelCount),p=Nf(n.numberOfOutputs,s),g=Array.from(i.parameters.keys()).reduce((m,O)=>({...m,[O]:new Float32Array(128)}),{});for(let m=0;m<a;m+=128){if(n.numberOfInputs>0&&t!==null)for(let O=0;O<n.numberOfInputs;O+=1)for(let y=0;y<n.channelCount;y+=1)Qf(t,d[O],y,y,m);r.parameterDescriptors!==void 0&&t!==null&&r.parameterDescriptors.forEach(({name:O},y)=>{Qf(t,g,O,l+y,m)});for(let O=0;O<n.numberOfInputs;O+=1)for(let y=0;y<s[O];y+=1)p[O][y].byteLength===0&&(p[O][y]=new Float32Array(128));try{const O=d.map((_,v)=>u.activeInputs[v].size===0?[]:_),y=o(m/e.sampleRate,e.sampleRate,()=>f.process(O,p,g));if(h!==null)for(let _=0,v=0;_<n.numberOfOutputs;_+=1){for(let b=0;b<s[_];b+=1)dx(h,p[_],b,v+b,m);v+=s[_]}if(!y)break}catch(O){i.dispatchEvent(new ErrorEvent("processorerror",{colno:O.colno,filename:O.filename,lineno:O.lineno,message:O.message}));break}}return h},W4=(i,t,e,n,s,r,o,a,l,c,h,u,f,d,p,g)=>(m,O,y)=>{const _=new WeakMap;let v=null;const b=async(k,x)=>{let C=h(k),I=null;const R=yi(C,x),$=Array.isArray(O.outputChannelCount)?O.outputChannelCount:Array.from(O.outputChannelCount);if(u===null){const E=$.reduce((B,U)=>B+U,0),Z=s(x,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),F=[];for(let B=0;B<k.numberOfOutputs;B+=1)F.push(n(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:$[B]}));const W=o(x,{channelCount:O.channelCount,channelCountMode:O.channelCountMode,channelInterpretation:O.channelInterpretation,gain:1});W.connect=t.bind(null,F),W.disconnect=l.bind(null,F),I=[Z,F,W]}else R||(C=new u(x,m));if(_.set(x,I===null?C:I[2]),I!==null){if(v===null){if(y===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const U=k.channelCount*k.numberOfInputs,V=y.parameterDescriptors===void 0?0:y.parameterDescriptors.length,X=U+V;v=F4(k,X===0?null:await(async()=>{const tt=new f(X,Math.ceil(k.context.length/128)*128,x.sampleRate),it=[],_t=[];for(let Mt=0;Mt<O.numberOfInputs;Mt+=1)it.push(o(tt,{channelCount:O.channelCount,channelCountMode:O.channelCountMode,channelInterpretation:O.channelInterpretation,gain:1})),_t.push(s(tt,{channelCount:O.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:O.channelCount}));const Nt=await Promise.all(Array.from(k.parameters.values()).map(async Mt=>{const Yt=r(tt,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Mt.value});return await d(tt,Mt,Yt.offset),Yt})),Ot=n(tt,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,U+V)});for(let Mt=0;Mt<O.numberOfInputs;Mt+=1){it[Mt].connect(_t[Mt]);for(let Yt=0;Yt<O.channelCount;Yt+=1)_t[Mt].connect(Ot,Yt,Mt*O.channelCount+Yt)}for(const[Mt,Yt]of Nt.entries())Yt.connect(Ot,0,U+Mt),Yt.start(0);return Ot.connect(tt.destination),await Promise.all(it.map(Mt=>p(k,tt,Mt))),g(tt)})(),x,O,$,y,c)}const E=await v,Z=e(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[F,W,B]=I;E!==null&&(Z.buffer=E,Z.start(0)),Z.connect(F);for(let U=0,V=0;U<k.numberOfOutputs;U+=1){const X=W[U];for(let j=0;j<$[U];j+=1)F.connect(X,V+j,j);V+=$[U]}return B}if(R)for(const[E,Z]of k.parameters.entries())await i(x,Z,C.parameters.get(E));else for(const[E,Z]of k.parameters.entries())await d(x,Z,C.parameters.get(E));return await p(k,x,C),C};return{render(k,x){a(x,k);const C=_.get(x);return C!==void 0?Promise.resolve(C):b(k,x)}}},q4=(i,t,e,n,s,r,o,a,l,c,h,u,f,d,p,g,m,O,y,_)=>class extends p{constructor(b,k){super(b,k),this._nativeContext=b,this._audioWorklet=i===void 0?void 0:{addModule:(x,C)=>i(this,x,C)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new s(this)}createBuffer(b,k,x){return new e({length:k,numberOfChannels:b,sampleRate:x})}createBufferSource(){return new n(this)}createChannelMerger(b=6){return new r(this,{numberOfInputs:b})}createChannelSplitter(b=6){return new o(this,{numberOfOutputs:b})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(b=1){return new h(this,{maxDelayTime:b})}createDynamicsCompressor(){return new u(this)}createGain(){return new f(this)}createIIRFilter(b,k){return new d(this,{feedback:k,feedforward:b})}createOscillator(){return new g(this)}createPanner(){return new m(this)}createPeriodicWave(b,k,x={disableNormalization:!1}){return new O(this,{...x,imag:k,real:b})}createStereoPanner(){return new y(this)}createWaveShaper(){return new _(this)}decodeAudioData(b,k,x){return c(this._nativeContext,b).then(C=>(typeof k=="function"&&k(C),C),C=>{throw typeof x=="function"&&x(C),C})}},X4={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},z4=(i,t,e,n,s,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f={...X4,...h},d=s(u,f),p=o(u),g=p?e():null;super(c,!1,d,g),this._Q=t(this,p,d.Q,ki,Vi),this._detune=t(this,p,d.detune,1200*Math.log2(ki),-1200*Math.log2(ki)),this._frequency=t(this,p,d.frequency,c.sampleRate/2,0),this._gain=t(this,p,d.gain,40*Math.log10(ki),Vi),this._nativeBiquadFilterNode=d,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,h,u){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,h,u)}catch(f){throw f.code===11?n():f}if(c.length!==h.length||h.length!==u.length)throw n()}},G4=(i,t,e,n,s)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=t(l,u)}return r.set(l,c),h?(await i(l,a.Q,c.Q),await i(l,a.detune,c.detune),await i(l,a.frequency,c.frequency),await i(l,a.gain,c.gain)):(await n(l,a.Q,c.Q),await n(l,a.detune,c.detune),await n(l,a.frequency,c.frequency),await n(l,a.gain,c.gain)),await s(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},j4=(i,t)=>(e,n)=>{const s=t.get(e);if(s!==void 0)return s;const r=i.get(e);if(r!==void 0)return r;try{const o=n();return o instanceof Promise?(i.set(e,o),o.catch(()=>!1).then(a=>(i.delete(e),t.set(e,a),a))):(t.set(e,o),o)}catch{return t.set(e,!1),!1}},U4={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Y4=(i,t,e,n,s)=>class extends i{constructor(o,a){const l=n(o),c={...U4,...a},h=e(l,c),u=s(l)?t():null;super(o,!1,h,u)}},H4=(i,t,e)=>()=>{const n=new WeakMap,s=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=i(o,c)}return n.set(o,a),await e(r,o,a),a};return{render(r,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(r,o)}}},K4={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},J4=(i,t,e,n,s,r)=>class extends i{constructor(a,l){const c=n(a),h=r({...K4,...l}),u=e(c,h),f=s(c)?t():null;super(a,!1,u,f)}},t6=(i,t,e)=>()=>{const n=new WeakMap,s=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=i(o,c)}return n.set(o,a),await e(r,o,a),a};return{render(r,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(r,o)}}},e6=i=>(t,e,n)=>i(e,t,n),i6=i=>(t,e,n=0,s=0)=>{const r=t[n];if(r===void 0)throw i();return If(e)?r.connect(e,0,s):r.connect(e,0)},n6=i=>(t,e)=>{const n=i(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=t.createBuffer(1,2,44100);return n.buffer=s,n.loop=!0,n.connect(e),n.start(),()=>{n.stop(),n.disconnect(e)}},s6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},r6=(i,t,e,n,s,r,o)=>class extends i{constructor(l,c){const h=s(l),u={...s6,...c},f=n(h,u),d=r(h),p=d?e():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=t(this,d,f.offset,ki,Vi),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?o(this,l):null;this._nativeConstantSourceNode.onended=c;const h=this._nativeConstantSourceNode.onended;this._onended=h!==null&&h===c?l:h}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Wa(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),zs(this)&&ch(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},o6=(i,t,e,n,s)=>()=>{const r=new WeakMap;let o=null,a=null;const l=async(c,h)=>{let u=e(c);const f=yi(u,h);if(!f){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=t(h,d),o!==null&&u.start(o),a!==null&&u.stop(a)}return r.set(h,u),f?await i(h,c.offset,u.offset):await n(h,c.offset,u.offset),await s(c,h,u),u};return{set start(c){o=c},set stop(c){a=c},render(c,h){const u=r.get(h);return u!==void 0?Promise.resolve(u):l(c,h)}}},a6=i=>t=>(i[0]=t,i[0]),l6={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},c6=(i,t,e,n,s,r)=>class extends i{constructor(a,l){const c=n(a),h={...l6,...l},u=e(c,h),d=s(c)?t():null;super(a,!1,u,d),this._isBufferNullified=!1,this._nativeConvolverNode=u,h.buffer!==null&&r(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},h6=(i,t,e)=>()=>{const n=new WeakMap,s=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=i(o,c)}return n.set(o,a),ll(a)?await e(r,o,a.inputs[0]):await e(r,o,a),a};return{render(r,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(r,o)}}},u6=(i,t)=>(e,n,s)=>{if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(e,n,s)}catch(r){throw r.name==="SyntaxError"?i():r}},f6=()=>new DOMException("","DataCloneError"),Ty=i=>{const{port1:t,port2:e}=new MessageChannel;return new Promise(n=>{const s=()=>{e.onmessage=null,t.close(),e.close(),n()};e.onmessage=()=>s();try{t.postMessage(i,[i])}catch{}finally{s()}})},d6=(i,t,e,n,s,r,o,a,l,c,h)=>(u,f)=>{const d=o(u)?u:r(u);if(s.has(f)){const p=e();return Promise.reject(p)}try{s.add(f)}catch{}return t(l,()=>l(d))?d.decodeAudioData(f).then(p=>(Ty(f).catch(()=>{}),t(a,()=>a(p))||h(p),i.add(p),p)):new Promise((p,g)=>{const m=async()=>{try{await Ty(f)}catch{}},O=y=>{g(y),m()};try{d.decodeAudioData(f,y=>{typeof y.copyFromChannel!="function"&&(c(y),Y0(y)),i.add(y),m().then(()=>p(y))},y=>{O(y===null?n():y)})}catch(y){O(y)}})},p6=(i,t,e,n,s,r,o,a)=>(l,c)=>{const h=t.get(l);if(h===void 0)throw new Error("Missing the expected cycle count.");const u=r(l.context),f=a(u);if(h===c){if(t.delete(l),!f&&o(l)){const d=n(l),{outputs:p}=e(l);for(const g of p)if(uh(g)){const m=n(g[0]);i(d,m,g[1],g[2])}else{const m=s(g[0]);d.connect(m,g[1])}}}else t.set(l,h-c)},g6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},m6=(i,t,e,n,s,r,o)=>class extends i{constructor(l,c){const h=s(l),u={...g6,...c},f=n(h,u),d=r(h),p=d?e(u.maxDelayTime):null;super(l,!1,f,p),this._delayTime=t(this,d,f.delayTime),o(this,u.maxDelayTime)}get delayTime(){return this._delayTime}},O6=(i,t,e,n,s)=>r=>{const o=new WeakMap,a=async(l,c)=>{let h=e(l);const u=yi(h,c);if(!u){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:r};h=t(c,f)}return o.set(c,h),u?await i(c,l.delayTime,h.delayTime):await n(c,l.delayTime,h.delayTime),await s(l,c,h),h};return{render(l,c){const h=o.get(c);return h!==void 0?Promise.resolve(h):a(l,c)}}},y6=i=>(t,e,n,s)=>i(t[s],r=>r[0]===e&&r[1]===n),b6=i=>(t,e)=>{i(t).delete(e)},v6=i=>"delayTime"in i,_6=(i,t,e)=>function n(s,r){const o=Mf(r)?r:e(i,r);if(v6(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];const{outputs:a}=t(o);return Array.from(a).map(l=>n([...s,o],l[0])).reduce((l,c)=>l.concat(c),[])},jh=(i,t,e)=>{const n=t[e];if(n===void 0)throw i();return n},x6=i=>(t,e=void 0,n=void 0,s=0)=>e===void 0?t.forEach(r=>r.disconnect()):typeof e=="number"?jh(i,t,e).disconnect():If(e)?n===void 0?t.forEach(r=>r.disconnect(e)):s===void 0?jh(i,t,n).disconnect(e,0):jh(i,t,n).disconnect(e,0,s):n===void 0?t.forEach(r=>r.disconnect(e)):jh(i,t,n).disconnect(e,0),S6={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},w6=(i,t,e,n,s,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f={...S6,...h},d=n(u,f),p=o(u),g=p?e():null;super(c,!1,d,g),this._attack=t(this,p,d.attack),this._knee=t(this,p,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=t(this,p,d.ratio),this._release=t(this,p,d.release),this._threshold=t(this,p,d.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const h=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=h,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const h=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=h,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},k6=(i,t,e,n,s)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=t(l,u)}return r.set(l,c),h?(await i(l,a.attack,c.attack),await i(l,a.knee,c.knee),await i(l,a.ratio,c.ratio),await i(l,a.release,c.release),await i(l,a.threshold,c.threshold)):(await n(l,a.attack,c.attack),await n(l,a.knee,c.knee),await n(l,a.ratio,c.ratio),await n(l,a.release,c.release),await n(l,a.threshold,c.threshold)),await s(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},C6=()=>new DOMException("","EncodingError"),T6=i=>t=>new Promise((e,n)=>{if(i===null){n(new SyntaxError);return}const s=i.document.head;if(s===null)n(new SyntaxError);else{const r=i.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(o),l=i.onerror,c=()=>{i.onerror=l,URL.revokeObjectURL(a)};i.onerror=(h,u,f,d,p)=>{if(u===a||u===i.location.href&&f===1&&d===1)return c(),n(p),!1;if(l!==null)return l(h,u,f,d,p)},r.onerror=()=>{c(),n(new SyntaxError)},r.onload=()=>{c(),e()},r.src=a,r.type="module",s.appendChild(r)}}),P6=i=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,n,s){if(n!==null){let r=this._listeners.get(n);r===void 0&&(r=i(this,n),typeof n=="function"&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(e,r,s)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,n,s){const r=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(e,r===void 0?null:r,s)}},A6=i=>(t,e,n)=>{Object.defineProperties(i,{currentFrame:{configurable:!0,get(){return Math.round(t*e)}},currentTime:{configurable:!0,get(){return t}}});try{return n()}finally{i!==null&&(delete i.currentFrame,delete i.currentTime)}},M6=i=>async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw i()},E6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},R6=(i,t,e,n,s,r)=>class extends i{constructor(a,l){const c=s(a),h={...E6,...l},u=n(c,h),f=r(c),d=f?e():null;super(a,!1,u,d),this._gain=t(this,f,u.gain,ki,Vi)}get gain(){return this._gain}},I6=(i,t,e,n,s)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=t(l,u)}return r.set(l,c),h?await i(l,a.gain,c.gain):await n(l,a.gain,c.gain),await s(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},Q6=(i,t)=>e=>t(i,e),N6=i=>t=>{const e=i(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer},$6=i=>t=>{var e;return(e=i.get(t))!==null&&e!==void 0?e:0},D6=i=>t=>{const e=i(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer},L6=i=>t=>i.get(t),Ye=()=>new DOMException("","InvalidStateError"),V6=i=>t=>{const e=i.get(t);if(e===void 0)throw Ye();return e},B6=(i,t)=>e=>{let n=i.get(e);if(n!==void 0)return n;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new t(1,1,44100),i.set(e,n),n},Z6=i=>t=>{const e=i.get(t);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e},Nd=()=>new DOMException("","InvalidAccessError"),F6=i=>{i.getFrequencyResponse=(t=>(e,n,s)=>{if(e.length!==n.length||n.length!==s.length)throw Nd();return t.call(i,e,n,s)})(i.getFrequencyResponse)},W6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},q6=(i,t,e,n,s,r)=>class extends i{constructor(a,l){const c=n(a),h=s(c),u={...W6,...l},f=t(c,h?null:a.baseLatency,u),d=h?e(u.feedback,u.feedforward):null;super(a,!1,f,d),F6(f),this._nativeIIRFilterNode=f,r(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},px=(i,t,e,n,s,r,o,a,l,c,h)=>{const u=c.length;let f=a;for(let d=0;d<u;d+=1){let p=e[0]*c[d];for(let g=1;g<s;g+=1){const m=f-g&l-1;p+=e[g]*r[m],p-=i[g]*o[m]}for(let g=s;g<n;g+=1)p+=e[g]*r[f-g&l-1];for(let g=s;g<t;g+=1)p-=i[g]*o[f-g&l-1];r[f]=c[d],o[f]=p,f=f+1&l-1,h[d]=p}return f},X6=(i,t,e,n)=>{const s=e instanceof Float64Array?e:new Float64Array(e),r=n instanceof Float64Array?n:new Float64Array(n),o=s.length,a=r.length,l=Math.min(o,a);if(s[0]!==1){for(let p=0;p<o;p+=1)r[p]/=s[0];for(let p=1;p<a;p+=1)s[p]/=s[0]}const c=32,h=new Float32Array(c),u=new Float32Array(c),f=t.createBuffer(i.numberOfChannels,i.length,i.sampleRate),d=i.numberOfChannels;for(let p=0;p<d;p+=1){const g=i.getChannelData(p),m=f.getChannelData(p);h.fill(0),u.fill(0),px(s,o,r,a,l,h,u,0,c,g,m)}return f},z6=(i,t,e,n,s)=>(r,o)=>{const a=new WeakMap;let l=null;const c=async(h,u)=>{let f=null,d=t(h);const p=yi(d,u);if(u.createIIRFilter===void 0?f=i(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=u.createIIRFilter(o,r)),a.set(u,f===null?d:f),f!==null){if(l===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");const m=new e(h.context.destination.channelCount,h.context.length,u.sampleRate);l=(async()=>{await n(h,m,m.destination);const O=await s(m);return X6(O,u,r,o)})()}const g=await l;return f.buffer=g,f.start(0),f}return await n(h,u,d),d};return{render(h,u){const f=a.get(u);return f!==void 0?Promise.resolve(f):c(h,u)}}},G6=(i,t,e,n,s,r)=>o=>(a,l)=>{const c=i.get(a);if(c===void 0){if(!o&&r(a)){const h=n(a),{outputs:u}=e(a);for(const f of u)if(uh(f)){const d=n(f[0]);t(h,d,f[1],f[2])}else{const d=s(f[0]);h.disconnect(d,f[1])}}i.set(a,l)}else i.set(a,c+l)},j6=(i,t)=>e=>{const n=i.get(e);return t(n)||t(e)},U6=(i,t)=>e=>i.has(e)||t(e),Y6=(i,t)=>e=>i.has(e)||t(e),H6=(i,t)=>e=>{const n=i.get(e);return t(n)||t(e)},K6=i=>t=>i!==null&&t instanceof i,J6=i=>t=>i!==null&&typeof i.AudioNode=="function"&&t instanceof i.AudioNode,tA=i=>t=>i!==null&&typeof i.AudioParam=="function"&&t instanceof i.AudioParam,eA=(i,t)=>e=>i(e)||t(e),iA=i=>t=>i!==null&&t instanceof i,nA=i=>i!==null&&i.isSecureContext,sA=(i,t,e,n)=>class extends i{constructor(r,o){const a=e(r),l=t(a,o);if(n(a))throw TypeError();super(r,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},rA={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},oA=(i,t,e,n)=>class extends i{constructor(r,o){const a=e(r);if(n(a))throw new TypeError;const l={...rA,...o},c=t(a,l);super(r,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},aA=(i,t,e,n)=>class extends i{constructor(r,o){const a=e(r),l=t(a,o);if(n(a))throw new TypeError;super(r,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},lA=(i,t,e)=>class extends i{constructor(s,r){const o=e(s),a=t(o,r);super(s,!0,a,null)}},cA=(i,t,e,n,s,r)=>class extends e{constructor(a,l){super(a),this._nativeContext=a,Id.set(this,a),n(a)&&s.set(a,new Set),this._destination=new i(this,l),this._listener=t(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?r(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},$c=i=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const e=i.decodeAudioData(t.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch{}return!1},hA=(i,t)=>(e,n,s)=>{const r=new Set;return e.connect=(o=>(a,l=0,c=0)=>{const h=r.size===0;if(t(a))return o.call(e,a,l,c),i(r,[a,l,c],u=>u[0]===a&&u[1]===l&&u[2]===c,!0),h&&n(),a;o.call(e,a,l),i(r,[a,l],u=>u[0]===a&&u[1]===l,!0),h&&n()})(e.connect),e.disconnect=(o=>(a,l,c)=>{const h=r.size>0;if(a===void 0)o.apply(e),r.clear();else if(typeof a=="number"){o.call(e,a);for(const f of r)f[1]===a&&r.delete(f)}else{t(a)?o.call(e,a,l,c):o.call(e,a,l);for(const f of r)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&r.delete(f)}const u=r.size===0;h&&u&&s()})(e.disconnect),e},be=(i,t,e)=>{const n=t[e];n!==void 0&&n!==i[e]&&(i[e]=n)},Xe=(i,t)=>{be(i,t,"channelCount"),be(i,t,"channelCountMode"),be(i,t,"channelInterpretation")},Py=i=>typeof i.getFloatTimeDomainData=="function",uA=i=>{i.getFloatTimeDomainData=t=>{const e=new Uint8Array(t.length);i.getByteTimeDomainData(e);const n=Math.max(e.length,i.fftSize);for(let s=0;s<n;s+=1)t[s]=(e[s]-128)*.0078125;return t}},fA=(i,t)=>(e,n)=>{const s=e.createAnalyser();if(Xe(s,n),!(n.maxDecibels>n.minDecibels))throw t();return be(s,n,"fftSize"),be(s,n,"maxDecibels"),be(s,n,"minDecibels"),be(s,n,"smoothingTimeConstant"),i(Py,()=>Py(s))||uA(s),s},dA=i=>i===null?null:i.hasOwnProperty("AudioBuffer")?i.AudioBuffer:null,ke=(i,t,e)=>{const n=t[e];n!==void 0&&n!==i[e].value&&(i[e].value=n)},pA=i=>{i.start=(t=>{let e=!1;return(n=0,s=0,r)=>{if(e)throw Ye();t.call(i,n,s,r),e=!0}})(i.start)},J0=i=>{i.start=(t=>(e=0,n=0,s)=>{if(typeof s=="number"&&s<0||n<0||e<0)throw new RangeError("The parameters can't be negative.");t.call(i,e,n,s)})(i.start)},tO=i=>{i.stop=(t=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");t.call(i,e)})(i.stop)},gA=(i,t,e,n,s,r,o,a,l,c,h)=>(u,f)=>{const d=u.createBufferSource();return Xe(d,f),ke(d,f,"playbackRate"),be(d,f,"buffer"),be(d,f,"loop"),be(d,f,"loopEnd"),be(d,f,"loopStart"),t(e,()=>e(u))||pA(d),t(n,()=>n(u))||l(d),t(s,()=>s(u))||c(d,u),t(r,()=>r(u))||J0(d),t(o,()=>o(u))||h(d,u),t(a,()=>a(u))||tO(d),i(u,d),d},mA=i=>i===null?null:i.hasOwnProperty("AudioContext")?i.AudioContext:i.hasOwnProperty("webkitAudioContext")?i.webkitAudioContext:null,OA=(i,t)=>(e,n,s)=>{const r=e.destination;if(r.channelCount!==n)try{r.channelCount=n}catch{}s&&r.channelCountMode!=="explicit"&&(r.channelCountMode="explicit"),r.maxChannelCount===0&&Object.defineProperty(r,"maxChannelCount",{value:n});const o=i(e,{channelCount:n,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return t(o,"channelCount",a=>()=>a.call(o),a=>l=>{a.call(o,l);try{r.channelCount=l}catch(c){if(l>r.maxChannelCount)throw c}}),t(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{a.call(o,l),r.channelCountMode=l}),t(o,"channelInterpretation",a=>()=>a.call(o),a=>l=>{a.call(o,l),r.channelInterpretation=l}),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o},yA=i=>i===null?null:i.hasOwnProperty("AudioWorkletNode")?i.AudioWorkletNode:null,bA=i=>{const{port1:t}=new MessageChannel;try{t.postMessage(i)}finally{t.close()}},vA=(i,t,e,n,s)=>(r,o,a,l,c,h)=>{if(a!==null)try{const u=new a(r,l,h),f=new Map;let d=null;if(Object.defineProperties(u,{channelCount:{get:()=>h.channelCount,set:()=>{throw i()}},channelCountMode:{get:()=>"explicit",set:()=>{throw i()}},onprocessorerror:{get:()=>d,set:p=>{typeof d=="function"&&u.removeEventListener("processorerror",d),d=typeof p=="function"?p:null,typeof d=="function"&&u.addEventListener("processorerror",d)}}}),u.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(m!==null){const O=f.get(g[1]);O!==void 0?g[1]=O:(g[1]=y=>{y.type==="error"?(Object.defineProperties(y,{type:{value:"processorerror"}}),m(y)):m(new ErrorEvent(g[0],{...y}))},f.set(m,g[1]))}}return p.call(u,"error",g[1],g[2]),p.call(u,...g)})(u.addEventListener),u.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=f.get(g[1]);m!==void 0&&(f.delete(g[1]),g[1]=m)}return p.call(u,"error",g[1],g[2]),p.call(u,g[0],g[1],g[2])})(u.removeEventListener),h.numberOfOutputs!==0){const p=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return u.connect(p).connect(r.destination),s(u,()=>p.disconnect(),()=>p.connect(r.destination))}return u}catch(u){throw u.code===11?n():u}if(c===void 0)throw n();return bA(h),t(r,o,c,h)},gx=(i,t)=>i===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(i*t))))),_A=i=>new Promise((t,e)=>{const{port1:n,port2:s}=new MessageChannel;n.onmessage=({data:r})=>{n.close(),s.close(),t(r)},n.onmessageerror=({data:r})=>{n.close(),s.close(),e(r)},s.postMessage(i)}),xA=async(i,t)=>{const e=await _A(t);return new i(e)},SA=(i,t,e,n)=>{let s=Hg.get(i);s===void 0&&(s=new WeakMap,Hg.set(i,s));const r=xA(e,n);return s.set(t,r),r},wA=(i,t,e,n,s,r,o,a,l,c,h,u,f)=>(d,p,g,m)=>{if(m.numberOfInputs===0&&m.numberOfOutputs===0)throw l();const O=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(O.some(T=>T<1))throw l();if(O.length!==m.numberOfOutputs)throw t();if(m.channelCountMode!=="explicit")throw l();const y=m.channelCount*m.numberOfInputs,_=O.reduce((T,S)=>T+S,0),v=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(y+v>6||_>6)throw l();const b=new MessageChannel,k=[],x=[];for(let T=0;T<m.numberOfInputs;T+=1)k.push(o(d,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),x.push(s(d,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const C=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:T,maxValue:S,minValue:A,name:D}of g.parameterDescriptors){const q=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:m.parameterData[D]!==void 0?m.parameterData[D]:T===void 0?0:T});Object.defineProperties(q.offset,{defaultValue:{get:()=>T===void 0?0:T},maxValue:{get:()=>S===void 0?ki:S},minValue:{get:()=>A===void 0?Vi:A}}),C.push(q)}const I=n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+v)}),R=gx(p,d.sampleRate),$=a(d,R,y+v,Math.max(1,_)),E=s(d,{channelCount:Math.max(1,_),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,_)}),Z=[];for(let T=0;T<m.numberOfOutputs;T+=1)Z.push(n(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:O[T]}));for(let T=0;T<m.numberOfInputs;T+=1){k[T].connect(x[T]);for(let S=0;S<m.channelCount;S+=1)x[T].connect(I,S,T*m.channelCount+S)}const F=new fx(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:T},S)=>{const A=C[S];return A.connect(I,0,y+S),A.start(0),[T,A.offset]}));I.connect($);let W=m.channelInterpretation,B=null;const U=m.numberOfOutputs===0?[$]:Z,V={get bufferSize(){return R},get channelCount(){return m.channelCount},set channelCount(T){throw e()},get channelCountMode(){return m.channelCountMode},set channelCountMode(T){throw e()},get channelInterpretation(){return W},set channelInterpretation(T){for(const S of k)S.channelInterpretation=T;W=T},get context(){return $.context},get inputs(){return k},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return B},set onprocessorerror(T){typeof B=="function"&&V.removeEventListener("processorerror",B),B=typeof T=="function"?T:null,typeof B=="function"&&V.addEventListener("processorerror",B)},get parameters(){return F},get port(){return b.port2},addEventListener(...T){return $.addEventListener(T[0],T[1],T[2])},connect:i.bind(null,U),disconnect:c.bind(null,U),dispatchEvent(...T){return $.dispatchEvent(T[0])},removeEventListener(...T){return $.removeEventListener(T[0],T[1],T[2])}},X=new Map;b.port1.addEventListener=(T=>(...S)=>{if(S[0]==="message"){const A=typeof S[1]=="function"?S[1]:typeof S[1]=="object"&&S[1]!==null&&typeof S[1].handleEvent=="function"?S[1].handleEvent:null;if(A!==null){const D=X.get(S[1]);D!==void 0?S[1]=D:(S[1]=q=>{h(d.currentTime,d.sampleRate,()=>A(q))},X.set(A,S[1]))}}return T.call(b.port1,S[0],S[1],S[2])})(b.port1.addEventListener),b.port1.removeEventListener=(T=>(...S)=>{if(S[0]==="message"){const A=X.get(S[1]);A!==void 0&&(X.delete(S[1]),S[1]=A)}return T.call(b.port1,S[0],S[1],S[2])})(b.port1.removeEventListener);let j=null;Object.defineProperty(b.port1,"onmessage",{get:()=>j,set:T=>{typeof j=="function"&&b.port1.removeEventListener("message",j),j=typeof T=="function"?T:null,typeof j=="function"&&(b.port1.addEventListener("message",j),b.port1.start())}}),g.prototype.port=b.port1;let tt=null;SA(d,V,g,m).then(T=>tt=T);const _t=Nf(m.numberOfInputs,m.channelCount),Nt=Nf(m.numberOfOutputs,O),Ot=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((T,{name:S})=>({...T,[S]:new Float32Array(128)}),{});let Mt=!0;const Yt=()=>{m.numberOfOutputs>0&&$.disconnect(E);for(let T=0,S=0;T<m.numberOfOutputs;T+=1){const A=Z[T];for(let D=0;D<O[T];D+=1)E.disconnect(A,S+D,D);S+=O[T]}},dt=new Map;$.onaudioprocess=({inputBuffer:T,outputBuffer:S})=>{if(tt!==null){const A=u(V);for(let D=0;D<R;D+=128){for(let q=0;q<m.numberOfInputs;q+=1)for(let K=0;K<m.channelCount;K+=1)Qf(T,_t[q],K,K,D);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:q},K)=>{Qf(T,Ot,q,y+K,D)});for(let q=0;q<m.numberOfInputs;q+=1)for(let K=0;K<O[q];K+=1)Nt[q][K].byteLength===0&&(Nt[q][K]=new Float32Array(128));try{const q=_t.map((J,pt)=>{if(A[pt].size>0)return dt.set(pt,R/128),J;const yt=dt.get(pt);return yt===void 0?[]:(J.every(St=>St.every(Lt=>Lt===0))&&(yt===1?dt.delete(pt):dt.set(pt,yt-1)),J)});Mt=h(d.currentTime+D/d.sampleRate,d.sampleRate,()=>tt.process(q,Nt,Ot));for(let J=0,pt=0;J<m.numberOfOutputs;J+=1){for(let rt=0;rt<O[J];rt+=1)dx(S,Nt[J],rt,pt+rt,D);pt+=O[J]}}catch(q){Mt=!1,V.dispatchEvent(new ErrorEvent("processorerror",{colno:q.colno,filename:q.filename,lineno:q.lineno,message:q.message}))}if(!Mt){for(let q=0;q<m.numberOfInputs;q+=1){k[q].disconnect(x[q]);for(let K=0;K<m.channelCount;K+=1)x[D].disconnect(I,K,q*m.channelCount+K)}if(g.parameterDescriptors!==void 0){const q=g.parameterDescriptors.length;for(let K=0;K<q;K+=1){const J=C[K];J.disconnect(I,0,y+K),J.stop()}}I.disconnect($),$.onaudioprocess=null,Et?Yt():M();break}}}};let Et=!1;const bt=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Wt=()=>$.connect(bt).connect(d.destination),M=()=>{$.disconnect(bt),bt.disconnect()},Q=()=>{if(Mt){M(),m.numberOfOutputs>0&&$.connect(E);for(let T=0,S=0;T<m.numberOfOutputs;T+=1){const A=Z[T];for(let D=0;D<O[T];D+=1)E.connect(A,S+D,D);S+=O[T]}}Et=!0},G=()=>{Mt&&(Wt(),Yt()),Et=!1};return Wt(),f(V,Q,G)},mx=(i,t)=>{const e=i.createBiquadFilter();return Xe(e,t),ke(e,t,"Q"),ke(e,t,"detune"),ke(e,t,"frequency"),ke(e,t,"gain"),be(e,t,"type"),e},kA=(i,t)=>(e,n)=>{const s=e.createChannelMerger(n.numberOfInputs);return i!==null&&i.name==="webkitAudioContext"&&t(e,s),Xe(s,n),s},CA=i=>{const t=i.numberOfOutputs;Object.defineProperty(i,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Ye()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw Ye()}}),Object.defineProperty(i,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw Ye()}})},fh=(i,t)=>{const e=i.createChannelSplitter(t.numberOfOutputs);return Xe(e,t),CA(e),e},TA=(i,t,e,n,s)=>(r,o)=>{if(r.createConstantSource===void 0)return e(r,o);const a=r.createConstantSource();return Xe(a,o),ke(a,o,"offset"),t(n,()=>n(r))||J0(a),t(s,()=>s(r))||tO(a),i(r,a),a},cl=(i,t)=>(i.connect=t.connect.bind(t),i.disconnect=t.disconnect.bind(t),i),PA=(i,t,e,n)=>(s,{offset:r,...o})=>{const a=s.createBuffer(1,2,44100),l=t(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=e(s,{...o,gain:r}),h=a.getChannelData(0);h[0]=1,h[1]=1,l.buffer=a,l.loop=!0;const u={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(c),d=()=>l.disconnect(c);return i(s,l),n(cl(u,c),f,d)},AA=(i,t)=>(e,n)=>{const s=e.createConvolver();if(Xe(s,n),n.disableNormalization===s.normalize&&(s.normalize=!n.disableNormalization),be(s,n,"buffer"),n.channelCount>2||(t(s,"channelCount",r=>()=>r.call(s),r=>o=>{if(o>2)throw i();return r.call(s,o)}),n.channelCountMode==="max"))throw i();return t(s,"channelCountMode",r=>()=>r.call(s),r=>o=>{if(o==="max")throw i();return r.call(s,o)}),s},Ox=(i,t)=>{const e=i.createDelay(t.maxDelayTime);return Xe(e,t),ke(e,t,"delayTime"),e},MA=i=>(t,e)=>{const n=t.createDynamicsCompressor();if(Xe(n,e),e.channelCount>2||e.channelCountMode==="max")throw i();return ke(n,e,"attack"),ke(n,e,"knee"),ke(n,e,"ratio"),ke(n,e,"release"),ke(n,e,"threshold"),n},ji=(i,t)=>{const e=i.createGain();return Xe(e,t),ke(e,t,"gain"),e},EA=i=>(t,e,n)=>{if(t.createIIRFilter===void 0)return i(t,e,n);const s=t.createIIRFilter(n.feedforward,n.feedback);return Xe(s,n),s};function RA(i,t){const e=t[0]*t[0]+t[1]*t[1];return[(i[0]*t[0]+i[1]*t[1])/e,(i[1]*t[0]-i[0]*t[1])/e]}function IA(i,t){return[i[0]*t[0]-i[1]*t[1],i[0]*t[1]+i[1]*t[0]]}function Ay(i,t){let e=[0,0];for(let n=i.length-1;n>=0;n-=1)e=IA(e,t),e[0]+=i[n];return e}const QA=(i,t,e,n)=>(s,r,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:h})=>{const u=gx(r,s.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),d=h instanceof Float64Array?h:new Float64Array(h),p=f.length,g=d.length,m=Math.min(p,g);if(p===0||p>20)throw n();if(f[0]===0)throw t();if(g===0||g>20)throw n();if(d[0]===0)throw t();if(f[0]!==1){for(let C=0;C<g;C+=1)d[C]/=f[0];for(let C=1;C<p;C+=1)f[C]/=f[0]}const O=e(s,u,o,o);O.channelCount=o,O.channelCountMode=a,O.channelInterpretation=l;const y=32,_=[],v=[],b=[];for(let C=0;C<o;C+=1){_.push(0);const I=new Float32Array(y),R=new Float32Array(y);I.fill(0),R.fill(0),v.push(I),b.push(R)}O.onaudioprocess=C=>{const I=C.inputBuffer,R=C.outputBuffer,$=I.numberOfChannels;for(let E=0;E<$;E+=1){const Z=I.getChannelData(E),F=R.getChannelData(E);_[E]=px(f,p,d,g,m,v[E],b[E],_[E],y,Z,F)}};const k=s.sampleRate/2;return cl({get bufferSize(){return u},get channelCount(){return O.channelCount},set channelCount(C){O.channelCount=C},get channelCountMode(){return O.channelCountMode},set channelCountMode(C){O.channelCountMode=C},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(C){O.channelInterpretation=C},get context(){return O.context},get inputs(){return[O]},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},addEventListener(...C){return O.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return O.dispatchEvent(C[0])},getFrequencyResponse(C,I,R){if(C.length!==I.length||I.length!==R.length)throw i();const $=C.length;for(let E=0;E<$;E+=1){const Z=-Math.PI*(C[E]/k),F=[Math.cos(Z),Math.sin(Z)],W=Ay(d,F),B=Ay(f,F),U=RA(W,B);I[E]=Math.sqrt(U[0]*U[0]+U[1]*U[1]),R[E]=Math.atan2(U[1],U[0])}},removeEventListener(...C){return O.removeEventListener(C[0],C[1],C[2])}},O)},NA=(i,t)=>i.createMediaElementSource(t.mediaElement),$A=(i,t)=>{const e=i.createMediaStreamDestination();return Xe(e,t),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e},DA=(i,{mediaStream:t})=>{const e=t.getAudioTracks();e.sort((r,o)=>r.id<o.id?-1:r.id>o.id?1:0);const n=e.slice(0,1),s=i.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(s,"mediaStream",{value:t}),s},LA=(i,t)=>(e,{mediaStreamTrack:n})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(n);const s=new MediaStream([n]),r=e.createMediaStreamSource(s);if(n.kind!=="audio")throw i();if(t(e))throw new TypeError;return r},VA=i=>i===null?null:i.hasOwnProperty("OfflineAudioContext")?i.OfflineAudioContext:i.hasOwnProperty("webkitOfflineAudioContext")?i.webkitOfflineAudioContext:null,BA=(i,t,e,n,s,r)=>(o,a)=>{const l=o.createOscillator();return Xe(l,a),ke(l,a,"detune"),ke(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):be(l,a,"type"),t(e,()=>e(o))||J0(l),t(n,()=>n(o))||r(l,o),t(s,()=>s(o))||tO(l),i(o,l),l},ZA=i=>(t,e)=>{const n=t.createPanner();return n.orientationX===void 0?i(t,e):(Xe(n,e),ke(n,e,"orientationX"),ke(n,e,"orientationY"),ke(n,e,"orientationZ"),ke(n,e,"positionX"),ke(n,e,"positionY"),ke(n,e,"positionZ"),be(n,e,"coneInnerAngle"),be(n,e,"coneOuterAngle"),be(n,e,"coneOuterGain"),be(n,e,"distanceModel"),be(n,e,"maxDistance"),be(n,e,"panningModel"),be(n,e,"refDistance"),be(n,e,"rolloffFactor"),n)},FA=(i,t,e,n,s,r,o,a,l,c)=>(h,{coneInnerAngle:u,coneOuterAngle:f,coneOuterGain:d,distanceModel:p,maxDistance:g,orientationX:m,orientationY:O,orientationZ:y,panningModel:_,positionX:v,positionY:b,positionZ:k,refDistance:x,rolloffFactor:C,...I})=>{const R=h.createPanner();if(I.channelCount>2||I.channelCountMode==="max")throw o();Xe(R,I);const $={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},E=e(h,{...$,channelInterpretation:"speakers",numberOfInputs:6}),Z=n(h,{...I,gain:1}),F=n(h,{...$,gain:1}),W=n(h,{...$,gain:0}),B=n(h,{...$,gain:0}),U=n(h,{...$,gain:0}),V=n(h,{...$,gain:0}),X=n(h,{...$,gain:0}),j=s(h,256,6,1),tt=r(h,{...$,curve:new Float32Array([1,1]),oversample:"none"});let it=[m,O,y],_t=[v,b,k];const Nt=new Float32Array(1);j.onaudioprocess=({inputBuffer:dt})=>{const Et=[l(dt,Nt,0),l(dt,Nt,1),l(dt,Nt,2)];Et.some((Wt,M)=>Wt!==it[M])&&(R.setOrientation(...Et),it=Et);const bt=[l(dt,Nt,3),l(dt,Nt,4),l(dt,Nt,5)];bt.some((Wt,M)=>Wt!==_t[M])&&(R.setPosition(...bt),_t=bt)},Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(B.gain,"defaultValue",{get:()=>0}),Object.defineProperty(U.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(X.gain,"defaultValue",{get:()=>0});const Ot={get bufferSize(){},get channelCount(){return R.channelCount},set channelCount(dt){if(dt>2)throw o();Z.channelCount=dt,R.channelCount=dt},get channelCountMode(){return R.channelCountMode},set channelCountMode(dt){if(dt==="max")throw o();Z.channelCountMode=dt,R.channelCountMode=dt},get channelInterpretation(){return R.channelInterpretation},set channelInterpretation(dt){Z.channelInterpretation=dt,R.channelInterpretation=dt},get coneInnerAngle(){return R.coneInnerAngle},set coneInnerAngle(dt){R.coneInnerAngle=dt},get coneOuterAngle(){return R.coneOuterAngle},set coneOuterAngle(dt){R.coneOuterAngle=dt},get coneOuterGain(){return R.coneOuterGain},set coneOuterGain(dt){if(dt<0||dt>1)throw t();R.coneOuterGain=dt},get context(){return R.context},get distanceModel(){return R.distanceModel},set distanceModel(dt){R.distanceModel=dt},get inputs(){return[Z]},get maxDistance(){return R.maxDistance},set maxDistance(dt){if(dt<0)throw new RangeError;R.maxDistance=dt},get numberOfInputs(){return R.numberOfInputs},get numberOfOutputs(){return R.numberOfOutputs},get orientationX(){return F.gain},get orientationY(){return W.gain},get orientationZ(){return B.gain},get panningModel(){return R.panningModel},set panningModel(dt){R.panningModel=dt},get positionX(){return U.gain},get positionY(){return V.gain},get positionZ(){return X.gain},get refDistance(){return R.refDistance},set refDistance(dt){if(dt<0)throw new RangeError;R.refDistance=dt},get rolloffFactor(){return R.rolloffFactor},set rolloffFactor(dt){if(dt<0)throw new RangeError;R.rolloffFactor=dt},addEventListener(...dt){return Z.addEventListener(dt[0],dt[1],dt[2])},dispatchEvent(...dt){return Z.dispatchEvent(dt[0])},removeEventListener(...dt){return Z.removeEventListener(dt[0],dt[1],dt[2])}};u!==Ot.coneInnerAngle&&(Ot.coneInnerAngle=u),f!==Ot.coneOuterAngle&&(Ot.coneOuterAngle=f),d!==Ot.coneOuterGain&&(Ot.coneOuterGain=d),p!==Ot.distanceModel&&(Ot.distanceModel=p),g!==Ot.maxDistance&&(Ot.maxDistance=g),m!==Ot.orientationX.value&&(Ot.orientationX.value=m),O!==Ot.orientationY.value&&(Ot.orientationY.value=O),y!==Ot.orientationZ.value&&(Ot.orientationZ.value=y),_!==Ot.panningModel&&(Ot.panningModel=_),v!==Ot.positionX.value&&(Ot.positionX.value=v),b!==Ot.positionY.value&&(Ot.positionY.value=b),k!==Ot.positionZ.value&&(Ot.positionZ.value=k),x!==Ot.refDistance&&(Ot.refDistance=x),C!==Ot.rolloffFactor&&(Ot.rolloffFactor=C),(it[0]!==1||it[1]!==0||it[2]!==0)&&R.setOrientation(...it),(_t[0]!==0||_t[1]!==0||_t[2]!==0)&&R.setPosition(..._t);const Mt=()=>{Z.connect(R),i(Z,tt,0,0),tt.connect(F).connect(E,0,0),tt.connect(W).connect(E,0,1),tt.connect(B).connect(E,0,2),tt.connect(U).connect(E,0,3),tt.connect(V).connect(E,0,4),tt.connect(X).connect(E,0,5),E.connect(j).connect(h.destination)},Yt=()=>{Z.disconnect(R),a(Z,tt,0,0),tt.disconnect(F),F.disconnect(E),tt.disconnect(W),W.disconnect(E),tt.disconnect(B),B.disconnect(E),tt.disconnect(U),U.disconnect(E),tt.disconnect(V),V.disconnect(E),tt.disconnect(X),X.disconnect(E),E.disconnect(j),j.disconnect(h.destination)};return c(cl(Ot,R),Mt,Yt)},WA=i=>(t,{disableNormalization:e,imag:n,real:s})=>{const r=n instanceof Float32Array?n:new Float32Array(n),o=s instanceof Float32Array?s:new Float32Array(s),a=t.createPeriodicWave(o,r,{disableNormalization:e});if(Array.from(n).length<2)throw i();return a},dh=(i,t,e,n)=>i.createScriptProcessor(t,e,n),qA=(i,t)=>(e,n)=>{const s=n.channelCountMode;if(s==="clamped-max")throw t();if(e.createStereoPanner===void 0)return i(e,n);const r=e.createStereoPanner();return Xe(r,n),ke(r,n,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>s,set:o=>{if(o!==s)throw t()}}),r},XA=(i,t,e,n,s,r)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...c,oversample:"none"},u=(p,g,m,O)=>{const y=new Float32Array(16385),_=new Float32Array(16385);for(let I=0;I<16385;I+=1){const R=I/16384*l;y[I]=Math.cos(R),_[I]=Math.sin(R)}const v=e(p,{...c,gain:0}),b=n(p,{...h,curve:y}),k=n(p,{...h,curve:a}),x=e(p,{...c,gain:0}),C=n(p,{...h,curve:_});return{connectGraph(){g.connect(v),g.connect(k.inputs===void 0?k:k.inputs[0]),g.connect(x),k.connect(m),m.connect(b.inputs===void 0?b:b.inputs[0]),m.connect(C.inputs===void 0?C:C.inputs[0]),b.connect(v.gain),C.connect(x.gain),v.connect(O,0,0),x.connect(O,0,1)},disconnectGraph(){g.disconnect(v),g.disconnect(k.inputs===void 0?k:k.inputs[0]),g.disconnect(x),k.disconnect(m),m.disconnect(b.inputs===void 0?b:b.inputs[0]),m.disconnect(C.inputs===void 0?C:C.inputs[0]),b.disconnect(v.gain),C.disconnect(x.gain),v.disconnect(O,0,0),x.disconnect(O,0,1)}}},f=(p,g,m,O)=>{const y=new Float32Array(16385),_=new Float32Array(16385),v=new Float32Array(16385),b=new Float32Array(16385),k=Math.floor(16385/2);for(let U=0;U<16385;U+=1)if(U>k){const V=(U-k)/(16384-k)*l;y[U]=Math.cos(V),_[U]=Math.sin(V),v[U]=0,b[U]=1}else{const V=U/(16384-k)*l;y[U]=1,_[U]=0,v[U]=Math.cos(V),b[U]=Math.sin(V)}const x=t(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),C=e(p,{...c,gain:0}),I=n(p,{...h,curve:y}),R=e(p,{...c,gain:0}),$=n(p,{...h,curve:_}),E=n(p,{...h,curve:a}),Z=e(p,{...c,gain:0}),F=n(p,{...h,curve:v}),W=e(p,{...c,gain:0}),B=n(p,{...h,curve:b});return{connectGraph(){g.connect(x),g.connect(E.inputs===void 0?E:E.inputs[0]),x.connect(C,0),x.connect(R,0),x.connect(Z,1),x.connect(W,1),E.connect(m),m.connect(I.inputs===void 0?I:I.inputs[0]),m.connect($.inputs===void 0?$:$.inputs[0]),m.connect(F.inputs===void 0?F:F.inputs[0]),m.connect(B.inputs===void 0?B:B.inputs[0]),I.connect(C.gain),$.connect(R.gain),F.connect(Z.gain),B.connect(W.gain),C.connect(O,0,0),Z.connect(O,0,0),R.connect(O,0,1),W.connect(O,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(E.inputs===void 0?E:E.inputs[0]),x.disconnect(C,0),x.disconnect(R,0),x.disconnect(Z,1),x.disconnect(W,1),E.disconnect(m),m.disconnect(I.inputs===void 0?I:I.inputs[0]),m.disconnect($.inputs===void 0?$:$.inputs[0]),m.disconnect(F.inputs===void 0?F:F.inputs[0]),m.disconnect(B.inputs===void 0?B:B.inputs[0]),I.disconnect(C.gain),$.disconnect(R.gain),F.disconnect(Z.gain),B.disconnect(W.gain),C.disconnect(O,0,0),Z.disconnect(O,0,0),R.disconnect(O,0,1),W.disconnect(O,0,1)}}},d=(p,g,m,O,y)=>{if(g===1)return u(p,m,O,y);if(g===2)return f(p,m,O,y);throw s()};return(p,{channelCount:g,channelCountMode:m,pan:O,...y})=>{if(m==="max")throw s();const _=i(p,{...y,channelCount:1,channelCountMode:m,numberOfInputs:2}),v=e(p,{...y,channelCount:g,channelCountMode:m,gain:1}),b=e(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:O});let{connectGraph:k,disconnectGraph:x}=d(p,g,v,b,_);Object.defineProperty(b.gain,"defaultValue",{get:()=>0}),Object.defineProperty(b.gain,"maxValue",{get:()=>1}),Object.defineProperty(b.gain,"minValue",{get:()=>-1});const C={get bufferSize(){},get channelCount(){return v.channelCount},set channelCount(E){v.channelCount!==E&&(I&&x(),{connectGraph:k,disconnectGraph:x}=d(p,E,v,b,_),I&&k()),v.channelCount=E},get channelCountMode(){return v.channelCountMode},set channelCountMode(E){if(E==="clamped-max"||E==="max")throw s();v.channelCountMode=E},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(E){v.channelInterpretation=E},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get pan(){return b.gain},addEventListener(...E){return v.addEventListener(E[0],E[1],E[2])},dispatchEvent(...E){return v.dispatchEvent(E[0])},removeEventListener(...E){return v.removeEventListener(E[0],E[1],E[2])}};let I=!1;const R=()=>{k(),I=!0},$=()=>{x(),I=!1};return r(cl(C,_),R,$)}},zA=(i,t,e,n,s,r,o)=>(a,l)=>{const c=a.createWaveShaper();if(r!==null&&r.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return e(a,l);Xe(c,l);const h=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(h!==null&&h.length<2)throw t();be(c,{curve:h},"curve"),be(c,l,"oversample");let u=null,f=!1;return o(c,"curve",g=>()=>g.call(c),g=>m=>(g.call(c,m),f&&(n(m)&&u===null?u=i(a,c):!n(m)&&u!==null&&(u(),u=null)),m)),s(c,()=>{f=!0,n(c.curve)&&(u=i(a,c))},()=>{f=!1,u!==null&&(u(),u=null)})},GA=(i,t,e,n,s)=>(r,{curve:o,oversample:a,...l})=>{const c=r.createWaveShaper(),h=r.createWaveShaper();Xe(c,l),Xe(h,l);const u=e(r,{...l,gain:1}),f=e(r,{...l,gain:-1}),d=e(r,{...l,gain:1}),p=e(r,{...l,gain:-1});let g=null,m=!1,O=null;const y={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(b){u.channelCount=b,f.channelCount=b,c.channelCount=b,d.channelCount=b,h.channelCount=b,p.channelCount=b},get channelCountMode(){return c.channelCountMode},set channelCountMode(b){u.channelCountMode=b,f.channelCountMode=b,c.channelCountMode=b,d.channelCountMode=b,h.channelCountMode=b,p.channelCountMode=b},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(b){u.channelInterpretation=b,f.channelInterpretation=b,c.channelInterpretation=b,d.channelInterpretation=b,h.channelInterpretation=b,p.channelInterpretation=b},get context(){return c.context},get curve(){return O},set curve(b){if(b!==null&&b.length<2)throw t();if(b===null)c.curve=b,h.curve=b;else{const k=b.length,x=new Float32Array(k+2-k%2),C=new Float32Array(k+2-k%2);x[0]=b[0],C[0]=-b[k-1];const I=Math.ceil((k+1)/2),R=(k+1)/2-1;for(let $=1;$<I;$+=1){const E=$/I*R,Z=Math.floor(E),F=Math.ceil(E);x[$]=Z===F?b[Z]:(1-(E-Z))*b[Z]+(1-(F-E))*b[F],C[$]=Z===F?-b[k-1-Z]:-((1-(E-Z))*b[k-1-Z])-(1-(F-E))*b[k-1-F]}x[I]=k%2===1?b[I-1]:(b[I-2]+b[I-1])/2,c.curve=x,h.curve=C}O=b,m&&(n(O)&&g===null?g=i(r,u):g!==null&&(g(),g=null))},get inputs(){return[u]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(b){c.oversample=b,h.oversample=b},addEventListener(...b){return u.addEventListener(b[0],b[1],b[2])},dispatchEvent(...b){return u.dispatchEvent(b[0])},removeEventListener(...b){return u.removeEventListener(b[0],b[1],b[2])}};o!==null&&(y.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==y.oversample&&(y.oversample=a);const _=()=>{u.connect(c).connect(d),u.connect(f).connect(h).connect(p).connect(d),m=!0,n(O)&&(g=i(r,u))},v=()=>{u.disconnect(c),c.disconnect(d),u.disconnect(f),f.disconnect(h),h.disconnect(p),p.disconnect(d),m=!1,g!==null&&(g(),g=null)};return s(cl(y,d),_,v)},Ei=()=>new DOMException("","NotSupportedError"),jA={numberOfChannels:1},UA=(i,t,e,n,s)=>class extends i{constructor(o,a,l){let c;if(typeof o=="number"&&a!==void 0&&l!==void 0)c={length:a,numberOfChannels:o,sampleRate:l};else if(typeof o=="object")c=o;else throw new Error("The given parameters are not valid.");const{length:h,numberOfChannels:u,sampleRate:f}={...jA,...c},d=n(u,h,f);t($c,()=>$c(d))||d.addEventListener("statechange",(()=>{let p=0;const g=m=>{this._state==="running"&&(p>0?(d.removeEventListener("statechange",g),m.stopImmediatePropagation(),this._waitForThePromiseToSettle(m)):p+=1)};return g})()),super(d,u),this._length=h,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,lx(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},YA={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},HA=(i,t,e,n,s,r,o)=>class extends i{constructor(l,c){const h=s(l),u={...YA,...c},f=e(h,u),d=r(h),p=d?n():null,g=l.sampleRate/2;super(l,!1,f,p),this._detune=t(this,d,f.detune,153600,-153600),this._frequency=t(this,d,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&u.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=u.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?o(this,l):null;this._nativeOscillatorNode.onended=c;const h=this._nativeOscillatorNode.onended;this._onended=h!==null&&h===c?l:h}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Wa(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),zs(this)&&ch(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},KA=(i,t,e,n,s)=>()=>{const r=new WeakMap;let o=null,a=null,l=null;const c=async(h,u)=>{let f=e(h);const d=yi(f,u);if(!d){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=t(u,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return r.set(u,f),d?(await i(u,h.detune,f.detune),await i(u,h.frequency,f.frequency)):(await n(u,h.detune,f.detune),await n(u,h.frequency,f.frequency)),await s(h,u,f),f};return{set periodicWave(h){o=h},set start(h){a=h},set stop(h){l=h},render(h,u){const f=r.get(u);return f!==void 0?Promise.resolve(f):c(h,u)}}},JA={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},t8=(i,t,e,n,s,r,o)=>class extends i{constructor(l,c){const h=s(l),u={...JA,...c},f=e(h,u),d=r(h),p=d?n():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=t(this,d,f.orientationX,ki,Vi),this._orientationY=t(this,d,f.orientationY,ki,Vi),this._orientationZ=t(this,d,f.orientationZ,ki,Vi),this._positionX=t(this,d,f.positionX,ki,Vi),this._positionY=t(this,d,f.positionY,ki,Vi),this._positionZ=t(this,d,f.positionZ,ki,Vi),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},e8=(i,t,e,n,s,r,o,a,l,c)=>()=>{const h=new WeakMap;let u=null;const f=async(d,p)=>{let g=null,m=r(d);const O={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},y={...O,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},_=yi(m,p);if("bufferSize"in m)g=n(p,{...O,gain:1});else if(!_){const v={...y,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=s(p,v)}if(h.set(p,g===null?m:g),g!==null){if(u===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const $=new o(6,d.context.length,p.sampleRate),E=t($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});E.connect($.destination),u=(async()=>{const Z=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(F,W)=>{const B=e($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W===0?1:0});return await a($,F,B.offset),B}));for(let F=0;F<6;F+=1)Z[F].connect(E,0,F),Z[F].start(0);return c($)})()}const v=await u,b=n(p,{...O,gain:1});await l(d,p,b);const k=[];for(let $=0;$<v.numberOfChannels;$+=1)k.push(v.getChannelData($));let x=[k[0][0],k[1][0],k[2][0]],C=[k[3][0],k[4][0],k[5][0]],I=n(p,{...O,gain:1}),R=s(p,{...y,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:C[0],positionY:C[1],positionZ:C[2]});b.connect(I).connect(R.inputs[0]),R.connect(g);for(let $=128;$<v.length;$+=128){const E=[k[0][$],k[1][$],k[2][$]],Z=[k[3][$],k[4][$],k[5][$]];if(E.some((F,W)=>F!==x[W])||Z.some((F,W)=>F!==C[W])){x=E,C=Z;const F=$/p.sampleRate;I.gain.setValueAtTime(0,F),I=n(p,{...O,gain:0}),R=s(p,{...y,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:C[0],positionY:C[1],positionZ:C[2]}),I.gain.setValueAtTime(1,F),b.connect(I).connect(R.inputs[0]),R.connect(g)}}return g}return _?(await i(p,d.orientationX,m.orientationX),await i(p,d.orientationY,m.orientationY),await i(p,d.orientationZ,m.orientationZ),await i(p,d.positionX,m.positionX),await i(p,d.positionY,m.positionY),await i(p,d.positionZ,m.positionZ)):(await a(p,d.orientationX,m.orientationX),await a(p,d.orientationY,m.orientationY),await a(p,d.orientationZ,m.orientationZ),await a(p,d.positionX,m.positionX),await a(p,d.positionY,m.positionY),await a(p,d.positionZ,m.positionZ)),ll(m)?await l(d,p,m.inputs[0]):await l(d,p,m),m};return{render(d,p){const g=h.get(p);return g!==void 0?Promise.resolve(g):f(d,p)}}},i8={disableNormalization:!1},n8=(i,t,e,n)=>class yx{constructor(r,o){const a=t(r),l=n({...i8,...o}),c=i(a,l);return e.add(c),c}static[Symbol.hasInstance](r){return r!==null&&typeof r=="object"&&Object.getPrototypeOf(r)===yx.prototype||e.has(r)}},s8=(i,t)=>(e,n,s)=>(i(n).replay(s),t(n,e,s)),r8=(i,t,e)=>async(n,s,r)=>{const o=i(n);await Promise.all(o.activeInputs.map((a,l)=>Array.from(a).map(async([c,h])=>{const f=await t(c).render(c,s),d=n.context.destination;!e(c)&&(n!==d||!e(n))&&f.connect(r,h,l)})).reduce((a,l)=>[...a,...l],[]))},o8=(i,t,e)=>async(n,s,r)=>{const o=t(n);await Promise.all(Array.from(o.activeInputs).map(async([a,l])=>{const h=await i(a).render(a,s);e(a)||h.connect(r,l)}))},a8=(i,t,e,n)=>s=>i($c,()=>$c(s))?Promise.resolve(i(n,n)).then(r=>{if(!r){const o=e(s,512,0,1);s.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>s.currentTime,o.connect(s.destination)}return s.startRendering()}):new Promise(r=>{const o=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=a=>{o.disconnect(),r(a.renderedBuffer)},o.connect(s.destination),s.startRendering()}),l8=i=>(t,e)=>{i.set(t,e)},c8=i=>(t,e)=>i.set(t,e),h8=(i,t,e,n,s,r,o,a)=>(l,c)=>e(l).render(l,c).then(()=>Promise.all(Array.from(n(c)).map(h=>e(h).render(h,c)))).then(()=>s(c)).then(h=>(typeof h.copyFromChannel!="function"?(o(h),Y0(h)):t(r,()=>r(h))||a(h),i.add(h),h)),u8={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},f8=(i,t,e,n,s,r)=>class extends i{constructor(a,l){const c=s(a),h={...u8,...l},u=e(c,h),f=r(c),d=f?n():null;super(a,!1,u,d),this._pan=t(this,f,u.pan)}get pan(){return this._pan}},d8=(i,t,e,n,s)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=t(l,u)}return r.set(l,c),h?await i(l,a.pan,c.pan):await n(l,a.pan,c.pan),ll(c)?await s(a,l,c.inputs[0]):await s(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},p8=i=>()=>{if(i===null)return!1;try{new i({length:1,sampleRate:44100})}catch{return!1}return!0},g8=(i,t)=>async()=>{if(i===null)return!0;if(t===null)return!1;const e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new t(1,128,44100),s=URL.createObjectURL(e);let r=!1,o=!1;try{await n.audioWorklet.addModule(s);const a=new i(n,"a",{numberOfOutputs:0}),l=n.createOscillator();a.port.onmessage=()=>r=!0,a.onprocessorerror=()=>o=!0,l.connect(a),l.start(0),await n.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(s)}return r&&!o},m8=(i,t)=>()=>{if(t===null)return Promise.resolve(!1);const e=new t(1,1,44100),n=i(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{e.oncomplete=()=>{n.disconnect(),s(e.currentTime!==0)},e.startRendering()})},O8=()=>new DOMException("","UnknownError"),y8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},b8=(i,t,e,n,s,r,o)=>class extends i{constructor(l,c){const h=s(l),u={...y8,...c},f=e(h,u),p=r(h)?n():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},v8=(i,t,e)=>()=>{const n=new WeakMap,s=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=i(o,c)}return n.set(o,a),ll(a)?await e(r,o,a.inputs[0]):await e(r,o,a),a};return{render(r,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(r,o)}}},_8=()=>typeof window>"u"?null:window,x8=(i,t)=>e=>{e.copyFromChannel=(n,s,r=0)=>{const o=i(r),a=i(s);if(a>=e.numberOfChannels)throw t();const l=e.length,c=e.getChannelData(a),h=n.length;for(let u=o<0?-o:0;u+o<l&&u<h;u+=1)n[u]=c[u+o]},e.copyToChannel=(n,s,r=0)=>{const o=i(r),a=i(s);if(a>=e.numberOfChannels)throw t();const l=e.length,c=e.getChannelData(a),h=n.length;for(let u=o<0?-o:0;u+o<l&&u<h;u+=1)c[u+o]=n[u]}},S8=i=>t=>{t.copyFromChannel=(e=>(n,s,r=0)=>{const o=i(r),a=i(s);if(o<t.length)return e.call(t,n,a,o)})(t.copyFromChannel),t.copyToChannel=(e=>(n,s,r=0)=>{const o=i(r),a=i(s);if(o<t.length)return e.call(t,n,a,o)})(t.copyToChannel)},w8=i=>(t,e)=>{const n=e.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=n),i(t,"buffer",s=>()=>{const r=s.call(t);return r===n?null:r},s=>r=>s.call(t,r===null?n:r))},k8=(i,t)=>(e,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw i()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw i()}});const s=e.createBufferSource();t(n,()=>{const a=n.numberOfInputs;for(let l=0;l<a;l+=1)s.connect(n,0,l)},()=>s.disconnect(n))},bx=(i,t,e)=>i.copyFromChannel===void 0?i.getChannelData(e)[0]:(i.copyFromChannel(t,e),t[0]),vx=i=>{if(i===null)return!1;const t=i.length;return t%2!==0?i[Math.floor(t/2)]!==0:i[t/2-1]+i[t/2]!==0},ph=(i,t,e,n)=>{let s=i;for(;!s.hasOwnProperty(t);)s=Object.getPrototypeOf(s);const{get:r,set:o}=Object.getOwnPropertyDescriptor(s,t);Object.defineProperty(i,t,{get:e(r),set:n(o)})},C8=i=>({...i,outputChannelCount:i.outputChannelCount!==void 0?i.outputChannelCount:i.numberOfInputs===1&&i.numberOfOutputs===1?[i.channelCount]:Array.from({length:i.numberOfOutputs},()=>1)}),T8=i=>({...i,channelCount:i.numberOfOutputs}),P8=i=>{const{imag:t,real:e}=i;return t===void 0?e===void 0?{...i,imag:[0,0],real:[0,0]}:{...i,imag:Array.from(e,()=>0),real:e}:e===void 0?{...i,imag:t,real:Array.from(t,()=>0)}:{...i,imag:t,real:e}},_x=(i,t,e)=>{try{i.setValueAtTime(t,e)}catch(n){if(n.code!==9)throw n;_x(i,t,e+1e-7)}},A8=i=>{const t=i.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},M8=i=>{const t=i.createBufferSource(),e=i.createBuffer(1,1,44100);t.buffer=e;try{t.start(0,1)}catch{return!1}return!0},E8=i=>{const t=i.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},eO=i=>{const t=i.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},xx=i=>{const t=i.createBuffer(1,1,44100),e=i.createBufferSource();e.buffer=t,e.start(),e.stop();try{return e.stop(),!0}catch{return!1}},iO=i=>{const t=i.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},R8=i=>{const{port1:t,port2:e}=new MessageChannel;try{t.postMessage(i)}finally{t.close(),e.close()}},I8=i=>{i.start=(t=>(e=0,n=0,s)=>{const r=i.buffer,o=r===null?n:Math.min(r.duration,n);r!==null&&o>r.duration-.5/i.context.sampleRate?t.call(i,e,0,0):t.call(i,e,o,s)})(i.start)},Sx=(i,t)=>{const e=t.createGain();i.connect(e);const n=(s=>()=>{s.call(i,e),i.removeEventListener("ended",n)})(i.disconnect);i.addEventListener("ended",n),cl(i,e),i.stop=(s=>{let r=!1;return(o=0)=>{if(r)try{s.call(i,o)}catch{e.gain.setValueAtTime(0,o)}else s.call(i,o),r=!0}})(i.stop)},hl=(i,t)=>e=>{const n={value:i};return Object.defineProperties(e,{currentTarget:n,target:n}),typeof t=="function"?t.call(i,e):t.handleEvent.call(i,e)},Q8=t4(qo),N8=o4(qo),$8=y6(Qd),wx=new WeakMap,D8=$6(wx),qn=j4(new Map,new WeakMap),xs=_8(),kx=fA(qn,Cs),nO=N6(Pi),ri=r8(Pi,nO,No),L8=u4(kx,me,ri),fe=V6(Id),nr=VA(xs),te=iA(nr),Cx=new WeakMap,Tx=P6(hl),gh=mA(xs),sO=K6(gh),rO=J6(xs),Px=tA(xs),Dc=yA(xs),Me=$4(e4(ex),r4(Q8,N8,Ef,$8,Rf,Pi,D8,lh,me,qo,zs,No,Ju),qn,G6(Ug,Rf,Pi,me,Nc,zs),Cs,Nd,Ei,p6(Ef,Ug,Pi,me,Nc,fe,zs,te),_6(Cx,Pi,Zn),Tx,fe,sO,rO,Px,te,Dc),V8=h4(Me,L8,Cs,kx,fe,te),oO=new WeakSet,My=dA(xs),Ax=a6(new Uint32Array(1)),aO=x8(Ax,Cs),lO=S8(Ax),Mx=d4(oO,qn,Ei,My,nr,p8(My),aO,lO),$d=a4(ji),Ex=o8(nO,hh,No),Ts=e6(Ex),ul=gA($d,qn,A8,M8,E8,eO,xx,iO,I8,w8(ph),Sx),Ps=s8(D6(hh),Ex),B8=m4(Ts,ul,me,Ps,ri),Xn=D4(i4(ix),Cx,U0,L4,jP,UP,YP,HP,KP,zg,J_,gh,_x),Z8=g4(Me,B8,Xn,Ye,ul,fe,te,hl),F8=k4(Me,C4,Cs,Ye,OA(ji,ph),fe,te,ri),W8=G4(Ts,mx,me,Ps,ri),Xo=c8(wx),q8=z4(Me,Xn,W8,Nd,mx,fe,te,Xo),Ur=hA(qo,rO),X8=k8(Ye,Ur),Yr=kA(gh,X8),z8=H4(Yr,me,ri),G8=Y4(Me,z8,Yr,fe,te),j8=t6(fh,me,ri),U8=J4(Me,j8,fh,fe,te,T8),Y8=PA($d,ul,ji,Ur),fl=TA($d,qn,Y8,eO,iO),H8=o6(Ts,fl,me,Ps,ri),K8=r6(Me,Xn,H8,fl,fe,te,hl),Rx=AA(Ei,ph),J8=h6(Rx,me,ri),t9=c6(Me,J8,Rx,fe,te,Xo),e9=O6(Ts,Ox,me,Ps,ri),i9=m6(Me,Xn,e9,Ox,fe,te,Xo),Ix=MA(Ei),n9=k6(Ts,Ix,me,Ps,ri),s9=w6(Me,Xn,n9,Ix,Ei,fe,te,Xo),r9=I6(Ts,ji,me,Ps,ri),o9=R6(Me,Xn,r9,ji,fe,te),a9=QA(Nd,Ye,dh,Ei),Dd=a8(qn,ji,dh,m8(ji,nr)),l9=z6(ul,me,nr,ri,Dd),c9=EA(a9),h9=q6(Me,c9,l9,fe,te,Xo),u9=T4(Xn,Yr,fl,dh,Ei,bx,te,ph),Qx=new WeakMap,f9=cA(F8,u9,Tx,te,Qx,hl),Nx=BA($d,qn,eO,xx,iO,Sx),d9=KA(Ts,Nx,me,Ps,ri),p9=HA(Me,Xn,Nx,d9,fe,te,hl),$x=n6(ul),g9=GA($x,Ye,ji,vx,Ur),Ld=zA($x,Ye,g9,vx,Ur,gh,ph),m9=FA(Ef,Ye,Yr,ji,dh,Ld,Ei,Rf,bx,Ur),Dx=ZA(m9),O9=e8(Ts,Yr,fl,ji,Dx,me,nr,Ps,ri,Dd),y9=t8(Me,Xn,Dx,O9,fe,te,Xo),b9=WA(Cs),v9=n8(b9,fe,new WeakSet,P8),_9=XA(Yr,fh,ji,Ld,Ei,Ur),Lx=qA(_9,Ei),x9=d8(Ts,Lx,me,Ps,ri),S9=f8(Me,Xn,Lx,x9,fe,te),w9=v8(Ld,me,ri),k9=b8(Me,Ye,Ld,w9,fe,te,Xo),Vx=nA(xs),cO=A6(xs),Bx=new WeakMap,C9=B6(Bx,nr),T9=Vx?s4(qn,Ei,T6(xs),cO,M6(JP),fe,C9,te,Dc,new WeakMap,new WeakMap,g8(Dc,nr),xs):void 0,P9=eA(sO,te),A9=d6(oO,qn,f6,C6,new WeakSet,fe,P9,Af,$c,aO,lO),Zx=q4(T9,V8,Mx,Z8,q8,G8,U8,K8,t9,A9,i9,s9,o9,h9,f9,p9,y9,v9,S9,k9),M9=sA(Me,NA,fe,te),E9=oA(Me,$A,fe,te),R9=aA(Me,DA,fe,te),I9=LA(Ye,te),Q9=lA(Me,I9,fe),N9=w4(Zx,Ye,Ei,O8,M9,E9,R9,Q9,gh),hO=Z6(Qx),$9=l4(hO),Fx=i6(Cs),D9=b6(hO),Wx=x6(Cs),qx=new WeakMap,L9=Q6(qx,Zn),V9=wA(Fx,Cs,Ye,Yr,fh,fl,ji,dh,Ei,Wx,cO,L9,Ur),B9=vA(Ye,V9,ji,Ei,Ur),Z9=W4(Ts,Fx,ul,Yr,fh,fl,ji,D9,Wx,cO,me,Dc,nr,Ps,ri,Dd),F9=L6(Bx),W9=l8(qx),Ey=Vx?B4($9,Me,Xn,Z9,B9,Pi,F9,fe,te,Dc,C8,W9,R8,hl):void 0,q9=u6(Ei,nr),X9=h8(oO,qn,nO,hO,Dd,Af,aO,lO),z9=UA(Zx,qn,Ye,q9,X9),G9=j6(Id,sO),j9=U6(j0,rO),U9=Y6(U0,Px),Y9=H6(Id,te);function hn(i){return i===void 0}function Rt(i){return i!==void 0}function H9(i){return typeof i=="function"}function Ss(i){return typeof i=="number"}function Ir(i){return Object.prototype.toString.call(i)==="[object Object]"&&i.constructor===Object}function Xx(i){return typeof i=="boolean"}function zi(i){return Array.isArray(i)}function Ys(i){return typeof i=="string"}function Uh(i){return Ys(i)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(i)}function wt(i,t){if(!i)throw new Error(t)}function Br(i,t,e=1/0){if(!(t<=i&&i<=e))throw new RangeError(`Value must be within [${t}, ${e}], got: ${i}`)}function zx(i){!i.isOffline&&i.state!=="running"&&Vd('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Gx=!1,Ry=!1;function Iy(i){Gx=i}function K9(i){hn(i)&&Gx&&!Ry&&(Ry=!0,Vd("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let jx=console;function J9(...i){jx.log(...i)}function Vd(...i){jx.warn(...i)}function t7(i){return new N9(i)}function e7(i,t,e){return new z9(i,t,e)}const on=typeof self=="object"?self:null,i7=on&&(on.hasOwnProperty("AudioContext")||on.hasOwnProperty("webkitAudioContext"));function n7(i,t,e){return wt(Rt(Ey),"AudioWorkletNode only works in a secure context (https or localhost)"),new(i instanceof on?.BaseAudioContext?on?.AudioWorkletNode:Ey)(i,t,e)}function zn(i,t,e,n){var s=arguments.length,r=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,n);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(s<3?o(r):s>3?o(t,e,r):o(t,e))||r);return s>3&&r&&Object.defineProperty(t,e,r),r}function Ne(i,t,e,n){function s(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(h){try{c(n.next(h))}catch(u){o(u)}}function l(h){try{c(n.throw(h))}catch(u){o(u)}}function c(h){h.done?r(h.value):s(h.value).then(a,l)}c((n=n.apply(i,t||[])).next())})}class s7{constructor(t,e,n,s){this._callback=t,this._type=e,this._minimumUpdateInterval=Math.max(128/(s||44100),.001),this.updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){var e;this._updateInterval=Math.max(t,this._minimumUpdateInterval),this._type==="worker"&&((e=this._worker)===null||e===void 0||e.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function $o(i){return U9(i)}function Qr(i){return j9(i)}function tf(i){return Y9(i)}function ha(i){return G9(i)}function r7(i){return i instanceof Mx}function o7(i,t){return i==="value"||$o(t)||Qr(t)||r7(t)}function Co(i,...t){if(!t.length)return i;const e=t.shift();if(Ir(i)&&Ir(e))for(const n in e)o7(n,e[n])?i[n]=e[n]:Ir(e[n])?(i[n]||Object.assign(i,{[n]:{}}),Co(i[n],e[n])):Object.assign(i,{[n]:e[n]});return Co(i,...t)}function a7(i,t){return i.length===t.length&&i.every((e,n)=>t[n]===e)}function Tt(i,t,e=[],n){const s={},r=Array.from(t);if(Ir(r[0])&&n&&!Reflect.has(r[0],n)&&(Object.keys(r[0]).some(a=>Reflect.has(i,a))||(Co(s,{[n]:r[0]}),e.splice(e.indexOf(n),1),r.shift())),r.length===1&&Ir(r[0]))Co(s,r[0]);else for(let o=0;o<e.length;o++)Rt(r[o])&&(s[e[o]]=r[o]);return Co(i,s)}function l7(i){return i.constructor.getDefaults()}function ys(i,t){return hn(i)?t:i}function tm(i,t){return t.forEach(e=>{Reflect.has(i,e)&&delete i[e]}),i}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class sr{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||on&&this.toString()===on.TONE_DEBUG_CLASS)&&J9(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}sr.version=K_;const uO=1e-6;function qa(i,t){return i>t+uO}function em(i,t){return qa(i,t)||Qn(i,t)}function $f(i,t){return i+uO<t}function Qn(i,t){return Math.abs(i-t)<uO}function c7(i,t,e){return Math.max(Math.min(i,e),t)}class Cn extends sr{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Tt(Cn.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(wt(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];wt(em(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(t){const e=this._timeline.indexOf(t);return e!==-1&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Qn(this._timeline[e].time,t)){for(let n=e;n>=0&&Qn(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else this._timeline.length===1&&em(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(this._timeline.length===0)return-1;let n=0;const s=this._timeline.length;let r=s;if(s>0&&this._timeline[s-1][e]<=t)return s-1;for(;n<r;){let o=Math.floor(n+(r-n)/2);const a=this._timeline[o],l=this._timeline[o+1];if(Qn(a[e],t)){for(let c=o;c<this._timeline.length;c++){const h=this._timeline[c];if(Qn(h[e],t))o=c;else break}return o}else{if($f(a[e],t)&&qa(l[e],t))return o;qa(a[e],t)?r=o:n=o+1}}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return n!==-1&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let s=this._search(t),r=this._search(e);return s!==-1&&r!==-1?(this._timeline[s].time!==t&&(s+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,s,r)):s===-1&&this._iterate(n,0,r),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(n!==-1&&Qn(this._timeline[n].time,t)){let s=n;for(let r=n;r>=0&&Qn(this._timeline[r].time,t);r--)s=r;this._iterate(r=>{e(r)},s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Ux=[];function Bd(i){Ux.push(i)}function h7(i){Ux.forEach(t=>t(i))}const Yx=[];function Zd(i){Yx.push(i)}function u7(i){Yx.forEach(t=>t(i))}class mh extends sr{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(s=>{hn(this._events)&&(this._events={}),this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(e)}),this}once(t,e){const n=(...s)=>{e(...s),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach(s=>{if(hn(this._events)&&(this._events={}),this._events.hasOwnProperty(s))if(hn(e))this._events[s]=[];else{const r=this._events[s];for(let o=r.length-1;o>=0;o--)r[o]===e&&r.splice(o,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let s=0,r=n.length;s<r;s++)n[s].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const n=Object.getOwnPropertyDescriptor(mh.prototype,e);Object.defineProperty(t.prototype,e,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class Hx extends mh{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}let fO=class Kx extends Hx{constructor(){var t,e;super(),this.name="Context",this._constants=new Map,this._timeouts=new Cn,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const n=Tt(Kx.getDefaults(),arguments,["context"]);n.context?(this._context=n.context,this._latencyHint=((t=arguments[0])===null||t===void 0?void 0:t.latencyHint)||""):(this._context=t7({latencyHint:n.latencyHint}),this._latencyHint=n.latencyHint),this._ticker=new s7(this.emit.bind(this,"tick"),n.clockSource,n.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((e=arguments[0])===null||e===void 0)&&e.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=n.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(h7(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return wt(ha(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return wt(ha(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return wt(ha(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){wt(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){wt(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){wt(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){wt(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return n7(this.rawContext,t,e)}addAudioWorkletModule(t){return Ne(this,void 0,void 0,function*(){wt(Rt(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(t)),yield this._workletPromise})}workletsAreReady(){return Ne(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get lookAhead(){return this._lookAhead}set lookAhead(t){this._lookAhead=t,this.updateInterval=t?t/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return ha(this._context)?this._context.resume():Promise.resolve()}close(){return Ne(this,void 0,void 0,function*(){ha(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&u7(this)})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let r=0;r<n.length;r++)n[r]=t;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=e,s.loop=!0,s.start(0),this._constants.set(t,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this.close(),this}_timeoutLoop(){const t=this.now();this._timeouts.forEachBefore(t,e=>{e.callback(),this._timeouts.remove(e)})}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,s=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),s()},id:n,time:r+e})};return s(),n}};class f7 extends Hx{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t){return Ne(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}}function Ce(i,t){zi(t)?t.forEach(e=>Ce(i,e)):Object.defineProperty(i,t,{enumerable:!0,writable:!1})}function Jx(i,t){zi(t)?t.forEach(e=>Jx(i,e)):Object.defineProperty(i,t,{writable:!0})}const Kt=()=>{};class ye extends sr{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Kt;const t=Tt(ye.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,Ys(t.url)?this.load(t.url).catch(t.onerror):t.url&&this.set(t.url)}static getDefaults(){return{onerror:Kt,onload:Kt,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:_n().sampleRate}set(t){return t instanceof ye?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Ne(this,void 0,void 0,function*(){const e=ye.load(t).then(n=>{this.set(n),this.onload(this)});ye.downloads.push(e);try{yield e}finally{const n=ye.downloads.indexOf(e);ye.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=zi(t)&&t[0].length>0,n=e?t.length:1,s=e?t[0].length:t.length,r=_n(),o=r.createBuffer(n,s,r.sampleRate),a=!e&&n===1?[t]:t;for(let l=0;l<n;l++)o.copyToChannel(a[l],l);return this._buffer=o,this}toMono(t){if(Ss(t))this.fromArray(this.toArray(t));else{let e=new Float32Array(this.length);const n=this.numberOfChannels;for(let s=0;s<n;s++){const r=this.toArray(s);for(let o=0;o<r.length;o++)e[o]+=r[o]}e=e.map(s=>s/n),this.fromArray(e)}return this}toArray(t){if(Ss(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{const e=[];for(let n=0;n<this.numberOfChannels;n++)e[n]=this.getChannelData(n);return e}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){wt(this.loaded,"Buffer is not loaded");const n=Math.floor(t*this.sampleRate),s=Math.floor(e*this.sampleRate);wt(n<s,"The start time must be less than the end time");const r=s-n,o=_n().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(n,s),a);return new ye(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new ye().fromArray(t)}static fromUrl(t){return Ne(this,void 0,void 0,function*(){return yield new ye().load(t)})}static load(t){return Ne(this,void 0,void 0,function*(){const e=ye.baseUrl===""||ye.baseUrl.endsWith("/")?ye.baseUrl:ye.baseUrl+"/",n=yield fetch(e+t);if(!n.ok)throw new Error(`could not load url: ${t}`);const s=yield n.arrayBuffer();return yield _n().decodeAudioData(s)})}static supportsType(t){const e=t.split("."),n=e[e.length-1];return document.createElement("audio").canPlayType("audio/"+n)!==""}static loaded(){return Ne(this,void 0,void 0,function*(){for(yield Promise.resolve();ye.downloads.length;)yield ye.downloads[0]})}}ye.baseUrl="";ye.downloads=[];class dO extends fO{constructor(){super({clockSource:"offline",context:tf(arguments[0])?arguments[0]:e7(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:tf(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=tf(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Ne(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n===0&&(yield new Promise(s=>setTimeout(s,1)))}})}render(){return Ne(this,arguments,void 0,function*(t=!0){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new ye(e)})}close(){return Promise.resolve()}}const tS=new f7;let bo=tS;function _n(){return bo===tS&&i7&&d7(new fO),bo}function d7(i,t=!1){t&&bo.dispose(),ha(i)?bo=new fO(i):tf(i)?bo=new dO(i):bo=i}function p7(){return bo.resume()}if(on&&!on.TONE_SILENCE_LOGGING){const t=` * Tone.js v${K_} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function g7(i){return Math.pow(10,i/20)}function m7(i){return 20*(Math.log(i)/Math.LN10)}function eS(i){return Math.pow(2,i/12)}let Fd=440;function O7(){return Fd}function y7(i){Fd=i}function vo(i){return Math.round(iS(i))}function iS(i){return 69+12*Math.log2(i/Fd)}function nS(i){return Fd*Math.pow(2,(i-69)/12)}class pO extends sr{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),s=e==="."?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(Math.floor(e)*3))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let s=0;return t&&t!=="0"&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(s+=this._beatsToUnits(parseFloat(e))),n&&n!=="0"&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof pO&&this.fromType(this._val),hn(this._val))return this._noArg();if(Ys(this._val)&&hn(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Ir(this._val)){let t=0;for(const e in this._val)if(Rt(this._val[e])){const n=this._val[e],s=new this.constructor(this.context,e).valueOf()*n;t+=s}return t}if(Rt(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}else return Ys(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class Nn extends pO{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Nn(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),s=this.valueOf(),a=Math.round(s/n)*n-s;return s+a*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let r=1;r<9;r++){const o=Math.pow(2,r);e.push(o+"n."),e.push(o+"n"),e.push(o+"t")}e.push("0");let n=e[0],s=new Nn(this.context,e[0]).toSeconds();return e.forEach(r=>{const o=new Nn(this.context,r).toSeconds();Math.abs(o-t)<Math.abs(s-t)&&(n=r,s=o)}),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let s=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=s.toString();return r.length>3&&(s=parseFloat(parseFloat(r).toFixed(3))),[n,e,s].join(":")}toTicks(){const t=this._beatsToUnits(1);return this.valueOf()/t*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return vo(this.toFrequency())}_now(){return this.context.now()}}class Wi extends Nn{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return O7()}static set A4(t){y7(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return this.defaultUnits==="midi"?t:Wi.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(t,e){const s=b7[t.toLowerCase()]+(parseInt(e,10)+1)*12;return this.defaultUnits==="midi"?s:Wi.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let s=1;return t&&t!=="0"&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(s*=this._beatsToUnits(parseFloat(e))),n&&n!=="0"&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(t){return new Wi(this.context,this.valueOf()*eS(t))}harmonize(t){return t.map(e=>this.transpose(e))}toMidi(){return vo(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Wi.A4);let n=Math.round(12*e)+57;const s=Math.floor(n/12);return s<0&&(n+=-12*s),v7[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(t*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return nS(t)}static ftom(t){return vo(t)}}const b7={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},v7=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function _7(i,t){return new Wi(_n(),i,t)}class Aa extends Nn{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class pi extends sr{constructor(){super();const t=Tt(pi.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:_n()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return K9(t),new Nn(this.context,t).toSeconds()}toFrequency(t){return new Wi(this.context,t).toFrequency()}toTicks(t){return new Aa(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(n=>{hn(t[n])&&delete e[n]}),e}get(){const t=l7(this);return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const n=this[e];Rt(n)&&Rt(n.value)&&Rt(n.setValueAtTime)?t[e]=n.value:n instanceof pi?t[e]=n._getPartialProperties(t[e]):zi(n)||Ss(n)||Ys(n)||Xx(n)?t[e]=n:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&Rt(this[e])&&(this[e]&&Rt(this[e].value)&&Rt(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof pi?this[e].set(t[e]):this[e]=t[e])}),this}}class Oh extends Cn{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return e!==null?e.state:this._initial}setStateAtTime(t,e,n){return Br(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){const n=this._search(e);for(let s=n;s>=0;s--){const r=this._timeline[s];if(r.state===t)return r}}getNextState(t,e){const n=this._search(e);if(n!==-1)for(let s=n;s<this._timeline.length;s++){const r=this._timeline[s];if(r.state===t)return r}}}class Se extends pi{constructor(){const t=Tt(Se.getDefaults(),arguments,["param","units","convert"]);for(super(t),this.name="Param",this.overridden=!1,this._minOutput=1e-7,wt(Rt(t.param)&&($o(t.param)||t.param instanceof Se),"param must be an AudioParam");!$o(t.param);)t.param=t.param._param;this._swappable=Rt(t.swappable)?t.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Cn(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Rt(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(pi.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Rt(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Rt(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Rt(this.maxValue)&&Rt(this.minValue)&&Br(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?g7(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&this.units==="decibels"?m7(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),s=this._fromType(t);return wt(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),s=this._events.get(e);let r=this._initialValue;if(s===null)r=this._initialValue;else if(s.type==="setTargetAtTime"&&(n===null||n.type==="setValueAtTime")){const o=this._events.getBefore(s.time);let a;o===null?a=this._initialValue:a=o.value,s.type==="setTargetAtTime"&&(r=this._exponentialApproach(s.time,a,s.value,s.constant,e))}else if(n===null)r=s.value;else if(n.type==="linearRampToValueAtTime"||n.type==="exponentialRampToValueAtTime"){let o=s.value;if(s.type==="setTargetAtTime"){const a=this._events.getBefore(s.time);a===null?o=this._initialValue:o=a.value}n.type==="linearRampToValueAtTime"?r=this._linearInterpolate(s.time,o,n.time,n.value,e):r=this._exponentialInterpolate(s.time,o,n.time,n.value,e)}else r=s.value;return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(e)===0&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),s=this.toSeconds(e);return wt(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=Qn(n,0)?this._minOutput:n,this._assertRange(n);const s=this.toSeconds(e);return wt(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,s),this.cancelAndHoldAtTime(e+n*.9),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const s=this._fromType(t);wt(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(s),wt(isFinite(s)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(s,r,n),this}setValueCurveAtTime(t,e,n,s=1){n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*s;this.setValueAtTime(this._toType(r),e);const o=n/(t.length-1);for(let a=1;a<t.length;a++){const l=this._fromType(t[a])*s;this.linearRampToValueAtTime(this._toType(l),e+a*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return wt(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));wt(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const s=this._events.get(e),r=this._events.getAfter(e);return s&&Qn(s.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),r.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(n),e):r.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&n.type==="setTargetAtTime"){const s=this._events.getAfter(n.time),r=s?s.time:e+2,o=(r-e)/10;for(let a=e;a<r;a+=o)t.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,s=>{s.type==="cancelScheduledValues"?t.cancelScheduledValues(s.time):s.type==="setTargetAtTime"?t.setTargetAtTime(s.value,s.time,s.constant):t[s.type](s.value,s.time)}),this}setParam(t){wt(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,s,r){return n+(e-n)*Math.exp(-(r-t)/s)}_linearInterpolate(t,e,n,s,r){return e+(s-e)*((r-t)/(n-t))}_exponentialInterpolate(t,e,n,s,r){return e*Math.pow(s/e,(r-t)/(n-t))}}class Dt extends pi{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Rt(this.input)?$o(this.input)||this.input instanceof Se?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Rt(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Rt(t)&&(t instanceof Dt||Qr(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(n=>{n.channelCount=t.channelCount,n.channelCountMode=t.channelCountMode,n.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();wt(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return dl(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Vd("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return x7(this,t,e,n),this}chain(...t){return im(this,...t),this}fan(...t){return t.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),Rt(this.input)&&(this.input instanceof Dt?this.input.dispose():Qr(this.input)&&this.input.disconnect()),Rt(this.output)&&(this.output instanceof Dt?this.output.dispose():Qr(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function im(...i){const t=i.shift();i.reduce((e,n)=>(e instanceof Dt?e.connect(n):Qr(e)&&dl(e,n),n),t)}function dl(i,t,e=0,n=0){for(wt(Rt(i),"Cannot connect from undefined node"),wt(Rt(t),"Cannot connect to undefined node"),(t instanceof Dt||Qr(t))&&wt(t.numberOfInputs>0,"Cannot connect to node with no inputs"),wt(i.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof Dt||t instanceof Se;)Rt(t.input)&&(t=t.input);for(;i instanceof Dt;)Rt(i.output)&&(i=i.output);$o(t)?i.connect(t,e):i.connect(t,e,n)}function x7(i,t,e=0,n=0){if(Rt(t))for(;t instanceof Dt;)t=t.input;for(;!Qr(i);)Rt(i.output)&&(i=i.output);$o(t)?i.disconnect(t,e):Qr(t)?i.disconnect(t,e,n):i.disconnect()}class gi extends Dt{constructor(){const t=Tt(gi.getDefaults(),arguments,["gain","units"]);super(t),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Se({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),Ce(this,"gain")}static getDefaults(){return Object.assign(Dt.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Xa extends Dt{constructor(t){super(t),this.onended=Kt,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new gi({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){const n=this.toSeconds(e);return this._startTime!==-1&&n>=this._startTime&&(this._stopTime===-1||n<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Dt.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Kt})}_startGain(t,e=1){wt(this._startTime===-1,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){wt(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.now()),e>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n=this._curve==="exponential"?e*2:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Kt&&(this.onended(this),this.onended=Kt,!this.context.isOffline)){const t=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(t):setTimeout(t,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),wt(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Kt,this}}class gO extends Xa{constructor(){const t=Tt(gO.getDefaults(),arguments,["offset"]);super(t),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),dl(this._source,this._gainNode),this.offset=new Se({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Xa.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class He extends Dt{constructor(){const t=Tt(He.getDefaults(),arguments,["value","units"]);super(t),this.name="Signal",this.override=!0,this.output=this._constantSource=new gO({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Dt.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return mO(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,s){return this._param.setValueCurveAtTime(t,e,n,s),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function mO(i,t,e,n){(t instanceof Se||$o(t)||t instanceof He&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof He&&(t.overridden=!0)),dl(i,t,e,n)}class OO extends Se{constructor(){const t=Tt(OO.getDefaults(),arguments,["value"]);super(t),this.name="TickParam",this._events=new Cn(1/0),this._multiplier=1,this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Se.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const s=this._fromType(t),r=this._events.get(e),o=Math.round(Math.max(1/n,1));for(let a=0;a<=o;a++){const l=n*a+e,c=this._exponentialApproach(r.time,r.value,s,n,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const s=this._events.get(n),r=this._events.previousEvent(s),o=this._getTicksUntilEvent(r,n);return s.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const s=this._events.get(n),r=this._events.previousEvent(s),o=this._getTicksUntilEvent(r,n);return s.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),s=this._events.get(e),r=Math.round(Math.max((e-s.time)*10,1)),o=(e-s.time)/r;for(let a=0;a<=r;a++){const l=o*a+s.time,c=this._exponentialInterpolate(s.time,s.value,e,n,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}_getTicksUntilEvent(t,e){if(t===null)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(hn(t.ticks)){const o=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(o,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let s=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&r.type==="setValueAtTime"&&(s=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+s)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(e);return this.getTimeOfTick(s+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&n.type==="linearRampToValueAtTime"&&e.value!==n.value){const s=this._fromType(this.getValueAtTime(e.time)),o=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-e.time),a=Math.sqrt(Math.pow(s,2)-2*o*(e.ticks-t)),l=(-s+a)/o,c=(-s-a)/o;return(l>0?l:c)+e.time}else return e?e.value===0?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),s=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-r}_fromType(t){return this.units==="bpm"&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units==="bpm"&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class yO extends He{constructor(){const t=Tt(yO.getDefaults(),arguments,["value"]);super(t),this.name="TickSignal",this.input=this._param=new OO({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(He.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class bO extends pi{constructor(){const t=Tt(bO.getDefaults(),arguments,["frequency"]);super(t),this.name="TickSource",this._state=new Oh,this._tickOffset=new Cn,this._ticksAtTime=new Cn,this._secondsAtTime=new Cn,this.frequency=new yO({context:this.context,units:t.units,value:t.frequency}),Ce(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},pi.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),Rt(e)&&this.setTicksAtTime(e,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}stop(t){const e=this.toSeconds(t);if(this._state.getValueAtTime(e)==="stopped"){const n=this._state.get(e);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}pause(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e)),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),s=this._ticksAtTime.get(e),r={state:"paused",time:e};this._state.add(r);let o=s||n,a=s?s.ticks:0,l=null;return this._state.forEachBetween(o.time,e+this.sampleTime,c=>{let h=o.time;const u=this._tickOffset.get(c.time);u&&u.time>=o.time&&(a=u.ticks,h=u.time),o.state==="started"&&c.state!=="started"&&(a+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(h),c.time!==r.time&&(l={state:c.state,time:c.time,ticks:a})),o=c}),this._state.remove(r),l&&this._ticksAtTime.add(l),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);const s=this._secondsAtTime.get(t);let r=s||e,o=s?s.seconds:0,a=null;return this._state.forEachBetween(r.time,t+this.sampleTime,l=>{let c=r.time;const h=this._tickOffset.get(l.time);h&&h.time>=r.time&&(o=h.seconds,c=h.time),r.state==="started"&&l.state!=="started"&&(o+=l.time-c,l.time!==n.time&&(a={state:l.state,time:l.time,seconds:o})),r=l}),this._state.remove(n),a&&this._secondsAtTime.add(a),o}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),s=this._state.get(e),r=Math.max(n.time,s.time),o=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,n){let s=this._state.get(t);this._state.forEachBetween(t,e,o=>{s&&s.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(s.time,t),o.time-this.sampleTime,n),s=o});let r=null;if(s&&s.state==="started"){const o=Math.max(s.time,t),a=this.frequency.getTicksAtTime(o),l=this.frequency.getTicksAtTime(s.time),c=a-l;let h=Math.ceil(c)-c;h=Qn(h,1)?0:h;let u=this.frequency.getTimeOfTick(a+h);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(f){r=f;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class Wd extends pi{constructor(){const t=Tt(Wd.getDefaults(),arguments,["callback","frequency"]);super(t),this.name="Clock",this.callback=Kt,this._lastUpdate=0,this._state=new Oh("stopped"),this._boundLoop=this._loop.bind(this),this.callback=t.callback,this._tickSource=new bO({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Ce(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(pi.getDefaults(),{callback:Kt,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){zx(this.context);const n=this.toSeconds(t);return this.log("start",n),this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,n=>{switch(n.state){case"started":const s=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,s);break;case"stopped":n.time!==0&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time);break}}),this._tickSource.forEachTickBetween(t,e,(n,s)=>{this.callback(n,s)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}mh.mixin(Wd);class pl extends Dt{constructor(){const t=Tt(pl.getDefaults(),arguments,["volume"]);super(t),this.name="Volume",this.input=this.output=new gi({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,Ce(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Dt.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class vO extends Dt{constructor(){const t=Tt(vO.getDefaults(),arguments);super(t),this.name="Destination",this.input=new pl({context:this.context}),this.output=new gi({context:this.context}),this.volume=this.input.volume,im(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Dt.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),im(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Bd(i=>{i.destination=new vO({context:i})});Zd(i=>{i.destination.dispose()});class S7 extends Dt{constructor(){super(...arguments),this.name="Listener",this.positionX=new Se({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Se({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Se({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Se({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Se({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Se({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Se({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Se({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Se({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Dt.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Bd(i=>{i.listener=new S7({context:i})});Zd(i=>{i.listener.dispose()});class _O extends sr{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Tt(_O.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Kt,onload:Kt,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return wt(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,n=Kt,s=Kt){return Ys(e)?(this.baseUrl&&e.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(t.toString(),new ye(this.baseUrl+e,n,s))):this._buffers.set(t.toString(),new ye(e,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class Df extends Wi{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return vo(super._frequencyToUnits(t))}_ticksToUnits(t){return vo(super._ticksToUnits(t))}_beatsToUnits(t){return vo(super._beatsToUnits(t))}_secondsToUnits(t){return vo(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return nS(this.toMidi())}transpose(t){return new Df(this.context,this.toMidi()+t)}}class Be extends Aa{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class w7 extends pi{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Cn,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;this._events.forEachBefore(t+this.anticipation,e=>{t-e.time<=this.expiration&&e.callback(),this._events.remove(e)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Bd(i=>{i.draw=new w7({context:i})});Zd(i=>{i.draw.dispose()});class k7 extends sr{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){wt(Rt(t.time),"Events must have a time property"),wt(Rt(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new C7(t.time,t.time+t.duration,t);for(this._root===null?this._root=e:this._root.insert(e),this._length++;e!==null;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(this._root!==null){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,e=>this.remove(e)),this}_setRoot(t){this._root=t,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(t,e){t.parent!==null?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(t.left===null&&t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{const e=t.getBalance();let n,s=null;if(e>0)if(t.left.right===null)n=t.left,n.right=t.right,s=n;else{for(n=t.left.right;n.right!==null;)n=n.right;n.parent&&(n.parent.right=n.left,s=n.parent,n.left=t.left,n.right=t.right)}else if(t.right.left===null)n=t.right,n.left=t.left,s=n;else{for(n=t.right.left;n.left!==null;)n=n.left;n.parent&&(n.parent.left=n.right,s=n.parent,n.left=t.left,n.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=n:t.parent.right=n:this._setRoot(n),s&&this._rebalance(s)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),s=t.right;s&&(t.right=s.left,s.left=t),e!==null?n?e.left=s:e.right=s:this._setRoot(s)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),s=t.left;s&&(t.left=s.right,s.right=t),e!==null?n?e.left=s:e.right=s:this._setRoot(s)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){const e=[];if(this._root.search(t,e),e.length>0){let n=e[0];for(let s=1;s<e.length;s++)e[s].low>n.low&&(n=e[s]);return n.event}}return null}forEach(t){if(this._root!==null){const e=[];this._root.traverse(n=>e.push(n)),e.forEach(n=>{n.event&&t(n.event)})}return this}forEachAtTime(t,e){if(this._root!==null){const n=[];this._root.search(t,n),n.forEach(s=>{s.event&&e(s.event)})}return this}forEachFrom(t,e){if(this._root!==null){const n=[];this._root.searchAfter(t,n),n.forEach(s=>{s.event&&e(s.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class C7{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(this.left!==null&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),!(this.low>t)&&this.right!==null&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),this.left!==null&&this.left.searchAfter(t,e)),this.right!==null&&this.right.searchAfter(t,e)}traverse(t){t(this),this.left!==null&&this.left.traverse(t),this.right!==null&&this.right.traverse(t)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null&&this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null&&(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class T7 extends sr{constructor(t){super(),this.name="TimelineValue",this._timeline=new Cn({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class za extends Dt{constructor(){super(Tt(za.getDefaults(),arguments,["context"]))}connect(t,e=0,n=0){return mO(this,t,e,n),this}}class yh extends za{constructor(){const t=Tt(yh.getDefaults(),arguments,["mapping","length"]);super(t),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,zi(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):H9(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(He.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let s=0,r=e;s<r;s++){const o=s/(r-1)*2-1;n[s]=t(o,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){const e=["none","2x","4x"].some(n=>n.includes(t));wt(e,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class xO extends za{constructor(){const t=Tt(xO.getDefaults(),arguments,["value"]);super(t),this.name="Pow",this._exponentScaler=this.input=this.output=new yh({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(za.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Zr{constructor(t,e){this.id=Zr._eventId++,this._remainderTime=0;const n=Object.assign(Zr.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=Math.floor(n.time),this._remainderTime=n.time-this.time}static getDefaults(){return{callback:Kt,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(t){if(this.callback){const e=this.transport.bpm.getDurationOfTicks(1,t);this.callback(t+this._remainderTime*e),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Zr._eventId=0;class SO extends Zr{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(SO.getDefaults(),e);this.duration=n.duration,this._interval=n.interval,this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Zr.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvent(){return $f(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Be(this.context,this._nextTick).toSeconds()):-1}_createEvents(t){$f(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Be(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const e=this.transport.getTicksAtTime(t);qa(e,this.time)&&(this._nextTick=this.floatTime+Math.ceil((e-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class qd extends pi{constructor(){const t=Tt(qd.getDefaults(),arguments);super(t),this.name="Transport",this._loop=new T7(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Cn,this._repeatedEvents=new k7,this._syncedSignals=[],this._swingAmount=0,this._ppq=t.ppq,this._clock=new Wd({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),Ce(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(pi.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!==0&&e%(this._swingTicks*2)!==0){const n=e%(this._swingTicks*2)/(this._swingTicks*2),s=Math.sin(n*Math.PI)*this._swingAmount;t+=new Be(this.context,this._swingTicks*2/3).toSeconds()*s}Iy(!0),this._timeline.forEachAtTime(e,n=>n.invoke(t)),Iy(!1)}schedule(t,e){const n=new Zr(this,{callback:t,time:new Aa(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,s=1/0){const r=new SO(this,{callback:t,duration:new Nn(this.context,s).toTicks(),interval:new Nn(this.context,e).toTicks(),time:new Aa(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const n=new Zr(this,{callback:t,once:!0,time:new Aa(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(e,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new Be(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){this.context.resume();let n;return Rt(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!=="started"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){zi(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Nn(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Nn(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new Be(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Be(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if(this.state==="started"){const n=this._clock.getTicksAtTime(e),s=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e),r=e+s;this.emit("stop",r),this._clock.setTicksAtTime(t,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this.emit("ticks",e),this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return this._clock.getTicksAtTime(t)}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!=="started")return 0;{const e=this.now(),n=this.getTicksAtTime(e),s=t-n%t;return this._clock.nextTickTime(s,e)}}syncSignal(t,e){const n=this.now();let s=this.bpm,r=1/(60/s.getValueAtTime(n)/this.PPQ),o=[];if(t.units==="time"){const l=.015625/r,c=new gi(l),h=new xO(-1),u=new gi(l);s.chain(c,h,u),s=u,r=1/r,o=[c,h,u]}e||(t.getValueAtTime(n)!==0?e=t.getValueAtTime(n)/r:e=0);const a=new gi(e);return s.connect(a),a.connect(t._param),o.push(a),this._syncedSignals.push({initial:t.value,nodes:o,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.nodes.forEach(s=>s.dispose()),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Jx(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}mh.mixin(qd);Bd(i=>{i.transport=new qd({context:i})});Zd(i=>{i.transport.dispose()});class fn extends Dt{constructor(t){super(t),this.input=void 0,this._state=new Oh("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Kt,this._syncedStop=Kt,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new pl({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,Ce(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Dt.getDefaults(),{mute:!1,onstop:Kt,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let s=hn(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(s=this._clampToCurrentTime(s),!this._synced&&this._state.getValueAtTime(s)==="started")wt(qa(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,e,n);else if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const r=this._state.get(s);r&&(r.offset=this.toSeconds(ys(e,0)),r.duration=n?this.toSeconds(n):void 0);const o=this.context.transport.schedule(a=>{this._start(a,e,n)},s);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else zx(this.context),this._start(s,e,n);return this}stop(t){let e=hn(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this._state.getValueAtTime(e)==="started"||Rt(this._state.getNextState("started",e))){if(this.log("stop",e),!this._synced)this._stop(e);else{const n=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(n)}this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),this._state.getValueAtTime(t)==="started"&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(qa(e,0)){const n=this._state.get(e);if(n&&n.state==="started"&&n.time!==e){const s=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-s),this._start(t,this.toSeconds(n.offset)+s,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)==="started"&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Kt,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Xd extends Xa{constructor(){const t=Tt(Xd.getDefaults(),arguments,["url","onload"]);super(t),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,dl(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Se({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new ye(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Xa.getDefaults(),{url:new ye,loop:!1,loopEnd:0,loopStart:0,onload:Kt,onerror:Kt,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,s=1){wt(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,s),this.loop?e=ys(e,this.loopStart):e=ys(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),c=a-l;em(o,a)&&(o=(o-l)%c+l),Qn(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,$f(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,o)),Rt(n)){let a=this.toSeconds(n);a=Math.max(a,0),this.stop(r+a)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function zo(i,t){return Ne(this,void 0,void 0,function*(){const e=t/i.context.sampleRate,n=new dO(1,e,i.context.sampleRate);return new i.constructor(Object.assign(i.get(),{frequency:2/e,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class wO extends Xa{constructor(){const t=Tt(wO.getDefaults(),arguments,["frequency","type"]);super(t),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],dl(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Se({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Se({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),Ce(this,["frequency","detune"])}static getDefaults(){return Object.assign(Xa.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Qe extends fn{constructor(){const t=Tt(Qe.getDefaults(),arguments,["frequency","type"]);super(t),this.name="Oscillator",this._oscillator=null,this.frequency=new He({context:this.context,units:"frequency",value:t.frequency}),Ce(this,"frequency"),this.detune=new He({context:this.context,units:"cents",value:t.detune}),Ce(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&t.type!=="custom"&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(fn.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new wO({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Qe._periodicWaveCache.find(e=>e.phase===this._phase&&a7(e.partials,this._partials));{const t=Qe._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=["sine","square","sawtooth","triangle"].indexOf(t)!==-1;if(this._phase===0&&e)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=t);else{const n=this._getCachedPeriodicWave();if(Rt(n)){const{partials:s,wave:r}=n;this._wave=r,this._partials=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[s,r]=this._getRealImaginary(t,this._phase),o=this.context.createPeriodicWave(s,r);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Qe._periodicWaveCache.push({imag:r,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),Qe._periodicWaveCache.length>100&&Qe._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&this._type!=="custom"&&t!=="custom"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Br(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),this._type!=="custom")t===0?this.type=e:this.type=e+t.toString();else{const s=new Float32Array(t);this._partials.forEach((r,o)=>s[o]=r),this._partials=Array.from(s),this.type=this._type}}_getRealImaginary(t,e){let s=2048;const r=new Float32Array(s),o=new Float32Array(s);let a=1;if(t==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,s=a,this._partials.length===0)return[r,o]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);l?(a=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),t=l[1],a=Math.max(a,2),s=a):this._partialCount=0,this._partials=[]}for(let l=1;l<s;++l){const c=2/(l*Math.PI);let h;switch(t){case"sine":h=l<=a?1:0,this._partials[l-1]=h;break;case"square":h=l&1?2*c:0,this._partials[l-1]=h;break;case"sawtooth":h=c*(l&1?1:-1),this._partials[l-1]=h;break;case"triangle":l&1?h=2*(c*c)*(l-1>>1&1?-1:1):h=0,this._partials[l-1]=h;break;case"custom":h=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}h!==0?(r[l]=-h*Math.sin(e*l),o[l]=h*Math.cos(e*l)):(r[l]=0,o[l]=0)}return[r,o]}_inverseFFT(t,e,n){let s=0;const r=t.length;for(let o=0;o<r;o++)s+=t[o]*Math.cos(o*n)+e[o]*Math.sin(o*n);return s}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const s=Math.PI*2,r=32;for(let o=0;o<r;o++)n=Math.max(this._inverseFFT(t,e,o/r*s),n);return c7(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Qe._periodicWaveCache=[];class P7 extends za{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new yh({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ga extends He{constructor(){const t=Tt(Ga.getDefaults(),arguments,["value"]);super(t),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new gi({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(He.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class zd extends fn{constructor(){const t=Tt(zd.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="AMOscillator",this._modulationScale=new P7({context:this.context}),this._modulationNode=new gi({context:this.context}),this._carrier=new Qe({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Qe({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Ga({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Ce(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Qe.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Gd extends fn{constructor(){const t=Tt(Gd.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="FMOscillator",this._modulationNode=new gi({context:this.context,gain:0}),this._carrier=new Qe({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new He({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new Qe({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Ga({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Ga({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Ce(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Qe.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class bh extends fn{constructor(){const t=Tt(bh.getDefaults(),arguments,["frequency","width"]);super(t),this.name="PulseOscillator",this._widthGate=new gi({context:this.context,gain:0}),this._thresh=new yh({context:this.context,mapping:e=>e<=0?-1:1}),this.width=new He({context:this.context,units:"audioRange",value:t.width}),this._triangle=new Qe({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Ce(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(fn.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class jd extends fn{constructor(){const t=Tt(jd.getDefaults(),arguments,["frequency","type","spread"]);super(t),this.name="FatOscillator",this._oscillators=[],this.frequency=new He({context:this.context,units:"frequency",value:t.frequency}),this.detune=new He({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,Ce(this,["frequency","detune"])}static getDefaults(){return Object.assign(Qe.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach((s,r)=>s.detune.value=e+n*r)}}get count(){return this._oscillators.length}set count(t){if(Br(t,1),this._oscillators.length!==t){this._forEach(e=>e.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const n=new Qe({context:this.context,volume:-6-t*1.1,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:e===0?()=>this.onstop(this):Kt});this.type==="custom"&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,this.state==="started"&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((e,n)=>e.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class Ud extends fn{constructor(){const t=Tt(Ud.getDefaults(),arguments,["frequency","modulationFrequency"]);super(t),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Ga({context:this.context,value:2}),this._pulse=new bh({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Qe({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Ce(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(fn.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Qy={am:zd,fat:jd,fm:Gd,oscillator:Qe,pulse:bh,pwm:Ud};class Lf extends fn{constructor(){const t=Tt(Lf.getDefaults(),arguments,["frequency","type"]);super(t),this.name="OmniOscillator",this.frequency=new He({context:this.context,units:"frequency",value:t.frequency}),this.detune=new He({context:this.context,units:"cents",value:t.detune}),Ce(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(Qe.getDefaults(),Gd.getDefaults(),zd.getDefaults(),jd.getDefaults(),bh.getDefaults(),Ud.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):t==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=Qy[t],n=this.now();if(this._oscillator){const s=this._oscillator;s.stop(n),this.context.setTimeout(()=>s.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(e=this._oscillator.type),t==="fm"?this.type="fm"+e:t==="am"?this.type="am"+e:t==="fat"?this.type="fat"+e:t==="oscillator"?this.type=e:t==="pulse"?this.type="pulse":t==="pwm"&&(this.type="pwm")}_getOscType(t,e){return t instanceof Qy[e]}get baseType(){return this._oscillator.baseType}set baseType(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&t!=="pulse"&&t!=="pwm"&&(this._oscillator.baseType=t)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(t){this._getOscType(this._oscillator,"fat")&&Ss(t)&&(this._oscillator.count=t)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(t){this._getOscType(this._oscillator,"fat")&&Ss(t)&&(this._oscillator.spread=t)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Ys(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return Ne(this,arguments,void 0,function*(t=1024){return zo(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function sS(i,t=1/0){const e=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(r){Br(r,i,t),e.set(this,r)}})}}function rr(i,t=1/0){const e=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(r){Br(this.toSeconds(r),i,t),e.set(this,r)}})}}class Yd extends fn{constructor(){const t=Tt(Yd.getDefaults(),arguments,["url","onload"]);super(t),this.name="Player",this._activeSources=new Set,this._buffer=new ye({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(fn.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Kt,onerror:Kt,playbackRate:1,reverse:!1})}load(t){return Ne(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=Kt){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){this._loop?e=ys(e,this._loopStart):e=ys(e,0);const s=this.toSeconds(e),r=n;n=ys(n,Math.max(this._buffer.duration-s,0));let o=this.toSeconds(n);o=o/this._playbackRate,t=this.toSeconds(t);const a=new Xd({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&hn(r)?a.start(t,s):a.start(t,s,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(n=>n.stop(e))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){var s;(s=[...this._activeSources].pop())===null||s===void 0||s.stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="started"){const s=this.toSeconds(t);this._stop(n),this._start(n,s)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Br(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Br(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(s=>s.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}zn([rr(0)],Yd.prototype,"fadeIn",void 0);zn([rr(0)],Yd.prototype,"fadeOut",void 0);class Hr extends Dt{constructor(){const t=Tt(Hr.getDefaults(),arguments,["attack","decay","sustain","release"]);super(t),this.name="Envelope",this._sig=new He({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Dt.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Ys(t))return t;{let n;for(n in Yh)if(Yh[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Ys(n)&&Reflect.has(Yh,n)){const s=Yh[n];Ir(s)?t!=="_decayCurve"&&(this[t]=s[e]):this[t]=s}else if(zi(n)&&t!=="_decayCurve")this[t]=n;else throw new Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(t){this._setCurve("_decayCurve","Out",t)}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let s=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),o=this.getValueAtTime(t);if(o>0){const a=1/s;s=(1-o)/a}if(s<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if(this._attackCurve==="linear")this._sig.linearRampTo(e,s,t);else if(this._attackCurve==="exponential")this._sig.targetRampTo(e,s,t);else{this._sig.cancelAndHoldAtTime(t);let a=this._attackCurve;for(let l=1;l<a.length;l++)if(a[l-1]<=o&&o<=a[l]){a=this._attackCurve.slice(l),a[0]=o;break}this._sig.setValueCurveAtTime(a,t,s,e)}if(r&&this.sustain<1){const a=e*this.sustain,l=t+s;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,r+l):this._sig.exponentialApproachValueAtTime(a,l,r)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve==="linear"?this._sig.linearRampTo(0,n,t):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,n,t):(wt(zi(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return mO(this,t,e,n),this}asArray(){return Ne(this,arguments,void 0,function*(t=1024){const e=t/this.context.sampleRate,n=new dO(1,e,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=s+this.toSeconds(this.release),o=r*.1,a=r+o,l=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/a,decay:e*this.toSeconds(this.decay)/a,release:e*this.toSeconds(this.release)/a,context:n}));return l._sig.toDestination(),l.triggerAttackRelease(e*(s+o)/a,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}zn([rr(0)],Hr.prototype,"attack",void 0);zn([rr(0)],Hr.prototype,"decay",void 0);zn([sS(0,1)],Hr.prototype,"sustain",void 0);zn([rr(0)],Hr.prototype,"release",void 0);const Yh=(()=>{let t,e;const n=[];for(t=0;t<128;t++)n[t]=Math.sin(t/127*(Math.PI/2));const s=[],r=6.4;for(t=0;t<127;t++){e=t/127;const f=Math.sin(e*(Math.PI*2)*r-Math.PI/2)+1;s[t]=f/10+e*.83}s[127]=1;const o=[],a=5;for(t=0;t<128;t++)o[t]=Math.ceil(t/127*a)/a;const l=[];for(t=0;t<128;t++)e=t/127,l[t]=.5*(1-Math.cos(Math.PI*e));const c=[];for(t=0;t<128;t++){e=t/127;const f=Math.pow(e,3)*4+.2,d=Math.cos(f*Math.PI*2*e);c[t]=Math.abs(d*(1-e))}function h(f){const d=new Array(f.length);for(let p=0;p<f.length;p++)d[p]=1-f[p];return d}function u(f){return f.slice(0).reverse()}return{bounce:{In:h(c),Out:c},cosine:{In:n,Out:u(n)},exponential:"exponential",linear:"linear",ripple:{In:s,Out:h(s)},sine:{In:l,Out:h(l)},step:{In:o,Out:h(o)}}})();class Fr extends Dt{constructor(){const t=Tt(Fr.getDefaults(),arguments);super(t),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=e=>this._original_triggerRelease(e),this._volume=this.output=new pl({context:this.context,volume:t.volume}),this.volume=this._volume.volume,Ce(this,"volume")}static getDefaults(){return Object.assign(Dt.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...s)=>{const r=s[e],o=this.context.transport.schedule(a=>{s[e]=a,n.apply(this,s)},r);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(t,e,n,s){const r=this.toSeconds(n),o=this.toSeconds(e);return this.triggerAttack(t,r,s),this.triggerRelease(r+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Do extends Fr{constructor(){const t=Tt(Do.getDefaults(),arguments);super(t),this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Fr.getDefaults(),{detune:0,onsilence:Kt,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const s=this.toSeconds(e);return this._triggerEnvelopeAttack(s,n),this.setNote(t,s),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),s=t instanceof Wi?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,r,n)}else this.frequency.setValueAtTime(s,n);return this}}zn([rr(0)],Do.prototype,"portamento",void 0);class kO extends Hr{constructor(){super(Tt(kO.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new gi({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class ja extends Do{constructor(){const t=Tt(ja.getDefaults(),arguments);super(t),this.name="Synth",this.oscillator=new Lf(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new kO(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),Ce(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Do.getDefaults(),{envelope:Object.assign(tm(Hr.getDefaults(),Object.keys(Dt.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(tm(Lf.getDefaults(),[...Object.keys(fn.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+s)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Hd extends ja{constructor(){const t=Tt(Hd.getDefaults(),arguments);super(t),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,Ce(this,["oscillator","envelope"])}static getDefaults(){return Co(Do.getDefaults(),ja.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),s=this.toFrequency(t instanceof Wi?t.toFrequency():t),r=s*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}zn([sS(0)],Hd.prototype,"octaves",void 0);zn([rr(0)],Hd.prototype,"pitchDecay",void 0);const rS=new Set;function CO(i){rS.add(i)}function oS(i,t){const e=`registerProcessor("${i}", ${t})`;rS.add(e)}const A7=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;CO(A7);const M7=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;CO(M7);const E7=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;CO(E7);const R7="feedback-comb-filter",I7=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;oS(R7,I7);class TO extends Fr{constructor(){const t=Tt(TO.getDefaults(),arguments,["voice","options"]);super(t),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=s=>this.releaseAll(s),wt(!Ss(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Fr.getDefaults(),{maxPolyphony:32,options:{},voice:ja})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex(n=>n.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return wt(t instanceof Do,"Voice must extend Monophonic class"),t.connect(this.output),this._voices.push(t),t}else Vd("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach(s=>{const r=new Df(this.context,s).toMidi(),o=this._getNextAvailableVoice();o&&(o.triggerAttack(s,e,n),this._activeVoices.push({midi:r,voice:o,released:!1}),this.log("triggerAttack",s,e))})}_triggerRelease(t,e){t.forEach(n=>{const s=new Df(this.context,n).toMidi(),r=this._activeVoices.find(({midi:o,released:a})=>o===s&&!a);r&&(r.voice.triggerRelease(e),r.released=!0,this.log("triggerRelease",n,e))})}_scheduleEvent(t,e,n,s){wt(!this.disposed,"Synth was already disposed"),n<=this.now()?t==="attack"?this._triggerAttack(e,n,s):this._triggerRelease(e,n):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(t,e,n,s)},n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("attack",t,s,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,s){const r=this.toSeconds(n);if(this.triggerAttack(t,r,s),zi(e)){wt(zi(t),"If the duration is an array, the notes must also be an array"),t=t;for(let o=0;o<t.length;o++){const a=e[Math.min(o,e.length-1)],l=this.toSeconds(a);wt(l>0,"The duration must be greater than 0"),this.triggerRelease(t[o],r+l)}}else{const o=this.toSeconds(e);wt(o>0,"The duration must be greater than 0"),this.triggerRelease(t,r+o)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(t){const e=tm(t,["onsilence","context"]);return this.options=Co(this.options,e),this._voices.forEach(n=>n.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach(({voice:n})=>{n.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Kd extends Fr{constructor(){const t=Tt(Kd.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(t),this.name="Sampler",this._activeSources=new Map;const e={};Object.keys(t.urls).forEach(n=>{const s=parseInt(n,10);if(wt(Uh(n)||Ss(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),Uh(n)){const r=new Wi(this.context,n).toMidi();e[r]=t.urls[n]}else Ss(s)&&isFinite(s)&&(e[s]=t.urls[s])}),this._buffers=new _O({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Fr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Kt,onerror:Kt,release:.1,urls:{}})}_findClosest(t){let n=0;for(;n<96;){if(this._buffers.has(t+n))return-n;if(this._buffers.has(t-n))return n;n++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(s=>{const r=iS(new Wi(this.context,s).toFrequency()),o=Math.round(r),a=r-o,l=this._findClosest(o),c=o-l,h=this._buffers.get(c),u=eS(l+a),f=new Xd({url:h,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);f.start(e,0,h.duration/u,n),zi(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const d=this._activeSources.get(o),p=d.indexOf(f);p!==-1&&d.splice(p,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(n=>{const s=new Wi(this.context,n).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const r=this._activeSources.get(s);e=this.toSeconds(e),r.forEach(o=>{o.stop(e)}),this._activeSources.set(s,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(e)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,s=1){const r=this.toSeconds(n);return this.triggerAttack(t,r,s),zi(e)?(wt(zi(t),"notes must be an array when duration is array"),t.forEach((o,a)=>{const l=e[Math.min(a,e.length-1)];this.triggerRelease(o,r+this.toSeconds(l))})):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,n){if(wt(Uh(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Uh(t)){const s=new Wi(this.context,t).toMidi();this._buffers.add(s,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(e=>e.dispose())}),this._activeSources.clear(),this}}zn([rr(0)],Kd.prototype,"attack",void 0);zn([rr(0)],Kd.prototype,"release",void 0);class Oa extends pi{constructor(){const t=Tt(Oa.getDefaults(),arguments,["callback","value"]);super(t),this.name="ToneEvent",this._state=new Oh("stopped"),this._startOffset=0,this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(pi.getDefaults(),{callback:Kt,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,e=>{let n;if(e.state==="started"){e.id!==-1&&this.context.transport.clear(e.id);const s=e.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Ss(this._loop)&&this._loop>1){n=1/0,Ss(this._loop)&&(n=this._loop*this._getLoopDuration());const r=this._state.getAfter(s);r!==null&&(n=Math.min(n,r.time-s)),n!==1/0&&(n=new Be(this.context,n));const o=new Be(this.context,this._getLoopDuration());e.id=this.context.transport.scheduleRepeat(this._tick.bind(this),o,new Be(this.context,s),n)}else e.id=this.context.transport.schedule(this._tick.bind(this),new Be(this.context,s))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return this._state.getValueAtTime(e)==="stopped"&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if(this._state.getValueAtTime(e)==="started"){this._state.setStateAtTime("stopped",e,{id:-1});const n=this._state.getBefore(e);let s=e;n!==null&&(s=n.time),this._rescheduleEvents(s)}return this}cancel(t){t=ys(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,n=>{this.context.transport.clear(n.id)}),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&this._state.getValueAtTime(e)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let n=.02;Xx(this.humanize)||(n=this.toSeconds(this.humanize)),t+=(Math.random()*2-1)*n}this.callback(t,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new Be(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new Be(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(e!==null&&e.state==="started"){const n=this._getLoopDuration();return(t-e.time)%n/n}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Vf extends Oa{constructor(){const t=Tt(Vf.getDefaults(),arguments,["callback","events"]);super(t),this.name="Part",this._state=new Oh("stopped"),this._events=new Set,this._state.increasing=!0,t.events.forEach(e=>{zi(e)?this.add(e[0],e[1]):this.add(e)})}static getDefaults(){return Object.assign(Oa.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if(this._state.getValueAtTime(n)!=="started"){e=ys(e,this._loop?this._loopStart:0),this._loop?e=ys(e,this._loopStart):e=ys(e,0);const s=this.toTicks(e);this._state.add({id:-1,offset:s,state:"started",time:n}),this._forEach(r=>{this._startNote(r,n,s)})}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new Be(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new Be(this.context,e))):t.startOffset>=n&&t.start(new Be(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(e=>{e.startOffset+=this._startOffset})}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach(n=>{n.stop(t)}),this}at(t,e){const n=new Aa(this.context,t).toTicks(),s=new Be(this.context,1).toSeconds(),r=this._events.values();let o=r.next();for(;!o.done;){const a=o.value;if(Math.abs(n-a.startOffset)<s)return Rt(e)&&(a.value=e),a;o=r.next()}return Rt(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(e=t,t=e.time);const n=this.toTicks(t);let s;return e instanceof Oa?(s=e,s.callback=this._tick.bind(this)):s=new Oa({callback:this._tick.bind(this),context:this.context,value:e}),s.startOffset=n,s.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(s),this._restartEvent(s),this}_restartEvent(t){this._state.forEach(e=>{e.state==="started"?this._startNote(t,e.time,e.offset):t.stop(new Be(this.context,e.time))})}remove(t,e){return Ir(t)&&t.hasOwnProperty("time")&&(e=t,t=e.time),t=this.toTicks(t),this._events.forEach(n=>{n.startOffset===t&&(hn(e)||Rt(e)&&n.value===e)&&(this._events.delete(n),n.dispose())}),this}clear(){return this._forEach(t=>t.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=>e.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach(e=>{e instanceof Vf?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(n=>{n[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):t.state==="stopped"&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new Be(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new Be(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopStart=this.loopStart,this._testLoopBoundries(e)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class PO extends Dt{constructor(){const t=Tt(PO.getDefaults(),arguments,["pan"]);super(t),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Se({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",Ce(this,"pan")}static getDefaults(){return Object.assign(Dt.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const Q7="bit-crusher",N7=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;oS(Q7,N7);class Ee extends Dt{constructor(){const t=Tt(Ee.getDefaults(),arguments,["solo"]);super(t),this.name="Solo",this.input=this.output=new gi({context:this.context}),Ee._allSolos.has(this.context)||Ee._allSolos.set(this.context,new Set),Ee._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Dt.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Ee._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Ee._soloed.has(this.context)||Ee._soloed.set(this.context,new Set),Ee._soloed.get(this.context).add(this)}_removeSolo(){Ee._soloed.has(this.context)&&Ee._soloed.get(this.context).delete(this)}_isSoloed(){return Ee._soloed.has(this.context)&&Ee._soloed.get(this.context).has(this)}_noSolos(){return!Ee._soloed.has(this.context)||Ee._soloed.has(this.context)&&Ee._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ee._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ee._allSolos=new Map;Ee._soloed=new Map;class AO extends Dt{constructor(){const t=Tt(AO.getDefaults(),arguments,["pan","volume"]);super(t),this.name="PanVol",this._panner=this.input=new PO({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new pl({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,Ce(this,["pan","volume"])}static getDefaults(){return Object.assign(Dt.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class ya extends Dt{constructor(){const t=Tt(ya.getDefaults(),arguments,["volume","pan"]);super(t),this.name="Channel",this._solo=this.input=new Ee({solo:t.solo,context:this.context}),this._panVol=this.output=new AO({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Ce(this,["pan","volume"])}static getDefaults(){return Object.assign(Dt.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return ya.buses.has(t)||ya.buses.set(t,new gi({context:this.context})),ya.buses.get(t)}send(t,e=0){const n=this._getBus(t),s=new gi({context:this.context,units:"decibels",gain:e});return this.connect(s),s.connect(n),s}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}ya.buses=new Map;const Ki=_n().transport;_n().destination;_n().destination;_n().listener;_n().draw;_n();const $7=Math.PI/180;function D7(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const _o=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},ot={_global:_o,version:"10.0.2",isBrowser:D7(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return ot.angleDeg?i*$7:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return ot.DD.isDragging},isTransforming(){var i,t;return(t=(i=ot.Transformer)===null||i===void 0?void 0:i.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!ot.DD.node},releaseCanvasOnDestroy:!0,document:_o.document,_injectGlobal(i){typeof _o.Konva<"u"&&console.error("Severa Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),_o.Konva=i}},we=i=>{ot[i.prototype.getClassName()]=i};ot._injectGlobal(ot);const L7=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ny=()=>{if(typeof document>"u")throw new Error(L7)};class an{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new an(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),s=this.m[0]*e+this.m[2]*n,r=this.m[1]*e+this.m[3]*n,o=this.m[0]*-n+this.m[2]*e,a=this.m[1]*-n+this.m[3]*e;return this.m[0]=s,this.m[1]=r,this.m[2]=o,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){const n=this.m[0]+this.m[2]*e,s=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,o=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=s,this.m[2]=r,this.m[3]=o,this}multiply(t){const e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],o=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=s,this.m[3]=r,this.m[4]=o,this.m[5]=a,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,s=-this.m[2]*t,r=this.m[0]*t,o=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=s,this.m[3]=r,this.m[4]=o,this.m[5]=a,this}getMatrix(){return this.m}decompose(){const t=this.m[0],e=this.m[1],n=this.m[2],s=this.m[3],r=this.m[4],o=this.m[5],a=t*s-e*n,l={x:r,y:o,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const c=Math.sqrt(t*t+e*e);l.rotation=e>0?Math.acos(t/c):-Math.acos(t/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(t*n+e*s)/a,l.skewY=0}else if(n!=0||s!=0){const c=Math.sqrt(n*n+s*s);l.rotation=Math.PI/2-(s>0?Math.acos(-n/c):-Math.acos(n/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(t*n+e*s)/a}return l.rotation=L._getRotation(l.rotation),l}}const V7="[object Array]",B7="[object Number]",Z7="[object String]",F7="[object Boolean]",W7=Math.PI/180,q7=180/Math.PI,Ip="#",X7="",z7="0",G7="Konva warning: ",$y="Konva error: ",j7="rgb(",Qp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},U7=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let Hh=[];const Y7=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(i){setTimeout(i,60)},L={_isElement(i){return!!(i&&i.nodeType==1)},_isFunction(i){return!!(i&&i.constructor&&i.call&&i.apply)},_isPlainObject(i){return!!i&&i.constructor===Object},_isArray(i){return Object.prototype.toString.call(i)===V7},_isNumber(i){return Object.prototype.toString.call(i)===B7&&!isNaN(i)&&isFinite(i)},_isString(i){return Object.prototype.toString.call(i)===Z7},_isBoolean(i){return Object.prototype.toString.call(i)===F7},isObject(i){return i instanceof Object},isValidSelector(i){if(typeof i!="string")return!1;const t=i[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(i){return i===0||i>0?1:-1},requestAnimFrame(i){Hh.push(i),Hh.length===1&&Y7(function(){const t=Hh;Hh=[],t.forEach(function(e){e()})})},createCanvasElement(){Ny();const i=document.createElement("canvas");try{i.style=i.style||{}}catch{}return i},createImageElement(){return Ny(),document.createElement("img")},_isInDocument(i){for(;i=i.parentNode;)if(i==document)return!0;return!1},_urlToImage(i,t){const e=L.createImageElement();e.onload=function(){t(e)},e.src=i},_rgbToHex(i,t,e){return((1<<24)+(i<<16)+(t<<8)+e).toString(16).slice(1)},_hexToRgb(i){i=i.replace(Ip,X7);const t=parseInt(i,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let i=(Math.random()*16777215<<0).toString(16);for(;i.length<6;)i=z7+i;return Ip+i},getRGB(i){let t;return i in Qp?(t=Qp[i],{r:t[0],g:t[1],b:t[2]}):i[0]===Ip?this._hexToRgb(i.substring(1)):i.substr(0,4)===j7?(t=U7.exec(i.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(i){return i=i||"black",L._namedColorToRBA(i)||L._hex3ColorToRGBA(i)||L._hex4ColorToRGBA(i)||L._hex6ColorToRGBA(i)||L._hex8ColorToRGBA(i)||L._rgbColorToRGBA(i)||L._rgbaColorToRGBA(i)||L._hslColorToRGBA(i)},_namedColorToRBA(i){const t=Qp[i.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(i){if(i.indexOf("rgb(")===0){i=i.match(/rgb\(([^)]+)\)/)[1];const t=i.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(i){if(i.indexOf("rgba(")===0){i=i.match(/rgba\(([^)]+)\)/)[1];const t=i.split(/ *, */).map((e,n)=>e.slice(-1)==="%"?n===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(i){if(i[0]==="#"&&i.length===9)return{r:parseInt(i.slice(1,3),16),g:parseInt(i.slice(3,5),16),b:parseInt(i.slice(5,7),16),a:parseInt(i.slice(7,9),16)/255}},_hex6ColorToRGBA(i){if(i[0]==="#"&&i.length===7)return{r:parseInt(i.slice(1,3),16),g:parseInt(i.slice(3,5),16),b:parseInt(i.slice(5,7),16),a:1}},_hex4ColorToRGBA(i){if(i[0]==="#"&&i.length===5)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16),a:parseInt(i[4]+i[4],16)/255}},_hex3ColorToRGBA(i){if(i[0]==="#"&&i.length===4)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16),a:1}},_hslColorToRGBA(i){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(i)){const[t,...e]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(i),n=Number(e[0])/360,s=Number(e[1])/100,r=Number(e[2])/100;let o,a,l;if(s===0)return l=r*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};r<.5?o=r*(1+s):o=r+s-r*s;const c=2*r-o,h=[0,0,0];for(let u=0;u<3;u++)a=n+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=c+(o-c)*6*a:2*a<1?l=o:3*a<2?l=c+(o-c)*(2/3-a)*6:l=c,h[u]=l*255;return{r:Math.round(h[0]),g:Math.round(h[1]),b:Math.round(h[2]),a:1}}},haveIntersection(i,t){return!(t.x>i.x+i.width||t.x+t.width<i.x||t.y>i.y+i.height||t.y+t.height<i.y)},cloneObject(i){const t={};for(const e in i)this._isPlainObject(i[e])?t[e]=this.cloneObject(i[e]):this._isArray(i[e])?t[e]=this.cloneArray(i[e]):t[e]=i[e];return t},cloneArray(i){return i.slice(0)},degToRad(i){return i*W7},radToDeg(i){return i*q7},_degToRad(i){return L.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),L.degToRad(i)},_radToDeg(i){return L.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),L.radToDeg(i)},_getRotation(i){return ot.angleDeg?L.radToDeg(i):i},_capitalize(i){return i.charAt(0).toUpperCase()+i.slice(1)},throw(i){throw new Error($y+i)},error(i){console.error($y+i)},warn(i){ot.showWarnings&&console.warn(G7+i)},each(i,t){for(const e in i)t(e,i[e])},_inRange(i,t,e){return t<=i&&i<e},_getProjectionToSegment(i,t,e,n,s,r){let o,a,l;const c=(i-e)*(i-e)+(t-n)*(t-n);if(c==0)o=i,a=t,l=(s-e)*(s-e)+(r-n)*(r-n);else{const h=((s-i)*(e-i)+(r-t)*(n-t))/c;h<0?(o=i,a=t,l=(i-s)*(i-s)+(t-r)*(t-r)):h>1?(o=e,a=n,l=(e-s)*(e-s)+(n-r)*(n-r)):(o=i+h*(e-i),a=t+h*(n-t),l=(o-s)*(o-s)+(a-r)*(a-r))}return[o,a,l]},_getProjectionToLine(i,t,e){const n=L.cloneObject(i);let s=Number.MAX_VALUE;return t.forEach(function(r,o){if(!e&&o===t.length-1)return;const a=t[(o+1)%t.length],l=L._getProjectionToSegment(r.x,r.y,a.x,a.y,i.x,i.y),c=l[0],h=l[1],u=l[2];u<s&&(n.x=c,n.y=h,s=u)}),n},_prepareArrayForTween(i,t,e){const n=[],s=[];if(i.length>t.length){const o=t;t=i,i=o}for(let o=0;o<i.length;o+=2)n.push({x:i[o],y:i[o+1]});for(let o=0;o<t.length;o+=2)s.push({x:t[o],y:t[o+1]});const r=[];return s.forEach(function(o){const a=L._getProjectionToLine(o,n,e);r.push(a.x),r.push(a.y)}),r},_prepareToStringify(i){let t;i.visitedByCircularReferenceRemoval=!0;for(const e in i)if(i.hasOwnProperty(e)&&i[e]&&typeof i[e]=="object"){if(t=Object.getOwnPropertyDescriptor(i,e),i[e].visitedByCircularReferenceRemoval||L._isElement(i[e]))if(t.configurable)delete i[e];else return null;else if(L._prepareToStringify(i[e])===null)if(t.configurable)delete i[e];else return null}return delete i.visitedByCircularReferenceRemoval,i},_assign(i,t){for(const e in t)i[e]=t[e];return i},_getFirstPointerId(i){return i.touches?i.changedTouches[0].identifier:i.pointerId||999},releaseCanvas(...i){ot.releaseCanvasOnDestroy&&i.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(i,t,e,n){let s=t<0?t:0,r=e<0?e:0;t=Math.abs(t),e=Math.abs(e);let o=0,a=0,l=0,c=0;typeof n=="number"?o=a=l=c=Math.min(n,t/2,e/2):(o=Math.min(n[0]||0,t/2,e/2),a=Math.min(n[1]||0,t/2,e/2),c=Math.min(n[2]||0,t/2,e/2),l=Math.min(n[3]||0,t/2,e/2)),i.moveTo(s+o,r),i.lineTo(s+t-a,r),i.arc(s+t-a,r+a,a,Math.PI*3/2,0,!1),i.lineTo(s+t,r+e-c),i.arc(s+t-c,r+e-c,c,0,Math.PI/2,!1),i.lineTo(s+l,r+e),i.arc(s+l,r+e-l,l,Math.PI/2,Math.PI,!1),i.lineTo(s,r+o),i.arc(s+o,r+o,o,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(i,t,e,n,s){n=Math.abs(n);for(let r=0;r<e;r++){const o=t[(r-1+e)%e],a=t[r],l=t[(r+1)%e],c={x:a.x-o.x,y:a.y-o.y},h={x:l.x-a.x,y:l.y-a.y},u=Math.hypot(c.x,c.y),f=Math.hypot(h.x,h.y);let d;typeof s=="number"?d=s:d=r<s.length?s[r]:0,d=n*Math.cos(Math.PI/e)*Math.min(1,d/n*2);const g={x:c.x/u,y:c.y/u},m={x:h.x/f,y:h.y/f},O={x:a.x-g.x*d,y:a.y-g.y*d},y={x:a.x+m.x*d,y:a.y+m.y*d};r===0?i.moveTo(O.x,O.y):i.lineTo(O.x,O.y),i.arcTo(a.x,a.y,y.x,y.y,d)}}};function H7(i){const t=[],e=i.length,n=L;for(let s=0;s<e;s++){let r=i[s];n._isNumber(r)?r=Math.round(r*1e3)/1e3:n._isString(r)||(r=r+""),t.push(r)}return t}const Dy=",",K7="(",J7=")",tM="([",eM="])",iM=";",nM="()",sM="=",Ly=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],rM=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],oM=100;let Kh=null;function Vy(){if(Kh!==null)return Kh;try{const t=L.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Kh=!1,!1)}catch{return Kh=!1,!1}}class Jd{constructor(t){this.canvas=t,ot.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let n=this.traceArr,s=n.length,r="",o,a,l,c;for(o=0;o<s;o++)a=n[o],l=a.method,l?(c=a.args,r+=l,t?r+=nM:L._isArray(c[0])?r+=tM+c.join(Dy)+eM:(e&&(c=c.map(h=>typeof h=="number"?Math.floor(h):h)),r+=K7+c.join(Dy)+J7)):(r+=a.property,t||(r+=sM+a.val)),r+=iM;return r}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr,n;e.push(t),n=e.length,n>=oM&&e.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){const e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}_applyMiterLimit(t){const e=t.attrs.miterLimit;e!=null&&this.setAttr("miterLimit",e)}setAttr(t,e){this._context[t]=e}arc(t,e,n,s,r,o){this._context.arc(t,e,n,s,r,o)}arcTo(t,e,n,s,r){this._context.arcTo(t,e,n,s,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,n,s,r,o){this._context.bezierCurveTo(t,e,n,s,r,o)}clearRect(t,e,n,s){this._context.clearRect(t,e,n,s)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){const n=arguments;if(n.length===2)return this._context.createImageData(t,e);if(n.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,n,s){return this._context.createLinearGradient(t,e,n,s)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,n,s,r,o){return this._context.createRadialGradient(t,e,n,s,r,o)}drawImage(t,e,n,s,r,o,a,l,c){const h=arguments,u=this._context;h.length===3?u.drawImage(t,e,n):h.length===5?u.drawImage(t,e,n,s,r):h.length===9&&u.drawImage(t,e,n,s,r,o,a,l,c)}ellipse(t,e,n,s,r,o,a,l){this._context.ellipse(t,e,n,s,r,o,a,l)}isPointInPath(t,e,n,s){return n?this._context.isPointInPath(n,t,e,s):this._context.isPointInPath(t,e,s)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,n,s){this._context.fillRect(t,e,n,s)}strokeRect(t,e,n,s){this._context.strokeRect(t,e,n,s)}fillText(t,e,n,s){s?this._context.fillText(t,e,n,s):this._context.fillText(t,e,n)}measureText(t){return this._context.measureText(t)}getImageData(t,e,n,s){return this._context.getImageData(t,e,n,s)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,n,s){this._context.rect(t,e,n,s)}roundRect(t,e,n,s,r){this._context.roundRect(t,e,n,s,r)}putImageData(t,e,n){this._context.putImageData(t,e,n)}quadraticCurveTo(t,e,n,s){this._context.quadraticCurveTo(t,e,n,s)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,n,s,r,o){this._context.setTransform(t,e,n,s,r,o)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,n,s){this._context.strokeText(t,e,n,s)}transform(t,e,n,s,r,o){this._context.transform(t,e,n,s,r,o)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=Ly.length,n=this.setAttr,s,r;const o=function(a){let l=t[a],c;t[a]=function(){return r=H7(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:a,args:r}),c}};for(s=0;s<e;s++)o(Ly[s]);t.setAttr=function(){n.apply(t,arguments);const a=arguments[0];let l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||e==="source-over"||this.setAttr("globalCompositeOperation",e)}}rM.forEach(function(i){Object.defineProperty(Jd.prototype,i,{get(){return this._context[i]},set(t){this._context[i]=t}})});class aM extends Jd{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){const e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),n=t.getFillPriority();if(e&&n==="color"){this._fillColor(t);return}const s=t.getFillPatternImage();if(s&&n==="pattern"){this._fillPattern(t);return}const r=t.getFillLinearGradientColorStops();if(r&&n==="linear-gradient"){this._fillLinearGradient(t);return}const o=t.getFillRadialGradientColorStops();if(o&&n==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):s?this._fillPattern(t):r?this._fillLinearGradient(t):o&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),s=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,n.x,n.y);if(s){for(let o=0;o<s.length;o+=2)r.addColorStop(s[o],s[o+1]);this.setAttr("strokeStyle",r)}}_stroke(t){const e=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}}_applyShadow(t){var e,n,s;const r=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",o=(n=t.getShadowBlur())!==null&&n!==void 0?n:5,a=(s=t.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),h=l.x*c,u=l.y*c;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",o*Math.min(Math.abs(h),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*h),this.setAttr("shadowOffsetY",a.y*u)}}class lM extends Jd{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const e=t.getStrokeScaleEnabled();if(!e){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t);const n=t.hitStrokeWidth(),s=n==="auto"?t.strokeWidth():n;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}let Jh;function cM(){if(Jh)return Jh;const i=L.createCanvasElement(),t=i.getContext("2d");return Jh=(function(){const e=ot._global.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/n})(),L.releaseCanvas(i),Jh}class MO{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(t||{}).pixelRatio||ot.pixelRatio||cM();this.pixelRatio=n,this._canvas=L.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(s){return L.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class kr extends MO{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new aM(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function By(){const i=L.createCanvasElement();i.width=1,i.height=1;const t=i.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const e=t.getImageData(0,0,1,1).data;return!(e[0]===255&&e[1]===0&&e[2]===255&&e[3]===255)}function Zy(){var i,t;return typeof navigator>"u"?!1:(t=(i=navigator.brave)===null||i===void 0?void 0:i.isBrave())!==null&&t!==void 0?t:!1}let Fy=!1;function hM(){return Zy()&&By()&&!Fy&&(Fy=!0,L.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),Zy()&&By()}class EO extends MO{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new lM(this),this.setSize(t.width,t.height),hM()}}const jt={get isDragging(){let i=!1;return jt._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return jt._dragElements.forEach(t=>{i=t.node}),i},_dragElements:new Map,_drag(i){const t=[];jt._dragElements.forEach((e,n)=>{const{node:s}=e,r=s.getStage();r.setPointersPositions(i),e.pointerId===void 0&&(e.pointerId=L._getFirstPointerId(i));const o=r._changedPointerPositions.find(a=>a.id===e.pointerId);if(o){if(e.dragStatus!=="dragging"){const a=s.dragDistance();if(Math.max(Math.abs(o.x-e.startPointerPos.x),Math.abs(o.y-e.startPointerPos.y))<a||(s.startDrag({evt:i}),!s.isDragging()))return}s._setDragPosition(i,e),t.push(s)}}),t.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:i},!0)})},_endDragBefore(i){const t=[];jt._dragElements.forEach(e=>{const{node:n}=e,s=n.getStage();if(i&&s.setPointersPositions(i),!s._changedPointerPositions.find(a=>a.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(jt.justDragged=!0,ot._mouseListenClick=!1,ot._touchListenClick=!1,ot._pointerListenClick=!1,e.dragStatus="stopped");const o=e.node.getLayer()||e.node instanceof ot.Stage&&e.node;o&&t.indexOf(o)===-1&&t.push(o)}),t.forEach(e=>{e.draw()})},_endDragAfter(i){jt._dragElements.forEach((t,e)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:i},!0),t.dragStatus!=="dragging"&&jt._dragElements.delete(e)})}};ot.isBrowser&&(window.addEventListener("mouseup",jt._endDragBefore,!0),window.addEventListener("touchend",jt._endDragBefore,!0),window.addEventListener("touchcancel",jt._endDragBefore,!0),window.addEventListener("mousemove",jt._drag),window.addEventListener("touchmove",jt._drag),window.addEventListener("mouseup",jt._endDragAfter,!1),window.addEventListener("touchend",jt._endDragAfter,!1),window.addEventListener("touchcancel",jt._endDragAfter,!1));function Kr(i){return L._isString(i)?'"'+i+'"':Object.prototype.toString.call(i)==="[object Number]"||L._isBoolean(i)?i:Object.prototype.toString.call(i)}function aS(i){return i>255?255:i<0?0:Math.round(i)}function nt(){if(ot.isUnminified)return function(i,t){return L._isNumber(i)||L.warn(Kr(i)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),i}}function tp(i){if(ot.isUnminified)return function(t,e){let n=L._isNumber(t),s=L._isArray(t)&&t.length==i;return!n&&!s&&L.warn(Kr(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+i+")"),t}}function RO(){if(ot.isUnminified)return function(i,t){return L._isNumber(i)||i==="auto"||L.warn(Kr(i)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),i}}function Go(){if(ot.isUnminified)return function(i,t){return L._isString(i)||L.warn(Kr(i)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),i}}function lS(){if(ot.isUnminified)return function(i,t){const e=L._isString(i),n=Object.prototype.toString.call(i)==="[object CanvasGradient]"||i&&i.addColorStop;return e||n||L.warn(Kr(i)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),i}}function uM(){if(ot.isUnminified)return function(i,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&i instanceof e||(L._isArray(i)?i.forEach(function(n){L._isNumber(n)||L.warn('"'+t+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):L.warn(Kr(i)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),i}}function Gn(){if(ot.isUnminified)return function(i,t){return i===!0||i===!1||L.warn(Kr(i)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),i}}function fM(i){if(ot.isUnminified)return function(t,e){return t==null||L.isObject(t)||L.warn(Kr(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+i),t}}const Tl="get",Pl="set",P={addGetterSetter(i,t,e,n,s){P.addGetter(i,t,e),P.addSetter(i,t,n,s),P.addOverloadedGetterSetter(i,t)},addGetter(i,t,e){const n=Tl+L._capitalize(t);i.prototype[n]=i.prototype[n]||function(){const s=this.attrs[t];return s===void 0?e:s}},addSetter(i,t,e,n){const s=Pl+L._capitalize(t);i.prototype[s]||P.overWriteSetter(i,t,e,n)},overWriteSetter(i,t,e,n){const s=Pl+L._capitalize(t);i.prototype[s]=function(r){return e&&r!==void 0&&r!==null&&(r=e.call(this,r,t)),this._setAttr(t,r),n&&n.call(this),this}},addComponentsGetterSetter(i,t,e,n,s){const r=e.length,o=L._capitalize,a=Tl+o(t),l=Pl+o(t);i.prototype[a]=function(){const h={};for(let u=0;u<r;u++){const f=e[u];h[f]=this.getAttr(t+o(f))}return h};const c=fM(e);i.prototype[l]=function(h){const u=this.attrs[t];n&&(h=n.call(this,h,t)),c&&c.call(this,h,t);for(const f in h)h.hasOwnProperty(f)&&this._setAttr(t+o(f),h[f]);return h||e.forEach(f=>{this._setAttr(t+o(f),void 0)}),this._fireChangeEvent(t,u,h),s&&s.call(this),this},P.addOverloadedGetterSetter(i,t)},addOverloadedGetterSetter(i,t){const e=L._capitalize(t),n=Pl+e,s=Tl+e;i.prototype[t]=function(){return arguments.length?(this[n](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(i,t,e,n){L.error("Adding deprecated "+t);const s=Tl+L._capitalize(t),r=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";i.prototype[s]=function(){L.error(r);const o=this.attrs[t];return o===void 0?e:o},P.addSetter(i,t,n,function(){L.error(r)}),P.addOverloadedGetterSetter(i,t)},backCompat(i,t){L.each(t,function(e,n){const s=i.prototype[n],r=Tl+L._capitalize(e),o=Pl+L._capitalize(e);function a(){s.apply(this,arguments),L.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}i.prototype[e]=a,i.prototype[r]=a,i.prototype[o]=a})},afterSetFilter(){this._filterUpToDate=!1}};function dM(i){const t=/(\w+)\(([^)]+)\)/g;let e;for(;(e=t.exec(i))!==null;){const[,n,s]=e;switch(n){case"blur":{const r=parseFloat(s.replace("px",""));return function(o){this.blurRadius(r*.5);const a=ot.Filters;a&&a.Blur&&a.Blur.call(this,o)}}case"brightness":{const r=s.includes("%")?parseFloat(s)/100:parseFloat(s);return function(o){this.brightness(r);const a=ot.Filters;a&&a.Brightness&&a.Brightness.call(this,o)}}case"contrast":{const r=parseFloat(s);return function(o){const a=100*(Math.sqrt(r)-1);this.contrast(a);const l=ot.Filters;l&&l.Contrast&&l.Contrast.call(this,o)}}case"grayscale":return function(r){const o=ot.Filters;o&&o.Grayscale&&o.Grayscale.call(this,r)};case"sepia":return function(r){const o=ot.Filters;o&&o.Sepia&&o.Sepia.call(this,r)};case"invert":return function(r){const o=ot.Filters;o&&o.Invert&&o.Invert.call(this,r)};default:L.warn(`CSS filter "${n}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const ef="absoluteOpacity",tu="allEventListeners",Ds="absoluteTransform",Wy="absoluteScale",lo="canvas",pM="Change",gM="children",mM="konva",nm="listening",OM="mouseenter",yM="mouseleave",bM="pointerenter",vM="pointerleave",_M="touchenter",xM="touchleave",qy="set",Xy="Shape",nf=" ",zy="stage",Or="transform",SM="Stage",sm="visible",wM=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(nf);let kM=1,st=class rm{constructor(t){this._id=kM++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===Or||t===Ds)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let n=this._cache.get(t);return(n===void 0||(t===Or||t===Ds)&&n.dirty===!0)&&(n=e.call(this),this._cache.set(t,n)),n}_calculate(t,e,n){if(!this._attachedDepsListeners.get(t)){const s=e.map(r=>r+"Change.konva").join(nf);this.on(s,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)}_getCanvasCache(){return this._cache.get(lo)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Ds&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(lo)){const{scene:t,filter:e,hit:n,buffer:s}=this._cache.get(lo);L.releaseCanvas(t,e,n,s),this._cache.delete(lo)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const e=t||{};let n={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(e.width||n.width),r=Math.ceil(e.height||n.height),o=e.pixelRatio,a=e.x===void 0?Math.floor(n.x):e.x,l=e.y===void 0?Math.floor(n.y):e.y,c=e.offset||0,h=e.drawBorder||!1,u=e.hitCanvasPixelRatio||1;if(!s||!r){L.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const f=Math.abs(Math.round(n.x)-a)>.5?1:0,d=Math.abs(Math.round(n.y)-l)>.5?1:0;s+=c*2+f,r+=c*2+d,a-=c,l-=c;const p=new kr({pixelRatio:o,width:s,height:r}),g=new kr({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),m=new EO({pixelRatio:u,width:s,height:r}),O=p.getContext(),y=m.getContext(),_=new kr({width:p.width/p.pixelRatio+Math.abs(a),height:p.height/p.pixelRatio+Math.abs(l),pixelRatio:p.pixelRatio}),v=_.getContext();return m.isCache=!0,p.isCache=!0,this._cache.delete(lo),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(p.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),O.save(),y.save(),v.save(),O.translate(-a,-l),y.translate(-a,-l),v.translate(-a,-l),_.x=a,_.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(ef),this._clearSelfAndDescendantCache(Wy),this.drawScene(p,this,_),this.drawHit(m,this),this._isUnderCache=!1,O.restore(),y.restore(),h&&(O.save(),O.beginPath(),O.rect(0,0,s,r),O.closePath(),O.setAttr("strokeStyle","red"),O.setAttr("lineWidth",5),O.stroke(),O.restore()),this._cache.set(lo,{scene:p,filter:g,hit:m,buffer:_,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(lo)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){const n=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let s=1/0,r=1/0,o=-1/0,a=-1/0;const l=this.getAbsoluteTransform(e);return n.forEach(function(c){const h=l.point(c);s===void 0&&(s=o=h.x,r=a=h.y),s=Math.min(s,h.x),r=Math.min(r,h.y),o=Math.max(o,h.x),a=Math.max(a,h.y)}),{x:s,y:r,width:o-s,height:a-r}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);const n=this._getCachedSceneCanvas(),s=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/s,n.height/s),t.restore()}_drawCachedHitCanvas(t){const e=this._getCanvasCache(),n=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),n=e.scene,s=e.filter,r=s.getContext(),o,a,l,c;if(!t||t.length===0)return n;if(this._filterUpToDate)return s;let h=!0;for(let f=0;f<t.length;f++)if(typeof t[f]=="string"&&Vy(),typeof t[f]!="string"||!Vy()){h=!1;break}const u=n.pixelRatio;if(s.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio),h){const f=t.join(" ");return r.save(),r.setAttr("filter",f),r.drawImage(n._canvas,0,0,n.getWidth()/u,n.getHeight()/u),r.restore(),this._filterUpToDate=!0,s}try{for(o=t.length,r.clear(),r.drawImage(n._canvas,0,0,n.getWidth()/u,n.getHeight()/u),a=r.getImageData(0,0,s.getWidth(),s.getHeight()),l=0;l<o;l++)c=t[l],typeof c=="string"&&(c=dM(c)),c.call(this,a),r.putImageData(a,0,0)}catch(f){L.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,s}on(t,e){if(this._cache&&this._cache.delete(tu),arguments.length===3)return this._delegate.apply(this,arguments);const n=t.split(nf);for(let s=0;s<n.length;s++){const o=n[s].split("."),a=o[0],l=o[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:e})}return this}off(t,e){let n=(t||"").split(nf),s=n.length,r,o,a,l,c,h;if(this._cache&&this._cache.delete(tu),!t)for(o in this.eventListeners)this._off(o);for(r=0;r<s;r++)if(a=n[r],l=a.split("."),c=l[0],h=l[1],c)this.eventListeners[c]&&this._off(c,h,e);else for(o in this.eventListeners)this._off(o,h,e);return this}dispatchEvent(t){const e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(n){e.call(this,n.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,n){const s=this;this.on(t,function(r){const o=r.target.findAncestors(e,!0,s);for(let a=0;a<o.length;a++)r=L.cloneObject(r),r.currentTarget=o[a],n.call(o[a],r)})}remove(){return this.isDragging()&&this.stopDrag(),jt._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ds),this._clearSelfAndDescendantCache(ef),this._clearSelfAndDescendantCache(Wy),this._clearSelfAndDescendantCache(zy),this._clearSelfAndDescendantCache(sm),this._clearSelfAndDescendantCache(nm)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const e="get"+L._capitalize(t);return L._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,n;if(!t)return this;for(e in t)e!==gM&&(n=qy+L._capitalize(e),L._isFunction(this[n])?this[n](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(nm,this._isListening)}_isListening(t){if(!this.listening())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isListening(t):!0}isVisible(){return this._getCache(sm,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const n=this.getParent();return n&&n!==t&&this!==t?n._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);const n=this.getLayer();let s=!1;jt._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===n)&&(s=!0)});const r=!e&&!ot.hitOnDragEnabled&&(s||ot.isTransforming());return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,n=0,s,r,o,a;function l(h){for(s=[],r=h.length,o=0;o<r;o++)a=h[o],n++,a.nodeType!==Xy&&(s=s.concat(a.getChildren().slice())),a._id===e._id&&(o=r);s.length>0&&s[0].getDepth()<=t&&l(s)}const c=this.getStage();return e.nodeType!==SM&&c&&l(c.getChildren()),n}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Or),this._clearSelfAndDescendantCache(Ds)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const e=t.getPointerPosition();if(!e)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(e)}getAbsolutePosition(t){let e=!1,n=this.parent;for(;n;){if(n.isCached()){e=!0;break}n=n.parent}e&&!t&&(t=!0);const s=this.getAbsoluteTransform(t).getMatrix(),r=new an,o=this.offset();return r.m=s.slice(),r.translate(o.x,o.y),r.getTranslation()}setAbsolutePosition(t){const{x:e,y:n,...s}=this._clearTransform();this.attrs.x=e,this.attrs.y=n,this._clearCache(Or);const r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(t.x,t.y),t={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(s),this.setPosition({x:t.x,y:t.y}),this._clearCache(Or),this._clearSelfAndDescendantCache(Ds),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,n=t.y,s=this.x(),r=this.y();return e!==void 0&&(s+=e),n!==void 0&&(r+=n),this.setPosition({x:s,y:r}),this}_eachAncestorReverse(t,e){let n=[],s=this.getParent(),r,o;if(!(e&&e._id===this._id)){for(n.unshift(this);s&&(!e||s._id!==e._id);)n.unshift(s),s=s.parent;for(r=n.length,o=0;o<r;o++)t(n[o])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return L.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return L.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return L.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return L.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return L.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&L.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ef,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,n,s,r,o;const a={attrs:{},className:this.getClassName()};for(e in t)n=t[e],o=L.isObject(n)&&!L._isPlainObject(n)&&!L._isArray(n),!o&&(s=typeof this[e]=="function"&&this[e],delete t[e],r=s?s.call(this):null,t[e]=n,r!==n&&(a.attrs[e]=n));return L._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,n){const s=[];e&&this._isMatch(t)&&s.push(this);let r=this.parent;for(;r;){if(r===n)return s;r._isMatch(t)&&s.push(r),r=r.parent}return s}isAncestorOf(t){return!1}findAncestor(t,e,n){return this.findAncestors(t,e,n)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let e=t.replace(/ /g,"").split(","),n=e.length,s,r;for(s=0;s<n;s++)if(r=e[s],L.isValidSelector(r)||(L.warn('Selector "'+r+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),L.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),L.warn("Konva is awesome, right?")),r.charAt(0)==="#"){if(this.id()===r.slice(1))return!0}else if(r.charAt(0)==="."){if(this.hasName(r.slice(1)))return!0}else if(this.className===r||this.nodeType===r)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(zy,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,e={},n){return e.target=e.target||this,n?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Ds,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new an,this._eachAncestorReverse(function(n){const s=n.transformsEnabled();s==="all"?e.multiply(n.getTransform()):s==="position"&&e.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},t),e;{e=this._cache.get(Ds)||new an,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();const n=this.transformsEnabled();if(n==="all")e.multiply(this.getTransform());else if(n==="position"){const s=this.attrs.x||0,r=this.attrs.y||0,o=this.attrs.offsetX||0,a=this.attrs.offsetY||0;e.translate(s-o,r-a)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();const s=this.getAbsoluteTransform(t).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Or,this._getTransform)}_getTransform(){var t,e;const n=this._cache.get(Or)||new an;n.reset();const s=this.x(),r=this.y(),o=ot.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,h=this.attrs.skewY||0,u=this.attrs.offsetX||0,f=this.attrs.offsetY||0;return(s!==0||r!==0)&&n.translate(s,r),o!==0&&n.rotate(o),(c!==0||h!==0)&&n.skew(c,h),(a!==1||l!==1)&&n.scale(a,l),(u!==0||f!==0)&&n.translate(-1*u,-1*f),n.dirty=!1,n}clone(t){let e=L.cloneObject(this.attrs),n,s,r,o,a;for(n in t)e[n]=t[n];const l=new this.constructor(e);for(n in this.eventListeners)for(s=this.eventListeners[n],r=s.length,o=0;o<r;o++)a=s[o],a.name.indexOf(mM)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(a));return l}_toKonvaCanvas(t){t=t||{};const e=this.getClientRect(),n=this.getStage(),s=t.x!==void 0?t.x:Math.floor(e.x),r=t.y!==void 0?t.y:Math.floor(e.y),o=t.pixelRatio||1,a=new kr({width:t.width||Math.ceil(e.width)||(n?n.width():0),height:t.height||Math.ceil(e.height)||(n?n.height():0),pixelRatio:o}),l=a.getContext(),c=new kr({width:a.width/a.pixelRatio+Math.abs(s),height:a.height/a.pixelRatio+Math.abs(r),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(s||r)&&l.translate(-1*s,-1*r),this.drawScene(a,void 0,c),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const e=t.mimeType||null,n=t.quality||null,s=this._toKonvaCanvas(t).toDataURL(e,n);return t.callback&&t.callback(s),s}toImage(t){return new Promise((e,n)=>{try{const s=t?.callback;s&&delete t.callback,L._urlToImage(this.toDataURL(t),function(r){e(r),s?.(r)})}catch(s){n(s)}})}toBlob(t){return new Promise((e,n)=>{try{const s=t?.callback;s&&delete t.callback,this.toCanvas(t).toBlob(r=>{e(r),s?.(r)},t?.mimeType,t?.quality)}catch(s){n(s)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():ot.dragDistance}_off(t,e,n){let s=this.eventListeners[t],r,o,a;for(r=0;r<s.length;r++)if(o=s[r].name,a=s[r].handler,(o!=="konva"||e==="konva")&&(!e||o===e)&&(!n||n===a)){if(s.splice(r,1),s.length===0){delete this.eventListeners[t];break}r--}}_fireChangeEvent(t,e,n){this._fire(t+pM,{oldVal:e,newVal:n})}addName(t){if(!this.hasName(t)){const e=this.name(),n=e?e+" "+t:t;this.name(n)}return this}hasName(t){if(!t)return!1;const e=this.name();return e?(e||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const e=(this.name()||"").split(/\s/g),n=e.indexOf(t);return n!==-1&&(e.splice(n,1),this.name(e.join(" "))),this}setAttr(t,e){const n=this[qy+L._capitalize(t)];return L._isFunction(n)?n.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(ot.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){const n=this.attrs[t];n===e&&!L.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,n,e),this._requestDraw())}_setComponentAttr(t,e,n){let s;n!==void 0&&(s=this.attrs[t],s||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,s,n))}_fireAndBubble(t,e,n){e&&this.nodeType===Xy&&(e.target=this);const s=[OM,yM,bM,vM,_M,xM];if(!(s.indexOf(t)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(t,e);const o=s.indexOf(t)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!o&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,n,s;const r=(e=this._cache.get(tu))!==null&&e!==void 0?e:{};let o=r?.[t];if(o===void 0){o=[];let a=Object.getPrototypeOf(this);for(;a;){const l=(s=(n=a.eventListeners)===null||n===void 0?void 0:n[t])!==null&&s!==void 0?s:[];o.push(...l),a=Object.getPrototypeOf(a)}r[t]=o,this._cache.set(tu,r)}return o}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const n=this._getProtoListeners(t);if(n)for(let r=0;r<n.length;r++)n[r].handler.call(this,e);const s=this.eventListeners[t];if(s)for(let r=0;r<s.length;r++)s[r].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const e=t?t.pointerId:void 0,n=this.getStage(),s=this.getAbsolutePosition();if(!n)return;const r=n._getPointerById(e)||n._changedPointerPositions[0]||s;jt._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-s.x,y:r.y-s.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){jt._dragElements.has(this._id)||this._createDragElement(t);const n=jt._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const n=this.getStage()._getPointerById(e.pointerId);if(!n)return;let s={x:n.x-e.offset.x,y:n.y-e.offset.y};const r=this.dragBoundFunc();if(r!==void 0){const o=r.call(this,s,t);o?s=o:L.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(t){const e=jt._dragElements.get(this._id);e&&(e.dragStatus="stopped"),jt._endDragBefore(t),jt._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=jt._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||ot.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let s=!1;jt._dragElements.forEach(r=>{this.isAncestorOf(r.node)&&(s=!0)}),s||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const e=jt._dragElements.get(this._id),n=e&&e.dragStatus==="dragging",s=e&&e.dragStatus==="ready";n?this.stopDrag():s&&jt._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const n={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return L.haveIntersection(n,this.getClientRect())}static create(t,e){return L._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let n=rm.prototype.getClassName.call(t),s=t.children,r,o,a;e&&(t.attrs.container=e),ot[n]||(L.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=ot[n];if(r=new l(t.attrs),s)for(o=s.length,a=0;a<o;a++)r.add(rm._createNode(s[a]));return r}};st.prototype.nodeType="Node";st.prototype._attrsAffectingSize=[];st.prototype.eventListeners={};st.prototype.on.call(st.prototype,wM,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Or),this._clearSelfAndDescendantCache(Ds)});st.prototype.on.call(st.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(sm)});st.prototype.on.call(st.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(nm)});st.prototype.on.call(st.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ef)});const oe=P.addGetterSetter;oe(st,"zIndex");oe(st,"absolutePosition");oe(st,"position");oe(st,"x",0,nt());oe(st,"y",0,nt());oe(st,"globalCompositeOperation","source-over",Go());oe(st,"opacity",1,nt());oe(st,"name","",Go());oe(st,"id","",Go());oe(st,"rotation",0,nt());P.addComponentsGetterSetter(st,"scale",["x","y"]);oe(st,"scaleX",1,nt());oe(st,"scaleY",1,nt());P.addComponentsGetterSetter(st,"skew",["x","y"]);oe(st,"skewX",0,nt());oe(st,"skewY",0,nt());P.addComponentsGetterSetter(st,"offset",["x","y"]);oe(st,"offsetX",0,nt());oe(st,"offsetY",0,nt());oe(st,"dragDistance",void 0,nt());oe(st,"width",0,nt());oe(st,"height",0,nt());oe(st,"listening",!0,Gn());oe(st,"preventDefault",!0,Gn());oe(st,"filters",void 0,function(i){return this._filterUpToDate=!1,i});oe(st,"visible",!0,Gn());oe(st,"transformsEnabled","all",Go());oe(st,"size");oe(st,"dragBoundFunc");oe(st,"draggable",!1,Gn());P.backCompat(st,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class un extends st{constructor(){super(...arguments),this.children=[]}getChildren(t){const e=this.children||[];return t?e.filter(t):e}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let n=0;n<t.length;n++)this.add(t[n]);return this}const e=t[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){const n=[];return this._descendants(s=>{const r=s._isMatch(t);return r&&n.push(s),!!(r&&e)}),n}_descendants(t){let e=!1;const n=this.getChildren();for(const s of n){if(e=t(s),e)return!0;if(s.hasChildren()&&(e=s._descendants(t),e))return!0}return!1}toObject(){const t=st.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){const e=st.prototype.clone.call(this,t);return this.getChildren().forEach(function(n){e.add(n.clone())}),e}getAllIntersections(t){const e=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(t)&&e.push(n)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(n){n._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,n){e.index=n}),this._requestDraw()}drawScene(t,e,n){const s=this.getLayer(),r=t||s&&s.getCanvas(),o=r&&r.getContext(),a=this._getCanvasCache(),l=a&&a.scene,c=r&&r.isCache;if(!this.isVisible()&&!c)return this;if(l){o.save();const h=this.getAbsoluteTransform(e).getMatrix();o.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",r,e,n);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;const n=this.getLayer(),s=t||n&&n.hitCanvas,r=s&&s.getContext(),o=this._getCanvasCache();if(o&&o.hit){r.save();const l=this.getAbsoluteTransform(e).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",s,e);return this}_drawChildren(t,e,n,s){var r;const o=e&&e.getContext(),a=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),h=typeof a=="number"&&typeof l=="number"||c,u=n===this;if(h){o.save();const d=this.getAbsoluteTransform(n);let p=d.getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),o.beginPath();let g;if(c)g=c.call(this,o,this);else{const m=this.clipX(),O=this.clipY();o.rect(m||0,O||0,a,l)}o.clip.apply(o,g),p=d.copy().invert().getMatrix(),o.transform(p[0],p[1],p[2],p[3],p[4],p[5])}const f=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";f&&(o.save(),o._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(d){d[t](e,n,s)}),f&&o.restore(),h&&o.restore()}getClientRect(t={}){var e;const n=t.skipTransform,s=t.relativeTo;let r,o,a,l,c={x:1/0,y:1/0,width:0,height:0};const h=this;(e=this.children)===null||e===void 0||e.forEach(function(d){if(!d.visible())return;const p=d.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});p.width===0&&p.height===0||(r===void 0?(r=p.x,o=p.y,a=p.x+p.width,l=p.y+p.height):(r=Math.min(r,p.x),o=Math.min(o,p.y),a=Math.max(a,p.x+p.width),l=Math.max(l,p.y+p.height)))});const u=this.find("Shape");let f=!1;for(let d=0;d<u.length;d++)if(u[d]._isVisible(this)){f=!0;break}return f&&r!==void 0?c={x:r,y:o,width:a-r,height:l-o}:c={x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,s)}}P.addComponentsGetterSetter(un,"clip",["x","y","width","height"]);P.addGetterSetter(un,"clipX",void 0,nt());P.addGetterSetter(un,"clipY",void 0,nt());P.addGetterSetter(un,"clipWidth",void 0,nt());P.addGetterSetter(un,"clipHeight",void 0,nt());P.addGetterSetter(un,"clipFunc");const Lc=new Map,cS=ot._global.PointerEvent!==void 0;function Np(i){return Lc.get(i)}function IO(i){return{evt:i,pointerId:i.pointerId}}function hS(i,t){return Lc.get(i)===t}function uS(i,t){Oc(i),t.getStage()&&(Lc.set(i,t),cS&&t._fire("gotpointercapture",IO(new PointerEvent("gotpointercapture"))))}function Oc(i,t){const e=Lc.get(i);if(!e)return;const n=e.getStage();n&&n.content,Lc.delete(i),cS&&e._fire("lostpointercapture",IO(new PointerEvent("lostpointercapture")))}const CM="Stage",TM="string",Gy="px",PM="mouseout",fS="mouseleave",dS="mouseover",pS="mouseenter",gS="mousemove",mS="mousedown",OS="mouseup",Hl="pointermove",Kl="pointerdown",ba="pointerup",Jl="pointercancel",AM="lostpointercapture",eu="pointerout",tc="pointerleave",iu="pointerover",nu="pointerenter",om="contextmenu",yS="touchstart",bS="touchend",vS="touchmove",_S="touchcancel",am="wheel",MM=5,EM=[[pS,"_pointerenter"],[mS,"_pointerdown"],[gS,"_pointermove"],[OS,"_pointerup"],[fS,"_pointerleave"],[yS,"_pointerdown"],[vS,"_pointermove"],[bS,"_pointerup"],[_S,"_pointercancel"],[dS,"_pointerover"],[am,"_wheel"],[om,"_contextmenu"],[Kl,"_pointerdown"],[Hl,"_pointermove"],[ba,"_pointerup"],[Jl,"_pointercancel"],[tc,"_pointerleave"],[AM,"_lostpointercapture"]],$p={mouse:{[eu]:PM,[tc]:fS,[iu]:dS,[nu]:pS,[Hl]:gS,[Kl]:mS,[ba]:OS,[Jl]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[eu]:"touchout",[tc]:"touchleave",[iu]:"touchover",[nu]:"touchenter",[Hl]:vS,[Kl]:yS,[ba]:bS,[Jl]:_S,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[eu]:eu,[tc]:tc,[iu]:iu,[nu]:nu,[Hl]:Hl,[Kl]:Kl,[ba]:ba,[Jl]:Jl,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ec=i=>i.indexOf("pointer")>=0?"pointer":i.indexOf("touch")>=0?"touch":"mouse",ea=i=>{const t=ec(i);if(t==="pointer")return ot.pointerEventsEnabled&&$p.pointer;if(t==="touch")return $p.touch;if(t==="mouse")return $p.mouse};function jy(i={}){return(i.clipFunc||i.clipWidth||i.clipHeight)&&L.warn("Stage does not support clipping. Please use clip for Layers or Groups."),i}const RM="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",yc=[];class ep extends un{constructor(t){super(jy(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),yc.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{jy(this.attrs)}),this._checkVisibility()}_validateAdd(t){const e=t.getType()==="Layer",n=t.getType()==="FastLayer";e||n||L.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===TM){let e;if(t.charAt(0)==="."){const n=t.slice(1);t=document.getElementsByClassName(n)[0]}else t.charAt(0)!=="#"?e=t:e=t.slice(1),t=document.getElementById(e);if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,e=t.length;for(let n=0;n<e;n++)t[n].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),un.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&L._isInDocument(t)&&this.container().removeChild(t);const e=yc.indexOf(this);return e>-1&&yc.splice(e,1),L.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(L.warn(RM),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const e=new kr({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=e.getContext()._context,s=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),s.forEach(function(r){if(!r.isVisible())return;const o=r._toKonvaCanvas(t);n.drawImage(o._canvas,t.x,t.y,o.getWidth()/o.getPixelRatio(),o.getHeight()/o.getPixelRatio())}),e}getIntersection(t){if(!t)return null;const e=this.children,n=e.length,s=n-1;for(let r=s;r>=0;r--){const o=e[r].getIntersection(t);if(o)return o}return null}_resizeDOM(){const t=this.width(),e=this.height();this.content&&(this.content.style.width=t+Gy,this.content.style.height=e+Gy),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(n=>{n.setSize({width:t,height:e}),n.draw()})}add(t,...e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}super.add(t);const n=this.children.length;return n>MM&&L.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),ot.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return hS(t,this)}setPointerCapture(t){uS(t,this)}releaseCapture(t){Oc(t)}getLayers(){return this.children}_bindContentEvents(){ot.isBrowser&&EM.forEach(([t,e])=>{this.content.addEventListener(t,n=>{this[e](n)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const e=ea(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=ea(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=ea(t.type),n=ec(t.type);if(!e)return;this.setPointersPositions(t);const s=this._getTargetShape(n),r=!(ot.isDragging()||ot.isTransforming())||ot.hitOnDragEnabled;s&&r?(s._fireAndBubble(e.pointerout,{evt:t}),s._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[n+"targetShape"]=null):r&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const e=ea(t.type),n=ec(t.type);if(!e)return;this.setPointersPositions(t);let s=!1;this._changedPointerPositions.forEach(r=>{const o=this.getIntersection(r);if(jt.justDragged=!1,ot["_"+n+"ListenClick"]=!0,!o||!o.isListening()){this[n+"ClickStartShape"]=void 0;return}ot.capturePointerEventsEnabled&&o.setPointerCapture(r.id),this[n+"ClickStartShape"]=o,o._fireAndBubble(e.pointerdown,{evt:t,pointerId:r.id}),s=!0;const a=t.type.indexOf("touch")>=0;o.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),s||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const e=ea(t.type),n=ec(t.type);if(!e)return;const s=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(ot.isDragging()&&jt.node.preventDefault()&&t.cancelable&&s&&t.preventDefault(),this.setPointersPositions(t),!(!(ot.isDragging()||ot.isTransforming())||ot.hitOnDragEnabled))return;const o={};let a=!1;const l=this._getTargetShape(n);this._changedPointerPositions.forEach(c=>{const h=Np(c.id)||this.getIntersection(c),u=c.id,f={evt:t,pointerId:u},d=l!==h;if(d&&l&&(l._fireAndBubble(e.pointerout,{...f},h),l._fireAndBubble(e.pointerleave,{...f},h)),h){if(o[h._id])return;o[h._id]=!0}h&&h.isListening()?(a=!0,d&&(h._fireAndBubble(e.pointerover,{...f},l),h._fireAndBubble(e.pointerenter,{...f},l),this[n+"targetShape"]=h),h._fireAndBubble(e.pointermove,{...f})):l&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:u}),this[n+"targetShape"]=null)}),a||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=ea(t.type),n=ec(t.type);if(!e)return;this.setPointersPositions(t);const s=this[n+"ClickStartShape"],r=this[n+"ClickEndShape"],o={};let a=!1;this._changedPointerPositions.forEach(l=>{const c=Np(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),o[c._id])return;o[c._id]=!0}const h=l.id,u={evt:t,pointerId:h};let f=!1;ot["_"+n+"InDblClickWindow"]?(f=!0,clearTimeout(this[n+"DblTimeout"])):jt.justDragged||(ot["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){ot["_"+n+"InDblClickWindow"]=!1},ot.dblClickWindow),c&&c.isListening()?(a=!0,this[n+"ClickEndShape"]=c,c._fireAndBubble(e.pointerup,{...u}),ot["_"+n+"ListenClick"]&&s&&s===c&&(c._fireAndBubble(e.pointerclick,{...u}),f&&r&&r===c&&c._fireAndBubble(e.pointerdblclick,{...u}))):(this[n+"ClickEndShape"]=null,a||(this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a=!0),ot["_"+n+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:h}),f&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:h}))}),a||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),ot["_"+n+"ListenClick"]=!1,t.cancelable&&n!=="touch"&&n!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(om,{evt:t}):this._fire(om,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(am,{evt:t}):this._fire(am,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=Np(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(ba,IO(t)),Oc(t.pointerId)}_lostpointercapture(t){Oc(t.pointerId)}setPointersPositions(t){const e=this._getContentPosition();let n=null,s=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,r=>{this._pointerPositions.push({id:r.identifier,x:(r.clientX-e.left)/e.scaleX,y:(r.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,r=>{this._changedPointerPositions.push({id:r.identifier,x:(r.clientX-e.left)/e.scaleX,y:(r.clientY-e.top)/e.scaleY})})):(n=(t.clientX-e.left)/e.scaleX,s=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:n,y:s},this._pointerPositions=[{x:n,y:s,id:L._getFirstPointerId(t)}],this._changedPointerPositions=[{x:n,y:s,id:L._getFirstPointerId(t)}])}_setPointerPosition(t){L.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new kr({width:this.width(),height:this.height()}),this.bufferHitCanvas=new EO({pixelRatio:1,width:this.width(),height:this.height()}),!ot.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return L.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}}ep.prototype.nodeType=CM;we(ep);P.addGetterSetter(ep,"container");ot.isBrowser&&document.addEventListener("visibilitychange",()=>{yc.forEach(i=>{i.batchDraw()})});const xS="hasShadow",SS="shadowRGBA",wS="patternImage",kS="linearGradient",CS="radialGradient";let su;function Dp(){return su||(su=L.createCanvasElement().getContext("2d"),su)}const bc={};function IM(i){const t=this.attrs.fillRule;t?i.fill(t):i.fill()}function QM(i){i.stroke()}function NM(i){const t=this.attrs.fillRule;t?i.fill(t):i.fill()}function $M(i){i.stroke()}function DM(){this._clearCache(xS)}function LM(){this._clearCache(SS)}function VM(){this._clearCache(wS)}function BM(){this._clearCache(kS)}function ZM(){this._clearCache(CS)}class et extends st{constructor(t){super(t);let e;for(;e=L.getRandomColor(),!(e&&!(e in bc)););this.colorKey=e,bc[e]=this}getContext(){return L.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return L.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(xS,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(wS,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=Dp().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const n=new an;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(ot.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const s=n.getMatrix(),r=typeof DOMMatrix>"u"?{a:s[0],b:s[1],c:s[2],d:s[3],e:s[4],f:s[5]}:new DOMMatrix(s);e.setTransform(r)}return e}}_getLinearGradient(){return this._getCache(kS,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const e=Dp(),n=this.fillLinearGradientStartPoint(),s=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(n.x,n.y,s.x,s.y);for(let o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}}_getRadialGradient(){return this._getCache(CS,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const e=Dp(),n=this.fillRadialGradientStartPoint(),s=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),s.x,s.y,this.fillRadialGradientEndRadius());for(let o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}}getShadowRGBA(){return this._getCache(SS,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=L.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const e=this.getStage();if(!e)return!1;const n=e.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return st.prototype.destroy.call(this),delete bc[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!((e=this.attrs.perfectDrawEnabled)!==null&&e!==void 0?e:!0))return!1;const s=t||this.hasFill(),r=this.hasStroke(),o=this.getAbsoluteOpacity()!==1;if(s&&r&&o)return!0;const a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(s&&r&&a&&l)}setStrokeHitEnabled(t){L.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,n=this.getParent();for(;n;){if(n.isCached()){e=!0;break}n=n.getParent()}const s=t.skipTransform,r=t.relativeTo||e&&this.getStage()||void 0,o=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=o.width+l,h=o.height+l,u=!t.skipShadow&&this.hasShadow(),f=u?this.shadowOffsetX():0,d=u?this.shadowOffsetY():0,p=c+Math.abs(f),g=h+Math.abs(d),m=u&&this.shadowBlur()||0,O=p+m*2,y=g+m*2,_={width:O,height:y,x:-(l/2+m)+Math.min(f,0)+o.x,y:-(l/2+m)+Math.min(d,0)+o.y};return s?_:this._transformedRect(_,r)}drawScene(t,e,n){const s=this.getLayer(),r=t||s.getCanvas(),o=r.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow();let h;const u=e===this;if(!this.isVisible()&&!u)return this;if(a){o.save();const f=this.getAbsoluteTransform(e).getMatrix();return o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!l)return this;if(o.save(),this._useBufferCanvas()){h=this.getStage();const f=n||h.bufferCanvas,d=f.getContext();d.clear(),d.save(),d._applyLineJoin(this),d._applyMiterLimit(this);const p=this.getAbsoluteTransform(e).getMatrix();d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.call(this,d,this),d.restore();const g=f.pixelRatio;c&&o._applyShadow(this),o._applyOpacity(this),o._applyGlobalCompositeOperation(this),o.drawImage(f._canvas,f.x||0,f.y||0,f.width/g,f.height/g)}else{if(o._applyLineJoin(this),o._applyMiterLimit(this),!u){const f=this.getAbsoluteTransform(e).getMatrix();o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)}c&&o._applyShadow(this),l.call(this,o,this)}return o.restore(),this}drawHit(t,e,n=!1){if(!this.shouldDrawHit(e,n))return this;const s=this.getLayer(),r=t||s.hitCanvas,o=r&&r.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||L.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){o.save();const u=this.getAbsoluteTransform(e).getMatrix();return o.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!a)return this;if(o.save(),o._applyLineJoin(this),o._applyMiterLimit(this),!(this===e)){const u=this.getAbsoluteTransform(e).getMatrix();o.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,o,this),o.restore(),this}drawHitFromCache(t=0){const e=this._getCanvasCache(),n=this._getCachedSceneCanvas(),s=e.hit,r=s.getContext(),o=s.getWidth(),a=s.getHeight();r.clear(),r.drawImage(n._canvas,0,0,o,a);try{const l=r.getImageData(0,0,o,a),c=l.data,h=c.length,u=L._hexToRgb(this.colorKey);for(let f=0;f<h;f+=4)c[f+3]>t?(c[f]=u.r,c[f+1]=u.g,c[f+2]=u.b,c[f+3]=255):c[f+3]=0;r.putImageData(l,0,0)}catch(l){L.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return hS(t,this)}setPointerCapture(t){uS(t,this)}releaseCapture(t){Oc(t)}}et.prototype._fillFunc=IM;et.prototype._strokeFunc=QM;et.prototype._fillFuncHit=NM;et.prototype._strokeFuncHit=$M;et.prototype._centroid=!1;et.prototype.nodeType="Shape";we(et);et.prototype.eventListeners={};et.prototype.on.call(et.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",DM);et.prototype.on.call(et.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",LM);et.prototype.on.call(et.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",VM);et.prototype.on.call(et.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",BM);et.prototype.on.call(et.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",ZM);P.addGetterSetter(et,"stroke",void 0,lS());P.addGetterSetter(et,"strokeWidth",2,nt());P.addGetterSetter(et,"fillAfterStrokeEnabled",!1);P.addGetterSetter(et,"hitStrokeWidth","auto",RO());P.addGetterSetter(et,"strokeHitEnabled",!0,Gn());P.addGetterSetter(et,"perfectDrawEnabled",!0,Gn());P.addGetterSetter(et,"shadowForStrokeEnabled",!0,Gn());P.addGetterSetter(et,"lineJoin");P.addGetterSetter(et,"lineCap");P.addGetterSetter(et,"miterLimit");P.addGetterSetter(et,"sceneFunc");P.addGetterSetter(et,"hitFunc");P.addGetterSetter(et,"dash");P.addGetterSetter(et,"dashOffset",0,nt());P.addGetterSetter(et,"shadowColor",void 0,Go());P.addGetterSetter(et,"shadowBlur",0,nt());P.addGetterSetter(et,"shadowOpacity",1,nt());P.addComponentsGetterSetter(et,"shadowOffset",["x","y"]);P.addGetterSetter(et,"shadowOffsetX",0,nt());P.addGetterSetter(et,"shadowOffsetY",0,nt());P.addGetterSetter(et,"fillPatternImage");P.addGetterSetter(et,"fill",void 0,lS());P.addGetterSetter(et,"fillPatternX",0,nt());P.addGetterSetter(et,"fillPatternY",0,nt());P.addGetterSetter(et,"fillLinearGradientColorStops");P.addGetterSetter(et,"strokeLinearGradientColorStops");P.addGetterSetter(et,"fillRadialGradientStartRadius",0);P.addGetterSetter(et,"fillRadialGradientEndRadius",0);P.addGetterSetter(et,"fillRadialGradientColorStops");P.addGetterSetter(et,"fillPatternRepeat","repeat");P.addGetterSetter(et,"fillEnabled",!0);P.addGetterSetter(et,"strokeEnabled",!0);P.addGetterSetter(et,"shadowEnabled",!0);P.addGetterSetter(et,"dashEnabled",!0);P.addGetterSetter(et,"strokeScaleEnabled",!0);P.addGetterSetter(et,"fillPriority","color");P.addComponentsGetterSetter(et,"fillPatternOffset",["x","y"]);P.addGetterSetter(et,"fillPatternOffsetX",0,nt());P.addGetterSetter(et,"fillPatternOffsetY",0,nt());P.addComponentsGetterSetter(et,"fillPatternScale",["x","y"]);P.addGetterSetter(et,"fillPatternScaleX",1,nt());P.addGetterSetter(et,"fillPatternScaleY",1,nt());P.addComponentsGetterSetter(et,"fillLinearGradientStartPoint",["x","y"]);P.addComponentsGetterSetter(et,"strokeLinearGradientStartPoint",["x","y"]);P.addGetterSetter(et,"fillLinearGradientStartPointX",0);P.addGetterSetter(et,"strokeLinearGradientStartPointX",0);P.addGetterSetter(et,"fillLinearGradientStartPointY",0);P.addGetterSetter(et,"strokeLinearGradientStartPointY",0);P.addComponentsGetterSetter(et,"fillLinearGradientEndPoint",["x","y"]);P.addComponentsGetterSetter(et,"strokeLinearGradientEndPoint",["x","y"]);P.addGetterSetter(et,"fillLinearGradientEndPointX",0);P.addGetterSetter(et,"strokeLinearGradientEndPointX",0);P.addGetterSetter(et,"fillLinearGradientEndPointY",0);P.addGetterSetter(et,"strokeLinearGradientEndPointY",0);P.addComponentsGetterSetter(et,"fillRadialGradientStartPoint",["x","y"]);P.addGetterSetter(et,"fillRadialGradientStartPointX",0);P.addGetterSetter(et,"fillRadialGradientStartPointY",0);P.addComponentsGetterSetter(et,"fillRadialGradientEndPoint",["x","y"]);P.addGetterSetter(et,"fillRadialGradientEndPointX",0);P.addGetterSetter(et,"fillRadialGradientEndPointY",0);P.addGetterSetter(et,"fillPatternRotation",0);P.addGetterSetter(et,"fillRule",void 0,Go());P.backCompat(et,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const FM="#",WM="beforeDraw",qM="draw",TS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],XM=TS.length;class jo extends un{constructor(t){super(t),this.canvas=new kr,this.hitCanvas=new EO({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){st.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!st.prototype.moveUp.call(this))return!1;const e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(st.prototype.moveDown.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(st.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return st.prototype.remove.call(this),t&&t.parentNode&&L._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&L.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),st.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){L.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){L.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,L.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,n=!1;for(;;){for(let s=0;s<XM;s++){const r=TS[s],o=this._getIntersection({x:t.x+r.x*e,y:t.y+r.y*e}),a=o.shape;if(a)return a;if(n=!!o.antialiased,!o.antialiased)break}if(n)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,s=n[3];if(s===255){const r=L._rgbToHex(n[0],n[1],n[2]),o=bc[FM+r];return o?{shape:o}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(t,e,n){const s=this.getLayer(),r=t||s&&s.getCanvas();return this._fire(WM,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),un.prototype.drawScene.call(this,r,e,n),this._fire(qM,{node:this}),this}drawHit(t,e){const n=this.getLayer(),s=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),un.prototype.drawHit.call(this,s,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){L.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return L.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return L.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}jo.prototype.nodeType="Layer";we(jo);P.addGetterSetter(jo,"imageSmoothingEnabled",!0);P.addGetterSetter(jo,"clearBeforeDraw",!0);P.addGetterSetter(jo,"hitGraphEnabled",!0,Gn());class QO extends jo{constructor(t){super(t),this.listening(!1),L.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}QO.prototype.nodeType="FastLayer";we(QO);class Ua extends un{_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&L.throw("You may only add groups and shapes to groups.")}}Ua.prototype.nodeType="Group";we(Ua);const Lp=(function(){return _o.performance&&_o.performance.now?function(){return _o.performance.now()}:function(){return new Date().getTime()}})();class yn{constructor(t,e){this.id=yn.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Lp(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,n=e.length;for(let s=0;s<n;s++)if(e[s]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=yn.animations,n=e.length;for(let s=0;s<n;s++)if(e[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Lp(),yn._addAnimation(this),this}stop(){return yn._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,n=this.animations,s=n.length;for(let r=0;r<s;r++)if(n[r].id===e){this.animations.splice(r,1);break}}static _runFrames(){const t={},e=this.animations;for(let n=0;n<e.length;n++){const s=e[n],r=s.layers,o=s.func;s._updateFrameObject(Lp());const a=r.length;let l;if(o?l=o.call(s,s.frame)!==!1:l=!0,!!l)for(let c=0;c<a;c++){const h=r[c];h._id!==void 0&&(t[h._id]=h)}}for(const n in t)t.hasOwnProperty(n)&&t[n].batchDraw()}static _animationLoop(){const t=yn;t.animations.length?(t._runFrames(),L.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,L.requestAnimFrame(this._animationLoop))}}yn.animations=[];yn.animIdCounter=0;yn.animRunning=!1;const zM={node:1,duration:1,easing:1,onFinish:1,yoyo:1},GM=1,Uy=2,Yy=3,Hy=["fill","stroke","shadowColor"];let jM=0;class UM{constructor(t,e,n,s,r,o,a){this.prop=t,this.propFunc=e,this.begin=s,this._pos=s,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=r-this.begin,this.pause()}fire(t){const e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=Uy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=Yy,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===Uy?this.setTime(t):this.state===Yy&&this.setTime(this.duration-t)}pause(){this.state=GM,this.fire("onPause")}getTimer(){return new Date().getTime()}}class le{constructor(t){const e=this,n=t.node,s=n._id,r=t.easing||vc.Linear,o=!!t.yoyo;let a,l;typeof t.duration>"u"?a=.3:t.duration===0?a=.001:a=t.duration,this.node=n,this._id=jM++;const c=n.getLayer()||(n instanceof ot.Stage?n.getLayers():null);c||L.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new yn(function(){e.tween.onEnterFrame()},c),this.tween=new UM(l,function(h){e._tweenFunc(h)},r,0,1,a*1e3,o),this._addListeners(),le.attrs[s]||(le.attrs[s]={}),le.attrs[s][this._id]||(le.attrs[s][this._id]={}),le.tweens[s]||(le.tweens[s]={});for(l in t)zM[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){const n=this.node,s=n._id;let r,o,a,l,c;const h=le.tweens[s][t];h&&delete le.attrs[s][h][t];let u=n.getAttr(t);if(L._isArray(e))if(r=[],o=Math.max(e.length,u.length),t==="points"&&e.length!==u.length&&(e.length>u.length?(l=u,u=L._prepareArrayForTween(u,e,n.closed())):(a=e,e=L._prepareArrayForTween(e,u,n.closed()))),t.indexOf("fill")===0)for(let f=0;f<o;f++)if(f%2===0)r.push(e[f]-u[f]);else{const d=L.colorToRGBA(u[f]);c=L.colorToRGBA(e[f]),u[f]=d,r.push({r:c.r-d.r,g:c.g-d.g,b:c.b-d.b,a:c.a-d.a})}else for(let f=0;f<o;f++)r.push(e[f]-u[f]);else Hy.indexOf(t)!==-1?(u=L.colorToRGBA(u),c=L.colorToRGBA(e),r={r:c.r-u.r,g:c.g-u.g,b:c.b-u.b,a:c.a-u.a}):r=e-u;le.attrs[s][this._id][t]={start:u,diff:r,end:e,trueEnd:a,trueStart:l},le.tweens[s][t]=this._id}_tweenFunc(t){const e=this.node,n=le.attrs[e._id][this._id];let s,r,o,a,l,c,h,u;for(s in n){if(r=n[s],o=r.start,a=r.diff,u=r.end,L._isArray(o))if(l=[],h=Math.max(o.length,u.length),s.indexOf("fill")===0)for(c=0;c<h;c++)c%2===0?l.push((o[c]||0)+a[c]*t):l.push("rgba("+Math.round(o[c].r+a[c].r*t)+","+Math.round(o[c].g+a[c].g*t)+","+Math.round(o[c].b+a[c].b*t)+","+(o[c].a+a[c].a*t)+")");else for(c=0;c<h;c++)l.push((o[c]||0)+a[c]*t);else Hy.indexOf(s)!==-1?l="rgba("+Math.round(o.r+a.r*t)+","+Math.round(o.g+a.g*t)+","+Math.round(o.b+a.b*t)+","+(o.a+a.a*t)+")":l=o+a*t;e.setAttr(s,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,e=le.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,e=le.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,e=this._id,n=le.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const s in n)delete le.tweens[t][s];delete le.attrs[t][e],le.tweens[t]&&(Object.keys(le.tweens[t]).length===0&&delete le.tweens[t],Object.keys(le.attrs[t]).length===0&&delete le.attrs[t])}}le.attrs={};le.tweens={};st.prototype.to=function(i){const t=i.onFinish;i.node=this,i.onFinish=function(){this.destroy(),t&&t()},new le(i).play()};const vc={BackEaseIn(i,t,e,n){return e*(i/=n)*i*((1.70158+1)*i-1.70158)+t},BackEaseOut(i,t,e,n){return e*((i=i/n-1)*i*((1.70158+1)*i+1.70158)+1)+t},BackEaseInOut(i,t,e,n){let s=1.70158;return(i/=n/2)<1?e/2*(i*i*(((s*=1.525)+1)*i-s))+t:e/2*((i-=2)*i*(((s*=1.525)+1)*i+s)+2)+t},ElasticEaseIn(i,t,e,n,s,r){let o=0;return i===0?t:(i/=n)===1?t+e:(r||(r=n*.3),!s||s<Math.abs(e)?(s=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/s),-(s*Math.pow(2,10*(i-=1))*Math.sin((i*n-o)*(2*Math.PI)/r))+t)},ElasticEaseOut(i,t,e,n,s,r){let o=0;return i===0?t:(i/=n)===1?t+e:(r||(r=n*.3),!s||s<Math.abs(e)?(s=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/s),s*Math.pow(2,-10*i)*Math.sin((i*n-o)*(2*Math.PI)/r)+e+t)},ElasticEaseInOut(i,t,e,n,s,r){let o=0;return i===0?t:(i/=n/2)===2?t+e:(r||(r=n*(.3*1.5)),!s||s<Math.abs(e)?(s=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/s),i<1?-.5*(s*Math.pow(2,10*(i-=1))*Math.sin((i*n-o)*(2*Math.PI)/r))+t:s*Math.pow(2,-10*(i-=1))*Math.sin((i*n-o)*(2*Math.PI)/r)*.5+e+t)},BounceEaseOut(i,t,e,n){return(i/=n)<1/2.75?e*(7.5625*i*i)+t:i<2/2.75?e*(7.5625*(i-=1.5/2.75)*i+.75)+t:i<2.5/2.75?e*(7.5625*(i-=2.25/2.75)*i+.9375)+t:e*(7.5625*(i-=2.625/2.75)*i+.984375)+t},BounceEaseIn(i,t,e,n){return e-vc.BounceEaseOut(n-i,0,e,n)+t},BounceEaseInOut(i,t,e,n){return i<n/2?vc.BounceEaseIn(i*2,0,e,n)*.5+t:vc.BounceEaseOut(i*2-n,0,e,n)*.5+e*.5+t},EaseIn(i,t,e,n){return e*(i/=n)*i+t},EaseOut(i,t,e,n){return-e*(i/=n)*(i-2)+t},EaseInOut(i,t,e,n){return(i/=n/2)<1?e/2*i*i+t:-e/2*(--i*(i-2)-1)+t},StrongEaseIn(i,t,e,n){return e*(i/=n)*i*i*i*i+t},StrongEaseOut(i,t,e,n){return e*((i=i/n-1)*i*i*i*i+1)+t},StrongEaseInOut(i,t,e,n){return(i/=n/2)<1?e/2*i*i*i*i*i+t:e/2*((i-=2)*i*i*i*i+2)+t},Linear(i,t,e,n){return e*i/n+t}},Ky=L._assign(ot,{Util:L,Transform:an,Node:st,Container:un,Stage:ep,stages:yc,Layer:jo,FastLayer:QO,Group:Ua,DD:jt,Shape:et,shapes:bc,Animation:yn,Tween:le,Easings:vc,Context:Jd,Canvas:MO});class or extends et{_sceneFunc(t){const e=ot.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,n),t.arc(0,0,this.innerRadius(),e,0,!n),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),n=this.clockwise(),s=ot.getAngle(n?360-this.angle():this.angle()),r=Math.cos(Math.min(s,Math.PI)),o=1,a=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),l=Math.sin(Math.min(s,Math.PI/2)),c=r*(r>0?t:e),h=o*e,u=a*(a>0?t:e),f=l*(l>0?e:t);return{x:c,y:n?-1*f:u,width:h-c,height:f-u}}}or.prototype._centroid=!0;or.prototype.className="Arc";or.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];we(or);P.addGetterSetter(or,"innerRadius",0,nt());P.addGetterSetter(or,"outerRadius",0,nt());P.addGetterSetter(or,"angle",0,nt());P.addGetterSetter(or,"clockwise",!1,Gn());function lm(i,t,e,n,s,r,o){const a=Math.sqrt(Math.pow(e-i,2)+Math.pow(n-t,2)),l=Math.sqrt(Math.pow(s-e,2)+Math.pow(r-n,2)),c=o*a/(a+l),h=o*l/(a+l),u=e-c*(s-i),f=n-c*(r-t),d=e+h*(s-i),p=n+h*(r-t);return[u,f,d,p]}function Jy(i,t){const e=i.length,n=[];for(let s=2;s<e-2;s+=2){const r=lm(i[s-2],i[s-1],i[s],i[s+1],i[s+2],i[s+3],t);isNaN(r[0])||(n.push(r[0]),n.push(r[1]),n.push(i[s]),n.push(i[s+1]),n.push(r[2]),n.push(r[3]))}return n}let ar=class extends et{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const e=this.points(),n=e.length,s=this.tension(),r=this.closed(),o=this.bezier();if(!n)return;let a=0;if(t.beginPath(),t.moveTo(e[0],e[1]),s!==0&&n>4){const l=this.getTensionPoints(),c=l.length;for(a=r?0:4,r||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<c-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);r||t.quadraticCurveTo(l[c-2],l[c-1],e[n-2],e[n-1])}else if(o)for(a=2;a<n;)t.bezierCurveTo(e[a++],e[a++],e[a++],e[a++],e[a++],e[a++]);else for(a=2;a<n;a+=2)t.lineTo(e[a],e[a+1]);r?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Jy(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),e=t.length,n=this.tension(),s=lm(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),r=lm(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),o=Jy(t,n);return[s[2],s[3]].concat(o).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],s[0],s[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let e=t[0],n=t[0],s=t[1],r=t[1],o,a;for(let l=0;l<t.length/2;l++)o=t[l*2],a=t[l*2+1],e=Math.min(e,o),n=Math.max(n,o),s=Math.min(s,a),r=Math.max(r,a);return{x:e,y:s,width:n-e,height:r-s}}};ar.prototype.className="Line";ar.prototype._attrsAffectingSize=["points","bezier","tension"];we(ar);P.addGetterSetter(ar,"closed",!1);P.addGetterSetter(ar,"bezier",!1);P.addGetterSetter(ar,"tension",0,nt());P.addGetterSetter(ar,"points",[],uM());const YM=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],HM=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],KM=[[1],[1,1],[1,2,1],[1,3,3,1]],tb=(i,t,e)=>{let n,s;const o=e/2;n=0;for(let a=0;a<20;a++)s=o*YM[20][a]+o,n+=HM[20][a]*JM(i,t,s);return o*n},eb=(i,t,e)=>{e===void 0&&(e=1);const n=i[0]-2*i[1]+i[2],s=t[0]-2*t[1]+t[2],r=2*i[1]-2*i[0],o=2*t[1]-2*t[0],a=4*(n*n+s*s),l=4*(n*r+s*o),c=r*r+o*o;if(a===0)return e*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(t[2]-t[0],2));const h=l/(2*a),u=c/a,f=e+h,d=u-h*h,p=f*f+d>0?Math.sqrt(f*f+d):0,g=h*h+d>0?Math.sqrt(h*h+d):0,m=h+Math.sqrt(h*h+d)!==0?d*Math.log(Math.abs((f+p)/(h+g))):0;return Math.sqrt(a)/2*(f*p-h*g+m)};function JM(i,t,e){const n=cm(1,e,i),s=cm(1,e,t),r=n*n+s*s;return Math.sqrt(r)}const cm=(i,t,e)=>{const n=e.length-1;let s,r;if(n===0)return 0;if(i===0){r=0;for(let o=0;o<=n;o++)r+=KM[n][o]*Math.pow(1-t,n-o)*Math.pow(t,o)*e[o];return r}else{s=new Array(n);for(let o=0;o<n;o++)s[o]=n*(e[o+1]-e[o]);return cm(i-1,t,s)}},ib=(i,t,e)=>{let n=1,s=i/t,r=(i-e(s))/t,o=0;for(;n>.001;){const a=e(s+r),l=Math.abs(i-a)/t;if(l<n)n=l,s+=r;else{const c=e(s-r),h=Math.abs(i-c)/t;h<n?(n=h,s-=r):r/=2}if(o++,o>500)break}return s};class he extends et{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=he.parsePathData(this.data()),this.pathLength=he.getPathLength(this.dataArray)}_sceneFunc(t){const e=this.dataArray;t.beginPath();let n=!1;for(let s=0;s<e.length;s++){const r=e[s].command,o=e[s].points;switch(r){case"L":t.lineTo(o[0],o[1]);break;case"M":t.moveTo(o[0],o[1]);break;case"C":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const a=o[0],l=o[1],c=o[2],h=o[3],u=o[4],f=o[5],d=o[6],p=o[7],g=c>h?c:h,m=c>h?1:c/h,O=c>h?h/c:1;t.translate(a,l),t.rotate(d),t.scale(m,O),t.arc(0,0,g,u,u+f,1-p),t.scale(1/m,1/O),t.rotate(-d),t.translate(-a,-l);break;case"z":n=!0,t.closePath();break}}!n&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){const c=l.points[4],h=l.points[5],u=l.points[4]+h;let f=Math.PI/180;if(Math.abs(c-u)<f&&(f=Math.abs(c-u)),h<0)for(let d=c-f;d>u;d-=f){const p=he.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],d,0);t.push(p.x,p.y)}else for(let d=c+f;d<u;d+=f){const p=he.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],d,0);t.push(p.x,p.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){const h=he.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(h.x,h.y)}else t=t.concat(l.points)});let e=t[0],n=t[0],s=t[1],r=t[1],o,a;for(let l=0;l<t.length/2;l++)o=t[l*2],a=t[l*2+1],isNaN(o)||(e=Math.min(e,o),n=Math.max(n,o)),isNaN(a)||(s=Math.min(s,a),r=Math.max(r,a));return{x:e,y:s,width:n-e,height:r-s}}getLength(){return this.pathLength}getPointAtLength(t){return he.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,n,s){return Math.sqrt((n-t)*(n-t)+(s-e)*(s-e))}static getPathLength(t){let e=0;for(let n=0;n<t.length;++n)e+=t[n].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let n,s=0,r=e.length;if(!r)return null;for(;s<r&&t>e[s].pathLength;)t-=e[s].pathLength,++s;if(s===r)return n=e[s-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return e[s].command==="M"?(n=e[s].points.slice(0,2),{x:n[0],y:n[1]}):{x:e[s].start.x,y:e[s].start.y};const o=e[s],a=o.points;switch(o.command){case"L":return he.getPointOnLine(t,o.start.x,o.start.y,a[0],a[1]);case"C":return he.getPointOnCubicBezier(ib(t,he.getPathLength(e),g=>tb([o.start.x,a[0],a[2],a[4]],[o.start.y,a[1],a[3],a[5]],g)),o.start.x,o.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return he.getPointOnQuadraticBezier(ib(t,he.getPathLength(e),g=>eb([o.start.x,a[0],a[2]],[o.start.y,a[1],a[3]],g)),o.start.x,o.start.y,a[0],a[1],a[2],a[3]);case"A":const l=a[0],c=a[1],h=a[2],u=a[3],f=a[5],d=a[6];let p=a[4];return p+=f*t/o.pathLength,he.getPointOnEllipticalArc(l,c,h,u,p,d)}return null}static getPointOnLine(t,e,n,s,r,o,a){o=o??e,a=a??n;const l=this.getLineLength(e,n,s,r);if(l<1e-10)return{x:e,y:n};if(s===e)return{x:o,y:a+(r>n?t:-t)};const c=(r-n)/(s-e),h=Math.sqrt(t*t/(1+c*c))*(s<e?-1:1),u=c*h;if(Math.abs(a-n-c*(o-e))<1e-10)return{x:o+h,y:a+u};const f=((o-e)*(s-e)+(a-n)*(r-n))/(l*l),d=e+f*(s-e),p=n+f*(r-n),g=this.getLineLength(o,a,d,p),m=Math.sqrt(t*t-g*g),O=Math.sqrt(m*m/(1+c*c))*(s<e?-1:1),y=c*O;return{x:d+O,y:p+y}}static getPointOnCubicBezier(t,e,n,s,r,o,a,l,c){function h(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function f(m){return 3*m*(1-m)*(1-m)}function d(m){return(1-m)*(1-m)*(1-m)}const p=l*h(t)+o*u(t)+s*f(t)+e*d(t),g=c*h(t)+a*u(t)+r*f(t)+n*d(t);return{x:p,y:g}}static getPointOnQuadraticBezier(t,e,n,s,r,o,a){function l(d){return d*d}function c(d){return 2*d*(1-d)}function h(d){return(1-d)*(1-d)}const u=o*l(t)+s*c(t)+e*h(t),f=a*l(t)+r*c(t)+n*h(t);return{x:u,y:f}}static getPointOnEllipticalArc(t,e,n,s,r,o){const a=Math.cos(o),l=Math.sin(o),c={x:n*Math.cos(r),y:s*Math.sin(r)};return{x:t+(c.x*a-c.y*l),y:e+(c.x*l+c.y*a)}}static parsePathData(t){if(!t)return[];let e=t;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let u=0;u<n.length;u++)e=e.replace(new RegExp(n[u],"g"),"|"+n[u]);const s=e.split("|"),r=[],o=[];let a=0,l=0;const c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let h;for(let u=1;u<s.length;u++){let f=s[u],d=f.charAt(0);for(f=f.slice(1),o.length=0;h=c.exec(f);)o.push(h[0]);let p=[],g=d==="A"||d==="a"?0:-1;for(let m=0,O=o.length;m<O;m++){const y=o[m];if(y==="00"){p.push(0,0),g>=0&&(g+=2,g>=7&&(g-=7));continue}if(g>=0){if(g===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(y)){p.push(parseInt(y[0],10)),p.push(parseInt(y[1],10)),p.push(parseFloat(y.slice(2))),g+=3,g>=7&&(g-=7);continue}if(y==="11"||y==="10"||y==="01"){p.push(parseInt(y[0],10)),p.push(parseInt(y[1],10)),g+=2,g>=7&&(g-=7);continue}if(y==="0"||y==="1"){p.push(parseInt(y,10)),g+=1,g>=7&&(g-=7);continue}}else if(g===4){if(/^[01]\d+(?:\.\d+)?$/.test(y)){p.push(parseInt(y[0],10)),p.push(parseFloat(y.slice(1))),g+=2,g>=7&&(g-=7);continue}if(y==="0"||y==="1"){p.push(parseInt(y,10)),g+=1,g>=7&&(g-=7);continue}}const _=parseFloat(y);isNaN(_)?p.push(0):p.push(_),g+=1,g>=7&&(g-=7)}else{const _=parseFloat(y);isNaN(_)?p.push(0):p.push(_)}}for(;p.length>0&&!isNaN(p[0]);){let m="",O=[];const y=a,_=l;let v,b,k,x,C,I,R,$,E,Z;switch(d){case"l":a+=p.shift(),l+=p.shift(),m="L",O.push(a,l);break;case"L":a=p.shift(),l=p.shift(),O.push(a,l);break;case"m":const F=p.shift(),W=p.shift();if(a+=F,l+=W,m="M",r.length>2&&r[r.length-1].command==="z"){for(let B=r.length-2;B>=0;B--)if(r[B].command==="M"){a=r[B].points[0]+F,l=r[B].points[1]+W;break}}O.push(a,l),d="l";break;case"M":a=p.shift(),l=p.shift(),m="M",O.push(a,l),d="L";break;case"h":a+=p.shift(),m="L",O.push(a,l);break;case"H":a=p.shift(),m="L",O.push(a,l);break;case"v":l+=p.shift(),m="L",O.push(a,l);break;case"V":l=p.shift(),m="L",O.push(a,l);break;case"C":O.push(p.shift(),p.shift(),p.shift(),p.shift()),a=p.shift(),l=p.shift(),O.push(a,l);break;case"c":O.push(a+p.shift(),l+p.shift(),a+p.shift(),l+p.shift()),a+=p.shift(),l+=p.shift(),m="C",O.push(a,l);break;case"S":b=a,k=l,v=r[r.length-1],v.command==="C"&&(b=a+(a-v.points[2]),k=l+(l-v.points[3])),O.push(b,k,p.shift(),p.shift()),a=p.shift(),l=p.shift(),m="C",O.push(a,l);break;case"s":b=a,k=l,v=r[r.length-1],v.command==="C"&&(b=a+(a-v.points[2]),k=l+(l-v.points[3])),O.push(b,k,a+p.shift(),l+p.shift()),a+=p.shift(),l+=p.shift(),m="C",O.push(a,l);break;case"Q":O.push(p.shift(),p.shift()),a=p.shift(),l=p.shift(),O.push(a,l);break;case"q":O.push(a+p.shift(),l+p.shift()),a+=p.shift(),l+=p.shift(),m="Q",O.push(a,l);break;case"T":b=a,k=l,v=r[r.length-1],v.command==="Q"&&(b=a+(a-v.points[0]),k=l+(l-v.points[1])),a=p.shift(),l=p.shift(),m="Q",O.push(b,k,a,l);break;case"t":b=a,k=l,v=r[r.length-1],v.command==="Q"&&(b=a+(a-v.points[0]),k=l+(l-v.points[1])),a+=p.shift(),l+=p.shift(),m="Q",O.push(b,k,a,l);break;case"A":x=p.shift(),C=p.shift(),I=p.shift(),R=p.shift(),$=p.shift(),E=a,Z=l,a=p.shift(),l=p.shift(),m="A",O=this.convertEndpointToCenterParameterization(E,Z,a,l,R,$,x,C,I);break;case"a":x=p.shift(),C=p.shift(),I=p.shift(),R=p.shift(),$=p.shift(),E=a,Z=l,a+=p.shift(),l+=p.shift(),m="A",O=this.convertEndpointToCenterParameterization(E,Z,a,l,R,$,x,C,I);break}r.push({command:m||d,points:O,start:{x:y,y:_},pathLength:this.calcLength(y,_,m||d,O)})}(d==="z"||d==="Z")&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r}static calcLength(t,e,n,s){let r,o,a,l;const c=he;switch(n){case"L":return c.getLineLength(t,e,s[0],s[1]);case"C":return tb([t,s[0],s[2],s[4]],[e,s[1],s[3],s[5]],1);case"Q":return eb([t,s[0],s[2]],[e,s[1],s[3]],1);case"A":r=0;const h=s[4],u=s[5],f=s[4]+u;let d=Math.PI/180;if(Math.abs(h-f)<d&&(d=Math.abs(h-f)),o=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],h,0),u<0)for(l=h-d;l>f;l-=d)a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(l=h+d;l<f;l+=d)a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=c.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],f,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),r}return 0}static convertEndpointToCenterParameterization(t,e,n,s,r,o,a,l,c){const h=c*(Math.PI/180),u=Math.cos(h)*(t-n)/2+Math.sin(h)*(e-s)/2,f=-1*Math.sin(h)*(t-n)/2+Math.cos(h)*(e-s)/2,d=u*u/(a*a)+f*f/(l*l);d>1&&(a*=Math.sqrt(d),l*=Math.sqrt(d));let p=Math.sqrt((a*a*(l*l)-a*a*(f*f)-l*l*(u*u))/(a*a*(f*f)+l*l*(u*u)));r===o&&(p*=-1),isNaN(p)&&(p=0);const g=p*a*f/l,m=p*-l*u/a,O=(t+n)/2+Math.cos(h)*g-Math.sin(h)*m,y=(e+s)/2+Math.sin(h)*g+Math.cos(h)*m,_=function(R){return Math.sqrt(R[0]*R[0]+R[1]*R[1])},v=function(R,$){return(R[0]*$[0]+R[1]*$[1])/(_(R)*_($))},b=function(R,$){return(R[0]*$[1]<R[1]*$[0]?-1:1)*Math.acos(v(R,$))},k=b([1,0],[(u-g)/a,(f-m)/l]),x=[(u-g)/a,(f-m)/l],C=[(-1*u-g)/a,(-1*f-m)/l];let I=b(x,C);return v(x,C)<=-1&&(I=Math.PI),v(x,C)>=1&&(I=0),o===0&&I>0&&(I=I-2*Math.PI),o===1&&I<0&&(I=I+2*Math.PI),[O,y,a,l,k,I,h,o]}}he.prototype.className="Path";he.prototype._attrsAffectingSize=["data"];we(he);P.addGetterSetter(he,"data");class Uo extends ar{_sceneFunc(t){super._sceneFunc(t);const e=Math.PI*2,n=this.points();let s=n;const r=this.tension()!==0&&n.length>4;r&&(s=this.getTensionPoints());const o=this.pointerLength(),a=n.length;let l,c;if(r){const f=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],n[a-2],n[a-1]],d=he.calcLength(s[s.length-4],s[s.length-3],"C",f),p=he.getPointOnQuadraticBezier(Math.min(1,1-o/d),f[0],f[1],f[2],f[3],f[4],f[5]);l=n[a-2]-p.x,c=n[a-1]-p.y}else l=n[a-2]-n[a-4],c=n[a-1]-n[a-3];const h=(Math.atan2(c,l)+e)%e,u=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(n[a-2],n[a-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-o,u/2),t.lineTo(-o,-u/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(n[0],n[1]),r?(l=(s[0]+s[2])/2-n[0],c=(s[1]+s[3])/2-n[1]):(l=n[2]-n[0],c=n[3]-n[1]),t.rotate((Math.atan2(-c,-l)+e)%e),t.moveTo(0,0),t.lineTo(-o,u/2),t.lineTo(-o,-u/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x,y:t.y-e,width:t.width,height:t.height+e*2}}}Uo.prototype.className="Arrow";we(Uo);P.addGetterSetter(Uo,"pointerLength",10,nt());P.addGetterSetter(Uo,"pointerWidth",10,nt());P.addGetterSetter(Uo,"pointerAtBeginning",!1);P.addGetterSetter(Uo,"pointerAtEnding",!0);class gl extends et{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}gl.prototype._centroid=!0;gl.prototype.className="Circle";gl.prototype._attrsAffectingSize=["radius"];we(gl);P.addGetterSetter(gl,"radius",0,nt());class Jr extends et{_sceneFunc(t){const e=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),e!==n&&t.scale(1,n/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Jr.prototype.className="Ellipse";Jr.prototype._centroid=!0;Jr.prototype._attrsAffectingSize=["radiusX","radiusY"];we(Jr);P.addComponentsGetterSetter(Jr,"radius",["x","y"]);P.addGetterSetter(Jr,"radiusX",0,nt());P.addGetterSetter(Jr,"radiusY",0,nt());class An extends et{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),e=this.hasShadow();return t&&e?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),n=this.getHeight(),s=this.cornerRadius(),r=this.attrs.image;let o;if(r){const a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?o=[r,this.cropX(),this.cropY(),a,l,0,0,e,n]:o=[r,0,0,e,n]}(this.hasFill()||this.hasStroke()||s)&&(t.beginPath(),s?L.drawRoundedRectPath(t,e,n,s):t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)),r&&(s&&t.clip(),t.drawImage.apply(t,o))}_hitFunc(t){const e=this.width(),n=this.height(),s=this.cornerRadius();t.beginPath(),s?L.drawRoundedRectPath(t,e,n,s):t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width}getHeight(){var t,e;return(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height}static fromURL(t,e,n=null){const s=L.createImageElement();s.onload=function(){const r=new An({image:s});e(r)},s.onerror=n,s.crossOrigin="Anonymous",s.src=t}}An.prototype.className="Image";we(An);P.addGetterSetter(An,"cornerRadius",0,tp(4));P.addGetterSetter(An,"image");P.addComponentsGetterSetter(An,"crop",["x","y","width","height"]);P.addGetterSetter(An,"cropX",0,nt());P.addGetterSetter(An,"cropY",0,nt());P.addGetterSetter(An,"cropWidth",0,nt());P.addGetterSetter(An,"cropHeight",0,nt());const PS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],tE="Change.konva",eE="none",hm="up",um="right",fm="down",dm="left",iE=PS.length;class NO extends Ua{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,n;const s=function(){e._sync()};for(n=0;n<iE;n++)t.on(PS[n]+tE,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),n,s,r,o,a,l,c;if(t&&e){switch(n=t.width(),s=t.height(),r=e.pointerDirection(),o=e.pointerWidth(),c=e.pointerHeight(),a=0,l=0,r){case hm:a=n/2,l=-1*c;break;case um:a=n+o,l=s/2;break;case fm:a=n/2,l=s+c;break;case dm:a=-1*o,l=s/2;break}e.setAttrs({x:-1*a,y:-1*l,width:n,height:s}),t.setAttrs({x:-1*a,y:-1*l})}}}NO.prototype.className="Label";we(NO);let Yo=class extends et{_sceneFunc(t){const e=this.width(),n=this.height(),s=this.pointerDirection(),r=this.pointerWidth(),o=this.pointerHeight(),a=this.cornerRadius();let l=0,c=0,h=0,u=0;typeof a=="number"?l=c=h=u=Math.min(a,e/2,n/2):(l=Math.min(a[0]||0,e/2,n/2),c=Math.min(a[1]||0,e/2,n/2),u=Math.min(a[2]||0,e/2,n/2),h=Math.min(a[3]||0,e/2,n/2)),t.beginPath(),t.moveTo(l,0),s===hm&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*o),t.lineTo((e+r)/2,0)),t.lineTo(e-c,0),t.arc(e-c,c,c,Math.PI*3/2,0,!1),s===um&&(t.lineTo(e,(n-o)/2),t.lineTo(e+r,n/2),t.lineTo(e,(n+o)/2)),t.lineTo(e,n-u),t.arc(e-u,n-u,u,0,Math.PI/2,!1),s===fm&&(t.lineTo((e+r)/2,n),t.lineTo(e/2,n+o),t.lineTo((e-r)/2,n)),t.lineTo(h,n),t.arc(h,n-h,h,Math.PI/2,Math.PI,!1),s===dm&&(t.lineTo(0,(n+o)/2),t.lineTo(-1*r,n/2),t.lineTo(0,(n-o)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,n=this.pointerWidth(),s=this.pointerHeight(),r=this.pointerDirection(),o=this.width(),a=this.height();return r===hm?(e-=s,a+=s):r===fm?a+=s:r===dm?(t-=n*1.5,o+=n):r===um&&(o+=n*1.5),{x:t,y:e,width:o,height:a}}};Yo.prototype.className="Tag";we(Yo);P.addGetterSetter(Yo,"pointerDirection",eE);P.addGetterSetter(Yo,"pointerWidth",0,nt());P.addGetterSetter(Yo,"pointerHeight",0,nt());P.addGetterSetter(Yo,"cornerRadius",0,tp(4));class vh extends et{_sceneFunc(t){const e=this.cornerRadius(),n=this.width(),s=this.height();t.beginPath(),e?L.drawRoundedRectPath(t,n,s,e):t.rect(0,0,n,s),t.closePath(),t.fillStrokeShape(this)}}vh.prototype.className="Rect";we(vh);P.addGetterSetter(vh,"cornerRadius",0,tp(4));class to extends et{_sceneFunc(t){const e=this._getPoints(),n=this.radius(),s=this.sides(),r=this.cornerRadius();if(t.beginPath(),r)L.drawRoundedPolygonPath(t,e,s,n,r);else{t.moveTo(e[0].x,e[0].y);for(let o=1;o<e.length;o++)t.lineTo(e[o].x,e[o].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,n=[];for(let s=0;s<t;s++)n.push({x:e*Math.sin(s*2*Math.PI/t),y:-1*e*Math.cos(s*2*Math.PI/t)});return n}getSelfRect(){const t=this._getPoints();let e=t[0].x,n=t[0].y,s=t[0].x,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),n=Math.max(n,o.x),s=Math.min(s,o.y),r=Math.max(r,o.y)}),{x:e,y:s,width:n-e,height:r-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}to.prototype.className="RegularPolygon";to.prototype._centroid=!0;to.prototype._attrsAffectingSize=["radius"];we(to);P.addGetterSetter(to,"radius",0,nt());P.addGetterSetter(to,"sides",0,nt());P.addGetterSetter(to,"cornerRadius",0,tp(4));const nb=Math.PI*2;class Ho extends et{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,nb,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),nb,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Ho.prototype.className="Ring";Ho.prototype._centroid=!0;Ho.prototype._attrsAffectingSize=["innerRadius","outerRadius"];we(Ho);P.addGetterSetter(Ho,"innerRadius",0,nt());P.addGetterSetter(Ho,"outerRadius",0,nt());class As extends et{constructor(t){super(t),this._updated=!0,this.anim=new yn(()=>{const e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const e=this.animation(),n=this.frameIndex(),s=n*4,r=this.animations()[e],o=this.frameOffsets(),a=r[s+0],l=r[s+1],c=r[s+2],h=r[s+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,h),t.closePath(),t.fillStrokeShape(this)),u)if(o){const f=o[e],d=n*2;t.drawImage(u,a,l,c,h,f[d+0],f[d+1],c,h)}else t.drawImage(u,a,l,c,h,0,0,c,h)}_hitFunc(t){const e=this.animation(),n=this.frameIndex(),s=n*4,r=this.animations()[e],o=this.frameOffsets(),a=r[s+2],l=r[s+3];if(t.beginPath(),o){const c=o[e],h=n*2;t.rect(c[h+0],c[h+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),e=this.animation(),n=this.animations(),s=n[e],r=s.length/4;t<r-1?this.frameIndex(t+1):this.frameIndex(0)}}As.prototype.className="Sprite";we(As);P.addGetterSetter(As,"animation");P.addGetterSetter(As,"animations");P.addGetterSetter(As,"frameOffsets");P.addGetterSetter(As,"image");P.addGetterSetter(As,"frameIndex",0,nt());P.addGetterSetter(As,"frameRate",17,nt());P.backCompat(As,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class eo extends et{_sceneFunc(t){const e=this.innerRadius(),n=this.outerRadius(),s=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(let r=1;r<s*2;r++){const o=r%2===0?n:e,a=o*Math.sin(r*Math.PI/s),l=-1*o*Math.cos(r*Math.PI/s);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}eo.prototype.className="Star";eo.prototype._centroid=!0;eo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];we(eo);P.addGetterSetter(eo,"numPoints",5,nt());P.addGetterSetter(eo,"innerRadius",0,nt());P.addGetterSetter(eo,"outerRadius",0,nt());function yr(i){return[...i].reduce((t,e,n,s)=>{if(new RegExp("\\p{Emoji}","u").test(e)){const r=s[n+1];r&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(r)?(t.push(e+r),s[n+1]=""):t.push(e)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(e+(s[n+1]||""))?t.push(e+s[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(e)?t[t.length-1]+=e:e&&t.push(e);return t},[])}const ia="auto",nE="center",AS="inherit",na="justify",sE="Change.konva",rE="2d",sb="-",MS="left",oE="text",aE="Text",lE="top",cE="bottom",rb="middle",ES="normal",hE="px ",ru=" ",uE="right",ob="rtl",fE="word",dE="char",ab="none",Vp="…",RS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],pE=RS.length;function gE(i){return i.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!n&&(t=`"${t}"`),t}).join(", ")}let ou;function Bp(){return ou||(ou=L.createCanvasElement().getContext(rE),ou)}function mE(i){i.fillText(this._partialText,this._partialTextX,this._partialTextY)}function OE(i){i.setAttr("miterLimit",2),i.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function yE(i){return i=i||{},!i.fillLinearGradientColorStops&&!i.fillRadialGradientColorStops&&!i.fillPatternImage&&(i.fill=i.fill||"black"),i}let Oe=class extends et{constructor(t){super(yE(t)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<pE;e++)this.on(RS[e]+sE,this._setTextData);this._setTextData()}_sceneFunc(t){var e,n;const s=this.textArr,r=s.length;if(!this.text())return;let o=this.padding(),a=this.fontSize(),l=this.lineHeight()*a,c=this.verticalAlign(),h=this.direction(),u=0,f=this.align(),d=this.getWidth(),p=this.letterSpacing(),g=this.charRenderFunc(),m=this.fill(),O=this.textDecoration(),y=O.indexOf("underline")!==-1,_=O.indexOf("line-through")!==-1,v;h=h===AS?t.direction:h;let b=l/2,k=rb;if(!ot.legacyTextRendering){const x=this.measureSize("M");k="alphabetic";const C=(e=x.fontBoundingBoxAscent)!==null&&e!==void 0?e:x.actualBoundingBoxAscent,I=(n=x.fontBoundingBoxDescent)!==null&&n!==void 0?n:x.actualBoundingBoxDescent;b=(C-I)/2+l/2}for(h===ob&&t.setAttr("direction",h),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",k),t.setAttr("textAlign",MS),c===rb?u=(this.getHeight()-r*l-o*2)/2:c===cE&&(u=this.getHeight()-r*l-o*2),t.translate(o,u+o),v=0;v<r;v++){let x=0,C=0;const I=s[v],R=I.text,$=I.width,E=I.lastInParagraph;if(t.save(),f===uE?x+=d-$-o*2:f===nE&&(x+=(d-$-o*2)/2),y){t.save(),t.beginPath();const Z=ot.legacyTextRendering?Math.round(a/2):Math.round(a/4),F=x,W=b+C+Z;t.moveTo(F,W);const B=f===na&&!E?d-o*2:$;t.lineTo(F+Math.round(B),W),t.lineWidth=a/15;const U=this._getLinearGradient();t.strokeStyle=U||m,t.stroke(),t.restore()}if(h!==ob&&(p!==0||f===na||g)){const Z=R.split(" ").length-1,F=yr(R);for(let W=0;W<F.length;W++){const B=F[W];if(B===" "&&!E&&f===na&&(x+=(d-o*2-$)/Z),this._partialTextX=x,this._partialTextY=b+C,this._partialText=B,g){t.save();const V=s.slice(0,v).reduce((j,tt)=>j+yr(tt.text).length,0),X=W+V;g({char:B,index:X,x,y:b+C,lineIndex:v,column:W,isLastInLine:E,width:this.measureSize(B).width,context:t})}t.fillStrokeShape(this),g&&t.restore(),x+=this.measureSize(B).width+p}}else p!==0&&t.setAttr("letterSpacing",`${p}px`),this._partialTextX=x,this._partialTextY=b+C,this._partialText=R,t.fillStrokeShape(this);if(_){t.save(),t.beginPath();const Z=ot.legacyTextRendering?0:-Math.round(a/4),F=f===na?0:x;t.moveTo(F,b+C+Z);const W=f===na&&!E?d-o*2:$;t.lineTo(F+Math.round(W),b+C+Z),t.lineWidth=a/15;const B=this._getLinearGradient();t.strokeStyle=B||m,t.stroke(),t.restore()}t.restore(),r>1&&(b+=l)}}_hitFunc(t){const e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)}setText(t){const e=L._isString(t)?t:t==null?"":t+"";return this._setAttr(oE,e),this}getWidth(){return this.attrs.width===ia||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===ia||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return L.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,n,s,r,o,a,l,c,h,u,f;let d=Bp(),p=this.fontSize(),g;d.save(),d.font=this._getContextFont(),g=d.measureText(t),d.restore();const m=p/100;return{actualBoundingBoxAscent:(e=g.actualBoundingBoxAscent)!==null&&e!==void 0?e:71.58203125*m,actualBoundingBoxDescent:(n=g.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(s=g.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*m,actualBoundingBoxRight:(r=g.actualBoundingBoxRight)!==null&&r!==void 0?r:75.732421875*m,alphabeticBaseline:(o=g.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(a=g.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=g.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(c=g.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*m,fontBoundingBoxDescent:(h=g.fontBoundingBoxDescent)!==null&&h!==void 0?h:21*m,hangingBaseline:(u=g.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(f=g.ideographicBaseline)!==null&&f!==void 0?f:-21*m,width:g.width,height:p}}_getContextFont(){return this.fontStyle()+ru+this.fontVariant()+ru+(this.fontSize()+hE)+gE(this.fontFamily())}_addTextLine(t){this.align()===na&&(t=t.trim());const n=this._getTextWidth(t);return this.textArr.push({text:t,width:n,lastInParagraph:!1})}_getTextWidth(t){const e=this.letterSpacing(),n=t.length;return Bp().measureText(t).width+e*n}_setTextData(){let t=this.text().split(`
`),e=+this.fontSize(),n=0,s=this.lineHeight()*e,r=this.attrs.width,o=this.attrs.height,a=r!==ia&&r!==void 0,l=o!==ia&&o!==void 0,c=this.padding(),h=r-c*2,u=o-c*2,f=0,d=this.wrap(),p=d!==ab,g=d!==dE&&p,m=this.ellipsis();this.textArr=[],Bp().font=this._getContextFont();const O=m?this._getTextWidth(Vp):0;for(let y=0,_=t.length;y<_;++y){let v=t[y],b=this._getTextWidth(v);if(a&&b>h)for(;v.length>0;){let k=0,x=yr(v).length,C="",I=0;for(;k<x;){const R=k+x>>>1,$=yr(v),E=$.slice(0,R+1).join(""),Z=this._getTextWidth(E);(m&&l&&f+s>u?Z+O:Z)<=h?(k=R+1,C=E,I=Z):x=R}if(C){if(g){const E=yr(v),Z=yr(C),F=E[Z.length],W=F===ru||F===sb;let B;if(W&&I<=h)B=Z.length;else{const U=Z.lastIndexOf(ru),V=Z.lastIndexOf(sb);B=Math.max(U,V)+1}B>0&&(k=B,C=E.slice(0,k).join(""),I=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),n=Math.max(n,I),f+=s,this._shouldHandleEllipsis(f)){this._tryToAddEllipsisToLastLine();break}if(v=yr(v).slice(k).join("").trimLeft(),v.length>0&&(b=this._getTextWidth(v),b<=h)){this._addTextLine(v),f+=s,n=Math.max(n,b);break}}else break}else this._addTextLine(v),f+=s,n=Math.max(n,b),this._shouldHandleEllipsis(f)&&y<_-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&f+s>u)break}this.textHeight=e,this.textWidth=n}_shouldHandleEllipsis(t){const e=+this.fontSize(),n=this.lineHeight()*e,s=this.attrs.height,r=s!==ia&&s!==void 0,o=this.padding(),a=s-o*2;return!(this.wrap()!==ab)||r&&t+n>a}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,e=t!==ia&&t!==void 0,n=this.padding(),s=t-n*2,r=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!r||(e&&(this._getTextWidth(o.text+Vp)<s||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Vp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}};Oe.prototype._fillFunc=mE;Oe.prototype._strokeFunc=OE;Oe.prototype.className=aE;Oe.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];we(Oe);P.overWriteSetter(Oe,"width",RO());P.overWriteSetter(Oe,"height",RO());P.addGetterSetter(Oe,"direction",AS);P.addGetterSetter(Oe,"fontFamily","Arial");P.addGetterSetter(Oe,"fontSize",12,nt());P.addGetterSetter(Oe,"fontStyle",ES);P.addGetterSetter(Oe,"fontVariant",ES);P.addGetterSetter(Oe,"padding",0,nt());P.addGetterSetter(Oe,"align",MS);P.addGetterSetter(Oe,"verticalAlign",lE);P.addGetterSetter(Oe,"lineHeight",1,nt());P.addGetterSetter(Oe,"wrap",fE);P.addGetterSetter(Oe,"ellipsis",!1,Gn());P.addGetterSetter(Oe,"letterSpacing",0,nt());P.addGetterSetter(Oe,"text","",Go());P.addGetterSetter(Oe,"textDecoration","");P.addGetterSetter(Oe,"charRenderFunc",void 0);const bE="",IS="normal";function QS(i){i.fillText(this.partialText,0,0)}function NS(i){i.strokeText(this.partialText,0,0)}class je extends et{constructor(t){super(t),this.dummyCanvas=L.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return he.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t>e?null:he.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=he.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const e=this.textDecoration(),n=this.fill(),s=this.fontSize(),r=this.glyphInfo;e==="underline"&&t.beginPath();for(let o=0;o<r.length;o++){t.save();const a=r[o].p0;t.translate(a.x,a.y),t.rotate(r[o].rotation),this.partialText=r[o].text,t.fillStrokeShape(this),e==="underline"&&(o===0&&t.moveTo(0,s/2+1),t.lineTo(s,s/2+1)),t.restore()}e==="underline"&&(t.strokeStyle=n,t.lineWidth=s/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const e=this.glyphInfo;if(e.length>=1){const n=e[0].p0;t.moveTo(n.x,n.y)}for(let n=0;n<e.length;n++){const s=e[n].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return L.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Oe.prototype.setText.call(this,t)}_getContextFont(){return Oe.prototype._getContextFont.call(this)}_getTextSize(t){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const s=n.measureText(t);return n.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=yr(this.text()),e=[];let n=0;for(let u=0;u<t.length;u++)e.push({char:t[u],width:this._getTextSize(t[u]).width}),n+=e[u].width;const{height:s}=this._getTextSize(this.attrs.text);if(this.textWidth=n,this.textHeight=s,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),o=this.align(),a=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let c=0;o==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),o==="right"&&(c=Math.max(0,this.pathLength-l));let h=c;for(let u=0;u<e.length;u++){const f=this._getPointAtLength(h);if(!f)return;const d=e[u].char;let p=e[u].width+r;if(d===" "&&o==="justify"){const v=this.text().split(" ").length-1;p+=(this.pathLength-l)/v}const g=this._getPointAtLength(h+p);if(!g)return;const m=he.getLineLength(f.x,f.y,g.x,g.y);let O=0;if(a)try{O=a(e[u-1].char,d)*this.fontSize()}catch{O=0}f.x+=O,g.x+=O,this.textWidth+=O;const y=he.getPointOnLine(O+m/2,f.x,f.y,g.x,g.y),_=Math.atan2(g.y-f.y,g.x-f.x);this.glyphInfo.push({transposeX:y.x,transposeY:y.y,text:t[u],rotation:_,p0:f,p1:g}),h+=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(c){t.push(c.p0.x),t.push(c.p0.y),t.push(c.p1.x),t.push(c.p1.y)});let e=t[0]||0,n=t[0]||0,s=t[1]||0,r=t[1]||0,o,a;for(let c=0;c<t.length/2;c++)o=t[c*2],a=t[c*2+1],e=Math.min(e,o),n=Math.max(n,o),s=Math.min(s,a),r=Math.max(r,a);const l=this.fontSize();return{x:e-l/2,y:s-l/2,width:n-e+l,height:r-s+l}}destroy(){return L.releaseCanvas(this.dummyCanvas),super.destroy()}}je.prototype._fillFunc=QS;je.prototype._strokeFunc=NS;je.prototype._fillFuncHit=QS;je.prototype._strokeFuncHit=NS;je.prototype.className="TextPath";je.prototype._attrsAffectingSize=["text","fontSize","data"];we(je);P.addGetterSetter(je,"data");P.addGetterSetter(je,"fontFamily","Arial");P.addGetterSetter(je,"fontSize",12,nt());P.addGetterSetter(je,"fontStyle",IS);P.addGetterSetter(je,"align","left");P.addGetterSetter(je,"letterSpacing",0,nt());P.addGetterSetter(je,"textBaseline","middle");P.addGetterSetter(je,"fontVariant",IS);P.addGetterSetter(je,"text",bE);P.addGetterSetter(je,"textDecoration","");P.addGetterSetter(je,"kerningFunc",void 0);const $S="tr-konva",vE=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(i=>i+`.${$S}`).join(" "),lb="nodesRect",_E=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],xE={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},SE="ontouchstart"in ot._global;function wE(i,t,e){if(i==="rotater")return e;t+=L.degToRad(xE[i]||0);const n=(L.radToDeg(t)%360+360)%360;return L._inRange(n,315+22.5,360)||L._inRange(n,0,22.5)?"ns-resize":L._inRange(n,45-22.5,45+22.5)?"nesw-resize":L._inRange(n,90-22.5,90+22.5)?"ew-resize":L._inRange(n,135-22.5,135+22.5)?"nwse-resize":L._inRange(n,180-22.5,180+22.5)?"ns-resize":L._inRange(n,225-22.5,225+22.5)?"nesw-resize":L._inRange(n,270-22.5,270+22.5)?"ew-resize":L._inRange(n,315-22.5,315+22.5)?"nwse-resize":(L.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Bf=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function kE(i){return{x:i.x+i.width/2*Math.cos(i.rotation)+i.height/2*Math.sin(-i.rotation),y:i.y+i.height/2*Math.cos(i.rotation)+i.width/2*Math.sin(i.rotation)}}function DS(i,t,e){const n=e.x+(i.x-e.x)*Math.cos(t)-(i.y-e.y)*Math.sin(t),s=e.y+(i.x-e.x)*Math.sin(t)+(i.y-e.y)*Math.cos(t);return{...i,rotation:i.rotation+t,x:n,y:s}}function CE(i,t){const e=kE(i);return DS(i,t,e)}function TE(i,t,e){let n=t;for(let s=0;s<i.length;s++){const r=ot.getAngle(i[s]),o=Math.abs(r-t)%(Math.PI*2);Math.min(o,Math.PI*2-o)<e&&(n=r)}return n}let pm=0;class Ft extends Ua{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(vE,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return L.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return $S+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(s=>s.isAncestorOf(this)?(L.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const r=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const o=s._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");s.on(o,r)}s.on(_E.map(o=>o+`.${this._getEventNamespace()}`).join(" "),r),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,r),this._proxyDrag(s)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,n=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!e)return;const s=t.getAbsolutePosition(),r=s.x-e.x,o=s.y-e.y;this.nodes().forEach(a=>{if(a===t||a.isDragging())return;const l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+r,y:l.y+o}),a.startDrag(n)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(lb),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(lb,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),n){const s=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(n),o=t.getAbsolutePosition(n),a=s.x*r.x-t.offsetX()*r.x,l=s.y*r.y-t.offsetY()*r.y,c=(ot.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),h={x:o.x+a*Math.cos(c)+l*Math.sin(-c),y:o.y+l*Math.cos(c)+a*Math.sin(c),width:s.width*r.x,height:s.height*r.y,rotation:c};return DS(h,-ot.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const e=[];this.nodes().map(c=>{const h=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),u=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}],f=c.getAbsoluteTransform();u.forEach(function(d){const p=f.point(d);e.push(p)})});const n=new an;n.rotate(-ot.getAngle(this.rotation()));let s=1/0,r=1/0,o=-1/0,a=-1/0;e.forEach(function(c){const h=n.point(c);s===void 0&&(s=o=h.x,r=a=h.y),s=Math.min(s,h.x),r=Math.min(r,h.y),o=Math.max(o,h.x),a=Math.max(a,h.y)}),n.invert();const l=n.point({x:s,y:r});return{x:l.x,y:l.y,width:o-s,height:a-r,rotation:ot.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Bf.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const e=new vh({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:SE?10:"auto"}),n=this;e.on("mousedown touchstart",function(s){n._handleMouseDown(s)}),e.on("dragstart",s=>{e.stopDrag(),s.cancelBubble=!0}),e.on("dragend",s=>{s.cancelBubble=!0}),e.on("mouseenter",()=>{const s=ot.getAngle(this.rotation()),r=this.rotateAnchorCursor(),o=wE(t,s,r);e.getStage().content&&(e.getStage().content.style.cursor=o),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){const t=new et({name:"back",width:0,height:0,sceneFunc(e,n){const s=n.getParent(),r=s.padding();e.beginPath(),e.rect(-r,-r,n.width()+r*2,n.height()+r*2),e.moveTo(n.width()/2,-r),s.rotateEnabled()&&s.rotateLineVisible()&&e.lineTo(n.width()/2,-s.rotateAnchorOffset()*L._sign(n.height())-r),e.fillStrokeShape(n)},hitFunc:(e,n)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();e.beginPath(),e.rect(-s,-s,n.width()+s*2,n.height()+s*2),e.fillStrokeShape(n)}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const e=this._getNodeRect(),n=e.width,s=e.height,r=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));this.sin=Math.abs(s/r),this.cos=Math.abs(n/r),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=t.target.getAbsolutePosition(),a=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-o.x,y:a.y-o.y},pm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){let e,n,s;const r=this.findOne("."+this._movingAnchorName),o=r.getStage();o.setPointersPositions(t);const a=o.getPointerPosition();let l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y};const c=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,t)),r.setAbsolutePosition(l);const h=r.getAbsolutePosition();if(c.x===h.x&&c.y===h.y)return;if(this._movingAnchorName==="rotater"){const y=this._getNodeRect();e=r.x()-y.width/2,n=-r.y()+y.height/2;let _=Math.atan2(-n,e)+Math.PI/2;y.height<0&&(_-=Math.PI);const b=ot.getAngle(this.rotation())+_,k=ot.getAngle(this.rotationSnapTolerance()),C=TE(this.rotationSnaps(),b,k)-y.rotation,I=CE(y,C);this._fitNodesInto(I,t);return}const u=this.shiftBehavior();let f;u==="inverted"?f=this.keepRatio()&&!t.shiftKey:u==="none"?f=this.keepRatio():f=this.keepRatio()||t.shiftKey;let d=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(f){const y=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(y.x-r.x(),2)+Math.pow(y.y-r.y(),2));const _=this.findOne(".top-left").x()>y.x?-1:1,v=this.findOne(".top-left").y()>y.y?-1:1;e=s*this.cos*_,n=s*this.sin*v,this.findOne(".top-left").x(y.x-e),this.findOne(".top-left").y(y.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(r.y());else if(this._movingAnchorName==="top-right"){if(f){const y=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(r.x()-y.x,2)+Math.pow(y.y-r.y(),2));const _=this.findOne(".top-right").x()<y.x?-1:1,v=this.findOne(".top-right").y()>y.y?-1:1;e=s*this.cos*_,n=s*this.sin*v,this.findOne(".top-right").x(y.x+e),this.findOne(".top-right").y(y.y-n)}var p=r.position();this.findOne(".top-left").y(p.y),this.findOne(".bottom-right").x(p.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(r.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(r.x());else if(this._movingAnchorName==="bottom-left"){if(f){const y=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(y.x-r.x(),2)+Math.pow(r.y()-y.y,2));const _=y.x<r.x()?-1:1,v=r.y()<y.y?-1:1;e=s*this.cos*_,n=s*this.sin*v,r.x(y.x-e),r.y(y.y+n)}p=r.position(),this.findOne(".top-left").x(p.x),this.findOne(".bottom-right").y(p.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(r.y());else if(this._movingAnchorName==="bottom-right"){if(f){const y=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(r.x()-y.x,2)+Math.pow(r.y()-y.y,2));const _=this.findOne(".bottom-right").x()<y.x?-1:1,v=this.findOne(".bottom-right").y()<y.y?-1:1;e=s*this.cos*_,n=s*this.sin*v,this.findOne(".bottom-right").x(y.x+e),this.findOne(".bottom-right").y(y.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(d=this.centeredScaling()||t.altKey,d){const y=this.findOne(".top-left"),_=this.findOne(".bottom-right"),v=y.x(),b=y.y(),k=this.getWidth()-_.x(),x=this.getHeight()-_.y();_.move({x:-v,y:-b}),y.move({x:k,y:x})}const g=this.findOne(".top-left").getAbsolutePosition();e=g.x,n=g.y;const m=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),O=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:n,width:m,height:O,rotation:ot.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();pm--,this._fire("transformend",{evt:t,target:n}),(e=this.getLayer())===null||e===void 0||e.batchDraw(),n&&this._nodes.forEach(s=>{var r;s._fire("transformend",{evt:t,target:s}),(r=s.getLayer())===null||r===void 0||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,e){const n=this._getNodeRect(),s=1;if(L._inRange(t.width,-this.padding()*2-s,s)){this.update();return}if(L._inRange(t.height,-this.padding()*2-s,s)){this.update();return}const r=new an;if(r.rotate(ot.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const f=r.point({x:-this.padding()*2,y:0});t.x+=f.x,t.y+=f.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const f=r.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const f=r.point({x:0,y:-this.padding()*2});t.x+=f.x,t.y+=f.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const f=r.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const f=this.boundBoxFunc()(n,t);f?t=f:L.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,a=new an;a.translate(n.x,n.y),a.rotate(n.rotation),a.scale(n.width/o,n.height/o);const l=new an,c=t.width/o,h=t.height/o;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(c),Math.abs(h))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(c,h));const u=l.multiply(a.invert());this._nodes.forEach(f=>{var d;if(!f.getStage())return;const p=f.getParent().getAbsoluteTransform(),g=f.getTransform().copy();g.translate(f.offsetX(),f.offsetY());const m=new an;m.multiply(p.copy().invert()).multiply(u).multiply(p).multiply(g);const O=m.decompose();f.setAttrs(O),(d=f.getLayer())===null||d===void 0||d.batchDraw()}),this.rotation(L._getRotation(t.rotation)),this._nodes.forEach(f=>{this._fire("transform",{evt:e,target:f}),f._fire("transform",{evt:e,target:f})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t;const e=this._getNodeRect();this.rotation(L._getRotation(e.rotation));const n=e.width,s=e.height,r=this.enabledAnchors(),o=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(u=>{u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:o&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+a,visible:o&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:o&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:l/2+a,visible:o&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:s/2,offsetX:l/2-a,visible:o&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:l/2+a,offsetY:l/2-a,visible:o&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:s,offsetY:l/2-a,visible:o&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:s,offsetX:l/2-a,offsetY:l/2-a,visible:o&&r.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*L._sign(s)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(u=>u.draggable()),x:0,y:0});const h=this.anchorStyleFunc();h&&c.forEach(u=>{h(u)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Ua.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return st.prototype.toObject.call(this)}clone(t){return st.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Ft.isTransforming=()=>pm>0;function PE(i){return i instanceof Array||L.warn("enabledAnchors value should be an array"),i instanceof Array&&i.forEach(function(t){Bf.indexOf(t)===-1&&L.warn("Unknown anchor name: "+t+". Available names are: "+Bf.join(", "))}),i||[]}Ft.prototype.className="Transformer";we(Ft);P.addGetterSetter(Ft,"enabledAnchors",Bf,PE);P.addGetterSetter(Ft,"flipEnabled",!0,Gn());P.addGetterSetter(Ft,"resizeEnabled",!0);P.addGetterSetter(Ft,"anchorSize",10,nt());P.addGetterSetter(Ft,"rotateEnabled",!0);P.addGetterSetter(Ft,"rotateLineVisible",!0);P.addGetterSetter(Ft,"rotationSnaps",[]);P.addGetterSetter(Ft,"rotateAnchorOffset",50,nt());P.addGetterSetter(Ft,"rotateAnchorCursor","crosshair");P.addGetterSetter(Ft,"rotationSnapTolerance",5,nt());P.addGetterSetter(Ft,"borderEnabled",!0);P.addGetterSetter(Ft,"anchorStroke","rgb(0, 161, 255)");P.addGetterSetter(Ft,"anchorStrokeWidth",1,nt());P.addGetterSetter(Ft,"anchorFill","white");P.addGetterSetter(Ft,"anchorCornerRadius",0,nt());P.addGetterSetter(Ft,"borderStroke","rgb(0, 161, 255)");P.addGetterSetter(Ft,"borderStrokeWidth",1,nt());P.addGetterSetter(Ft,"borderDash");P.addGetterSetter(Ft,"keepRatio",!0);P.addGetterSetter(Ft,"shiftBehavior","default");P.addGetterSetter(Ft,"centeredScaling",!1);P.addGetterSetter(Ft,"ignoreStroke",!1);P.addGetterSetter(Ft,"padding",0,nt());P.addGetterSetter(Ft,"nodes");P.addGetterSetter(Ft,"node");P.addGetterSetter(Ft,"boundBoxFunc");P.addGetterSetter(Ft,"anchorDragBoundFunc");P.addGetterSetter(Ft,"anchorStyleFunc");P.addGetterSetter(Ft,"shouldOverdrawWholeArea",!1);P.addGetterSetter(Ft,"useSingleNodeRotation",!0);P.backCompat(Ft,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class lr extends et{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,ot.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}lr.prototype.className="Wedge";lr.prototype._centroid=!0;lr.prototype._attrsAffectingSize=["radius"];we(lr);P.addGetterSetter(lr,"radius",0,nt());P.addGetterSetter(lr,"angle",0,nt());P.addGetterSetter(lr,"clockwise",!1);P.backCompat(lr,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function cb(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const AE=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],ME=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function EE(i,t){const e=i.data,n=i.width,s=i.height;let r,o,a,l,c,h,u,f,d,p,g,m,O,y,_,v,b,k,x,C;const I=t+t+1,R=n-1,$=s-1,E=t+1,Z=E*(E+1)/2,F=new cb,W=AE[t],B=ME[t];let U=null,V=F,X=null,j=null;for(let tt=1;tt<I;tt++)V=V.next=new cb,tt===E&&(U=V);V.next=F,a=o=0;for(let tt=0;tt<s;tt++){m=O=y=_=l=c=h=u=0,f=E*(v=e[o]),d=E*(b=e[o+1]),p=E*(k=e[o+2]),g=E*(x=e[o+3]),l+=Z*v,c+=Z*b,h+=Z*k,u+=Z*x,V=F;for(let it=0;it<E;it++)V.r=v,V.g=b,V.b=k,V.a=x,V=V.next;for(let it=1;it<E;it++)r=o+((R<it?R:it)<<2),l+=(V.r=v=e[r])*(C=E-it),c+=(V.g=b=e[r+1])*C,h+=(V.b=k=e[r+2])*C,u+=(V.a=x=e[r+3])*C,m+=v,O+=b,y+=k,_+=x,V=V.next;X=F,j=U;for(let it=0;it<n;it++)e[o+3]=x=u*W>>B,x!==0?(x=255/x,e[o]=(l*W>>B)*x,e[o+1]=(c*W>>B)*x,e[o+2]=(h*W>>B)*x):e[o]=e[o+1]=e[o+2]=0,l-=f,c-=d,h-=p,u-=g,f-=X.r,d-=X.g,p-=X.b,g-=X.a,r=a+((r=it+t+1)<R?r:R)<<2,m+=X.r=e[r],O+=X.g=e[r+1],y+=X.b=e[r+2],_+=X.a=e[r+3],l+=m,c+=O,h+=y,u+=_,X=X.next,f+=v=j.r,d+=b=j.g,p+=k=j.b,g+=x=j.a,m-=v,O-=b,y-=k,_-=x,j=j.next,o+=4;a+=n}for(let tt=0;tt<n;tt++){O=y=_=m=c=h=u=l=0,o=tt<<2,f=E*(v=e[o]),d=E*(b=e[o+1]),p=E*(k=e[o+2]),g=E*(x=e[o+3]),l+=Z*v,c+=Z*b,h+=Z*k,u+=Z*x,V=F;for(let _t=0;_t<E;_t++)V.r=v,V.g=b,V.b=k,V.a=x,V=V.next;let it=n;for(let _t=1;_t<=t;_t++)o=it+tt<<2,l+=(V.r=v=e[o])*(C=E-_t),c+=(V.g=b=e[o+1])*C,h+=(V.b=k=e[o+2])*C,u+=(V.a=x=e[o+3])*C,m+=v,O+=b,y+=k,_+=x,V=V.next,_t<$&&(it+=n);o=tt,X=F,j=U;for(let _t=0;_t<s;_t++)r=o<<2,e[r+3]=x=u*W>>B,x>0?(x=255/x,e[r]=(l*W>>B)*x,e[r+1]=(c*W>>B)*x,e[r+2]=(h*W>>B)*x):e[r]=e[r+1]=e[r+2]=0,l-=f,c-=d,h-=p,u-=g,f-=X.r,d-=X.g,p-=X.b,g-=X.a,r=tt+((r=_t+E)<$?r:$)*n<<2,l+=m+=X.r=e[r],c+=O+=X.g=e[r+1],h+=y+=X.b=e[r+2],u+=_+=X.a=e[r+3],X=X.next,f+=v=j.r,d+=b=j.g,p+=k=j.b,g+=x=j.a,m-=v,O-=b,y-=k,_-=x,j=j.next,o+=n}}const RE=function(t){const e=Math.round(this.blurRadius());e>0&&EE(t,e)};P.addGetterSetter(st,"blurRadius",0,nt(),P.afterSetFilter);const IE=function(i){const t=this.brightness()*255,e=i.data,n=e.length;for(let s=0;s<n;s+=4)e[s]+=t,e[s+1]+=t,e[s+2]+=t};P.addGetterSetter(st,"brightness",0,nt(),P.afterSetFilter);const QE=function(i){const t=this.brightness(),e=i.data,n=e.length;for(let s=0;s<n;s+=4)e[s]=Math.min(255,e[s]*t),e[s+1]=Math.min(255,e[s+1]*t),e[s+2]=Math.min(255,e[s+2]*t)},NE=function(i){const t=Math.pow((this.contrast()+100)/100,2),e=i.data,n=e.length;let s=150,r=150,o=150;for(let a=0;a<n;a+=4)s=e[a],r=e[a+1],o=e[a+2],s/=255,s-=.5,s*=t,s+=.5,s*=255,r/=255,r-=.5,r*=t,r+=.5,r*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,s=s<0?0:s>255?255:s,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,e[a]=s,e[a+1]=r,e[a+2]=o};P.addGetterSetter(st,"contrast",0,nt(),P.afterSetFilter);const $E=function(i){var t,e,n,s,r,o,a,l,c;const h=i.data,u=i.width,f=i.height,d=Math.min(1,Math.max(0,(e=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&e!==void 0?e:.5)),p=Math.min(1,Math.max(0,(s=(n=this.embossWhiteLevel)===null||n===void 0?void 0:n.call(this))!==null&&s!==void 0?s:.5)),m=(a={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(o=(r=this.embossDirection)===null||r===void 0?void 0:r.call(this))!==null&&o!==void 0?o:"top-left"])!==null&&a!==void 0?a:315,O=!!((c=(l=this.embossBlend)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0&&c),y=d*10,_=p*255,v=m*Math.PI/180,b=Math.cos(v),k=Math.sin(v),x=128/1020*y,C=new Uint8ClampedArray(h),I=new Float32Array(u*f);for(let F=0,W=0;W<h.length;W+=4,F++)I[F]=.2126*C[W]+.7152*C[W+1]+.0722*C[W+2];const R=[-1,0,1,-2,0,2,-1,0,1],$=[-1,-2,-1,0,0,0,1,2,1],E=[-u-1,-u,-u+1,-1,0,1,u-1,u,u+1],Z=F=>F<0?0:F>255?255:F;for(let F=1;F<f-1;F++)for(let W=1;W<u-1;W++){const B=F*u+W;let U=0,V=0;U+=I[B+E[0]]*R[0],V+=I[B+E[0]]*$[0],U+=I[B+E[1]]*R[1],V+=I[B+E[1]]*$[1],U+=I[B+E[2]]*R[2],V+=I[B+E[2]]*$[2],U+=I[B+E[3]]*R[3],V+=I[B+E[3]]*$[3],U+=I[B+E[5]]*R[5],V+=I[B+E[5]]*$[5],U+=I[B+E[6]]*R[6],V+=I[B+E[6]]*$[6],U+=I[B+E[7]]*R[7],V+=I[B+E[7]]*$[7],U+=I[B+E[8]]*R[8],V+=I[B+E[8]]*$[8];const X=b*U+k*V,j=Z(_+X*x),tt=B*4;if(O){const it=j-_;h[tt]=Z(C[tt]+it),h[tt+1]=Z(C[tt+1]+it),h[tt+2]=Z(C[tt+2]+it),h[tt+3]=C[tt+3]}else h[tt]=h[tt+1]=h[tt+2]=j,h[tt+3]=C[tt+3]}for(let F=0;F<u;F++){let W=F*4,B=((f-1)*u+F)*4;h[W]=C[W],h[W+1]=C[W+1],h[W+2]=C[W+2],h[W+3]=C[W+3],h[B]=C[B],h[B+1]=C[B+1],h[B+2]=C[B+2],h[B+3]=C[B+3]}for(let F=1;F<f-1;F++){let W=F*u*4,B=(F*u+(u-1))*4;h[W]=C[W],h[W+1]=C[W+1],h[W+2]=C[W+2],h[W+3]=C[W+3],h[B]=C[B],h[B+1]=C[B+1],h[B+2]=C[B+2],h[B+3]=C[B+3]}return i};P.addGetterSetter(st,"embossStrength",.5,nt(),P.afterSetFilter);P.addGetterSetter(st,"embossWhiteLevel",.5,nt(),P.afterSetFilter);P.addGetterSetter(st,"embossDirection","top-left",void 0,P.afterSetFilter);P.addGetterSetter(st,"embossBlend",!1,void 0,P.afterSetFilter);function Zp(i,t,e,n,s){const r=e-t,o=s-n;if(r===0)return n+o/2;if(o===0)return n;let a=(i-t)/r;return a=o*a+n,a}const DE=function(i){const t=i.data,e=t.length;let n=t[0],s=n,r,o=t[1],a=o,l,c=t[2],h=c,u;const f=this.enhance();if(f===0)return;for(let _=0;_<e;_+=4)r=t[_+0],r<n?n=r:r>s&&(s=r),l=t[_+1],l<o?o=l:l>a&&(a=l),u=t[_+2],u<c?c=u:u>h&&(h=u);s===n&&(s=255,n=0),a===o&&(a=255,o=0),h===c&&(h=255,c=0);let d,p,g,m,O,y;if(f>0)d=s+f*(255-s),p=n-f*(n-0),g=a+f*(255-a),m=o-f*(o-0),O=h+f*(255-h),y=c-f*(c-0);else{const _=(s+n)*.5;d=s+f*(s-_),p=n+f*(n-_);const v=(a+o)*.5;g=a+f*(a-v),m=o+f*(o-v);const b=(h+c)*.5;O=h+f*(h-b),y=c+f*(c-b)}for(let _=0;_<e;_+=4)t[_+0]=Zp(t[_+0],n,s,p,d),t[_+1]=Zp(t[_+1],o,a,m,g),t[_+2]=Zp(t[_+2],c,h,y,O)};P.addGetterSetter(st,"enhance",0,nt(),P.afterSetFilter);const LE=function(i){const t=i.data,e=t.length;for(let n=0;n<e;n+=4){const s=.34*t[n]+.5*t[n+1]+.16*t[n+2];t[n]=s,t[n+1]=s,t[n+2]=s}};P.addGetterSetter(st,"hue",0,nt(),P.afterSetFilter);P.addGetterSetter(st,"saturation",0,nt(),P.afterSetFilter);P.addGetterSetter(st,"luminance",0,nt(),P.afterSetFilter);const VE=function(i){const t=i.data,e=t.length,n=1,s=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,o=this.luminance()*127,a=n*s*Math.cos(r*Math.PI/180),l=n*s*Math.sin(r*Math.PI/180),c=.299*n+.701*a+.167*l,h=.587*n-.587*a+.33*l,u=.114*n-.114*a-.497*l,f=.299*n-.299*a-.328*l,d=.587*n+.413*a+.035*l,p=.114*n-.114*a+.293*l,g=.299*n-.3*a+1.25*l,m=.587*n-.586*a-1.05*l,O=.114*n+.886*a-.2*l;let y,_,v,b;for(let k=0;k<e;k+=4)y=t[k+0],_=t[k+1],v=t[k+2],b=t[k+3],t[k+0]=c*y+h*_+u*v+o,t[k+1]=f*y+d*_+p*v+o,t[k+2]=g*y+m*_+O*v+o,t[k+3]=b},BE=function(i){const t=i.data,e=t.length,n=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,o=n*s*Math.cos(r*Math.PI/180),a=n*s*Math.sin(r*Math.PI/180),l=.299*n+.701*o+.167*a,c=.587*n-.587*o+.33*a,h=.114*n-.114*o-.497*a,u=.299*n-.299*o-.328*a,f=.587*n+.413*o+.035*a,d=.114*n-.114*o+.293*a,p=.299*n-.3*o+1.25*a,g=.587*n-.586*o-1.05*a,m=.114*n+.886*o-.2*a;for(let O=0;O<e;O+=4){const y=t[O+0],_=t[O+1],v=t[O+2],b=t[O+3];t[O+0]=l*y+c*_+h*v,t[O+1]=u*y+f*_+d*v,t[O+2]=p*y+g*_+m*v,t[O+3]=b}};P.addGetterSetter(st,"hue",0,nt(),P.afterSetFilter);P.addGetterSetter(st,"saturation",0,nt(),P.afterSetFilter);P.addGetterSetter(st,"value",0,nt(),P.afterSetFilter);const ZE=function(i){const t=i.data,e=t.length;for(let n=0;n<e;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2]},FE=function(i,t,e){const n=i.data,s=t.data,r=i.width,o=i.height,a=e.polarCenterX||r/2,l=e.polarCenterY||o/2;let c=Math.sqrt(a*a+l*l),h=r-a,u=o-l;const f=Math.sqrt(h*h+u*u);c=f>c?f:c;const d=o,p=r,g=360/p*Math.PI/180;for(let m=0;m<p;m+=1){const O=Math.sin(m*g),y=Math.cos(m*g);for(let _=0;_<d;_+=1){h=Math.floor(a+c*_/d*y),u=Math.floor(l+c*_/d*O);let v=(u*r+h)*4;const b=n[v+0],k=n[v+1],x=n[v+2],C=n[v+3];v=(m+_*r)*4,s[v+0]=b,s[v+1]=k,s[v+2]=x,s[v+3]=C}}},WE=function(i,t,e){const n=i.data,s=t.data,r=i.width,o=i.height,a=e.polarCenterX||r/2,l=e.polarCenterY||o/2;let c=Math.sqrt(a*a+l*l),h=r-a,u=o-l;const f=Math.sqrt(h*h+u*u);c=f>c?f:c;const d=o,p=r,g=0;let m,O;for(h=0;h<r;h+=1)for(u=0;u<o;u+=1){const y=h-a,_=u-l,v=Math.sqrt(y*y+_*_)*d/c;let b=(Math.atan2(_,y)*180/Math.PI+360+g)%360;b=b*p/360,m=Math.floor(b),O=Math.floor(v);let k=(O*r+m)*4;const x=n[k+0],C=n[k+1],I=n[k+2],R=n[k+3];k=(u*r+h)*4,s[k+0]=x,s[k+1]=C,s[k+2]=I,s[k+3]=R}},qE=function(i){const t=i.width,e=i.height;let n,s,r,o,a,l,c,h,u,f,d=Math.round(this.kaleidoscopePower());const p=Math.round(this.kaleidoscopeAngle()),g=Math.floor(t*(p%360)/360);if(d<1)return;const m=L.createCanvasElement();m.width=t,m.height=e;const O=m.getContext("2d").getImageData(0,0,t,e);L.releaseCanvas(m),FE(i,O,{polarCenterX:t/2,polarCenterY:e/2});let y=t/Math.pow(2,d);for(;y<=8;)y=y*2,d-=1;y=Math.ceil(y);let _=y,v=0,b=_,k=1;for(g+y>t&&(v=_,b=0,k=-1),s=0;s<e;s+=1)for(n=v;n!==b;n+=k)r=Math.round(n+g)%t,u=(t*s+r)*4,a=O.data[u+0],l=O.data[u+1],c=O.data[u+2],h=O.data[u+3],f=(t*s+n)*4,O.data[f+0]=a,O.data[f+1]=l,O.data[f+2]=c,O.data[f+3]=h;for(s=0;s<e;s+=1)for(_=Math.floor(y),o=0;o<d;o+=1){for(n=0;n<_+1;n+=1)u=(t*s+n)*4,a=O.data[u+0],l=O.data[u+1],c=O.data[u+2],h=O.data[u+3],f=(t*s+_*2-n-1)*4,O.data[f+0]=a,O.data[f+1]=l,O.data[f+2]=c,O.data[f+3]=h;_*=2}WE(O,i,{})};P.addGetterSetter(st,"kaleidoscopePower",2,nt(),P.afterSetFilter);P.addGetterSetter(st,"kaleidoscopeAngle",0,nt(),P.afterSetFilter);function au(i,t,e){let n=(e*i.width+t)*4;const s=[];return s.push(i.data[n++],i.data[n++],i.data[n++],i.data[n++]),s}function Al(i,t){return Math.sqrt(Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)+Math.pow(i[2]-t[2],2))}function XE(i){const t=[0,0,0];for(let e=0;e<i.length;e++)t[0]+=i[e][0],t[1]+=i[e][1],t[2]+=i[e][2];return t[0]/=i.length,t[1]/=i.length,t[2]/=i.length,t}function zE(i,t){const e=au(i,0,0),n=au(i,i.width-1,0),s=au(i,0,i.height-1),r=au(i,i.width-1,i.height-1),o=t||10;if(Al(e,n)<o&&Al(n,r)<o&&Al(r,s)<o&&Al(s,e)<o){const a=XE([n,e,r,s]),l=[];for(let c=0;c<i.width*i.height;c++){const h=Al(a,[i.data[c*4],i.data[c*4+1],i.data[c*4+2]]);l[c]=h<o?0:255}return l}}function GE(i,t){for(let e=0;e<i.width*i.height;e++)i.data[4*e+3]=t[e]}function jE(i,t,e){const n=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(n.length)),r=Math.floor(s/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let u=0;u<s;u++)for(let f=0;f<s;f++){const d=a+u-r,p=l+f-r;if(d>=0&&d<e&&p>=0&&p<t){const g=d*t+p,m=n[u*s+f];h+=i[g]*m}}o[c]=h===2040?255:0}return o}function UE(i,t,e){const n=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(n.length)),r=Math.floor(s/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let u=0;u<s;u++)for(let f=0;f<s;f++){const d=a+u-r,p=l+f-r;if(d>=0&&d<e&&p>=0&&p<t){const g=d*t+p,m=n[u*s+f];h+=i[g]*m}}o[c]=h>=1020?255:0}return o}function YE(i,t,e){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(n.length)),r=Math.floor(s/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let u=0;u<s;u++)for(let f=0;f<s;f++){const d=a+u-r,p=l+f-r;if(d>=0&&d<e&&p>=0&&p<t){const g=d*t+p,m=n[u*s+f];h+=i[g]*m}}o[c]=h}return o}const HE=function(i){const t=this.threshold();let e=zE(i,t);return e&&(e=jE(e,i.width,i.height),e=UE(e,i.width,i.height),e=YE(e,i.width,i.height),GE(i,e)),i};P.addGetterSetter(st,"threshold",0,nt(),P.afterSetFilter);const KE=function(i){const t=this.noise()*255,e=i.data,n=e.length,s=t/2;for(let r=0;r<n;r+=4)e[r+0]+=s-2*s*Math.random(),e[r+1]+=s-2*s*Math.random(),e[r+2]+=s-2*s*Math.random()};P.addGetterSetter(st,"noise",.2,nt(),P.afterSetFilter);const JE=function(i){let t=Math.ceil(this.pixelSize()),e=i.width,n=i.height,s=Math.ceil(e/t),r=Math.ceil(n/t),o=i.data;if(t<=0){L.error("pixelSize value can not be <= 0");return}for(let a=0;a<s;a+=1)for(let l=0;l<r;l+=1){let c=0,h=0,u=0,f=0;const d=a*t,p=d+t,g=l*t,m=g+t;let O=0;for(let y=d;y<p;y+=1)if(!(y>=e))for(let _=g;_<m;_+=1){if(_>=n)continue;const v=(e*_+y)*4;c+=o[v+0],h+=o[v+1],u+=o[v+2],f+=o[v+3],O+=1}c=c/O,h=h/O,u=u/O,f=f/O;for(let y=d;y<p;y+=1)if(!(y>=e))for(let _=g;_<m;_+=1){if(_>=n)continue;const v=(e*_+y)*4;o[v+0]=c,o[v+1]=h,o[v+2]=u,o[v+3]=f}}};P.addGetterSetter(st,"pixelSize",8,nt(),P.afterSetFilter);const tR=function(i){const t=Math.round(this.levels()*254)+1,e=i.data,n=e.length,s=255/t;for(let r=0;r<n;r+=1)e[r]=Math.floor(e[r]/s)*s};P.addGetterSetter(st,"levels",.5,nt(),P.afterSetFilter);const eR=function(i){const t=i.data,e=t.length,n=this.red(),s=this.green(),r=this.blue();for(let o=0;o<e;o+=4){const a=(.34*t[o]+.5*t[o+1]+.16*t[o+2])/255;t[o]=a*n,t[o+1]=a*s,t[o+2]=a*r,t[o+3]=t[o+3]}};P.addGetterSetter(st,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});P.addGetterSetter(st,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});P.addGetterSetter(st,"blue",0,aS,P.afterSetFilter);const iR=function(i){const t=i.data,e=t.length,n=this.red(),s=this.green(),r=this.blue(),o=this.alpha();for(let a=0;a<e;a+=4){const l=1-o;t[a]=n*o+t[a]*l,t[a+1]=s*o+t[a+1]*l,t[a+2]=r*o+t[a+2]*l}};P.addGetterSetter(st,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});P.addGetterSetter(st,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});P.addGetterSetter(st,"blue",0,aS,P.afterSetFilter);P.addGetterSetter(st,"alpha",1,function(i){return this._filterUpToDate=!1,i>1?1:i<0?0:i});const nR=function(i){const t=i.data,e=t.length;for(let n=0;n<e;n+=4){const s=t[n+0],r=t[n+1],o=t[n+2];t[n+0]=Math.min(255,s*.393+r*.769+o*.189),t[n+1]=Math.min(255,s*.349+r*.686+o*.168),t[n+2]=Math.min(255,s*.272+r*.534+o*.131)}},sR=function(i){const e=i.data;for(let n=0;n<e.length;n+=4){const s=e[n],r=e[n+1],o=e[n+2];.2126*s+.7152*r+.0722*o>=128&&(e[n]=255-s,e[n+1]=255-r,e[n+2]=255-o)}return i},rR=function(i){const t=this.threshold()*255,e=i.data,n=e.length;for(let s=0;s<n;s+=1)e[s]=e[s]<t?0:255};P.addGetterSetter(st,"threshold",.5,nt(),P.afterSetFilter);const hi=Ky.Util._assign(Ky,{Arc:or,Arrow:Uo,Circle:gl,Ellipse:Jr,Image:An,Label:NO,Tag:Yo,Line:ar,Path:he,Rect:vh,RegularPolygon:to,Ring:Ho,Sprite:As,Star:eo,Text:Oe,TextPath:je,Transformer:Ft,Wedge:lr,Filters:{Blur:RE,Brightness:QE,Brighten:IE,Contrast:NE,Emboss:$E,Enhance:DE,Grayscale:LE,HSL:VE,HSV:BE,Invert:ZE,Kaleidoscope:qE,Mask:HE,Noise:KE,Pixelate:JE,Posterize:tR,RGB:eR,RGBA:iR,Sepia:nR,Solarize:sR,Threshold:rR}}),oR=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:1100,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map,createEmptyOverlapAdjustments:()=>({toDelete:new Set,toTruncate:new Map})},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0,midi:{manager:void 0,enabled:!1,selectedDeviceId:null,availableDevices:[]}}),aR=(i="note_")=>`${i}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function hb(i,t){const{scrollX:e,scrollY:n}=t.viewport,{quarterNoteWidth:s,noteHeight:r}=t.grid,o=i.x+e,a=i.y+n,l=o/s;return{pitch:127-Math.floor(a/r),position:l}}function Zf(i,t,e){const{scrollX:n,scrollY:s}=e.viewport,{quarterNoteWidth:r,noteHeight:o}=e.grid,a=t*r,l=(127-i)*o;return{x:a-n,y:l-s}}function ub(i,t){const e=t/4;return Math.floor(i*e)/e}function LS(i){return i.grid.quarterNoteWidth*(4/i.grid.subdivision)}function VS(i,t){const{scrollX:e,scrollY:n}=t.viewport,{quarterNoteWidth:s,noteHeight:r}=t.grid,o=t.stage;if(!o)return!1;const a=o.width(),l=o.height(),c=e/s,h=(e+a)/s,u=Math.floor(n/r),f=Math.ceil((n+l)/r),d=i.position+i.duration,p=127-i.pitch;return!(d<c||i.position>h||p<u||p>f)}function lR(i,t){const{quarterNoteWidth:e,noteHeight:n}=i.grid,s=[];return i.notes.forEach((r,o)=>{const a=Zf(r.pitch,r.position,i),l=r.duration*e,c=a.x+l,h=a.y+n,u=t.x+t.width,f=t.y+t.height;!(c<t.x||a.x>u||h<t.y||a.y>f)&&s.push(o)}),s}function BS(i,t){const e=new Set(t);if(e.size===0)return i.interaction.createEmptyOverlapAdjustments();const n=new Set,s=new Map;return e.forEach(r=>{const o=i.notes.get(r);if(!o)return;const a=o.position+o.duration;i.notes.forEach((l,c)=>{if(e.has(c)||l.pitch!==o.pitch)return;const h=l.position+l.duration;if(l.position<o.position&&o.position<h){const u=o.position-l.position;u>0?n.has(c)||s.set(c,u):(n.add(c),s.delete(c))}else o.position<=l.position&&l.position<a&&(n.add(c),s.delete(c))})}),n.size===0&&s.size===0?i.interaction.createEmptyOverlapAdjustments():{toDelete:n,toTruncate:s}}function ZS(i){i.interaction.hiddenNoteIds.clear(),i.interaction.truncatedNotes.clear();const t=BS(i,i.selection.selectedIds);t.toDelete.forEach(e=>i.interaction.hiddenNoteIds.add(e)),t.toTruncate.forEach((e,n)=>i.interaction.truncatedNotes.set(n,e))}function cR(i,t,e){return i.interaction.truncatedNotes.get(t)??e}function $O(i,t){let e=null,n=!1;if(!t&&(i.interaction.hiddenNoteIds.size>0||i.interaction.truncatedNotes.size>0))e={toDelete:new Set(i.interaction.hiddenNoteIds),toTruncate:new Map(i.interaction.truncatedNotes)},n=!0;else{const s=t??i.selection.selectedIds;e=BS(i,s)}return e.toDelete.size===0&&e.toTruncate.size===0?(n||(i.interaction.hiddenNoteIds.clear(),i.interaction.truncatedNotes.clear()),e):(e.toDelete.forEach(s=>{i.notes.delete(s),i.selection.selectedIds.delete(s)}),e.toTruncate.forEach((s,r)=>{const o=i.notes.get(r);o&&(o.duration=Math.max(s,0))}),i.needsRedraw=!0,n||(i.interaction.hiddenNoteIds.clear(),i.interaction.truncatedNotes.clear()),e)}function FS(i){i.interaction.truncatedNotes.clear(),i.interaction.hiddenNoteIds.clear()}function hR(i){let e=null;for(const n of i.selection.selectedIds){const s=i.notes.get(n);if(!s)continue;let r=1/0,o=null;if(i.notes.forEach((a,l)=>{if(i.selection.selectedIds.has(l))return;const c=Math.abs(s.position-a.position);c<r&&c<.1&&(r=c,o=a.position)}),o!==null){e=o-s.position;break}}e!==null&&i.selection.selectedIds.forEach(n=>{const s=i.notes.get(n);s&&(s.position+=e)})}const uR=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function fb(i){const t=(i%12+12)%12;return(uR[t]??"C")+(Math.floor(i/12)-2)}class fR{constructor(t,e,n){this.captureState=t,this.restoreState=e,this.onChangeCallback=n}stack=[];currentIndex=-1;onChangeCallback;executeCommand(t,e){const n=this.captureState();e();const s=this.captureState();n!==s&&this.pushCommand(t,n,s)}pushCommand(t,e,n){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:t,beforeState:e,afterState:n}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const t=this.stack[this.currentIndex];this.restoreState(t.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const t=this.stack[this.currentIndex];this.restoreState(t.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}function dR(i,t,e){const n=g=>{const m=g.startsWith("#")?g.slice(1):g,O=m.length===3?m.split("").map(y=>y+y).join(""):m;return parseInt(O,16)},s=n(i),r=n(t),o=s>>16&255,a=s>>8&255,l=s&255,c=r>>16&255,h=r>>8&255,u=r&255,f=Math.round(o+(c-o)*e),d=Math.round(a+(h-a)*e),p=Math.round(l+(u-l)*e);return`#${(f<<16|d<<8|p).toString(16).padStart(6,"0")}`}function _h(i){return JSON.stringify({notes:Array.from(i.notes.entries()),selection:Array.from(i.selection.selectedIds)})}function pR(i,t){const e=JSON.parse(t);i.notes=new Map(e.notes),i.selection.selectedIds=new Set(e.selection),i.needsRedraw=!0}function gR(i,t){if(i.size!==t.size)return!0;for(const e of i)if(!t.has(e))return!0;return!1}function Fp(i,t){const e=new Set(i.selection.selectedIds);t();const n=gR(e,i.selection.selectedIds);return n&&i.notifyExternalChange?.(),n}function mR(i,t,e){const n=new hi.Layer({listening:!1,name:"grid-layer"});t.add(n),i.layers.grid=n;const s=new hi.Layer({name:"notes-layer"});t.add(s),i.layers.notes=s;const r=new hi.Layer({name:"overlay-layer"});t.add(r),i.layers.overlay=r,i.selection.selectionRect=new hi.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),r.add(i.selection.selectionRect);const o=128*i.grid.noteHeight;i.livePlayhead.element=new hi.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),r.add(i.livePlayhead.element),i.queuePlayhead.element=new hi.Line({points:[0,0,0,o],stroke:"#33dd00",strokeWidth:2,listening:!1}),r.add(i.queuePlayhead.element),i.command.stack=new fR(()=>_h(i),a=>pR(i,a),()=>{i.needsRedraw=!0,e?.()})}function OR(i){const t=i.layers.grid;if(!t||!i.stage)return;const e=i.renderCache.grid;if(e.lastScrollX===i.viewport.scrollX&&e.lastScrollY===i.viewport.scrollY&&e.lastSubdivision===i.grid.subdivision&&e.lastQuarterNoteWidth===i.grid.quarterNoteWidth&&e.lastNoteHeight===i.grid.noteHeight)return;e.lastScrollX=i.viewport.scrollX,e.lastScrollY=i.viewport.scrollY,e.lastSubdivision=i.grid.subdivision,e.lastQuarterNoteWidth=i.grid.quarterNoteWidth,e.lastNoteHeight=i.grid.noteHeight,t.destroyChildren();const{scrollX:n,scrollY:s}=i.viewport,{quarterNoteWidth:r,noteHeight:o,numMeasures:a,timeSignature:l}=i.grid,c=i.stage,h=c.width(),u=c.height(),f=128*o,d=l*4,p=r*d,g=Math.floor(n/p),m=Math.ceil((n+h)/p);for(let x=g;x<=m&&x<a;x++){const C=x%2===0?i.grid.backgroundColor1:i.grid.backgroundColor2,I=x*p-n;t.add(new hi.Rect({x:I,y:-s,width:p,height:f,fill:C,listening:!1}))}const O=a*d*(i.grid.subdivision/4),y=r*(4/i.grid.subdivision),_=Math.floor(n/y),v=Math.ceil((n+h)/y);for(let x=_;x<=v&&x<O;x++){const C=x*y-n,R=x*y%r===0?1.8:1;t.add(new hi.Line({points:[C,-s,C,f-s],stroke:"#000",strokeWidth:R,listening:!1}))}const b=Math.floor(s/o),k=Math.ceil((s+u)/o);for(let x=b;x<=k&&x<128;x++){const C=x*o-s;t.add(new hi.Line({points:[0-n,C,a*p-n,C],stroke:"#000",strokeWidth:1,listening:!1}))}t.batchDraw()}function yR(i){const t=i.layers.notes;if(!t||!i.stage)return;t.destroyChildren();const{quarterNoteWidth:e,noteHeight:n}=i.grid,s=[],r=[];i.notes.forEach((o,a)=>{VS(o,i)&&(i.selection.selectedIds.has(a)?r.push([a,o]):s.push([a,o]))}),s.forEach(([o,a])=>{const l=Zf(a.pitch,a.position,i),h=cR(i,o,a.duration)*e,u=i.interaction.hiddenNoteIds.has(o),f=Math.min(1,Math.max(0,a.velocity/127)),d=dR(i.grid.noteColor,"#444444",1-f),p=new hi.Rect({x:l.x,y:l.y,width:h,height:n,fill:d,stroke:"#000",strokeWidth:1,opacity:u?.3:1,listening:!0});p.setAttr("noteId",o),t.add(p);const g=fb(a.pitch),m=new hi.Text({x:l.x+4,y:l.y+2,text:g,fontSize:14,fill:"#000",listening:!1});t.add(m)}),r.forEach(([o,a])=>{const l=Zf(a.pitch,a.position,i),c=a.duration*e,h=i.interaction.hiddenNoteIds.has(o),u=new hi.Rect({x:l.x,y:l.y,width:c,height:n,fill:i.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:h?.3:1,listening:!0});u.setAttr("noteId",o),t.add(u);const f=fb(a.pitch),d=new hi.Text({x:l.x+4,y:l.y+2,text:f,fontSize:14,fill:"#000",listening:!1});t.add(d)}),t.batchDraw()}function bR(i){const t=i.layers.notes;if(!t)return;const{quarterNoteWidth:e,noteHeight:n}=i.grid,s=5;t.find(".resize-handle").forEach(r=>r.destroy()),i.selection.selectedIds.forEach(r=>{const o=i.notes.get(r);if(!o||!VS(o,i))return;const a=Zf(o.pitch,o.position,i),l=o.duration*e,c=new hi.Circle({x:a.x,y:a.y+n/2,radius:s,fill:"#000",listening:!0,name:"resize-handle"});c.setAttr("handleNoteId",r),c.setAttr("handleIsEnd",!1),t.add(c);const h=new hi.Circle({x:a.x+l,y:a.y+n/2,radius:s,fill:"#000",listening:!0,name:"resize-handle"});h.setAttr("handleNoteId",r),h.setAttr("handleIsEnd",!0),t.add(h)}),t.batchDraw()}function vR(i){if(!i.selection.selectionRect||!i.interaction.marqueeStart||!i.interaction.marqueeCurrent)return;const t=i.interaction.marqueeStart,e=i.interaction.marqueeCurrent,n=Math.min(t.x,e.x),s=Math.min(t.y,e.y),r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);i.selection.selectionRect.setAttrs({x:n,y:s,width:r,height:o,visible:r>5||o>5}),i.layers.overlay?.batchDraw()}function _R(i){if(!i.queuePlayhead.element)return;const{scrollX:t}=i.viewport,e=i.queuePlayhead.position*i.grid.quarterNoteWidth-t;i.queuePlayhead.element.x(e),i.layers.overlay?.batchDraw()}function xR(i){if(!i.livePlayhead.element)return;const{scrollX:t}=i.viewport,e=i.livePlayhead.position*i.grid.quarterNoteWidth-t;i.livePlayhead.element.x(e),i.layers.overlay?.batchDraw()}function SR(i,t){const e=i.layers.grid;t.on("dblclick",n=>{if(n.target===t||n.target.getLayer()===e){const s=t.getPointerPosition();if(!s)return;const{pitch:r,position:o}=hb(s,i),a=ub(o,i.grid.subdivision),l=Math.round(r);i.command.stack?.executeCommand("Add Note",()=>{const c={id:aR(),pitch:l,position:a,duration:4/i.grid.subdivision,velocity:.8};i.notes.set(c.id,c),i.needsRedraw=!0})}}),t.on("mousedown touchstart",n=>{const s=n.target,r=s.getAttr?.("handleNoteId");if(r){const a=s.getAttr("handleIsEnd");TR(i,t,r,a);return}const o=s.getAttr?.("noteId");if(o){const a=n.evt.shiftKey||n.evt.ctrlKey,l=i.selection.selectedIds.has(o);Fp(i,()=>{a?l?i.selection.selectedIds.delete(o):i.selection.selectedIds.add(o):(!l||i.selection.selectedIds.size>1)&&(i.selection.selectedIds.clear(),i.selection.selectedIds.add(o))}),wR(i,t),i.needsRedraw=!0;return}if(s===t||s.getLayer()===e){const a=t.getPointerPosition();if(!a)return;i.interaction.isMarqueeSelecting=!0,i.interaction.marqueeStart=a,i.interaction.marqueeCurrent=a,i.interaction.marqueeIsShift=n.evt.shiftKey||n.evt.ctrlKey,i.interaction.marqueeIsShift||Fp(i,()=>{i.selection.selectedIds.clear()}),i.needsRedraw=!0}}),t.on("mousemove touchmove",n=>{const s=t.getPointerPosition();if(s){if(i.interaction.isDragging){kR(i,t);return}if(i.interaction.isResizing){PR(i,t);return}if(i.interaction.isMarqueeSelecting){i.interaction.marqueeCurrent=s,vR(i);const r={x:Math.min(i.interaction.marqueeStart.x,s.x),y:Math.min(i.interaction.marqueeStart.y,s.y),width:Math.abs(s.x-i.interaction.marqueeStart.x),height:Math.abs(s.y-i.interaction.marqueeStart.y)},o=lR(i,r);Fp(i,()=>{i.interaction.marqueeIsShift?o.forEach(a=>{i.selection.selectedIds.add(a)}):(i.selection.selectedIds.clear(),o.forEach(a=>{i.selection.selectedIds.add(a)}))}),i.needsRedraw=!0}}}),t.on("mouseup touchend",n=>{if(i.interaction.isDragging){CR(i);return}if(i.interaction.isResizing){AR(i);return}if(i.interaction.isMarqueeSelecting){const s=i.interaction.marqueeStart&&i.interaction.marqueeCurrent&&Math.abs(i.interaction.marqueeStart.x-i.interaction.marqueeCurrent.x)<5&&Math.abs(i.interaction.marqueeStart.y-i.interaction.marqueeCurrent.y)<5;if(i.interaction.isMarqueeSelecting=!1,i.selection.selectionRect&&(i.selection.selectionRect.visible(!1),i.layers.overlay?.batchDraw()),s&&n.target===t||n.target.getLayer()===e){const r=t.getPointerPosition();if(r){const{position:o}=hb(r,i),a=ub(o,i.grid.subdivision);i.queuePlayhead.position=Math.max(0,Math.min(a,i.grid.maxLength)),i.needsRedraw=!0,i.notifyExternalChange?.()}}}})}function wR(i,t){const e=t.getPointerPosition();e&&(i.interaction.isDragging=!0,i.interaction.dragStartPos=e,i.interaction.quantDragActivated=!1,i.interaction.dragBeforeState=_h(i),i.interaction.draggedNoteInitialStates.clear(),i.selection.selectedIds.forEach(n=>{const s=i.notes.get(n);s&&i.interaction.draggedNoteInitialStates.set(n,{position:s.position,pitch:s.pitch})}))}function kR(i,t){const e=t.getPointerPosition();if(!e||!i.interaction.dragStartPos)return;const n=e.x-i.interaction.dragStartPos.x,s=e.y-i.interaction.dragStartPos.y,r=LS(i);let o;Math.abs(n)<r*.9&&!i.interaction.quantDragActivated?o=n:(o=Math.round(n/r)*r,i.interaction.quantDragActivated=!0);const a=Math.round(s/i.grid.noteHeight);i.interaction.draggedNoteInitialStates.forEach((l,c)=>{const h=i.notes.get(c);h&&(h.position=l.position+o/i.grid.quarterNoteWidth,h.pitch=Math.max(0,Math.min(127,l.pitch-a)))}),hR(i),ZS(i),i.needsRedraw=!0}function CR(i){$O(i);const t=_h(i);i.interaction.dragBeforeState&&i.interaction.dragBeforeState!==t&&i.command.stack?.pushCommand("Move Notes",i.interaction.dragBeforeState,t),i.interaction.isDragging=!1,FS(i),i.needsRedraw=!0}function TR(i,t,e,n){const s=t.getPointerPosition();s&&(i.interaction.isResizing=!0,i.interaction.resizeTargetId=e,i.interaction.resizeIsEnd=n,i.interaction.quantResizeActivated=!1,i.interaction.dragStartPos=s,i.interaction.resizeBeforeState=_h(i),i.interaction.resizeInitialStates.clear(),i.selection.selectedIds.forEach(r=>{const o=i.notes.get(r);o&&i.interaction.resizeInitialStates.set(r,{position:o.position,duration:o.duration})}))}function PR(i,t){const e=t.getPointerPosition();if(!e||!i.interaction.dragStartPos)return;const n=e.x-i.interaction.dragStartPos.x,s=LS(i);let r;Math.abs(n)<s*.9&&!i.interaction.quantResizeActivated?r=n:(r=Math.round(n/s)*s,i.interaction.quantResizeActivated=!0);const o=r/i.grid.quarterNoteWidth;i.interaction.resizeInitialStates.forEach((a,l)=>{const c=i.notes.get(l);c&&(i.interaction.resizeIsEnd?c.duration=Math.max(.25,a.duration+o):(c.position=a.position+o,c.duration=Math.max(.25,a.duration-o)))}),ZS(i),i.needsRedraw=!0}function AR(i){$O(i);const t=_h(i);i.interaction.resizeBeforeState&&i.interaction.resizeBeforeState!==t&&i.command.stack?.pushCommand("Resize Notes",i.interaction.resizeBeforeState,t),i.interaction.isResizing=!1,FS(i),i.needsRedraw=!0}const sa=.25,ra=1,_i=128,db=4,pb=12,MR=55,ie=(i,t,e)=>e<t?t:Math.min(Math.max(i,t),e),Ya=(i,t)=>i.stage?.width()??t,Ha=(i,t)=>i.stage?.height()??t,ER=i=>i.grid.maxLength*i.grid.quarterNoteWidth,RR=i=>_i*i.grid.noteHeight,IR=(i,t)=>{i.grid.quarterNoteWidth=t,i.viewport.zoomX=t/i.grid.baseQuarterNoteWidth},QR=(i,t)=>{i.grid.noteHeight=t,i.viewport.zoomY=t/i.grid.baseNoteHeight},NR=(i,t)=>{const e=i.grid.quarterNoteWidth,n=Ya(i,t),s=e===0?0:i.viewport.scrollX/e,r=s+n/(e||1);return{startQuarter:s,endQuarter:r}},$R=(i,t)=>{const e=i.grid.noteHeight,n=Ha(i,t),s=e===0?0:i.viewport.scrollY/e,r=s+n/(e||1);return{topIndex:s,bottomIndex:r}},DO=(i,t,e,n)=>{const s=Ya(i,t),r=Ha(i,e),o=Math.max(0,ER(i)-s),a=ie(i.viewport.scrollX,0,o);a!==i.viewport.scrollX&&(i.viewport.scrollX=a,i.needsRedraw=!0,n());const l=Math.max(0,RR(i)-r),c=ie(i.viewport.scrollY,0,l);c!==i.viewport.scrollY&&(i.viewport.scrollY=c,i.needsRedraw=!0,n())},gm=(i,t,e,n,s,r)=>{if(!Number.isFinite(t)||t<=0)return;IR(i,t);const a=Ya(i,n)/i.grid.quarterNoteWidth,l=Math.max(0,i.grid.maxLength-a),c=ie(e,0,l);i.viewport.scrollX=c*i.grid.quarterNoteWidth,DO(i,n,s,r),i.needsRedraw=!0,r()},mm=(i,t,e,n,s,r)=>{if(!Number.isFinite(t)||t<=0)return;QR(i,t);const a=Ha(i,s)/i.grid.noteHeight,l=Math.max(0,_i-a),c=ie(e,0,l);i.viewport.scrollY=c*i.grid.noteHeight,DO(i,n,s,r),i.needsRedraw=!0,r()},DR=(i,t,e,n,s=!1)=>{const r=Ya(i,t),o=Ha(i,e);if(r<=0||o<=0)return;const a=Array.from(i.notes.values());if(a.length===0){const Z=r/db;gm(i,Z,0,t,e,n);const F=pb,W=o/F,B=127-MR,U=Math.max(0,_i-F),V=ie(B-(F-1),0,U);mm(i,W,V,t,e,n);return}const l=a.reduce((E,Z)=>Math.min(E,Z.position),Number.POSITIVE_INFINITY),c=a.reduce((E,Z)=>Math.max(E,Z.position+Z.duration),Number.NEGATIVE_INFINITY),h=s?c:Math.max(c-l,0),u=Math.max(h,db),f=r/u,d=Math.max(0,i.grid.maxLength-u),p=Math.max(u-h,0),g=s?0:l-p/2,m=ie(g,0,d);gm(i,f,m,t,e,n);const O=a.reduce((E,Z)=>Math.max(E,Z.pitch),Number.NEGATIVE_INFINITY),y=a.reduce((E,Z)=>Math.min(E,Z.pitch),Number.POSITIVE_INFINITY),_=127-O,v=127-y,b=Math.max(v-_+1,1),k=Math.max(b,pb),x=o/k,C=Math.max(k-b,0),I=_-C/2,R=Math.max(0,_i-k),$=ie(I,0,R);mm(i,x,$,t,e,n)};class LR{constructor(t){this.options=t}dragState=null;getThumbMetrics=()=>{const t=this.options.state.grid.maxLength;if(t<=0)return{start:0,size:1};const e=this.options.state.grid.quarterNoteWidth,n=Ya(this.options.state,this.options.getFallbackWidth());if(e<=0||n<=0)return{start:0,size:1};const s=this.options.state.viewport.scrollX/e,r=n/e,o=Math.min(1,r/t);if(o>=1)return{start:0,size:1};const a=s/t;return{start:ie(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:t,size:e}=this.getThumbMetrics(),n=ie(e,0,1),s=Math.min(1,Math.max(n,.01));return{left:`${ie(t,0,1-s)*100}%`,width:`${s*100}%`}};startDrag=(t,e)=>{if(!this.options.isInteractive())return;const n=this.options.horizontalTrack.value;if(!n)return;this.stopDrag();const s=n.getBoundingClientRect();if(s.width<=0)return;const{startQuarter:r,endQuarter:o}=this.options.getViewportRange(),a=Math.max(sa,o-r),l=Ya(this.options.state,this.options.getFallbackWidth()),c=this.options.state.grid.maxLength;if(l<=0||c<=0)return;const h=r/c,u=o/c;let f=0;t==="resize-start"?f=e.clientX-(s.left+h*s.width):t==="resize-end"&&(f=e.clientX-(s.left+u*s.width)),this.dragState={mode:t,pointerId:e.pointerId,pointerStart:e.clientX,trackRect:s,startQuarter:r,endQuarter:o,anchorQuarter:t==="resize-start"?o:r,spanQuarter:a,stageWidth:l,pointerOffset:f},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),e.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=t=>{const e=this.dragState;if(!e||t.pointerId!==e.pointerId)return;const n=this.options.state.grid.maxLength,s=e.trackRect;if(n<=0||s.width<=0||e.stageWidth<=0)return;if(t.preventDefault(),e.mode==="move"){const c=(t.clientX-e.pointerStart)/s.width*n,h=Math.max(0,n-e.spanQuarter),u=ie(e.startQuarter+c,0,h);this.options.state.viewport.scrollX=u*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const r=ie(t.clientX,s.left,s.right),a=(ie(r-e.pointerOffset,s.left,s.right)-s.left)/s.width;if(e.mode==="resize-start"){let l=a*n;const c=e.anchorQuarter-sa;l=ie(l,0,Math.max(0,c));const h=Math.max(sa,e.anchorQuarter-l),u=e.stageWidth/h;this.options.applyHorizontalZoom(u,l),e.startQuarter=l,e.spanQuarter=h;return}if(e.mode==="resize-end"){let l=a*n;const c=e.anchorQuarter+sa;l=ie(l,Math.min(c,n),n);const h=Math.max(sa,l-e.anchorQuarter),u=e.stageWidth/h;this.options.applyHorizontalZoom(u,e.anchorQuarter),e.endQuarter=l,e.spanQuarter=h}};onTrackPointerDown=t=>{if(!this.options.isInteractive())return;const e=this.options.horizontalTrack.value;if(!e)return;const n=e.getBoundingClientRect();if(n.width<=0)return;const s=ie((t.clientX-n.left)/n.width,0,1),{startQuarter:r,endQuarter:o}=this.options.getViewportRange(),a=Math.max(sa,o-r),l=this.options.state.grid.maxLength,c=Math.max(0,l-a),h=ie(s*l-a/2,0,c);this.options.state.viewport.scrollX=h*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}class VR{constructor(t){this.options=t}dragState=null;getThumbMetrics=()=>{const t=_i,e=this.options.state.grid.noteHeight,n=Ha(this.options.state,this.options.getFallbackHeight());if(e<=0||n<=0)return{start:0,size:1};const s=this.options.state.viewport.scrollY/e,r=n/e,o=Math.min(1,r/t);if(o>=1)return{start:0,size:1};const a=s/t;return{start:ie(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:t,size:e}=this.getThumbMetrics(),n=ie(e,0,1),s=Math.min(1,Math.max(n,.01));return{top:`${ie(t,0,1-s)*100}%`,height:`${s*100}%`}};startDrag=(t,e)=>{if(!this.options.isInteractive())return;const n=this.options.verticalTrack.value;if(!n)return;this.stopDrag();const s=n.getBoundingClientRect();if(s.height<=0)return;const{topIndex:r,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(ra,o-r),l=Ha(this.options.state,this.options.getFallbackHeight());if(l<=0)return;const c=r/_i,h=o/_i;let u=0;t==="resize-start"?u=e.clientY-(s.top+c*s.height):t==="resize-end"&&(u=e.clientY-(s.top+h*s.height)),this.dragState={mode:t,pointerId:e.pointerId,pointerStart:e.clientY,trackRect:s,topIndex:r,bottomIndex:o,anchorIndex:t==="resize-start"?o:r,span:a,stageHeight:l,pointerOffset:u},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),e.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=t=>{const e=this.dragState;if(!e||t.pointerId!==e.pointerId)return;const n=e.trackRect;if(n.height<=0||e.stageHeight<=0)return;if(t.preventDefault(),e.mode==="move"){const l=(t.clientY-e.pointerStart)/n.height*_i,c=Math.max(0,_i-e.span),h=ie(e.topIndex+l,0,c);this.options.state.viewport.scrollY=h*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const s=ie(t.clientY,n.top,n.bottom),o=(ie(s-e.pointerOffset,n.top,n.bottom)-n.top)/n.height;if(e.mode==="resize-start"){let a=o*_i;const l=e.anchorIndex-ra;a=ie(a,0,Math.max(0,l));const c=Math.max(ra,e.anchorIndex-a),h=e.stageHeight/c;this.options.applyVerticalZoom(h,a),e.topIndex=a,e.span=c;return}if(e.mode==="resize-end"){let a=o*_i;const l=e.anchorIndex+ra;a=ie(a,Math.min(l,_i),_i);const c=Math.max(ra,a-e.anchorIndex),h=e.stageHeight/c;this.options.applyVerticalZoom(h,e.anchorIndex),e.bottomIndex=a,e.span=c}};onTrackPointerDown=t=>{if(!this.options.isInteractive())return;const e=this.options.verticalTrack.value;if(!e)return;const n=e.getBoundingClientRect();if(n.height<=0)return;const s=ie((t.clientY-n.top)/n.height,0,1),{topIndex:r,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(ra,o-r),l=Math.max(0,_i-a),c=ie(s*_i-a/2,0,l);this.options.state.viewport.scrollY=c*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}const BR=({state:i,canUndo:t,canRedo:e,emitStateUpdate:n})=>{const s=()=>{t.value=i.command.stack?.canUndo()??!1,e.value=i.command.stack?.canRedo()??!1};return{undo:()=>{i.command.stack?.undo(),s()},redo:()=>{i.command.stack?.redo(),s()},deleteSelected:()=>{i.selection.selectedIds.size!==0&&(i.command.stack?.executeCommand("Delete Selected",()=>{i.selection.selectedIds.forEach(c=>i.notes.delete(c)),i.selection.selectedIds.clear(),i.needsRedraw=!0}),s())},updateCommandStackButtons:s,handleCommandStackUpdate:()=>{s(),n()}}},ZR=({state:i,isInteractive:t,undo:e,redo:n,deleteSelected:s,updateCommandStackButtons:r,executeOverlapChanges:o,getContainer:a})=>{let l=!1;const c=f=>{if(t()){if((f.metaKey||f.ctrlKey)&&f.key==="z"&&!f.shiftKey){f.preventDefault(),e();return}if((f.metaKey||f.ctrlKey)&&f.key==="z"&&f.shiftKey){f.preventDefault(),n();return}if(f.key==="Backspace"||f.key==="Delete"){f.preventDefault(),s();return}if(f.key.startsWith("Arrow")&&i.selection.selectedIds.size>0){f.preventDefault(),i.command.stack?.executeCommand("Move Selection",()=>{i.selection.selectedIds.forEach(d=>{const p=i.notes.get(d);if(p)switch(f.key){case"ArrowUp":p.pitch=Math.min(127,p.pitch+1);break;case"ArrowDown":p.pitch=Math.max(0,p.pitch-1);break;case"ArrowLeft":p.position=Math.max(0,p.position-.25);break;case"ArrowRight":p.position+=.25;break}}),o(i,i.selection.selectedIds),i.needsRedraw=!0}),r();return}if((f.metaKey||f.ctrlKey)&&f.key==="c"&&i.selection.selectedIds.size>0){f.preventDefault();const d=Array.from(i.selection.selectedIds).map(g=>{const m=i.notes.get(g);return m?{...m}:null}).filter(g=>g!==null);if(d.length===0)return;const p=Math.min(...d.map(g=>g.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:d.map(g=>({...g,position:g.position-p}))}));return}if((f.metaKey||f.ctrlKey)&&f.key==="v"){f.preventDefault();const d=sessionStorage.getItem("copiedPianoRollNotes");if(!d)return;try{const{notes:p}=JSON.parse(d);i.command.stack?.executeCommand("Paste Notes",()=>{i.selection.selectedIds.clear(),p.forEach(g=>{const m={...g,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:i.queuePlayhead.position+g.position};i.notes.set(m.id,m),i.selection.selectedIds.add(m.id)}),o(i,i.selection.selectedIds),i.needsRedraw=!0}),r()}catch(p){console.error("Failed to paste notes",p)}}}};return{attach:()=>{if(l)return;const f=a();f&&(f.setAttribute("tabindex","0"),f.addEventListener("keydown",c),l=!0)},detach:()=>{if(!l)return;const f=a();f&&f.removeEventListener("keydown",c),l=!1},isAttached:()=>l}};class FR{constructor(t){this.deps=t}eventHandlersInitialized=!1;keyboardAttached=!1;renderFrame=()=>{this.deps.state.needsRedraw&&(this.deps.renderGrid(this.deps.state),this.deps.renderVisibleNotes(this.deps.state),this.deps.renderResizeHandles(this.deps.state),this.deps.updateQueuePlayheadPosition(this.deps.state),this.deps.updateLivePlayheadPosition(this.deps.state),this.deps.state.needsRedraw=!1),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)};startRenderLoop(){this.stopRenderLoop(),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)}stopRenderLoop(){this.deps.state.rafHandle&&(cancelAnimationFrame(this.deps.state.rafHandle),this.deps.state.rafHandle=void 0)}enableInteractivity(){this.deps.state.stage&&(this.eventHandlersInitialized||(this.deps.setupEventHandlers(this.deps.state,this.deps.state.stage),this.eventHandlersInitialized=!0),this.deps.state.stage.listening(!0),this.keyboardAttached||(this.deps.attachKeyboard(),this.keyboardAttached=!0))}disableInteractivity(){this.deps.state.stage&&(this.deps.state.stage.listening(!1),this.deps.state.interaction.isDragging=!1,this.deps.state.interaction.isResizing=!1,this.deps.state.interaction.isMarqueeSelecting=!1,this.deps.state.selection.selectionRect?.visible(!1),this.keyboardAttached&&(this.deps.detachKeyboard(),this.keyboardAttached=!1),this.deps.state.layers.overlay?.batchDraw(),this.deps.syncUiCounters())}mount({width:t,height:e,interactive:n,initialNotes:s}){if(!this.deps.konvaContainer.value){console.error("Konva container ref not found");return}const r=new hi.Stage({container:this.deps.konvaContainer.value,width:t,height:e});this.deps.state.stage=r,this.deps.state.konvaContainer=this.deps.konvaContainer.value,this.deps.initializeLayers(this.deps.state,r,this.deps.handleCommandStackUpdate),n?this.enableInteractivity():this.disableInteractivity(),s.length>0&&(this.deps.state.notes=new Map(s),this.deps.state.needsRedraw=!0,this.deps.syncUiCounters()),this.startRenderLoop(),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds(),this.deps.handleCommandStackUpdate()}unmount(){this.stopRenderLoop(),this.disableInteractivity(),this.deps.state.stage?.destroy(),this.deps.state.stage=void 0,this.deps.state.konvaContainer=void 0,this.eventHandlersInitialized=!1}setInteractive(t){this.deps.state.stage&&(t?this.enableInteractivity():this.disableInteractivity())}resize(t,e){this.deps.state.stage&&(this.deps.state.stage.width(t),this.deps.state.stage.height(e),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds())}}const WR={class:"piano-roll-root"},qR={key:0,class:"control-panel"},XR=["disabled"],zR=["disabled"],GR=["disabled"],jR=["disabled"],UR={class:"info"},YR={class:"piano-roll-layout"},HR={class:"stage-wrapper"},KR=al({__name:"PianoRollRoot",props:{width:{default:640},height:{default:360},initialNotes:{default:()=>[]},syncState:{},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0}},emits:["notes-update"],setup(i,{expose:t,emit:e}){const n=i,s=e,r=oR();r.viewport=Qo(r.viewport),r.grid=Qo(r.grid);const o=ue(),a=ue(),l=ue(),c=ue(!1),h=ue(!1),u=ue(r.grid.subdivision),f=ue(r.notes.size),d=ue(r.selection.selectedIds.size),p=fs(()=>n.interactive),g=fs(()=>n.showControlPanel),m=()=>{f.value=r.notes.size,d.value=r.selection.selectedIds.size},O=()=>{n.syncState?.(r)},y=(Et=!1)=>{DR(r,n.width,n.height,O,Et)},_=()=>{DO(r,n.width,n.height,O)},v=(Et,bt)=>{gm(r,Et,bt,n.width,n.height,O)},b=(Et,bt)=>{mm(r,Et,bt,n.width,n.height,O)},k=()=>NR(r,n.width),x=()=>$R(r,n.height),C=new LR({state:r,horizontalTrack:a,isInteractive:()=>n.interactive,getViewportRange:k,applyHorizontalZoom:v,enforceScrollBounds:_,notifyViewportChange:O,getFallbackWidth:()=>n.width}),I=new VR({state:r,verticalTrack:l,isInteractive:()=>n.interactive,getViewportRange:x,applyVerticalZoom:b,enforceScrollBounds:_,notifyViewportChange:O,getFallbackHeight:()=>n.height}),R=fs(()=>C.getThumbStyle()),$=fs(()=>I.getThumbStyle()),E=(Et,bt)=>{C.startDrag(Et,bt)},Z=()=>{C.stopDrag()},F=(Et,bt)=>{I.startDrag(Et,bt)},W=()=>{I.stopDrag()},B=Et=>{C.onTrackPointerDown(Et)},U=Et=>{I.onTrackPointerDown(Et)};ti(u,Et=>{r.grid.subdivision=Et,r.needsRedraw=!0,n.syncState?.(r)});const V=()=>{m(),s("notes-update",Array.from(r.notes.entries())),n.syncState?.(r)};r.notifyExternalChange=()=>{V()};const{undo:X,redo:j,deleteSelected:tt,updateCommandStackButtons:it,handleCommandStackUpdate:_t}=BR({state:r,canUndo:c,canRedo:h,emitStateUpdate:V}),Nt=ZR({state:r,isInteractive:()=>n.interactive,undo:X,redo:j,deleteSelected:tt,updateCommandStackButtons:it,executeOverlapChanges:$O,getContainer:()=>o.value||null}),Ot=new FR({state:r,konvaContainer:o,initializeLayers:mR,setupEventHandlers:SR,renderGrid:OR,renderVisibleNotes:yR,renderResizeHandles:bR,updateQueuePlayheadPosition:_R,updateLivePlayheadPosition:xR,handleCommandStackUpdate:_t,syncUiCounters:m,enforceScrollBounds:_,attachKeyboard:()=>Nt.attach(),detachKeyboard:()=>Nt.detach()});return Ad(()=>{Ot.mount({width:n.width,height:n.height,interactive:n.interactive,initialNotes:n.initialNotes??[]})}),F0(()=>{Z(),W(),Ot.unmount()}),ti(()=>n.interactive,Et=>{Ot.setInteractive(Et),Et||(Z(),W())}),ti(()=>n.width,Et=>{Ot.resize(Et,n.height)}),ti(()=>n.height,Et=>{Ot.resize(n.width,Et)}),t({setNotes:Et=>{r.command.stack?.executeCommand("Set Notes",()=>{const bt=new Set;r.notes.clear(),Et.forEach((Wt,M)=>{let Q=Wt.id||`note_${Date.now()}_${M}`;for(;bt.has(Q);)Q=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;bt.add(Q);const G={...Wt,id:Q,velocity:Wt.velocity??100};r.notes.set(Q,G)}),r.needsRedraw=!0}),it(),V()},setLivePlayheadPosition:Et=>{r.livePlayhead.position=Math.max(0,Math.min(Et,r.grid.maxLength)),r.needsRedraw=!0},getPlayStartPosition:()=>r.queuePlayhead.position,fitZoomToNotes:y}),(Et,bt)=>(It(),$t("div",WR,[g.value?(It(),$t("div",qR,[Y("button",{class:"btn btn-ghost",onClick:bt[0]||(bt[0]=(...Wt)=>Re(X)&&Re(X)(...Wt)),disabled:!p.value||!c.value},"↶ Undo",8,XR),Y("button",{class:"btn btn-ghost",onClick:bt[1]||(bt[1]=(...Wt)=>Re(j)&&Re(j)(...Wt)),disabled:!p.value||!h.value},"↷ Redo",8,zR),bt[12]||(bt[12]=Y("span",{class:"separator"},"|",-1)),Y("label",null,[bt[11]||(bt[11]=Fi(" Grid: ",-1)),Rc(Y("select",{"onUpdate:modelValue":bt[2]||(bt[2]=Wt=>u.value=Wt),disabled:!p.value},[...bt[10]||(bt[10]=[Y("option",{value:4},"Quarter",-1),Y("option",{value:8},"Eighth",-1),Y("option",{value:16},"16th",-1),Y("option",{value:32},"32nd",-1)])],8,GR),[[z0,u.value,void 0,{number:!0}]])]),bt[13]||(bt[13]=Y("span",{class:"separator"},"|",-1)),Y("button",{class:"btn btn-ghost",onClick:bt[3]||(bt[3]=(...Wt)=>Re(tt)&&Re(tt)(...Wt)),disabled:!p.value||d.value===0}," 🗑️ Delete ",8,jR),bt[14]||(bt[14]=Y("span",{class:"separator"},"|",-1)),Y("span",UR,Pe(f.value)+" notes, "+Pe(d.value)+" selected",1)])):oi("",!0),Y("div",YR,[Y("div",HR,[Y("div",{ref_key:"konvaContainer",ref:o,class:Ln(["piano-roll-container",{"is-disabled":!p.value}]),style:wr({width:n.width+"px",height:n.height+"px"})},null,6),Y("div",{ref_key:"horizontalTrack",ref:a,class:Ln(["scrollbar horizontal",{"is-disabled":!p.value}]),style:wr({width:n.width+"px"}),onPointerdown:os(B,["self"])},[Y("div",{class:"scrollbar-thumb horizontal-thumb",style:wr(R.value)},[Y("div",{class:"scrollbar-handle handle-left",onPointerdown:bt[4]||(bt[4]=os(Wt=>E("resize-start",Wt),["stop","prevent"]))},null,32),Y("div",{class:"scrollbar-body",onPointerdown:bt[5]||(bt[5]=os(Wt=>E("move",Wt),["stop","prevent"]))},null,32),Y("div",{class:"scrollbar-handle handle-right",onPointerdown:bt[6]||(bt[6]=os(Wt=>E("resize-end",Wt),["stop","prevent"]))},null,32)],4)],38)]),Y("div",{ref_key:"verticalTrack",ref:l,class:Ln(["scrollbar vertical",{"is-disabled":!p.value}]),style:wr({height:n.height+"px"}),onPointerdown:os(U,["self"])},[Y("div",{class:"scrollbar-thumb vertical-thumb",style:wr($.value)},[Y("div",{class:"scrollbar-handle handle-top",onPointerdown:bt[7]||(bt[7]=os(Wt=>F("resize-start",Wt),["stop","prevent"]))},null,32),Y("div",{class:"scrollbar-body vertical-body",onPointerdown:bt[8]||(bt[8]=os(Wt=>F("move",Wt),["stop","prevent"]))},null,32),Y("div",{class:"scrollbar-handle handle-bottom",onPointerdown:bt[9]||(bt[9]=os(Wt=>F("resize-end",Wt),["stop","prevent"]))},null,32)],4)],38)])]))}}),xh=(i,t)=>{const e=i.__vccOpts||i;for(const[n,s]of t)e[n]=s;return e},JR=xh(KR,[["__scopeId","data-v-78662f76"]]);function mt(i,t,e,n,s){if(typeof t=="function"?i!==t||!0:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(i,e),e}function z(i,t,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!n:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(i):n?n.value:t.get(i)}let WS=function(){const{crypto:i}=globalThis;if(i?.randomUUID)return WS=i.randomUUID.bind(i),i.randomUUID();const t=new Uint8Array(1),e=i?()=>i.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^e()&15>>+n/4).toString(16))};function Vc(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const Om=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const t=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(t.stack=i.stack),i.cause&&!t.cause&&(t.cause=i.cause),i.name&&(t.name=i.name),t}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};class At extends Error{}class Oi extends At{constructor(t,e,n,s){super(`${Oi.makeMessage(t,e,n)}`),this.status=t,this.headers=s,this.requestID=s?.get("request-id"),this.error=e}static makeMessage(t,e,n){const s=e?.message?typeof e.message=="string"?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n;return t&&s?`${t} ${s}`:t?`${t} status code (no body)`:s||"(no status code or body)"}static generate(t,e,n,s){if(!t||!s)return new ip({message:n,cause:Om(e)});const r=e;return t===400?new XS(t,r,n,s):t===401?new zS(t,r,n,s):t===403?new GS(t,r,n,s):t===404?new jS(t,r,n,s):t===409?new US(t,r,n,s):t===422?new YS(t,r,n,s):t===429?new HS(t,r,n,s):t>=500?new KS(t,r,n,s):new Oi(t,r,n,s)}}class $n extends Oi{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class ip extends Oi{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),e&&(this.cause=e)}}class qS extends ip{constructor({message:t}={}){super({message:t??"Request timed out."})}}class XS extends Oi{}class zS extends Oi{}class GS extends Oi{}class jS extends Oi{}class US extends Oi{}class YS extends Oi{}class HS extends Oi{}class KS extends Oi{}const tI=/^[a-z][a-z0-9+.-]*:/i,eI=i=>tI.test(i);let ym=i=>(ym=Array.isArray,ym(i)),gb=ym;function mb(i){return typeof i!="object"?{}:i??{}}function iI(i){if(!i)return!0;for(const t in i)return!1;return!0}function nI(i,t){return Object.prototype.hasOwnProperty.call(i,t)}const sI=(i,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new At(`${i} must be an integer`);if(t<0)throw new At(`${i} must be a positive integer`);return t},JS=i=>{try{return JSON.parse(i)}catch{return}},rI=i=>new Promise(t=>setTimeout(t,i)),ua="0.65.0",oI=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function aI(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const lI=()=>{const i=aI();if(i==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ua,"X-Stainless-OS":yb(Deno.build.os),"X-Stainless-Arch":Ob(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ua,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(i==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ua,"X-Stainless-OS":yb(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Ob(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=cI();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ua,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ua,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function cI(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:e}of i){const n=e.exec(navigator.userAgent);if(n){const s=n[1]||0,r=n[2]||0,o=n[3]||0;return{browser:t,version:`${s}.${r}.${o}`}}}return null}const Ob=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",yb=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let bb;const hI=()=>bb??(bb=lI());function uI(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function tw(...i){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...i)}function ew(i){let t=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return tw({start(){},async pull(e){const{done:n,value:s}=await t.next();n?e.close():e.enqueue(s)},async cancel(){await t.return?.()}})}function LO(i){if(i[Symbol.asyncIterator])return i;const t=i.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function fI(i){if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await i[Symbol.asyncIterator]().return?.();return}const t=i.getReader(),e=t.cancel();t.releaseLock(),await e}const dI=({headers:i,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});function pI(i){let t=0;for(const s of i)t+=s.length;const e=new Uint8Array(t);let n=0;for(const s of i)e.set(s,n),n+=s.length;return e}let vb;function VO(i){let t;return(vb??(t=new globalThis.TextEncoder,vb=t.encode.bind(t)))(i)}let _b;function xb(i){let t;return(_b??(t=new globalThis.TextDecoder,_b=t.decode.bind(t)))(i)}var en,nn;class Sh{constructor(){en.set(this,void 0),nn.set(this,void 0),mt(this,en,new Uint8Array),mt(this,nn,null)}decode(t){if(t==null)return[];const e=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?VO(t):t;mt(this,en,pI([z(this,en,"f"),e]));const n=[];let s;for(;(s=gI(z(this,en,"f"),z(this,nn,"f")))!=null;){if(s.carriage&&z(this,nn,"f")==null){mt(this,nn,s.index);continue}if(z(this,nn,"f")!=null&&(s.index!==z(this,nn,"f")+1||s.carriage)){n.push(xb(z(this,en,"f").subarray(0,z(this,nn,"f")-1))),mt(this,en,z(this,en,"f").subarray(z(this,nn,"f"))),mt(this,nn,null);continue}const r=z(this,nn,"f")!==null?s.preceding-1:s.preceding,o=xb(z(this,en,"f").subarray(0,r));n.push(o),mt(this,en,z(this,en,"f").subarray(s.index)),mt(this,nn,null)}return n}flush(){return z(this,en,"f").length?this.decode(`
`):[]}}en=new WeakMap,nn=new WeakMap;Sh.NEWLINE_CHARS=new Set([`
`,"\r"]);Sh.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function gI(i,t){for(let s=t??0;s<i.length;s++){if(i[s]===10)return{preceding:s,index:s+1,carriage:!1};if(i[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function mI(i){for(let n=0;n<i.length-1;n++){if(i[n]===10&&i[n+1]===10||i[n]===13&&i[n+1]===13)return n+2;if(i[n]===13&&i[n+1]===10&&n+3<i.length&&i[n+2]===13&&i[n+3]===10)return n+4}return-1}const Ff={off:0,error:200,warn:300,info:400,debug:500},Sb=(i,t,e)=>{if(i){if(nI(Ff,i))return i;xi(e).warn(`${t} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(Ff))}`)}};function ic(){}function lu(i,t,e){return!t||Ff[i]>Ff[e]?ic:t[i].bind(t)}const OI={error:ic,warn:ic,info:ic,debug:ic};let wb=new WeakMap;function xi(i){const t=i.logger,e=i.logLevel??"off";if(!t)return OI;const n=wb.get(t);if(n&&n[0]===e)return n[1];const s={error:lu("error",t,e),warn:lu("warn",t,e),info:lu("info",t,e),debug:lu("debug",t,e)};return wb.set(t,[e,s]),s}const fo=i=>(i.options&&(i.options={...i.options},delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([t,e])=>[t,t.toLowerCase()==="x-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":e]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);var Ml;class ds{constructor(t,e,n){this.iterator=t,Ml.set(this,void 0),this.controller=e,mt(this,Ml,n)}static fromSSEResponse(t,e,n){let s=!1;const r=n?xi(n):console;async function*o(){if(s)throw new At("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const l of yI(t,e)){if(l.event==="completion")try{yield JSON.parse(l.data)}catch(c){throw r.error("Could not parse message into JSON:",l.data),r.error("From chunk:",l.raw),c}if(l.event==="message_start"||l.event==="message_delta"||l.event==="message_stop"||l.event==="content_block_start"||l.event==="content_block_delta"||l.event==="content_block_stop")try{yield JSON.parse(l.data)}catch(c){throw r.error("Could not parse message into JSON:",l.data),r.error("From chunk:",l.raw),c}if(l.event!=="ping"&&l.event==="error")throw new Oi(void 0,JS(l.data)??l.data,void 0,t.headers)}a=!0}catch(l){if(Vc(l))return;throw l}finally{a||e.abort()}}return new ds(o,e,n)}static fromReadableStream(t,e,n){let s=!1;async function*r(){const a=new Sh,l=LO(t);for await(const c of l)for(const h of a.decode(c))yield h;for(const c of a.flush())yield c}async function*o(){if(s)throw new At("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let a=!1;try{for await(const l of r())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(Vc(l))return;throw l}finally{a||e.abort()}}return new ds(o,e,n)}[(Ml=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],e=[],n=this.iterator(),s=r=>({next:()=>{if(r.length===0){const o=n.next();t.push(o),e.push(o)}return r.shift()}});return[new ds(()=>s(t),this.controller,z(this,Ml,"f")),new ds(()=>s(e),this.controller,z(this,Ml,"f"))]}toReadableStream(){const t=this;let e;return tw({async start(){e=t[Symbol.asyncIterator]()},async pull(n){try{const{value:s,done:r}=await e.next();if(r)return n.close();const o=VO(JSON.stringify(s)+`
`);n.enqueue(o)}catch(s){n.error(s)}},async cancel(){await e.return?.()}})}}async function*yI(i,t){if(!i.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new At("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new At("Attempted to iterate over a response with no body");const e=new vI,n=new Sh,s=LO(i.body);for await(const r of bI(s))for(const o of n.decode(r)){const a=e.decode(o);a&&(yield a)}for(const r of n.flush()){const o=e.decode(r);o&&(yield o)}}async function*bI(i){let t=new Uint8Array;for await(const e of i){if(e==null)continue;const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?VO(e):e;let s=new Uint8Array(t.length+n.length);s.set(t),s.set(n,t.length),t=s;let r;for(;(r=mI(t))!==-1;)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}class vI{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,n,s]=_I(t,":");return s.startsWith(" ")&&(s=s.substring(1)),e==="event"?this.event=s:e==="data"&&this.data.push(s),null}}function _I(i,t){const e=i.indexOf(t);return e!==-1?[i.substring(0,e),t,i.substring(e+t.length)]:[i,"",""]}async function iw(i,t){const{response:e,requestLogID:n,retryOfRequestLogID:s,startTime:r}=t,o=await(async()=>{if(t.options.stream)return xi(i).debug("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):ds.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const l=e.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){const u=await e.json();return nw(u,e)}return await e.text()})();return xi(i).debug(`[${n}] response parsed`,fo({retryOfRequestLogID:s,url:e.url,status:e.status,body:o,durationMs:Date.now()-r})),o}function nw(i,t){return!i||typeof i!="object"||Array.isArray(i)?i:Object.defineProperty(i,"_request_id",{value:t.headers.get("request-id"),enumerable:!1})}var nc;class np extends Promise{constructor(t,e,n=iw){super(s=>{s(null)}),this.responsePromise=e,this.parseResponse=n,nc.set(this,void 0),mt(this,nc,t)}_thenUnwrap(t){return new np(z(this,nc,"f"),this.responsePromise,async(e,n)=>nw(t(await this.parseResponse(e,n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e,request_id:e.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(z(this,nc,"f"),t))),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}nc=new WeakMap;var cu;class xI{constructor(t,e,n,s){cu.set(this,void 0),mt(this,cu,t),this.options=s,this.response=e,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new At("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await z(this,cu,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(cu=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class SI extends np{constructor(t,e,n){super(t,e,async(s,r)=>new n(s,r.response,await iw(s,r),r.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const e of t)yield e}}class wh extends xI{constructor(t,e,n,s){super(t,e,n,s),this.data=n.data||[],this.has_more=n.has_more||!1,this.first_id=n.first_id||null,this.last_id=n.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){const e=this.first_id;return e?{...this.options,query:{...mb(this.options.query),before_id:e}}:null}const t=this.last_id;return t?{...this.options,query:{...mb(this.options.query),after_id:t}}:null}}const sw=()=>{if(typeof File>"u"){const{process:i}=globalThis,t=typeof i?.versions?.node=="string"&&parseInt(i.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ma(i,t,e){return sw(),new File(i,t??"unknown_file",e)}function sf(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const rw=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function",wI=async(i,t)=>({...i,body:await CI(i.body,t)}),kb=new WeakMap;function kI(i){const t=typeof i=="function"?i:i.fetch,e=kb.get(t);if(e)return e;const n=(async()=>{try{const s="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;return r.toString()!==await new s(r).text()}catch{return!0}})();return kb.set(t,n),n}const CI=async(i,t)=>{if(!await kI(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const e=new FormData;return await Promise.all(Object.entries(i||{}).map(([n,s])=>bm(e,n,s))),e},TI=i=>i instanceof Blob&&"name"in i,bm=async(i,t,e)=>{if(e!==void 0){if(e==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof e=="string"||typeof e=="number"||typeof e=="boolean")i.append(t,String(e));else if(e instanceof Response){let n={};const s=e.headers.get("Content-Type");s&&(n={type:s}),i.append(t,Ma([await e.blob()],sf(e),n))}else if(rw(e))i.append(t,Ma([await new Response(ew(e)).blob()],sf(e)));else if(TI(e))i.append(t,Ma([e],sf(e),{type:e.type}));else if(Array.isArray(e))await Promise.all(e.map(n=>bm(i,t+"[]",n)));else if(typeof e=="object")await Promise.all(Object.entries(e).map(([n,s])=>bm(i,`${t}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${e} instead`)}},ow=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",PI=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&ow(i),AI=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function MI(i,t,e){if(sw(),i=await i,t||(t=sf(i)),PI(i))return i instanceof File&&t==null&&e==null?i:Ma([await i.arrayBuffer()],t??i.name,{type:i.type,lastModified:i.lastModified,...e});if(AI(i)){const s=await i.blob();return t||(t=new URL(i.url).pathname.split(/[\\/]/).pop()),Ma(await vm(s),t,e)}const n=await vm(i);if(!e?.type){const s=n.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof s=="string"&&(e={...e,type:s})}return Ma(n,t,e)}async function vm(i){let t=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)t.push(i);else if(ow(i))t.push(i instanceof Blob?i:await i.arrayBuffer());else if(rw(i))for await(const e of i)t.push(...await vm(e));else{const e=i?.constructor?.name;throw new Error(`Unexpected data type: ${typeof i}${e?`; constructor: ${e}`:""}${EI(i)}`)}return t}function EI(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(e=>`"${e}"`).join(", ")}]`}class cr{constructor(t){this._client=t}}const aw=Symbol.for("brand.privateNullableHeaders");function*RI(i){if(!i)return;if(aw in i){const{values:n,nulls:s}=i;yield*n.entries();for(const r of s)yield[r,null];return}let t=!1,e;i instanceof Headers?e=i.entries():gb(i)?e=i:(t=!0,e=Object.entries(i??{}));for(let n of e){const s=n[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const r=gb(n[1])?n[1]:[n[1]];let o=!1;for(const a of r)a!==void 0&&(t&&!o&&(o=!0,yield[s,null]),yield[s,a])}}const pe=i=>{const t=new Headers,e=new Set;for(const n of i){const s=new Set;for(const[r,o]of RI(n)){const a=r.toLowerCase();s.has(a)||(t.delete(r),s.add(a)),o===null?(t.delete(r),e.add(a)):(t.append(r,o),e.delete(a))}}return{[aw]:!0,values:t,nulls:e}};function lw(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Cb=Object.freeze(Object.create(null)),II=(i=lw)=>function(e,...n){if(e.length===1)return e[0];let s=!1;const r=[],o=e.reduce((h,u,f)=>{/[?#]/.test(u)&&(s=!0);const d=n[f];let p=(s?encodeURIComponent:i)(""+d);return f!==n.length&&(d==null||typeof d=="object"&&d.toString===Object.getPrototypeOf(Object.getPrototypeOf(d.hasOwnProperty??Cb)??Cb)?.toString)&&(p=d+"",r.push({start:h.length+u.length,length:p.length,error:`Value of type ${Object.prototype.toString.call(d).slice(8,-1)} is not a valid path parameter`})),h+u+(f===n.length?"":p)},""),a=o.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)r.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(r.sort((h,u)=>h.start-u.start),r.length>0){let h=0;const u=r.reduce((f,d)=>{const p=" ".repeat(d.start-h),g="^".repeat(d.length);return h=d.start+d.length,f+p+g},"");throw new At(`Path parameters result in path with invalid segments:
${r.map(f=>f.error).join(`
`)}
${o}
${u}`)}return o},Bn=II(lw);class cw extends cr{list(t={},e){const{betas:n,...s}=t??{};return this._client.getAPIList("/v1/files",wh,{query:s,...e,headers:pe([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString()},e?.headers])})}delete(t,e={},n){const{betas:s}=e??{};return this._client.delete(Bn`/v1/files/${t}`,{...n,headers:pe([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},n?.headers])})}download(t,e={},n){const{betas:s}=e??{};return this._client.get(Bn`/v1/files/${t}/content`,{...n,headers:pe([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}retrieveMetadata(t,e={},n){const{betas:s}=e??{};return this._client.get(Bn`/v1/files/${t}`,{...n,headers:pe([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},n?.headers])})}upload(t,e){const{betas:n,...s}=t;return this._client.post("/v1/files",wI({body:s,...e,headers:pe([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString()},e?.headers])},this._client))}}let hw=class extends cr{retrieve(t,e={},n){const{betas:s}=e??{};return this._client.get(Bn`/v1/models/${t}?beta=true`,{...n,headers:pe([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},n?.headers])})}list(t={},e){const{betas:n,...s}=t??{};return this._client.getAPIList("/v1/models?beta=true",wh,{query:s,...e,headers:pe([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},e?.headers])})}};class sp{constructor(t,e){this.iterator=t,this.controller=e}async*decoder(){const t=new Sh;for await(const e of this.iterator)for(const n of t.decode(e))yield JSON.parse(n);for(const e of t.flush())yield JSON.parse(e)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new At("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new At("Attempted to iterate over a response with no body");return new sp(LO(t.body),e)}}let uw=class extends cr{create(t,e){const{betas:n,...s}=t;return this._client.post("/v1/messages/batches?beta=true",{body:s,...e,headers:pe([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},e?.headers])})}retrieve(t,e={},n){const{betas:s}=e??{};return this._client.get(Bn`/v1/messages/batches/${t}?beta=true`,{...n,headers:pe([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},n?.headers])})}list(t={},e){const{betas:n,...s}=t??{};return this._client.getAPIList("/v1/messages/batches?beta=true",wh,{query:s,...e,headers:pe([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},e?.headers])})}delete(t,e={},n){const{betas:s}=e??{};return this._client.delete(Bn`/v1/messages/batches/${t}?beta=true`,{...n,headers:pe([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},n?.headers])})}cancel(t,e={},n){const{betas:s}=e??{};return this._client.post(Bn`/v1/messages/batches/${t}/cancel?beta=true`,{...n,headers:pe([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},n?.headers])})}async results(t,e={},n){const s=await this.retrieve(t);if(!s.results_url)throw new At(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);const{betas:r}=e??{};return this._client.get(s.results_url,{...n,headers:pe([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},n?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((o,a)=>sp.fromResponse(a.response,a.controller))}};const QI=i=>{let t=0,e=[];for(;t<i.length;){let n=i[t];if(n==="\\"){t++;continue}if(n==="{"){e.push({type:"brace",value:"{"}),t++;continue}if(n==="}"){e.push({type:"brace",value:"}"}),t++;continue}if(n==="["){e.push({type:"paren",value:"["}),t++;continue}if(n==="]"){e.push({type:"paren",value:"]"}),t++;continue}if(n===":"){e.push({type:"separator",value:":"}),t++;continue}if(n===","){e.push({type:"delimiter",value:","}),t++;continue}if(n==='"'){let a="",l=!1;for(n=i[++t];n!=='"';){if(t===i.length){l=!0;break}if(n==="\\"){if(t++,t===i.length){l=!0;break}a+=n+i[t],n=i[++t]}else a+=n,n=i[++t]}n=i[++t],l||e.push({type:"string",value:a});continue}if(n&&/\s/.test(n)){t++;continue}let r=/[0-9]/;if(n&&r.test(n)||n==="-"||n==="."){let a="";for(n==="-"&&(a+=n,n=i[++t]);n&&r.test(n)||n===".";)a+=n,n=i[++t];e.push({type:"number",value:a});continue}let o=/[a-z]/i;if(n&&o.test(n)){let a="";for(;n&&o.test(n)&&t!==i.length;)a+=n,n=i[++t];if(a=="true"||a=="false"||a==="null")e.push({type:"name",value:a});else{t++;continue}continue}t++}return e},fa=i=>{if(i.length===0)return i;let t=i[i.length-1];switch(t.type){case"separator":return i=i.slice(0,i.length-1),fa(i);case"number":let e=t.value[t.value.length-1];if(e==="."||e==="-")return i=i.slice(0,i.length-1),fa(i);case"string":let n=i[i.length-2];if(n?.type==="delimiter")return i=i.slice(0,i.length-1),fa(i);if(n?.type==="brace"&&n.value==="{")return i=i.slice(0,i.length-1),fa(i);break;case"delimiter":return i=i.slice(0,i.length-1),fa(i)}return i},NI=i=>{let t=[];return i.map(e=>{e.type==="brace"&&(e.value==="{"?t.push("}"):t.splice(t.lastIndexOf("}"),1)),e.type==="paren"&&(e.value==="["?t.push("]"):t.splice(t.lastIndexOf("]"),1))}),t.length>0&&t.reverse().map(e=>{e==="}"?i.push({type:"brace",value:"}"}):e==="]"&&i.push({type:"paren",value:"]"})}),i},$I=i=>{let t="";return i.map(e=>{switch(e.type){case"string":t+='"'+e.value+'"';break;default:t+=e.value;break}}),t},fw=i=>JSON.parse($I(NI(fa(QI(i)))));var dn,pr,El,hu,Rl,Il,uu,Ql,Ns,Nl,fu,du,oa,pu,gu,Wp,Tb,mu,qp,Xp,zp,Pb;const Ab="__json_buf";function Mb(i){return i.type==="tool_use"||i.type==="server_tool_use"||i.type==="mcp_tool_use"}class Wf{constructor(){dn.add(this),this.messages=[],this.receivedMessages=[],pr.set(this,void 0),this.controller=new AbortController,El.set(this,void 0),hu.set(this,()=>{}),Rl.set(this,()=>{}),Il.set(this,void 0),uu.set(this,()=>{}),Ql.set(this,()=>{}),Ns.set(this,{}),Nl.set(this,!1),fu.set(this,!1),du.set(this,!1),oa.set(this,!1),pu.set(this,void 0),gu.set(this,void 0),mu.set(this,t=>{if(mt(this,fu,!0),Vc(t)&&(t=new $n),t instanceof $n)return mt(this,du,!0),this._emit("abort",t);if(t instanceof At)return this._emit("error",t);if(t instanceof Error){const e=new At(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new At(String(t)))}),mt(this,El,new Promise((t,e)=>{mt(this,hu,t,"f"),mt(this,Rl,e,"f")})),mt(this,Il,new Promise((t,e)=>{mt(this,uu,t,"f"),mt(this,Ql,e,"f")})),z(this,El,"f").catch(()=>{}),z(this,Il,"f").catch(()=>{})}get response(){return z(this,pu,"f")}get request_id(){return z(this,gu,"f")}async withResponse(){const t=await z(this,El,"f");if(!t)throw new Error("Could not resolve a `Response` object");return{data:this,response:t,request_id:t.headers.get("request-id")}}static fromReadableStream(t){const e=new Wf;return e._run(()=>e._fromReadableStream(t)),e}static createMessage(t,e,n){const s=new Wf;for(const r of e.messages)s._addMessageParam(r);return s._run(()=>s._createMessage(t,{...e,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(t){t().then(()=>{this._emitFinal(),this._emit("end")},z(this,mu,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,e=!0){this.receivedMessages.push(t),e&&this._emit("message",t)}async _createMessage(t,e,n){const s=n?.signal;let r;s&&(s.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),s.addEventListener("abort",r));try{z(this,dn,"m",qp).call(this);const{response:o,data:a}=await t.create({...e,stream:!0},{...n,signal:this.controller.signal}).withResponse();this._connected(o);for await(const l of a)z(this,dn,"m",Xp).call(this,l);if(a.controller.signal?.aborted)throw new $n;z(this,dn,"m",zp).call(this)}finally{s&&r&&s.removeEventListener("abort",r)}}_connected(t){this.ended||(mt(this,pu,t),mt(this,gu,t?.headers.get("request-id")),z(this,hu,"f").call(this,t),this._emit("connect"))}get ended(){return z(this,Nl,"f")}get errored(){return z(this,fu,"f")}get aborted(){return z(this,du,"f")}abort(){this.controller.abort()}on(t,e){return(z(this,Ns,"f")[t]||(z(this,Ns,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=z(this,Ns,"f")[t];if(!n)return this;const s=n.findIndex(r=>r.listener===e);return s>=0&&n.splice(s,1),this}once(t,e){return(z(this,Ns,"f")[t]||(z(this,Ns,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise((e,n)=>{mt(this,oa,!0),t!=="error"&&this.once("error",n),this.once(t,e)})}async done(){mt(this,oa,!0),await z(this,Il,"f")}get currentMessage(){return z(this,pr,"f")}async finalMessage(){return await this.done(),z(this,dn,"m",Wp).call(this)}async finalText(){return await this.done(),z(this,dn,"m",Tb).call(this)}_emit(t,...e){if(z(this,Nl,"f"))return;t==="end"&&(mt(this,Nl,!0),z(this,uu,"f").call(this));const n=z(this,Ns,"f")[t];if(n&&(z(this,Ns,"f")[t]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...e))),t==="abort"){const s=e[0];!z(this,oa,"f")&&!n?.length&&Promise.reject(s),z(this,Rl,"f").call(this,s),z(this,Ql,"f").call(this,s),this._emit("end");return}if(t==="error"){const s=e[0];!z(this,oa,"f")&&!n?.length&&Promise.reject(s),z(this,Rl,"f").call(this,s),z(this,Ql,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",z(this,dn,"m",Wp).call(this))}async _fromReadableStream(t,e){const n=e?.signal;let s;n&&(n.aborted&&this.controller.abort(),s=this.controller.abort.bind(this.controller),n.addEventListener("abort",s));try{z(this,dn,"m",qp).call(this),this._connected(null);const r=ds.fromReadableStream(t,this.controller);for await(const o of r)z(this,dn,"m",Xp).call(this,o);if(r.controller.signal?.aborted)throw new $n;z(this,dn,"m",zp).call(this)}finally{n&&s&&n.removeEventListener("abort",s)}}[(pr=new WeakMap,El=new WeakMap,hu=new WeakMap,Rl=new WeakMap,Il=new WeakMap,uu=new WeakMap,Ql=new WeakMap,Ns=new WeakMap,Nl=new WeakMap,fu=new WeakMap,du=new WeakMap,oa=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap,dn=new WeakSet,Wp=function(){if(this.receivedMessages.length===0)throw new At("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Tb=function(){if(this.receivedMessages.length===0)throw new At("stream ended without producing a Message with role=assistant");const e=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(e.length===0)throw new At("stream ended without producing a content block with type=text");return e.join(" ")},qp=function(){this.ended||mt(this,pr,void 0)},Xp=function(e){if(this.ended)return;const n=z(this,dn,"m",Pb).call(this,e);switch(this._emit("streamEvent",e,n),e.type){case"content_block_delta":{const s=n.content.at(-1);switch(e.delta.type){case"text_delta":{s.type==="text"&&this._emit("text",e.delta.text,s.text||"");break}case"citations_delta":{s.type==="text"&&this._emit("citation",e.delta.citation,s.citations??[]);break}case"input_json_delta":{Mb(s)&&s.input&&this._emit("inputJson",e.delta.partial_json,s.input);break}case"thinking_delta":{s.type==="thinking"&&this._emit("thinking",e.delta.thinking,s.thinking);break}case"signature_delta":{s.type==="thinking"&&this._emit("signature",s.signature);break}default:e.delta}break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{mt(this,pr,n);break}}},zp=function(){if(this.ended)throw new At("stream has ended, this shouldn't happen");const e=z(this,pr,"f");if(!e)throw new At("request ended without sending any chunks");return mt(this,pr,void 0),e},Pb=function(e){let n=z(this,pr,"f");if(e.type==="message_start"){if(n)throw new At(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!n)throw new At(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":return n;case"message_delta":return n.container=e.delta.container,n.stop_reason=e.delta.stop_reason,n.stop_sequence=e.delta.stop_sequence,n.usage.output_tokens=e.usage.output_tokens,n.context_management=e.context_management,e.usage.input_tokens!=null&&(n.usage.input_tokens=e.usage.input_tokens),e.usage.cache_creation_input_tokens!=null&&(n.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),e.usage.cache_read_input_tokens!=null&&(n.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),e.usage.server_tool_use!=null&&(n.usage.server_tool_use=e.usage.server_tool_use),n;case"content_block_start":return n.content.push(e.content_block),n;case"content_block_delta":{const s=n.content.at(e.index);switch(e.delta.type){case"text_delta":{s?.type==="text"&&(n.content[e.index]={...s,text:(s.text||"")+e.delta.text});break}case"citations_delta":{s?.type==="text"&&(n.content[e.index]={...s,citations:[...s.citations??[],e.delta.citation]});break}case"input_json_delta":{if(s&&Mb(s)){let r=s[Ab]||"";r+=e.delta.partial_json;const o={...s};if(Object.defineProperty(o,Ab,{value:r,enumerable:!1,writable:!0}),r)try{o.input=fw(r)}catch(a){const l=new At(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${a}. JSON: ${r}`);z(this,mu,"f").call(this,l)}n.content[e.index]=o}break}case"thinking_delta":{s?.type==="thinking"&&(n.content[e.index]={...s,thinking:s.thinking+e.delta.thinking});break}case"signature_delta":{s?.type==="thinking"&&(n.content[e.index]={...s,signature:e.delta.signature});break}default:e.delta}return n}case"content_block_stop":return n}},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("streamEvent",s=>{const r=e.shift();r?r.resolve(s):t.push(s)}),this.on("end",()=>{n=!0;for(const s of e)s.resolve(void 0);e.length=0}),this.on("abort",s=>{n=!0;for(const r of e)r.reject(s);e.length=0}),this.on("error",s=>{n=!0;for(const r of e)r.reject(s);e.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((r,o)=>e.push({resolve:r,reject:o})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ds(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const dw={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192,"claude-opus-4-1-20250805":8192,"anthropic.claude-opus-4-1-20250805-v1:0":8192,"claude-opus-4-1@20250805":8192};var Ou,aa,co,$i,$l,ts,qs,gr,Dl,_m;function Eb(){let i,t;return{promise:new Promise((n,s)=>{i=n,t=s}),resolve:i,reject:t}}class pw{constructor(t,e,n){Ou.add(this),this.client=t,aa.set(this,!1),co.set(this,!1),$i.set(this,void 0),$l.set(this,void 0),ts.set(this,void 0),qs.set(this,void 0),gr.set(this,void 0),Dl.set(this,0),mt(this,$i,{params:{...e,messages:structuredClone(e.messages)}}),mt(this,$l,{...n,headers:pe([{"x-stainless-helper":"BetaToolRunner"},n?.headers])}),mt(this,gr,Eb())}async*[(aa=new WeakMap,co=new WeakMap,$i=new WeakMap,$l=new WeakMap,ts=new WeakMap,qs=new WeakMap,gr=new WeakMap,Dl=new WeakMap,Ou=new WeakSet,Symbol.asyncIterator)](){var t;if(z(this,aa,"f"))throw new At("Cannot iterate over a consumed stream");mt(this,aa,!0),mt(this,co,!0),mt(this,qs,void 0);try{for(;;){let e;try{if(z(this,$i,"f").params.max_iterations&&z(this,Dl,"f")>=z(this,$i,"f").params.max_iterations)break;mt(this,co,!1,"f"),mt(this,ts,void 0,"f"),mt(this,qs,void 0,"f"),mt(this,Dl,(t=z(this,Dl,"f"),t++,t),"f");const{max_iterations:n,...s}=z(this,$i,"f").params;if(s.stream?(e=this.client.beta.messages.stream({...s},z(this,$l,"f")),mt(this,ts,e.finalMessage(),"f"),yield e):(mt(this,ts,this.client.beta.messages.create({...s,stream:!1},z(this,$l,"f")),"f"),yield z(this,ts,"f")),!z(this,co,"f")){const{role:o,content:a}=await z(this,ts,"f");z(this,$i,"f").params.messages.push({role:o,content:a})}const r=await z(this,Ou,"m",_m).call(this,z(this,$i,"f").params.messages.at(-1));if(r&&z(this,$i,"f").params.messages.push(r),!r&&!z(this,co,"f"))break}finally{e&&e.abort()}}if(!z(this,ts,"f"))throw new At("ToolRunner concluded without a message from the server");z(this,gr,"f").resolve(await z(this,ts,"f"))}catch(e){throw mt(this,aa,!1),z(this,gr,"f").promise.catch(()=>{}),z(this,gr,"f").reject(e),mt(this,gr,Eb()),e}}setMessagesParams(t){typeof t=="function"?z(this,$i,"f").params=t(z(this,$i,"f").params):z(this,$i,"f").params=t,mt(this,co,!0),mt(this,qs,void 0)}async generateToolResponse(){const t=await z(this,ts,"f")??this.params.messages.at(-1);return t?z(this,Ou,"m",_m).call(this,t):null}done(){return z(this,gr,"f").promise}async runUntilDone(){if(!z(this,aa,"f"))for await(const t of this);return this.done()}get params(){return z(this,$i,"f").params}pushMessages(...t){this.setMessagesParams(e=>({...e,messages:[...e.messages,...t]}))}then(t,e){return this.runUntilDone().then(t,e)}}_m=async function(t){return z(this,qs,"f")!==void 0?z(this,qs,"f"):(mt(this,qs,DI(z(this,$i,"f").params,t)),z(this,qs,"f"))};async function DI(i,t=i.messages.at(-1)){if(!t||t.role!=="assistant"||!t.content||typeof t.content=="string")return null;const e=t.content.filter(s=>s.type==="tool_use");return e.length===0?null:{role:"user",content:await Promise.all(e.map(async s=>{const r=i.tools.find(o=>o.name===s.name);if(!r||!("run"in r))return{type:"tool_result",tool_use_id:s.id,content:`Error: Tool '${s.name}' not found`,is_error:!0};try{let o=s.input;"parse"in r&&r.parse&&(o=r.parse(o));const a=await r.run(o);return{type:"tool_result",tool_use_id:s.id,content:a}}catch(o){return{type:"tool_result",tool_use_id:s.id,content:`Error: ${o instanceof Error?o.message:String(o)}`,is_error:!0}}}))}}const Rb={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-5-sonnet-20241022":"October 22, 2025","claude-3-5-sonnet-20240620":"October 22, 2025"};let rp=class extends cr{constructor(){super(...arguments),this.batches=new uw(this._client)}create(t,e){const{betas:n,...s}=t;s.model in Rb&&console.warn(`The model '${s.model}' is deprecated and will reach end-of-life on ${Rb[s.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let r=this._client._options.timeout;if(!s.stream&&r==null){const o=dw[s.model]??void 0;r=this._client.calculateNonstreamingTimeout(s.max_tokens,o)}return this._client.post("/v1/messages?beta=true",{body:s,timeout:r??6e5,...e,headers:pe([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},e?.headers]),stream:t.stream??!1})}stream(t,e){return Wf.createMessage(this,t,e)}countTokens(t,e){const{betas:n,...s}=t;return this._client.post("/v1/messages/count_tokens?beta=true",{body:s,...e,headers:pe([{"anthropic-beta":[...n??[],"token-counting-2024-11-01"].toString()},e?.headers])})}toolRunner(t,e){return new pw(this._client,t,e)}};rp.Batches=uw;rp.BetaToolRunner=pw;class kh extends cr{constructor(){super(...arguments),this.models=new hw(this._client),this.messages=new rp(this._client),this.files=new cw(this._client)}}kh.Models=hw;kh.Messages=rp;kh.Files=cw;class gw extends cr{create(t,e){const{betas:n,...s}=t;return this._client.post("/v1/complete",{body:s,timeout:this._client._options.timeout??6e5,...e,headers:pe([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},e?.headers]),stream:t.stream??!1})}}var pn,mr,Ll,yu,Vl,Bl,bu,Zl,$s,Fl,vu,_u,la,xu,Su,Gp,Ib,jp,Up,Yp,Hp,Qb;const Nb="__json_buf";function $b(i){return i.type==="tool_use"||i.type==="server_tool_use"}class qf{constructor(){pn.add(this),this.messages=[],this.receivedMessages=[],mr.set(this,void 0),this.controller=new AbortController,Ll.set(this,void 0),yu.set(this,()=>{}),Vl.set(this,()=>{}),Bl.set(this,void 0),bu.set(this,()=>{}),Zl.set(this,()=>{}),$s.set(this,{}),Fl.set(this,!1),vu.set(this,!1),_u.set(this,!1),la.set(this,!1),xu.set(this,void 0),Su.set(this,void 0),jp.set(this,t=>{if(mt(this,vu,!0),Vc(t)&&(t=new $n),t instanceof $n)return mt(this,_u,!0),this._emit("abort",t);if(t instanceof At)return this._emit("error",t);if(t instanceof Error){const e=new At(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new At(String(t)))}),mt(this,Ll,new Promise((t,e)=>{mt(this,yu,t,"f"),mt(this,Vl,e,"f")})),mt(this,Bl,new Promise((t,e)=>{mt(this,bu,t,"f"),mt(this,Zl,e,"f")})),z(this,Ll,"f").catch(()=>{}),z(this,Bl,"f").catch(()=>{})}get response(){return z(this,xu,"f")}get request_id(){return z(this,Su,"f")}async withResponse(){const t=await z(this,Ll,"f");if(!t)throw new Error("Could not resolve a `Response` object");return{data:this,response:t,request_id:t.headers.get("request-id")}}static fromReadableStream(t){const e=new qf;return e._run(()=>e._fromReadableStream(t)),e}static createMessage(t,e,n){const s=new qf;for(const r of e.messages)s._addMessageParam(r);return s._run(()=>s._createMessage(t,{...e,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),s}_run(t){t().then(()=>{this._emitFinal(),this._emit("end")},z(this,jp,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,e=!0){this.receivedMessages.push(t),e&&this._emit("message",t)}async _createMessage(t,e,n){const s=n?.signal;let r;s&&(s.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),s.addEventListener("abort",r));try{z(this,pn,"m",Up).call(this);const{response:o,data:a}=await t.create({...e,stream:!0},{...n,signal:this.controller.signal}).withResponse();this._connected(o);for await(const l of a)z(this,pn,"m",Yp).call(this,l);if(a.controller.signal?.aborted)throw new $n;z(this,pn,"m",Hp).call(this)}finally{s&&r&&s.removeEventListener("abort",r)}}_connected(t){this.ended||(mt(this,xu,t),mt(this,Su,t?.headers.get("request-id")),z(this,yu,"f").call(this,t),this._emit("connect"))}get ended(){return z(this,Fl,"f")}get errored(){return z(this,vu,"f")}get aborted(){return z(this,_u,"f")}abort(){this.controller.abort()}on(t,e){return(z(this,$s,"f")[t]||(z(this,$s,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=z(this,$s,"f")[t];if(!n)return this;const s=n.findIndex(r=>r.listener===e);return s>=0&&n.splice(s,1),this}once(t,e){return(z(this,$s,"f")[t]||(z(this,$s,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise((e,n)=>{mt(this,la,!0),t!=="error"&&this.once("error",n),this.once(t,e)})}async done(){mt(this,la,!0),await z(this,Bl,"f")}get currentMessage(){return z(this,mr,"f")}async finalMessage(){return await this.done(),z(this,pn,"m",Gp).call(this)}async finalText(){return await this.done(),z(this,pn,"m",Ib).call(this)}_emit(t,...e){if(z(this,Fl,"f"))return;t==="end"&&(mt(this,Fl,!0),z(this,bu,"f").call(this));const n=z(this,$s,"f")[t];if(n&&(z(this,$s,"f")[t]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...e))),t==="abort"){const s=e[0];!z(this,la,"f")&&!n?.length&&Promise.reject(s),z(this,Vl,"f").call(this,s),z(this,Zl,"f").call(this,s),this._emit("end");return}if(t==="error"){const s=e[0];!z(this,la,"f")&&!n?.length&&Promise.reject(s),z(this,Vl,"f").call(this,s),z(this,Zl,"f").call(this,s),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",z(this,pn,"m",Gp).call(this))}async _fromReadableStream(t,e){const n=e?.signal;let s;n&&(n.aborted&&this.controller.abort(),s=this.controller.abort.bind(this.controller),n.addEventListener("abort",s));try{z(this,pn,"m",Up).call(this),this._connected(null);const r=ds.fromReadableStream(t,this.controller);for await(const o of r)z(this,pn,"m",Yp).call(this,o);if(r.controller.signal?.aborted)throw new $n;z(this,pn,"m",Hp).call(this)}finally{n&&s&&n.removeEventListener("abort",s)}}[(mr=new WeakMap,Ll=new WeakMap,yu=new WeakMap,Vl=new WeakMap,Bl=new WeakMap,bu=new WeakMap,Zl=new WeakMap,$s=new WeakMap,Fl=new WeakMap,vu=new WeakMap,_u=new WeakMap,la=new WeakMap,xu=new WeakMap,Su=new WeakMap,jp=new WeakMap,pn=new WeakSet,Gp=function(){if(this.receivedMessages.length===0)throw new At("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Ib=function(){if(this.receivedMessages.length===0)throw new At("stream ended without producing a Message with role=assistant");const e=this.receivedMessages.at(-1).content.filter(n=>n.type==="text").map(n=>n.text);if(e.length===0)throw new At("stream ended without producing a content block with type=text");return e.join(" ")},Up=function(){this.ended||mt(this,mr,void 0)},Yp=function(e){if(this.ended)return;const n=z(this,pn,"m",Qb).call(this,e);switch(this._emit("streamEvent",e,n),e.type){case"content_block_delta":{const s=n.content.at(-1);switch(e.delta.type){case"text_delta":{s.type==="text"&&this._emit("text",e.delta.text,s.text||"");break}case"citations_delta":{s.type==="text"&&this._emit("citation",e.delta.citation,s.citations??[]);break}case"input_json_delta":{$b(s)&&s.input&&this._emit("inputJson",e.delta.partial_json,s.input);break}case"thinking_delta":{s.type==="thinking"&&this._emit("thinking",e.delta.thinking,s.thinking);break}case"signature_delta":{s.type==="thinking"&&this._emit("signature",s.signature);break}default:e.delta}break}case"message_stop":{this._addMessageParam(n),this._addMessage(n,!0);break}case"content_block_stop":{this._emit("contentBlock",n.content.at(-1));break}case"message_start":{mt(this,mr,n);break}}},Hp=function(){if(this.ended)throw new At("stream has ended, this shouldn't happen");const e=z(this,mr,"f");if(!e)throw new At("request ended without sending any chunks");return mt(this,mr,void 0),e},Qb=function(e){let n=z(this,mr,"f");if(e.type==="message_start"){if(n)throw new At(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!n)throw new At(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":return n;case"message_delta":return n.stop_reason=e.delta.stop_reason,n.stop_sequence=e.delta.stop_sequence,n.usage.output_tokens=e.usage.output_tokens,e.usage.input_tokens!=null&&(n.usage.input_tokens=e.usage.input_tokens),e.usage.cache_creation_input_tokens!=null&&(n.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),e.usage.cache_read_input_tokens!=null&&(n.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),e.usage.server_tool_use!=null&&(n.usage.server_tool_use=e.usage.server_tool_use),n;case"content_block_start":return n.content.push({...e.content_block}),n;case"content_block_delta":{const s=n.content.at(e.index);switch(e.delta.type){case"text_delta":{s?.type==="text"&&(n.content[e.index]={...s,text:(s.text||"")+e.delta.text});break}case"citations_delta":{s?.type==="text"&&(n.content[e.index]={...s,citations:[...s.citations??[],e.delta.citation]});break}case"input_json_delta":{if(s&&$b(s)){let r=s[Nb]||"";r+=e.delta.partial_json;const o={...s};Object.defineProperty(o,Nb,{value:r,enumerable:!1,writable:!0}),r&&(o.input=fw(r)),n.content[e.index]=o}break}case"thinking_delta":{s?.type==="thinking"&&(n.content[e.index]={...s,thinking:s.thinking+e.delta.thinking});break}case"signature_delta":{s?.type==="thinking"&&(n.content[e.index]={...s,signature:e.delta.signature});break}default:e.delta}return n}case"content_block_stop":return n}},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("streamEvent",s=>{const r=e.shift();r?r.resolve(s):t.push(s)}),this.on("end",()=>{n=!0;for(const s of e)s.resolve(void 0);e.length=0}),this.on("abort",s=>{n=!0;for(const r of e)r.reject(s);e.length=0}),this.on("error",s=>{n=!0;for(const r of e)r.reject(s);e.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((r,o)=>e.push({resolve:r,reject:o})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ds(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class mw extends cr{create(t,e){return this._client.post("/v1/messages/batches",{body:t,...e})}retrieve(t,e){return this._client.get(Bn`/v1/messages/batches/${t}`,e)}list(t={},e){return this._client.getAPIList("/v1/messages/batches",wh,{query:t,...e})}delete(t,e){return this._client.delete(Bn`/v1/messages/batches/${t}`,e)}cancel(t,e){return this._client.post(Bn`/v1/messages/batches/${t}/cancel`,e)}async results(t,e){const n=await this.retrieve(t);if(!n.results_url)throw new At(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);return this._client.get(n.results_url,{...e,headers:pe([{Accept:"application/binary"},e?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((s,r)=>sp.fromResponse(r.response,r.controller))}}class BO extends cr{constructor(){super(...arguments),this.batches=new mw(this._client)}create(t,e){t.model in Db&&console.warn(`The model '${t.model}' is deprecated and will reach end-of-life on ${Db[t.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let n=this._client._options.timeout;if(!t.stream&&n==null){const s=dw[t.model]??void 0;n=this._client.calculateNonstreamingTimeout(t.max_tokens,s)}return this._client.post("/v1/messages",{body:t,timeout:n??6e5,...e,stream:t.stream??!1})}stream(t,e){return qf.createMessage(this,t,e)}countTokens(t,e){return this._client.post("/v1/messages/count_tokens",{body:t,...e})}}const Db={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-5-sonnet-20241022":"October 22, 2025","claude-3-5-sonnet-20240620":"October 22, 2025"};BO.Batches=mw;class Ow extends cr{retrieve(t,e={},n){const{betas:s}=e??{};return this._client.get(Bn`/v1/models/${t}`,{...n,headers:pe([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},n?.headers])})}list(t={},e){const{betas:n,...s}=t??{};return this._client.getAPIList("/v1/models",wh,{query:s,...e,headers:pe([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},e?.headers])})}}var LI={};const wu=i=>{if(typeof globalThis.process<"u")return LI?.[i]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(i)?.trim()};var xm,ZO,rf,yw;const VI="\\n\\nHuman:",BI="\\n\\nAssistant:";class Ve{constructor({baseURL:t=wu("ANTHROPIC_BASE_URL"),apiKey:e=wu("ANTHROPIC_API_KEY")??null,authToken:n=wu("ANTHROPIC_AUTH_TOKEN")??null,...s}={}){xm.add(this),rf.set(this,void 0);const r={apiKey:e,authToken:n,...s,baseURL:t||"https://api.anthropic.com"};if(!r.dangerouslyAllowBrowser&&oI())throw new At(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);this.baseURL=r.baseURL,this.timeout=r.timeout??ZO.DEFAULT_TIMEOUT,this.logger=r.logger??console;const o="warn";this.logLevel=o,this.logLevel=Sb(r.logLevel,"ClientOptions.logLevel",this)??Sb(wu("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??o,this.fetchOptions=r.fetchOptions,this.maxRetries=r.maxRetries??2,this.fetch=r.fetch??uI(),mt(this,rf,dI),this._options=r,this.apiKey=e,this.authToken=n}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:e}){if(!(this.apiKey&&t.get("x-api-key"))&&!e.has("x-api-key")&&!(this.authToken&&t.get("authorization"))&&!e.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(t){return pe([await this.apiKeyAuth(t),await this.bearerAuth(t)])}async apiKeyAuth(t){if(this.apiKey!=null)return pe([{"X-Api-Key":this.apiKey}])}async bearerAuth(t){if(this.authToken!=null)return pe([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(t){return Object.entries(t).filter(([e,n])=>typeof n<"u").map(([e,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(e)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(e)}=`;throw new At(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ua}`}defaultIdempotencyKey(){return`stainless-node-retry-${WS()}`}makeStatusError(t,e,n,s){return Oi.generate(t,e,n,s)}buildURL(t,e,n){const s=!z(this,xm,"m",yw).call(this)&&n||this.baseURL,r=eI(t)?new URL(t):new URL(s+(s.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return iI(o)||(e={...o,...e}),typeof e=="object"&&e&&!Array.isArray(e)&&(r.search=this.stringifyQuery(e)),r.toString()}_calculateNonstreamingTimeout(t){if(3600*t/128e3>600)throw new At("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 600*1e3}async prepareOptions(t){}async prepareRequest(t,{url:e,options:n}){}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,n){return this.request(Promise.resolve(n).then(s=>({method:t,path:e,...s})))}request(t,e=null){return new np(this,this.makeRequest(t,e,void 0))}async makeRequest(t,e,n){const s=await t,r=s.maxRetries??this.maxRetries;e==null&&(e=r),await this.prepareOptions(s);const{req:o,url:a,timeout:l}=await this.buildRequest(s,{retryCount:r-e});await this.prepareRequest(o,{url:a,options:s});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),h=n===void 0?"":`, retryOf: ${n}`,u=Date.now();if(xi(this).debug(`[${c}] sending request`,fo({retryOfRequestLogID:n,method:s.method,url:a,options:s,headers:o.headers})),s.signal?.aborted)throw new $n;const f=new AbortController,d=await this.fetchWithTimeout(a,o,l,f).catch(Om),p=Date.now();if(d instanceof globalThis.Error){const O=`retrying, ${e} attempts remaining`;if(s.signal?.aborted)throw new $n;const y=Vc(d)||/timed? ?out/i.test(String(d)+("cause"in d?String(d.cause):""));if(e)return xi(this).info(`[${c}] connection ${y?"timed out":"failed"} - ${O}`),xi(this).debug(`[${c}] connection ${y?"timed out":"failed"} (${O})`,fo({retryOfRequestLogID:n,url:a,durationMs:p-u,message:d.message})),this.retryRequest(s,e,n??c);throw xi(this).info(`[${c}] connection ${y?"timed out":"failed"} - error; no more retries left`),xi(this).debug(`[${c}] connection ${y?"timed out":"failed"} (error; no more retries left)`,fo({retryOfRequestLogID:n,url:a,durationMs:p-u,message:d.message})),y?new qS:new ip({cause:d})}const g=[...d.headers.entries()].filter(([O])=>O==="request-id").map(([O,y])=>", "+O+": "+JSON.stringify(y)).join(""),m=`[${c}${h}${g}] ${o.method} ${a} ${d.ok?"succeeded":"failed"} with status ${d.status} in ${p-u}ms`;if(!d.ok){const O=await this.shouldRetry(d);if(e&&O){const x=`retrying, ${e} attempts remaining`;return await fI(d.body),xi(this).info(`${m} - ${x}`),xi(this).debug(`[${c}] response error (${x})`,fo({retryOfRequestLogID:n,url:d.url,status:d.status,headers:d.headers,durationMs:p-u})),this.retryRequest(s,e,n??c,d.headers)}const y=O?"error; no more retries left":"error; not retryable";xi(this).info(`${m} - ${y}`);const _=await d.text().catch(x=>Om(x).message),v=JS(_),b=v?void 0:_;throw xi(this).debug(`[${c}] response error (${y})`,fo({retryOfRequestLogID:n,url:d.url,status:d.status,headers:d.headers,message:b,durationMs:Date.now()-u})),this.makeStatusError(d.status,v,b,d.headers)}return xi(this).info(m),xi(this).debug(`[${c}] response start`,fo({retryOfRequestLogID:n,url:d.url,status:d.status,headers:d.headers,durationMs:p-u})),{response:d,options:s,controller:f,requestLogID:c,retryOfRequestLogID:n,startTime:u}}getAPIList(t,e,n){return this.requestAPIList(e,{method:"get",path:t,...n})}requestAPIList(t,e){const n=this.makeRequest(e,null,void 0);return new SI(this,n,t)}async fetchWithTimeout(t,e,n,s){const{signal:r,method:o,...a}=e||{};r&&r.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),n),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,h={signal:s.signal,...c?{duplex:"half"}:{},method:"GET",...a};o&&(h.method=o.toUpperCase());try{return await this.fetch.call(void 0,t,h)}finally{clearTimeout(l)}}async shouldRetry(t){const e=t.headers.get("x-should-retry");return e==="true"?!0:e==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,e,n,s){let r;const o=s?.get("retry-after-ms");if(o){const l=parseFloat(o);Number.isNaN(l)||(r=l)}const a=s?.get("retry-after");if(a&&!r){const l=parseFloat(a);Number.isNaN(l)?r=Date.parse(a)-Date.now():r=l*1e3}if(!(r&&0<=r&&r<60*1e3)){const l=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(e,l)}return await rI(r),this.makeRequest(t,e-1,n)}calculateDefaultRetryTimeoutMillis(t,e){const r=e-t,o=Math.min(.5*Math.pow(2,r),8),a=1-Math.random()*.25;return o*a*1e3}calculateNonstreamingTimeout(t,e){if(36e5*t/128e3>6e5||e!=null&&t>e)throw new At("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(t,{retryCount:e=0}={}){const n={...t},{method:s,path:r,query:o,defaultBaseURL:a}=n,l=this.buildURL(r,o,a);"timeout"in n&&sI("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const{bodyHeaders:c,body:h}=this.buildBody({options:n}),u=await this.buildHeaders({options:t,method:s,bodyHeaders:c,retryCount:e});return{req:{method:s,headers:u,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&h instanceof globalThis.ReadableStream&&{duplex:"half"},...h&&{body:h},...this.fetchOptions??{},...n.fetchOptions??{}},url:l,timeout:n.timeout}}async buildHeaders({options:t,method:e,bodyHeaders:n,retryCount:s}){let r={};this.idempotencyHeader&&e!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=t.idempotencyKey);const o=pe([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...hI(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(t),this._options.defaultHeaders,n,t.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:t,headers:e}}){if(!t)return{bodyHeaders:void 0,body:void 0};const n=pe([e]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&n.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:ew(t)}:z(this,rf,"f").call(this,{body:t,headers:n})}}ZO=Ve,rf=new WeakMap,xm=new WeakSet,yw=function(){return this.baseURL!=="https://api.anthropic.com"};Ve.Anthropic=ZO;Ve.HUMAN_PROMPT=VI;Ve.AI_PROMPT=BI;Ve.DEFAULT_TIMEOUT=6e5;Ve.AnthropicError=At;Ve.APIError=Oi;Ve.APIConnectionError=ip;Ve.APIConnectionTimeoutError=qS;Ve.APIUserAbortError=$n;Ve.NotFoundError=jS;Ve.ConflictError=US;Ve.RateLimitError=HS;Ve.BadRequestError=XS;Ve.AuthenticationError=zS;Ve.InternalServerError=KS;Ve.PermissionDeniedError=GS;Ve.UnprocessableEntityError=YS;Ve.toFile=MI;class Ch extends Ve{constructor(){super(...arguments),this.completions=new gw(this),this.messages=new BO(this),this.models=new Ow(this),this.beta=new kh(this)}}Ch.Completions=gw;Ch.Messages=BO;Ch.Models=Ow;Ch.Beta=kh;const ZI=512,FI=10,Lb="claude-sonnet-4-5";function WI(i,t){return i.slice(0,ZI).map((n,s)=>{const r=Math.max(0,Math.min(127,Math.round(n.pitch??60))),o=Math.max(0,n.position??0),a=1/t.subdivision,l=Math.max(a,n.duration??.25),c=Math.max(0,Math.min(127,n.velocity??100)),h=Math.max(a,t.maxLength-o);return{id:n.id||`note-${Date.now()}-${s}`,pitch:r,position:o,duration:Math.min(l,h),velocity:c}})}function qI(i){const{getNotes:t,setNotes:e,getGrid:n,registry:s}=i,r=ue([]),o=ue(!1),a=ue(null),l={name:"midi_notes",description:"Read or write the piano roll MIDI notes. Use action='read' to fetch all notes. Use action='write' with a notes array to replace the current notes.",input_schema:{type:"object",properties:{action:{type:"string",enum:["read","write"],description:"Whether to read current notes or write new notes"},notes:{type:"array",description:"Array of MIDI notes to write (only for 'write' action)",items:{type:"object",properties:{id:{type:"string",description:"Optional unique identifier"},pitch:{type:"number",minimum:0,maximum:127,description:"MIDI pitch (0-127, 60=middle C)"},position:{type:"number",minimum:0,description:"Note start position in quarter notes"},duration:{type:"number",minimum:0,description:"Note duration in quarter notes"},velocity:{type:"number",minimum:0,maximum:127,description:"Note velocity (0-127, default 100)"}},required:["pitch","position","duration"]}}},required:["action"]}},c={name:"write_transform_function",description:"Create or overwrite a transform function in a given slot (0-7). Provide complete JavaScript code with a function named 'transform' that takes notes as first parameter, followed by numeric parameters. Include JSDoc comments with one line per parameter.",input_schema:{type:"object",properties:{slotIndex:{type:"number",minimum:0,maximum:7,description:"Slot index (0-7) where to write the transform"},code:{type:"string",description:"Complete JavaScript code defining the transform function"}},required:["slotIndex","code"]}};function h(){const p=n();let g=`You are a music composition assistant for a MIDI piano roll editor.

IMPORTANT RULES:
- Always use the midi_notes tool to read or write notes - never hallucinate note data
- Grid constraints: maxLength=${p.maxLength} quarter notes, timeSignature=${p.timeSignature}/4, subdivision=1/${p.subdivision}
- Time units: 1.0 represents one quarter note across all positions and durations
- When writing notes:
  - Pitch must be 0-127 (60=middle C, 62=D, 64=E, 65=F, 67=G, 69=A, 71=B, 72=high C)
  - Position must be >= 0 and position+duration should stay within maxLength
  - Duration must be > 0 (minimum 1/${p.subdivision} quarter notes recommended)
  - Velocity defaults to 100 if not specified (range 0-127)
- Keep responses concise and acknowledge changes after writing
- Consider musical context when suggesting edits (key, rhythm, harmony)
- When creating chords, use simultaneous notes at the same position`;return s&&(g+=`

TRANSFORM FUNCTIONS:
Before modifying notes, determine the best approach:
- For simple operations (add/remove individual notes, simple pitch/position changes), use midi_notes tool directly
- For pattern-based operations (transpose all notes, quantize, humanize), check if an existing transform tool matches
- For complex multi-step operations, consider combining multiple transform tools in sequence
- Only create new transforms if no existing tool or combination fits the need

Available transform tools:
${s.summarizeTransforms()}

When using a transform tool:
1. First, determine if you have all required parameter values
2. If any required parameter is missing and cannot be reasonably inferred from context, ask the user for it
3. Do NOT invoke the tool with placeholder or guessed values for missing required parameters
4. Optional parameters can be omitted if not provided

CREATING NEW TRANSFORMS:
Use write_transform_function(code, slotIndex) only when:
- The user explicitly asks you to create a transform function
- No existing transform or combination can accomplish the task
- The operation would be reusable for future requests

Transform code requirements:
- Must define a function with notes as the first parameter, followed by numeric parameters
- Function can have any name (e.g., transpose, quantize, humanize)
- First parameter must be 'notes' (the input array)
- Additional parameters must be numbers that configure the transformation
- Must include JSDoc with @param tags for each parameter
- Should return a new array, not modify input array

Example transform structure:
/**
 * Brief description of what this does.
 * @param {Note[]} notes - Input notes array
 * @param {number} paramName - Description and recommended range (e.g., 0-127, -12 to +12)
 * * ... - more parameters, as long as they are all numbers (and you need a description line for each)
 */
function myTransform(notes, paramName) {
  const newNotes = notes.map(n => ({...n}));
  // transform newNotes here
  return newNotes;
}`),g}async function u(p){const g=n();if(p.action==="read")return{notes:t(),grid:g};if(p.action==="write"){const m=WI(p.notes||[],g);return e(m),{status:"ok",count:m.length,grid:g}}return{error:"Invalid action"}}async function f(p,g){if(!g.trim()){a.value="Please provide an API key";return}if(p.trim()){r.value.push({role:"user",text:p,timestamp:Date.now()}),o.value=!0,a.value=null;try{const m=new Ch({apiKey:g,dangerouslyAllowBrowser:!0}),O=[l],y=new Map;if(y.set("midi_notes",u),s){O.push(c),y.set("write_transform_function",async I=>{const R=s.writeTransformFunction(I.slotIndex,I.code);return{status:R.valid?"validated":"invalid",errors:R.errors,toolName:R.valid?`transform_slot_${I.slotIndex+1}`:void 0,params:R.params}});const x=s.getToolDefs();O.push(...x),s.getToolHandlers().forEach((I,R)=>{y.set(R,I)})}const _=[{role:"user",content:p}];let v=await m.messages.create({model:Lb,system:h(),tools:O,max_tokens:1e3,messages:_});const b=[];for(let x=0;x<FI;x++){const C=v.content.filter(R=>R.type==="tool_use");if(C.length===0)break;for(const R of C){let $=R.name;if(R.name.startsWith("transform_slot_")&&s){const E=parseInt(R.name.replace("transform_slot_",""))-1,Z=s.slots[E];Z&&Z.functionName&&($=Z.functionName)}b.push({name:R.name,displayName:$,input:R.input})}_.push({role:"assistant",content:v.content});const I=[];for(const R of C){const $=y.get(R.name);if($){const E=await $(R.input);I.push({type:"tool_result",tool_use_id:R.id,content:JSON.stringify(E)})}}_.push({role:"user",content:I}),v=await m.messages.create({model:Lb,system:h(),tools:O,max_tokens:1e3,messages:_})}const k=v.content.filter(x=>x.type==="text").map(x=>x.text).join(`
`);r.value.push({role:"assistant",text:k||"No response",timestamp:Date.now(),toolCalls:b.length>0?b:void 0})}catch(m){a.value=m.message||"Failed to communicate with Claude",console.error("Claude API error:",m)}finally{o.value=!1}}}function d(){r.value=[],a.value=null,o.value=!1}return{messages:r,isWaiting:o,error:a,send:f,reset:d}}const XI={class:"claude-chat"},zI={class:"chat-header"},GI=["disabled"],jI={class:"api-key-section"},UI={class:"api-key-label-row"},YI=["type"],HI={key:0,class:"alert alert-warning warning"},KI={class:"warning-content"},JI={class:"modal-header"},tQ={class:"modal-footer"},eQ={key:0,class:"empty-state"},iQ={class:"message-header"},nQ={class:"role-label"},sQ={class:"timestamp"},rQ={key:0,class:"tool-calls"},oQ={class:"tool-name"},aQ={key:0,class:"tool-params"},lQ={class:"message-text"},cQ={key:1,class:"message assistant waiting"},hQ={key:1,class:"error-message"},uQ={class:"input-container"},fQ=["disabled"],dQ=["disabled"],pQ=al({__name:"ClaudeChat",props:{getNotes:{type:Function},setNotes:{type:Function},getGrid:{type:Function},registry:{}},setup(i){const t=i,e=qI({getNotes:t.getNotes,setNotes:t.setNotes,getGrid:t.getGrid,registry:t.registry}),n=ue(""),s=ue(""),r=ue(null),o=ue(!0),a=ue(!1),l=ue(!1),c=async()=>{await Td(),r.value&&(r.value.scrollTop=r.value.scrollHeight)},h=async()=>{if(!s.value.trim()||e.isWaiting.value)return;const d=s.value;s.value="",await e.send(d,n.value),await c()},u=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),h())},f=d=>new Date(d).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(d,p)=>(It(),$t("div",XI,[Y("div",zI,[p[10]||(p[10]=Y("h3",null,"AI Music Assistant",-1)),Re(e).messages.value.length>0?(It(),$t("button",{key:0,onClick:p[0]||(p[0]=g=>Re(e).reset()),class:"btn btn-ghost reset-btn",disabled:Re(e).isWaiting.value}," Clear Chat ",8,GI)):oi("",!0)]),Y("div",jI,[Y("div",UI,[p[11]||(p[11]=Y("label",{for:"api-key"},[Fi(" Claude API Key "),Y("span",{class:"required"},"*")],-1)),Y("button",{type:"button",onClick:p[1]||(p[1]=g=>a.value=!a.value),class:"btn btn-ghost toggle-visibility-btn"},Pe(a.value?"👁️ Hide":"👁️‍🗨️ Show"),1)]),Rc(Y("input",{id:"api-key","onUpdate:modelValue":p[2]||(p[2]=g=>n.value=g),type:a.value?"text":"password",placeholder:"sk-ant-...",class:"input api-key-input",autocomplete:"off",spellcheck:"false"},null,8,YI),[[$P,n.value]]),o.value?(It(),$t("div",HI,[p[14]||(p[14]=Y("span",{class:"warning-icon"},"⚠️",-1)),Y("div",KI,[p[12]||(p[12]=Y("strong",null,"Security Warning:",-1)),p[13]||(p[13]=Fi(" This API key is exposed in your browser. Use a limited, revocable key. Never use production keys. ",-1)),Y("a",{href:"#",onClick:p[3]||(p[3]=os(g=>l.value=!0,["prevent"])),class:"learn-more-link"},"Click here to learn more"),Y("button",{onClick:p[4]||(p[4]=g=>o.value=!1),class:"btn btn-ghost dismiss-btn"},"Dismiss")])])):oi("",!0)]),l.value?(It(),$t("div",{key:0,class:"modal-overlay",onClick:p[8]||(p[8]=g=>l.value=!1)},[Y("div",{class:"modal-content",onClick:p[7]||(p[7]=os(()=>{},["stop"]))},[Y("div",JI,[p[15]||(p[15]=Y("h2",null,"⚠️ Important notice about your API key",-1)),Y("button",{onClick:p[5]||(p[5]=g=>l.value=!1),class:"btn btn-ghost modal-close"},"×")]),p[16]||(p[16]=iP('<div class="modal-body" data-v-5c872952><section data-v-5c872952><h3 data-v-5c872952>Where your key lives:</h3><p data-v-5c872952>This app runs entirely in your browser. Your API key is kept in memory only and is not saved to localStorage, cookies, or our servers. When you close or refresh the page, the key is discarded.</p></section><section data-v-5c872952><h3 data-v-5c872952>What that still means in practice:</h3><p data-v-5c872952>Even without storage, a key used in the browser can be exposed in several ways:</p><ul data-v-5c872952><li data-v-5c872952><strong data-v-5c872952>Browser extensions</strong> – Any extension with permission to run on this page can read the DOM, intercept network requests, or capture keystrokes. Malicious or over-permissive extensions can exfiltrate your key and chat data.</li><li data-v-5c872952><strong data-v-5c872952>Developer tools &amp; logs</strong> – Authorization headers and request bodies may be visible in the Network tab. Copy/paste history, crash reports, debugging overlays, or third-party analytics/debug scripts could capture sensitive data.</li><li data-v-5c872952><strong data-v-5c872952>Clipboard &amp; screenshots</strong> – Some clipboard managers keep history; screen recorders or &quot;share your screen&quot; sessions can reveal the key or responses.</li><li data-v-5c872952><strong data-v-5c872952>Malware or shared devices</strong> – Keyloggers and remote-control tools can grab what you type. Anyone with access to your machine or account profile could view active sessions.</li><li data-v-5c872952><strong data-v-5c872952>Third-party scripts</strong> – If you enable content blockers or load-helper scripts, be aware that any third-party script running on the page could read page memory.</li><li data-v-5c872952><strong data-v-5c872952>Network visibility</strong> – We use HTTPS, but corporate proxies, antivirus, or traffic-capturing tools on your device/network could still inspect requests.</li><li data-v-5c872952><strong data-v-5c872952>Usage risk</strong> – If your key leaks, someone else can spend your credits, hit your rate limits, or access models/features under your account until you revoke it.</li></ul></section><section data-v-5c872952><h3 data-v-5c872952>How to reduce your risk (recommended):</h3><ul data-v-5c872952><li data-v-5c872952><strong data-v-5c872952>Use a limited, revocable key:</strong><p data-v-5c872952>Create a non-production key with the lowest possible permissions, strict quotas/spend caps, and model/endpoint allow-lists (if supported). Be ready to revoke it at any time.</p></li><li data-v-5c872952><strong data-v-5c872952>Prefer a clean browser session:</strong><p data-v-5c872952>Use a private/incognito window with extensions disabled. Don&#39;t save the key between sessions. Avoid pasting it into multiple tabs.</p></li><li data-v-5c872952><strong data-v-5c872952>Keep it off the clipboard:</strong><p data-v-5c872952>Paste once if needed, then clear it. Disable clipboard history managers while using the app.</p></li><li data-v-5c872952><strong data-v-5c872952>Don&#39;t open DevTools while using the key:</strong><p data-v-5c872952>This reduces the chance of accidental logging or copying of request data.</p></li><li data-v-5c872952><strong data-v-5c872952>Verify the site:</strong><p data-v-5c872952>Make sure you&#39;re on the correct domain (HTTPS lock icon, expected URL). Don&#39;t use the app from untrusted links or if your browser shows security warnings.</p></li><li data-v-5c872952><strong data-v-5c872952>Rotate and monitor:</strong><p data-v-5c872952>Rotate keys periodically, and keep an eye on your provider&#39;s usage/billing dashboard for unexpected spikes.</p></li><li data-v-5c872952><strong data-v-5c872952>Prefer a server-side proxy for production:</strong><p data-v-5c872952>For real projects, use a backend that keeps provider keys on the server and issues short-lived, scoped tokens to the browser. That&#39;s the only robust way to protect a production key.</p></li></ul></section><section data-v-5c872952><h3 data-v-5c872952>By proceeding, you acknowledge:</h3><ul data-v-5c872952><li data-v-5c872952>You understand your key is used client-side and may be visible to software on your device (including extensions) and in browser tools.</li><li data-v-5c872952>You accept the risk of unintended exposure and potential charges if the key is leaked.</li><li data-v-5c872952>You agree to use a limited, revocable, non-production key and to revoke it immediately if you suspect misuse.</li></ul></section></div>',1)),Y("div",tQ,[Y("button",{onClick:p[6]||(p[6]=g=>l.value=!1),class:"btn btn-primary modal-ok-btn"},"I Understand")])])])):oi("",!0),Y("div",{class:"messages-container",ref_key:"messagesContainer",ref:r},[Re(e).messages.value.length===0?(It(),$t("div",eQ,[...p[17]||(p[17]=[Y("p",null,"👋 Ask me to create, modify, or analyze the music in your piano roll!",-1),Y("div",{class:"examples"},[Y("p",null,[Y("strong",null,"Try:")]),Y("ul",null,[Y("li",null,'"What notes are currently in the piano roll?"'),Y("li",null,'"Create a C major chord at beat 0"'),Y("li",null,'"Add a simple melody starting at beat 4"')])],-1)])])):oi("",!0),(It(!0),$t(ci,null,yo(Re(e).messages.value,(g,m)=>(It(),$t("div",{key:m,class:Ln(["message",g.role])},[Y("div",iQ,[Y("span",nQ,Pe(g.role==="user"?"You":"AI Assistant"),1),Y("span",sQ,Pe(f(g.timestamp)),1)]),g.toolCalls&&g.toolCalls.length>0?(It(),$t("div",rQ,[p[18]||(p[18]=Y("div",{class:"tool-call-header"},"🔧 Tools used:",-1)),(It(!0),$t(ci,null,yo(g.toolCalls,(O,y)=>(It(),$t("div",{key:y,class:"tool-call"},[Y("span",oQ,Pe(O.displayName||O.name),1),Object.keys(O.input).length>0?(It(),$t("span",aQ," ("+Pe(Object.entries(O.input).filter(([_])=>!(O.name==="midi_notes"&&_==="notes")).map(([_,v])=>`${_}: ${v}`).join(", "))+") ",1)):oi("",!0)]))),128))])):oi("",!0),Y("div",lQ,Pe(g.text),1)],2))),128)),Re(e).isWaiting.value?(It(),$t("div",cQ,[...p[19]||(p[19]=[Y("div",{class:"message-header"},[Y("span",{class:"role-label"},"AI Assistant")],-1),Y("div",{class:"message-text"},[Y("span",{class:"loading-dots"},"Thinking")],-1)])])):oi("",!0)],512),Re(e).error.value?(It(),$t("div",hQ,[p[20]||(p[20]=Y("strong",null,"Error:",-1)),Fi(" "+Pe(Re(e).error.value),1)])):oi("",!0),Y("div",uQ,[Rc(Y("textarea",{"onUpdate:modelValue":p[9]||(p[9]=g=>s.value=g),onKeydown:u,placeholder:"Ask me to create or modify music...",class:"textarea user-input",rows:"2",disabled:Re(e).isWaiting.value||!n.value},null,40,fQ),[[Xg,s.value]]),Y("button",{onClick:h,class:"btn btn-primary send-btn",disabled:Re(e).isWaiting.value||!s.value.trim()||!n.value}," Send ",8,dQ)])]))}}),gQ=xh(pQ,[["__scopeId","data-v-5c872952"]]);let Sm=[],bw=[];(()=>{let i="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,e=0;t<i.length;t++)(t%2?bw:Sm).push(e=e+i[t])})();function mQ(i){if(i<768)return!1;for(let t=0,e=Sm.length;;){let n=t+e>>1;if(i<Sm[n])e=n;else if(i>=bw[n])t=n+1;else return!0;if(t==e)return!1}}function Vb(i){return i>=127462&&i<=127487}const Bb=8205;function OQ(i,t,e=!0,n=!0){return(e?vw:yQ)(i,t,n)}function vw(i,t,e){if(t==i.length)return t;t&&_w(i.charCodeAt(t))&&xw(i.charCodeAt(t-1))&&t--;let n=Kp(i,t);for(t+=Zb(n);t<i.length;){let s=Kp(i,t);if(n==Bb||s==Bb||e&&mQ(s))t+=Zb(s),n=s;else if(Vb(s)){let r=0,o=t-2;for(;o>=0&&Vb(Kp(i,o));)r++,o-=2;if(r%2==0)break;t+=2}else break}return t}function yQ(i,t,e){for(;t>0;){let n=vw(i,t-2,e);if(n<t)return n;t--}return 0}function Kp(i,t){let e=i.charCodeAt(t);if(!xw(e)||t+1==i.length)return e;let n=i.charCodeAt(t+1);return _w(n)?(e-55296<<10)+(n-56320)+65536:e}function _w(i){return i>=56320&&i<57344}function xw(i){return i>=55296&&i<56320}function Zb(i){return i<65536?1:2}class qt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,n){[t,e]=Ka(this,t,e);let s=[];return this.decompose(0,t,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(e,this.length,s,1),cs.from(s,this.length-(e-t)+n.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=Ka(this,t,e);let n=[];return this.decompose(t,e,n,0),cs.from(n,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),n=this.length-this.scanIdentical(t,-1),s=new _c(this),r=new _c(t);for(let o=e,a=e;;){if(s.next(o),r.next(o),o=0,s.lineBreak!=r.lineBreak||s.done!=r.done||s.value!=r.value)return!1;if(a+=s.value.length,s.done||a>=n)return!0}}iter(t=1){return new _c(this,t)}iterRange(t,e=this.length){return new Sw(this,t,e)}iterLines(t,e){let n;if(t==null)n=this.iter();else{e==null&&(e=this.lines+1);let s=this.line(t).from;n=this.iterRange(s,Math.max(s,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new ww(n)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?qt.empty:t.length<=32?new Te(t):cs.from(Te.split(t,[]))}}class Te extends qt{constructor(t,e=bQ(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,n,s){for(let r=0;;r++){let o=this.text[r],a=s+o.length;if((e?n:a)>=t)return new vQ(s,a,n,o);s=a+1,n++}}decompose(t,e,n,s){let r=t<=0&&e>=this.length?this:new Te(Fb(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(s&1){let o=n.pop(),a=of(r.text,o.text.slice(),0,r.length);if(a.length<=32)n.push(new Te(a,o.length+r.length));else{let l=a.length>>1;n.push(new Te(a.slice(0,l)),new Te(a.slice(l)))}}else n.push(r)}replace(t,e,n){if(!(n instanceof Te))return super.replace(t,e,n);[t,e]=Ka(this,t,e);let s=of(this.text,of(n.text,Fb(this.text,0,t)),e),r=this.length+n.length-(e-t);return s.length<=32?new Te(s,r):cs.from(Te.split(s,[]),r)}sliceString(t,e=this.length,n=`
`){[t,e]=Ka(this,t,e);let s="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let a=this.text[o],l=r+a.length;r>t&&o&&(s+=n),t<l&&e>r&&(s+=a.slice(Math.max(0,t-r),e-r)),r=l+1}return s}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let n=[],s=-1;for(let r of t)n.push(r),s+=r.length+1,n.length==32&&(e.push(new Te(n,s)),n=[],s=-1);return s>-1&&e.push(new Te(n,s)),e}}class cs extends qt{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let n of t)this.lines+=n.lines}lineInner(t,e,n,s){for(let r=0;;r++){let o=this.children[r],a=s+o.length,l=n+o.lines-1;if((e?l:a)>=t)return o.lineInner(t,e,n,s);s=a+1,n=l+1}}decompose(t,e,n,s){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let a=this.children[r],l=o+a.length;if(t<=l&&e>=o){let c=s&((o<=t?1:0)|(l>=e?2:0));o>=t&&l<=e&&!c?n.push(a):a.decompose(t-o,e-o,n,c)}o=l+1}}replace(t,e,n){if([t,e]=Ka(this,t,e),n.lines<this.lines)for(let s=0,r=0;s<this.children.length;s++){let o=this.children[s],a=r+o.length;if(t>=r&&e<=a){let l=o.replace(t-r,e-r,n),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let h=this.children.slice();return h[s]=l,new cs(h,this.length-(e-t)+n.length)}return super.replace(r,a,l)}r=a+1}return super.replace(t,e,n)}sliceString(t,e=this.length,n=`
`){[t,e]=Ka(this,t,e);let s="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let a=this.children[r],l=o+a.length;o>t&&r&&(s+=n),t<l&&e>o&&(s+=a.sliceString(t-o,e-o,n)),o=l+1}return s}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof cs))return 0;let n=0,[s,r,o,a]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;s+=e,r+=e){if(s==o||r==a)return n;let l=this.children[s],c=t.children[r];if(l!=c)return n+l.scanIdentical(c,e);n+=l.length+1}}static from(t,e=t.reduce((n,s)=>n+s.length+1,-1)){let n=0;for(let d of t)n+=d.lines;if(n<32){let d=[];for(let p of t)p.flatten(d);return new Te(d,e)}let s=Math.max(32,n>>5),r=s<<1,o=s>>1,a=[],l=0,c=-1,h=[];function u(d){let p;if(d.lines>r&&d instanceof cs)for(let g of d.children)u(g);else d.lines>o&&(l>o||!l)?(f(),a.push(d)):d instanceof Te&&l&&(p=h[h.length-1])instanceof Te&&d.lines+p.lines<=32?(l+=d.lines,c+=d.length+1,h[h.length-1]=new Te(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>s&&f(),l+=d.lines,c+=d.length+1,h.push(d))}function f(){l!=0&&(a.push(h.length==1?h[0]:cs.from(h,c)),c=-1,l=h.length=0)}for(let d of t)u(d);return f(),a.length==1?a[0]:new cs(a,e)}}qt.empty=new Te([""],0);function bQ(i){let t=-1;for(let e of i)t+=e.length+1;return t}function of(i,t,e=0,n=1e9){for(let s=0,r=0,o=!0;r<i.length&&s<=n;r++){let a=i[r],l=s+a.length;l>=e&&(l>n&&(a=a.slice(0,n-s)),s<e&&(a=a.slice(e-s)),o?(t[t.length-1]+=a,o=!1):t.push(a)),s=l+1}return t}function Fb(i,t,e){return of(i,[""],t,e)}class _c{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Te?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],r=this.offsets[n],o=r>>1,a=s instanceof Te?s.text.length:s.children.length;if(o==(e>0?a:0)){if(n==0)return this.done=!0,this.value="",this;e>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(e>0?0:1)){if(this.offsets[n]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(s instanceof Te){let l=s.text[o+(e<0?-1:0)];if(this.offsets[n]+=e,l.length>Math.max(0,t))return this.value=t==0?l:e>0?l.slice(t):l.slice(0,l.length-t),this;t-=l.length}else{let l=s.children[o+(e<0?-1:0)];t>l.length?(t-=l.length,this.offsets[n]+=e):(e<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(e>0?1:(l instanceof Te?l.text.length:l.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class Sw{constructor(t,e,n){this.value="",this.done=!1,this.cursor=new _c(t,e>n?-1:1),this.pos=e>n?t.length:0,this.from=Math.min(e,n),this.to=Math.max(e,n)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let n=e<0?this.pos-this.from:this.to-this.pos;t>n&&(t=n),n-=t;let{value:s}=this.cursor.next(t);return this.pos+=(s.length+t)*e,this.value=s.length<=n?s:e<0?s.slice(s.length-n):s.slice(0,n),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class ww{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:n,value:s}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(qt.prototype[Symbol.iterator]=function(){return this.iter()},_c.prototype[Symbol.iterator]=Sw.prototype[Symbol.iterator]=ww.prototype[Symbol.iterator]=function(){return this});class vQ{constructor(t,e,n,s){this.from=t,this.to=e,this.number=n,this.text=s}get length(){return this.to-this.from}}function Ka(i,t,e){return t=Math.max(0,Math.min(i.length,t)),[t,Math.max(t,Math.min(i.length,e))]}function si(i,t,e=!0,n=!0){return OQ(i,t,e,n)}function _Q(i){return i>=56320&&i<57344}function xQ(i){return i>=55296&&i<56320}function Bi(i,t){let e=i.charCodeAt(t);if(!xQ(e)||t+1==i.length)return e;let n=i.charCodeAt(t+1);return _Q(n)?(e-55296<<10)+(n-56320)+65536:e}function FO(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function hs(i){return i<65536?1:2}const wm=/\r\n?|\n/;var ni=(function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i})(ni||(ni={}));class bs{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let n=this.sections[e+1];t+=n<0?this.sections[e]:n}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,n=0,s=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(n,s,r),s+=r):s+=o,n+=r}}iterChangedRanges(t,e=!1){km(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let n=this.sections[e++],s=this.sections[e++];s<0?t.push(n,s):t.push(s,n)}return new bs(t)}composeDesc(t){return this.empty?t:t.empty?this:kw(this,t)}mapDesc(t,e=!1){return t.empty?this:Cm(this,t,e)}mapPos(t,e=-1,n=ni.Simple){let s=0,r=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],c=s+a;if(l<0){if(c>t)return r+(t-s);r+=a}else{if(n!=ni.Simple&&c>=t&&(n==ni.TrackDel&&s<t&&c>t||n==ni.TrackBefore&&s<t||n==ni.TrackAfter&&c>t))return null;if(c>t||c==t&&e<0&&!a)return t==s||e<0?r:r+l;r+=l}s=c}if(t>s)throw new RangeError(`Position ${t} is out of range for changeset of length ${s}`);return r}touchesRange(t,e=t){for(let n=0,s=0;n<this.sections.length&&s<=e;){let r=this.sections[n++],o=this.sections[n++],a=s+r;if(o>=0&&s<=e&&a>=t)return s<t&&a>e?"cover":!0;s=a}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let n=this.sections[e++],s=this.sections[e++];t+=(t?" ":"")+n+(s>=0?":"+s:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bs(t)}static create(t){return new bs(t)}}class Ze extends bs{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return km(this,(e,n,s,r,o)=>t=t.replace(s,s+(n-e),o),!1),t}mapDesc(t,e=!1){return Cm(this,t,e,!0)}invert(t){let e=this.sections.slice(),n=[];for(let s=0,r=0;s<e.length;s+=2){let o=e[s],a=e[s+1];if(a>=0){e[s]=a,e[s+1]=o;let l=s>>1;for(;n.length<l;)n.push(qt.empty);n.push(o?t.slice(r,r+o):qt.empty)}r+=o}return new Ze(e,n)}compose(t){return this.empty?t:t.empty?this:kw(this,t,!0)}map(t,e=!1){return t.empty?this:Cm(this,t,e,!0)}iterChanges(t,e=!1){km(this,t,e)}get desc(){return bs.create(this.sections)}filter(t){let e=[],n=[],s=[],r=new Bc(this);t:for(let o=0,a=0;;){let l=o==t.length?1e9:t[o++];for(;a<l||a==l&&r.len==0;){if(r.done)break t;let h=Math.min(r.len,l-a);ai(s,h,-1);let u=r.ins==-1?-1:r.off==0?r.ins:0;ai(e,h,u),u>0&&Pr(n,e,r.text),r.forward(h),a+=h}let c=t[o++];for(;a<c;){if(r.done)break t;let h=Math.min(r.len,c-a);ai(e,h,-1),ai(s,h,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(h),a+=h}}return{changes:new Ze(e,n),filtered:bs.create(s)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let n=this.sections[e],s=this.sections[e+1];s<0?t.push(n):s==0?t.push([n]):t.push([n].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,n){let s=[],r=[],o=0,a=null;function l(h=!1){if(!h&&!s.length)return;o<e&&ai(s,e-o,-1);let u=new Ze(s,r);a=a?a.compose(u.map(a)):u,s=[],r=[],o=0}function c(h){if(Array.isArray(h))for(let u of h)c(u);else if(h instanceof Ze){if(h.length!=e)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${e})`);l(),a=a?a.compose(h.map(a)):h}else{let{from:u,to:f=u,insert:d}=h;if(u>f||u<0||f>e)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${e})`);let p=d?typeof d=="string"?qt.of(d.split(n||wm)):d:qt.empty,g=p.length;if(u==f&&g==0)return;u<o&&l(),u>o&&ai(s,u-o,-1),ai(s,f-u,g),Pr(r,s,p),o=f}}return c(t),l(!a),a}static empty(t){return new Ze(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],n=[];for(let s=0;s<t.length;s++){let r=t[s];if(typeof r=="number")e.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)e.push(r[0],0);else{for(;n.length<s;)n.push(qt.empty);n[s]=qt.of(r.slice(1)),e.push(r[0],n[s].length)}}}return new Ze(e,n)}static createSet(t,e){return new Ze(t,e)}}function ai(i,t,e,n=!1){if(t==0&&e<=0)return;let s=i.length-2;s>=0&&e<=0&&e==i[s+1]?i[s]+=t:s>=0&&t==0&&i[s]==0?i[s+1]+=e:n?(i[s]+=t,i[s+1]+=e):i.push(t,e)}function Pr(i,t,e){if(e.length==0)return;let n=t.length-2>>1;if(n<i.length)i[i.length-1]=i[i.length-1].append(e);else{for(;i.length<n;)i.push(qt.empty);i.push(e)}}function km(i,t,e){let n=i.inserted;for(let s=0,r=0,o=0;o<i.sections.length;){let a=i.sections[o++],l=i.sections[o++];if(l<0)s+=a,r+=a;else{let c=s,h=r,u=qt.empty;for(;c+=a,h+=l,l&&n&&(u=u.append(n[o-2>>1])),!(e||o==i.sections.length||i.sections[o+1]<0);)a=i.sections[o++],l=i.sections[o++];t(s,c,r,h,u),s=c,r=h}}}function Cm(i,t,e,n=!1){let s=[],r=n?[]:null,o=new Bc(i),a=new Bc(t);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let c=Math.min(o.len,a.len);ai(s,c,-1),o.forward(c),a.forward(c)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!e))){let c=a.len;for(ai(s,a.ins,-1);c;){let h=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=h&&(ai(s,0,o.ins),r&&Pr(r,s,o.text),l=o.i),o.forward(h),c-=h}a.next()}else if(o.ins>=0){let c=0,h=o.len;for(;h;)if(a.ins==-1){let u=Math.min(h,a.len);c+=u,h-=u,a.forward(u)}else if(a.ins==0&&a.len<h)h-=a.len,a.next();else break;ai(s,c,l<o.i?o.ins:0),r&&l<o.i&&Pr(r,s,o.text),l=o.i,o.forward(o.len-h)}else{if(o.done&&a.done)return r?Ze.createSet(s,r):bs.create(s);throw new Error("Mismatched change set lengths")}}}function kw(i,t,e=!1){let n=[],s=e?[]:null,r=new Bc(i),o=new Bc(t);for(let a=!1;;){if(r.done&&o.done)return s?Ze.createSet(n,s):bs.create(n);if(r.ins==0)ai(n,r.len,0,a),r.next();else if(o.len==0&&!o.done)ai(n,0,o.ins,a),s&&Pr(s,n,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(r.len2,o.len),c=n.length;if(r.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;ai(n,l,h,a),s&&h&&Pr(s,n,o.text)}else o.ins==-1?(ai(n,r.off?0:r.len,l,a),s&&Pr(s,n,r.textBit(l))):(ai(n,r.off?0:r.len,o.off?0:o.ins,a),s&&!o.off&&Pr(s,n,o.text));a=(r.ins>l||o.ins>=0&&o.len>l)&&(a||n.length>c),r.forward2(l),o.forward(l)}}}}class Bc{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?qt.empty:t[e]}textBit(t){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length&&!t?qt.empty:e[n].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class xo{constructor(t,e,n){this.from=t,this.to=e,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let n,s;return this.empty?n=s=t.mapPos(this.from,e):(n=t.mapPos(this.from,1),s=t.mapPos(this.to,-1)),n==this.from&&s==this.to?this:new xo(n,s,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return H.range(t,e);let n=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return H.range(this.anchor,n)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return H.range(t.anchor,t.head)}static create(t,e,n){return new xo(t,e,n)}}class H{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:H.create(this.ranges.map(n=>n.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(t.ranges[n],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new H([this.main],0)}addRange(t,e=!0){return H.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let n=this.ranges.slice();return n[e]=t,H.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new H(t.ranges.map(e=>xo.fromJSON(e)),t.main)}static single(t,e=t){return new H([H.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,s=0;s<t.length;s++){let r=t[s];if(r.empty?r.from<=n:r.from<n)return H.normalized(t.slice(),e);n=r.to}return new H(t,e)}static cursor(t,e=0,n,s){return xo.create(t,t,(e==0?0:e<0?8:16)|(n==null?7:Math.min(6,n))|(s??16777215)<<6)}static range(t,e,n,s){let r=(n??16777215)<<6|(s==null?7:Math.min(6,s));return e<t?xo.create(e,t,48|r):xo.create(t,e,(e>t?8:0)|r)}static normalized(t,e=0){let n=t[e];t.sort((s,r)=>s.from-r.from),e=t.indexOf(n);for(let s=1;s<t.length;s++){let r=t[s],o=t[s-1];if(r.empty?r.from<=o.to:r.from<o.to){let a=o.from,l=Math.max(r.to,o.to);s<=e&&e--,t.splice(--s,2,r.anchor>r.head?H.range(l,a):H.range(a,l))}}return new H(t,e)}}function Cw(i,t){for(let e of i.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let WO=0;class ut{constructor(t,e,n,s,r){this.combine=t,this.compareInput=e,this.compare=n,this.isStatic=s,this.id=WO++,this.default=t([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(t={}){return new ut(t.combine||(e=>e),t.compareInput||((e,n)=>e===n),t.compare||(t.combine?(e,n)=>e===n:qO),!!t.static,t.enables)}of(t){return new af([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new af(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new af(t,this,2,e)}from(t,e){return e||(e=n=>n),this.compute([t],n=>e(n.field(t)))}}function qO(i,t){return i==t||i.length==t.length&&i.every((e,n)=>e===t[n])}class af{constructor(t,e,n,s){this.dependencies=t,this.facet=e,this.type=n,this.value=s,this.id=WO++}dynamicSlot(t){var e;let n=this.value,s=this.facet.compareInput,r=this.id,o=t[r]>>1,a=this.type==2,l=!1,c=!1,h=[];for(let u of this.dependencies)u=="doc"?l=!0:u=="selection"?c=!0:(((e=t[u.id])!==null&&e!==void 0?e:1)&1)==0&&h.push(t[u.id]);return{create(u){return u.values[o]=n(u),1},update(u,f){if(l&&f.docChanged||c&&(f.docChanged||f.selection)||Tm(u,h)){let d=n(u);if(a?!Wb(d,u.values[o],s):!s(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,f)=>{let d,p=f.config.address[r];if(p!=null){let g=zf(f,p);if(this.dependencies.every(m=>m instanceof ut?f.facet(m)===u.facet(m):m instanceof Ke?f.field(m,!1)==u.field(m,!1):!0)||(a?Wb(d=n(u),g,s):s(d=n(u),g)))return u.values[o]=g,0}else d=n(u);return u.values[o]=d,1}}}}function Wb(i,t,e){if(i.length!=t.length)return!1;for(let n=0;n<i.length;n++)if(!e(i[n],t[n]))return!1;return!0}function Tm(i,t){let e=!1;for(let n of t)xc(i,n)&1&&(e=!0);return e}function SQ(i,t,e){let n=e.map(l=>i[l.id]),s=e.map(l=>l.type),r=n.filter(l=>!(l&1)),o=i[t.id]>>1;function a(l){let c=[];for(let h=0;h<n.length;h++){let u=zf(l,n[h]);if(s[h]==2)for(let f of u)c.push(f);else c.push(u)}return t.combine(c)}return{create(l){for(let c of n)xc(l,c);return l.values[o]=a(l),1},update(l,c){if(!Tm(l,r))return 0;let h=a(l);return t.compare(h,l.values[o])?0:(l.values[o]=h,1)},reconfigure(l,c){let h=Tm(l,n),u=c.config.facets[t.id],f=c.facet(t);if(u&&!h&&qO(e,u))return l.values[o]=f,0;let d=a(l);return t.compare(d,f)?(l.values[o]=f,0):(l.values[o]=d,1)}}}const ku=ut.define({static:!0});class Ke{constructor(t,e,n,s,r){this.id=t,this.createF=e,this.updateF=n,this.compareF=s,this.spec=r,this.provides=void 0}static define(t){let e=new Ke(WO++,t.create,t.update,t.compare||((n,s)=>n===s),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(ku).find(n=>n.field==this);return(e?.create||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:n=>(n.values[e]=this.create(n),1),update:(n,s)=>{let r=n.values[e],o=this.updateF(r,s);return this.compareF(r,o)?0:(n.values[e]=o,1)},reconfigure:(n,s)=>{let r=n.facet(ku),o=s.facet(ku),a;return(a=r.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(n.values[e]=a.create(n),1):s.config.address[this.id]!=null?(n.values[e]=s.field(this),0):(n.values[e]=this.create(n),1)}}}init(t){return[this,ku.of({field:this,create:t})]}get extension(){return this}}const go={lowest:4,low:3,default:2,high:1,highest:0};function Wl(i){return t=>new Tw(t,i)}const io={highest:Wl(go.highest),high:Wl(go.high),default:Wl(go.default),low:Wl(go.low),lowest:Wl(go.lowest)};class Tw{constructor(t,e){this.inner=t,this.prec=e}}class Th{of(t){return new Pm(this,t)}reconfigure(t){return Th.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class Pm{constructor(t,e){this.compartment=t,this.inner=e}}class Xf{constructor(t,e,n,s,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=n,this.address=s,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,n){let s=[],r=Object.create(null),o=new Map;for(let f of wQ(t,e,o))f instanceof Ke?s.push(f):(r[f.facet.id]||(r[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],c=[];for(let f of s)a[f.id]=c.length<<1,c.push(d=>f.slot(d));let h=n?.config.facets;for(let f in r){let d=r[f],p=d[0].facet,g=h&&h[f]||[];if(d.every(m=>m.type==0))if(a[p.id]=l.length<<1|1,qO(g,d))l.push(n.facet(p));else{let m=p.combine(d.map(O=>O.value));l.push(n&&p.compare(m,n.facet(p))?n.facet(p):m)}else{for(let m of d)m.type==0?(a[m.id]=l.length<<1|1,l.push(m.value)):(a[m.id]=c.length<<1,c.push(O=>m.dynamicSlot(O)));a[p.id]=c.length<<1,c.push(m=>SQ(m,p,d))}}let u=c.map(f=>f(a));return new Xf(t,o,u,a,l,r)}}function wQ(i,t,e){let n=[[],[],[],[],[]],s=new Map;function r(o,a){let l=s.get(o);if(l!=null){if(l<=a)return;let c=n[l].indexOf(o);c>-1&&n[l].splice(c,1),o instanceof Pm&&e.delete(o.compartment)}if(s.set(o,a),Array.isArray(o))for(let c of o)r(c,a);else if(o instanceof Pm){if(e.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(o.compartment)||o.inner;e.set(o.compartment,c),r(c,a)}else if(o instanceof Tw)r(o.inner,o.prec);else if(o instanceof Ke)n[a].push(o),o.provides&&r(o.provides,a);else if(o instanceof af)n[a].push(o),o.facet.extensions&&r(o.facet.extensions,go.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(c,a)}}return r(i,go.default),n.reduce((o,a)=>o.concat(a))}function xc(i,t){if(t&1)return 2;let e=t>>1,n=i.status[e];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;i.status[e]=4;let s=i.computeSlot(i,i.config.dynamicSlots[e]);return i.status[e]=2|s}function zf(i,t){return t&1?i.config.staticValues[t>>1]:i.values[t>>1]}const Pw=ut.define(),Am=ut.define({combine:i=>i.some(t=>t),static:!0}),Aw=ut.define({combine:i=>i.length?i[0]:void 0,static:!0}),Mw=ut.define(),Ew=ut.define(),Rw=ut.define(),Iw=ut.define({combine:i=>i.length?i[0]:!1});class hr{constructor(t,e){this.type=t,this.value=e}static define(){return new kQ}}class kQ{of(t){return new hr(this,t)}}class CQ{constructor(t){this.map=t}of(t){return new Ct(this,t)}}class Ct{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new Ct(this.type,e)}is(t){return this.type==t}static define(t={}){return new CQ(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let n=[];for(let s of t){let r=s.map(e);r&&n.push(r)}return n}}Ct.reconfigure=Ct.define();Ct.appendConfig=Ct.define();class $e{constructor(t,e,n,s,r,o){this.startState=t,this.changes=e,this.selection=n,this.effects=s,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,n&&Cw(n,e.newLength),r.some(a=>a.type==$e.time)||(this.annotations=r.concat($e.time.of(Date.now())))}static create(t,e,n,s,r,o){return new $e(t,e,n,s,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation($e.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}$e.time=hr.define();$e.userEvent=hr.define();$e.addToHistory=hr.define();$e.remote=hr.define();function TQ(i,t){let e=[];for(let n=0,s=0;;){let r,o;if(n<i.length&&(s==t.length||t[s]>=i[n]))r=i[n++],o=i[n++];else if(s<t.length)r=t[s++],o=t[s++];else return e;!e.length||e[e.length-1]<r?e.push(r,o):e[e.length-1]<o&&(e[e.length-1]=o)}}function Qw(i,t,e){var n;let s,r,o;return e?(s=t.changes,r=Ze.empty(t.changes.length),o=i.changes.compose(t.changes)):(s=t.changes.map(i.changes),r=i.changes.mapDesc(t.changes,!0),o=i.changes.compose(s)),{changes:o,selection:t.selection?t.selection.map(r):(n=i.selection)===null||n===void 0?void 0:n.map(s),effects:Ct.mapEffects(i.effects,s).concat(Ct.mapEffects(t.effects,r)),annotations:i.annotations.length?i.annotations.concat(t.annotations):t.annotations,scrollIntoView:i.scrollIntoView||t.scrollIntoView}}function Mm(i,t,e){let n=t.selection,s=Ea(t.annotations);return t.userEvent&&(s=s.concat($e.userEvent.of(t.userEvent))),{changes:t.changes instanceof Ze?t.changes:Ze.of(t.changes||[],e,i.facet(Aw)),selection:n&&(n instanceof H?n:H.single(n.anchor,n.head)),effects:Ea(t.effects),annotations:s,scrollIntoView:!!t.scrollIntoView}}function Nw(i,t,e){let n=Mm(i,t.length?t[0]:{},i.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let r=1;r<t.length;r++){t[r].filter===!1&&(e=!1);let o=!!t[r].sequential;n=Qw(n,Mm(i,t[r],o?n.changes.newLength:i.doc.length),o)}let s=$e.create(i,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return AQ(e?PQ(s):s)}function PQ(i){let t=i.startState,e=!0;for(let s of t.facet(Mw)){let r=s(i);if(r===!1){e=!1;break}Array.isArray(r)&&(e=e===!0?r:TQ(e,r))}if(e!==!0){let s,r;if(e===!1)r=i.changes.invertedDesc,s=Ze.empty(t.doc.length);else{let o=i.changes.filter(e);s=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}i=$e.create(t,s,i.selection&&i.selection.map(r),Ct.mapEffects(i.effects,r),i.annotations,i.scrollIntoView)}let n=t.facet(Ew);for(let s=n.length-1;s>=0;s--){let r=n[s](i);r instanceof $e?i=r:Array.isArray(r)&&r.length==1&&r[0]instanceof $e?i=r[0]:i=Nw(t,Ea(r),!1)}return i}function AQ(i){let t=i.startState,e=t.facet(Rw),n=i;for(let s=e.length-1;s>=0;s--){let r=e[s](i);r&&Object.keys(r).length&&(n=Qw(n,Mm(t,r,i.changes.newLength),!0))}return n==i?i:$e.create(t,i.changes,i.selection,n.effects,n.annotations,n.scrollIntoView)}const MQ=[];function Ea(i){return i==null?MQ:Array.isArray(i)?i:[i]}var _e=(function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i})(_e||(_e={}));const EQ=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Em;try{Em=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function RQ(i){if(Em)return Em.test(i);for(let t=0;t<i.length;t++){let e=i[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||EQ.test(e)))return!0}return!1}function IQ(i){return t=>{if(!/\S/.test(t))return _e.Space;if(RQ(t))return _e.Word;for(let e=0;e<i.length;e++)if(t.indexOf(i[e])>-1)return _e.Word;return _e.Other}}class Vt{constructor(t,e,n,s,r,o){this.config=t,this.doc=e,this.selection=n,this.values=s,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)xc(this,a<<1);this.computeSlot=null}field(t,e=!0){let n=this.config.address[t.id];if(n==null){if(e)throw new RangeError("Field is not present in this state");return}return xc(this,n),zf(this,n)}update(...t){return Nw(this,t,!0)}applyTransaction(t){let e=this.config,{base:n,compartments:s}=e;for(let a of t.effects)a.is(Th.reconfigure)?(e&&(s=new Map,e.compartments.forEach((l,c)=>s.set(c,l)),e=null),s.set(a.value.compartment,a.value.extension)):a.is(Ct.reconfigure)?(e=null,n=a.value):a.is(Ct.appendConfig)&&(e=null,n=Ea(n).concat(a.value));let r;e?r=t.startState.values.slice():(e=Xf.resolve(n,s,this),r=new Vt(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=t.startState.facet(Am)?t.newSelection:t.newSelection.asSingle();new Vt(e,t.newDoc,o,r,(a,l)=>l.update(a,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:H.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,n=t(e.ranges[0]),s=this.changes(n.changes),r=[n.range],o=Ea(n.effects);for(let a=1;a<e.ranges.length;a++){let l=t(e.ranges[a]),c=this.changes(l.changes),h=c.map(s);for(let f=0;f<a;f++)r[f]=r[f].map(h);let u=s.mapDesc(c,!0);r.push(l.range.map(u)),s=s.compose(h),o=Ct.mapEffects(o,h).concat(Ct.mapEffects(Ea(l.effects),u))}return{changes:s,selection:H.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof Ze?t:Ze.of(t,this.doc.length,this.facet(Vt.lineSeparator))}toText(t){return qt.of(t.split(this.facet(Vt.lineSeparator)||wm))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(xc(this,e),zf(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let n in t){let s=t[n];s instanceof Ke&&this.config.address[s.id]!=null&&(e[n]=s.spec.toJSON(this.field(t[n]),this))}return e}static fromJSON(t,e={},n){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(n){for(let r in n)if(Object.prototype.hasOwnProperty.call(t,r)){let o=n[r],a=t[r];s.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Vt.create({doc:t.doc,selection:H.fromJSON(t.selection),extensions:e.extensions?s.concat([e.extensions]):s})}static create(t={}){let e=Xf.resolve(t.extensions||[],new Map),n=t.doc instanceof qt?t.doc:qt.of((t.doc||"").split(e.staticFacet(Vt.lineSeparator)||wm)),s=t.selection?t.selection instanceof H?t.selection:H.single(t.selection.anchor,t.selection.head):H.single(0);return Cw(s,n.length),e.staticFacet(Am)||(s=s.asSingle()),new Vt(e,n,s,e.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(Vt.tabSize)}get lineBreak(){return this.facet(Vt.lineSeparator)||`
`}get readOnly(){return this.facet(Iw)}phrase(t,...e){for(let n of this.facet(Vt.phrases))if(Object.prototype.hasOwnProperty.call(n,t)){t=n[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(n,s)=>{if(s=="$")return"$";let r=+(s||1);return!r||r>e.length?n:e[r-1]})),t}languageDataAt(t,e,n=-1){let s=[];for(let r of this.facet(Pw))for(let o of r(this,e,n))Object.prototype.hasOwnProperty.call(o,t)&&s.push(o[t]);return s}charCategorizer(t){return IQ(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:n,length:s}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-n,a=t-n;for(;o>0;){let l=si(e,o,!1);if(r(e.slice(l,o))!=_e.Word)break;o=l}for(;a<s;){let l=si(e,a);if(r(e.slice(a,l))!=_e.Word)break;a=l}return o==a?null:H.range(o+n,a+n)}}Vt.allowMultipleSelections=Am;Vt.tabSize=ut.define({combine:i=>i.length?i[0]:4});Vt.lineSeparator=Aw;Vt.readOnly=Iw;Vt.phrases=ut.define({compare(i,t){let e=Object.keys(i),n=Object.keys(t);return e.length==n.length&&e.every(s=>i[s]==t[s])}});Vt.languageData=Pw;Vt.changeFilter=Mw;Vt.transactionFilter=Ew;Vt.transactionExtender=Rw;Th.reconfigure=Ct.define();function Ms(i,t,e={}){let n={};for(let s of i)for(let r of Object.keys(s)){let o=s[r],a=n[r];if(a===void 0)n[r]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(e,r))n[r]=e[r](a,o);else throw new Error("Config merge conflict for field "+r)}for(let s in t)n[s]===void 0&&(n[s]=t[s]);return n}class Lo{eq(t){return this==t}range(t,e=t){return Rm.create(t,e,this)}}Lo.prototype.startSide=Lo.prototype.endSide=0;Lo.prototype.point=!1;Lo.prototype.mapMode=ni.TrackDel;let Rm=class $w{constructor(t,e,n){this.from=t,this.to=e,this.value=n}static create(t,e,n){return new $w(t,e,n)}};function Im(i,t){return i.from-t.from||i.value.startSide-t.value.startSide}class XO{constructor(t,e,n,s){this.from=t,this.to=e,this.value=n,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(t,e,n,s=0){let r=n?this.to:this.from;for(let o=s,a=r.length;;){if(o==a)return o;let l=o+a>>1,c=r[l]-t||(n?this.value[l].endSide:this.value[l].startSide)-e;if(l==o)return c>=0?o:a;c>=0?a=l:o=l+1}}between(t,e,n,s){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(n,1e9,!1,r);r<o;r++)if(s(this.from[r]+t,this.to[r]+t,this.value[r])===!1)return!1}map(t,e){let n=[],s=[],r=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],h=this.from[l]+t,u=this.to[l]+t,f,d;if(h==u){let p=e.mapPos(h,c.startSide,c.mapMode);if(p==null||(f=d=p,c.startSide!=c.endSide&&(d=e.mapPos(h,c.endSide),d<f)))continue}else if(f=e.mapPos(h,c.startSide),d=e.mapPos(u,c.endSide),f>d||f==d&&c.startSide>0&&c.endSide<=0)continue;(d-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(a=Math.max(a,d-f)),n.push(c),s.push(f-o),r.push(d-o))}return{mapped:n.length?new XO(s,r,n,a):null,pos:o}}}class zt{constructor(t,e,n,s){this.chunkPos=t,this.chunk=e,this.nextLayer=n,this.maxPoint=s}static create(t,e,n,s){return new zt(t,e,n,s)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:n=!1,filterFrom:s=0,filterTo:r=this.length}=t,o=t.filter;if(e.length==0&&!o)return this;if(n&&(e=e.slice().sort(Im)),this.isEmpty)return e.length?zt.of(e):this;let a=new Dw(this,null,-1).goto(0),l=0,c=[],h=new Hs;for(;a.value||l<e.length;)if(l<e.length&&(a.from-e[l].from||a.startSide-e[l].value.startSide)>=0){let u=e[l++];h.addInner(u.from,u.to,u.value)||c.push(u)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(a.chunkIndex)<e[l].from)&&(!o||s>this.chunkEnd(a.chunkIndex)||r<this.chunkPos[a.chunkIndex])&&h.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||s>a.to||r<a.from||o(a.from,a.to,a.value))&&(h.addInner(a.from,a.to,a.value)||c.push(Rm.create(a.from,a.to,a.value))),a.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?zt.empty:this.nextLayer.update({add:c,filter:o,filterFrom:s,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],n=[],s=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],c=t.touchesRange(a,a+l.length);if(c===!1)s=Math.max(s,l.maxPoint),e.push(l),n.push(t.mapPos(a));else if(c===!0){let{mapped:h,pos:u}=l.map(a,t);h&&(s=Math.max(s,h.maxPoint),e.push(h),n.push(u))}}let r=this.nextLayer.map(t);return e.length==0?r:new zt(n,e,r||zt.empty,s)}between(t,e,n){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s];if(e>=r&&t<=r+o.length&&o.between(r,t-r,e-r,n)===!1)return}this.nextLayer.between(t,e,n)}}iter(t=0){return Zc.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Zc.from(t).goto(e)}static compare(t,e,n,s,r=-1){let o=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),a=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),l=qb(o,a,n),c=new ql(o,l,r),h=new ql(a,l,r);n.iterGaps((u,f,d)=>Xb(c,u,h,f,d,s)),n.empty&&n.length==0&&Xb(c,0,h,0,0,s)}static eq(t,e,n=0,s){s==null&&(s=999999999);let r=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0),o=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let a=qb(r,o),l=new ql(r,a,0).goto(n),c=new ql(o,a,0).goto(n);for(;;){if(l.to!=c.to||!Qm(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>s)return!0;l.next(),c.next()}}static spans(t,e,n,s,r=-1){let o=new ql(t,null,r).goto(e),a=e,l=o.openStart;for(;;){let c=Math.min(o.to,n);if(o.point){let h=o.activeForPoint(o.to),u=o.pointFrom<e?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,l);s.point(a,c,o.point,h,u,o.pointRank),l=Math.min(o.openEnd(c),h.length)}else c>a&&(s.span(a,c,o.active,l),l=o.openEnd(c));if(o.to>n)return l+(o.point&&o.to>n?1:0);a=o.to,o.next()}}static of(t,e=!1){let n=new Hs;for(let s of t instanceof Rm?[t]:e?QQ(t):t)n.add(s.from,s.to,s.value);return n.finish()}static join(t){if(!t.length)return zt.empty;let e=t[t.length-1];for(let n=t.length-2;n>=0;n--)for(let s=t[n];s!=zt.empty;s=s.nextLayer)e=new zt(s.chunkPos,s.chunk,e,Math.max(s.maxPoint,e.maxPoint));return e}}zt.empty=new zt([],[],null,-1);function QQ(i){if(i.length>1)for(let t=i[0],e=1;e<i.length;e++){let n=i[e];if(Im(t,n)>0)return i.slice().sort(Im);t=n}return i}zt.empty.nextLayer=zt.empty;class Hs{finishChunk(t){this.chunks.push(new XO(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,n){this.addInner(t,e,n)||(this.nextLayer||(this.nextLayer=new Hs)).add(t,e,n)}addInner(t,e,n){let s=t-this.lastTo||n.startSide-this.last.endSide;if(s<=0&&(t-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=n,this.lastFrom=t,this.lastTo=e,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let n=e.value.length-1;return this.last=e.value[n],this.lastFrom=e.from[n]+t,this.lastTo=e.to[n]+t,!0}finish(){return this.finishInner(zt.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=zt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function qb(i,t,e){let n=new Map;for(let r of i)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&n.set(r.chunk[o],r.chunkPos[o]);let s=new Set;for(let r of t)for(let o=0;o<r.chunk.length;o++){let a=n.get(r.chunk[o]);a!=null&&(e?e.mapPos(a):a)==r.chunkPos[o]&&!e?.touchesRange(a,a+r.chunk[o].length)&&s.add(r.chunk[o])}return s}class Dw{constructor(t,e,n,s=0){this.layer=t,this.skip=e,this.minPoint=n,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,n){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<t||s.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!n||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],n=t+e.from[this.rangeIndex];if(this.from=n,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Zc{constructor(t){this.heap=t}static from(t,e=null,n=-1){let s=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&s.push(new Dw(o,e,n,r));return s.length==1?s[0]:new Zc(s)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let n of this.heap)n.goto(t,e);for(let n=this.heap.length>>1;n>=0;n--)Jp(this.heap,n);return this.next(),this}forward(t,e){for(let n of this.heap)n.forward(t,e);for(let n=this.heap.length>>1;n>=0;n--)Jp(this.heap,n);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Jp(this.heap,0)}}}function Jp(i,t){for(let e=i[t];;){let n=(t<<1)+1;if(n>=i.length)break;let s=i[n];if(n+1<i.length&&s.compare(i[n+1])>=0&&(s=i[n+1],n++),e.compare(s)<0)break;i[n]=e,i[t]=s,t=n}}class ql{constructor(t,e,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Zc.from(t,e,n)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Cu(this.active,t),Cu(this.activeTo,t),Cu(this.activeRank,t),this.minActive=zb(this.active,this.activeTo)}addActive(t){let e=0,{value:n,to:s,rank:r}=this.cursor;for(;e<this.activeRank.length&&(r-this.activeRank[e]||s-this.activeTo[e])>0;)e++;Tu(this.active,e,n),Tu(this.activeTo,e,s),Tu(this.activeRank,e,r),t&&Tu(t,e,this.cursor.from),this.minActive=zb(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>t){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),n&&Cu(n,s)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(n),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let s=n.length-1;s>=0&&n[s]<t;s--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>t||this.activeTo[n]==t&&this.active[n].endSide>=this.point.endSide)&&e.push(this.active[n]);return e.reverse()}openEnd(t){let e=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>t;n--)e++;return e}}function Xb(i,t,e,n,s,r){i.goto(t),e.goto(n);let o=n+s,a=n,l=n-t;for(;;){let c=i.to+l-e.to,h=c||i.endSide-e.endSide,u=h<0?i.to+l:e.to,f=Math.min(u,o);if(i.point||e.point?i.point&&e.point&&(i.point==e.point||i.point.eq(e.point))&&Qm(i.activeForPoint(i.to),e.activeForPoint(e.to))||r.comparePoint(a,f,i.point,e.point):f>a&&!Qm(i.active,e.active)&&r.compareRange(a,f,i.active,e.active),u>o)break;(c||i.openEnd!=e.openEnd)&&r.boundChange&&r.boundChange(u),a=u,h<=0&&i.next(),h>=0&&e.next()}}function Qm(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++)if(i[e]!=t[e]&&!i[e].eq(t[e]))return!1;return!0}function Cu(i,t){for(let e=t,n=i.length-1;e<n;e++)i[e]=i[e+1];i.pop()}function Tu(i,t,e){for(let n=i.length-1;n>=t;n--)i[n+1]=i[n];i[t]=e}function zb(i,t){let e=-1,n=1e9;for(let s=0;s<t.length;s++)(t[s]-n||i[s].endSide-i[e].endSide)<0&&(e=s,n=t[s]);return e}function ml(i,t,e=i.length){let n=0;for(let s=0;s<e&&s<i.length;)i.charCodeAt(s)==9?(n+=t-n%t,s++):(n++,s=si(i,s));return n}function Nm(i,t,e,n){for(let s=0,r=0;;){if(r>=t)return s;if(s==i.length)break;r+=i.charCodeAt(s)==9?e-r%e:1,s=si(i,s)}return n===!0?-1:i.length}const $m="ͼ",Gb=typeof Symbol>"u"?"__"+$m:Symbol.for($m),Dm=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),jb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Wr{constructor(t,e){this.rules=[];let{finish:n}=e||{};function s(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,a,l,c){let h=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&a==null)return l.push(o[0]+";");for(let d in a){let p=a[d];if(/&/.test(d))r(d.split(/,\s*/).map(g=>o.map(m=>g.replace(/&/,m))).reduce((g,m)=>g.concat(m)),p,l);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+d+") should be a primitive value.");r(s(d),p,h,f)}else p!=null&&h.push(d.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+p+";")}(h.length||f)&&l.push((n&&!u&&!c?o.map(n):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in t)r(s(o),t[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=jb[Gb]||1;return jb[Gb]=t+1,$m+t.toString(36)}static mount(t,e,n){let s=t[Dm],r=n&&n.nonce;s?r&&s.setNonce(r):s=new NQ(t,r),s.mount(Array.isArray(e)?e:[e],t)}}let Ub=new Map;class NQ{constructor(t,e){let n=t.ownerDocument||t,s=n.defaultView;if(!t.head&&t.adoptedStyleSheets&&s.CSSStyleSheet){let r=Ub.get(n);if(r)return t[Dm]=r;this.sheet=new s.CSSStyleSheet,Ub.set(n,this)}else this.styleTag=n.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[Dm]=this}mount(t,e){let n=this.sheet,s=0,r=0;for(let o=0;o<t.length;o++){let a=t[o],l=this.modules.indexOf(a);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,a),n)for(let c=0;c<a.rules.length;c++)n.insertRule(a.rules[c],s++)}else{for(;r<l;)s+=this.modules[r++].rules.length;s+=a.rules.length,r++}}if(n)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=e.head||e;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var qr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Fc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},$Q=typeof navigator<"u"&&/Mac/.test(navigator.platform),DQ=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var ii=0;ii<10;ii++)qr[48+ii]=qr[96+ii]=String(ii);for(var ii=1;ii<=24;ii++)qr[ii+111]="F"+ii;for(var ii=65;ii<=90;ii++)qr[ii]=String.fromCharCode(ii+32),Fc[ii]=String.fromCharCode(ii);for(var tg in qr)Fc.hasOwnProperty(tg)||(Fc[tg]=qr[tg]);function LQ(i){var t=$Q&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||DQ&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",e=!t&&i.key||(i.shiftKey?Fc:qr)[i.keyCode]||i.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function ee(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var s=e[n];typeof s=="string"?i.setAttribute(n,s):s!=null&&(i[n]=s)}t++}for(;t<arguments.length;t++)Lw(i,arguments[t]);return i}function Lw(i,t){if(typeof t=="string")i.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)i.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)Lw(i,t[e]);else throw new RangeError("Unsupported child node: "+t)}let Si=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Lm=typeof document<"u"?document:{documentElement:{style:{}}};const Vm=/Edge\/(\d+)/.exec(Si.userAgent),Vw=/MSIE \d/.test(Si.userAgent),Bm=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Si.userAgent),op=!!(Vw||Bm||Vm),Yb=!op&&/gecko\/(\d+)/i.test(Si.userAgent),eg=!op&&/Chrome\/(\d+)/.exec(Si.userAgent),VQ="webkitFontSmoothing"in Lm.documentElement.style,Zm=!op&&/Apple Computer/.test(Si.vendor),Hb=Zm&&(/Mobile\/\w+/.test(Si.userAgent)||Si.maxTouchPoints>2);var ht={mac:Hb||/Mac/.test(Si.platform),windows:/Win/.test(Si.platform),linux:/Linux|X11/.test(Si.platform),ie:op,ie_version:Vw?Lm.documentMode||6:Bm?+Bm[1]:Vm?+Vm[1]:0,gecko:Yb,gecko_version:Yb?+(/Firefox\/(\d+)/.exec(Si.userAgent)||[0,0])[1]:0,chrome:!!eg,chrome_version:eg?+eg[1]:0,ios:Hb,android:/Android\b/.test(Si.userAgent),webkit_version:VQ?+(/\bAppleWebKit\/(\d+)/.exec(Si.userAgent)||[0,0])[1]:0,safari:Zm,safari_version:Zm?+(/\bVersion\/(\d+(\.\d+)?)/.exec(Si.userAgent)||[0,0])[1]:0,tabSize:Lm.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Wc(i){let t;return i.nodeType==11?t=i.getSelection?i:i.ownerDocument:t=i,t.getSelection()}function Fm(i,t){return t?i==t||i.contains(t.nodeType!=1?t.parentNode:t):!1}function lf(i,t){if(!t.anchorNode)return!1;try{return Fm(i,t.anchorNode)}catch{return!1}}function Ja(i){return i.nodeType==3?Bo(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function Sc(i,t,e,n){return e?Kb(i,t,e,n,-1)||Kb(i,t,e,n,1):!1}function Vo(i){for(var t=0;;t++)if(i=i.previousSibling,!i)return t}function Gf(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function Kb(i,t,e,n,s){for(;;){if(i==e&&t==n)return!0;if(t==(s<0?0:ws(i))){if(i.nodeName=="DIV")return!1;let r=i.parentNode;if(!r||r.nodeType!=1)return!1;t=Vo(i)+(s<0?0:1),i=r}else if(i.nodeType==1){if(i=i.childNodes[t+(s<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;t=s<0?ws(i):0}else return!1}}function ws(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function Ph(i,t){let e=t?i.left:i.right;return{left:e,right:e,top:i.top,bottom:i.bottom}}function BQ(i){let t=i.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function Bw(i,t){let e=t.width/i.offsetWidth,n=t.height/i.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-i.offsetWidth)<1)&&(e=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(t.height-i.offsetHeight)<1)&&(n=1),{scaleX:e,scaleY:n}}function ZQ(i,t,e,n,s,r,o,a){let l=i.ownerDocument,c=l.defaultView||window;for(let h=i,u=!1;h&&!u;)if(h.nodeType==1){let f,d=h==l.body,p=1,g=1;if(d)f=BQ(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let y=h.getBoundingClientRect();({scaleX:p,scaleY:g}=Bw(h,y)),f={left:y.left,right:y.left+h.clientWidth*p,top:y.top,bottom:y.top+h.clientHeight*g}}let m=0,O=0;if(s=="nearest")t.top<f.top?(O=t.top-(f.top+o),e>0&&t.bottom>f.bottom+O&&(O=t.bottom-f.bottom+o)):t.bottom>f.bottom&&(O=t.bottom-f.bottom+o,e<0&&t.top-O<f.top&&(O=t.top-(f.top+o)));else{let y=t.bottom-t.top,_=f.bottom-f.top;O=(s=="center"&&y<=_?t.top+y/2-_/2:s=="start"||s=="center"&&e<0?t.top-o:t.bottom-_+o)-f.top}if(n=="nearest"?t.left<f.left?(m=t.left-(f.left+r),e>0&&t.right>f.right+m&&(m=t.right-f.right+r)):t.right>f.right&&(m=t.right-f.right+r,e<0&&t.left<f.left+m&&(m=t.left-(f.left+r))):m=(n=="center"?t.left+(t.right-t.left)/2-(f.right-f.left)/2:n=="start"==a?t.left-r:t.right-(f.right-f.left)+r)-f.left,m||O)if(d)c.scrollBy(m,O);else{let y=0,_=0;if(O){let v=h.scrollTop;h.scrollTop+=O/g,_=(h.scrollTop-v)*g}if(m){let v=h.scrollLeft;h.scrollLeft+=m/p,y=(h.scrollLeft-v)*p}t={left:t.left-y,top:t.top-_,right:t.right-y,bottom:t.bottom-_},y&&Math.abs(y-m)<1&&(n="nearest"),_&&Math.abs(_-O)<1&&(s="nearest")}if(d)break;(t.top<f.top||t.bottom>f.bottom||t.left<f.left||t.right>f.right)&&(t={left:Math.max(t.left,f.left),right:Math.min(t.right,f.right),top:Math.max(t.top,f.top),bottom:Math.min(t.bottom,f.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function FQ(i){let t=i.ownerDocument,e,n;for(let s=i.parentNode;s&&!(s==t.body||e&&n);)if(s.nodeType==1)!n&&s.scrollHeight>s.clientHeight&&(n=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:e,y:n}}class WQ{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:n}=t;this.set(e,Math.min(t.anchorOffset,e?ws(e):0),n,Math.min(t.focusOffset,n?ws(n):0))}set(t,e,n,s){this.anchorNode=t,this.anchorOffset=e,this.focusNode=n,this.focusOffset=s}}let po=null;ht.safari&&ht.safari_version>=26&&(po=!1);function Zw(i){if(i.setActive)return i.setActive();if(po)return i.focus(po);let t=[];for(let e=i;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(i.focus(po==null?{get preventScroll(){return po={preventScroll:!0},!0}}:void 0),!po){po=!1;for(let e=0;e<t.length;){let n=t[e++],s=t[e++],r=t[e++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=r&&(n.scrollLeft=r)}}}let Jb;function Bo(i,t,e=t){let n=Jb||(Jb=document.createRange());return n.setEnd(i,e),n.setStart(i,t),n}function Ra(i,t,e,n){let s={key:t,code:t,keyCode:e,which:e,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let r=new KeyboardEvent("keydown",s);r.synthetic=!0,i.dispatchEvent(r);let o=new KeyboardEvent("keyup",s);return o.synthetic=!0,i.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function qQ(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function Fw(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function XQ(i,t){let e=t.focusNode,n=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=n)return!1;for(n=Math.min(n,ws(e));;)if(n){if(e.nodeType!=1)return!1;let s=e.childNodes[n-1];s.contentEditable=="false"?n--:(e=s,n=ws(e))}else{if(e==i)return!0;n=Vo(e),e=e.parentNode}}function Ww(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function qw(i,t){for(let e=i,n=t;;){if(e.nodeType==3&&n>0)return{node:e,offset:n};if(e.nodeType==1&&n>0){if(e.contentEditable=="false")return null;e=e.childNodes[n-1],n=ws(e)}else if(e.parentNode&&!Gf(e))n=Vo(e),e=e.parentNode;else return null}}function Xw(i,t){for(let e=i,n=t;;){if(e.nodeType==3&&n<e.nodeValue.length)return{node:e,offset:n};if(e.nodeType==1&&n<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[n],n=0}else if(e.parentNode&&!Gf(e))n=Vo(e)+1,e=e.parentNode;else return null}}class fi{constructor(t,e,n=!0){this.node=t,this.offset=e,this.precise=n}static before(t,e){return new fi(t.parentNode,Vo(t),e)}static after(t,e){return new fi(t.parentNode,Vo(t)+1,e)}}const zO=[];class Jt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let n of this.children){if(n==t)return e;e+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let n=this.dom,s=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=s?s.nextSibling:n.firstChild)){let a=Jt.get(r);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(t,e),o.flags&=-8}if(r=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&r!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;r&&r!=o.dom;)r=t2(r);else n.insertBefore(o.dom,r);s=o.dom}for(r=s?s.nextSibling:n.firstChild,r&&e&&e.node==n&&(e.written=!0);r;)r=t2(r)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(t,e),n.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let n;if(t==this.dom)n=this.dom.childNodes[e];else{let s=ws(t)==0?0:e==0?-1:1;for(;;){let r=t.parentNode;if(r==this.dom)break;s==0&&r.firstChild!=r.lastChild&&(t==r.firstChild?s=-1:s=1),t=r}s<0?n=t:n=t.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!Jt.get(n);)n=n.nextSibling;if(!n)return this.length;for(let s=0,r=0;;s++){let o=this.children[s];if(o.dom==n)return r;r+=o.length+o.breakAfter}}domBoundsAround(t,e,n=0){let s=-1,r=-1,o=-1,a=-1;for(let l=0,c=n,h=n;l<this.children.length;l++){let u=this.children[l],f=c+u.length;if(c<t&&f>e)return u.domBoundsAround(t,e,c);if(f>=t&&s==-1&&(s=l,r=c),c>e&&u.dom.parentNode==this.dom){o=l,a=h;break}h=f,c=f+u.breakAfter}return{from:r,to:a<0?n+this.length:a,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,n=zO){this.markDirty();for(let s=t;s<e;s++){let r=this.children[s];r.parent==this&&n.indexOf(r)<0&&r.destroy()}n.length<250?this.children.splice(t,e-t,...n):this.children=[].concat(this.children.slice(0,t),n,this.children.slice(e));for(let s=0;s<n.length;s++)n[s].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new zw(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,n,s,r,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}Jt.prototype.breakAfter=0;function t2(i){let t=i.nextSibling;return i.parentNode.removeChild(i),t}class zw{constructor(t,e,n){this.children=t,this.pos=e,this.i=n,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Gw(i,t,e,n,s,r,o,a,l){let{children:c}=i,h=c.length?c[t]:null,u=r.length?r[r.length-1]:null,f=u?u.breakAfter:o;if(!(t==n&&h&&!o&&!f&&r.length<2&&h.merge(e,s,r.length?u:null,e==0,a,l))){if(n<c.length){let d=c[n];d&&(s<d.length||d.breakAfter&&u?.breakAfter)?(t==n&&(d=d.split(s),s=0),!f&&u&&d.merge(0,s,u,!0,0,l)?r[r.length-1]=d:((s||d.children.length&&!d.children[0].length)&&d.merge(0,s,null,!1,0,l),r.push(d))):d?.breakAfter&&(u?u.breakAfter=1:o=1),n++}for(h&&(h.breakAfter=o,e>0&&(!o&&r.length&&h.merge(e,h.length,r[0],!1,a,0)?h.breakAfter=r.shift().breakAfter:(e<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(e,h.length,null,!1,a,0),t++));t<n&&r.length;)if(c[n-1].become(r[r.length-1]))n--,r.pop(),l=r.length?0:a;else if(c[t].become(r[0]))t++,r.shift(),a=r.length?0:l;else break;!r.length&&t&&n<c.length&&!c[t-1].breakAfter&&c[n].merge(0,0,c[t-1],!1,a,l)&&t--,(t<n||r.length)&&i.replaceChildren(t,n,r)}}function jw(i,t,e,n,s,r){let o=i.childCursor(),{i:a,off:l}=o.findPos(e,1),{i:c,off:h}=o.findPos(t,-1),u=t-e;for(let f of n)u+=f.length;i.length+=u,Gw(i,c,h,a,l,n,0,s,r)}const zQ=256;class Fn extends Jt{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,n){return this.flags&8||n&&(!(n instanceof Fn)||this.length-(e-t)+n.length>zQ||n.flags&8)?!1:(this.text=this.text.slice(0,t)+(n?n.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Fn(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new fi(this.dom,t)}domBoundsAround(t,e,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return GQ(this.dom,t,e)}}class Ks extends Jt{constructor(t,e=[],n=0){super(),this.mark=t,this.children=e,this.length=n;for(let s of e)s.setParent(this)}setAttrs(t){if(Fw(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,n,s,r,o){return n&&(!(n instanceof Ks&&n.mark.eq(this.mark))||t&&r<=0||e<this.length&&o<=0)?!1:(jw(this,t,e,n?n.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(t){let e=[],n=0,s=-1,r=0;for(let a of this.children){let l=n+a.length;l>t&&e.push(n<t?a.split(t-n):a),s<0&&n>=t&&(s=r),n=l,r++}let o=this.length-t;return this.length=t,s>-1&&(this.children.length=s,this.markDirty()),new Ks(this.mark,e,o)}domAtPos(t){return Uw(this,t)}coordsAt(t,e){return Hw(this,t,e)}}function GQ(i,t,e){let n=i.nodeValue.length;t>n&&(t=n);let s=t,r=t,o=0;t==0&&e<0||t==n&&e>=0?ht.chrome||ht.gecko||(t?(s--,o=1):r<n&&(r++,o=-1)):e<0?s--:r<n&&r++;let a=Bo(i,s,r).getClientRects();if(!a.length)return null;let l=a[(o?o<0:e>=0)?0:a.length-1];return ht.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),o?Ph(l,o<0):l||null}class Ar extends Jt{static create(t,e,n){return new Ar(t,e,n)}constructor(t,e,n){super(),this.widget=t,this.length=e,this.side=n,this.prevWidget=null}split(t){let e=Ar.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,n,s,r,o){return n&&(!(n instanceof Ar)||!this.widget.compare(n.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-e),!0)}become(t){return t instanceof Ar&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return qt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,n=e&&e.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):qt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?fi.before(this.dom):fi.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let n=this.widget.coordsAt(this.dom,t,e);if(n)return n;let s=this.dom.getClientRects(),r=null;if(!s.length)return null;let o=this.side?this.side<0:t>0;for(let a=o?s.length-1:0;r=s[a],!(t>0?a==0:a==s.length-1||r.top<r.bottom);a+=o?-1:1);return Ph(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class tl extends Jt{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof tl&&t.side==this.side}split(){return new tl(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?fi.before(this.dom):fi.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return qt.empty}get isHidden(){return!0}}Fn.prototype.children=Ar.prototype.children=tl.prototype.children=zO;function Uw(i,t){let e=i.dom,{children:n}=i,s=0;for(let r=0;s<n.length;s++){let o=n[s],a=r+o.length;if(!(a==r&&o.getSide()<=0)){if(t>r&&t<a&&o.dom.parentNode==e)return o.domAtPos(t-r);if(t<=r)break;r=a}}for(let r=s;r>0;r--){let o=n[r-1];if(o.dom.parentNode==e)return o.domAtPos(o.length)}for(let r=s;r<n.length;r++){let o=n[r];if(o.dom.parentNode==e)return o.domAtPos(0)}return new fi(e,0)}function Yw(i,t,e){let n,{children:s}=i;e>0&&t instanceof Ks&&s.length&&(n=s[s.length-1])instanceof Ks&&n.mark.eq(t.mark)?Yw(n,t.children[0],e-1):(s.push(t),t.setParent(i)),i.length+=t.length}function Hw(i,t,e){let n=null,s=-1,r=null,o=-1;function a(c,h){for(let u=0,f=0;u<c.children.length&&f<=h;u++){let d=c.children[u],p=f+d.length;p>=h&&(d.children.length?a(d,h-f):(!r||r.isHidden&&(e>0||UQ(r,d)))&&(p>h||f==p&&d.getSide()>0)?(r=d,o=h-f):(f<h||f==p&&d.getSide()<0&&!d.isHidden)&&(n=d,s=h-f)),f=p}}a(i,t);let l=(e<0?n:r)||n||r;return l?l.coordsAt(Math.max(0,l==n?s:o),e):jQ(i)}function jQ(i){let t=i.dom.lastChild;if(!t)return i.dom.getBoundingClientRect();let e=Ja(t);return e[e.length-1]||null}function UQ(i,t){let e=i.coordsAt(0,1),n=t.coordsAt(0,1);return e&&n&&n.top<e.bottom}function Wm(i,t){for(let e in i)e=="class"&&t.class?t.class+=" "+i.class:e=="style"&&t.style?t.style+=";"+i.style:t[e]=i[e];return t}const e2=Object.create(null);function jf(i,t,e){if(i==t)return!0;i||(i=e2),t||(t=e2);let n=Object.keys(i),s=Object.keys(t);if(n.length-(e&&n.indexOf(e)>-1?1:0)!=s.length-(e&&s.indexOf(e)>-1?1:0))return!1;for(let r of n)if(r!=e&&(s.indexOf(r)==-1||i[r]!==t[r]))return!1;return!0}function qm(i,t,e){let n=!1;if(t)for(let s in t)e&&s in e||(n=!0,s=="style"?i.style.cssText="":i.removeAttribute(s));if(e)for(let s in e)t&&t[s]==e[s]||(n=!0,s=="style"?i.style.cssText=e[s]:i.setAttribute(s,e[s]));return n}function YQ(i){let t=Object.create(null);for(let e=0;e<i.attributes.length;e++){let n=i.attributes[e];t[n.name]=n.value}return t}class Es{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var Ai=(function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i})(Ai||(Ai={}));class vt extends Lo{constructor(t,e,n,s){super(),this.startSide=t,this.endSide=e,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(t){return new Ah(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),n=!!t.block;return e+=n&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new Xr(t,e,e,n,t.widget||null,!1)}static replace(t){let e=!!t.block,n,s;if(t.isBlockGap)n=-5e8,s=4e8;else{let{start:r,end:o}=Kw(t,e);n=(r?e?-3e8:-1:5e8)-1,s=(o?e?2e8:1:-6e8)+1}return new Xr(t,n,s,e,t.widget||null,!0)}static line(t){return new Mh(t)}static set(t,e=!1){return zt.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}vt.none=zt.empty;class Ah extends vt{constructor(t){let{start:e,end:n}=Kw(t);super(e?-1:5e8,n?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,n;return this==t||t instanceof Ah&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((n=t.attrs)===null||n===void 0?void 0:n.class))&&jf(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}Ah.prototype.point=!1;class Mh extends vt{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof Mh&&this.spec.class==t.spec.class&&jf(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}Mh.prototype.mapMode=ni.TrackBefore;Mh.prototype.point=!0;class Xr extends vt{constructor(t,e,n,s,r,o){super(e,n,r,t),this.block=s,this.isReplace=o,this.mapMode=s?e<=0?ni.TrackBefore:ni.TrackAfter:ni.TrackDel}get type(){return this.startSide!=this.endSide?Ai.WidgetRange:this.startSide<=0?Ai.WidgetBefore:Ai.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Xr&&HQ(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}Xr.prototype.point=!0;function Kw(i,t=!1){let{inclusiveStart:e,inclusiveEnd:n}=i;return e==null&&(e=i.inclusive),n==null&&(n=i.inclusive),{start:e??t,end:n??t}}function HQ(i,t){return i==t||!!(i&&t&&i.compare(t))}function cf(i,t,e,n=0){let s=e.length-1;s>=0&&e[s]+n>=i?e[s]=Math.max(e[s],t):e.push(i,t)}class Ie extends Jt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,n,s,r,o){if(n){if(!(n instanceof Ie))return!1;this.dom||n.transferDOM(this)}return s&&this.setDeco(n?n.attrs:null),jw(this,t,e,n?n.children.slice():[],r,o),!0}split(t){let e=new Ie;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i:n,off:s}=this.childPos(t);s&&(e.append(this.children[n].split(s),0),this.children[n].merge(s,this.children[n].length,null,!1,0,0),n++);for(let r=n;r<this.children.length;r++)e.append(this.children[r],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){jf(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Yw(this,t,e)}addLineDeco(t){let e=t.spec.attributes,n=t.spec.class;e&&(this.attrs=Wm(e,this.attrs||{})),n&&(this.attrs=Wm({class:n},this.attrs||{}))}domAtPos(t){return Uw(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var n;this.dom?this.flags&4&&(Fw(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(qm(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let s=this.dom.lastChild;for(;s&&Jt.get(s)instanceof Ks;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((n=Jt.get(s))===null||n===void 0?void 0:n.isEditable)==!1&&(!ht.ios||!this.children.some(r=>r instanceof Fn))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let n of this.children){if(!(n instanceof Fn)||/[^ -~]/.test(n.text))return null;let s=Ja(n.dom);if(s.length!=1)return null;t+=s[0].width,e=s[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let n=Hw(this,t,e);if(!this.children.length&&n&&this.parent){let{heightOracle:s}=this.parent.view.viewState,r=n.bottom-n.top;if(Math.abs(r-s.lineHeight)<2&&s.textHeight<r){let o=(r-s.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(t){return t instanceof Ie&&this.children.length==0&&t.children.length==0&&jf(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let n=0,s=0;n<t.children.length;n++){let r=t.children[n],o=s+r.length;if(o>=e){if(r instanceof Ie)return r;if(o>e)break}s=o+r.breakAfter}return null}}class Gs extends Jt{constructor(t,e,n){super(),this.widget=t,this.length=e,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(t,e,n,s,r,o){return n&&(!(n instanceof Gs)||!this.widget.compare(n.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(n?n.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?fi.before(this.dom):fi.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let n=new Gs(this.widget,e,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return zO}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):qt.empty}domBoundsAround(){return null}become(t){return t instanceof Gs&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){let n=this.widget.coordsAt(this.dom,t,e);return n||(this.widget instanceof Xm?null:Ph(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:n}=this.deco;return e==n?!1:t<0?e<0:n>0}}class Xm extends Es{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class wc{constructor(t,e,n,s){this.doc=t,this.pos=e,this.end=n,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof Gs&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ie),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Pu(new tl(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof Gs)&&this.getLine()}buildText(t,e,n){for(;t>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:a,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=o,this.textOff=0}let s=Math.min(this.text.length-this.textOff,t),r=Math.min(s,512);this.flushBuffer(e.slice(e.length-n)),this.getLine().append(Pu(new Fn(this.text.slice(this.textOff,this.textOff+r)),e),n),this.atCursorPos=!0,this.textOff+=r,t-=r,n=s<=r?0:e.length}}span(t,e,n,s){this.buildText(e-t,n,s),this.pos=e,this.openStart<0&&(this.openStart=s)}point(t,e,n,s,r,o){if(this.disallowBlockEffectsFor[o]&&n instanceof Xr){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=e-t;if(n instanceof Xr)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Gs(n.widget||el.block,a,n));else{let l=Ar.create(n.widget||el.inline,a,a?0:n.startSide),c=this.atCursorPos&&!l.isEditable&&r<=s.length&&(t<e||n.startSide>0),h=!l.isEditable&&(t<e||r>s.length||n.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),c&&(u.append(Pu(new tl(1),s),r),r=s.length+Math.max(0,r-s.length)),u.append(Pu(l,s),r),this.atCursorPos=h,this.pendingBuffer=h?t<e||r>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,n,s,r){let o=new wc(t,e,n,r);return o.openEnd=zt.spans(s,e,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Pu(i,t){for(let e of t)i=new Ks(e,[i],i.length);return i}class el extends Es{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}el.inline=new el("span");el.block=new el("div");var ge=(function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i})(ge||(ge={}));const Zo=ge.LTR,GO=ge.RTL;function Jw(i){let t=[];for(let e=0;e<i.length;e++)t.push(1<<+i[e]);return t}const KQ=Jw("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),JQ=Jw("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),zm=Object.create(null),es=[];for(let i of["()","[]","{}"]){let t=i.charCodeAt(0),e=i.charCodeAt(1);zm[t]=e,zm[e]=-t}function tk(i){return i<=247?KQ[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?JQ[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const tN=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Mr{get dir(){return this.level%2?GO:Zo}constructor(t,e,n){this.from=t,this.to=e,this.level=n}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,n,s){let r=-1;for(let o=0;o<t.length;o++){let a=t[o];if(a.from<=e&&a.to>=e){if(a.level==n)return o;(r<0||(s!=0?s<0?a.from<e:a.to>e:t[r].level>a.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function ek(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++){let n=i[e],s=t[e];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!ek(n.inner,s.inner))return!1}return!0}const ne=[];function eN(i,t,e,n,s){for(let r=0;r<=n.length;r++){let o=r?n[r-1].to:t,a=r<n.length?n[r].from:e,l=r?256:s;for(let c=o,h=l,u=l;c<a;c++){let f=tk(i.charCodeAt(c));f==512?f=h:f==8&&u==4&&(f=16),ne[c]=f==4?2:f,f&7&&(u=f),h=f}for(let c=o,h=l,u=l;c<a;c++){let f=ne[c];if(f==128)c<a-1&&h==ne[c+1]&&h&24?f=ne[c]=h:ne[c]=256;else if(f==64){let d=c+1;for(;d<a&&ne[d]==64;)d++;let p=c&&h==8||d<e&&ne[d]==8?u==1?1:8:256;for(let g=c;g<d;g++)ne[g]=p;c=d-1}else f==8&&u==1&&(ne[c]=1);h=f,f&7&&(u=f)}}}function iN(i,t,e,n,s){let r=s==1?2:1;for(let o=0,a=0,l=0;o<=n.length;o++){let c=o?n[o-1].to:t,h=o<n.length?n[o].from:e;for(let u=c,f,d,p;u<h;u++)if(d=zm[f=i.charCodeAt(u)])if(d<0){for(let g=a-3;g>=0;g-=3)if(es[g+1]==-d){let m=es[g+2],O=m&2?s:m&4?m&1?r:s:0;O&&(ne[u]=ne[es[g]]=O),a=g;break}}else{if(es.length==189)break;es[a++]=u,es[a++]=f,es[a++]=l}else if((p=ne[u])==2||p==1){let g=p==s;l=g?0:1;for(let m=a-3;m>=0;m-=3){let O=es[m+2];if(O&2)break;if(g)es[m+2]|=2;else{if(O&4)break;es[m+2]|=4}}}}}function nN(i,t,e,n){for(let s=0,r=n;s<=e.length;s++){let o=s?e[s-1].to:i,a=s<e.length?e[s].from:t;for(let l=o;l<a;){let c=ne[l];if(c==256){let h=l+1;for(;;)if(h==a){if(s==e.length)break;h=e[s++].to,a=s<e.length?e[s].from:t}else if(ne[h]==256)h++;else break;let u=r==1,f=(h<t?ne[h]:n)==1,d=u==f?u?1:2:n;for(let p=h,g=s,m=g?e[g-1].to:i;p>l;)p==m&&(p=e[--g].from,m=g?e[g-1].to:i),ne[--p]=d;l=h}else r=c,l++}}}function Gm(i,t,e,n,s,r,o){let a=n%2?2:1;if(n%2==s%2)for(let l=t,c=0;l<e;){let h=!0,u=!1;if(c==r.length||l<r[c].from){let g=ne[l];g!=a&&(h=!1,u=g==16)}let f=!h&&a==1?[]:null,d=h?n:n+1,p=l;t:for(;;)if(c<r.length&&p==r[c].from){if(u)break t;let g=r[c];if(!h)for(let m=g.to,O=c+1;;){if(m==e)break t;if(O<r.length&&r[O].from==m)m=r[O++].to;else{if(ne[m]==a)break t;break}}if(c++,f)f.push(g);else{g.from>l&&o.push(new Mr(l,g.from,d));let m=g.direction==Zo!=!(d%2);jm(i,m?n+1:n,s,g.inner,g.from,g.to,o),l=g.to}p=g.to}else{if(p==e||(h?ne[p]!=a:ne[p]==a))break;p++}f?Gm(i,l,p,n+1,s,f,o):l<p&&o.push(new Mr(l,p,d)),l=p}else for(let l=e,c=r.length;l>t;){let h=!0,u=!1;if(!c||l>r[c-1].to){let g=ne[l-1];g!=a&&(h=!1,u=g==16)}let f=!h&&a==1?[]:null,d=h?n:n+1,p=l;t:for(;;)if(c&&p==r[c-1].to){if(u)break t;let g=r[--c];if(!h)for(let m=g.from,O=c;;){if(m==t)break t;if(O&&r[O-1].to==m)m=r[--O].from;else{if(ne[m-1]==a)break t;break}}if(f)f.push(g);else{g.to<l&&o.push(new Mr(g.to,l,d));let m=g.direction==Zo!=!(d%2);jm(i,m?n+1:n,s,g.inner,g.from,g.to,o),l=g.from}p=g.from}else{if(p==t||(h?ne[p-1]!=a:ne[p-1]==a))break;p--}f?Gm(i,p,l,n+1,s,f,o):p<l&&o.push(new Mr(p,l,d)),l=p}}function jm(i,t,e,n,s,r,o){let a=t%2?2:1;eN(i,s,r,n,a),iN(i,s,r,n,a),nN(s,r,n,a),Gm(i,s,r,t,e,n,o)}function sN(i,t,e){if(!i)return[new Mr(0,0,t==GO?1:0)];if(t==Zo&&!e.length&&!tN.test(i))return ik(i.length);if(e.length)for(;i.length>ne.length;)ne[ne.length]=256;let n=[],s=t==Zo?0:1;return jm(i,s,s,e,0,i.length,n),n}function ik(i){return[new Mr(0,i,0)]}let nk="";function rN(i,t,e,n,s){var r;let o=n.head-i.from,a=Mr.find(t,o,(r=n.bidiLevel)!==null&&r!==void 0?r:-1,n.assoc),l=t[a],c=l.side(s,e);if(o==c){let f=a+=s?1:-1;if(f<0||f>=t.length)return null;l=t[a=f],o=l.side(!s,e),c=l.side(s,e)}let h=si(i.text,o,l.forward(s,e));(h<l.from||h>l.to)&&(h=c),nk=i.text.slice(Math.min(o,h),Math.max(o,h));let u=a==(s?t.length-1:0)?null:t[a+(s?1:-1)];return u&&h==c&&u.level+(s?0:1)<l.level?H.cursor(u.side(!s,e)+i.from,u.forward(s,e)?1:-1,u.level):H.cursor(h+i.from,l.forward(s,e)?-1:1,l.level)}function oN(i,t,e){for(let n=t;n<e;n++){let s=tk(i.charCodeAt(n));if(s==1)return Zo;if(s==2||s==4)return GO}return Zo}const sk=ut.define(),rk=ut.define(),ok=ut.define(),ak=ut.define(),Um=ut.define(),lk=ut.define(),ck=ut.define(),jO=ut.define(),UO=ut.define(),hk=ut.define({combine:i=>i.some(t=>t)}),uk=ut.define({combine:i=>i.some(t=>t)}),fk=ut.define();class Ia{constructor(t,e="nearest",n="nearest",s=5,r=5,o=!1){this.range=t,this.y=e,this.x=n,this.yMargin=s,this.xMargin=r,this.isSnapshot=o}map(t){return t.empty?this:new Ia(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Ia(H.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Au=Ct.define({map:(i,t)=>i.map(t)}),dk=Ct.define();function qi(i,t,e){let n=i.facet(ak);n.length?n[0](t):window.onerror&&window.onerror(String(t),e,void 0,void 0,t)||(e?console.error(e+":",t):console.error(t))}const Xs=ut.define({combine:i=>i.length?i[0]:!0});let aN=0;const va=ut.define({combine(i){return i.filter((t,e)=>{for(let n=0;n<e;n++)if(i[n].plugin==t.plugin)return!1;return!0})}});class Ae{constructor(t,e,n,s,r){this.id=t,this.create=e,this.domEventHandlers=n,this.domEventObservers=s,this.baseExtensions=r(this),this.extension=this.baseExtensions.concat(va.of({plugin:this,arg:void 0}))}of(t){return this.baseExtensions.concat(va.of({plugin:this,arg:t}))}static define(t,e){const{eventHandlers:n,eventObservers:s,provide:r,decorations:o}=e||{};return new Ae(aN++,t,n,s,a=>{let l=[];return o&&l.push(qc.of(c=>{let h=c.plugin(a);return h?o(h):vt.none})),r&&l.push(r(a)),l})}static fromClass(t,e){return Ae.define((n,s)=>new t(n,s),e)}}class ig{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(n){if(qi(e.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(t,this.spec.arg)}catch(e){qi(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(n){qi(t.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const pk=ut.define(),YO=ut.define(),qc=ut.define(),gk=ut.define(),Eh=ut.define(),mk=ut.define();function i2(i,t){let e=i.state.facet(mk);if(!e.length)return e;let n=e.map(r=>r instanceof Function?r(i):r),s=[];return zt.spans(n,t.from,t.to,{point(){},span(r,o,a,l){let c=r-t.from,h=o-t.from,u=s;for(let f=a.length-1;f>=0;f--,l--){let d=a[f].spec.bidiIsolate,p;if(d==null&&(d=oN(t.text,c,h)),l>0&&u.length&&(p=u[u.length-1]).to==c&&p.direction==d)p.to=h,u=p.inner;else{let g={from:c,to:h,direction:d,inner:[]};u.push(g),u=g.inner}}}}),s}const Ok=ut.define();function HO(i){let t=0,e=0,n=0,s=0;for(let r of i.state.facet(Ok)){let o=r(i);o&&(o.left!=null&&(t=Math.max(t,o.left)),o.right!=null&&(e=Math.max(e,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(s=Math.max(s,o.bottom)))}return{left:t,right:e,top:n,bottom:s}}const sc=ut.define();class Tn{constructor(t,e,n,s){this.fromA=t,this.toA=e,this.fromB=n,this.toB=s}join(t){return new Tn(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,n=this;for(;e>0;e--){let s=t[e-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),t.splice(e-1,1)}}return t.splice(e,0,n),t}static extendWithRanges(t,e){if(e.length==0)return t;let n=[];for(let s=0,r=0,o=0,a=0;;s++){let l=s==t.length?null:t[s],c=o-a,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let u=e[r],f=e[r+1],d=Math.max(a,u),p=Math.min(h,f);if(d<=p&&new Tn(d+c,p+c,d,p).addToSet(n),f>h)break;r+=2}if(!l)return n;new Tn(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),o=l.toA,a=l.toB}}}class Uf{constructor(t,e,n){this.view=t,this.state=e,this.transactions=n,this.flags=0,this.startState=t.state,this.changes=Ze.empty(this.startState.doc.length);for(let r of n)this.changes=this.changes.compose(r.changes);let s=[];this.changes.iterChangedRanges((r,o,a,l)=>s.push(new Tn(r,o,a,l))),this.changedRanges=s}static create(t,e,n){return new Uf(t,e,n)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class n2 extends Jt{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=vt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Ie],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Tn(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let n=t.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?s=this.domChanged.newSel.head:!pN(t.changes,this.hasComposition)&&!t.selectionSet&&(s=t.state.selection.main.head));let r=s>-1?cN(this.view,t.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;n=new Tn(c,h,t.changes.mapPos(c,-1),t.changes.mapPos(h,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(ht.ie||ht.chrome)&&!r&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=fN(o,a,t.changes);return n=Tn.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,t.startState.doc.length,r),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,n);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=ht.chrome||ht.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||s.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Gs&&o.widget instanceof Xm&&r.push(o.dom);s.updateGaps(r)}updateChildren(t,e,n){let s=n?n.range.addToSet(t.slice()):t,r=this.childCursor(e);for(let o=s.length-1;;o--){let a=o>=0?s[o]:null;if(!a)break;let{fromA:l,toA:c,fromB:h,toB:u}=a,f,d,p,g;if(n&&n.range.fromB<u&&n.range.toB>h){let v=wc.build(this.view.state.doc,h,n.range.fromB,this.decorations,this.dynamicDecorationMap),b=wc.build(this.view.state.doc,n.range.toB,u,this.decorations,this.dynamicDecorationMap);d=v.breakAtStart,p=v.openStart,g=b.openEnd;let k=this.compositionView(n);b.breakAtStart?k.breakAfter=1:b.content.length&&k.merge(k.length,k.length,b.content[0],!1,b.openStart,0)&&(k.breakAfter=b.content[0].breakAfter,b.content.shift()),v.content.length&&k.merge(0,0,v.content[v.content.length-1],!0,0,v.openEnd)&&v.content.pop(),f=v.content.concat(k).concat(b.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:g}=wc.build(this.view.state.doc,h,u,this.decorations,this.dynamicDecorationMap));let{i:m,off:O}=r.findPos(c,1),{i:y,off:_}=r.findPos(l,-1);Gw(this,y,_,m,O,f,d,p,g)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let n of e.effects)n.is(dk)&&(this.editContextFormatting=n.value)}compositionView(t){let e=new Fn(t.text.nodeValue);e.flags|=8;for(let{deco:s}of t.marks)e=new Ks(s,[e],e.length);let n=new Ie;return n.append(e,0),n}fixCompositionDOM(t){let e=(r,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=Jt.get(r);a&&a!=o&&(a.dom=null),o.setDOM(r)},n=this.childPos(t.range.fromB,1),s=this.children[n.i];e(t.line,s);for(let r=t.marks.length-1;r>=-1;r--)n=s.childPos(n.off,1),s=s.children[n.i],e(r>=0?t.marks[r].node:t.text,s)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,s=n==this.dom,r=!s&&!(this.view.state.facet(Xs)||this.dom.tabIndex>-1)&&lf(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(s||e||r))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(ht.gecko&&a.empty&&!this.hasComposition&&lN(l)){let u=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(u,l.node.childNodes[l.offset]||null)),l=c=new fi(u,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!Sc(l.node,l.offset,h.anchorNode,h.anchorOffset)||!Sc(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,a))&&(this.view.observer.ignore(()=>{ht.android&&ht.chrome&&this.dom.contains(h.focusNode)&&dN(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=Wc(this.view.root);if(u)if(a.empty){if(ht.gecko){let f=hN(l.node,l.offset);if(f&&f!=3){let d=(f==1?qw:Xw)(l.node,l.offset);d&&(l=new fi(d.node,d.offset))}}u.collapse(l.node,l.offset),a.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=a.bidiLevel)}else if(u.extend){u.collapse(l.node,l.offset);try{u.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),f.setEnd(c.node,c.offset),f.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(f)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new fi(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new fi(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&Sc(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,n=Wc(t.root),{anchorNode:s,anchorOffset:r}=t.observer.selectionRange;if(!n||!e.empty||!e.assoc||!n.modify)return;let o=Ie.find(this,e.head);if(!o)return;let a=o.posAtStart;if(e.head==a||e.head==a+o.length)return;let l=this.coordsAt(e.head,-1),c=this.coordsAt(e.head,1);if(!l||!c||l.bottom>c.top)return;let h=this.domAtPos(e.head+e.assoc);n.collapse(h.node,h.offset),n.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let u=t.observer.selectionRange;t.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=e.from&&n.collapse(s,r)}moveToLine(t){let e=this.dom,n;if(t.node!=e)return t;for(let s=t.offset;!n&&s<e.childNodes.length;s++){let r=Jt.get(e.childNodes[s]);r instanceof Ie&&(n=r.domAtPos(0))}for(let s=t.offset-1;!n&&s>=0;s--){let r=Jt.get(e.childNodes[s]);r instanceof Ie&&(n=r.domAtPos(r.length))}return n?new fi(n.node,n.offset,!0):t}nearest(t){for(let e=t;e;){let n=Jt.get(e);if(n&&n.rootView==this)return n;e=e.parentNode}return null}posFromDOM(t,e){let n=this.nearest(t);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(t,e)+n.posAtStart}domAtPos(t){let{i:e,off:n}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let s=this.children[e];if(n<s.length||s instanceof Ie)break;e++,n=0}return this.children[e].domAtPos(n)}coordsAt(t,e){let n=null,s=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=r-a.breakAfter,c=l-a.length;if(l<t)break;if(c<=t&&(c<t||a.covers(-1))&&(l>t||a.covers(1))&&(!n||a instanceof Ie&&!(n instanceof Ie&&e>=0)))n=a,s=c;else if(n&&c==t&&l==t&&a instanceof Gs&&Math.abs(e)<2){if(a.deco.startSide<0)break;o&&(n=null)}r=c}return n?n.coordsAt(t-s,e):null}coordsForChar(t){let{i:e,off:n}=this.childPos(t,1),s=this.children[e];if(!(s instanceof Ie))return null;for(;s.children.length;){let{i:a,off:l}=s.childPos(n,1);for(;;a++){if(a==s.children.length)return null;if((s=s.children[a]).length)break}n=l}if(!(s instanceof Fn))return null;let r=si(s.text,n);if(r==n)return null;let o=Bo(s.dom,n,r).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(t){let e=[],{from:n,to:s}=t,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==ge.LTR;for(let c=0,h=0;h<this.children.length;h++){let u=this.children[h],f=c+u.length;if(f>s)break;if(c>=n){let d=u.dom.getBoundingClientRect();if(e.push(d.height),o){let p=u.dom.lastChild,g=p?Ja(p):[];if(g.length){let m=g[g.length-1],O=l?m.right-d.left:d.right-m.left;O>a&&(a=O,this.minWidth=r,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+u.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?ge.RTL:ge.LTR}measureTextSize(){for(let r of this.children)if(r instanceof Ie){let o=r.measureTextSize();if(o)return o}let t=document.createElement("div"),e,n,s;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let r=Ja(t.firstChild)[0];e=t.getBoundingClientRect().height,n=r?r.width/27:7,s=r?r.height:e,t.remove()}),{lineHeight:e,charWidth:n,textHeight:s}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new zw(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let n=0,s=0;;s++){let r=s==e.viewports.length?null:e.viewports[s],o=r?r.from-1:this.length;if(o>n){let a=(e.lineBlockAt(o).bottom-e.lineBlockAt(n).top)/this.view.scaleY;t.push(vt.replace({widget:new Xm(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!r)break;n=r.to+1}return vt.set(t)}updateDeco(){let t=1,e=this.view.state.facet(qc).map(r=>(this.dynamicDecorationMap[t++]=typeof r=="function")?r(this.view):r),n=!1,s=this.view.state.facet(gk).map((r,o)=>{let a=typeof r=="function";return a&&(n=!0),a?r(this.view):r});for(s.length&&(this.dynamicDecorationMap[t++]=n,e.push(zt.join(s))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let c of this.view.state.facet(fk))try{if(c(this.view,t.range,t))return!0}catch(h){qi(this.view.state,h,"scroll handler")}let{range:e}=t,n=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),s;if(!n)return;!e.empty&&(s=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let r=HO(this.view),o={left:n.left-r.left,top:n.top-r.top,right:n.right+r.right,bottom:n.bottom+r.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;ZQ(this.view.scrollDOM,o,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,a),-a),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==ge.LTR)}}function lN(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}function yk(i,t){let e=i.observer.selectionRange;if(!e.focusNode)return null;let n=qw(e.focusNode,e.focusOffset),s=Xw(e.focusNode,e.focusOffset),r=n||s;if(s&&n&&s.node!=n.node){let a=Jt.get(s.node);if(!a||a instanceof Fn&&a.text!=s.node.nodeValue)r=s;else if(i.docView.lastCompositionAfterCursor){let l=Jt.get(n.node);!l||l instanceof Fn&&l.text!=n.node.nodeValue||(r=s)}}if(i.docView.lastCompositionAfterCursor=r!=n,!r)return null;let o=t-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function cN(i,t,e){let n=yk(i,e);if(!n)return null;let{node:s,from:r,to:o}=n,a=s.nodeValue;if(/[\n\r]/.test(a)||i.state.doc.sliceString(n.from,n.to)!=a)return null;let l=t.invertedDesc,c=new Tn(l.mapPos(r),l.mapPos(o),r,o),h=[];for(let u=s.parentNode;;u=u.parentNode){let f=Jt.get(u);if(f instanceof Ks)h.push({node:u,deco:f.mark});else{if(f instanceof Ie||u.nodeName=="DIV"&&u.parentNode==i.contentDOM)return{range:c,text:s,marks:h,line:u};if(u!=i.contentDOM)h.push({node:u,deco:new Ah({inclusive:!0,attributes:YQ(u),tagName:u.tagName.toLowerCase()})});else return null}}}function hN(i,t){return i.nodeType!=1?0:(t&&i.childNodes[t-1].contentEditable=="false"?1:0)|(t<i.childNodes.length&&i.childNodes[t].contentEditable=="false"?2:0)}let uN=class{constructor(){this.changes=[]}compareRange(t,e){cf(t,e,this.changes)}comparePoint(t,e){cf(t,e,this.changes)}boundChange(t){cf(t,t,this.changes)}};function fN(i,t,e){let n=new uN;return zt.compare(i,t,e,n),n.changes}function dN(i,t){for(let e=i;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function pN(i,t){let e=!1;return t&&i.iterChangedRanges((n,s)=>{n<t.to&&s>t.from&&(e=!0)}),e}function gN(i,t,e=1){let n=i.charCategorizer(t),s=i.doc.lineAt(t),r=t-s.from;if(s.length==0)return H.cursor(t);r==0?e=1:r==s.length&&(e=-1);let o=r,a=r;e<0?o=si(s.text,r,!1):a=si(s.text,r);let l=n(s.text.slice(o,a));for(;o>0;){let c=si(s.text,o,!1);if(n(s.text.slice(c,o))!=l)break;o=c}for(;a<s.length;){let c=si(s.text,a);if(n(s.text.slice(a,c))!=l)break;a=c}return H.range(o+s.from,a+s.from)}function mN(i,t){return t.left>i?t.left-i:Math.max(0,i-t.right)}function ON(i,t){return t.top>i?t.top-i:Math.max(0,i-t.bottom)}function ng(i,t){return i.top<t.bottom-1&&i.bottom>t.top+1}function s2(i,t){return t<i.top?{top:t,left:i.left,right:i.right,bottom:i.bottom}:i}function r2(i,t){return t>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:t}:i}function Ym(i,t,e){let n,s,r,o,a=!1,l,c,h,u;for(let p=i.firstChild;p;p=p.nextSibling){let g=Ja(p);for(let m=0;m<g.length;m++){let O=g[m];s&&ng(s,O)&&(O=s2(r2(O,s.bottom),s.top));let y=mN(t,O),_=ON(e,O);if(y==0&&_==0)return p.nodeType==3?o2(p,t,e):Ym(p,t,e);(!n||o>_||o==_&&r>y)&&(n=p,s=O,r=y,o=_,a=y?t<O.left?m>0:m<g.length-1:!0),y==0?e>O.bottom&&(!h||h.bottom<O.bottom)?(l=p,h=O):e<O.top&&(!u||u.top>O.top)&&(c=p,u=O):h&&ng(h,O)?h=r2(h,O.bottom):u&&ng(u,O)&&(u=s2(u,O.top))}}if(h&&h.bottom>=e?(n=l,s=h):u&&u.top<=e&&(n=c,s=u),!n)return{node:i,offset:0};let f=Math.max(s.left,Math.min(s.right,t));if(n.nodeType==3)return o2(n,f,e);if(a&&n.contentEditable!="false")return Ym(n,f,e);let d=Array.prototype.indexOf.call(i.childNodes,n)+(t>=(s.left+s.right)/2?1:0);return{node:i,offset:d}}function o2(i,t,e){let n=i.nodeValue.length,s=-1,r=1e9,o=0;for(let a=0;a<n;a++){let l=Bo(i,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let h=l[c];if(h.top==h.bottom)continue;o||(o=t-h.left);let u=(h.top>e?h.top-e:e-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&u<r){let f=t>=(h.left+h.right)/2,d=f;if((ht.chrome||ht.gecko)&&Bo(i,a).getBoundingClientRect().left==h.right&&(d=!f),u<=0)return{node:i,offset:a+(d?1:0)};s=a+(d?1:0),r=u}}}return{node:i,offset:s>-1?s:o>0?i.nodeValue.length:0}}function bk(i,t,e,n=-1){var s,r;let o=i.contentDOM.getBoundingClientRect(),a=o.top+i.viewState.paddingTop,l,{docHeight:c}=i.viewState,{x:h,y:u}=t,f=u-a;if(f<0)return 0;if(f>c)return i.state.doc.length;for(let v=i.viewState.heightOracle.textHeight/2,b=!1;l=i.elementAtHeight(f),l.type!=Ai.Text;)for(;f=n>0?l.bottom+v:l.top-v,!(f>=0&&f<=c);){if(b)return e?null:0;b=!0,n=-n}u=a+f;let d=l.from;if(d<i.viewport.from)return i.viewport.from==0?0:e?null:a2(i,o,l,h,u);if(d>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:e?null:a2(i,o,l,h,u);let p=i.dom.ownerDocument,g=i.root.elementFromPoint?i.root:p,m=g.elementFromPoint(h,u);m&&!i.contentDOM.contains(m)&&(m=null),m||(h=Math.max(o.left+1,Math.min(o.right-1,h)),m=g.elementFromPoint(h,u),m&&!i.contentDOM.contains(m)&&(m=null));let O,y=-1;if(m&&((s=i.docView.nearest(m))===null||s===void 0?void 0:s.isEditable)!=!1){if(p.caretPositionFromPoint){let v=p.caretPositionFromPoint(h,u);v&&({offsetNode:O,offset:y}=v)}else if(p.caretRangeFromPoint){let v=p.caretRangeFromPoint(h,u);v&&({startContainer:O,startOffset:y}=v)}O&&(!i.contentDOM.contains(O)||ht.safari&&yN(O,y,h)||ht.chrome&&bN(O,y,h))&&(O=void 0),O&&(y=Math.min(ws(O),y))}if(!O||!i.docView.dom.contains(O)){let v=Ie.find(i.docView,d);if(!v)return f>l.top+l.height/2?l.to:l.from;({node:O,offset:y}=Ym(v.dom,h,u))}let _=i.docView.nearest(O);if(!_)return null;if(_.isWidget&&((r=_.dom)===null||r===void 0?void 0:r.nodeType)==1){let v=_.dom.getBoundingClientRect();return t.y<v.top||t.y<=v.bottom&&t.x<=(v.left+v.right)/2?_.posAtStart:_.posAtEnd}else return _.localPosFromDOM(O,y)+_.posAtStart}function a2(i,t,e,n,s){let r=Math.round((n-t.left)*i.defaultCharacterWidth);if(i.lineWrapping&&e.height>i.defaultLineHeight*1.5){let a=i.viewState.heightOracle.textHeight,l=Math.floor((s-e.top-(i.defaultLineHeight-a)*.5)/a);r+=l*i.viewState.heightOracle.lineLength}let o=i.state.sliceDoc(e.from,e.to);return e.from+Nm(o,r,i.state.tabSize)}function vk(i,t,e){let n,s=i;if(i.nodeType!=3||t!=(n=i.nodeValue.length))return!1;for(;;){let r=s.nextSibling;if(r){if(r.nodeName=="BR")break;return!1}else{let o=s.parentNode;if(!o||o.nodeName=="DIV")break;s=o}}return Bo(i,n-1,n).getBoundingClientRect().right>e}function yN(i,t,e){return vk(i,t,e)}function bN(i,t,e){if(t!=0)return vk(i,t,e);for(let s=i;;){let r=s.parentNode;if(!r||r.nodeType!=1||r.firstChild!=s)return!1;if(r.classList.contains("cm-line"))break;s=r}let n=i.nodeType==1?i.getBoundingClientRect():Bo(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return e-n.left>5}function Hm(i,t,e){let n=i.lineBlockAt(t);if(Array.isArray(n.type)){let s;for(let r of n.type){if(r.from>t)break;if(!(r.to<t)){if(r.from<t&&r.to>t)return r;(!s||r.type==Ai.Text&&(s.type!=r.type||(e<0?r.from<t:r.to>t)))&&(s=r)}}return s||n}return n}function vN(i,t,e,n){let s=Hm(i,t.head,t.assoc||-1),r=!n||s.type!=Ai.Text||!(i.lineWrapping||s.widgetLineBreaks)?null:i.coordsAtPos(t.assoc<0&&t.head>s.from?t.head-1:t.head);if(r){let o=i.dom.getBoundingClientRect(),a=i.textDirectionAt(s.from),l=i.posAtCoords({x:e==(a==ge.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(l!=null)return H.cursor(l,e?-1:1)}return H.cursor(e?s.to:s.from,e?-1:1)}function l2(i,t,e,n){let s=i.state.doc.lineAt(t.head),r=i.bidiSpans(s),o=i.textDirectionAt(s.from);for(let a=t,l=null;;){let c=rN(s,r,o,a,e),h=nk;if(!c){if(s.number==(e?i.state.doc.lines:1))return a;h=`
`,s=i.state.doc.line(s.number+(e?1:-1)),r=i.bidiSpans(s),c=i.visualLineSide(s,!e)}if(l){if(!l(h))return a}else{if(!n)return c;l=n(h)}a=c}}function _N(i,t,e){let n=i.state.charCategorizer(t),s=n(e);return r=>{let o=n(r);return s==_e.Space&&(s=o),s==o}}function xN(i,t,e,n){let s=t.head,r=e?1:-1;if(s==(e?i.state.doc.length:0))return H.cursor(s,t.assoc);let o=t.goalColumn,a,l=i.contentDOM.getBoundingClientRect(),c=i.coordsAtPos(s,t.assoc||-1),h=i.documentTop;if(c)o==null&&(o=c.left-l.left),a=r<0?c.top:c.bottom;else{let d=i.viewState.lineBlockAt(s);o==null&&(o=Math.min(l.right-l.left,i.defaultCharacterWidth*(s-d.from))),a=(r<0?d.top:d.bottom)+h}let u=l.left+o,f=n??i.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=a+(f+d)*r,g=bk(i,{x:u,y:p},!1,r);if(p<l.top||p>l.bottom||(r<0?g<s:g>s)){let m=i.docView.coordsForChar(g),O=!m||p<m.top?-1:1;return H.cursor(g,O,void 0,o)}}}function kc(i,t,e){for(;;){let n=0;for(let s of i)s.between(t-1,t+1,(r,o,a)=>{if(t>r&&t<o){let l=n||e||(t-r<o-t?-1:1);t=l<0?r:o,n=l}});if(!n)return t}}function _k(i,t){let e=null;for(let n=0;n<t.ranges.length;n++){let s=t.ranges[n],r=null;if(s.empty){let o=kc(i,s.from,0);o!=s.from&&(r=H.cursor(o,-1))}else{let o=kc(i,s.from,-1),a=kc(i,s.to,1);(o!=s.from||a!=s.to)&&(r=H.range(s.from==s.anchor?o:a,s.from==s.head?o:a))}r&&(e||(e=t.ranges.slice()),e[n]=r)}return e?H.create(e,t.mainIndex):t}function sg(i,t,e){let n=kc(i.state.facet(Eh).map(s=>s(i)),e.from,t.head>e.from?-1:1);return n==e.from?e:H.cursor(n,n<e.from?1:-1)}const rc="￿";class SN{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Vt.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=rc}readRange(t,e){if(!t)return this;let n=t.parentNode;for(let s=t;;){this.findPointBefore(n,s);let r=this.text.length;this.readNode(s);let o=s.nextSibling;if(o==e)break;let a=Jt.get(s),l=Jt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:Gf(s))||Gf(o)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>r)&&!kN(o,e)&&this.lineBreak(),s=o}return this.findPointBefore(n,e),this}readTextNode(t){let e=t.nodeValue;for(let n of this.points)n.node==t&&(n.pos=this.text.length+Math.min(n.offset,e.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,a;if(this.lineSeparator?(r=e.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(a=s.exec(e))&&(r=a.index,o=a[0].length),this.append(e.slice(n,r<0?e.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==t&&l.pos>this.text.length&&(l.pos-=o-1);n=r+o}}readNode(t){if(t.cmIgnore)return;let e=Jt.get(t),n=e&&e.overrideDOMText;if(n!=null){this.findPointInside(t,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let n of this.points)n.node==t&&t.childNodes[n.offset]==e&&(n.pos=this.text.length)}findPointInside(t,e){for(let n of this.points)(t.nodeType==3?n.node==t:t.contains(n.node))&&(n.pos=this.text.length+(wN(t,n.node,n.offset)?e:0))}}function wN(i,t,e){for(;;){if(!t||e<ws(t))return!1;if(t==i)return!0;e=Vo(t)+1,t=t.parentNode}}function kN(i,t){let e;for(;!(i==t||!i);i=i.nextSibling){let n=Jt.get(i);if(!(n?.isWidget||i.cmIgnore))return!1;n&&(e||(e=[])).push(n)}if(e)for(let n of e){let s=n.overrideDOMText;if(s?.length)return!1}return!0}class c2{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class CN{constructor(t,e,n,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:r,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,n,0))){let a=r||o?[]:PN(t),l=new SN(a,t.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=AN(a,this.bounds.from)}else{let a=t.observer.selectionRange,l=r&&r.node==a.focusNode&&r.offset==a.focusOffset||!Fm(t.contentDOM,a.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(a.focusNode,a.focusOffset),c=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Fm(t.contentDOM,a.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(a.anchorNode,a.anchorOffset),h=t.viewport;if((ht.ios||ht.chrome)&&t.state.selection.main.empty&&l!=c&&(h.from>0||h.to<t.state.doc.length)){let u=Math.min(l,c),f=Math.max(l,c),d=h.from-u,p=h.to-f;(d==0||d==1||u==0)&&(p==0||p==-1||f==t.state.doc.length)&&(l=0,c=t.state.doc.length)}this.newSel=H.single(c,l)}}}function xk(i,t){let e,{newSel:n}=t,s=i.state.selection.main,r=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(t.bounds){let{from:o,to:a}=t.bounds,l=s.from,c=null;(r===8||ht.android&&t.text.length<a-o)&&(l=s.to,c="end");let h=Sk(i.state.doc.sliceString(o,a,rc),t.text,l-o,c);h&&(ht.chrome&&r==13&&h.toB==h.from+2&&t.text.slice(h.from,h.toB)==rc+rc&&h.toB--,e={from:o+h.from,to:o+h.toA,insert:qt.of(t.text.slice(h.from,h.toB).split(rc))})}else n&&(!i.hasFocus&&i.state.facet(Xs)||n.main.eq(s))&&(n=null);if(!e&&!n)return!1;if(!e&&t.typeOver&&!s.empty&&n&&n.main.empty?e={from:s.from,to:s.to,insert:i.state.doc.slice(s.from,s.to)}:(ht.mac||ht.android)&&e&&e.from==e.to&&e.from==s.head-1&&/^\. ?$/.test(e.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(n&&e.insert.length==2&&(n=H.single(n.main.anchor-1,n.main.head-1)),e={from:e.from,to:e.to,insert:qt.of([e.insert.toString().replace("."," ")])}):e&&e.from>=s.from&&e.to<=s.to&&(e.from!=s.from||e.to!=s.to)&&s.to-s.from-(e.to-e.from)<=4?e={from:s.from,to:s.to,insert:i.state.doc.slice(s.from,e.from).append(e.insert).append(i.state.doc.slice(e.to,s.to))}:ht.chrome&&e&&e.from==e.to&&e.from==s.head&&e.insert.toString()==`
 `&&i.lineWrapping&&(n&&(n=H.single(n.main.anchor-1,n.main.head-1)),e={from:s.from,to:s.to,insert:qt.of([" "])}),e)return KO(i,e,n,r);if(n&&!n.main.eq(s)){let o=!1,a="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(o=!0),a=i.inputState.lastSelectionOrigin,a=="select.pointer"&&(n=_k(i.state.facet(Eh).map(l=>l(i)),n))),i.dispatch({selection:n,scrollIntoView:o,userEvent:a}),!0}else return!1}function KO(i,t,e,n=-1){if(ht.ios&&i.inputState.flushIOSKey(t))return!0;let s=i.state.selection.main;if(ht.android&&(t.to==s.to&&(t.from==s.from||t.from==s.from-1&&i.state.sliceDoc(t.from,s.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&Ra(i.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||n==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&Ra(i.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&Ra(i.contentDOM,"Delete",46)))return!0;let r=t.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let o,a=()=>o||(o=TN(i,t,e));return i.state.facet(lk).some(l=>l(i,t.from,t.to,r,a))||i.dispatch(a()),!0}function TN(i,t,e){let n,s=i.state,r=s.selection.main,o=-1;if(t.from==t.to&&t.from<r.from||t.from>r.to){let l=t.from<r.from?-1:1,c=l<0?r.from:r.to,h=kc(s.facet(Eh).map(u=>u(i)),c,l);t.from==h&&(o=h)}if(o>-1)n={changes:t,selection:H.cursor(t.from+t.insert.length,-1)};else if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&i.inputState.composing<0){let l=r.from<t.from?s.sliceDoc(r.from,t.from):"",c=r.to>t.to?s.sliceDoc(t.to,r.to):"";n=s.replaceSelection(i.state.toText(l+t.insert.sliceString(0,void 0,i.state.lineBreak)+c))}else{let l=s.changes(t),c=e&&e.main.to<=l.newLength?e.main:void 0;if(s.selection.ranges.length>1&&i.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let h=i.state.sliceDoc(t.from,t.to),u,f=e&&yk(i,e.main.head);if(f){let g=t.insert.length-(t.to-t.from);u={from:f.from,to:f.to-g}}else u=i.state.doc.lineAt(r.head);let d=r.to-t.to,p=r.to-r.from;n=s.changeByRange(g=>{if(g.from==r.from&&g.to==r.to)return{changes:l,range:c||g.map(l)};let m=g.to-d,O=m-h.length;if(g.to-g.from!=p||i.state.sliceDoc(O,m)!=h||g.to>=u.from&&g.from<=u.to)return{range:g};let y=s.changes({from:O,to:m,insert:t.insert}),_=g.to-r.to;return{changes:y,range:c?H.range(Math.max(0,c.anchor+_),Math.max(0,c.head+_)):g.map(y)}})}else n={changes:l,selection:c&&s.selection.replaceRange(c)}}let a="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,a+=".compose",i.inputState.compositionFirstChange&&(a+=".start",i.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:a,scrollIntoView:!0})}function Sk(i,t,e,n){let s=Math.min(i.length,t.length),r=0;for(;r<s&&i.charCodeAt(r)==t.charCodeAt(r);)r++;if(r==s&&i.length==t.length)return null;let o=i.length,a=t.length;for(;o>0&&a>0&&i.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;if(n=="end"){let l=Math.max(0,r-Math.min(o,a));e-=o+l-r}if(o<r&&i.length<t.length){let l=e<=r&&e>=o?r-e:0;r-=l,a=r+(a-o),o=r}else if(a<r){let l=e<=r&&e>=a?r-e:0;r-=l,o=r+(o-a),a=r}return{from:r,toA:o,toB:a}}function PN(i){let t=[];if(i.root.activeElement!=i.contentDOM)return t;let{anchorNode:e,anchorOffset:n,focusNode:s,focusOffset:r}=i.observer.selectionRange;return e&&(t.push(new c2(e,n)),(s!=e||r!=n)&&t.push(new c2(s,r))),t}function AN(i,t){if(i.length==0)return null;let e=i[0].pos,n=i.length==2?i[1].pos:e;return e>-1&&n>-1?H.single(e+t,n+t):null}class MN{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,ht.safari&&t.contentDOM.addEventListener("input",()=>null),ht.gecko&&zN(t.contentDOM.ownerDocument)}handleEvent(t){!LN(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,e){let n=this.handlers[t];if(n){for(let s of n.observers)s(this.view,e);for(let s of n.handlers){if(e.defaultPrevented)break;if(s(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=EN(t),n=this.handlers,s=this.view.contentDOM;for(let r in e)if(r!="scroll"){let o=!e[r].handlers.length,a=n[r];a&&o!=!a.handlers.length&&(s.removeEventListener(r,this.handleEvent),a=null),a||s.addEventListener(r,this.handleEvent,{passive:o})}for(let r in n)r!="scroll"&&!e[r]&&s.removeEventListener(r,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&kk.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),ht.android&&ht.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return ht.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=wk.find(n=>n.keyCode==t.keyCode))&&!t.ctrlKey||RN.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,Ra(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!/^key/.test(t.type)||t.synthetic?!1:this.composing>0?!0:ht.safari&&!ht.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function h2(i,t){return(e,n)=>{try{return t.call(i,n,e)}catch(s){qi(e.state,s)}}}function EN(i){let t=Object.create(null);function e(n){return t[n]||(t[n]={observers:[],handlers:[]})}for(let n of i){let s=n.spec,r=s&&s.plugin.domEventHandlers,o=s&&s.plugin.domEventObservers;if(r)for(let a in r){let l=r[a];l&&e(a).handlers.push(h2(n.value,l))}if(o)for(let a in o){let l=o[a];l&&e(a).observers.push(h2(n.value,l))}}for(let n in Wn)e(n).handlers.push(Wn[n]);for(let n in Pn)e(n).observers.push(Pn[n]);return t}const wk=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],RN="dthko",kk=[16,17,18,20,91,92,224,225],Mu=6;function Eu(i){return Math.max(0,i)*.7+8}function IN(i,t){return Math.max(Math.abs(i.clientX-t.clientX),Math.abs(i.clientY-t.clientY))}class QN{constructor(t,e,n,s){this.view=t,this.startEvent=e,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=FQ(t.contentDOM),this.atoms=t.state.facet(Eh).map(o=>o(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Vt.allowMultipleSelections)&&NN(t,e),this.dragging=DN(t,e)&&Pk(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&IN(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,n=0,s=0,r=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=HO(this.view);t.clientX-l.left<=s+Mu?e=-Eu(s-t.clientX):t.clientX+l.right>=o-Mu&&(e=Eu(t.clientX-o)),t.clientY-l.top<=r+Mu?n=-Eu(r-t.clientY):t.clientY+l.bottom>=a-Mu&&(n=Eu(t.clientY-a)),this.setScrollSpeed(e,n)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}select(t){let{view:e}=this,n=_k(this.atoms,this.style.get(t,this.extend,this.multiple));(this.mustSelect||!n.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function NN(i,t){let e=i.state.facet(sk);return e.length?e[0](t):ht.mac?t.metaKey:t.ctrlKey}function $N(i,t){let e=i.state.facet(rk);return e.length?e[0](t):ht.mac?!t.altKey:!t.ctrlKey}function DN(i,t){let{main:e}=i.state.selection;if(e.empty)return!1;let n=Wc(i.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let r=0;r<s.length;r++){let o=s[r];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return!0}return!1}function LN(i,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,n;e!=i.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(n=Jt.get(e))&&n.ignoreEvent(t))return!1;return!0}const Wn=Object.create(null),Pn=Object.create(null),Ck=ht.ie&&ht.ie_version<15||ht.ios&&ht.webkit_version<604;function VN(i){let t=i.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{i.focus(),e.remove(),Tk(i,e.value)},50)}function ap(i,t,e){for(let n of i.facet(t))e=n(e,i);return e}function Tk(i,t){t=ap(i.state,jO,t);let{state:e}=i,n,s=1,r=e.toText(t),o=r.lines==e.selection.ranges.length;if(Km!=null&&e.selection.ranges.every(l=>l.empty)&&Km==r.toString()){let l=-1;n=e.changeByRange(c=>{let h=e.doc.lineAt(c.from);if(h.from==l)return{range:c};l=h.from;let u=e.toText((o?r.line(s++).text:t)+e.lineBreak);return{changes:{from:h.from,insert:u},range:H.cursor(c.from+u.length)}})}else o?n=e.changeByRange(l=>{let c=r.line(s++);return{changes:{from:l.from,to:l.to,insert:c.text},range:H.cursor(l.from+c.length)}}):n=e.replaceSelection(r);i.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Pn.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft};Wn.keydown=(i,t)=>(i.inputState.setSelectionOrigin("select"),t.keyCode==27&&i.inputState.tabFocusMode!=0&&(i.inputState.tabFocusMode=Date.now()+2e3),!1);Pn.touchstart=(i,t)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};Pn.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};Wn.mousedown=(i,t)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let n of i.state.facet(ok))if(e=n(i,t),e)break;if(!e&&t.button==0&&(e=FN(i,t)),e){let n=!i.hasFocus;i.inputState.startMouseSelection(new QN(i,t,e,n)),n&&i.observer.ignore(()=>{Zw(i.contentDOM);let r=i.root.activeElement;r&&!r.contains(i.contentDOM)&&r.blur()});let s=i.inputState.mouseSelection;if(s)return s.start(t),s.dragging===!1}else i.inputState.setSelectionOrigin("select.pointer");return!1};function u2(i,t,e,n){if(n==1)return H.cursor(t,e);if(n==2)return gN(i.state,t,e);{let s=Ie.find(i.docView,t),r=i.state.doc.lineAt(s?s.posAtEnd:t),o=s?s.posAtStart:r.from,a=s?s.posAtEnd:r.to;return a<i.state.doc.length&&a==r.to&&a++,H.range(o,a)}}let f2=(i,t,e)=>t>=e.top&&t<=e.bottom&&i>=e.left&&i<=e.right;function BN(i,t,e,n){let s=Ie.find(i.docView,t);if(!s)return 1;let r=t-s.posAtStart;if(r==0)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&f2(e,n,o))return-1;let a=s.coordsAt(r,1);return a&&f2(e,n,a)?1:o&&o.bottom>=n?-1:1}function d2(i,t){let e=i.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:BN(i,e,t.clientX,t.clientY)}}const ZN=ht.ie&&ht.ie_version<=11;let p2=null,g2=0,m2=0;function Pk(i){if(!ZN)return i.detail;let t=p2,e=m2;return p2=i,m2=Date.now(),g2=!t||e>Date.now()-400&&Math.abs(t.clientX-i.clientX)<2&&Math.abs(t.clientY-i.clientY)<2?(g2+1)%3:1}function FN(i,t){let e=d2(i,t),n=Pk(t),s=i.state.selection;return{update(r){r.docChanged&&(e.pos=r.changes.mapPos(e.pos),s=s.map(r.changes))},get(r,o,a){let l=d2(i,r),c,h=u2(i,l.pos,l.bias,n);if(e.pos!=l.pos&&!o){let u=u2(i,e.pos,e.bias,n),f=Math.min(u.from,h.from),d=Math.max(u.to,h.to);h=f<h.from?H.range(f,d):H.range(d,f)}return o?s.replaceRange(s.main.extend(h.from,h.to)):a&&n==1&&s.ranges.length>1&&(c=WN(s,l.pos))?c:a?s.addRange(h):H.create([h])}}}function WN(i,t){for(let e=0;e<i.ranges.length;e++){let{from:n,to:s}=i.ranges[e];if(n<=t&&s>=t)return H.create(i.ranges.slice(0,e).concat(i.ranges.slice(e+1)),i.mainIndex==e?0:i.mainIndex-(i.mainIndex>e?1:0))}return null}Wn.dragstart=(i,t)=>{let{selection:{main:e}}=i.state;if(t.target.draggable){let s=i.docView.nearest(t.target);if(s&&s.isWidget){let r=s.posAtStart,o=r+s.length;(r>=e.to||o<=e.from)&&(e=H.range(r,o))}}let{inputState:n}=i;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",ap(i.state,UO,i.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1};Wn.dragend=i=>(i.inputState.draggedContent=null,!1);function O2(i,t,e,n){if(e=ap(i.state,jO,e),!e)return;let s=i.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:r}=i.inputState,o=n&&r&&$N(i,t)?{from:r.from,to:r.to}:null,a={from:s,insert:e},l=i.state.changes(o?[o,a]:a);i.focus(),i.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"}),i.inputState.draggedContent=null}Wn.drop=(i,t)=>{if(!t.dataTransfer)return!1;if(i.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let n=Array(e.length),s=0,r=()=>{++s==e.length&&O2(i,t,n.filter(o=>o!=null).join(i.state.lineBreak),!1)};for(let o=0;o<e.length;o++){let a=new FileReader;a.onerror=r,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(n[o]=a.result),r()},a.readAsText(e[o])}return!0}else{let n=t.dataTransfer.getData("Text");if(n)return O2(i,t,n,!0),!0}return!1};Wn.paste=(i,t)=>{if(i.state.readOnly)return!0;i.observer.flush();let e=Ck?null:t.clipboardData;return e?(Tk(i,e.getData("text/plain")||e.getData("text/uri-list")),!0):(VN(i),!1)};function qN(i,t){let e=i.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=t,n.focus(),n.selectionEnd=t.length,n.selectionStart=0,setTimeout(()=>{n.remove(),i.focus()},50)}function XN(i){let t=[],e=[],n=!1;for(let s of i.selection.ranges)s.empty||(t.push(i.sliceDoc(s.from,s.to)),e.push(s));if(!t.length){let s=-1;for(let{from:r}of i.selection.ranges){let o=i.doc.lineAt(r);o.number>s&&(t.push(o.text),e.push({from:o.from,to:Math.min(i.doc.length,o.to+1)})),s=o.number}n=!0}return{text:ap(i,UO,t.join(i.lineBreak)),ranges:e,linewise:n}}let Km=null;Wn.copy=Wn.cut=(i,t)=>{let{text:e,ranges:n,linewise:s}=XN(i.state);if(!e&&!s)return!1;Km=s?e:null,t.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let r=Ck?null:t.clipboardData;return r?(r.clearData(),r.setData("text/plain",e),!0):(qN(i,e),!1)};const Ak=hr.define();function Mk(i,t){let e=[];for(let n of i.facet(ck)){let s=n(i,t);s&&e.push(s)}return e.length?i.update({effects:e,annotations:Ak.of(!0)}):null}function Ek(i){setTimeout(()=>{let t=i.hasFocus;if(t!=i.inputState.notifiedFocused){let e=Mk(i.state,t);e?i.dispatch(e):i.update([])}},10)}Pn.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),Ek(i)};Pn.blur=i=>{i.observer.clearSelectionRange(),Ek(i)};Pn.compositionstart=Pn.compositionupdate=i=>{i.observer.editContext||(i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0))};Pn.compositionend=i=>{i.observer.editContext||(i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,ht.chrome&&ht.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50))};Pn.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};Wn.beforeinput=(i,t)=>{var e,n;if(t.inputType=="insertReplacementText"&&i.observer.editContext){let r=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),o=t.getTargetRanges();if(r&&o.length){let a=o[0],l=i.posAtDOM(a.startContainer,a.startOffset),c=i.posAtDOM(a.endContainer,a.endOffset);return KO(i,{from:l,to:c,insert:i.state.toText(r)},null),!0}}let s;if(ht.chrome&&ht.android&&(s=wk.find(r=>r.inputType==t.inputType))&&(i.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let r=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return ht.ios&&t.inputType=="deleteContentForward"&&i.observer.flushSoon(),ht.safari&&t.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>Pn.compositionend(i,t),20),!1};const y2=new Set;function zN(i){y2.has(i)||(y2.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const b2=["pre-wrap","normal","pre-line","break-spaces"];let il=!1;function v2(){il=!1}class GN{constructor(t){this.lineWrapping=t,this.doc=qt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let n=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((e-t-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return b2.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let n=0;n<t.length;n++){let s=t[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(e=!0,this.heightSamples[Math.floor(s*10)]=!0)}return e}refresh(t,e,n,s,r,o){let a=b2.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=e,this.charWidth=n,this.textHeight=s,this.lineLength=r,l){this.heightSamples={};for(let c=0;c<o.length;c++){let h=o[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return l}}class jN{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class us{constructor(t,e,n,s,r){this.from=t,this.length=e,this.top=n,this.height=s,this._content=r}get type(){return typeof this._content=="number"?Ai.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Xr?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new us(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var de=(function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i})(de||(de={}));const hf=.001;class Mi{constructor(t,e,n=2){this.length=t,this.height=e,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>hf&&(il=!0),this.height=t)}replace(t,e,n){return Mi.of(n)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,n,s){let r=this,o=n.doc;for(let a=s.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:h,toB:u}=s[a],f=r.lineAt(l,de.ByPosNoHeight,n.setDoc(e),0,0),d=f.to>=c?f:r.lineAt(c,de.ByPosNoHeight,n,0,0);for(u+=d.to-c,c=d.to;a>0&&f.from<=s[a-1].toA;)l=s[a-1].fromA,h=s[a-1].fromB,a--,l<f.from&&(f=r.lineAt(l,de.ByPosNoHeight,n,0,0));h+=f.from-l,l=f.from;let p=JO.build(n.setDoc(o),t,h,u);r=Yf(r,r.replace(l,c,p))}return r.updateHeight(n,0)}static empty(){return new rn(0,0)}static of(t){if(t.length==1)return t[0];let e=0,n=t.length,s=0,r=0;for(;;)if(e==n)if(s>r*2){let a=t[e-1];a.break?t.splice(--e,1,a.left,null,a.right):t.splice(--e,1,a.left,a.right),n+=1+a.break,s-=a.size}else if(r>s*2){let a=t[n];a.break?t.splice(n,1,a.left,null,a.right):t.splice(n,1,a.left,a.right),n+=2+a.break,r-=a.size}else break;else if(s<r){let a=t[e++];a&&(s+=a.size)}else{let a=t[--n];a&&(r+=a.size)}let o=0;return t[e-1]==null?(o=1,e--):t[e]==null&&(o=1,n++),new UN(Mi.of(t.slice(0,e)),o,Mi.of(t.slice(n)))}}function Yf(i,t){return i==t?i:(i.constructor!=t.constructor&&(il=!0),t)}Mi.prototype.size=1;class Rk extends Mi{constructor(t,e,n){super(t,e),this.deco=n}blockAt(t,e,n,s){return new us(s,this.length,n,this.height,this.deco||0)}lineAt(t,e,n,s,r){return this.blockAt(0,n,s,r)}forEachLine(t,e,n,s,r,o){t<=r+this.length&&e>=r&&o(this.blockAt(0,n,s,r))}updateHeight(t,e=0,n=!1,s){return s&&s.from<=e&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class rn extends Rk{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,n,s){return new us(s,this.length,n,this.height,this.breaks)}replace(t,e,n){let s=n[0];return n.length==1&&(s instanceof rn||s instanceof Je&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Je?s=new rn(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Mi.of(n)}updateHeight(t,e=0,n=!1,s){return s&&s.from<=e&&s.more?this.setHeight(s.heights[s.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Je extends Mi{constructor(t){super(t,0)}heightMetrics(t,e){let n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,r=s-n+1,o,a=0;if(t.lineWrapping){let l=Math.min(this.height,t.lineHeight*r);o=l/r,this.length>r+1&&(a=(this.height-l)/(this.length-r-1))}else o=this.height/r;return{firstLine:n,lastLine:s,perLine:o,perChar:a}}blockAt(t,e,n,s){let{firstLine:r,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(e,s);if(e.lineWrapping){let c=s+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-n)/this.height))*this.length)),h=e.doc.lineAt(c),u=a+h.length*l,f=Math.max(n,t-u/2);return new us(h.from,h.length,f,u,0)}else{let c=Math.max(0,Math.min(o-r,Math.floor((t-n)/a))),{from:h,length:u}=e.doc.line(r+c);return new us(h,u,n+a*c,a,0)}}lineAt(t,e,n,s,r){if(e==de.ByHeight)return this.blockAt(t,n,s,r);if(e==de.ByPosNoHeight){let{from:d,to:p}=n.doc.lineAt(t);return new us(d,p-d,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r),c=n.doc.lineAt(t),h=a+c.length*l,u=c.number-o,f=s+a*u+l*(c.from-r-u);return new us(c.from,c.length,Math.max(s,Math.min(f,s+this.height-h)),h,0)}forEachLine(t,e,n,s,r,o){t=Math.max(t,r),e=Math.min(e,r+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(n,r);for(let h=t,u=s;h<=e;){let f=n.doc.lineAt(h);if(h==t){let p=f.number-a;u+=l*p+c*(t-r-p)}let d=l+c*f.length;o(new us(f.from,f.length,u,d,0)),u+=d,h=f.to+1}}replace(t,e,n){let s=this.length-e;if(s>0){let r=n[n.length-1];r instanceof Je?n[n.length-1]=new Je(r.length+s):n.push(null,new Je(s-1))}if(t>0){let r=n[0];r instanceof Je?n[0]=new Je(t+r.length):n.unshift(new Je(t-1),null)}return Mi.of(n)}decomposeLeft(t,e){e.push(new Je(t-1),null)}decomposeRight(t,e){e.push(null,new Je(this.length-t-1))}updateHeight(t,e=0,n=!1,s){let r=e+this.length;if(s&&s.from<=e+this.length&&s.more){let o=[],a=Math.max(e,s.from),l=-1;for(s.from>e&&o.push(new Je(s.from-e-1).updateHeight(t,e));a<=r&&s.more;){let h=t.doc.lineAt(a).length;o.length&&o.push(null);let u=s.heights[s.index++];l==-1?l=u:Math.abs(u-l)>=hf&&(l=-2);let f=new rn(h,u);f.outdated=!1,o.push(f),a+=h+1}a<=r&&o.push(null,new Je(r-a).updateHeight(t,a));let c=Mi.of(o);return(l<0||Math.abs(c.height-this.height)>=hf||Math.abs(l-this.heightMetrics(t,e).perLine)>=hf)&&(il=!0),Yf(this,c)}else(n||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class UN extends Mi{constructor(t,e,n){super(t.length+e+n.length,t.height+n.height,e|(t.outdated||n.outdated?2:0)),this.left=t,this.right=n,this.size=t.size+n.size}get break(){return this.flags&1}blockAt(t,e,n,s){let r=n+this.left.height;return t<r?this.left.blockAt(t,e,n,s):this.right.blockAt(t,e,r,s+this.left.length+this.break)}lineAt(t,e,n,s,r){let o=s+this.left.height,a=r+this.left.length+this.break,l=e==de.ByHeight?t<o:t<a,c=l?this.left.lineAt(t,e,n,s,r):this.right.lineAt(t,e,n,o,a);if(this.break||(l?c.to<a:c.from>a))return c;let h=e==de.ByPosNoHeight?de.ByPosNoHeight:de.ByPos;return l?c.join(this.right.lineAt(a,h,n,o,a)):this.left.lineAt(a,h,n,s,r).join(c)}forEachLine(t,e,n,s,r,o){let a=s+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,n,s,r,o),e>=l&&this.right.forEachLine(t,e,n,a,l,o);else{let c=this.lineAt(l,de.ByPos,n,s,r);t<c.from&&this.left.forEachLine(t,c.from-1,n,s,r,o),c.to>=t&&c.from<=e&&o(c),e>c.to&&this.right.forEachLine(c.to+1,e,n,a,l,o)}}replace(t,e,n){let s=this.left.length+this.break;if(e<s)return this.balanced(this.left.replace(t,e,n),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-s,e-s,n));let r=[];t>0&&this.decomposeLeft(t,r);let o=r.length;for(let a of n)r.push(a);if(t>0&&_2(r,o-1),e<this.length){let a=r.length;this.decomposeRight(e,r),_2(r,a)}return Mi.of(r)}decomposeLeft(t,e){let n=this.left.length;if(t<=n)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(n++,t>=n&&e.push(null)),t>n&&this.right.decomposeLeft(t-n,e)}decomposeRight(t,e){let n=this.left.length,s=n+this.break;if(t>=s)return this.right.decomposeRight(t-s,e);t<n&&this.left.decomposeRight(t,e),this.break&&t<s&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?Mi.of(this.break?[t,null,e]:[t,e]):(this.left=Yf(this.left,t),this.right=Yf(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,n=!1,s){let{left:r,right:o}=this,a=e+r.length+this.break,l=null;return s&&s.from<=e+r.length&&s.more?l=r=r.updateHeight(t,e,n,s):r.updateHeight(t,e,n),s&&s.from<=a+o.length&&s.more?l=o=o.updateHeight(t,a,n,s):o.updateHeight(t,a,n),l?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function _2(i,t){let e,n;i[t]==null&&(e=i[t-1])instanceof Je&&(n=i[t+1])instanceof Je&&i.splice(t-1,3,new Je(e.length+1+n.length))}const YN=5;class JO{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let n=Math.min(e,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof rn?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new rn(n-this.pos,-1)),this.writtenTo=n,e>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,n){if(t<e||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,r=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let o=e-t;n.block?this.addBlock(new Rk(o,s,n)):(o||r||s>=YN)&&this.addLineDeco(s,r,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new rn(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let n=new Je(e-t);return this.oracle.doc.lineAt(t).to==e&&(n.flags|=4),n}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof rn)return t;let e=new rn(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,t),s.breaks+=e,this.writtenTo=this.pos=this.pos+n}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof rn)&&!this.isCovered?this.nodes.push(new rn(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=t;for(let s of this.nodes)s instanceof rn&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(t,e,n,s){let r=new JO(n,t);return zt.spans(e,n,s,r,0),r.finish(n)}}function HN(i,t,e){let n=new KN;return zt.compare(i,t,e,n,0),n.changes}class KN{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,n,s){(t<e||n&&n.heightRelevant||s&&s.heightRelevant)&&cf(t,e,this.changes,5)}}function JN(i,t){let e=i.getBoundingClientRect(),n=i.ownerDocument,s=n.defaultView||window,r=Math.max(0,e.left),o=Math.min(s.innerWidth,e.right),a=Math.max(0,e.top),l=Math.min(s.innerHeight,e.bottom);for(let c=i.parentNode;c&&c!=n.body;)if(c.nodeType==1){let h=c,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let f=h.getBoundingClientRect();r=Math.max(r,f.left),o=Math.min(o,f.right),a=Math.max(a,f.top),l=Math.min(c==i.parentNode?s.innerHeight:l,f.bottom)}c=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:r-e.left,right:Math.max(r,o)-e.left,top:a-(e.top+t),bottom:Math.max(a,l)-(e.top+t)}}function t$(i){let t=i.getBoundingClientRect(),e=i.ownerDocument.defaultView||window;return t.left<e.innerWidth&&t.right>0&&t.top<e.innerHeight&&t.bottom>0}function e$(i,t){let e=i.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class rg{constructor(t,e,n,s){this.from=t,this.to=e,this.size=n,this.displaySize=s}static same(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let s=t[n],r=e[n];if(s.from!=r.from||s.to!=r.to||s.size!=r.size)return!1}return!0}draw(t,e){return vt.replace({widget:new i$(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class i$ extends Es{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class x2{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=S2,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ge.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(YO).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new GN(e),this.stateDeco=t.facet(qc).filter(n=>typeof n!="function"),this.heightMap=Mi.empty().applyChanges(this.stateDeco,qt.empty,this.heightOracle.setDoc(t.doc),[new Tn(0,0,0,t.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=vt.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let n=0;n<=1;n++){let s=n?e.head:e.anchor;if(!t.some(({from:r,to:o})=>s>=r&&s<=o)){let{from:r,to:o}=this.lineBlockAt(s);t.push(new Ru(r,o))}}return this.viewports=t.sort((n,s)=>n.from-s.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?S2:new t1(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(oc(t,this.scaler))})}update(t,e=null){this.state=t.state;let n=this.stateDeco;this.stateDeco=this.state.facet(qc).filter(h=>typeof h!="function");let s=t.changedRanges,r=Tn.extendWithRanges(s,HN(n,this.stateDeco,t?t.changes:Ze.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);v2(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||il)&&(t.flags|=2),a?(this.scrollAnchorPos=t.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(c||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(uk)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,n=window.getComputedStyle(e),s=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?ge.RTL:ge.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),a=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,h=0;if(a.width&&a.height){let{scaleX:v,scaleY:b}=Bw(e,a);(v>.005&&Math.abs(this.scaleX-v)>.005||b>.005&&Math.abs(this.scaleY-b)>.005)&&(this.scaleX=v,this.scaleY=b,c|=16,o=l=!0)}let u=(parseInt(n.paddingTop)||0)*this.scaleY,f=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=f)&&(this.paddingTop=u,this.paddingBottom=f,c|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(s.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=16);let d=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=Ww(t.scrollDOM);let p=(this.printing?e$:JN)(e,this.paddingTop),g=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(l=!0)),!this.inView&&!this.scrollTarget&&!t$(t.dom))return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=t.scrollDOM.clientHeight,c|=16),l){let v=t.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(v)&&(o=!0),o||s.lineWrapping&&Math.abs(y-this.contentDOMWidth)>s.charWidth){let{lineHeight:b,charWidth:k,textHeight:x}=t.docView.measureTextSize();o=b>0&&s.refresh(r,b,k,x,Math.max(5,y/k),v),o&&(t.docView.minWidth=0,c|=16)}g>0&&m>0?h=Math.max(g,m):g<0&&m<0&&(h=Math.min(g,m)),v2();for(let b of this.viewports){let k=b.from==this.viewport.from?v:t.docView.measureVisibleLineHeights(b);this.heightMap=(o?Mi.empty().applyChanges(this.stateDeco,qt.empty,this.heightOracle,[new Tn(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new jN(b.from,k))}il&&(c|=2)}let _=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return _&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||_)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let n=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),s=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new Ru(s.lineAt(o-n*1e3,de.ByHeight,r,0,0).from,s.lineAt(a+(1-n)*1e3,de.ByHeight,r,0,0).to);if(e){let{head:c}=e.range;if(c<l.from||c>l.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=s.lineAt(c,de.ByPos,r,0,0),f;e.y=="center"?f=(u.top+u.bottom)/2-h/2:e.y=="start"||e.y=="nearest"&&c<l.from?f=u.top:f=u.bottom-h,l=new Ru(s.lineAt(f-1e3/2,de.ByHeight,r,0,0).from,s.lineAt(f+h+1e3/2,de.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let n=e.mapPos(t.from,-1),s=e.mapPos(t.to,1);return new Ru(this.heightMap.lineAt(n,de.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,de.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(t,de.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(e,de.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(t==0||s<=o-Math.max(10,Math.min(-n,250)))&&(e==this.state.doc.length||r>=a+Math.max(10,Math.min(n,250)))&&s>o-2*1e3&&r<a+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let n=[];for(let s of t)e.touchesRange(s.from,s.to)||n.push(new rg(e.mapPos(s.from),e.mapPos(s.to),s.size,s.displaySize));return n}ensureLineGaps(t,e){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,r=s>>1,o=s<<1;if(this.defaultTextDirection!=ge.LTR&&!n)return[];let a=[],l=(h,u,f,d)=>{if(u-h<r)return;let p=this.state.selection.main,g=[p.from];p.empty||g.push(p.to);for(let O of g)if(O>h&&O<u){l(h,O-10,f,d),l(O+10,u,f,d);return}let m=s$(t,O=>O.from>=f.from&&O.to<=f.to&&Math.abs(O.from-h)<r&&Math.abs(O.to-u)<r&&!g.some(y=>O.from<y&&O.to>y));if(!m){if(u<f.to&&e&&n&&e.visibleRanges.some(_=>_.from<=u&&_.to>=u)){let _=e.moveToLineBoundary(H.cursor(u),!1,!0).head;_>h&&(u=_)}let O=this.gapSize(f,h,u,d),y=n||O<2e6?O:2e6;m=new rg(h,u,O,y)}a.push(m)},c=h=>{if(h.length<o||h.type!=Ai.Text)return;let u=n$(h.from,h.to,this.stateDeco);if(u.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(n){let g=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,O;if(f!=null){let y=Qu(u,f),_=((this.visibleBottom-this.visibleTop)/2+g)/h.height;m=y-_,O=y+_}else m=(this.visibleTop-h.top-g)/h.height,O=(this.visibleBottom-h.top+g)/h.height;d=Iu(u,m),p=Iu(u,O)}else{let g=u.total*this.heightOracle.charWidth,m=s*this.heightOracle.charWidth,O=0;if(g>2e6)for(let k of t)k.from>=h.from&&k.from<h.to&&k.size!=k.displaySize&&k.from*this.heightOracle.charWidth+O<this.pixelViewport.left&&(O=k.size-k.displaySize);let y=this.pixelViewport.left+O,_=this.pixelViewport.right+O,v,b;if(f!=null){let k=Qu(u,f),x=((_-y)/2+m)/g;v=k-x,b=k+x}else v=(y-m)/g,b=(_+m)/g;d=Iu(u,v),p=Iu(u,b)}d>h.from&&l(h.from,d,h,u),p<h.to&&l(p,h.to,h,u)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return a}gapSize(t,e,n,s){let r=Qu(s,n)-Qu(s,e);return this.heightOracle.lineWrapping?t.height*r:s.total*this.heightOracle.charWidth*r}updateLineGaps(t){rg.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=vt.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let n=[];zt.spans(e,this.viewport.from,this.viewport.to,{span(r,o){n.push({from:r,to:o})},point(){}},20);let s=0;if(n.length!=this.visibleRanges.length)s=12;else for(let r=0;r<n.length&&!(s&8);r++){let o=this.visibleRanges[r],a=n[r];(o.from!=a.from||o.to!=a.to)&&(s|=4,t&&t.mapPos(o.from,-1)==a.from&&t.mapPos(o.to,1)==a.to||(s|=8))}return this.visibleRanges=n,s}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||oc(this.heightMap.lineAt(t,de.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||oc(this.heightMap.lineAt(this.scaler.fromDOM(t),de.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return oc(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Ru{constructor(t,e){this.from=t,this.to=e}}function n$(i,t,e){let n=[],s=i,r=0;return zt.spans(e,i,t,{span(){},point(o,a){o>s&&(n.push({from:s,to:o}),r+=o-s),s=a}},20),s<t&&(n.push({from:s,to:t}),r+=t-s),{total:r,ranges:n}}function Iu({total:i,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let n=Math.floor(i*e);for(let s=0;;s++){let{from:r,to:o}=t[s],a=o-r;if(n<=a)return r+n;n-=a}}function Qu(i,t){let e=0;for(let{from:n,to:s}of i.ranges){if(t<=s){e+=t-n;break}e+=s-n}return e/i.total}function s$(i,t){for(let e of i)if(t(e))return e}const S2={toDOM(i){return i},fromDOM(i){return i},scale:1,eq(i){return i==this}};class t1{constructor(t,e,n){let s=0,r=0,o=0;this.viewports=n.map(({from:a,to:l})=>{let c=e.lineAt(a,de.ByPos,t,0,0).top,h=e.lineAt(l,de.ByPos,t,0,0).bottom;return s+=h-c,{from:a,to:l,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(e.height-s);for(let a of this.viewports)a.domTop=o+(a.top-r)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),r=a.bottom}toDOM(t){for(let e=0,n=0,s=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return s+(t-n)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);n=r.bottom,s=r.domBottom}}fromDOM(t){for(let e=0,n=0,s=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return n+(t-s)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);n=r.bottom,s=r.domBottom}}eq(t){return t instanceof t1?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,n)=>e.from==t.viewports[n].from&&e.to==t.viewports[n].to):!1}}function oc(i,t){if(t.scale==1)return i;let e=t.toDOM(i.top),n=t.toDOM(i.bottom);return new us(i.from,i.length,e,n-e,Array.isArray(i._content)?i._content.map(s=>oc(s,t)):i._content)}const Nu=ut.define({combine:i=>i.join(" ")}),Jm=ut.define({combine:i=>i.indexOf(!0)>-1}),t0=Wr.newName(),Ik=Wr.newName(),Qk=Wr.newName(),Nk={"&light":"."+Ik,"&dark":"."+Qk};function e0(i,t,e){return new Wr(t,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return i;if(!e||!e[s])throw new RangeError(`Unsupported selector: ${s}`);return e[s]}):i+" "+n}})}const r$=e0("."+t0,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Nk),o$={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},og=ht.ie&&ht.ie_version<=11;class a${constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new WQ,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let n of e)this.queue.push(n);(ht.ie&&ht.ie_version<=11||ht.ios&&t.composing)&&e.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&ht.android&&t.constructor.EDIT_CONTEXT!==!1&&!(ht.chrome&&ht.chrome_version<126)&&(this.editContext=new c$(t),t.state.facet(Xs)&&(t.contentDOM.editContext=this.editContext.editContext)),og&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,n)=>e!=t[n]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(Xs)?n.root.activeElement!=this.dom:!lf(this.dom,s))return;let r=s.anchorNode&&n.docView.nearest(s.anchorNode);if(r&&r.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(ht.ie&&ht.ie_version<=11||ht.android&&ht.chrome)&&!n.state.selection.main.empty&&s.focusNode&&Sc(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Wc(t.root);if(!e)return!1;let n=ht.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&l$(this.view,e)||e;if(!n||this.selectionRange.eq(n))return!1;let s=lf(this.dom,n);return s&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&XQ(this.dom,n)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(n),s&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let n=this.dom;n;)if(n.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==n?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=e)n.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,o$),og&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),og&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var n;if(!this.delayedAndroidKey){let s=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&Ra(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,n=-1,s=!1;for(let r of t){let o=this.readMutation(r);o&&(o.typeOver&&(s=!0),e==-1?{from:e,to:n}=o:(e=Math.min(o.from,e),n=Math.max(o.to,n)))}return{from:e,to:n,typeOver:s}}readChange(){let{from:t,to:e,typeOver:n}=this.processRecords(),s=this.selectionChanged&&lf(this.dom,this.selectionRange);if(t<0&&!s)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new CN(this.view,t,e,n);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let n=this.view.state,s=xk(this.view,e);return this.view.state==n&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let n=w2(e,t.previousSibling||t.target.previousSibling,-1),s=w2(e,t.nextSibling||t.target.nextSibling,1);return{from:n?e.posAfter(n):e.posAtStart,to:s?e.posBefore(s):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Xs)!=t.state.facet(Xs)&&(t.view.contentDOM.editContext=t.state.facet(Xs)?this.editContext.editContext:null))}destroy(){var t,e,n;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function w2(i,t,e){for(;t;){let n=Jt.get(t);if(n&&n.parent==i)return n;let s=t.parentNode;t=s!=i.dom?s:e>0?t.nextSibling:t.previousSibling}return null}function k2(i,t){let e=t.startContainer,n=t.startOffset,s=t.endContainer,r=t.endOffset,o=i.docView.domAtPos(i.state.selection.main.anchor);return Sc(o.node,o.offset,s,r)&&([e,n,s,r]=[s,r,e,n]),{anchorNode:e,anchorOffset:n,focusNode:s,focusOffset:r}}function l$(i,t){if(t.getComposedRanges){let s=t.getComposedRanges(i.root)[0];if(s)return k2(i,s)}let e=null;function n(s){s.preventDefault(),s.stopImmediatePropagation(),e=s.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",n,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",n,!0),e?k2(i,e):null}class c${constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=n=>{let s=t.state.selection.main,{anchor:r,head:o}=s,a=this.toEditorPos(n.updateRangeStart),l=this.toEditorPos(n.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:a,drifted:!1});let c=l-a>n.text.length;a==this.from&&r<this.from?a=r:l==this.to&&r>this.to&&(l=r);let h=Sk(t.state.sliceDoc(a,l),n.text,(c?s.from:s.to)-a,c?"end":null);if(!h){let f=H.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd));f.main.eq(s)||t.dispatch({selection:f,userEvent:"select"});return}let u={from:h.from+a,to:h.toA+a,insert:qt.of(n.text.slice(h.from,h.toB).split(`
`))};if((ht.mac||ht.android)&&u.from==o-1&&/^\. ?$/.test(n.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(u={from:a,to:l,insert:qt.of([n.text.replace("."," ")])}),this.pendingContextChange=u,!t.state.readOnly){let f=this.to-this.from+(u.to-u.from+u.insert.length);KO(t,u,H.single(this.toEditorPos(n.selectionStart,f),this.toEditorPos(n.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state)),u.from<u.to&&!u.insert.length&&t.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(e.text.slice(Math.max(0,n.updateRangeStart-1),Math.min(e.text.length,n.updateRangeStart+1)))&&this.handlers.compositionend(n)},this.handlers.characterboundsupdate=n=>{let s=[],r=null;for(let o=this.toEditorPos(n.rangeStart),a=this.toEditorPos(n.rangeEnd);o<a;o++){let l=t.coordsForChar(o);r=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||r||new DOMRect,s.push(r)}e.updateCharacterBounds(n.rangeStart,s)},this.handlers.textformatupdate=n=>{let s=[];for(let r of n.getTextFormats()){let o=r.underlineStyle,a=r.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(a)){let l=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);if(l<c){let h=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(a)?1:2}px`;s.push(vt.mark({attributes:{style:h}}).range(l,c))}}}t.dispatch({effects:dk.of(vt.set(s))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(t.state)}};for(let n in this.handlers)e.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let s=Wc(n.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,n=!1,s=this.pendingContextChange;return t.changes.iterChanges((r,o,a,l,c)=>{if(n)return;let h=c.length-(o-r);if(s&&o>=s.to)if(s.from==r&&s.to==o&&s.insert.eq(c)){s=this.pendingContextChange=null,e+=h,this.to+=h;return}else s=null,this.revertPending(t.state);if(r+=e,o+=e,o<=this.from)this.from+=h,this.to+=h;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+c.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),c.toString()),this.to+=h}e+=h}),s&&!n&&this.revertPending(t.state),!n}update(t){let e=this.pendingContextChange,n=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(n.from,n.to)&&t.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),s=this.toContextPos(e.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(n,s)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let n=this.composing;return n&&n.drifted?n.editorBase+(t-n.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class ct{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:n}=t;this.dispatchTransactions=t.dispatchTransactions||n&&(s=>s.forEach(r=>n(r,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=t.root||qQ(t.parent)||document,this.viewState=new x2(t.state||Vt.create(t)),t.scrollTo&&t.scrollTo.is(Au)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(va).map(s=>new ig(s));for(let s of this.plugins)s.update(this);this.observer=new a$(this),this.inputState=new MN(this),this.inputState.ensureHandlers(this.plugins),this.docView=new n2(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof $e?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,n=!1,s,r=this.state;for(let f of t){if(f.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=f.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,a=0,l=null;t.some(f=>f.annotation(Ak))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=Mk(r,o),l||(a=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(h=null)):this.observer.clear(),r.facet(Vt.phrases)!=this.state.facet(Vt.phrases))return this.setState(r);s=Uf.create(this,r,t),s.flags|=a;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let f of t){if(u&&(u=u.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;u=new Ia(d.empty?d:H.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(Au)&&(u=d.value.clip(this.state))}this.viewState.update(s,u),this.bidiCache=Hf.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),e=this.docView.update(s),this.state.facet(sc)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Nu)!=s.state.facet(Nu)&&(this.viewState.mustMeasureContent=!0),(e||n||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!s.empty)for(let f of this.state.facet(Um))try{f(s)}catch(d){qi(this.state,d,"update listener")}(l||h)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!xk(this,h)&&c.force&&Ra(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new x2(t),this.plugins=t.facet(va).map(n=>new ig(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new n2(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(va),n=t.state.facet(va);if(e!=n){let s=[];for(let r of n){let o=e.indexOf(r);if(o<0)s.push(new ig(r));else{let a=this.plugins[o];a.mustUpdate=t,s.push(a)}}for(let r of this.plugins)r.mustUpdate!=t&&r.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=t;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);e!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(n){qi(this.state,n,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(Ww(n))r=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(s);r=d.from,o=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(d=>{try{return d.read(this)}catch(p){return qi(this.state,p),C2}}),u=Uf.create(this,this.state,[]),f=!1;u.flags|=l,e?e.flags|=l:e=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),f=this.docView.update(u),f&&this.docViewUpdate());for(let d=0;d<c.length;d++)if(h[d]!=C2)try{let p=c[d];p.write&&p.write(h[d],this)}catch(p){qi(this.state,p)}if(f&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(p>1||p<-1){s=s+p,n.scrollTop=s/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let a of this.state.facet(Um))a(e)}get themeClasses(){return t0+" "+(this.state.facet(Jm)?Qk:Ik)+" "+this.state.facet(Nu)}updateAttrs(){let t=T2(this,pk,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Xs)?"true":"false",class:"cm-content",style:`${ht.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),T2(this,YO,e);let n=this.observer.ignore(()=>{let s=qm(this.contentDOM,this.contentAttrs,e),r=qm(this.dom,this.editorAttrs,t);return s||r});return this.editorAttrs=t,this.contentAttrs=e,n}showAnnouncements(t){let e=!0;for(let n of t)for(let s of n.effects)if(s.is(ct.announce)){e&&(this.announceDOM.textContent=""),e=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(sc);let t=this.state.facet(ct.cspNonce);Wr.mount(this.root,this.styleModules.concat(r$).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.plugin!=t)&&this.pluginMap.set(t,e=this.plugins.find(n=>n.plugin==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,n){return sg(this,t,l2(this,t,e,n))}moveByGroup(t,e){return sg(this,t,l2(this,t,e,n=>_N(this,t.head,n)))}visualLineSide(t,e){let n=this.bidiSpans(t),s=this.textDirectionAt(t.from),r=n[e?n.length-1:0];return H.cursor(r.side(e,s)+t.from,r.forward(!e,s)?1:-1)}moveToLineBoundary(t,e,n=!0){return vN(this,t,e,n)}moveVertically(t,e,n){return sg(this,t,xN(this,t,e,n))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),bk(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let n=this.docView.coordsAt(t,e);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(t),r=this.bidiSpans(s),o=r[Mr.find(r,t-s.from,-1,e)];return Ph(n,o.dir==ge.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(hk)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>h$)return ik(t.length);let e=this.textDirectionAt(t.from),n;for(let r of this.bidiCache)if(r.from==t.from&&r.dir==e&&(r.fresh||ek(r.isolates,n=i2(this,t))))return r.order;n||(n=i2(this,t));let s=sN(t.text,e,n);return this.bidiCache.push(new Hf(t.from,t.to,e,n,!0,s)),s}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||ht.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Zw(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return Au.of(new Ia(typeof t=="number"?H.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,n=this.viewState.scrollAnchorAt(t);return Au.of(new Ia(H.cursor(n.from),"start","start",n.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Ae.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return Ae.define(()=>({}),{eventObservers:t})}static theme(t,e){let n=Wr.newName(),s=[Nu.of(n),sc.of(e0(`.${n}`,t))];return e&&e.dark&&s.push(Jm.of(!0)),s}static baseTheme(t){return io.lowest(sc.of(e0("."+t0,t,Nk)))}static findFromDOM(t){var e;let n=t.querySelector(".cm-content"),s=n&&Jt.get(n)||Jt.get(t);return((e=s?.rootView)===null||e===void 0?void 0:e.view)||null}}ct.styleModule=sc;ct.inputHandler=lk;ct.clipboardInputFilter=jO;ct.clipboardOutputFilter=UO;ct.scrollHandler=fk;ct.focusChangeEffect=ck;ct.perLineTextDirection=hk;ct.exceptionSink=ak;ct.updateListener=Um;ct.editable=Xs;ct.mouseSelectionStyle=ok;ct.dragMovesSelection=rk;ct.clickAddsSelectionRange=sk;ct.decorations=qc;ct.outerDecorations=gk;ct.atomicRanges=Eh;ct.bidiIsolatedRanges=mk;ct.scrollMargins=Ok;ct.darkTheme=Jm;ct.cspNonce=ut.define({combine:i=>i.length?i[0]:""});ct.contentAttributes=YO;ct.editorAttributes=pk;ct.lineWrapping=ct.contentAttributes.of({class:"cm-lineWrapping"});ct.announce=Ct.define();const h$=4096,C2={};class Hf{constructor(t,e,n,s,r,o){this.from=t,this.to=e,this.dir=n,this.isolates=s,this.fresh=r,this.order=o}static update(t,e){if(e.empty&&!t.some(r=>r.fresh))return t;let n=[],s=t.length?t[t.length-1].dir:ge.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let o=t[r];o.dir==s&&!e.touchesRange(o.from,o.to)&&n.push(new Hf(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function T2(i,t,e){for(let n=i.state.facet(t),s=n.length-1;s>=0;s--){let r=n[s],o=typeof r=="function"?r(i):r;o&&Wm(o,e)}return e}const u$=ht.mac?"mac":ht.windows?"win":ht.linux?"linux":"key";function f$(i,t){const e=i.split(/-(?!$)/);let n=e[e.length-1];n=="Space"&&(n=" ");let s,r,o,a;for(let l=0;l<e.length-1;++l){const c=e[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))s=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))t=="mac"?a=!0:r=!0;else throw new Error("Unrecognized modifier name: "+c)}return s&&(n="Alt-"+n),r&&(n="Ctrl-"+n),a&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function $u(i,t,e){return t.altKey&&(i="Alt-"+i),t.ctrlKey&&(i="Ctrl-"+i),t.metaKey&&(i="Meta-"+i),e!==!1&&t.shiftKey&&(i="Shift-"+i),i}const d$=io.default(ct.domEventHandlers({keydown(i,t){return Dk($k(t.state),i,t,"editor")}})),Rh=ut.define({enables:d$}),P2=new WeakMap;function $k(i){let t=i.facet(Rh),e=P2.get(t);return e||P2.set(t,e=m$(t.reduce((n,s)=>n.concat(s),[]))),e}function p$(i,t,e){return Dk($k(i.state),t,i,e)}let Cr=null;const g$=4e3;function m$(i,t=u$){let e=Object.create(null),n=Object.create(null),s=(o,a)=>{let l=n[o];if(l==null)n[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,a,l,c,h)=>{var u,f;let d=e[o]||(e[o]=Object.create(null)),p=a.split(/ (?!$)/).map(O=>f$(O,t));for(let O=1;O<p.length;O++){let y=p.slice(0,O).join(" ");s(y,!0),d[y]||(d[y]={preventDefault:!0,stopPropagation:!1,run:[_=>{let v=Cr={view:_,prefix:y,scope:o};return setTimeout(()=>{Cr==v&&(Cr=null)},g$),!0}]})}let g=p.join(" ");s(g,!1);let m=d[g]||(d[g]={preventDefault:!1,stopPropagation:!1,run:((f=(u=d._any)===null||u===void 0?void 0:u.run)===null||f===void 0?void 0:f.slice())||[]});l&&m.run.push(l),c&&(m.preventDefault=!0),h&&(m.stopPropagation=!0)};for(let o of i){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of a){let h=e[c]||(e[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=o;for(let f in h)h[f].run.push(d=>u(d,i0))}let l=o[t]||o.key;if(l)for(let c of a)r(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return e}let i0=null;function Dk(i,t,e,n){i0=t;let s=LQ(t),r=Bi(s,0),o=hs(r)==s.length&&s!=" ",a="",l=!1,c=!1,h=!1;Cr&&Cr.view==e&&Cr.scope==n&&(a=Cr.prefix+" ",kk.indexOf(t.keyCode)<0&&(c=!0,Cr=null));let u=new Set,f=m=>{if(m){for(let O of m.run)if(!u.has(O)&&(u.add(O),O(e)))return m.stopPropagation&&(h=!0),!0;m.preventDefault&&(m.stopPropagation&&(h=!0),c=!0)}return!1},d=i[n],p,g;return d&&(f(d[a+$u(s,t,!o)])?l=!0:o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(ht.windows&&t.ctrlKey&&t.altKey)&&!(ht.mac&&t.altKey&&!(t.ctrlKey||t.metaKey))&&(p=qr[t.keyCode])&&p!=s?(f(d[a+$u(p,t,!0)])||t.shiftKey&&(g=Fc[t.keyCode])!=s&&g!=p&&f(d[a+$u(g,t,!1)]))&&(l=!0):o&&t.shiftKey&&f(d[a+$u(s,t,!0)])&&(l=!0),!l&&f(d._any)&&(l=!0)),c&&(l=!0),l&&h&&t.stopPropagation(),i0=null,l}class Ih{constructor(t,e,n,s,r){this.className=t,this.left=e,this.top=n,this.width=s,this.height=r}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,n){if(n.empty){let s=t.coordsAtPos(n.head,n.assoc||1);if(!s)return[];let r=Lk(t);return[new Ih(e,s.left-r.left,s.top-r.top,null,s.bottom-s.top)]}else return O$(t,e,n)}}function Lk(i){let t=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==ge.LTR?t.left:t.right-i.scrollDOM.clientWidth*i.scaleX)-i.scrollDOM.scrollLeft*i.scaleX,top:t.top-i.scrollDOM.scrollTop*i.scaleY}}function A2(i,t,e,n){let s=i.coordsAtPos(t,e*2);if(!s)return n;let r=i.dom.getBoundingClientRect(),o=(s.top+s.bottom)/2,a=i.posAtCoords({x:r.left+1,y:o}),l=i.posAtCoords({x:r.right-1,y:o});return a==null||l==null?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}function O$(i,t,e){if(e.to<=i.viewport.from||e.from>=i.viewport.to)return[];let n=Math.max(e.from,i.viewport.from),s=Math.min(e.to,i.viewport.to),r=i.textDirection==ge.LTR,o=i.contentDOM,a=o.getBoundingClientRect(),l=Lk(i),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=a.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),f=a.right-(h?parseInt(h.paddingRight):0),d=Hm(i,n,1),p=Hm(i,s,-1),g=d.type==Ai.Text?d:null,m=p.type==Ai.Text?p:null;if(g&&(i.lineWrapping||d.widgetLineBreaks)&&(g=A2(i,n,1,g)),m&&(i.lineWrapping||p.widgetLineBreaks)&&(m=A2(i,s,-1,m)),g&&m&&g.from==m.from&&g.to==m.to)return y(_(e.from,e.to,g));{let b=g?_(e.from,null,g):v(d,!1),k=m?_(null,e.to,m):v(p,!0),x=[];return(g||d).to<(m||p).from-(g&&m?1:0)||d.widgetLineBreaks>1&&b.bottom+i.defaultLineHeight/2<k.top?x.push(O(u,b.bottom,f,k.top)):b.bottom<k.top&&i.elementAtHeight((b.bottom+k.top)/2).type==Ai.Text&&(b.bottom=k.top=(b.bottom+k.top)/2),y(b).concat(x).concat(y(k))}function O(b,k,x,C){return new Ih(t,b-l.left,k-l.top,x-b,C-k)}function y({top:b,bottom:k,horizontal:x}){let C=[];for(let I=0;I<x.length;I+=2)C.push(O(x[I],b,x[I+1],k));return C}function _(b,k,x){let C=1e9,I=-1e9,R=[];function $(F,W,B,U,V){let X=i.coordsAtPos(F,F==x.to?-2:2),j=i.coordsAtPos(B,B==x.from?2:-2);!X||!j||(C=Math.min(X.top,j.top,C),I=Math.max(X.bottom,j.bottom,I),V==ge.LTR?R.push(r&&W?u:X.left,r&&U?f:j.right):R.push(!r&&U?u:j.left,!r&&W?f:X.right))}let E=b??x.from,Z=k??x.to;for(let F of i.visibleRanges)if(F.to>E&&F.from<Z)for(let W=Math.max(F.from,E),B=Math.min(F.to,Z);;){let U=i.state.doc.lineAt(W);for(let V of i.bidiSpans(U)){let X=V.from+U.from,j=V.to+U.from;if(X>=B)break;j>W&&$(Math.max(X,W),b==null&&X<=E,Math.min(j,B),k==null&&j>=Z,V.dir)}if(W=U.to+1,W>=B)break}return R.length==0&&$(E,b==null,Z,k==null,i.textDirection),{top:C,bottom:I,horizontal:R}}function v(b,k){let x=a.top+(k?b.top:b.bottom);return{top:x,bottom:x,horizontal:[]}}}function y$(i,t){return i.constructor==t.constructor&&i.eq(t)}class b${constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(uf)!=t.state.facet(uf)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,n=t.facet(uf);for(;e<n.length&&n[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;(t!=this.scaleX||e!=this.scaleY)&&(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some((e,n)=>!y$(e,this.drawn[n]))){let e=this.dom.firstChild,n=0;for(let s of t)s.update&&e&&s.constructor&&this.drawn[n].constructor&&s.update(e,this.drawn[n])?(e=e.nextSibling,n++):this.dom.insertBefore(s.draw(),e);for(;e;){let s=e.nextSibling;e.remove(),e=s}this.drawn=t,ht.ios&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const uf=ut.define();function Vk(i){return[Ae.define(t=>new b$(t,i)),uf.of(i)]}const Xc=ut.define({combine(i){return Ms(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function v$(i={}){return[Xc.of(i),_$,x$,S$,uk.of(!0)]}function Bk(i){return i.startState.facet(Xc)!=i.state.facet(Xc)}const _$=Vk({above:!0,markers(i){let{state:t}=i,e=t.facet(Xc),n=[];for(let s of t.selection.ranges){let r=s==t.selection.main;if(s.empty||e.drawRangeCursor){let o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=s.empty?s:H.cursor(s.head,s.head>s.anchor?-1:1);for(let l of Ih.forRange(i,o,a))n.push(l)}}return n},update(i,t){i.transactions.some(n=>n.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let e=Bk(i);return e&&M2(i.state,t),i.docChanged||i.selectionSet||e},mount(i,t){M2(t.state,i)},class:"cm-cursorLayer"});function M2(i,t){t.style.animationDuration=i.facet(Xc).cursorBlinkRate+"ms"}const x$=Vk({above:!1,markers(i){return i.state.selection.ranges.map(t=>t.empty?[]:Ih.forRange(i,"cm-selectionBackground",t)).reduce((t,e)=>t.concat(e))},update(i,t){return i.docChanged||i.selectionSet||i.viewportChanged||Bk(i)},class:"cm-selectionLayer"}),S$=io.highest(ct.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Zk=Ct.define({map(i,t){return i==null?null:t.mapPos(i)}}),ac=Ke.define({create(){return null},update(i,t){return i!=null&&(i=t.changes.mapPos(i)),t.effects.reduce((e,n)=>n.is(Zk)?n.value:e,i)}}),w$=Ae.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var t;let e=i.state.field(ac);e==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(ac)!=e||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:i}=this,t=i.state.field(ac),e=t!=null&&i.coordsAtPos(t);if(!e)return null;let n=i.scrollDOM.getBoundingClientRect();return{left:e.left-n.left+i.scrollDOM.scrollLeft*i.scaleX,top:e.top-n.top+i.scrollDOM.scrollTop*i.scaleY,height:e.bottom-e.top}}drawCursor(i){if(this.cursor){let{scaleX:t,scaleY:e}=this.view;i?(this.cursor.style.left=i.left/t+"px",this.cursor.style.top=i.top/e+"px",this.cursor.style.height=i.height/e+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(ac)!=i&&this.view.dispatch({effects:Zk.of(i)})}},{eventObservers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function k$(){return[ac,w$]}function E2(i,t,e,n,s){t.lastIndex=0;for(let r=i.iterRange(e,n),o=e,a;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;a=t.exec(r.value);)s(o+a.index,a)}function C$(i,t){let e=i.visibleRanges;if(e.length==1&&e[0].from==i.viewport.from&&e[0].to==i.viewport.to)return e;let n=[];for(let{from:s,to:r}of e)s=Math.max(i.state.doc.lineAt(s).from,s-t),r=Math.min(i.state.doc.lineAt(r).to,r+t),n.length&&n[n.length-1].to>=s?n[n.length-1].to=r:n.push({from:s,to:r});return n}class T${constructor(t){const{regexp:e,decoration:n,decorate:s,boundary:r,maxLength:o=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,s)this.addMatch=(a,l,c,h)=>s(h,c,c+a[0].length,a,l);else if(typeof n=="function")this.addMatch=(a,l,c,h)=>{let u=n(a,l,c);u&&h(c,c+a[0].length,u)};else if(n)this.addMatch=(a,l,c,h)=>h(c,c+a[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=r,this.maxLength=o}createDeco(t){let e=new Hs,n=e.add.bind(e);for(let{from:s,to:r}of C$(t,this.maxLength))E2(t.state.doc,this.regexp,s,r,(o,a)=>this.addMatch(a,t,o,n));return e.finish()}updateDeco(t,e){let n=1e9,s=-1;return t.docChanged&&t.changes.iterChanges((r,o,a,l)=>{l>=t.view.viewport.from&&a<=t.view.viewport.to&&(n=Math.min(a,n),s=Math.max(l,s))}),t.viewportMoved||s-n>1e3?this.createDeco(t.view):s>-1?this.updateRange(t.view,e.map(t.changes),n,s):e}updateRange(t,e,n,s){for(let r of t.visibleRanges){let o=Math.max(r.from,n),a=Math.min(r.to,s);if(a>=o){let l=t.state.doc.lineAt(o),c=l.to<a?t.state.doc.lineAt(a):l,h=Math.max(r.from,l.from),u=Math.min(r.to,c.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){h=o;break}for(;a<c.to;a++)if(this.boundary.test(c.text[a-c.from])){u=a;break}}let f=[],d,p=(g,m,O)=>f.push(O.range(g,m));if(l==c)for(this.regexp.lastIndex=h-l.from;(d=this.regexp.exec(l.text))&&d.index<u-l.from;)this.addMatch(d,t,d.index+l.from,p);else E2(t.state.doc,this.regexp,h,u,(g,m)=>this.addMatch(m,t,g,p));e=e.update({filterFrom:h,filterTo:u,filter:(g,m)=>g<h||m>u,add:f})}}return e}}const n0=/x/.unicode!=null?"gu":"g",P$=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,n0),A$={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ag=null;function M$(){var i;if(ag==null&&typeof document<"u"&&document.body){let t=document.body.style;ag=((i=t.tabSize)!==null&&i!==void 0?i:t.MozTabSize)!=null}return ag||!1}const ff=ut.define({combine(i){let t=Ms(i,{render:null,specialChars:P$,addSpecialChars:null});return(t.replaceTabs=!M$())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,n0)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,n0)),t}});function E$(i={}){return[ff.of(i),R$()]}let R2=null;function R$(){return R2||(R2=Ae.fromClass(class{constructor(i){this.view=i,this.decorations=vt.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(ff)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new T$({regexp:i.specialChars,decoration:(t,e,n)=>{let{doc:s}=e.state,r=Bi(t[0],0);if(r==9){let o=s.lineAt(n),a=e.state.tabSize,l=ml(o.text,a,n-o.from);return vt.replace({widget:new $$((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=vt.replace({widget:new N$(i,r)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let t=i.state.facet(ff);i.startState.facet(ff)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}const I$="•";function Q$(i){return i>=32?I$:i==10?"␤":String.fromCharCode(9216+i)}class N$ extends Es{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=Q$(this.code),n=t.state.phrase("Control character")+" "+(A$[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,n,e);if(s)return s;let r=document.createElement("span");return r.textContent=e,r.title=n,r.setAttribute("aria-label",n),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class $$ extends Es{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function D$(){return V$}const L$=vt.line({class:"cm-activeLine"}),V$=Ae.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let t=-1,e=[];for(let n of i.state.selection.ranges){let s=i.lineBlockAt(n.head);s.from>t&&(e.push(L$.range(s.from)),t=s.from)}return vt.set(e)}},{decorations:i=>i.decorations});class B$ extends Es{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?Ja(t.firstChild):[];if(!e.length)return null;let n=window.getComputedStyle(t.parentNode),s=Ph(e[0],n.direction!="rtl"),r=parseInt(n.lineHeight);return s.bottom-s.top>r*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+r}:s}ignoreEvent(){return!1}}function Z$(i){let t=Ae.fromClass(class{constructor(e){this.view=e,this.placeholder=i?vt.set([vt.widget({widget:new B$(i),side:1}).range(0)]):vt.none}get decorations(){return this.view.state.doc.length?vt.none:this.placeholder}},{decorations:e=>e.decorations});return typeof i=="string"?[t,ct.contentAttributes.of({"aria-placeholder":i})]:t}const s0=2e3;function F$(i,t,e){let n=Math.min(t.line,e.line),s=Math.max(t.line,e.line),r=[];if(t.off>s0||e.off>s0||t.col<0||e.col<0){let o=Math.min(t.off,e.off),a=Math.max(t.off,e.off);for(let l=n;l<=s;l++){let c=i.doc.line(l);c.length<=a&&r.push(H.range(c.from+o,c.to+a))}}else{let o=Math.min(t.col,e.col),a=Math.max(t.col,e.col);for(let l=n;l<=s;l++){let c=i.doc.line(l),h=Nm(c.text,o,i.tabSize,!0);if(h<0)r.push(H.cursor(c.to));else{let u=Nm(c.text,a,i.tabSize);r.push(H.range(c.from+h,c.from+u))}}}return r}function W$(i,t){let e=i.coordsAtPos(i.viewport.from);return e?Math.round(Math.abs((e.left-t)/i.defaultCharacterWidth)):-1}function I2(i,t){let e=i.posAtCoords({x:t.clientX,y:t.clientY},!1),n=i.state.doc.lineAt(e),s=e-n.from,r=s>s0?-1:s==n.length?W$(i,t.clientX):ml(n.text,i.state.tabSize,e-n.from);return{line:n.number,col:r,off:s}}function q$(i,t){let e=I2(i,t),n=i.state.selection;return e?{update(s){if(s.docChanged){let r=s.changes.mapPos(s.startState.doc.line(e.line).from),o=s.state.doc.lineAt(r);e={line:o.number,col:e.col,off:Math.min(e.off,o.length)},n=n.map(s.changes)}},get(s,r,o){let a=I2(i,s);if(!a)return n;let l=F$(i.state,e,a);return l.length?o?H.create(l.concat(n.ranges)):H.create(l):n}}:null}function X$(i){let t=(e=>e.altKey&&e.button==0);return ct.mouseSelectionStyle.of((e,n)=>t(n)?q$(e,n):null)}const z$={Alt:[18,i=>!!i.altKey],Control:[17,i=>!!i.ctrlKey],Shift:[16,i=>!!i.shiftKey],Meta:[91,i=>!!i.metaKey]},G$={style:"cursor: crosshair"};function j$(i={}){let[t,e]=z$[i.key||"Alt"],n=Ae.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==t||e(s))},keyup(s){(s.keyCode==t||!e(s))&&this.set(!1)},mousemove(s){this.set(e(s))}}});return[n,ct.contentAttributes.of(s=>{var r;return!((r=s.plugin(n))===null||r===void 0)&&r.isDown?G$:null})]}const Xl="-10000px";class Fk{constructor(t,e,n,s){this.facet=e,this.createTooltipView=n,this.removeTooltipView=s,this.input=t.state.facet(e),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=n(o,r))}update(t,e){var n;let s=t.state.facet(this.facet),r=s.filter(l=>l);if(s===this.input){for(let l of this.tooltipViews)l.update&&l.update(t);return!1}let o=[],a=e?[]:null;for(let l=0;l<r.length;l++){let c=r[l],h=-1;if(c){for(let u=0;u<this.tooltips.length;u++){let f=this.tooltips[u];f&&f.create==c.create&&(h=u)}if(h<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),a&&(a[l]=!!c.above);else{let u=o[l]=this.tooltipViews[h];a&&(a[l]=e[h]),u.update&&u.update(t)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return e&&(a.forEach((l,c)=>e[c]=l),e.length=a.length),this.input=s,this.tooltips=r,this.tooltipViews=o,!0}}function U$(i){let t=i.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const lg=ut.define({combine:i=>{var t,e,n;return{position:ht.ios?"absolute":((t=i.find(s=>s.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=i.find(s=>s.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((n=i.find(s=>s.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||U$}}}),Q2=new WeakMap,e1=Ae.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=i.state.facet(lg);this.position=t.position,this.parent=t.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Fk(i,i1,(e,n)=>this.createTooltip(e,n),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(i,this.above);t&&this.observeIntersection();let e=t||i.geometryChanged,n=i.state.facet(lg);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;e=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(i,t){let e=i.create(this.view),n=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),i.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",e.dom.appendChild(s)}return e.dom.style.position=this.position,e.dom.style.top=Xl,e.dom.style.left="0px",this.container.insertBefore(e.dom,n),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var i,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(i=n.destroy)===null||i===void 0||i.call(n);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=1,t=1,e=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(ht.gecko)e=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Xl&&r.style.left=="0px"){let o=r.getBoundingClientRect();e=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(e||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(i=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:i,scaleY:t}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=HO(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(lg).tooltipSpace(this.view),scaleX:i,scaleY:t,makeAbsolute:e}}writeMeasure(i){var t;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:e,space:n,scaleX:s,scaleY:r}=i,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:h}=c,u=i.pos[a],f=i.size[a];if(!u||l.clip!==!1&&(u.bottom<=Math.max(e.top,n.top)||u.top>=Math.min(e.bottom,n.bottom)||u.right<Math.max(e.left,n.left)-.1||u.left>Math.min(e.right,n.right)+.1)){h.style.top=Xl;continue}let d=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,g=f.right-f.left,m=(t=Q2.get(c))!==null&&t!==void 0?t:f.bottom-f.top,O=c.offset||H$,y=this.view.textDirection==ge.LTR,_=f.width>n.right-n.left?y?n.left:n.right-f.width:y?Math.max(n.left,Math.min(u.left-(d?14:0)+O.x,n.right-g)):Math.min(Math.max(n.left,u.left-g+(d?14:0)-O.x),n.right-g),v=this.above[a];!l.strictSide&&(v?u.top-m-p-O.y<n.top:u.bottom+m+p+O.y>n.bottom)&&v==n.bottom-u.bottom>u.top-n.top&&(v=this.above[a]=!v);let b=(v?u.top-n.top:n.bottom-u.bottom)-p;if(b<m&&c.resize!==!1){if(b<this.view.defaultLineHeight){h.style.top=Xl;continue}Q2.set(c,m),h.style.height=(m=b)/r+"px"}else h.style.height&&(h.style.height="");let k=v?u.top-m-p-O.y:u.bottom+p+O.y,x=_+g;if(c.overlap!==!0)for(let C of o)C.left<x&&C.right>_&&C.top<k+m&&C.bottom>k&&(k=v?C.top-m-2-p:C.bottom+p+2);if(this.position=="absolute"?(h.style.top=(k-i.parent.top)/r+"px",N2(h,(_-i.parent.left)/s)):(h.style.top=k/r+"px",N2(h,_/s)),d){let C=u.left+(y?O.x:-O.x)-(_+14-7);d.style.left=C/s+"px"}c.overlap!==!0&&o.push({left:_,top:k,right:x,bottom:k+m}),h.classList.toggle("cm-tooltip-above",v),h.classList.toggle("cm-tooltip-below",!v),c.positioned&&c.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Xl}},{eventObservers:{scroll(){this.maybeMeasure()}}});function N2(i,t){let e=parseInt(i.style.left,10);(isNaN(e)||Math.abs(t-e)>1)&&(i.style.left=t+"px")}const Y$=ct.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),H$={x:0,y:0},i1=ut.define({enables:[e1,Y$]}),Kf=ut.define({combine:i=>i.reduce((t,e)=>t.concat(e),[])});class lp{static create(t){return new lp(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Fk(t,Kf,(e,n)=>this.createHostedView(e,n),e=>e.dom.remove())}createHostedView(t,e){let n=t.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(n.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&n.mount&&n.mount(this.view),n}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}passProp(t){let e;for(let n of this.manager.tooltipViews){let s=n[t];if(s!==void 0){if(e===void 0)e=s;else if(e!==s)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const K$=i1.compute([Kf],i=>{let t=i.facet(Kf);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var n;return(n=e.end)!==null&&n!==void 0?n:e.pos})),create:lp.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class J${constructor(t,e,n,s,r){this.view=t,this.source=e,this.field=n,this.setHover=s,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,n=t.docView.nearest(e.target);if(!n)return;let s,r=1;if(n instanceof Ar)s=n.posAtStart;else{if(s=t.posAtCoords(e),s==null)return;let a=t.coordsAtPos(s);if(!a||e.y<a.top||e.y>a.bottom||e.x<a.left-t.defaultCharacterWidth||e.x>a.right+t.defaultCharacterWidth)return;let l=t.bidiSpans(t.state.doc.lineAt(s)).find(h=>h.from<=s&&h.to>=s),c=l&&l.dir==ge.RTL?-1:1;r=e.x<a.left?-c:c}let o=this.source(t,s,r);if(o?.then){let a=this.pending={pos:s};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>qi(t.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let t=this.view.plugin(e1),e=t?t.manager.tooltips.findIndex(n=>n.create==lp.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,n;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:r}=this;if(s.length&&r&&!tD(r.dom,t)||this.pending){let{pos:o}=s[0]||this.pending,a=(n=(e=s[0])===null||e===void 0?void 0:e.end)!==null&&n!==void 0?n:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!eD(this.view,o,a,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:n}=this;n&&n.dom.contains(t.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=n=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Du=4;function tD(i,t){let{left:e,right:n,top:s,bottom:r}=i.getBoundingClientRect(),o;if(o=i.querySelector(".cm-tooltip-arrow")){let a=o.getBoundingClientRect();s=Math.min(a.top,s),r=Math.max(a.bottom,r)}return t.clientX>=e-Du&&t.clientX<=n+Du&&t.clientY>=s-Du&&t.clientY<=r+Du}function eD(i,t,e,n,s,r){let o=i.scrollDOM.getBoundingClientRect(),a=i.documentTop+i.documentPadding.top+i.contentHeight;if(o.left>n||o.right<n||o.top>s||Math.min(o.bottom,a)<s)return!1;let l=i.posAtCoords({x:n,y:s},!1);return l>=t&&l<=e}function iD(i,t={}){let e=Ct.define(),n=Ke.define({create(){return[]},update(s,r){if(s.length&&(t.hideOnChange&&(r.docChanged||r.selection)?s=[]:t.hideOn&&(s=s.filter(o=>!t.hideOn(r,o))),r.docChanged)){let o=[];for(let a of s){let l=r.changes.mapPos(a.pos,-1,ni.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),a);c.pos=l,c.end!=null&&(c.end=r.changes.mapPos(c.end)),o.push(c)}}s=o}for(let o of r.effects)o.is(e)&&(s=o.value),o.is(nD)&&(s=[]);return s},provide:s=>Kf.from(s)});return{active:n,extension:[n,Ae.define(s=>new J$(s,i,n,e,t.hoverTime||300)),K$]}}function Wk(i,t){let e=i.plugin(e1);if(!e)return null;let n=e.manager.tooltips.indexOf(t);return n<0?null:e.manager.tooltipViews[n]}const nD=Ct.define(),$2=ut.define({combine(i){let t,e;for(let n of i)t=t||n.topContainer,e=e||n.bottomContainer;return{topContainer:t,bottomContainer:e}}});function zc(i,t){let e=i.plugin(qk),n=e?e.specs.indexOf(t):-1;return n>-1?e.panels[n]:null}const qk=Ae.fromClass(class{constructor(i){this.input=i.state.facet(Gc),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(i));let t=i.state.facet($2);this.top=new Lu(i,!0,t.topContainer),this.bottom=new Lu(i,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(i){let t=i.state.facet($2);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Lu(i.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Lu(i.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=i.state.facet(Gc);if(e!=this.input){let n=e.filter(l=>l),s=[],r=[],o=[],a=[];for(let l of n){let c=this.specs.indexOf(l),h;c<0?(h=l(i.view),a.push(h)):(h=this.panels[c],h.update&&h.update(i)),s.push(h),(h.top?r:o).push(h)}this.specs=n,this.panels=s,this.top.sync(r),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>ct.scrollMargins.of(t=>{let e=t.plugin(i);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class Lu{constructor(t,e,n){this.view=t,this.top=e,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=D2(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=D2(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function D2(i){let t=i.nextSibling;return i.remove(),t}const Gc=ut.define({enables:qk});class Js extends Lo{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Js.prototype.elementClass="";Js.prototype.toDOM=void 0;Js.prototype.mapMode=ni.TrackBefore;Js.prototype.startSide=Js.prototype.endSide=-1;Js.prototype.point=!0;const df=ut.define(),sD=ut.define(),rD={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>zt.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Cc=ut.define();function oD(i){return[Xk(),Cc.of({...rD,...i})]}const L2=ut.define({combine:i=>i.some(t=>t)});function Xk(i){return[aD]}const aD=Ae.fromClass(class{constructor(i){this.view=i,this.domAfter=null,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=i.state.facet(Cc).map(t=>new B2(i,t)),this.fixed=!i.state.facet(L2);for(let t of this.gutters)t.config.side=="after"?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(i){if(this.updateGutters(i)){let t=this.prevViewport,e=i.view.viewport,n=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(n<(e.to-e.from)*.8)}if(i.geometryChanged){let t=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=t,this.domAfter&&(this.domAfter.style.minHeight=t)}this.view.state.facet(L2)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=i.view.viewport}syncGutters(i){let t=this.dom.nextSibling;i&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let e=zt.iter(this.view.state.facet(df),this.view.viewport.from),n=[],s=this.gutters.map(r=>new lD(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(r.type)){let o=!0;for(let a of r.type)if(a.type==Ai.Text&&o){r0(e,n,a.from);for(let l of s)l.line(this.view,a,n);o=!1}else if(a.widget)for(let l of s)l.widget(this.view,a)}else if(r.type==Ai.Text){r0(e,n,r.from);for(let o of s)o.line(this.view,r,n)}else if(r.widget)for(let o of s)o.widget(this.view,r);for(let r of s)r.finish();i&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(i){let t=i.startState.facet(Cc),e=i.state.facet(Cc),n=i.docChanged||i.heightChanged||i.viewportChanged||!zt.eq(i.startState.facet(df),i.state.facet(df),i.view.viewport.from,i.view.viewport.to);if(t==e)for(let s of this.gutters)s.update(i)&&(n=!0);else{n=!0;let s=[];for(let r of e){let o=t.indexOf(r);o<0?s.push(new B2(this.view,r)):(this.gutters[o].update(i),s.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),s.indexOf(r)<0&&r.destroy();for(let r of s)r.config.side=="after"?this.getDOMAfter().appendChild(r.dom):this.dom.appendChild(r.dom);this.gutters=s}return n}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:i=>ct.scrollMargins.of(t=>{let e=t.plugin(i);if(!e||e.gutters.length==0||!e.fixed)return null;let n=e.dom.offsetWidth*t.scaleX,s=e.domAfter?e.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==ge.LTR?{left:n,right:s}:{right:n,left:s}})});function V2(i){return Array.isArray(i)?i:[i]}function r0(i,t,e){for(;i.value&&i.from<=e;)i.from==e&&t.push(i.value),i.next()}class lD{constructor(t,e,n){this.gutter=t,this.height=n,this.i=0,this.cursor=zt.iter(t.markers,e.from)}addElement(t,e,n){let{gutter:s}=this,r=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==s.elements.length){let a=new zk(t,o,r,n);s.elements.push(a),s.dom.appendChild(a.dom)}else s.elements[this.i].update(t,o,r,n);this.height=e.bottom,this.i++}line(t,e,n){let s=[];r0(this.cursor,s,e.from),n.length&&(s=s.concat(n));let r=this.gutter.config.lineMarker(t,e,s);r&&s.unshift(r);let o=this.gutter;s.length==0&&!o.config.renderEmptyElements||this.addElement(t,e,s)}widget(t,e){let n=this.gutter.config.widgetMarker(t,e.widget,e),s=n?[n]:null;for(let r of t.state.facet(sD)){let o=r(t,e.widget,e);o&&(s||(s=[])).push(o)}s&&this.addElement(t,e,s)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class B2{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in e.domEventHandlers)this.dom.addEventListener(n,s=>{let r=s.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let l=r.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=s.clientY;let a=t.lineBlockAtHeight(o-t.documentTop);e.domEventHandlers[n](t,a,s)&&s.preventDefault()});this.markers=V2(e.markers(t)),e.initialSpacer&&(this.spacer=new zk(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=V2(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],t);s!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[s])}let n=t.view.viewport;return!zt.eq(this.markers,e,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class zk{constructor(t,e,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,n,s)}update(t,e,n,s){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),cD(this.markers,s)||this.setMarkers(t,s)}setMarkers(t,e){let n="cm-gutterElement",s=this.dom.firstChild;for(let r=0,o=0;;){let a=o,l=r<e.length?e[r++]:null,c=!1;if(l){let h=l.elementClass;h&&(n+=" "+h);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(l)){a=u,c=!0;break}}else a=this.markers.length;for(;o<a;){let h=this.markers[o++];if(h.toDOM){h.destroy(s);let u=s.nextSibling;s.remove(),s=u}}if(!l)break;l.toDOM&&(c?s=s.nextSibling:this.dom.insertBefore(l.toDOM(t),s)),c&&o++}this.dom.className=n,this.markers=e}destroy(){this.setMarkers(null,[])}}function cD(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++)if(!i[e].compare(t[e]))return!1;return!0}const hD=ut.define(),uD=ut.define(),_a=ut.define({combine(i){return Ms(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let n=Object.assign({},t);for(let s in e){let r=n[s],o=e[s];n[s]=r?(a,l,c)=>r(a,l,c)||o(a,l,c):o}return n}})}});class cg extends Js{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function hg(i,t){return i.state.facet(_a).formatNumber(t,i.state)}const fD=Cc.compute([_a],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(hD)},lineMarker(t,e,n){return n.some(s=>s.toDOM)?null:new cg(hg(t,t.state.doc.lineAt(e.from).number))},widgetMarker:(t,e,n)=>{for(let s of t.state.facet(uD)){let r=s(t,e,n);if(r)return r}return null},lineMarkerChange:t=>t.startState.facet(_a)!=t.state.facet(_a),initialSpacer(t){return new cg(hg(t,Z2(t.state.doc.lines)))},updateSpacer(t,e){let n=hg(e.view,Z2(e.view.state.doc.lines));return n==t.number?t:new cg(n)},domEventHandlers:i.facet(_a).domEventHandlers,side:"before"}));function dD(i={}){return[_a.of(i),Xk(),fD]}function Z2(i){let t=9;for(;t<i;)t=t*10+9;return t}const pD=new class extends Js{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},gD=df.compute(["selection"],i=>{let t=[],e=-1;for(let n of i.selection.ranges){let s=i.doc.lineAt(n.head).from;s>e&&(e=s,t.push(pD.range(s)))}return zt.of(t)});function mD(){return gD}const Gk=1024;let OD=0;class ug{constructor(t,e){this.from=t,this.to=e}}class Qt{constructor(t={}){this.id=OD++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Ui.match(t)),e=>{let n=t(e);return n===void 0?null:[this,n]}}}Qt.closedBy=new Qt({deserialize:i=>i.split(" ")});Qt.openedBy=new Qt({deserialize:i=>i.split(" ")});Qt.group=new Qt({deserialize:i=>i.split(" ")});Qt.isolate=new Qt({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});Qt.contextHash=new Qt({perNode:!0});Qt.lookAhead=new Qt({perNode:!0});Qt.mounted=new Qt({perNode:!0});class Jf{constructor(t,e,n){this.tree=t,this.overlay=e,this.parser=n}static get(t){return t&&t.props&&t.props[Qt.mounted.id]}}const yD=Object.create(null);class Ui{constructor(t,e,n,s=0){this.name=t,this.props=e,this.id=n,this.flags=s}static define(t){let e=t.props&&t.props.length?Object.create(null):yD,n=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),s=new Ui(t.name||"",e,t.id,n);if(t.props){for(let r of t.props)if(Array.isArray(r)||(r=r(s)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[r[0].id]=r[1]}}return s}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(Qt.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let n in t)for(let s of n.split(" "))e[s]=t[n];return n=>{for(let s=n.prop(Qt.group),r=-1;r<(s?s.length:0);r++){let o=e[r<0?n.name:s[r]];if(o)return o}}}}Ui.none=new Ui("",Object.create(null),0,8);class n1{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let n of this.types){let s=null;for(let r of t){let o=r(n);o&&(s||(s=Object.assign({},n.props)),s[o[0].id]=o[1])}e.push(s?new Ui(n.name,s,n.id,n.flags):n)}return new n1(e)}}const Vu=new WeakMap,F2=new WeakMap;var Fe;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(Fe||(Fe={}));class De{constructor(t,e,n,s,r){if(this.type=t,this.children=e,this.positions=n,this.length=s,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,a]of r)this.props[typeof o=="number"?o:o.id]=a}}toString(){let t=Jf.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let n of this.children){let s=n.toString();s&&(e&&(e+=","),e+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new a0(this.topNode,t)}cursorAt(t,e=0,n=0){let s=Vu.get(this)||this.topNode,r=new a0(s);return r.moveTo(t,e),Vu.set(this,r._tree),r}get topNode(){return new Gi(this,0,0,null)}resolve(t,e=0){let n=jc(Vu.get(this)||this.topNode,t,e,!1);return Vu.set(this,n),n}resolveInner(t,e=0){let n=jc(F2.get(this)||this.topNode,t,e,!0);return F2.set(this,n),n}resolveStack(t,e=0){return _D(this,t,e)}iterate(t){let{enter:e,leave:n,from:s=0,to:r=this.length}=t,o=t.mode||0,a=(o&Fe.IncludeAnonymous)>0;for(let l=this.cursor(o|Fe.IncludeAnonymous);;){let c=!1;if(l.from<=r&&l.to>=s&&(!a&&l.type.isAnonymous||e(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&n&&(a||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:o1(Ui.none,this.children,this.positions,0,this.children.length,0,this.length,(e,n,s)=>new De(this.type,e,n,s,this.propValues),t.makeTree||((e,n,s)=>new De(Ui.none,e,n,s)))}static build(t){return xD(t)}}De.empty=new De(Ui.none,[],[],0);class s1{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new s1(this.buffer,this.index)}}class zr{constructor(t,e,n){this.buffer=t,this.length=e,this.set=n}get type(){return Ui.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],n=this.buffer[t+3],s=this.set.types[e],r=s.name;if(/\W/.test(r)&&!s.isError&&(r=JSON.stringify(r)),t+=4,n==t)return r;let o=[];for(;t<n;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,n,s,r){let{buffer:o}=this,a=-1;for(let l=t;l!=e&&!(jk(r,s,o[l+1],o[l+2])&&(a=l,n>0));l=o[l+3]);return a}slice(t,e,n){let s=this.buffer,r=new Uint16Array(e-t),o=0;for(let a=t,l=0;a<e;){r[l++]=s[a++],r[l++]=s[a++]-n;let c=r[l++]=s[a++]-n;r[l++]=s[a++]-t,o=Math.max(o,c)}return new zr(r,o,this.set)}}function jk(i,t,e,n){switch(i){case-2:return e<t;case-1:return n>=t&&e<t;case 0:return e<t&&n>t;case 1:return e<=t&&n>t;case 2:return n>t;case 4:return!0}}function jc(i,t,e,n){for(var s;i.from==i.to||(e<1?i.from>=t:i.from>t)||(e>-1?i.to<=t:i.to<t);){let o=!n&&i instanceof Gi&&i.index<0?null:i.parent;if(!o)return i;i=o}let r=n?0:Fe.IgnoreOverlays;if(n)for(let o=i,a=o.parent;a;o=a,a=o.parent)o instanceof Gi&&o.index<0&&((s=a.enter(t,e,r))===null||s===void 0?void 0:s.from)!=o.from&&(i=a);for(;;){let o=i.enter(t,e,r);if(!o)return i;i=o}}class Uk{cursor(t=0){return new a0(this,t)}getChild(t,e=null,n=null){let s=W2(this,t,e,n);return s.length?s[0]:null}getChildren(t,e=null,n=null){return W2(this,t,e,n)}resolve(t,e=0){return jc(this,t,e,!1)}resolveInner(t,e=0){return jc(this,t,e,!0)}matchContext(t){return o0(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),n=this;for(;e;){let s=e.lastChild;if(!s||s.to!=e.to)break;s.type.isError&&s.from==s.to?(n=e,e=s.prevSibling):e=s}return n}get node(){return this}get next(){return this.parent}}class Gi extends Uk{constructor(t,e,n,s){super(),this._tree=t,this.from=e,this.index=n,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,n,s,r=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,c=e>0?a.length:-1;t!=c;t+=e){let h=a[t],u=l[t]+o.from;if(jk(s,n,u,u+h.length)){if(h instanceof zr){if(r&Fe.ExcludeBuffers)continue;let f=h.findChild(0,h.buffer.length,e,n-u,s);if(f>-1)return new ps(new bD(o,h,t,u),null,f)}else if(r&Fe.IncludeAnonymous||!h.type.isAnonymous||r1(h)){let f;if(!(r&Fe.IgnoreMounts)&&(f=Jf.get(h))&&!f.overlay)return new Gi(f.tree,u,t,o);let d=new Gi(h,u,t,o);return r&Fe.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(e<0?h.children.length-1:0,e,n,s)}}}if(r&Fe.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,n=0){let s;if(!(n&Fe.IgnoreOverlays)&&(s=Jf.get(this._tree))&&s.overlay){let r=t-this.from;for(let{from:o,to:a}of s.overlay)if((e>0?o<=r:o<r)&&(e<0?a>=r:a>r))return new Gi(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,n)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function W2(i,t,e,n){let s=i.cursor(),r=[];if(!s.firstChild())return r;if(e!=null){for(let o=!1;!o;)if(o=s.type.is(e),!s.nextSibling())return r}for(;;){if(n!=null&&s.type.is(n))return r;if(s.type.is(t)&&r.push(s.node),!s.nextSibling())return n==null?r:[]}}function o0(i,t,e=t.length-1){for(let n=i;e>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(t[e]&&t[e]!=n.name)return!1;e--}}return!0}class bD{constructor(t,e,n,s){this.parent=t,this.buffer=e,this.index=n,this.start=s}}class ps extends Uk{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,n){super(),this.context=t,this._parent=e,this.index=n,this.type=t.buffer.set.types[t.buffer.buffer[n]]}child(t,e,n){let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],t,e-this.context.start,n);return r<0?null:new ps(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,n=0){if(n&Fe.ExcludeBuffers)return null;let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new ps(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new ps(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new ps(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:n}=this.context,s=this.index+4,r=n.buffer[this.index+3];if(r>s){let o=n.buffer[this.index+1];t.push(n.slice(s,r,o)),e.push(0)}return new De(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Yk(i){if(!i.length)return null;let t=0,e=i[0];for(let r=1;r<i.length;r++){let o=i[r];(o.from>e.from||o.to<e.to)&&(e=o,t=r)}let n=e instanceof Gi&&e.index<0?null:e.parent,s=i.slice();return n?s[t]=n:s.splice(t,1),new vD(s,e)}class vD{constructor(t,e){this.heads=t,this.node=e}get next(){return Yk(this.heads)}}function _D(i,t,e){let n=i.resolveInner(t,e),s=null;for(let r=n instanceof Gi?n:n.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(s||(s=[n])).push(o.resolve(t,e)),r=o}else{let o=Jf.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=t&&o.overlay[o.overlay.length-1].to>=t){let a=new Gi(o.tree,o.overlay[0].from+r.from,-1,r);(s||(s=[n])).push(jc(a,t,e,!1))}}return s?Yk(s):n}class a0{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Gi)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let n=t._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:n,buffer:s}=this.buffer;return this.type=e||s.set.types[s.buffer[t]],this.from=n+s.buffer[t+1],this.to=n+s.buffer[t+2],!0}yield(t){return t?t instanceof Gi?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,n){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,n,this.mode));let{buffer:s}=this.buffer,r=s.findChild(this.index+4,s.buffer[this.index+3],t,e-this.buffer.start,n);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,n=this.mode){return this.buffer?n&Fe.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Fe.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&Fe.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,n=this.stack.length-1;if(t<0){let s=n<0?0:this.stack[n]+4;if(this.index!=s)return this.yieldBuf(e.findChild(s,this.index,-1,0,4))}else{let s=e.buffer[this.index+3];if(s<(n<0?e.buffer.length:e.buffer[this.stack[n]+3]))return this.yieldBuf(s)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,n,{buffer:s}=this;if(s){if(t>0){if(this.index<s.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(s.buffer.buffer[r+3]<this.index)return!1;({index:e,parent:n}=s)}else({index:e,_parent:n}=this._tree);for(;n;{index:e,_parent:n}=n)if(e>-1)for(let r=e+t,o=t<0?-1:n._tree.children.length;r!=o;r+=t){let a=n._tree.children[r];if(this.mode&Fe.IncludeAnonymous||a instanceof zr||!a.type.isAnonymous||r1(a))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,n=0;if(t&&t.context==this.buffer)t:for(let s=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==s){if(s==this.index)return o;e=o,n=r+1;break t}s=this.stack[--r]}for(let s=n;s<this.stack.length;s++)e=new ps(this.buffer,e,this.stack[s]);return this.bufferNode=new ps(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let n=0;;){let s=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&e&&e(this),s=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,s=!0}}}matchContext(t){if(!this.buffer)return o0(this.node.parent,t);let{buffer:e}=this.buffer,{types:n}=e.set;for(let s=t.length-1,r=this.stack.length-1;s>=0;r--){if(r<0)return o0(this._tree,t,s);let o=n[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[s]&&t[s]!=o.name)return!1;s--}}return!0}}function r1(i){return i.children.some(t=>t instanceof zr||!t.type.isAnonymous||r1(t))}function xD(i){var t;let{buffer:e,nodeSet:n,maxBufferLength:s=Gk,reused:r=[],minRepeatType:o=n.types.length}=i,a=Array.isArray(e)?new s1(e,e.length):e,l=n.types,c=0,h=0;function u(b,k,x,C,I,R){let{id:$,start:E,end:Z,size:F}=a,W=h,B=c;for(;F<0;)if(a.next(),F==-1){let tt=r[$];x.push(tt),C.push(E-b);return}else if(F==-3){c=$;return}else if(F==-4){h=$;return}else throw new RangeError(`Unrecognized record size: ${F}`);let U=l[$],V,X,j=E-b;if(Z-E<=s&&(X=m(a.pos-k,I))){let tt=new Uint16Array(X.size-X.skip),it=a.pos-X.size,_t=tt.length;for(;a.pos>it;)_t=O(X.start,tt,_t);V=new zr(tt,Z-X.start,n),j=X.start-b}else{let tt=a.pos-F;a.next();let it=[],_t=[],Nt=$>=o?$:-1,Ot=0,Mt=Z;for(;a.pos>tt;)Nt>=0&&a.id==Nt&&a.size>=0?(a.end<=Mt-s&&(p(it,_t,E,Ot,a.end,Mt,Nt,W,B),Ot=it.length,Mt=a.end),a.next()):R>2500?f(E,tt,it,_t):u(E,tt,it,_t,Nt,R+1);if(Nt>=0&&Ot>0&&Ot<it.length&&p(it,_t,E,Ot,E,Mt,Nt,W,B),it.reverse(),_t.reverse(),Nt>-1&&Ot>0){let Yt=d(U,B);V=o1(U,it,_t,0,it.length,0,Z-E,Yt,Yt)}else V=g(U,it,_t,Z-E,W-Z,B)}x.push(V),C.push(j)}function f(b,k,x,C){let I=[],R=0,$=-1;for(;a.pos>k;){let{id:E,start:Z,end:F,size:W}=a;if(W>4)a.next();else{if($>-1&&Z<$)break;$<0&&($=F-s),I.push(E,Z,F),R++,a.next()}}if(R){let E=new Uint16Array(R*4),Z=I[I.length-2];for(let F=I.length-3,W=0;F>=0;F-=3)E[W++]=I[F],E[W++]=I[F+1]-Z,E[W++]=I[F+2]-Z,E[W++]=W;x.push(new zr(E,I[2]-Z,n)),C.push(Z-b)}}function d(b,k){return(x,C,I)=>{let R=0,$=x.length-1,E,Z;if($>=0&&(E=x[$])instanceof De){if(!$&&E.type==b&&E.length==I)return E;(Z=E.prop(Qt.lookAhead))&&(R=C[$]+E.length+Z)}return g(b,x,C,I,R,k)}}function p(b,k,x,C,I,R,$,E,Z){let F=[],W=[];for(;b.length>C;)F.push(b.pop()),W.push(k.pop()+x-I);b.push(g(n.types[$],F,W,R-I,E-R,Z)),k.push(I-x)}function g(b,k,x,C,I,R,$){if(R){let E=[Qt.contextHash,R];$=$?[E].concat($):[E]}if(I>25){let E=[Qt.lookAhead,I];$=$?[E].concat($):[E]}return new De(b,k,x,C,$)}function m(b,k){let x=a.fork(),C=0,I=0,R=0,$=x.end-s,E={size:0,start:0,skip:0};t:for(let Z=x.pos-b;x.pos>Z;){let F=x.size;if(x.id==k&&F>=0){E.size=C,E.start=I,E.skip=R,R+=4,C+=4,x.next();continue}let W=x.pos-F;if(F<0||W<Z||x.start<$)break;let B=x.id>=o?4:0,U=x.start;for(x.next();x.pos>W;){if(x.size<0)if(x.size==-3)B+=4;else break t;else x.id>=o&&(B+=4);x.next()}I=U,C+=F,R+=B}return(k<0||C==b)&&(E.size=C,E.start=I,E.skip=R),E.size>4?E:void 0}function O(b,k,x){let{id:C,start:I,end:R,size:$}=a;if(a.next(),$>=0&&C<o){let E=x;if($>4){let Z=a.pos-($-4);for(;a.pos>Z;)x=O(b,k,x)}k[--x]=E,k[--x]=R-b,k[--x]=I-b,k[--x]=C}else $==-3?c=C:$==-4&&(h=C);return x}let y=[],_=[];for(;a.pos>0;)u(i.start||0,i.bufferStart||0,y,_,-1,0);let v=(t=i.length)!==null&&t!==void 0?t:y.length?_[0]+y[0].length:0;return new De(l[i.topID],y.reverse(),_.reverse(),v)}const q2=new WeakMap;function pf(i,t){if(!i.isAnonymous||t instanceof zr||t.type!=i)return 1;let e=q2.get(t);if(e==null){e=1;for(let n of t.children){if(n.type!=i||!(n instanceof De)){e=1;break}e+=pf(i,n)}q2.set(t,e)}return e}function o1(i,t,e,n,s,r,o,a,l){let c=0;for(let p=n;p<s;p++)c+=pf(i,t[p]);let h=Math.ceil(c*1.5/8),u=[],f=[];function d(p,g,m,O,y){for(let _=m;_<O;){let v=_,b=g[_],k=pf(i,p[_]);for(_++;_<O;_++){let x=pf(i,p[_]);if(k+x>=h)break;k+=x}if(_==v+1){if(k>h){let x=p[v];d(x.children,x.positions,0,x.children.length,g[v]+y);continue}u.push(p[v])}else{let x=g[_-1]+p[_-1].length-b;u.push(o1(i,p,g,v,_,b,x,null,l))}f.push(b+y-r)}}return d(t,e,n,s,0),(a||l)(u,f,o)}class SD{constructor(){this.map=new WeakMap}setBuffer(t,e,n){let s=this.map.get(t);s||this.map.set(t,s=new Map),s.set(e,n)}getBuffer(t,e){let n=this.map.get(t);return n&&n.get(e)}set(t,e){t instanceof ps?this.setBuffer(t.context.buffer,t.index,e):t instanceof Gi&&this.map.set(t.tree,e)}get(t){return t instanceof ps?this.getBuffer(t.context.buffer,t.index):t instanceof Gi?this.map.get(t.tree):void 0}cursorSet(t,e){t.buffer?this.setBuffer(t.buffer.buffer,t.index,e):this.map.set(t.tree,e)}cursorGet(t){return t.buffer?this.getBuffer(t.buffer.buffer,t.index):this.map.get(t.tree)}}class To{constructor(t,e,n,s,r=!1,o=!1){this.from=t,this.to=e,this.tree=n,this.offset=s,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],n=!1){let s=[new To(0,t.length,t,0,!1,n)];for(let r of e)r.to>t.length&&s.push(r);return s}static applyChanges(t,e,n=128){if(!e.length)return t;let s=[],r=1,o=t.length?t[0]:null;for(let a=0,l=0,c=0;;a++){let h=a<e.length?e[a]:null,u=h?h.fromA:1e9;if(u-l>=n)for(;o&&o.from<u;){let f=o;if(l>=f.from||u<=f.to||c){let d=Math.max(f.from,l)-c,p=Math.min(f.to,u)-c;f=d>=p?null:new To(d,p,f.tree,f.offset+c,a>0,!!h)}if(f&&s.push(f),o.to>u)break;o=r<t.length?t[r++]:null}if(!h)break;l=h.toA,c=h.toA-h.toB}return s}}let Hk=class{startParse(t,e,n){return typeof t=="string"&&(t=new wD(t)),n=n?n.length?n.map(s=>new ug(s.from,s.to)):[new ug(0,0)]:[new ug(0,t.length)],this.createParse(t,e||[],n)}parse(t,e,n){let s=this.startParse(t,e,n);for(;;){let r=s.advance();if(r)return r}}};class wD{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new Qt({perNode:!0});let kD=0;class On{constructor(t,e,n,s){this.name=t,this.set=e,this.base=n,this.modified=s,this.id=kD++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let n=typeof t=="string"?t:"?";if(t instanceof On&&(e=t),e?.base)throw new Error("Can not derive from a modified tag");let s=new On(n,[],null,[]);if(s.set.push(s),e)for(let r of e.set)s.set.push(r);return s}static defineModifier(t){let e=new td(t);return n=>n.modified.indexOf(e)>-1?n:td.get(n.base||n,n.modified.concat(e).sort((s,r)=>s.id-r.id))}}let CD=0;class td{constructor(t){this.name=t,this.instances=[],this.id=CD++}static get(t,e){if(!e.length)return t;let n=e[0].instances.find(a=>a.base==t&&TD(e,a.modified));if(n)return n;let s=[],r=new On(t.name,s,t,e);for(let a of e)a.instances.push(r);let o=PD(e);for(let a of t.set)if(!a.modified.length)for(let l of o)s.push(td.get(a,l));return r}}function TD(i,t){return i.length==t.length&&i.every((e,n)=>e==t[n])}function PD(i){let t=[[]];for(let e=0;e<i.length;e++)for(let n=0,s=t.length;n<s;n++)t.push(t[n].concat(i[e]));return t.sort((e,n)=>n.length-e.length)}function Kk(i){let t=Object.create(null);for(let e in i){let n=i[e];Array.isArray(n)||(n=[n]);for(let s of e.split(" "))if(s){let r=[],o=2,a=s;for(let u=0;;){if(a=="..."&&u>0&&u+3==s.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+s);if(r.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==s.length)break;let d=s[u++];if(u==s.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+s);a=s.slice(u)}let l=r.length-1,c=r[l];if(!c)throw new RangeError("Invalid path: "+s);let h=new ed(n,o,l>0?r.slice(0,l):null);t[c]=h.sort(t[c])}}return Jk.add(t)}const Jk=new Qt;class ed{constructor(t,e,n,s){this.tags=t,this.mode=e,this.context=n,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}ed.empty=new ed([],2,null);function t5(i,t){let e=Object.create(null);for(let r of i)if(!Array.isArray(r.tag))e[r.tag.id]=r.class;else for(let o of r.tag)e[o.id]=r.class;let{scope:n,all:s=null}=t||{};return{style:r=>{let o=s;for(let a of r)for(let l of a.set){let c=e[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:n}}function AD(i,t){let e=null;for(let n of i){let s=n.style(t);s&&(e=e?e+" "+s:s)}return e}function MD(i,t,e,n=0,s=i.length){let r=new ED(n,Array.isArray(t)?t:[t],e);r.highlightRange(i.cursor(),n,s,"",r.highlighters),r.flush(s)}class ED{constructor(t,e,n){this.at=t,this.highlighters=e,this.span=n,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,n,s,r){let{type:o,from:a,to:l}=t;if(a>=n||l<=e)return;o.isTop&&(r=this.highlighters.filter(d=>!d.scope||d.scope(o)));let c=s,h=RD(t)||ed.empty,u=AD(r,h.tags);if(u&&(c&&(c+=" "),c+=u,h.mode==1&&(s+=(s?" ":"")+u)),this.startSpan(Math.max(e,a),c),h.opaque)return;let f=t.tree&&t.tree.prop(Qt.mounted);if(f&&f.overlay){let d=t.node.enter(f.overlay[0].from+a,1),p=this.highlighters.filter(m=>!m.scope||m.scope(f.tree.type)),g=t.firstChild();for(let m=0,O=a;;m++){let y=m<f.overlay.length?f.overlay[m]:null,_=y?y.from+a:l,v=Math.max(e,O),b=Math.min(n,_);if(v<b&&g)for(;t.from<b&&(this.highlightRange(t,v,b,s,r),this.startSpan(Math.min(b,t.to),c),!(t.to>=_||!t.nextSibling())););if(!y||_>n)break;O=y.to+a,O>e&&(this.highlightRange(d.cursor(),Math.max(e,y.from+a),Math.min(n,O),"",p),this.startSpan(Math.min(n,O),c))}g&&t.parent()}else if(t.firstChild()){f&&(s="");do if(!(t.to<=e)){if(t.from>=n)break;this.highlightRange(t,e,n,s,r),this.startSpan(Math.min(n,t.to),c)}while(t.nextSibling());t.parent()}}}function RD(i){let t=i.type.prop(Jk);for(;t&&t.context&&!i.matchContext(t.context);)t=t.next;return t||null}const lt=On.define,Bu=lt(),xr=lt(),X2=lt(xr),z2=lt(xr),Sr=lt(),Zu=lt(Sr),fg=lt(Sr),ss=lt(),ho=lt(ss),is=lt(),ns=lt(),l0=lt(),zl=lt(l0),Fu=lt(),N={comment:Bu,lineComment:lt(Bu),blockComment:lt(Bu),docComment:lt(Bu),name:xr,variableName:lt(xr),typeName:X2,tagName:lt(X2),propertyName:z2,attributeName:lt(z2),className:lt(xr),labelName:lt(xr),namespace:lt(xr),macroName:lt(xr),literal:Sr,string:Zu,docString:lt(Zu),character:lt(Zu),attributeValue:lt(Zu),number:fg,integer:lt(fg),float:lt(fg),bool:lt(Sr),regexp:lt(Sr),escape:lt(Sr),color:lt(Sr),url:lt(Sr),keyword:is,self:lt(is),null:lt(is),atom:lt(is),unit:lt(is),modifier:lt(is),operatorKeyword:lt(is),controlKeyword:lt(is),definitionKeyword:lt(is),moduleKeyword:lt(is),operator:ns,derefOperator:lt(ns),arithmeticOperator:lt(ns),logicOperator:lt(ns),bitwiseOperator:lt(ns),compareOperator:lt(ns),updateOperator:lt(ns),definitionOperator:lt(ns),typeOperator:lt(ns),controlOperator:lt(ns),punctuation:l0,separator:lt(l0),bracket:zl,angleBracket:lt(zl),squareBracket:lt(zl),paren:lt(zl),brace:lt(zl),content:ss,heading:ho,heading1:lt(ho),heading2:lt(ho),heading3:lt(ho),heading4:lt(ho),heading5:lt(ho),heading6:lt(ho),contentSeparator:lt(ss),list:lt(ss),quote:lt(ss),emphasis:lt(ss),strong:lt(ss),link:lt(ss),monospace:lt(ss),strikethrough:lt(ss),inserted:lt(),deleted:lt(),changed:lt(),invalid:lt(),meta:Fu,documentMeta:lt(Fu),annotation:lt(Fu),processingInstruction:lt(Fu),definition:On.defineModifier("definition"),constant:On.defineModifier("constant"),function:On.defineModifier("function"),standard:On.defineModifier("standard"),local:On.defineModifier("local"),special:On.defineModifier("special")};for(let i in N){let t=N[i];t instanceof On&&(t.name=i)}t5([{tag:N.link,class:"tok-link"},{tag:N.heading,class:"tok-heading"},{tag:N.emphasis,class:"tok-emphasis"},{tag:N.strong,class:"tok-strong"},{tag:N.keyword,class:"tok-keyword"},{tag:N.atom,class:"tok-atom"},{tag:N.bool,class:"tok-bool"},{tag:N.url,class:"tok-url"},{tag:N.labelName,class:"tok-labelName"},{tag:N.inserted,class:"tok-inserted"},{tag:N.deleted,class:"tok-deleted"},{tag:N.literal,class:"tok-literal"},{tag:N.string,class:"tok-string"},{tag:N.number,class:"tok-number"},{tag:[N.regexp,N.escape,N.special(N.string)],class:"tok-string2"},{tag:N.variableName,class:"tok-variableName"},{tag:N.local(N.variableName),class:"tok-variableName tok-local"},{tag:N.definition(N.variableName),class:"tok-variableName tok-definition"},{tag:N.special(N.variableName),class:"tok-variableName2"},{tag:N.definition(N.propertyName),class:"tok-propertyName tok-definition"},{tag:N.typeName,class:"tok-typeName"},{tag:N.namespace,class:"tok-namespace"},{tag:N.className,class:"tok-className"},{tag:N.macroName,class:"tok-macroName"},{tag:N.propertyName,class:"tok-propertyName"},{tag:N.operator,class:"tok-operator"},{tag:N.comment,class:"tok-comment"},{tag:N.meta,class:"tok-meta"},{tag:N.invalid,class:"tok-invalid"},{tag:N.punctuation,class:"tok-punctuation"}]);var dg;const xa=new Qt;function e5(i){return ut.define({combine:i?t=>t.concat(i):void 0})}const a1=new Qt;class Dn{constructor(t,e,n=[],s=""){this.data=t,this.name=s,Vt.prototype.hasOwnProperty("tree")||Object.defineProperty(Vt.prototype,"tree",{get(){return ze(this)}}),this.parser=e,this.extension=[Gr.of(this),Vt.languageData.of((r,o,a)=>{let l=G2(r,o,a),c=l.type.prop(xa);if(!c)return[];let h=r.facet(c),u=l.type.prop(a1);if(u){let f=l.resolve(o-l.from,a);for(let d of u)if(d.test(f,r)){let p=r.facet(d.facet);return d.type=="replace"?p:p.concat(h)}}return h})].concat(n)}isActiveAt(t,e,n=-1){return G2(t,e,n).type.prop(xa)==this.data}findRegions(t){let e=t.facet(Gr);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let n=[],s=(r,o)=>{if(r.prop(xa)==this.data){n.push({from:o,to:o+r.length});return}let a=r.prop(Qt.mounted);if(a){if(a.tree.prop(xa)==this.data){if(a.overlay)for(let l of a.overlay)n.push({from:l.from+o,to:l.to+o});else n.push({from:o,to:o+r.length});return}else if(a.overlay){let l=n.length;if(s(a.tree,a.overlay[0].from+o),n.length>l)return}}for(let l=0;l<r.children.length;l++){let c=r.children[l];c instanceof De&&s(c,r.positions[l]+o)}};return s(ze(t),0),n}get allowsNesting(){return!0}}Dn.setState=Ct.define();function G2(i,t,e){let n=i.facet(Gr),s=ze(i).topNode;if(!n||n.allowsNesting)for(let r=s;r;r=r.enter(t,e,Fe.ExcludeBuffers))r.type.isTop&&(s=r);return s}class id extends Dn{constructor(t,e,n){super(t,e,[],n),this.parser=e}static define(t){let e=e5(t.languageData);return new id(e,t.parser.configure({props:[xa.add(n=>n.isTop?e:void 0)]}),t.name)}configure(t,e){return new id(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function ze(i){let t=i.field(Dn.state,!1);return t?t.tree:De.empty}class ID{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let n=this.cursorPos-this.string.length;return t<n||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-n,e-n)}}let Gl=null;class nd{constructor(t,e,n=[],s,r,o,a,l){this.parser=t,this.state=e,this.fragments=n,this.tree=s,this.treeLen=r,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,n){return new nd(t,e,[],De.empty,0,n,[],null)}startParse(){return this.parser.startParse(new ID(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=De.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof t=="number"){let s=Date.now()+t;t=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(To.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(To.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Gl;Gl=this;try{return t()}finally{Gl=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=j2(t,e.from,e.to);return t}changes(t,e){let{fragments:n,tree:s,treeLen:r,viewport:o,skipped:a}=this;if(this.takeTree(),!t.empty){let l=[];if(t.iterChangedRanges((c,h,u,f)=>l.push({fromA:c,toA:h,fromB:u,toB:f})),n=To.applyChanges(n,l),s=De.empty,r=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let h=t.mapPos(c.from,1),u=t.mapPos(c.to,-1);h<u&&a.push({from:h,to:u})}}}return new nd(this.parser,e,n,s,r,o,a,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:s,to:r}=this.skipped[n];s<t.to&&r>t.from&&(this.fragments=j2(this.fragments,s,r),this.skipped.splice(n--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Hk{createParse(e,n,s){let r=s[0].from,o=s[s.length-1].to;return{parsedPos:r,advance(){let l=Gl;if(l){for(let c of s)l.tempSkipped.push(c);t&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,t]):t)}return this.parsedPos=o,new De(Ui.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return Gl}}function j2(i,t,e){return To.applyChanges(i,[{fromA:t,toA:e,fromB:t,toB:e}])}class nl{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),n=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,n)||e.takeTree(),new nl(e)}static init(t){let e=Math.min(3e3,t.doc.length),n=nd.create(t.facet(Gr).parser,t,{from:0,to:e});return n.work(20,e)||n.takeTree(),new nl(n)}}Dn.state=Ke.define({create:nl.init,update(i,t){for(let e of t.effects)if(e.is(Dn.setState))return e.value;return t.startState.facet(Gr)!=t.state.facet(Gr)?nl.init(t.state):i.apply(t)}});let i5=i=>{let t=setTimeout(()=>i(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(i5=i=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(i,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const pg=typeof navigator<"u"&&(!((dg=navigator.scheduling)===null||dg===void 0)&&dg.isInputPending)?()=>navigator.scheduling.isInputPending():null,QD=Ae.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Dn.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Dn.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=i5(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:s}}=this.view,r=n.field(Dn.state);if(r.tree==r.context.tree&&r.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!pg?Math.max(25,t.timeRemaining()-5):1e9),a=r.context.treeLen<s&&n.doc.length>s+1e3,l=r.context.work(()=>pg&&pg()||Date.now()>o,s+(a?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Dn.setState.of(new nl(r.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>qi(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Gr=ut.define({combine(i){return i.length?i[0]:null},enables:i=>[Dn.state,QD,ct.contentAttributes.compute([i],t=>{let e=t.facet(i);return e&&e.name?{"data-language":e.name}:{}})]});class ND{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const $D=ut.define(),Qh=ut.define({combine:i=>{if(!i.length)return"  ";let t=i[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return t}});function sd(i){let t=i.facet(Qh);return t.charCodeAt(0)==9?i.tabSize*t.length:t.length}function Uc(i,t){let e="",n=i.tabSize,s=i.facet(Qh)[0];if(s=="	"){for(;t>=n;)e+="	",t-=n;s=" "}for(let r=0;r<t;r++)e+=s;return e}function l1(i,t){i instanceof Vt&&(i=new cp(i));for(let n of i.state.facet($D)){let s=n(i,t);if(s!==void 0)return s}let e=ze(i.state);return e.length>=t?DD(i,e,t):null}class cp{constructor(t,e={}){this.state=t,this.options=e,this.unit=sd(t)}lineAt(t,e=1){let n=this.state.doc.lineAt(t),{simulateBreak:s,simulateDoubleBreak:r}=this.options;return s!=null&&s>=n.from&&s<=n.to?r&&s==t?{text:"",from:t}:(e<0?s<t:s<=t)?{text:n.text.slice(s-n.from),from:s}:{text:n.text.slice(0,s-n.from),from:n.from}:n}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:n,from:s}=this.lineAt(t,e);return n.slice(t-s,Math.min(n.length,t+100-s))}column(t,e=1){let{text:n,from:s}=this.lineAt(t,e),r=this.countColumn(n,t-s),o=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return o>-1&&(r+=o-this.countColumn(n,n.search(/\S|$/))),r}countColumn(t,e=t.length){return ml(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:n,from:s}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let o=r(s);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const n5=new Qt;function DD(i,t,e){let n=t.resolveStack(e),s=t.resolveInner(e,-1).resolve(e,0).enterUnfinishedNodesBefore(e);if(s!=n.node){let r=[];for(let o=s;o&&!(o.from<n.node.from||o.to>n.node.to||o.from==n.node.from&&o.type==n.node.type);o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)n={node:r[o],next:n}}return s5(n,i,e)}function s5(i,t,e){for(let n=i;n;n=n.next){let s=VD(n.node);if(s)return s(c1.create(t,e,n))}return 0}function LD(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function VD(i){let t=i.type.prop(n5);if(t)return t;let e=i.firstChild,n;if(e&&(n=e.type.prop(Qt.closedBy))){let s=i.lastChild,r=s&&n.indexOf(s.name)>-1;return o=>r5(o,!0,1,void 0,r&&!LD(o)?s.from:void 0)}return i.parent==null?BD:null}function BD(){return 0}class c1 extends cp{constructor(t,e,n){super(t.state,t.options),this.base=t,this.pos=e,this.context=n}get node(){return this.context.node}static create(t,e,n){return new c1(t,e,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let n=t.resolve(e.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(ZD(n,t))break;e=this.state.doc.lineAt(n.from)}return this.lineIndent(e.from)}continue(){return s5(this.context.next,this.base,this.pos)}}function ZD(i,t){for(let e=t;e;e=e.parent)if(i==e)return!0;return!1}function FD(i){let t=i.node,e=t.childAfter(t.from),n=t.lastChild;if(!e)return null;let s=i.options.simulateBreak,r=i.state.doc.lineAt(e.from),o=s==null||s<=r.from?r.to:Math.min(r.to,s);for(let a=e.to;;){let l=t.childAfter(a);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(r.text.slice(e.to-r.from))[0].length;return{from:e.from,to:e.to+c}}a=l.to}}function WD({closing:i,align:t=!0,units:e=1}){return n=>r5(n,t,e,i)}function r5(i,t,e,n,s){let r=i.textAfter,o=r.match(/^\s*/)[0].length,a=n&&r.slice(o,o+n.length)==n||s==i.pos+o,l=t?FD(i):null;return l?a?i.column(l.from):i.column(l.to):i.baseIndent+(a?0:i.unit*e)}const qD=i=>i.baseIndent;function gg({except:i,units:t=1}={}){return e=>{let n=i&&i.test(e.textAfter);return e.baseIndent+(n?0:t*e.unit)}}const XD=200;function zD(){return Vt.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let t=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!t.length)return i;let e=i.newDoc,{head:n}=i.newSelection.main,s=e.lineAt(n);if(n>s.from+XD)return i;let r=e.sliceString(s.from,n);if(!t.some(c=>c.test(r)))return i;let{state:o}=i,a=-1,l=[];for(let{head:c}of o.selection.ranges){let h=o.doc.lineAt(c);if(h.from==a)continue;a=h.from;let u=l1(o,h.from);if(u==null)continue;let f=/^\s*/.exec(h.text)[0],d=Uc(o,u);f!=d&&l.push({from:h.from,to:h.from+f.length,insert:d})}return l.length?[i,{changes:l,sequential:!0}]:i})}const GD=ut.define(),o5=new Qt;function jD(i){let t=i.firstChild,e=i.lastChild;return t&&t.to<e.from?{from:t.to,to:e.type.isError?i.to:e.from}:null}function UD(i,t,e){let n=ze(i);if(n.length<e)return null;let s=n.resolveStack(e,1),r=null;for(let o=s;o;o=o.next){let a=o.node;if(a.to<=e||a.from>e)continue;if(r&&a.from<t)break;let l=a.type.prop(o5);if(l&&(a.to<n.length-50||n.length==i.doc.length||!YD(a))){let c=l(a,i);c&&c.from<=e&&c.from>=t&&c.to>e&&(r=c)}}return r}function YD(i){let t=i.lastChild;return t&&t.to==i.to&&t.type.isError}function rd(i,t,e){for(let n of i.facet(GD)){let s=n(i,t,e);if(s)return s}return UD(i,t,e)}function a5(i,t){let e=t.mapPos(i.from,1),n=t.mapPos(i.to,-1);return e>=n?void 0:{from:e,to:n}}const hp=Ct.define({map:a5}),Nh=Ct.define({map:a5});function l5(i){let t=[];for(let{head:e}of i.state.selection.ranges)t.some(n=>n.from<=e&&n.to>=e)||t.push(i.lineBlockAt(e));return t}const Fo=Ke.define({create(){return vt.none},update(i,t){t.isUserEvent("delete")&&t.changes.iterChangedRanges((e,n)=>i=U2(i,e,n)),i=i.map(t.changes);for(let e of t.effects)if(e.is(hp)&&!HD(i,e.value.from,e.value.to)){let{preparePlaceholder:n}=t.state.facet(u5),s=n?vt.replace({widget:new sL(n(t.state,e.value))}):Y2;i=i.update({add:[s.range(e.value.from,e.value.to)]})}else e.is(Nh)&&(i=i.update({filter:(n,s)=>e.value.from!=n||e.value.to!=s,filterFrom:e.value.from,filterTo:e.value.to}));return t.selection&&(i=U2(i,t.selection.main.head)),i},provide:i=>ct.decorations.from(i),toJSON(i,t){let e=[];return i.between(0,t.doc.length,(n,s)=>{e.push(n,s)}),e},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<i.length;){let n=i[e++],s=i[e++];if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");t.push(Y2.range(n,s))}return vt.set(t,!0)}});function U2(i,t,e=t){let n=!1;return i.between(t,e,(s,r)=>{s<e&&r>t&&(n=!0)}),n?i.update({filterFrom:t,filterTo:e,filter:(s,r)=>s>=e||r<=t}):i}function od(i,t,e){var n;let s=null;return(n=i.field(Fo,!1))===null||n===void 0||n.between(t,e,(r,o)=>{(!s||s.from>r)&&(s={from:r,to:o})}),s}function HD(i,t,e){let n=!1;return i.between(t,t,(s,r)=>{s==t&&r==e&&(n=!0)}),n}function c5(i,t){return i.field(Fo,!1)?t:t.concat(Ct.appendConfig.of(f5()))}const KD=i=>{for(let t of l5(i)){let e=rd(i.state,t.from,t.to);if(e)return i.dispatch({effects:c5(i.state,[hp.of(e),h5(i,e)])}),!0}return!1},JD=i=>{if(!i.state.field(Fo,!1))return!1;let t=[];for(let e of l5(i)){let n=od(i.state,e.from,e.to);n&&t.push(Nh.of(n),h5(i,n,!1))}return t.length&&i.dispatch({effects:t}),t.length>0};function h5(i,t,e=!0){let n=i.state.doc.lineAt(t.from).number,s=i.state.doc.lineAt(t.to).number;return ct.announce.of(`${i.state.phrase(e?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${s}.`)}const tL=i=>{let{state:t}=i,e=[];for(let n=0;n<t.doc.length;){let s=i.lineBlockAt(n),r=rd(t,s.from,s.to);r&&e.push(hp.of(r)),n=(r?i.lineBlockAt(r.to):s).to+1}return e.length&&i.dispatch({effects:c5(i.state,e)}),!!e.length},eL=i=>{let t=i.state.field(Fo,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,i.state.doc.length,(n,s)=>{e.push(Nh.of({from:n,to:s}))}),i.dispatch({effects:e}),!0},iL=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:KD},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:JD},{key:"Ctrl-Alt-[",run:tL},{key:"Ctrl-Alt-]",run:eL}],nL={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},u5=ut.define({combine(i){return Ms(i,nL)}});function f5(i){return[Fo,aL]}function d5(i,t){let{state:e}=i,n=e.facet(u5),s=o=>{let a=i.lineBlockAt(i.posAtDOM(o.target)),l=od(i.state,a.from,a.to);l&&i.dispatch({effects:Nh.of(l)}),o.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(i,s,t);let r=document.createElement("span");return r.textContent=n.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=s,r}const Y2=vt.replace({widget:new class extends Es{toDOM(i){return d5(i,null)}}});class sL extends Es{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return d5(t,this.value)}}const rL={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class mg extends Js{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function oL(i={}){let t={...rL,...i},e=new mg(t,!0),n=new mg(t,!1),s=Ae.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Gr)!=o.state.facet(Gr)||o.startState.field(Fo,!1)!=o.state.field(Fo,!1)||ze(o.startState)!=ze(o.state)||t.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new Hs;for(let l of o.viewportLineBlocks){let c=od(o.state,l.from,l.to)?n:rd(o.state,l.from,l.to)?e:null;c&&a.add(l.from,l.from,c)}return a.finish()}}),{domEventHandlers:r}=t;return[s,oD({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(s))===null||a===void 0?void 0:a.markers)||zt.empty},initialSpacer(){return new mg(t,!1)},domEventHandlers:{...r,click:(o,a,l)=>{if(r.click&&r.click(o,a,l))return!0;let c=od(o.state,a.from,a.to);if(c)return o.dispatch({effects:Nh.of(c)}),!0;let h=rd(o.state,a.from,a.to);return h?(o.dispatch({effects:hp.of(h)}),!0):!1}}}),f5()]}const aL=ct.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class $h{constructor(t,e){this.specs=t;let n;function s(a){let l=Wr.newName();return(n||(n=Object.create(null)))["."+l]=a,l}const r=typeof e.all=="string"?e.all:e.all?s(e.all):void 0,o=e.scope;this.scope=o instanceof Dn?a=>a.prop(xa)==o.data:o?a=>a==o:void 0,this.style=t5(t.map(a=>({tag:a.tag,class:a.class||s(Object.assign({},a,{tag:null}))})),{all:r}).style,this.module=n?new Wr(n):null,this.themeType=e.themeType}static define(t,e){return new $h(t,e||{})}}const c0=ut.define(),p5=ut.define({combine(i){return i.length?[i[0]]:null}});function Og(i){let t=i.facet(c0);return t.length?t:i.facet(p5)}function g5(i,t){let e=[cL],n;return i instanceof $h&&(i.module&&e.push(ct.styleModule.of(i.module)),n=i.themeType),t?.fallback?e.push(p5.of(i)):n?e.push(c0.computeN([ct.darkTheme],s=>s.facet(ct.darkTheme)==(n=="dark")?[i]:[])):e.push(c0.of(i)),e}class lL{constructor(t){this.markCache=Object.create(null),this.tree=ze(t.state),this.decorations=this.buildDeco(t,Og(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=ze(t.state),n=Og(t.state),s=n!=Og(t.startState),{viewport:r}=t.view,o=t.changes.mapPos(this.decoratedTo,1);e.length<r.to&&!s&&e.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=o):(e!=this.tree||t.viewportChanged||s)&&(this.tree=e,this.decorations=this.buildDeco(t.view,n),this.decoratedTo=r.to)}buildDeco(t,e){if(!e||!this.tree.length)return vt.none;let n=new Hs;for(let{from:s,to:r}of t.visibleRanges)MD(this.tree,e,(o,a,l)=>{n.add(o,a,this.markCache[l]||(this.markCache[l]=vt.mark({class:l})))},s,r);return n.finish()}}const cL=io.high(Ae.fromClass(lL,{decorations:i=>i.decorations})),hL=$h.define([{tag:N.meta,color:"#404740"},{tag:N.link,textDecoration:"underline"},{tag:N.heading,textDecoration:"underline",fontWeight:"bold"},{tag:N.emphasis,fontStyle:"italic"},{tag:N.strong,fontWeight:"bold"},{tag:N.strikethrough,textDecoration:"line-through"},{tag:N.keyword,color:"#708"},{tag:[N.atom,N.bool,N.url,N.contentSeparator,N.labelName],color:"#219"},{tag:[N.literal,N.inserted],color:"#164"},{tag:[N.string,N.deleted],color:"#a11"},{tag:[N.regexp,N.escape,N.special(N.string)],color:"#e40"},{tag:N.definition(N.variableName),color:"#00f"},{tag:N.local(N.variableName),color:"#30a"},{tag:[N.typeName,N.namespace],color:"#085"},{tag:N.className,color:"#167"},{tag:[N.special(N.variableName),N.macroName],color:"#256"},{tag:N.definition(N.propertyName),color:"#00c"},{tag:N.comment,color:"#940"},{tag:N.invalid,color:"#f00"}]),uL=ct.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),m5=1e4,O5="()[]{}",y5=ut.define({combine(i){return Ms(i,{afterCursor:!0,brackets:O5,maxScanDistance:m5,renderMatch:pL})}}),fL=vt.mark({class:"cm-matchingBracket"}),dL=vt.mark({class:"cm-nonmatchingBracket"});function pL(i){let t=[],e=i.matched?fL:dL;return t.push(e.range(i.start.from,i.start.to)),i.end&&t.push(e.range(i.end.from,i.end.to)),t}const gL=Ke.define({create(){return vt.none},update(i,t){if(!t.docChanged&&!t.selection)return i;let e=[],n=t.state.facet(y5);for(let s of t.state.selection.ranges){if(!s.empty)continue;let r=gs(t.state,s.head,-1,n)||s.head>0&&gs(t.state,s.head-1,1,n)||n.afterCursor&&(gs(t.state,s.head,1,n)||s.head<t.state.doc.length&&gs(t.state,s.head+1,-1,n));r&&(e=e.concat(n.renderMatch(r,t.state)))}return vt.set(e,!0)},provide:i=>ct.decorations.from(i)}),mL=[gL,uL];function OL(i={}){return[y5.of(i),mL]}const yL=new Qt;function h0(i,t,e){let n=i.prop(t<0?Qt.openedBy:Qt.closedBy);if(n)return n;if(i.name.length==1){let s=e.indexOf(i.name);if(s>-1&&s%2==(t<0?1:0))return[e[s+t]]}return null}function u0(i){let t=i.type.prop(yL);return t?t(i.node):i}function gs(i,t,e,n={}){let s=n.maxScanDistance||m5,r=n.brackets||O5,o=ze(i),a=o.resolveInner(t,e);for(let l=a;l;l=l.parent){let c=h0(l.type,e,r);if(c&&l.from<l.to){let h=u0(l);if(h&&(e>0?t>=h.from&&t<h.to:t>h.from&&t<=h.to))return bL(i,t,e,l,h,c,r)}}return vL(i,t,e,o,a.type,s,r)}function bL(i,t,e,n,s,r,o){let a=n.parent,l={from:s.from,to:s.to},c=0,h=a?.cursor();if(h&&(e<0?h.childBefore(n.from):h.childAfter(n.to)))do if(e<0?h.to<=n.from:h.from>=n.to){if(c==0&&r.indexOf(h.type.name)>-1&&h.from<h.to){let u=u0(h);return{start:l,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(h0(h.type,e,o))c++;else if(h0(h.type,-e,o)){if(c==0){let u=u0(h);return{start:l,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}c--}}while(e<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function vL(i,t,e,n,s,r,o){let a=e<0?i.sliceDoc(t-1,t):i.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=e>0)return null;let c={from:e<0?t-1:t,to:e>0?t+1:t},h=i.doc.iterRange(t,e>0?i.doc.length:0),u=0;for(let f=0;!h.next().done&&f<=r;){let d=h.value;e<0&&(f+=d.length);let p=t+f*e;for(let g=e>0?0:d.length-1,m=e>0?d.length:-1;g!=m;g+=e){let O=o.indexOf(d[g]);if(!(O<0||n.resolveInner(p+g,1).type!=s))if(O%2==0==e>0)u++;else{if(u==1)return{start:c,end:{from:p+g,to:p+g+1},matched:O>>1==l>>1};u--}}e>0&&(f+=d.length)}return h.done?{start:c,matched:!1}:null}const _L=Object.create(null),H2=[Ui.none],K2=[],J2=Object.create(null),xL=Object.create(null);for(let[i,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])xL[i]=SL(_L,t);function yg(i,t){K2.indexOf(i)>-1||(K2.push(i),console.warn(t))}function SL(i,t){let e=[];for(let a of t.split(" ")){let l=[];for(let c of a.split(".")){let h=i[c]||N[c];h?typeof h=="function"?l.length?l=l.map(h):yg(c,`Modifier ${c} used at start of tag`):l.length?yg(c,`Tag ${c} used as modifier`):l=Array.isArray(h)?h:[h]:yg(c,`Unknown highlighting tag ${c}`)}for(let c of l)e.push(c)}if(!e.length)return 0;let n=t.replace(/ /g,"_"),s=n+" "+e.map(a=>a.id),r=J2[s];if(r)return r.id;let o=J2[s]=Ui.define({id:H2.length,name:n,props:[Kk({[n]:e})]});return H2.push(o),o.id}ge.RTL,ge.LTR;const wL=i=>{let{state:t}=i,e=t.doc.lineAt(t.selection.main.from),n=u1(i.state,e.from);return n.line?kL(i):n.block?TL(i):!1};function h1(i,t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let s=i(t,e);return s?(n(e.update(s)),!0):!1}}const kL=h1(ML,0),CL=h1(b5,0),TL=h1((i,t)=>b5(i,t,AL(t)),0);function u1(i,t){let e=i.languageDataAt("commentTokens",t,1);return e.length?e[0]:{}}const jl=50;function PL(i,{open:t,close:e},n,s){let r=i.sliceDoc(n-jl,n),o=i.sliceDoc(s,s+jl),a=/\s*$/.exec(r)[0].length,l=/^\s*/.exec(o)[0].length,c=r.length-a;if(r.slice(c-t.length,c)==t&&o.slice(l,l+e.length)==e)return{open:{pos:n-a,margin:a&&1},close:{pos:s+l,margin:l&&1}};let h,u;s-n<=2*jl?h=u=i.sliceDoc(n,s):(h=i.sliceDoc(n,n+jl),u=i.sliceDoc(s-jl,s));let f=/^\s*/.exec(h)[0].length,d=/\s*$/.exec(u)[0].length,p=u.length-d-e.length;return h.slice(f,f+t.length)==t&&u.slice(p,p+e.length)==e?{open:{pos:n+f+t.length,margin:/\s/.test(h.charAt(f+t.length))?1:0},close:{pos:s-d-e.length,margin:/\s/.test(u.charAt(p-1))?1:0}}:null}function AL(i){let t=[];for(let e of i.selection.ranges){let n=i.doc.lineAt(e.from),s=e.to<=n.to?n:i.doc.lineAt(e.to);s.from>n.from&&s.from==e.to&&(s=e.to==n.to+1?n:i.doc.lineAt(e.to-1));let r=t.length-1;r>=0&&t[r].to>n.from?t[r].to=s.to:t.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return t}function b5(i,t,e=t.selection.ranges){let n=e.map(r=>u1(t,r.from).block);if(!n.every(r=>r))return null;let s=e.map((r,o)=>PL(t,n[o],r.from,r.to));if(i!=2&&!s.every(r=>r))return{changes:t.changes(e.map((r,o)=>s[o]?[]:[{from:r.from,insert:n[o].open+" "},{from:r.to,insert:" "+n[o].close}]))};if(i!=1&&s.some(r=>r)){let r=[];for(let o=0,a;o<s.length;o++)if(a=s[o]){let l=n[o],{open:c,close:h}=a;r.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+l.close.length})}return{changes:r}}return null}function ML(i,t,e=t.selection.ranges){let n=[],s=-1;for(let{from:r,to:o}of e){let a=n.length,l=1e9,c=u1(t,r).line;if(c){for(let h=r;h<=o;){let u=t.doc.lineAt(h);if(u.from>s&&(r==o||o>u.from)){s=u.from;let f=/^\s*/.exec(u.text)[0].length,d=f==u.length,p=u.text.slice(f,f+c.length)==c?f:-1;f<u.text.length&&f<l&&(l=f),n.push({line:u,comment:p,token:c,indent:f,empty:d,single:!1})}h=u.to+1}if(l<1e9)for(let h=a;h<n.length;h++)n[h].indent<n[h].line.text.length&&(n[h].indent=l);n.length==a+1&&(n[a].single=!0)}}if(i!=2&&n.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:a,token:l,indent:c,empty:h,single:u}of n)(u||!h)&&r.push({from:a.from+c,insert:l+" "});let o=t.changes(r);return{changes:o,selection:t.selection.map(o,1)}}else if(i!=1&&n.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:a,token:l}of n)if(a>=0){let c=o.from+a,h=c+l.length;o.text[h-o.from]==" "&&h++,r.push({from:c,to:h})}return{changes:r}}return null}const f0=hr.define(),EL=hr.define(),RL=ut.define(),v5=ut.define({combine(i){return Ms(i,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(n,s)=>t(n,s)||e(n,s)})}}),_5=Ke.define({create(){return ms.empty},update(i,t){let e=t.state.facet(v5),n=t.annotation(f0);if(n){let l=Xi.fromTransaction(t,n.selection),c=n.side,h=c==0?i.undone:i.done;return l?h=ad(h,h.length,e.minDepth,l):h=w5(h,t.startState.selection),new ms(c==0?n.rest:h,c==0?h:n.rest)}let s=t.annotation(EL);if((s=="full"||s=="before")&&(i=i.isolate()),t.annotation($e.addToHistory)===!1)return t.changes.empty?i:i.addMapping(t.changes.desc);let r=Xi.fromTransaction(t),o=t.annotation($e.time),a=t.annotation($e.userEvent);return r?i=i.addChanges(r,o,a,e,t):t.selection&&(i=i.addSelection(t.startState.selection,o,a,e.newGroupDelay)),(s=="full"||s=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(t=>t.toJSON()),undone:i.undone.map(t=>t.toJSON())}},fromJSON(i){return new ms(i.done.map(Xi.fromJSON),i.undone.map(Xi.fromJSON))}});function IL(i={}){return[_5,v5.of(i),ct.domEventHandlers({beforeinput(t,e){let n=t.inputType=="historyUndo"?x5:t.inputType=="historyRedo"?d0:null;return n?(t.preventDefault(),n(e)):!1}})]}function up(i,t){return function({state:e,dispatch:n}){if(!t&&e.readOnly)return!1;let s=e.field(_5,!1);if(!s)return!1;let r=s.pop(i,e,t);return r?(n(r),!0):!1}}const x5=up(0,!1),d0=up(1,!1),QL=up(0,!0),NL=up(1,!0);class Xi{constructor(t,e,n,s,r){this.changes=t,this.effects=e,this.mapped=n,this.startSelection=s,this.selectionsAfter=r}setSelAfter(t){return new Xi(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,n;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(t){return new Xi(t.changes&&Ze.fromJSON(t.changes),[],t.mapped&&bs.fromJSON(t.mapped),t.startSelection&&H.fromJSON(t.startSelection),t.selectionsAfter.map(H.fromJSON))}static fromTransaction(t,e){let n=xn;for(let s of t.startState.facet(RL)){let r=s(t);r.length&&(n=n.concat(r))}return!n.length&&t.changes.empty?null:new Xi(t.changes.invert(t.startState.doc),n,void 0,e||t.startState.selection,xn)}static selection(t){return new Xi(void 0,xn,void 0,void 0,t)}}function ad(i,t,e,n){let s=t+1>e+20?t-e-1:0,r=i.slice(s,t);return r.push(n),r}function $L(i,t){let e=[],n=!1;return i.iterChangedRanges((s,r)=>e.push(s,r)),t.iterChangedRanges((s,r,o,a)=>{for(let l=0;l<e.length;){let c=e[l++],h=e[l++];a>=c&&o<=h&&(n=!0)}}),n}function DL(i,t){return i.ranges.length==t.ranges.length&&i.ranges.filter((e,n)=>e.empty!=t.ranges[n].empty).length===0}function S5(i,t){return i.length?t.length?i.concat(t):i:t}const xn=[],LL=200;function w5(i,t){if(i.length){let e=i[i.length-1],n=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-LL));return n.length&&n[n.length-1].eq(t)?i:(n.push(t),ad(i,i.length-1,1e9,e.setSelAfter(n)))}else return[Xi.selection([t])]}function VL(i){let t=i[i.length-1],e=i.slice();return e[i.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function bg(i,t){if(!i.length)return i;let e=i.length,n=xn;for(;e;){let s=BL(i[e-1],t,n);if(s.changes&&!s.changes.empty||s.effects.length){let r=i.slice(0,e);return r[e-1]=s,r}else t=s.mapped,e--,n=s.selectionsAfter}return n.length?[Xi.selection(n)]:xn}function BL(i,t,e){let n=S5(i.selectionsAfter.length?i.selectionsAfter.map(a=>a.map(t)):xn,e);if(!i.changes)return Xi.selection(n);let s=i.changes.map(t),r=t.mapDesc(i.changes,!0),o=i.mapped?i.mapped.composeDesc(r):r;return new Xi(s,Ct.mapEffects(i.effects,t),o,i.startSelection.map(r),n)}const ZL=/^(input\.type|delete)($|\.)/;class ms{constructor(t,e,n=0,s=void 0){this.done=t,this.undone=e,this.prevTime=n,this.prevUserEvent=s}isolate(){return this.prevTime?new ms(this.done,this.undone):this}addChanges(t,e,n,s,r){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&t.changes&&(!n||ZL.test(n))&&(!a.selectionsAfter.length&&e-this.prevTime<s.newGroupDelay&&s.joinToEvent(r,$L(a.changes,t.changes))||n=="input.type.compose")?o=ad(o,o.length-1,s.minDepth,new Xi(t.changes.compose(a.changes),S5(Ct.mapEffects(t.effects,a.changes),a.effects),a.mapped,a.startSelection,xn)):o=ad(o,o.length,s.minDepth,t),new ms(o,xn,e,n)}addSelection(t,e,n,s){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:xn;return r.length>0&&e-this.prevTime<s&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&DL(r[r.length-1],t)?this:new ms(w5(this.done,t),this.undone,e,n)}addMapping(t){return new ms(bg(this.done,t),bg(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,n){let s=t==0?this.done:this.undone;if(s.length==0)return null;let r=s[s.length-1],o=r.selectionsAfter[0]||e.selection;if(n&&r.selectionsAfter.length)return e.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:f0.of({side:t,rest:VL(s),selection:o}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let a=s.length==1?xn:s.slice(0,s.length-1);return r.mapped&&(a=bg(a,r.mapped)),e.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:f0.of({side:t,rest:a,selection:o}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}ms.empty=new ms(xn,xn);const FL=[{key:"Mod-z",run:x5,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:d0,preventDefault:!0},{linux:"Ctrl-Shift-z",run:d0,preventDefault:!0},{key:"Mod-u",run:QL,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:NL,preventDefault:!0}];function Ol(i,t){return H.create(i.ranges.map(t),i.mainIndex)}function jn(i,t){return i.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Un({state:i,dispatch:t},e){let n=Ol(i.selection,e);return n.eq(i.selection,!0)?!1:(t(jn(i,n)),!0)}function fp(i,t){return H.cursor(t?i.to:i.from)}function k5(i,t){return Un(i,e=>e.empty?i.moveByChar(e,t):fp(e,t))}function bi(i){return i.textDirectionAt(i.state.selection.main.head)==ge.LTR}const C5=i=>k5(i,!bi(i)),T5=i=>k5(i,bi(i));function P5(i,t){return Un(i,e=>e.empty?i.moveByGroup(e,t):fp(e,t))}const WL=i=>P5(i,!bi(i)),qL=i=>P5(i,bi(i));function XL(i,t,e){if(t.type.prop(e))return!0;let n=t.to-t.from;return n&&(n>2||/[^\s,.;:]/.test(i.sliceDoc(t.from,t.to)))||t.firstChild}function dp(i,t,e){let n=ze(i).resolveInner(t.head),s=e?Qt.closedBy:Qt.openedBy;for(let l=t.head;;){let c=e?n.childAfter(l):n.childBefore(l);if(!c)break;XL(i,c,s)?n=c:l=e?c.to:c.from}let r=n.type.prop(s),o,a;return r&&(o=e?gs(i,n.from,1):gs(i,n.to,-1))&&o.matched?a=e?o.end.to:o.end.from:a=e?n.to:n.from,H.cursor(a,e?-1:1)}const zL=i=>Un(i,t=>dp(i.state,t,!bi(i))),GL=i=>Un(i,t=>dp(i.state,t,bi(i)));function A5(i,t){return Un(i,e=>{if(!e.empty)return fp(e,t);let n=i.moveVertically(e,t);return n.head!=e.head?n:i.moveToLineBoundary(e,t)})}const M5=i=>A5(i,!1),E5=i=>A5(i,!0);function R5(i){let t=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,e=0,n=0,s;if(t){for(let r of i.state.facet(ct.scrollMargins)){let o=r(i);o?.top&&(e=Math.max(o?.top,e)),o?.bottom&&(n=Math.max(o?.bottom,n))}s=i.scrollDOM.clientHeight-e-n}else s=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:e,marginBottom:n,selfScroll:t,height:Math.max(i.defaultLineHeight,s-5)}}function I5(i,t){let e=R5(i),{state:n}=i,s=Ol(n.selection,o=>o.empty?i.moveVertically(o,t,e.height):fp(o,t));if(s.eq(n.selection))return!1;let r;if(e.selfScroll){let o=i.coordsAtPos(n.selection.main.head),a=i.scrollDOM.getBoundingClientRect(),l=a.top+e.marginTop,c=a.bottom-e.marginBottom;o&&o.top>l&&o.bottom<c&&(r=ct.scrollIntoView(s.main.head,{y:"start",yMargin:o.top-l}))}return i.dispatch(jn(n,s),{effects:r}),!0}const tv=i=>I5(i,!1),p0=i=>I5(i,!0);function no(i,t,e){let n=i.lineBlockAt(t.head),s=i.moveToLineBoundary(t,e);if(s.head==t.head&&s.head!=(e?n.to:n.from)&&(s=i.moveToLineBoundary(t,e,!1)),!e&&s.head==n.from&&n.length){let r=/^\s*/.exec(i.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;r&&t.head!=n.from+r&&(s=H.cursor(n.from+r))}return s}const jL=i=>Un(i,t=>no(i,t,!0)),UL=i=>Un(i,t=>no(i,t,!1)),YL=i=>Un(i,t=>no(i,t,!bi(i))),HL=i=>Un(i,t=>no(i,t,bi(i))),KL=i=>Un(i,t=>H.cursor(i.lineBlockAt(t.head).from,1)),JL=i=>Un(i,t=>H.cursor(i.lineBlockAt(t.head).to,-1));function tV(i,t,e){let n=!1,s=Ol(i.selection,r=>{let o=gs(i,r.head,-1)||gs(i,r.head,1)||r.head>0&&gs(i,r.head-1,1)||r.head<i.doc.length&&gs(i,r.head+1,-1);if(!o||!o.end)return r;n=!0;let a=o.start.from==r.head?o.end.to:o.end.from;return H.cursor(a)});return n?(t(jn(i,s)),!0):!1}const eV=({state:i,dispatch:t})=>tV(i,t);function Mn(i,t){let e=Ol(i.state.selection,n=>{let s=t(n);return H.range(n.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return e.eq(i.state.selection)?!1:(i.dispatch(jn(i.state,e)),!0)}function Q5(i,t){return Mn(i,e=>i.moveByChar(e,t))}const N5=i=>Q5(i,!bi(i)),$5=i=>Q5(i,bi(i));function D5(i,t){return Mn(i,e=>i.moveByGroup(e,t))}const iV=i=>D5(i,!bi(i)),nV=i=>D5(i,bi(i)),sV=i=>Mn(i,t=>dp(i.state,t,!bi(i))),rV=i=>Mn(i,t=>dp(i.state,t,bi(i)));function L5(i,t){return Mn(i,e=>i.moveVertically(e,t))}const V5=i=>L5(i,!1),B5=i=>L5(i,!0);function Z5(i,t){return Mn(i,e=>i.moveVertically(e,t,R5(i).height))}const ev=i=>Z5(i,!1),iv=i=>Z5(i,!0),oV=i=>Mn(i,t=>no(i,t,!0)),aV=i=>Mn(i,t=>no(i,t,!1)),lV=i=>Mn(i,t=>no(i,t,!bi(i))),cV=i=>Mn(i,t=>no(i,t,bi(i))),hV=i=>Mn(i,t=>H.cursor(i.lineBlockAt(t.head).from)),uV=i=>Mn(i,t=>H.cursor(i.lineBlockAt(t.head).to)),nv=({state:i,dispatch:t})=>(t(jn(i,{anchor:0})),!0),sv=({state:i,dispatch:t})=>(t(jn(i,{anchor:i.doc.length})),!0),rv=({state:i,dispatch:t})=>(t(jn(i,{anchor:i.selection.main.anchor,head:0})),!0),ov=({state:i,dispatch:t})=>(t(jn(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),fV=({state:i,dispatch:t})=>(t(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),dV=({state:i,dispatch:t})=>{let e=pp(i).map(({from:n,to:s})=>H.range(n,Math.min(s+1,i.doc.length)));return t(i.update({selection:H.create(e),userEvent:"select"})),!0},pV=({state:i,dispatch:t})=>{let e=Ol(i.selection,n=>{let s=ze(i),r=s.resolveStack(n.from,1);if(n.empty){let o=s.resolveStack(n.from,-1);o.node.from>=r.node.from&&o.node.to<=r.node.to&&(r=o)}for(let o=r;o;o=o.next){let{node:a}=o;if((a.from<n.from&&a.to>=n.to||a.to>n.to&&a.from<=n.from)&&o.next)return H.range(a.to,a.from)}return n});return e.eq(i.selection)?!1:(t(jn(i,e)),!0)};function F5(i,t){let{state:e}=i,n=e.selection,s=e.selection.ranges.slice();for(let r of e.selection.ranges){let o=e.doc.lineAt(r.head);if(t?o.to<i.state.doc.length:o.from>0)for(let a=r;;){let l=i.moveVertically(a,t);if(l.head<o.from||l.head>o.to){s.some(c=>c.head==l.head)||s.push(l);break}else{if(l.head==a.head)break;a=l}}}return s.length==n.ranges.length?!1:(i.dispatch(jn(e,H.create(s,s.length-1))),!0)}const gV=i=>F5(i,!1),mV=i=>F5(i,!0),OV=({state:i,dispatch:t})=>{let e=i.selection,n=null;return e.ranges.length>1?n=H.create([e.main]):e.main.empty||(n=H.create([H.cursor(e.main.head)])),n?(t(jn(i,n)),!0):!1};function Dh(i,t){if(i.state.readOnly)return!1;let e="delete.selection",{state:n}=i,s=n.changeByRange(r=>{let{from:o,to:a}=r;if(o==a){let l=t(r);l<o?(e="delete.backward",l=Wu(i,l,!1)):l>o&&(e="delete.forward",l=Wu(i,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=Wu(i,o,!1),a=Wu(i,a,!0);return o==a?{range:r}:{changes:{from:o,to:a},range:H.cursor(o,o<r.head?-1:1)}});return s.changes.empty?!1:(i.dispatch(n.update(s,{scrollIntoView:!0,userEvent:e,effects:e=="delete.selection"?ct.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function Wu(i,t,e){if(i instanceof ct)for(let n of i.state.facet(ct.atomicRanges).map(s=>s(i)))n.between(t,t,(s,r)=>{s<t&&r>t&&(t=e?r:s)});return t}const W5=(i,t,e)=>Dh(i,n=>{let s=n.from,{state:r}=i,o=r.doc.lineAt(s),a,l;if(e&&!t&&s>o.from&&s<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,s-o.from))){if(a[a.length-1]=="	")return s-1;let c=ml(a,r.tabSize),h=c%sd(r)||sd(r);for(let u=0;u<h&&a[a.length-1-u]==" ";u++)s--;l=s}else l=si(o.text,s-o.from,t,t)+o.from,l==s&&o.number!=(t?r.doc.lines:1)?l+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,s-o.from))&&(l=si(o.text,l-o.from,!1,!1)+o.from);return l}),g0=i=>W5(i,!1,!0),q5=i=>W5(i,!0,!1),X5=(i,t)=>Dh(i,e=>{let n=e.head,{state:s}=i,r=s.doc.lineAt(n),o=s.charCategorizer(n);for(let a=null;;){if(n==(t?r.to:r.from)){n==e.head&&r.number!=(t?s.doc.lines:1)&&(n+=t?1:-1);break}let l=si(r.text,n-r.from,t)+r.from,c=r.text.slice(Math.min(n,l)-r.from,Math.max(n,l)-r.from),h=o(c);if(a!=null&&h!=a)break;(c!=" "||n!=e.head)&&(a=h),n=l}return n}),z5=i=>X5(i,!1),yV=i=>X5(i,!0),bV=i=>Dh(i,t=>{let e=i.lineBlockAt(t.head).to;return t.head<e?e:Math.min(i.state.doc.length,t.head+1)}),vV=i=>Dh(i,t=>{let e=i.moveToLineBoundary(t,!1).head;return t.head>e?e:Math.max(0,t.head-1)}),_V=i=>Dh(i,t=>{let e=i.moveToLineBoundary(t,!0).head;return t.head<e?e:Math.min(i.state.doc.length,t.head+1)}),xV=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=i.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:qt.of(["",""])},range:H.cursor(n.from)}));return t(i.update(e,{scrollIntoView:!0,userEvent:"input"})),!0},SV=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=i.changeByRange(n=>{if(!n.empty||n.from==0||n.from==i.doc.length)return{range:n};let s=n.from,r=i.doc.lineAt(s),o=s==r.from?s-1:si(r.text,s-r.from,!1)+r.from,a=s==r.to?s+1:si(r.text,s-r.from,!0)+r.from;return{changes:{from:o,to:a,insert:i.doc.slice(s,a).append(i.doc.slice(o,s))},range:H.cursor(a)}});return e.changes.empty?!1:(t(i.update(e,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function pp(i){let t=[],e=-1;for(let n of i.selection.ranges){let s=i.doc.lineAt(n.from),r=i.doc.lineAt(n.to);if(!n.empty&&n.to==r.from&&(r=i.doc.lineAt(n.to-1)),e>=s.number){let o=t[t.length-1];o.to=r.to,o.ranges.push(n)}else t.push({from:s.from,to:r.to,ranges:[n]});e=r.number+1}return t}function G5(i,t,e){if(i.readOnly)return!1;let n=[],s=[];for(let r of pp(i)){if(e?r.to==i.doc.length:r.from==0)continue;let o=i.doc.lineAt(e?r.to+1:r.from-1),a=o.length+1;if(e){n.push({from:r.to,to:o.to},{from:r.from,insert:o.text+i.lineBreak});for(let l of r.ranges)s.push(H.range(Math.min(i.doc.length,l.anchor+a),Math.min(i.doc.length,l.head+a)))}else{n.push({from:o.from,to:r.from},{from:r.to,insert:i.lineBreak+o.text});for(let l of r.ranges)s.push(H.range(l.anchor-a,l.head-a))}}return n.length?(t(i.update({changes:n,scrollIntoView:!0,selection:H.create(s,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const wV=({state:i,dispatch:t})=>G5(i,t,!1),kV=({state:i,dispatch:t})=>G5(i,t,!0);function j5(i,t,e){if(i.readOnly)return!1;let n=[];for(let s of pp(i))e?n.push({from:s.from,insert:i.doc.slice(s.from,s.to)+i.lineBreak}):n.push({from:s.to,insert:i.lineBreak+i.doc.slice(s.from,s.to)});return t(i.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const CV=({state:i,dispatch:t})=>j5(i,t,!1),TV=({state:i,dispatch:t})=>j5(i,t,!0),PV=i=>{if(i.state.readOnly)return!1;let{state:t}=i,e=t.changes(pp(t).map(({from:s,to:r})=>(s>0?s--:r<t.doc.length&&r++,{from:s,to:r}))),n=Ol(t.selection,s=>{let r;if(i.lineWrapping){let o=i.lineBlockAt(s.head),a=i.coordsAtPos(s.head,s.assoc||1);a&&(r=o.bottom+i.documentTop-a.bottom+i.defaultLineHeight/2)}return i.moveVertically(s,!0,r)}).map(e);return i.dispatch({changes:e,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function AV(i,t){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=ze(i).resolveInner(t),n=e.childBefore(t),s=e.childAfter(t),r;return n&&s&&n.to<=t&&s.from>=t&&(r=n.type.prop(Qt.closedBy))&&r.indexOf(s.name)>-1&&i.doc.lineAt(n.to).from==i.doc.lineAt(s.from).from&&!/\S/.test(i.sliceDoc(n.to,s.from))?{from:n.to,to:s.from}:null}const av=U5(!1),MV=U5(!0);function U5(i){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(s=>{let{from:r,to:o}=s,a=t.doc.lineAt(r),l=!i&&r==o&&AV(t,r);i&&(r=o=(o<=a.to?a:t.doc.lineAt(o)).to);let c=new cp(t,{simulateBreak:r,simulateDoubleBreak:!!l}),h=l1(c,r);for(h==null&&(h=ml(/^\s*/.exec(t.doc.lineAt(r).text)[0],t.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:r,to:o}=l:r>a.from&&r<a.from+100&&!/\S/.test(a.text.slice(0,r))&&(r=a.from);let u=["",Uc(t,h)];return l&&u.push(Uc(t,c.lineIndent(a.from,-1))),{changes:{from:r,to:o,insert:qt.of(u)},range:H.cursor(r+1+u[1].length)}});return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function f1(i,t){let e=-1;return i.changeByRange(n=>{let s=[];for(let o=n.from;o<=n.to;){let a=i.doc.lineAt(o);a.number>e&&(n.empty||n.to>a.from)&&(t(a,s,n),e=a.number),o=a.to+1}let r=i.changes(s);return{changes:s,range:H.range(r.mapPos(n.anchor,1),r.mapPos(n.head,1))}})}const EV=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=Object.create(null),n=new cp(i,{overrideIndentation:r=>{let o=e[r];return o??-1}}),s=f1(i,(r,o,a)=>{let l=l1(n,r.from);if(l==null)return;/\S/.test(r.text)||(l=0);let c=/^\s*/.exec(r.text)[0],h=Uc(i,l);(c!=h||a.from<r.from+c.length)&&(e[r.from]=l,o.push({from:r.from,to:r.from+c.length,insert:h}))});return s.changes.empty||t(i.update(s,{userEvent:"indent"})),!0},Y5=({state:i,dispatch:t})=>i.readOnly?!1:(t(i.update(f1(i,(e,n)=>{n.push({from:e.from,insert:i.facet(Qh)})}),{userEvent:"input.indent"})),!0),H5=({state:i,dispatch:t})=>i.readOnly?!1:(t(i.update(f1(i,(e,n)=>{let s=/^\s*/.exec(e.text)[0];if(!s)return;let r=ml(s,i.tabSize),o=0,a=Uc(i,Math.max(0,r-sd(i)));for(;o<s.length&&o<a.length&&s.charCodeAt(o)==a.charCodeAt(o);)o++;n.push({from:e.from+o,to:e.from+s.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),RV=i=>(i.setTabFocusMode(),!0),IV=[{key:"Ctrl-b",run:C5,shift:N5,preventDefault:!0},{key:"Ctrl-f",run:T5,shift:$5},{key:"Ctrl-p",run:M5,shift:V5},{key:"Ctrl-n",run:E5,shift:B5},{key:"Ctrl-a",run:KL,shift:hV},{key:"Ctrl-e",run:JL,shift:uV},{key:"Ctrl-d",run:q5},{key:"Ctrl-h",run:g0},{key:"Ctrl-k",run:bV},{key:"Ctrl-Alt-h",run:z5},{key:"Ctrl-o",run:xV},{key:"Ctrl-t",run:SV},{key:"Ctrl-v",run:p0}],QV=[{key:"ArrowLeft",run:C5,shift:N5,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:WL,shift:iV,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:YL,shift:lV,preventDefault:!0},{key:"ArrowRight",run:T5,shift:$5,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:qL,shift:nV,preventDefault:!0},{mac:"Cmd-ArrowRight",run:HL,shift:cV,preventDefault:!0},{key:"ArrowUp",run:M5,shift:V5,preventDefault:!0},{mac:"Cmd-ArrowUp",run:nv,shift:rv},{mac:"Ctrl-ArrowUp",run:tv,shift:ev},{key:"ArrowDown",run:E5,shift:B5,preventDefault:!0},{mac:"Cmd-ArrowDown",run:sv,shift:ov},{mac:"Ctrl-ArrowDown",run:p0,shift:iv},{key:"PageUp",run:tv,shift:ev},{key:"PageDown",run:p0,shift:iv},{key:"Home",run:UL,shift:aV,preventDefault:!0},{key:"Mod-Home",run:nv,shift:rv},{key:"End",run:jL,shift:oV,preventDefault:!0},{key:"Mod-End",run:sv,shift:ov},{key:"Enter",run:av,shift:av},{key:"Mod-a",run:fV},{key:"Backspace",run:g0,shift:g0,preventDefault:!0},{key:"Delete",run:q5,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:z5,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:yV,preventDefault:!0},{mac:"Mod-Backspace",run:vV,preventDefault:!0},{mac:"Mod-Delete",run:_V,preventDefault:!0}].concat(IV.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),NV=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:zL,shift:sV},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:GL,shift:rV},{key:"Alt-ArrowUp",run:wV},{key:"Shift-Alt-ArrowUp",run:CV},{key:"Alt-ArrowDown",run:kV},{key:"Shift-Alt-ArrowDown",run:TV},{key:"Mod-Alt-ArrowUp",run:gV},{key:"Mod-Alt-ArrowDown",run:mV},{key:"Escape",run:OV},{key:"Mod-Enter",run:MV},{key:"Alt-l",mac:"Ctrl-l",run:dV},{key:"Mod-i",run:pV,preventDefault:!0},{key:"Mod-[",run:H5},{key:"Mod-]",run:Y5},{key:"Mod-Alt-\\",run:EV},{key:"Shift-Mod-k",run:PV},{key:"Shift-Mod-\\",run:eV},{key:"Mod-/",run:wL},{key:"Alt-A",run:CL},{key:"Ctrl-m",mac:"Shift-Alt-m",run:RV}].concat(QV),$V={key:"Tab",run:Y5,shift:H5},lv=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class sl{constructor(t,e,n=0,s=t.length,r,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(n,s),this.bufferStart=n,this.normalize=r?a=>r(lv(a)):lv,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Bi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=FO(t),n=this.bufferStart+this.bufferPos;this.bufferPos+=hs(t);let s=this.normalize(e);if(s.length)for(let r=0,o=n;;r++){let a=s.charCodeAt(r),l=this.match(a,o,this.bufferPos+this.bufferStart);if(r==s.length-1){if(l)return this.value=l,this;break}o==n&&r<e.length&&e.charCodeAt(r)==a&&o++}}}match(t,e,n){let s=null;for(let r=0;r<this.matches.length;r+=2){let o=this.matches[r],a=!1;this.query.charCodeAt(o)==t&&(o==this.query.length-1?s={from:this.matches[r+1],to:n}:(this.matches[r]++,a=!0)),a||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==t&&(this.query.length==1?s={from:e,to:n}:this.matches.push(1,e)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(sl.prototype[Symbol.iterator]=function(){return this});const K5={from:-1,to:-1,match:/.*/.exec("")},d1="gm"+(/x/.unicode==null?"":"u");class J5{constructor(t,e,n,s=0,r=t.length){if(this.text=t,this.to=r,this.curLine="",this.done=!1,this.value=K5,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new tC(t,e,n,s,r);this.re=new RegExp(e,d1+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=t.iter();let o=t.lineAt(s);this.curLineStart=o.from,this.matchPos=ld(t,s),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let n=this.curLineStart+e.index,s=n+e[0].length;if(this.matchPos=ld(this.text,s+(n==s?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<s||n>this.value.to)&&(!this.test||this.test(n,s,e)))return this.value={from:n,to:s,match:e},this;t=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),t=0;else return this.done=!0,this}}}const vg=new WeakMap;class Qa{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,n){let s=vg.get(t);if(!s||s.from>=n||s.to<=e){let a=new Qa(e,t.sliceString(e,n));return vg.set(t,a),a}if(s.from==e&&s.to==n)return s;let{text:r,from:o}=s;return o>e&&(r=t.sliceString(e,o)+r,o=e),s.to<n&&(r+=t.sliceString(s.to,n)),vg.set(t,new Qa(o,r)),new Qa(e,r.slice(e-o,n-o))}}class tC{constructor(t,e,n,s,r){this.text=t,this.to=r,this.done=!1,this.value=K5,this.matchPos=ld(t,s),this.re=new RegExp(e,d1+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=Qa.get(t,s,this.chunkEnd(s+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let n=this.flat.from+e.index,s=n+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,s,e)))return this.value={from:n,to:s,match:e},this.matchPos=ld(this.text,s+(n==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Qa.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(J5.prototype[Symbol.iterator]=tC.prototype[Symbol.iterator]=function(){return this});function DV(i){try{return new RegExp(i,d1),!0}catch{return!1}}function ld(i,t){if(t>=i.length)return t;let e=i.lineAt(t),n;for(;t<e.to&&(n=e.text.charCodeAt(t-e.from))>=56320&&n<57344;)t++;return t}function m0(i){let t=String(i.state.doc.lineAt(i.state.selection.main.head).number),e=ee("input",{class:"cm-textfield",name:"line",value:t}),n=ee("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),i.dispatch({effects:Tc.of(!1)}),i.focus()):r.keyCode==13&&(r.preventDefault(),s())},onsubmit:r=>{r.preventDefault(),s()}},ee("label",i.state.phrase("Go to line"),": ",e)," ",ee("button",{class:"cm-button",type:"submit"},i.state.phrase("go")),ee("button",{name:"close",onclick:()=>{i.dispatch({effects:Tc.of(!1)}),i.focus()},"aria-label":i.state.phrase("close"),type:"button"},["×"]));function s(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:o}=i,a=o.doc.lineAt(o.selection.main.head),[,l,c,h,u]=r,f=h?+h.slice(1):0,d=c?+c:a.number;if(c&&u){let m=d/100;l&&(m=m*(l=="-"?-1:1)+a.number/o.doc.lines),d=Math.round(o.doc.lines*m)}else c&&l&&(d=d*(l=="-"?-1:1)+a.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),g=H.cursor(p.from+Math.max(0,Math.min(f,p.length)));i.dispatch({effects:[Tc.of(!1),ct.scrollIntoView(g.from,{y:"center"})],selection:g}),i.focus()}return{dom:n}}const Tc=Ct.define(),cv=Ke.define({create(){return!0},update(i,t){for(let e of t.effects)e.is(Tc)&&(i=e.value);return i},provide:i=>Gc.from(i,t=>t?m0:null)}),LV=i=>{let t=zc(i,m0);if(!t){let e=[Tc.of(!0)];i.state.field(cv,!1)==null&&e.push(Ct.appendConfig.of([cv,VV])),i.dispatch({effects:e}),t=zc(i,m0)}return t&&t.dom.querySelector("input").select(),!0},VV=ct.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),BV={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},ZV=ut.define({combine(i){return Ms(i,BV,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})}});function FV(i){return[GV,zV]}const WV=vt.mark({class:"cm-selectionMatch"}),qV=vt.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function hv(i,t,e,n){return(e==0||i(t.sliceDoc(e-1,e))!=_e.Word)&&(n==t.doc.length||i(t.sliceDoc(n,n+1))!=_e.Word)}function XV(i,t,e,n){return i(t.sliceDoc(e,e+1))==_e.Word&&i(t.sliceDoc(n-1,n))==_e.Word}const zV=Ae.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let t=i.state.facet(ZV),{state:e}=i,n=e.selection;if(n.ranges.length>1)return vt.none;let s=n.main,r,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return vt.none;let l=e.wordAt(s.head);if(!l)return vt.none;o=e.charCategorizer(s.head),r=e.sliceDoc(l.from,l.to)}else{let l=s.to-s.from;if(l<t.minSelectionLength||l>200)return vt.none;if(t.wholeWords){if(r=e.sliceDoc(s.from,s.to),o=e.charCategorizer(s.head),!(hv(o,e,s.from,s.to)&&XV(o,e,s.from,s.to)))return vt.none}else if(r=e.sliceDoc(s.from,s.to),!r)return vt.none}let a=[];for(let l of i.visibleRanges){let c=new sl(e.doc,r,l.from,l.to);for(;!c.next().done;){let{from:h,to:u}=c.value;if((!o||hv(o,e,h,u))&&(s.empty&&h<=s.from&&u>=s.to?a.push(qV.range(h,u)):(h>=s.to||u<=s.from)&&a.push(WV.range(h,u)),a.length>t.maxMatches))return vt.none}}return vt.set(a)}},{decorations:i=>i.decorations}),GV=ct.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),jV=({state:i,dispatch:t})=>{let{selection:e}=i,n=H.create(e.ranges.map(s=>i.wordAt(s.head)||H.cursor(s.head)),e.mainIndex);return n.eq(e)?!1:(t(i.update({selection:n})),!0)};function UV(i,t){let{main:e,ranges:n}=i.selection,s=i.wordAt(e.head),r=s&&s.from==e.from&&s.to==e.to;for(let o=!1,a=new sl(i.doc,t,n[n.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new sl(i.doc,t,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(l=>l.from==a.value.from))continue;if(r){let l=i.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const YV=({state:i,dispatch:t})=>{let{ranges:e}=i.selection;if(e.some(r=>r.from===r.to))return jV({state:i,dispatch:t});let n=i.sliceDoc(e[0].from,e[0].to);if(i.selection.ranges.some(r=>i.sliceDoc(r.from,r.to)!=n))return!1;let s=UV(i,n);return s?(t(i.update({selection:i.selection.addRange(H.range(s.from,s.to),!1),effects:ct.scrollIntoView(s.to)})),!0):!1},yl=ut.define({combine(i){return Ms(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:t=>new lB(t),scrollToMatch:t=>ct.scrollIntoView(t)})}});class eC{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||DV(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,(e,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new tB(this):new KV(this)}getCursor(t,e=0,n){let s=t.doc?t:Vt.create({doc:t});return n==null&&(n=s.doc.length),this.regexp?pa(this,s,e,n):da(this,s,e,n)}}class iC{constructor(t){this.spec=t}}function da(i,t,e,n){return new sl(t.doc,i.unquoted,e,n,i.caseSensitive?void 0:s=>s.toLowerCase(),i.wholeWord?HV(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function HV(i,t){return(e,n,s,r)=>((r>e||r+s.length<n)&&(r=Math.max(0,e-2),s=i.sliceString(r,Math.min(i.length,n+2))),(t(cd(s,e-r))!=_e.Word||t(hd(s,e-r))!=_e.Word)&&(t(hd(s,n-r))!=_e.Word||t(cd(s,n-r))!=_e.Word))}class KV extends iC{constructor(t){super(t)}nextMatch(t,e,n){let s=da(this.spec,t,n,t.doc.length).nextOverlapping();if(s.done){let r=Math.min(t.doc.length,e+this.spec.unquoted.length);s=da(this.spec,t,0,r).nextOverlapping()}return s.done||s.value.from==e&&s.value.to==n?null:s.value}prevMatchInRange(t,e,n){for(let s=n;;){let r=Math.max(e,s-1e4-this.spec.unquoted.length),o=da(this.spec,t,r,s),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(r==e)return null;s-=1e4}}prevMatch(t,e,n){let s=this.prevMatchInRange(t,0,e);return s||(s=this.prevMatchInRange(t,Math.max(0,n-this.spec.unquoted.length),t.doc.length)),s&&(s.from!=e||s.to!=n)?s:null}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let n=da(this.spec,t,0,t.doc.length),s=[];for(;!n.next().done;){if(s.length>=e)return null;s.push(n.value)}return s}highlight(t,e,n,s){let r=da(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,t.doc.length));for(;!r.next().done;)s(r.value.from,r.value.to)}}function pa(i,t,e,n){return new J5(t.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?JV(t.charCategorizer(t.selection.main.head)):void 0},e,n)}function cd(i,t){return i.slice(si(i,t,!1),t)}function hd(i,t){return i.slice(t,si(i,t))}function JV(i){return(t,e,n)=>!n[0].length||(i(cd(n.input,n.index))!=_e.Word||i(hd(n.input,n.index))!=_e.Word)&&(i(hd(n.input,n.index+n[0].length))!=_e.Word||i(cd(n.input,n.index+n[0].length))!=_e.Word)}class tB extends iC{nextMatch(t,e,n){let s=pa(this.spec,t,n,t.doc.length).next();return s.done&&(s=pa(this.spec,t,0,e).next()),s.done?null:s.value}prevMatchInRange(t,e,n){for(let s=1;;s++){let r=Math.max(e,n-s*1e4),o=pa(this.spec,t,r,n),a=null;for(;!o.next().done;)a=o.value;if(a&&(r==e||a.from>r+10))return a;if(r==e)return null}}prevMatch(t,e,n){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,n,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(e,n)=>{if(n=="&")return t.match[0];if(n=="$")return"$";for(let s=n.length;s>0;s--){let r=+n.slice(0,s);if(r>0&&r<t.match.length)return t.match[r]+n.slice(s)}return e})}matchAll(t,e){let n=pa(this.spec,t,0,t.doc.length),s=[];for(;!n.next().done;){if(s.length>=e)return null;s.push(n.value)}return s}highlight(t,e,n,s){let r=pa(this.spec,t,Math.max(0,e-250),Math.min(n+250,t.doc.length));for(;!r.next().done;)s(r.value.from,r.value.to)}}const Yc=Ct.define(),p1=Ct.define(),Nr=Ke.define({create(i){return new _g(O0(i).create(),null)},update(i,t){for(let e of t.effects)e.is(Yc)?i=new _g(e.value.create(),i.panel):e.is(p1)&&(i=new _g(i.query,e.value?g1:null));return i},provide:i=>Gc.from(i,t=>t.panel)});class _g{constructor(t,e){this.query=t,this.panel=e}}const eB=vt.mark({class:"cm-searchMatch"}),iB=vt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),nB=Ae.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(Nr))}update(i){let t=i.state.field(Nr);(t!=i.startState.field(Nr)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:i,panel:t}){if(!t||!i.spec.valid)return vt.none;let{view:e}=this,n=new Hs;for(let s=0,r=e.visibleRanges,o=r.length;s<o;s++){let{from:a,to:l}=r[s];for(;s<o-1&&l>r[s+1].from-500;)l=r[++s].to;i.highlight(e.state,a,l,(c,h)=>{let u=e.state.selection.ranges.some(f=>f.from==c&&f.to==h);n.add(c,h,u?iB:eB)})}return n.finish()}},{decorations:i=>i.decorations});function Lh(i){return t=>{let e=t.state.field(Nr,!1);return e&&e.query.spec.valid?i(t,e):rC(t)}}const ud=Lh((i,{query:t})=>{let{to:e}=i.state.selection.main,n=t.nextMatch(i.state,e,e);if(!n)return!1;let s=H.single(n.from,n.to),r=i.state.facet(yl);return i.dispatch({selection:s,effects:[m1(i,n),r.scrollToMatch(s.main,i)],userEvent:"select.search"}),sC(i),!0}),fd=Lh((i,{query:t})=>{let{state:e}=i,{from:n}=e.selection.main,s=t.prevMatch(e,n,n);if(!s)return!1;let r=H.single(s.from,s.to),o=i.state.facet(yl);return i.dispatch({selection:r,effects:[m1(i,s),o.scrollToMatch(r.main,i)],userEvent:"select.search"}),sC(i),!0}),sB=Lh((i,{query:t})=>{let e=t.matchAll(i.state,1e3);return!e||!e.length?!1:(i.dispatch({selection:H.create(e.map(n=>H.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),rB=({state:i,dispatch:t})=>{let e=i.selection;if(e.ranges.length>1||e.main.empty)return!1;let{from:n,to:s}=e.main,r=[],o=0;for(let a=new sl(i.doc,i.sliceDoc(n,s));!a.next().done;){if(r.length>1e3)return!1;a.value.from==n&&(o=r.length),r.push(H.range(a.value.from,a.value.to))}return t(i.update({selection:H.create(r,o),userEvent:"select.search.matches"})),!0},uv=Lh((i,{query:t})=>{let{state:e}=i,{from:n,to:s}=e.selection.main;if(e.readOnly)return!1;let r=t.nextMatch(e,n,n);if(!r)return!1;let o=r,a=[],l,c,h=[];o.from==n&&o.to==s&&(c=e.toText(t.getReplacement(o)),a.push({from:o.from,to:o.to,insert:c}),o=t.nextMatch(e,o.from,o.to),h.push(ct.announce.of(e.phrase("replaced match on line $",e.doc.lineAt(n).number)+".")));let u=i.state.changes(a);return o&&(l=H.single(o.from,o.to).map(u),h.push(m1(i,o)),h.push(e.facet(yl).scrollToMatch(l.main,i))),i.dispatch({changes:u,selection:l,effects:h,userEvent:"input.replace"}),!0}),oB=Lh((i,{query:t})=>{if(i.state.readOnly)return!1;let e=t.matchAll(i.state,1e9).map(s=>{let{from:r,to:o}=s;return{from:r,to:o,insert:t.getReplacement(s)}});if(!e.length)return!1;let n=i.state.phrase("replaced $ matches",e.length)+".";return i.dispatch({changes:e,effects:ct.announce.of(n),userEvent:"input.replace.all"}),!0});function g1(i){return i.state.facet(yl).createPanel(i)}function O0(i,t){var e,n,s,r,o;let a=i.selection.main,l=a.empty||a.to>a.from+100?"":i.sliceDoc(a.from,a.to);if(t&&!l)return t;let c=i.facet(yl);return new eC({search:((e=t?.literal)!==null&&e!==void 0?e:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=t?.caseSensitive)!==null&&n!==void 0?n:c.caseSensitive,literal:(s=t?.literal)!==null&&s!==void 0?s:c.literal,regexp:(r=t?.regexp)!==null&&r!==void 0?r:c.regexp,wholeWord:(o=t?.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function nC(i){let t=zc(i,g1);return t&&t.dom.querySelector("[main-field]")}function sC(i){let t=nC(i);t&&t==i.root.activeElement&&t.select()}const rC=i=>{let t=i.state.field(Nr,!1);if(t&&t.panel){let e=nC(i);if(e&&e!=i.root.activeElement){let n=O0(i.state,t.query.spec);n.valid&&i.dispatch({effects:Yc.of(n)}),e.focus(),e.select()}}else i.dispatch({effects:[p1.of(!0),t?Yc.of(O0(i.state,t.query.spec)):Ct.appendConfig.of(hB)]});return!0},oC=i=>{let t=i.state.field(Nr,!1);if(!t||!t.panel)return!1;let e=zc(i,g1);return e&&e.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:p1.of(!1)}),!0},aB=[{key:"Mod-f",run:rC,scope:"editor search-panel"},{key:"F3",run:ud,shift:fd,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ud,shift:fd,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:oC,scope:"editor search-panel"},{key:"Mod-Shift-l",run:rB},{key:"Mod-Alt-g",run:LV},{key:"Mod-d",run:YV,preventDefault:!0}];class lB{constructor(t){this.view=t;let e=this.query=t.state.field(Nr).query.spec;this.commit=this.commit.bind(this),this.searchField=ee("input",{value:e.search,placeholder:Ji(t,"Find"),"aria-label":Ji(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ee("input",{value:e.replace,placeholder:Ji(t,"Replace"),"aria-label":Ji(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ee("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=ee("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=ee("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit});function n(s,r,o){return ee("button",{class:"cm-button",name:s,onclick:r,type:"button"},o)}this.dom=ee("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,n("next",()=>ud(t),[Ji(t,"next")]),n("prev",()=>fd(t),[Ji(t,"previous")]),n("select",()=>sB(t),[Ji(t,"all")]),ee("label",null,[this.caseField,Ji(t,"match case")]),ee("label",null,[this.reField,Ji(t,"regexp")]),ee("label",null,[this.wordField,Ji(t,"by word")]),...t.state.readOnly?[]:[ee("br"),this.replaceField,n("replace",()=>uv(t),[Ji(t,"replace")]),n("replaceAll",()=>oB(t),[Ji(t,"replace all")])],ee("button",{name:"close",onclick:()=>oC(t),"aria-label":Ji(t,"close"),type:"button"},["×"])])}commit(){let t=new eC({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:Yc.of(t)}))}keydown(t){p$(this.view,t,"search-panel")?t.preventDefault():t.keyCode==13&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?fd:ud)(this.view)):t.keyCode==13&&t.target==this.replaceField&&(t.preventDefault(),uv(this.view))}update(t){for(let e of t.transactions)for(let n of e.effects)n.is(Yc)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(yl).top}}function Ji(i,t){return i.state.phrase(t)}const qu=30,Xu=/[\s\.,:;?!]/;function m1(i,{from:t,to:e}){let n=i.state.doc.lineAt(t),s=i.state.doc.lineAt(e).to,r=Math.max(n.from,t-qu),o=Math.min(s,e+qu),a=i.state.sliceDoc(r,o);if(r!=n.from){for(let l=0;l<qu;l++)if(!Xu.test(a[l+1])&&Xu.test(a[l])){a=a.slice(l);break}}if(o!=s){for(let l=a.length-1;l>a.length-qu;l--)if(!Xu.test(a[l-1])&&Xu.test(a[l])){a=a.slice(0,l);break}}return ct.announce.of(`${i.state.phrase("current match")}. ${a} ${i.state.phrase("on line")} ${n.number}.`)}const cB=ct.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),hB=[Nr,io.low(nB),cB];class aC{constructor(t,e,n,s){this.state=t,this.pos=e,this.explicit=n,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=ze(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),n=Math.max(e.from,this.pos-250),s=e.text.slice(n-e.from,this.pos-e.from),r=s.search(cC(t,!1));return r<0?null:{from:n+r,to:this.pos,text:s.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(t,e,n){t=="abort"&&this.abortListeners&&(this.abortListeners.push(e),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function fv(i){let t=Object.keys(i).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function uB(i){let t=Object.create(null),e=Object.create(null);for(let{label:s}of i){t[s[0]]=!0;for(let r=1;r<s.length;r++)e[s[r]]=!0}let n=fv(t)+fv(e)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function lC(i){let t=i.map(s=>typeof s=="string"?{label:s}:s),[e,n]=t.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:uB(t);return s=>{let r=s.matchBefore(n);return r||s.explicit?{from:r?r.from:s.pos,options:t,validFor:e}:null}}function fB(i,t){return e=>{for(let n=ze(e.state).resolveInner(e.pos,-1);n;n=n.parent){if(i.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return t(e)}}class dv{constructor(t,e,n,s){this.completion=t,this.source=e,this.match=n,this.score=s}}function Po(i){return i.selection.main.from}function cC(i,t){var e;let{source:n}=i,s=t&&n[0]!="^",r=n[n.length-1]!="$";return!s&&!r?i:new RegExp(`${s?"^":""}(?:${n})${r?"$":""}`,(e=i.flags)!==null&&e!==void 0?e:i.ignoreCase?"i":"")}const O1=hr.define();function dB(i,t,e,n){let{main:s}=i.selection,r=e-s.from,o=n-s.from;return{...i.changeByRange(a=>{if(a!=s&&e!=n&&i.sliceDoc(a.from+r,a.from+o)!=i.sliceDoc(e,n))return{range:a};let l=i.toText(t);return{changes:{from:a.from+r,to:n==s.from?a.to:a.from+o,insert:l},range:H.cursor(a.from+r+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const pv=new WeakMap;function pB(i){if(!Array.isArray(i))return i;let t=pv.get(i);return t||pv.set(i,t=lC(i)),t}const dd=Ct.define(),Hc=Ct.define();class gB{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let n=Bi(t,e),s=hs(n);this.chars.push(n);let r=t.slice(e,e+s),o=r.toUpperCase();this.folded.push(Bi(o==r?r.toLowerCase():o,0)),e+=s}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:n,any:s,precise:r,byWord:o}=this;if(e.length==1){let y=Bi(t,0),_=hs(y),v=_==t.length?0:-100;if(y!=e[0])if(y==n[0])v+=-200;else return null;return this.ret(v,[0,_])}let a=t.indexOf(this.pattern);if(a==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=e.length,c=0;if(a<0){for(let y=0,_=Math.min(t.length,200);y<_&&c<l;){let v=Bi(t,y);(v==e[c]||v==n[c])&&(s[c++]=y),y+=hs(v)}if(c<l)return null}let h=0,u=0,f=!1,d=0,p=-1,g=-1,m=/[a-z]/.test(t),O=!0;for(let y=0,_=Math.min(t.length,200),v=0;y<_&&u<l;){let b=Bi(t,y);a<0&&(h<l&&b==e[h]&&(r[h++]=y),d<l&&(b==e[d]||b==n[d]?(d==0&&(p=y),g=y+1,d++):d=0));let k,x=b<255?b>=48&&b<=57||b>=97&&b<=122?2:b>=65&&b<=90?1:0:(k=FO(b))!=k.toLowerCase()?1:k!=k.toUpperCase()?2:0;(!y||x==1&&m||v==0&&x!=0)&&(e[u]==b||n[u]==b&&(f=!0)?o[u++]=y:o.length&&(O=!1)),v=x,y+=hs(b)}return u==l&&o[0]==0&&O?this.result(-100+(f?-200:0),o,t):d==l&&p==0?this.ret(-200-t.length+(g==t.length?0:-100),[0,g]):a>-1?this.ret(-700-t.length,[a,a+this.pattern.length]):d==l?this.ret(-900-t.length,[p,g]):u==l?this.result(-100+(f?-200:0)+-700+(O?0:-1100),o,t):e.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,t)}result(t,e,n){let s=[],r=0;for(let o of e){let a=o+(this.astral?hs(Bi(n,o)):1);r&&s[r-1]==o?s[r-1]=a:(s[r++]=o,s[r++]=a)}return this.ret(t-n.length,s)}}class mB{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),n=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,e.length],this.score=n+(t.length==this.pattern.length?0:-100),this)}}const Ue=ut.define({combine(i){return Ms(i,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:OB,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>n=>gv(t(n),e(n)),optionClass:(t,e)=>n=>gv(t(n),e(n)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function gv(i,t){return i?t?i+" "+t:i:t}function OB(i,t,e,n,s,r){let o=i.textDirection==ge.RTL,a=o,l=!1,c="top",h,u,f=t.left-s.left,d=s.right-t.right,p=n.right-n.left,g=n.bottom-n.top;if(a&&f<Math.min(p,d)?a=!1:!a&&d<Math.min(p,f)&&(a=!0),p<=(a?f:d))h=Math.max(s.top,Math.min(e.top,s.bottom-g))-t.top,u=Math.min(400,a?f:d);else{l=!0,u=Math.min(400,(o?t.right:s.right-t.left)-30);let y=s.bottom-t.bottom;y>=g||y>t.top?h=e.bottom-t.top:(c="bottom",h=t.bottom-e.top)}let m=(t.bottom-t.top)/r.offsetHeight,O=(t.right-t.left)/r.offsetWidth;return{style:`${c}: ${h/m}px; max-width: ${u/O}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function yB(i){let t=i.addToOptions.slice();return i.icons&&t.push({render(e){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),e.type&&n.classList.add(...e.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),n.setAttribute("aria-hidden","true"),n},position:20}),t.push({render(e,n,s,r){let o=document.createElement("span");o.className="cm-completionLabel";let a=e.displayLabel||e.label,l=0;for(let c=0;c<r.length;){let h=r[c++],u=r[c++];h>l&&o.appendChild(document.createTextNode(a.slice(l,h)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(a.slice(h,u))),f.className="cm-completionMatchedText",l=u}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(e){if(!e.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=e.detail,n},position:80}),t.sort((e,n)=>e.position-n.position).map(e=>e.render)}function xg(i,t,e){if(i<=e)return{from:0,to:i};if(t<0&&(t=0),t<=i>>1){let s=Math.floor(t/e);return{from:s*e,to:(s+1)*e}}let n=Math.floor((i-t)/e);return{from:i-(n+1)*e,to:i-n*e}}class bB{constructor(t,e,n){this.view=t,this.stateField=e,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let s=t.state.field(e),{options:r,selected:o}=s.open,a=t.state.facet(Ue);this.optionContent=yB(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=xg(r.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=t.state.field(e).open;for(let h=l.target,u;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(u=/-(\d+)$/.exec(h.id))&&+u[1]<c.length){this.applyCompletion(t,c[+u[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(Ue).closeOnBlur&&l.relatedTarget!=t.contentDOM&&t.dispatch({effects:Hc.of(null)})}),this.showOptions(r,s.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let n=t.state.field(this.stateField),s=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),n!=s){let{options:r,selected:o,disabled:a}=n.open;(!s.open||s.open.options!=r)&&(this.range=xg(r.length,o,t.state.facet(Ue).maxRenderedOptions),this.showOptions(r,n.id)),this.updateSel(),a!=((e=s.open)===null||e===void 0?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of e.split(" "))n&&this.dom.classList.add(n);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=xg(e.options.length,e.selected,this.view.state.facet(Ue).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:n}=e.options[e.selected],{info:s}=n;if(!s)return;let r=typeof s=="string"?document.createTextNode(s):s(n);if(!r)return;"then"in r?r.then(o=>{o&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(o,n)}).catch(o=>qi(this.view.state,o,"completion info")):this.addInfoPane(r,n)}}addInfoPane(t,e){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",t.nodeType!=null)n.appendChild(t),this.infoDestroy=null;else{let{dom:s,destroy:r}=t;n.appendChild(s),this.infoDestroy=r||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let n=this.list.firstChild,s=this.range.from;n;n=n.nextSibling,s++)n.nodeName!="LI"||!n.id?s--:s==t?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),e=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return e&&_B(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),s=t.getBoundingClientRect(),r=this.space;if(!r){let o=this.dom.ownerDocument.documentElement;r={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return s.top>Math.min(r.bottom,e.bottom)-10||s.bottom<Math.max(r.top,e.top)+10?null:this.view.state.facet(Ue).positionInfo(this.view,e,s,n,r,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,n){const s=document.createElement("ul");s.id=e,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions")),s.addEventListener("mousedown",o=>{o.target==s&&o.preventDefault()});let r=null;for(let o=n.from;o<n.to;o++){let{completion:a,match:l}=t[o],{section:c}=a;if(c){let f=typeof c=="string"?c:c.name;if(f!=r&&(o>n.from||n.from==0))if(r=f,typeof c!="string"&&c.header)s.appendChild(c.header(c));else{let d=s.appendChild(document.createElement("completion-section"));d.textContent=f}}const h=s.appendChild(document.createElement("li"));h.id=e+"-"+o,h.setAttribute("role","option");let u=this.optionClass(a);u&&(h.className=u);for(let f of this.optionContent){let d=f(a,this.view.state,this.view,l);d&&h.appendChild(d)}}return n.from&&s.classList.add("cm-completionListIncompleteTop"),n.to<t.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function vB(i,t){return e=>new bB(e,i,t)}function _B(i,t){let e=i.getBoundingClientRect(),n=t.getBoundingClientRect(),s=e.height/i.offsetHeight;n.top<e.top?i.scrollTop-=(e.top-n.top)/s:n.bottom>e.bottom&&(i.scrollTop+=(n.bottom-e.bottom)/s)}function mv(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function xB(i,t){let e=[],n=null,s=null,r=h=>{e.push(h);let{section:u}=h.completion;if(u){n||(n=[]);let f=typeof u=="string"?u:u.name;n.some(d=>d.name==f)||n.push(typeof u=="string"?{name:f}:u)}},o=t.facet(Ue);for(let h of i)if(h.hasResult()){let u=h.result.getMatch;if(h.result.filter===!1)for(let f of h.result.options)r(new dv(f,h.source,u?u(f):[],1e9-e.length));else{let f=t.sliceDoc(h.from,h.to),d,p=o.filterStrict?new mB(f):new gB(f);for(let g of h.result.options)if(d=p.match(g.label)){let m=g.displayLabel?u?u(g,d.matched):[]:d.matched,O=d.score+(g.boost||0);if(r(new dv(g,h.source,m,O)),typeof g.section=="object"&&g.section.rank==="dynamic"){let{name:y}=g.section;s||(s=Object.create(null)),s[y]=Math.max(O,s[y]||-1e9)}}}}if(n){let h=Object.create(null),u=0,f=(d,p)=>(d.rank==="dynamic"&&p.rank==="dynamic"?s[p.name]-s[d.name]:0)||(typeof d.rank=="number"?d.rank:1e9)-(typeof p.rank=="number"?p.rank:1e9)||(d.name<p.name?-1:1);for(let d of n.sort(f))u-=1e5,h[d.name]=u;for(let d of e){let{section:p}=d.completion;p&&(d.score+=h[typeof p=="string"?p:p.name])}}let a=[],l=null,c=o.compareCompletions;for(let h of e.sort((u,f)=>f.score-u.score||c(u.completion,f.completion))){let u=h.completion;!l||l.label!=u.label||l.detail!=u.detail||l.type!=null&&u.type!=null&&l.type!=u.type||l.apply!=u.apply||l.boost!=u.boost?a.push(h):mv(h.completion)>mv(l)&&(a[a.length-1]=h),l=h.completion}return a}class Sa{constructor(t,e,n,s,r,o){this.options=t,this.attrs=e,this.tooltip=n,this.timestamp=s,this.selected=r,this.disabled=o}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new Sa(this.options,Ov(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,n,s,r,o){if(s&&!o&&t.some(c=>c.isPending))return s.setDisabled();let a=xB(t,e);if(!a.length)return s&&t.some(c=>c.isPending)?s.setDisabled():null;let l=e.facet(Ue).selectOnOpen?0:-1;if(s&&s.selected!=l&&s.selected!=-1){let c=s.options[s.selected].completion;for(let h=0;h<a.length;h++)if(a[h].completion==c){l=h;break}}return new Sa(a,Ov(n,l),{pos:t.reduce((c,h)=>h.hasResult()?Math.min(c,h.from):c,1e8),create:PB,above:r.aboveCursor},s?s.timestamp:Date.now(),l,!1)}map(t){return new Sa(this.options,this.attrs,{...this.tooltip,pos:t.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new Sa(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class pd{constructor(t,e,n){this.active=t,this.id=e,this.open=n}static start(){return new pd(CB,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,n=e.facet(Ue),r=(n.override||e.languageDataAt("autocomplete",Po(e)).map(pB)).map(l=>(this.active.find(h=>h.source==l)||new Sn(l,this.active.some(h=>h.state!=0)?1:0)).update(t,n));r.length==this.active.length&&r.every((l,c)=>l==this.active[c])&&(r=this.active);let o=this.open,a=t.effects.some(l=>l.is(y1));o&&t.docChanged&&(o=o.map(t.changes)),t.selection||r.some(l=>l.hasResult()&&t.changes.touchesRange(l.from,l.to))||!SB(r,this.active)||a?o=Sa.build(r,e,this.id,o,n,a):o&&o.disabled&&!r.some(l=>l.isPending)&&(o=null),!o&&r.every(l=>!l.isPending)&&r.some(l=>l.hasResult())&&(r=r.map(l=>l.hasResult()?new Sn(l.source,0):l));for(let l of t.effects)l.is(uC)&&(o=o&&o.setSelected(l.value,this.id));return r==this.active&&o==this.open?this:new pd(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?wB:kB}}function SB(i,t){if(i==t)return!0;for(let e=0,n=0;;){for(;e<i.length&&!i[e].hasResult();)e++;for(;n<t.length&&!t[n].hasResult();)n++;let s=e==i.length,r=n==t.length;if(s||r)return s==r;if(i[e++].result!=t[n++].result)return!1}}const wB={"aria-autocomplete":"list"},kB={};function Ov(i,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return t>-1&&(e["aria-activedescendant"]=i+"-"+t),e}const CB=[];function hC(i,t){if(i.isUserEvent("input.complete")){let n=i.annotation(O1);if(n&&t.activateOnCompletion(n))return 12}let e=i.isUserEvent("input.type");return e&&t.activateOnTyping?5:e?1:i.isUserEvent("delete.backward")?2:i.selection?8:i.docChanged?16:0}class Sn{constructor(t,e,n=!1){this.source=t,this.state=e,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(t,e){let n=hC(t,e),s=this;(n&8||n&16&&this.touches(t))&&(s=new Sn(s.source,0)),n&4&&s.state==0&&(s=new Sn(this.source,1)),s=s.updateFor(t,n);for(let r of t.effects)if(r.is(dd))s=new Sn(s.source,1,r.value);else if(r.is(Hc))s=new Sn(s.source,0);else if(r.is(y1))for(let o of r.value)o.source==s.source&&(s=o);return s}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(Po(t.state))}}class Na extends Sn{constructor(t,e,n,s,r,o){super(t,3,e),this.limit=n,this.result=s,this.from=r,this.to=o}hasResult(){return!0}updateFor(t,e){var n;if(!(e&3))return this.map(t.changes);let s=this.result;s.map&&!t.changes.empty&&(s=s.map(s,t.changes));let r=t.changes.mapPos(this.from),o=t.changes.mapPos(this.to,1),a=Po(t.state);if(a>o||!s||e&2&&(Po(t.startState)==this.from||a<this.limit))return new Sn(this.source,e&4?1:0);let l=t.changes.mapPos(this.limit);return TB(s.validFor,t.state,r,o)?new Na(this.source,this.explicit,l,s,r,o):s.update&&(s=s.update(s,r,o,new aC(t.state,a,!1)))?new Na(this.source,this.explicit,l,s,s.from,(n=s.to)!==null&&n!==void 0?n:Po(t.state)):new Sn(this.source,1,this.explicit)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new Na(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new Sn(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}function TB(i,t,e,n){if(!i)return!1;let s=t.sliceDoc(e,n);return typeof i=="function"?i(s,e,n,t):cC(i,!0).test(s)}const y1=Ct.define({map(i,t){return i.map(e=>e.map(t))}}),uC=Ct.define(),Zi=Ke.define({create(){return pd.start()},update(i,t){return i.update(t)},provide:i=>[i1.from(i,t=>t.tooltip),ct.contentAttributes.from(i,t=>t.attrs)]});function b1(i,t){const e=t.completion.apply||t.completion.label;let n=i.state.field(Zi).active.find(s=>s.source==t.source);return n instanceof Na?(typeof e=="string"?i.dispatch({...dB(i.state,e,n.from,n.to),annotations:O1.of(t.completion)}):e(i,t.completion,n.from,n.to),!0):!1}const PB=vB(Zi,b1);function zu(i,t="option"){return e=>{let n=e.state.field(Zi,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<e.state.facet(Ue).interactionDelay)return!1;let s=1,r;t=="page"&&(r=Wk(e,n.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,a=n.open.selected>-1?n.open.selected+s*(i?1:-1):i?0:o-1;return a<0?a=t=="page"?0:o-1:a>=o&&(a=t=="page"?o-1:0),e.dispatch({effects:uC.of(a)}),!0}}const AB=i=>{let t=i.state.field(Zi,!1);return i.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<i.state.facet(Ue).interactionDelay?!1:b1(i,t.open.options[t.open.selected])},Sg=i=>i.state.field(Zi,!1)?(i.dispatch({effects:dd.of(!0)}),!0):!1,MB=i=>{let t=i.state.field(Zi,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(i.dispatch({effects:Hc.of(null)}),!0)};class EB{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const RB=50,IB=1e3,QB=Ae.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of i.state.field(Zi).active)t.isPending&&this.startQuery(t)}update(i){let t=i.state.field(Zi),e=i.state.facet(Ue);if(!i.selectionSet&&!i.docChanged&&i.startState.field(Zi)==t)return;let n=i.transactions.some(r=>{let o=hC(r,e);return o&8||(r.selection||r.docChanged)&&!(o&3)});for(let r=0;r<this.running.length;r++){let o=this.running[r];if(n||o.context.abortOnDocChange&&i.docChanged||o.updates.length+i.transactions.length>RB&&Date.now()-o.time>IB){for(let a of o.context.abortListeners)try{a()}catch(l){qi(this.view.state,l)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(r=>r.effects.some(o=>o.is(dd)))&&(this.pendingStart=!0);let s=this.pendingStart?50:e.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(r=>r.isPending&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let r of i.transactions)r.isUserEvent("input.type")?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,t=i.field(Zi);for(let e of t.active)e.isPending&&!this.running.some(n=>n.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Ue).updateSyncTime))}startQuery(i){let{state:t}=this.view,e=Po(t),n=new aC(t,e,i.explicit,this.view),s=new EB(i,n);this.running.push(s),Promise.resolve(i.source(n)).then(r=>{s.context.aborted||(s.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:Hc.of(null)}),qi(this.view.state,r)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Ue).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(Ue),n=this.view.state.field(Zi);for(let s=0;s<this.running.length;s++){let r=this.running[s];if(r.done===void 0)continue;if(this.running.splice(s--,1),r.done){let a=Po(r.updates.length?r.updates[0].startState:this.view.state),l=Math.min(a,r.done.from+(r.active.explicit?0:1)),c=new Na(r.active.source,r.active.explicit,l,r.done,r.done.from,(i=r.done.to)!==null&&i!==void 0?i:a);for(let h of r.updates)c=c.update(h,e);if(c.hasResult()){t.push(c);continue}}let o=n.active.find(a=>a.source==r.active.source);if(o&&o.isPending)if(r.done==null){let a=new Sn(r.active.source,0);for(let l of r.updates)a=a.update(l,e);a.isPending||t.push(a)}else this.startQuery(o)}(t.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:y1.of(t)})}},{eventHandlers:{blur(i){let t=this.view.state.field(Zi,!1);if(t&&t.tooltip&&this.view.state.facet(Ue).closeOnBlur){let e=t.open&&Wk(this.view,t.open.tooltip);(!e||!e.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Hc.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:dd.of(!1)}),20),this.composing=0}}}),NB=typeof navigator=="object"&&/Win/.test(navigator.platform),$B=io.highest(ct.domEventHandlers({keydown(i,t){let e=t.state.field(Zi,!1);if(!e||!e.open||e.open.disabled||e.open.selected<0||i.key.length>1||i.ctrlKey&&!(NB&&i.altKey)||i.metaKey)return!1;let n=e.open.options[e.open.selected],s=e.active.find(o=>o.source==n.source),r=n.completion.commitCharacters||s.result.commitCharacters;return r&&r.indexOf(i.key)>-1&&b1(t,n),!1}})),fC=ct.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class DB{constructor(t,e,n,s){this.field=t,this.line=e,this.from=n,this.to=s}}class v1{constructor(t,e,n){this.field=t,this.from=e,this.to=n}map(t){let e=t.mapPos(this.from,-1,ni.TrackDel),n=t.mapPos(this.to,1,ni.TrackDel);return e==null||n==null?null:new v1(this.field,e,n)}}class _1{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let n=[],s=[e],r=t.doc.lineAt(e),o=/^\s*/.exec(r.text)[0];for(let l of this.lines){if(n.length){let c=o,h=/^\t*/.exec(l)[0].length;for(let u=0;u<h;u++)c+=t.facet(Qh);s.push(e+c.length-h),l=c+l.slice(h)}n.push(l),e+=l.length+1}let a=this.fieldPositions.map(l=>new v1(l.field,s[l.line]+l.from,s[l.line]+l.to));return{text:n,ranges:a}}static parse(t){let e=[],n=[],s=[],r;for(let o of t.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let a=r[1]?+r[1]:null,l=r[2]||r[3]||"",c=-1,h=l.replace(/\\[{}]/g,u=>u[1]);for(let u=0;u<e.length;u++)(a!=null?e[u].seq==a:h&&e[u].name==h)&&(c=u);if(c<0){let u=0;for(;u<e.length&&(a==null||e[u].seq!=null&&e[u].seq<a);)u++;e.splice(u,0,{seq:a,name:h}),c=u;for(let f of s)f.field>=c&&f.field++}for(let u of s)if(u.line==n.length&&u.from>r.index){let f=r[2]?3+(r[1]||"").length:2;u.from-=f,u.to-=f}s.push(new DB(c,n.length,r.index,r.index+h.length)),o=o.slice(0,r.index)+l+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(a,l,c)=>{for(let h of s)h.line==n.length&&h.from>c&&(h.from--,h.to--);return l}),n.push(o)}return new _1(n,s)}}let LB=vt.widget({widget:new class extends Es{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),VB=vt.mark({class:"cm-snippetField"});class bl{constructor(t,e){this.ranges=t,this.active=e,this.deco=vt.set(t.map(n=>(n.from==n.to?LB:VB).range(n.from,n.to)),!0)}map(t){let e=[];for(let n of this.ranges){let s=n.map(t);if(!s)return null;e.push(s)}return new bl(e,this.active)}selectionInsideField(t){return t.ranges.every(e=>this.ranges.some(n=>n.field==this.active&&n.from<=e.from&&n.to>=e.to))}}const Vh=Ct.define({map(i,t){return i&&i.map(t)}}),BB=Ct.define(),Kc=Ke.define({create(){return null},update(i,t){for(let e of t.effects){if(e.is(Vh))return e.value;if(e.is(BB)&&i)return new bl(i.ranges,e.value)}return i&&t.docChanged&&(i=i.map(t.changes)),i&&t.selection&&!i.selectionInsideField(t.selection)&&(i=null),i},provide:i=>ct.decorations.from(i,t=>t?t.deco:vt.none)});function x1(i,t){return H.create(i.filter(e=>e.field==t).map(e=>H.range(e.from,e.to)))}function ZB(i){let t=_1.parse(i);return(e,n,s,r)=>{let{text:o,ranges:a}=t.instantiate(e.state,s),{main:l}=e.state.selection,c={changes:{from:s,to:r==l.from?l.to:r,insert:qt.of(o)},scrollIntoView:!0,annotations:n?[O1.of(n),$e.userEvent.of("input.complete")]:void 0};if(a.length&&(c.selection=x1(a,0)),a.some(h=>h.field>0)){let h=new bl(a,0),u=c.effects=[Vh.of(h)];e.state.field(Kc,!1)===void 0&&u.push(Ct.appendConfig.of([Kc,zB,GB,fC]))}e.dispatch(e.state.update(c))}}function dC(i){return({state:t,dispatch:e})=>{let n=t.field(Kc,!1);if(!n||i<0&&n.active==0)return!1;let s=n.active+i,r=i>0&&!n.ranges.some(o=>o.field==s+i);return e(t.update({selection:x1(n.ranges,s),effects:Vh.of(r?null:new bl(n.ranges,s)),scrollIntoView:!0})),!0}}const FB=({state:i,dispatch:t})=>i.field(Kc,!1)?(t(i.update({effects:Vh.of(null)})),!0):!1,WB=dC(1),qB=dC(-1),XB=[{key:"Tab",run:WB,shift:qB},{key:"Escape",run:FB}],yv=ut.define({combine(i){return i.length?i[0]:XB}}),zB=io.highest(Rh.compute([yv],i=>i.facet(yv)));function Di(i,t){return{...t,apply:ZB(i)}}const GB=ct.domEventHandlers({mousedown(i,t){let e=t.state.field(Kc,!1),n;if(!e||(n=t.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let s=e.ranges.find(r=>r.from<=n&&r.to>=n);return!s||s.field==e.active?!1:(t.dispatch({selection:x1(e.ranges,s.field),effects:Vh.of(e.ranges.some(r=>r.field>s.field)?new bl(e.ranges,s.field):null),scrollIntoView:!0}),!0)}}),Jc={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},So=Ct.define({map(i,t){let e=t.mapPos(i,-1,ni.TrackAfter);return e??void 0}}),S1=new class extends Lo{};S1.startSide=1;S1.endSide=-1;const pC=Ke.define({create(){return zt.empty},update(i,t){if(i=i.map(t.changes),t.selection){let e=t.state.doc.lineAt(t.selection.main.head);i=i.update({filter:n=>n>=e.from&&n<=e.to})}for(let e of t.effects)e.is(So)&&(i=i.update({add:[S1.range(e.value,e.value+1)]}));return i}});function jB(){return[YB,pC]}const wg="()[]{}<>«»»«［］｛｝";function gC(i){for(let t=0;t<wg.length;t+=2)if(wg.charCodeAt(t)==i)return wg.charAt(t+1);return FO(i<128?i:i+1)}function mC(i,t){return i.languageDataAt("closeBrackets",t)[0]||Jc}const UB=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),YB=ct.inputHandler.of((i,t,e,n)=>{if((UB?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let s=i.state.selection.main;if(n.length>2||n.length==2&&hs(Bi(n,0))==1||t!=s.from||e!=s.to)return!1;let r=JB(i.state,n);return r?(i.dispatch(r),!0):!1}),HB=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let n=mC(i,i.selection.main.head).brackets||Jc.brackets,s=null,r=i.changeByRange(o=>{if(o.empty){let a=tZ(i.doc,o.head);for(let l of n)if(l==a&&gp(i.doc,o.head)==gC(Bi(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:H.cursor(o.head-l.length)}}return{range:s=o}});return s||t(i.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},KB=[{key:"Backspace",run:HB}];function JB(i,t){let e=mC(i,i.selection.main.head),n=e.brackets||Jc.brackets;for(let s of n){let r=gC(Bi(s,0));if(t==s)return r==s?nZ(i,s,n.indexOf(s+s+s)>-1,e):eZ(i,s,r,e.before||Jc.before);if(t==r&&OC(i,i.selection.main.from))return iZ(i,s,r)}return null}function OC(i,t){let e=!1;return i.field(pC).between(0,i.doc.length,n=>{n==t&&(e=!0)}),e}function gp(i,t){let e=i.sliceString(t,t+2);return e.slice(0,hs(Bi(e,0)))}function tZ(i,t){let e=i.sliceString(t-2,t);return hs(Bi(e,0))==e.length?e:e.slice(1)}function eZ(i,t,e,n){let s=null,r=i.changeByRange(o=>{if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:e,from:o.to}],effects:So.of(o.to+t.length),range:H.range(o.anchor+t.length,o.head+t.length)};let a=gp(i.doc,o.head);return!a||/\s/.test(a)||n.indexOf(a)>-1?{changes:{insert:t+e,from:o.head},effects:So.of(o.head+t.length),range:H.cursor(o.head+t.length)}:{range:s=o}});return s?null:i.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function iZ(i,t,e){let n=null,s=i.changeByRange(r=>r.empty&&gp(i.doc,r.head)==e?{changes:{from:r.head,to:r.head+e.length,insert:e},range:H.cursor(r.head+e.length)}:n={range:r});return n?null:i.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function nZ(i,t,e,n){let s=n.stringPrefixes||Jc.stringPrefixes,r=null,o=i.changeByRange(a=>{if(!a.empty)return{changes:[{insert:t,from:a.from},{insert:t,from:a.to}],effects:So.of(a.to+t.length),range:H.range(a.anchor+t.length,a.head+t.length)};let l=a.head,c=gp(i.doc,l),h;if(c==t){if(bv(i,l))return{changes:{insert:t+t,from:l},effects:So.of(l+t.length),range:H.cursor(l+t.length)};if(OC(i,l)){let f=e&&i.sliceDoc(l,l+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:l,to:l+f.length,insert:f},range:H.cursor(l+f.length)}}}else{if(e&&i.sliceDoc(l-2*t.length,l)==t+t&&(h=vv(i,l-2*t.length,s))>-1&&bv(i,h))return{changes:{insert:t+t+t+t,from:l},effects:So.of(l+t.length),range:H.cursor(l+t.length)};if(i.charCategorizer(l)(c)!=_e.Word&&vv(i,l,s)>-1&&!sZ(i,l,t,s))return{changes:{insert:t+t,from:l},effects:So.of(l+t.length),range:H.cursor(l+t.length)}}return{range:r=a}});return r?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function bv(i,t){let e=ze(i).resolveInner(t+1);return e.parent&&e.from==t}function sZ(i,t,e,n){let s=ze(i).resolveInner(t,-1),r=n.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=i.sliceDoc(s.from,Math.min(s.to,s.from+e.length+r)),l=a.indexOf(e);if(!l||l>-1&&n.indexOf(a.slice(0,l))>-1){let h=s.firstChild;for(;h&&h.from==s.from&&h.to-h.from>e.length+l;){if(i.sliceDoc(h.to-e.length,h.to)==e)return!1;h=h.firstChild}return!0}let c=s.to==t&&s.parent;if(!c)break;s=c}return!1}function vv(i,t,e){let n=i.charCategorizer(t);if(n(i.sliceDoc(t-1,t))!=_e.Word)return t;for(let s of e){let r=t-s.length;if(i.sliceDoc(r,t)==s&&n(i.sliceDoc(r-1,r))!=_e.Word)return r}return-1}function rZ(i={}){return[$B,Zi,Ue.of(i),QB,oZ,fC]}const yC=[{key:"Ctrl-Space",run:Sg},{mac:"Alt-`",run:Sg},{mac:"Alt-i",run:Sg},{key:"Escape",run:MB},{key:"ArrowDown",run:zu(!0)},{key:"ArrowUp",run:zu(!1)},{key:"PageDown",run:zu(!0,"page")},{key:"PageUp",run:zu(!1,"page")},{key:"Enter",run:AB}],oZ=io.highest(Rh.computeN([Ue],i=>i.facet(Ue).defaultKeymap?[yC]:[]));class _v{constructor(t,e,n){this.from=t,this.to=e,this.diagnostic=n}}class mo{constructor(t,e,n){this.diagnostics=t,this.panel=e,this.selected=n}static init(t,e,n){let s=n.facet(th).markerFilter;s&&(t=s(t,n));let r=t.slice().sort((h,u)=>h.from-u.from||h.to-u.to),o=new Hs,a=[],l=0;for(let h=0;;){let u=h==r.length?null:r[h];if(!u&&!a.length)break;let f,d;for(a.length?(f=l,d=a.reduce((g,m)=>Math.min(g,m.to),u&&u.from>f?u.from:1e8)):(f=u.from,d=u.to,a.push(u),h++);h<r.length;){let g=r[h];if(g.from==f&&(g.to>g.from||g.to==f))a.push(g),h++,d=Math.min(g.to,d);else{d=Math.min(g.from,d);break}}let p=bZ(a);if(a.some(g=>g.from==g.to||g.from==g.to-1&&n.doc.lineAt(g.from).to==g.from))o.add(f,f,vt.widget({widget:new gZ(p),diagnostics:a.slice()}));else{let g=a.reduce((m,O)=>O.markClass?m+" "+O.markClass:m,"");o.add(f,d,vt.mark({class:"cm-lintRange cm-lintRange-"+p+g,diagnostics:a.slice(),inclusiveEnd:a.some(m=>m.to>d)}))}l=d;for(let g=0;g<a.length;g++)a[g].to<=l&&a.splice(g--,1)}let c=o.finish();return new mo(c,e,rl(c))}}function rl(i,t=null,e=0){let n=null;return i.between(e,1e9,(s,r,{spec:o})=>{if(!(t&&o.diagnostics.indexOf(t)<0))if(!n)n=new _v(s,r,t||o.diagnostics[0]);else{if(o.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new _v(n.from,r,n.diagnostic)}}),n}function aZ(i,t){let e=t.pos,n=t.end||e,s=i.state.facet(th).hideOn(i,e,n);if(s!=null)return s;let r=i.startState.doc.lineAt(t.pos);return!!(i.effects.some(o=>o.is(bC))||i.changes.touchesRange(r.from,Math.max(r.to,n)))}function lZ(i,t){return i.field(cn,!1)?t:t.concat(Ct.appendConfig.of(vZ))}const bC=Ct.define(),w1=Ct.define(),vC=Ct.define(),cn=Ke.define({create(){return new mo(vt.none,null,null)},update(i,t){if(t.docChanged&&i.diagnostics.size){let e=i.diagnostics.map(t.changes),n=null,s=i.panel;if(i.selected){let r=t.changes.mapPos(i.selected.from,1);n=rl(e,i.selected.diagnostic,r)||rl(e,null,r)}!e.size&&s&&t.state.facet(th).autoPanel&&(s=null),i=new mo(e,s,n)}for(let e of t.effects)if(e.is(bC)){let n=t.state.facet(th).autoPanel?e.value.length?eh.open:null:i.panel;i=mo.init(e.value,n,t.state)}else e.is(w1)?i=new mo(i.diagnostics,e.value?eh.open:null,i.selected):e.is(vC)&&(i=new mo(i.diagnostics,i.panel,e.value));return i},provide:i=>[Gc.from(i,t=>t.panel),ct.decorations.from(i,t=>t.diagnostics)]}),cZ=vt.mark({class:"cm-lintRange cm-lintRange-active"});function hZ(i,t,e){let{diagnostics:n}=i.state.field(cn),s,r=-1,o=-1;n.between(t-(e<0?1:0),t+(e>0?1:0),(l,c,{spec:h})=>{if(t>=l&&t<=c&&(l==c||(t>l||e>0)&&(t<c||e<0)))return s=h.diagnostics,r=l,o=c,!1});let a=i.state.facet(th).tooltipFilter;return s&&a&&(s=a(s,i.state)),s?{pos:r,end:o,above:i.state.doc.lineAt(r).to<o,create(){return{dom:uZ(i,s)}}}:null}function uZ(i,t){return ee("ul",{class:"cm-tooltip-lint"},t.map(e=>xC(i,e,!1)))}const fZ=i=>{let t=i.state.field(cn,!1);(!t||!t.panel)&&i.dispatch({effects:lZ(i.state,[w1.of(!0)])});let e=zc(i,eh.open);return e&&e.dom.querySelector(".cm-panel-lint ul").focus(),!0},xv=i=>{let t=i.state.field(cn,!1);return!t||!t.panel?!1:(i.dispatch({effects:w1.of(!1)}),!0)},dZ=i=>{let t=i.state.field(cn,!1);if(!t)return!1;let e=i.state.selection.main,n=t.diagnostics.iter(e.to+1);return!n.value&&(n=t.diagnostics.iter(0),!n.value||n.from==e.from&&n.to==e.to)?!1:(i.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),!0)},pZ=[{key:"Mod-Shift-m",run:fZ,preventDefault:!0},{key:"F8",run:dZ}],th=ut.define({combine(i){return{sources:i.map(t=>t.source).filter(t=>t!=null),...Ms(i.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:Sv,tooltipFilter:Sv,needsRefresh:(t,e)=>t?e?n=>t(n)||e(n):t:e,hideOn:(t,e)=>t?e?(n,s,r)=>t(n,s,r)||e(n,s,r):t:e,autoPanel:(t,e)=>t||e})}}});function Sv(i,t){return i?t?(e,n)=>t(i(e,n),n):i:t}function _C(i){let t=[];if(i)t:for(let{name:e}of i){for(let n=0;n<e.length;n++){let s=e[n];if(/[a-zA-Z]/.test(s)&&!t.some(r=>r.toLowerCase()==s.toLowerCase())){t.push(s);continue t}}t.push("")}return t}function xC(i,t,e){var n;let s=e?_C(t.actions):[];return ee("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},ee("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(i):t.message),(n=t.actions)===null||n===void 0?void 0:n.map((r,o)=>{let a=!1,l=d=>{if(d.preventDefault(),a)return;a=!0;let p=rl(i.state.field(cn).diagnostics,t);p&&r.apply(i,p.from,p.to)},{name:c}=r,h=s[o]?c.indexOf(s[o]):-1,u=h<0?c:[c.slice(0,h),ee("u",c.slice(h,h+1)),c.slice(h+1)],f=r.markClass?" "+r.markClass:"";return ee("button",{type:"button",class:"cm-diagnosticAction"+f,onclick:l,onmousedown:l,"aria-label":` Action: ${c}${h<0?"":` (access key "${s[o]})"`}.`},u)}),t.source&&ee("div",{class:"cm-diagnosticSource"},t.source))}class gZ extends Es{constructor(t){super(),this.sev=t}eq(t){return t.sev==this.sev}toDOM(){return ee("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class wv{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=xC(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class eh{constructor(t){this.view=t,this.items=[];let e=s=>{if(s.keyCode==27)xv(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],o=_C(r.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==s.keyCode){let l=rl(this.view.state.field(cn).diagnostics,r);l&&r.actions[a].apply(t,l.from,l.to)}}else return;s.preventDefault()},n=s=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(s.target)&&this.moveSelection(r)};this.list=ee("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:n}),this.dom=ee("div",{class:"cm-panel-lint"},this.list,ee("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>xv(this.view)},"×")),this.update()}get selectedIndex(){let t=this.view.state.field(cn).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(cn),n=0,s=!1,r=null,o=new Set;for(t.between(0,this.view.state.doc.length,(a,l,{spec:c})=>{for(let h of c.diagnostics){if(o.has(h))continue;o.add(h);let u=-1,f;for(let d=n;d<this.items.length;d++)if(this.items[d].diagnostic==h){u=d;break}u<0?(f=new wv(this.view,h),this.items.splice(n,0,f),s=!0):(f=this.items[u],u>n&&(this.items.splice(n,u-n),s=!0)),e&&f.diagnostic==e.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),r=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new wv(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let c=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/c:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let t=this.list.firstChild;function e(){let n=t;t=n.nextSibling,n.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;t!=n.dom;)e();t=n.dom.nextSibling}else this.list.insertBefore(n.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(cn),n=rl(e.diagnostics,this.items[t].diagnostic);n&&this.view.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:vC.of(n)})}static open(t){return new eh(t)}}function mZ(i,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(i)}</svg>')`}function Gu(i){return mZ(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const OZ=ct.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Gu("#d11")},".cm-lintRange-warning":{backgroundImage:Gu("orange")},".cm-lintRange-info":{backgroundImage:Gu("#999")},".cm-lintRange-hint":{backgroundImage:Gu("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function yZ(i){return i=="error"?4:i=="warning"?3:i=="info"?2:1}function bZ(i){let t="hint",e=1;for(let n of i){let s=yZ(n.severity);s>e&&(e=s,t=n.severity)}return t}const vZ=[cn,ct.decorations.compute([cn],i=>{let{selected:t,panel:e}=i.field(cn);return!t||!e||t.from==t.to?vt.none:vt.set([cZ.range(t.from,t.to)])}),iD(hZ,{hideOn:aZ}),OZ],_Z=[dD(),mD(),E$(),IL(),oL(),v$(),k$(),Vt.allowMultipleSelections.of(!0),zD(),g5(hL,{fallback:!0}),OL(),jB(),rZ(),X$(),j$(),D$(),FV(),Rh.of([...KB,...NV,...aB,...FL,...iL,...yC,...pZ])];/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var xZ=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[_Z]}),SZ=Symbol("vue-codemirror-global-config"),Ci,wZ=function(i){var t=i.onUpdate,e=i.onChange,n=i.onFocus,s=i.onBlur,r=(function(o,a){var l={};for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&a.indexOf(c)<0&&(l[c]=o[c]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var h=0;for(c=Object.getOwnPropertySymbols(o);h<c.length;h++)a.indexOf(c[h])<0&&Object.prototype.propertyIsEnumerable.call(o,c[h])&&(l[c[h]]=o[c[h]])}return l})(i,["onUpdate","onChange","onFocus","onBlur"]);return Vt.create({doc:r.doc,selection:r.selection,extensions:(Array.isArray(r.extensions)?r.extensions:[r.extensions]).concat([ct.updateListener.of((function(o){t(o),o.docChanged&&e(o.state.doc.toString(),o),o.focusChanged&&(o.view.hasFocus?n(o):s(o))}))])})},ga=function(i){var t=new Th;return{compartment:t,run:function(e){t.get(i.state)?i.dispatch({effects:t.reconfigure(e)}):i.dispatch({effects:Ct.appendConfig.of(t.of(e))})}}},kv=function(i,t){var e=ga(i),n=e.compartment,s=e.run;return function(r){var o=n.get(i.state);s(r??o!==t?t:[])}},ju={type:Boolean,default:void 0},kZ={autofocus:ju,disabled:ju,indentWithTab:ju,tabSize:Number,placeholder:String,style:Object,autoDestroy:ju,phrases:Object,root:Object,extensions:Array,selection:Object},CZ={modelValue:{type:String,default:""}},TZ=Object.assign(Object.assign({},kZ),CZ);(function(i){i.Change="change",i.Update="update",i.Focus="focus",i.Blur="blur",i.Ready="ready",i.ModelUpdate="update:modelValue"})(Ci||(Ci={}));var Oo={};Oo[Ci.Change]=function(i,t){return!0},Oo[Ci.Update]=function(i){return!0},Oo[Ci.Focus]=function(i){return!0},Oo[Ci.Blur]=function(i){return!0},Oo[Ci.Ready]=function(i){return!0};var SC={};SC[Ci.ModelUpdate]=Oo[Ci.Change];var PZ=Object.assign(Object.assign({},Oo),SC),AZ=al({name:"VueCodemirror",props:Object.assign({},TZ),emits:Object.assign({},PZ),setup:function(i,t){var e=Tp(),n=Tp(),s=Tp(),r=Object.assign(Object.assign({},xZ),gc(SZ,{})),o=fs((function(){var a={};return Object.keys(Gt(i)).forEach((function(l){var c;l!=="modelValue"&&(a[l]=(c=i[l])!==null&&c!==void 0?c:r[l])})),a}));return Ad((function(){var a;n.value=wZ({doc:i.modelValue,selection:o.value.selection,extensions:(a=r.extensions)!==null&&a!==void 0?a:[],onFocus:function(c){return t.emit(Ci.Focus,c)},onBlur:function(c){return t.emit(Ci.Blur,c)},onUpdate:function(c){return t.emit(Ci.Update,c)},onChange:function(c,h){c!==i.modelValue&&(t.emit(Ci.Change,c,h),t.emit(Ci.ModelUpdate,c,h))}}),s.value=(function(c){return new ct(Object.assign({},c))})({state:n.value,parent:e.value,root:o.value.root});var l=(function(c){var h=function(){return c.state.doc.toString()},u=ga(c).run,f=kv(c,[ct.editable.of(!1),Vt.readOnly.of(!0)]),d=kv(c,Rh.of([$V])),p=ga(c).run,g=ga(c).run,m=ga(c).run,O=ga(c).run;return{focus:function(){return c.focus()},getDoc:h,setDoc:function(y){y!==h()&&c.dispatch({changes:{from:0,to:c.state.doc.length,insert:y}})},reExtensions:u,toggleDisabled:f,toggleIndentWithTab:d,setTabSize:function(y){p([Vt.tabSize.of(y),Qh.of(" ".repeat(y))])},setPhrases:function(y){g([Vt.phrases.of(y)])},setPlaceholder:function(y){m(Z$(y))},setStyle:function(y){y===void 0&&(y={}),O(ct.theme({"&":Object.assign({},y)}))}}})(s.value);ti((function(){return i.modelValue}),(function(c){c!==l.getDoc()&&l.setDoc(c)})),ti((function(){return i.extensions}),(function(c){return l.reExtensions(c||[])}),{immediate:!0}),ti((function(){return o.value.disabled}),(function(c){return l.toggleDisabled(c)}),{immediate:!0}),ti((function(){return o.value.indentWithTab}),(function(c){return l.toggleIndentWithTab(c)}),{immediate:!0}),ti((function(){return o.value.tabSize}),(function(c){return l.setTabSize(c)}),{immediate:!0}),ti((function(){return o.value.phrases}),(function(c){return l.setPhrases(c||{})}),{immediate:!0}),ti((function(){return o.value.placeholder}),(function(c){return l.setPlaceholder(c)}),{immediate:!0}),ti((function(){return o.value.style}),(function(c){return l.setStyle(c)}),{immediate:!0}),o.value.autofocus&&l.focus(),t.emit(Ci.Ready,{state:n.value,view:s.value,container:e.value})})),Z0((function(){o.value.autoDestroy&&s.value&&(function(a){a.destroy()})(s.value)})),function(){return dP("div",{class:"v-codemirror",style:{display:"contents"},ref:e})}}}),MZ=AZ,Cv={};class gd{constructor(t,e,n,s,r,o,a,l,c,h=0,u){this.p=t,this.stack=e,this.state=n,this.reducePos=s,this.pos=r,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=c,this.lookAhead=h,this.parent=u}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,n=0){let s=t.parser.context;return new gd(t,[],e,n,n,0,[],0,s?new Tv(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let n=t>>19,s=t&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let a=r.dynamicPrecedence(s);if(a&&(this.score+=a),n==0){this.pushState(r.getGoto(this.state,s,!0),this.reducePos),s<r.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(s,this.reducePos);return}let l=this.stack.length-(n-1)*3-(t&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-c;h>=2e3&&!(!((e=this.p.parser.nodeSet.types[s])===null||e===void 0)&&e.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=h));let u=l?this.stack[l-1]:0,f=this.bufferBase+this.buffer.length-u;if(s<r.minRepeatTerm||t&131072){let d=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,c,d,f+4,!0)}if(t&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=r.getGoto(d,s,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(s,c)}storeNode(t,e,n,s=4,r=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(e==n)return;if(o.buffer[a-2]>=e){o.buffer[a-2]=n;return}}}if(!r||this.pos==n)this.buffer.push(t,e,n,s);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let a=!1;for(let l=o;l>0&&this.buffer[l-2]>n;l-=4)if(this.buffer[l-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>n;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,s>4&&(s-=4)}this.buffer[o]=t,this.buffer[o+1]=e,this.buffer[o+2]=n,this.buffer[o+3]=s}}shift(t,e,n,s){if(t&131072)this.pushState(t&65535,this.pos);else if((t&262144)==0){let r=t,{parser:o}=this.p;(s>this.pos||e<=o.maxNode)&&(this.pos=s,o.stateFlag(r,1)||(this.reducePos=s)),this.pushState(r,n),this.shiftContext(e,n),e<=o.maxNode&&this.buffer.push(e,n,s,4)}else this.pos=s,this.shiftContext(e,n),e<=this.p.parser.maxNode&&this.buffer.push(e,n,s,4)}apply(t,e,n,s){t&65536?this.reduce(t):this.shift(t,e,n,s)}useNode(t,e){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=t)&&(this.p.reused.push(t),n++);let s=this.pos;this.reducePos=this.pos=s+t.length,this.pushState(e,s),this.buffer.push(n,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let n=t.buffer.slice(e),s=t.bufferBase+e;for(;t&&s==t.bufferBase;)t=t.parent;return new gd(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,s,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let n=t<=this.p.parser.maxNode;n&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,n?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new EZ(this);;){let n=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(n==0)return!1;if((n&65536)==0)return!0;e.reduce(n)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let s=[];for(let r=0,o;r<e.length;r+=2)(o=e[r+1])!=this.state&&this.p.parser.hasAction(o,t)&&s.push(e[r],o);if(this.stack.length<120)for(let r=0;s.length<8&&r<e.length;r+=2){let o=e[r+1];s.some((a,l)=>l&1&&a==o)||s.push(e[r],o)}e=s}let n=[];for(let s=0;s<e.length&&n.length<4;s+=2){let r=e[s+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(e[s],this.pos),o.reducePos=this.pos,o.score-=200,n.push(o)}return n}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if((e&65536)==0)return!1;if(!t.validAction(this.state,e)){let n=e>>19,s=e&65535,r=this.stack.length-n*3;if(r<0||t.getGoto(this.stack[r],s,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;e=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],n=(s,r)=>{if(!e.includes(s))return e.push(s),t.allActions(s,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-r;if(a>1){let l=o&65535,c=this.stack.length-a*3;if(c>=0&&t.getGoto(this.stack[c],l,!1)>=0)return a<<19|65536|l}}else{let a=n(o,r+1);if(a!=null)return a}})};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new Tv(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class Tv{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class EZ{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,n=t>>19;n==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(n-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=s}}class md{constructor(t,e,n){this.stack=t,this.pos=e,this.index=n,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new md(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new md(this.stack,this.pos,this.index)}}function lc(i,t=Uint16Array){if(typeof i!="string")return i;let e=null;for(let n=0,s=0;n<i.length;){let r=0;for(;;){let o=i.charCodeAt(n++),a=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),r+=l,a)break;r*=46}e?e[s++]=r:e=new t(r)}return e}class gf{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const Pv=new gf;class RZ{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=Pv,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let n=this.range,s=this.rangeIndex,r=this.pos+t;for(;r<n.from;){if(!s)return null;let o=this.ranges[--s];r-=n.from-o.to,n=o}for(;e<0?r>n.to:r>=n.to;){if(s==this.ranges.length-1)return null;let o=this.ranges[++s];r+=o.from-n.to,n=o}return r}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,n,s;if(e>=0&&e<this.chunk.length)n=this.pos+t,s=this.chunk.charCodeAt(e);else{let r=this.resolveOffset(t,1);if(r==null)return-1;if(n=r,n>=this.chunk2Pos&&n<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(n-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=n;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=n),n+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-n)),s=this.chunk2.charCodeAt(0)}}return n>=this.token.lookAhead&&(this.token.lookAhead=n+1),s}acceptToken(t,e=0){let n=e?this.resolveOffset(e,-1):this.pos;if(n==null||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=n}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=Pv,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let n="";for(let s of this.ranges){if(s.from>=e)break;s.to>t&&(n+=this.input.read(Math.max(s.from,t),Math.min(s.to,e)))}return n}}class $a{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:n}=e.p;wC(this.data,t,e,this.id,n.data,n.tokenPrecTable)}}$a.prototype.contextual=$a.prototype.fallback=$a.prototype.extend=!1;class y0{constructor(t,e,n){this.precTable=e,this.elseToken=n,this.data=typeof t=="string"?lc(t):t}token(t,e){let n=t.pos,s=0;for(;;){let r=t.next<0,o=t.resolveOffset(1,1);if(wC(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(r||s++,o==null)break;t.reset(o,t.token)}s&&(t.reset(n,t.token),t.acceptToken(this.elseToken,s))}}y0.prototype.contextual=$a.prototype.fallback=$a.prototype.extend=!1;class Bh{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function wC(i,t,e,n,s,r){let o=0,a=1<<n,{dialect:l}=e.p.parser;t:for(;(a&i[o])!=0;){let c=i[o+1];for(let d=o+3;d<c;d+=2)if((i[d+1]&a)>0){let p=i[d];if(l.allows(p)&&(t.token.value==-1||t.token.value==p||IZ(p,t.token.value,s,r))){t.acceptToken(p);break}}let h=t.next,u=0,f=i[o+2];if(t.next<0&&f>u&&i[c+f*3-3]==65535){o=i[c+f*3-1];continue t}for(;u<f;){let d=u+f>>1,p=c+d+(d<<1),g=i[p],m=i[p+1]||65536;if(h<g)f=d;else if(h>=m)u=d+1;else{o=i[p+2],t.advance();continue t}}break}}function Av(i,t,e){for(let n=t,s;(s=i[n])!=65535;n++)if(s==e)return n-t;return-1}function IZ(i,t,e,n){let s=Av(e,n,t);return s<0||Av(e,n,i)<s}const tn=typeof process<"u"&&Cv&&/\bparse\b/.test(Cv.LOG);let kg=null;function Mv(i,t,e){let n=i.cursor(Fe.IncludeAnonymous);for(n.moveTo(t);;)if(!(e<0?n.childBefore(t):n.childAfter(t)))for(;;){if((e<0?n.to<t:n.from>t)&&!n.type.isError)return e<0?Math.max(0,Math.min(n.to-1,t-25)):Math.min(i.length,Math.max(n.from+1,t+25));if(e<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return e<0?0:i.length}}class QZ{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?Mv(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?Mv(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let n=this.trees[e],s=this.index[e];if(s==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[s],o=this.start[e]+n.positions[s];if(o>t)return this.nextStart=o,null;if(r instanceof De){if(o==t){if(o<this.safeFrom)return null;let a=o+r.length;if(a<=this.safeTo){let l=r.prop(Qt.lookAhead);if(!l||a+l<this.fragment.to)return r}}this.index[e]++,o+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+r.length}}}class NZ{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(n=>new gf)}getActions(t){let e=0,n=null,{parser:s}=t.p,{tokenizers:r}=s,o=s.stateSlot(t.state,3),a=t.curContext?t.curContext.hash:0,l=0;for(let c=0;c<r.length;c++){if((1<<c&o)==0)continue;let h=r[c],u=this.tokens[c];if(!(n&&!h.fallback)&&((h.contextual||u.start!=t.pos||u.mask!=o||u.context!=a)&&(this.updateCachedToken(u,h,t),u.mask=o,u.context=a),u.lookAhead>u.end+25&&(l=Math.max(u.lookAhead,l)),u.value!=0)){let f=e;if(u.extended>-1&&(e=this.addActions(t,u.extended,u.end,e)),e=this.addActions(t,u.value,u.end,e),!h.extend&&(n=u,e>f))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),!n&&t.pos==this.stream.end&&(n=new gf,n.value=t.p.parser.eofTerm,n.start=n.end=t.pos,e=this.addActions(t,n.value,n.end,e)),this.mainToken=n,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new gf,{pos:n,p:s}=t;return e.start=n,e.end=Math.min(n+1,s.stream.end),e.value=n==s.stream.end?s.parser.eofTerm:0,e}updateCachedToken(t,e,n){let s=this.stream.clipPos(n.pos);if(e.token(this.stream.reset(s,t),n),t.value>-1){let{parser:r}=n.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==t.value){let a=r.specializers[o](this.stream.read(t.start,t.end),n);if(a>=0&&n.p.parser.dialect.allows(a>>1)){(a&1)==0?t.value=a>>1:t.extended=a>>1;break}}}else t.value=0,t.end=this.stream.clipPos(s+1)}putAction(t,e,n,s){for(let r=0;r<s;r+=3)if(this.actions[r]==t)return s;return this.actions[s++]=t,this.actions[s++]=e,this.actions[s++]=n,s}addActions(t,e,n,s){let{state:r}=t,{parser:o}=t.p,{data:a}=o;for(let l=0;l<2;l++)for(let c=o.stateSlot(r,l?2:1);;c+=3){if(a[c]==65535)if(a[c+1]==1)c=Bs(a,c+2);else{s==0&&a[c+1]==2&&(s=this.putAction(Bs(a,c+2),e,n,s));break}a[c]==e&&(s=this.putAction(Bs(a,c+1),e,n,s))}return s}}class $Z{constructor(t,e,n,s){this.parser=t,this.input=e,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new RZ(e,s),this.tokens=new NZ(t,this.stream),this.topTerm=t.top[1];let{from:r}=s[0];this.stacks=[gd.start(this,t.top[0],r)],this.fragments=n.length&&this.stream.end-r>t.bufferLength*4?new QZ(n,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,n=this.stacks=[],s,r;if(this.bigReductionCount>300&&t.length==1){let[o]=t;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<t.length;o++){let a=t[o];for(;;){if(this.tokens.mainToken=null,a.pos>e)n.push(a);else{if(this.advanceStack(a,n,t))continue;{s||(s=[],r=[]),s.push(a);let l=this.tokens.getMainToken(a);r.push(l.value,l.end)}}break}}if(!n.length){let o=s&&VZ(s);if(o)return tn&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw tn&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&s){let o=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,r,n);if(o)return tn&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(n.length>o)for(n.sort((a,l)=>l.score-a.score);n.length>o;)n.pop();n.some(a=>a.reducePos>e)&&this.recovering--}else if(n.length>1){t:for(let o=0;o<n.length-1;o++){let a=n[o];for(let l=o+1;l<n.length;l++){let c=n[l];if(a.sameState(c)||a.buffer.length>500&&c.buffer.length>500)if((a.score-c.score||a.buffer.length-c.buffer.length)>0)n.splice(l--,1);else{n.splice(o--,1);continue t}}}n.length>12&&n.splice(12,n.length-12)}this.minStackPos=n[0].pos;for(let o=1;o<n.length;o++)n[o].pos<this.minStackPos&&(this.minStackPos=n[o].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,n){let s=t.pos,{parser:r}=this,o=tn?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let c=t.curContext&&t.curContext.tracker.strict,h=c?t.curContext.hash:0;for(let u=this.fragments.nodeAt(s);u;){let f=this.parser.nodeSet.types[u.type.id]==u.type?r.getGoto(t.state,u.type.id):-1;if(f>-1&&u.length&&(!c||(u.prop(Qt.contextHash)||0)==h))return t.useNode(u,f),tn&&console.log(o+this.stackID(t)+` (via reuse of ${r.getName(u.type.id)})`),!0;if(!(u instanceof De)||u.children.length==0||u.positions[0]>0)break;let d=u.children[0];if(d instanceof De&&u.positions[0]==0)u=d;else break}}let a=r.stateSlot(t.state,4);if(a>0)return t.reduce(a),tn&&console.log(o+this.stackID(t)+` (via always-reduce ${r.getName(a&65535)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let c=0;c<l.length;){let h=l[c++],u=l[c++],f=l[c++],d=c==l.length||!n,p=d?t:t.split(),g=this.tokens.mainToken;if(p.apply(h,u,g?g.start:p.pos,f),tn&&console.log(o+this.stackID(p)+` (via ${(h&65536)==0?"shift":`reduce of ${r.getName(h&65535)}`} for ${r.getName(u)} @ ${s}${p==t?"":", split"})`),d)return!0;p.pos>s?e.push(p):n.push(p)}return!1}advanceFully(t,e){let n=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>n)return Ev(t,e),!0}}runRecovery(t,e,n){let s=null,r=!1;for(let o=0;o<t.length;o++){let a=t[o],l=e[o<<1],c=e[(o<<1)+1],h=tn?this.stackID(a)+" -> ":"";if(a.deadEnd&&(r||(r=!0,a.restart(),tn&&console.log(h+this.stackID(a)+" (restarted)"),this.advanceFully(a,n))))continue;let u=a.split(),f=h;for(let d=0;u.forceReduce()&&d<10&&(tn&&console.log(f+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,n));d++)tn&&(f=this.stackID(u)+" -> ");for(let d of a.recoverByInsert(l))tn&&console.log(h+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,n);this.stream.end>a.pos?(c==a.pos&&(c++,l=0),a.recoverByDelete(l,c),tn&&console.log(h+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),Ev(a,n)):(!s||s.score<a.score)&&(s=a)}return s}stackToTree(t){return t.close(),De.build({buffer:md.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(kg||(kg=new WeakMap)).get(t);return e||kg.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function Ev(i,t){for(let e=0;e<t.length;e++){let n=t[e];if(n.pos==i.pos&&n.sameState(i)){t[e].score<i.score&&(t[e]=i);return}}t.push(i)}class DZ{constructor(t,e,n){this.source=t,this.flags=e,this.disabled=n}allows(t){return!this.disabled||this.disabled[t]==0}}const Cg=i=>i;class LZ{constructor(t){this.start=t.start,this.shift=t.shift||Cg,this.reduce=t.reduce||Cg,this.reuse=t.reuse||Cg,this.hash=t.hash||(()=>0),this.strict=t.strict!==!1}}class Od extends Hk{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let a=0;a<t.repeatNodeCount;a++)e.push("");let n=Object.keys(t.topRules).map(a=>t.topRules[a][1]),s=[];for(let a=0;a<e.length;a++)s.push([]);function r(a,l,c){s[a].push([l,l.deserialize(String(c))])}if(t.nodeProps)for(let a of t.nodeProps){let l=a[0];typeof l=="string"&&(l=Qt[l]);for(let c=1;c<a.length;){let h=a[c++];if(h>=0)r(h,l,a[c++]);else{let u=a[c+-h];for(let f=-h;f>0;f--)r(a[c++],l,u);c++}}}this.nodeSet=new n1(e.map((a,l)=>Ui.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:s[l],top:n.indexOf(l)>-1,error:l==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(l)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=Gk;let o=lc(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(Rv),this.states=lc(t.states,Uint32Array),this.data=lc(t.stateData),this.goto=lc(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(a=>typeof a=="number"?new $a(o,a):a),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,n){let s=new $Z(this,t,e,n);for(let r of this.wrappers)s=r(s,t,e,n);return s}getGoto(t,e,n=!1){let s=this.goto;if(e>=s[0])return-1;for(let r=s[e+1];;){let o=s[r++],a=o&1,l=s[r++];if(a&&n)return l;for(let c=r+(o>>1);r<c;r++)if(s[r]==t)return l;if(a)return-1}}hasAction(t,e){let n=this.data;for(let s=0;s<2;s++)for(let r=this.stateSlot(t,s?2:1),o;;r+=3){if((o=n[r])==65535)if(n[r+1]==1)o=n[r=Bs(n,r+2)];else{if(n[r+1]==2)return Bs(n,r+2);break}if(o==e||o==0)return Bs(n,r+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,n=>n==e?!0:null)}allActions(t,e){let n=this.stateSlot(t,4),s=n?e(n):void 0;for(let r=this.stateSlot(t,1);s==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=Bs(this.data,r+2);else break;s=e(Bs(this.data,r+1))}return s}nextStates(t){let e=[];for(let n=this.stateSlot(t,1);;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=Bs(this.data,n+2);else break;if((this.data[n+2]&1)==0){let s=this.data[n+1];e.some((r,o)=>o&1&&r==s)||e.push(this.data[n],s)}}return e}configure(t){let e=Object.assign(Object.create(Od.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let n=this.topRules[t.top];if(!n)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=n}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(n=>{let s=t.tokenizers.find(r=>r.from==n);return s?s.to:n})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((n,s)=>{let r=t.specializers.find(a=>a.from==n.external);if(!r)return n;let o=Object.assign(Object.assign({},n),{external:r.to});return e.specializers[s]=Rv(o),o})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),n=e.map(()=>!1);if(t)for(let r of t.split(" ")){let o=e.indexOf(r);o>=0&&(n[o]=!0)}let s=null;for(let r=0;r<e.length;r++)if(!n[r])for(let o=this.dialects[e[r]],a;(a=this.data[o++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[a]=1;return new DZ(t,n,s)}static deserialize(t){return new Od(t)}}function Bs(i,t){return i[t]|i[t+1]<<16}function VZ(i){let t=null;for(let e of i){let n=e.p.stoppedAt;(e.pos==e.p.stream.end||n!=null&&e.pos>n)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function Rv(i){if(i.external){let t=i.extend?1:0;return(e,n)=>i.external(e,n)<<1|t}return i.get}const BZ=316,ZZ=317,Iv=1,FZ=2,WZ=3,qZ=4,XZ=318,zZ=320,GZ=321,jZ=5,UZ=6,YZ=0,b0=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],kC=125,HZ=59,v0=47,KZ=42,JZ=43,tF=45,eF=60,iF=44,nF=63,sF=46,rF=91,oF=new LZ({start:!1,shift(i,t){return t==jZ||t==UZ||t==zZ?i:t==GZ},strict:!1}),aF=new Bh((i,t)=>{let{next:e}=i;(e==kC||e==-1||t.context)&&i.acceptToken(XZ)},{contextual:!0,fallback:!0}),lF=new Bh((i,t)=>{let{next:e}=i,n;b0.indexOf(e)>-1||e==v0&&((n=i.peek(1))==v0||n==KZ)||e!=kC&&e!=HZ&&e!=-1&&!t.context&&i.acceptToken(BZ)},{contextual:!0}),cF=new Bh((i,t)=>{i.next==rF&&!t.context&&i.acceptToken(ZZ)},{contextual:!0}),hF=new Bh((i,t)=>{let{next:e}=i;if(e==JZ||e==tF){if(i.advance(),e==i.next){i.advance();let n=!t.context&&t.canShift(Iv);i.acceptToken(n?Iv:FZ)}}else e==nF&&i.peek(1)==sF&&(i.advance(),i.advance(),(i.next<48||i.next>57)&&i.acceptToken(WZ))},{contextual:!0});function Tg(i,t){return i>=65&&i<=90||i>=97&&i<=122||i==95||i>=192||!t&&i>=48&&i<=57}const uF=new Bh((i,t)=>{if(i.next!=eF||!t.dialectEnabled(YZ)||(i.advance(),i.next==v0))return;let e=0;for(;b0.indexOf(i.next)>-1;)i.advance(),e++;if(Tg(i.next,!0)){for(i.advance(),e++;Tg(i.next,!1);)i.advance(),e++;for(;b0.indexOf(i.next)>-1;)i.advance(),e++;if(i.next==iF)return;for(let n=0;;n++){if(n==7){if(!Tg(i.next,!0))return;break}if(i.next!="extends".charCodeAt(n))break;i.advance(),e++}}i.acceptToken(qZ,-e)}),fF=Kk({"get set async static":N.modifier,"for while do if else switch try catch finally return throw break continue default case defer":N.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":N.operatorKeyword,"let var const using function class extends":N.definitionKeyword,"import export from":N.moduleKeyword,"with debugger new":N.keyword,TemplateString:N.special(N.string),super:N.atom,BooleanLiteral:N.bool,this:N.self,null:N.null,Star:N.modifier,VariableName:N.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":N.function(N.variableName),VariableDefinition:N.definition(N.variableName),Label:N.labelName,PropertyName:N.propertyName,PrivatePropertyName:N.special(N.propertyName),"CallExpression/MemberExpression/PropertyName":N.function(N.propertyName),"FunctionDeclaration/VariableDefinition":N.function(N.definition(N.variableName)),"ClassDeclaration/VariableDefinition":N.definition(N.className),"NewExpression/VariableName":N.className,PropertyDefinition:N.definition(N.propertyName),PrivatePropertyDefinition:N.definition(N.special(N.propertyName)),UpdateOp:N.updateOperator,"LineComment Hashbang":N.lineComment,BlockComment:N.blockComment,Number:N.number,String:N.string,Escape:N.escape,ArithOp:N.arithmeticOperator,LogicOp:N.logicOperator,BitOp:N.bitwiseOperator,CompareOp:N.compareOperator,RegExp:N.regexp,Equals:N.definitionOperator,Arrow:N.function(N.punctuation),": Spread":N.punctuation,"( )":N.paren,"[ ]":N.squareBracket,"{ }":N.brace,"InterpolationStart InterpolationEnd":N.special(N.brace),".":N.derefOperator,", ;":N.separator,"@":N.meta,TypeName:N.typeName,TypeDefinition:N.definition(N.typeName),"type enum interface implements namespace module declare":N.definitionKeyword,"abstract global Privacy readonly override":N.modifier,"is keyof unique infer asserts":N.operatorKeyword,JSXAttributeValue:N.attributeValue,JSXText:N.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":N.angleBracket,"JSXIdentifier JSXNameSpacedName":N.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":N.attributeName,"JSXBuiltin/JSXIdentifier":N.standard(N.tagName)}),dF={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},pF={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},gF={__proto__:null,"<":193},mF=Od.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:oF,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[fF],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[lF,cF,hF,uF,2,3,4,5,6,7,8,9,10,11,12,13,14,aF,new y0("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new y0("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:i=>dF[i]||-1},{term:343,get:i=>pF[i]||-1},{term:95,get:i=>gF[i]||-1}],tokenPrec:15201}),CC=[Di("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Di("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Di("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Di("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Di("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Di(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Di("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Di(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Di(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Di('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Di('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],OF=CC.concat([Di("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Di("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Di("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),Qv=new SD,TC=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Ul(i){return(t,e)=>{let n=t.node.getChild("VariableDefinition");return n&&e(n,i),!0}}const yF=["FunctionDeclaration"],bF={FunctionDeclaration:Ul("function"),ClassDeclaration:Ul("class"),ClassExpression:()=>!0,EnumDeclaration:Ul("constant"),TypeAliasDeclaration:Ul("type"),NamespaceDeclaration:Ul("namespace"),VariableDefinition(i,t){i.matchContext(yF)||t(i,"variable")},TypeDefinition(i,t){t(i,"type")},__proto__:null};function PC(i,t){let e=Qv.get(t);if(e)return e;let n=[],s=!0;function r(o,a){let l=i.sliceString(o.from,o.to);n.push({label:l,type:a})}return t.cursor(Fe.IncludeAnonymous).iterate(o=>{if(s)s=!1;else if(o.name){let a=bF[o.name];if(a&&a(o,r)||TC.has(o.name))return!1}else if(o.to-o.from>8192){for(let a of PC(i,o.node))n.push(a);return!1}}),Qv.set(t,n),n}const Nv=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,AC=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function vF(i){let t=ze(i.state).resolveInner(i.pos,-1);if(AC.indexOf(t.name)>-1)return null;let e=t.name=="VariableName"||t.to-t.from<20&&Nv.test(i.state.sliceDoc(t.from,t.to));if(!e&&!i.explicit)return null;let n=[];for(let s=t;s;s=s.parent)TC.has(s.name)&&(n=n.concat(PC(i.state.doc,s)));return{options:n,from:e?t.from:i.pos,validFor:Nv}}const Ao=id.define({name:"javascript",parser:mF.configure({props:[n5.add({IfStatement:gg({except:/^\s*({|else\b)/}),TryStatement:gg({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:qD,SwitchBody:i=>{let t=i.textAfter,e=/^\s*\}/.test(t),n=/^\s*(case|default)\b/.test(t);return i.baseIndent+(e?0:n?1:2)*i.unit},Block:WD({closing:"}"}),ArrowFunction:i=>i.baseIndent+i.unit,"TemplateString BlockComment":()=>null,"Statement Property":gg({except:/^\s*{/}),JSXElement(i){let t=/^\s*<\//.test(i.textAfter);return i.lineIndent(i.node.from)+(t?0:i.unit)},JSXEscape(i){let t=/\s*\}/.test(i.textAfter);return i.lineIndent(i.node.from)+(t?0:i.unit)},"JSXOpenTag JSXSelfClosingTag"(i){return i.column(i.node.from)+i.unit}}),o5.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":jD,BlockComment(i){return{from:i.from+2,to:i.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),MC={test:i=>/^JSX/.test(i.name),facet:e5({commentTokens:{block:{open:"{/*",close:"*/}"}}})},_F=Ao.configure({dialect:"ts"},"typescript"),xF=Ao.configure({dialect:"jsx",props:[a1.add(i=>i.isTop?[MC]:void 0)]}),SF=Ao.configure({dialect:"jsx ts",props:[a1.add(i=>i.isTop?[MC]:void 0)]},"typescript");let EC=i=>({label:i,type:"keyword"});const RC="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(EC),wF=RC.concat(["declare","implements","private","protected","public"].map(EC));function kF(i={}){let t=i.jsx?i.typescript?SF:xF:i.typescript?_F:Ao,e=i.typescript?OF.concat(wF):CC.concat(RC);return new ND(t,[Ao.data.of({autocomplete:fB(AC,lC(e))}),Ao.data.of({autocomplete:vF}),i.jsx?PF:[]])}function CF(i){for(;;){if(i.name=="JSXOpenTag"||i.name=="JSXSelfClosingTag"||i.name=="JSXFragmentTag")return i;if(i.name=="JSXEscape"||!i.parent)return null;i=i.parent}}function $v(i,t,e=i.length){for(let n=t?.firstChild;n;n=n.nextSibling)if(n.name=="JSXIdentifier"||n.name=="JSXBuiltin"||n.name=="JSXNamespacedName"||n.name=="JSXMemberExpression")return i.sliceString(n.from,Math.min(n.to,e));return""}const TF=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),PF=ct.inputHandler.of((i,t,e,n,s)=>{if((TF?i.composing:i.compositionStarted)||i.state.readOnly||t!=e||n!=">"&&n!="/"||!Ao.isActiveAt(i.state,t,-1))return!1;let r=s(),{state:o}=r,a=o.changeByRange(l=>{var c;let{head:h}=l,u=ze(o).resolveInner(h-1,-1),f;if(u.name=="JSXStartTag"&&(u=u.parent),!(o.doc.sliceString(h-1,h)!=n||u.name=="JSXAttributeValue"&&u.to>h)){if(n==">"&&u.name=="JSXFragmentTag")return{range:l,changes:{from:h,insert:"</>"}};if(n=="/"&&u.name=="JSXStartCloseTag"){let d=u.parent,p=d.parent;if(p&&d.from==h-2&&((f=$v(o.doc,p.firstChild,h))||((c=p.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let g=`${f}>`;return{range:H.cursor(h+g.length,-1),changes:{from:h,insert:g}}}}else if(n==">"){let d=CF(u);if(d&&d.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(h,h+2))&&(f=$v(o.doc,d,h)))return{range:l,changes:{from:h,insert:`</${f}>`}}}}return{range:l}});return a.changes.empty?!1:(i.dispatch([r,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),AF="#e5c07b",Dv="#e06c75",MF="#56b6c2",EF="#ffffff",mf="#abb2bf",_0="#7d8799",RF="#61afef",IF="#98c379",Lv="#d19a66",QF="#c678dd",NF="#21252b",Vv="#2c313a",Bv="#282c34",Pg="#353a42",$F="#3E4451",Zv="#528bff",DF=ct.theme({"&":{color:mf,backgroundColor:Bv},".cm-content":{caretColor:Zv},".cm-cursor, .cm-dropCursor":{borderLeftColor:Zv},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:$F},".cm-panels":{backgroundColor:NF,color:mf},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Bv,color:_0,border:"none"},".cm-activeLineGutter":{backgroundColor:Vv},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Pg},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Pg,borderBottomColor:Pg},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Vv,color:mf}}},{dark:!0}),LF=$h.define([{tag:N.keyword,color:QF},{tag:[N.name,N.deleted,N.character,N.propertyName,N.macroName],color:Dv},{tag:[N.function(N.variableName),N.labelName],color:RF},{tag:[N.color,N.constant(N.name),N.standard(N.name)],color:Lv},{tag:[N.definition(N.name),N.separator],color:mf},{tag:[N.typeName,N.className,N.number,N.changed,N.annotation,N.modifier,N.self,N.namespace],color:AF},{tag:[N.operator,N.operatorKeyword,N.url,N.escape,N.regexp,N.link,N.special(N.string)],color:MF},{tag:[N.meta,N.comment],color:_0},{tag:N.strong,fontWeight:"bold"},{tag:N.emphasis,fontStyle:"italic"},{tag:N.strikethrough,textDecoration:"line-through"},{tag:N.link,color:_0,textDecoration:"underline"},{tag:N.heading,fontWeight:"bold",color:Dv},{tag:[N.atom,N.bool,N.special(N.variableName)],color:Lv},{tag:[N.processingInstruction,N.string,N.inserted],color:IF},{tag:N.invalid,color:EF}]),VF=[DF,g5(LF)],BF={class:"transform-workbench"},ZF={class:"tabs"},FF=["onClick"],WF={key:0,class:"valid-indicator"},qF={class:"tab-content"},XF={class:"editor-section"},zF={class:"editor-header"},GF={class:"status"},jF={class:"editor-wrapper"},UF={key:0,class:"errors"},YF={key:1,class:"params-info"},HF={key:0,class:"no-params"},KF={key:1},JF={key:0},tW={key:0,class:"execute-section"},eW={class:"param-inputs"},iW=["for"],nW={key:0,class:"param-hint"},sW=["id","value","onInput"],rW={class:"execute-actions"},oW=["disabled"],aW=["disabled"],lW=al({__name:"TransformWorkbench",props:{registry:{}},setup(i){const t=i,e=ue(0),n=ue({}),s=[kF(),VF],r=fs(()=>t.registry.slots[e.value]),o=f=>{t.registry.setCode(e.value,f)},a=()=>{t.registry.validateSlot(e.value)},l=()=>{const f=r.value;if(!f||!f.isValid)return;const d=f.params.filter(g=>g.name!=="notes").map(g=>(n.value[e.value]||{})[g.name]||0),p=t.registry.applyTransform(e.value,d);p.status==="error"&&alert(`Error: ${p.error}`)},c=()=>{t.registry.setCode(e.value,`/**
 * Brief description of what this does.
 * @param {Note[]} notes - Input notes array
 * @param {number} amount - Parameter description (e.g., -12 to +12)
 * ... - more parameters, as long as they are all numbers (and you need a description line for each)
 */
function myTransform(notes, amount) {
  const newNotes = notes.map(n => ({...n}));
  // transform newNotes here
  return newNotes;
}`)},h=f=>(n.value[e.value]||(n.value[e.value]={}),n.value[e.value][f]||0),u=(f,d)=>{n.value[e.value]||(n.value[e.value]={}),n.value[e.value][f]=d};return(f,d)=>(It(),$t("div",BF,[Y("div",{class:"workbench-header"},[d[3]||(d[3]=Y("h3",null,"Transform Functions",-1)),Y("div",{class:"header-actions"},[d[2]||(d[2]=Y("span",{class:"template-hint"},"Click this to see the transform function format →",-1)),Y("button",{onClick:c,class:"btn btn-ghost template-btn",title:"Insert starter template"}," 📝 Template ")])]),Y("div",ZF,[(It(!0),$t(ci,null,yo(i.registry.slots,(p,g)=>(It(),$t("button",{key:g,onClick:m=>e.value=g,class:Ln(["tab",{active:e.value===g,valid:p.isValid}])},[Fi(Pe(p.name)+" ",1),p.isValid?(It(),$t("span",WF,"✓")):oi("",!0)],10,FF))),128))]),Y("div",qF,[Y("div",XF,[Y("div",zF,[Y("div",GF,[Y("span",{class:Ln(["badge",r.value.isValid?"badge-valid":"badge-warning","status-badge"])},Pe(r.value.isValid?"✓ Valid":"⚠ Not Validated"),3),Y("button",{onClick:a,class:"btn btn-primary validate-btn"}," Validate ")])]),Y("div",jF,[We(Re(MZ),{"model-value":r.value.code,"onUpdate:modelValue":o,extensions:s,style:{height:"300px",fontSize:"14px"},placeholder:"Write your transform function here..."},null,8,["model-value"])]),r.value.errors.length>0?(It(),$t("div",UF,[d[4]||(d[4]=Y("h4",null,"Validation Errors:",-1)),Y("ul",null,[(It(!0),$t(ci,null,yo(r.value.errors,(p,g)=>(It(),$t("li",{key:g,class:"error-item"},Pe(p),1))),128))])])):oi("",!0),r.value.isValid?(It(),$t("div",YF,[d[5]||(d[5]=Y("h4",null,"Parameters:",-1)),r.value.params.filter(p=>p.name!=="notes").length===0?(It(),$t("div",HF," No parameters (transform operates on notes only) ")):(It(),$t("ul",KF,[(It(!0),$t(ci,null,yo(r.value.params.filter(p=>p.name!=="notes"),p=>(It(),$t("li",{key:p.name},[Y("strong",null,Pe(p.name),1),p.description?(It(),$t("span",JF,": "+Pe(p.description),1)):oi("",!0)]))),128))]))])):oi("",!0)]),r.value.isValid?(It(),$t("div",tW,[d[6]||(d[6]=Y("h4",null,"Test Transform",-1)),Y("div",eW,[(It(!0),$t(ci,null,yo(r.value.params.filter(p=>p.name!=="notes"),p=>(It(),$t("div",{key:p.name,class:"param-input"},[Y("label",{for:`param-${p.name}`},[Fi(Pe(p.name)+" ",1),p.description?(It(),$t("span",nW,Pe(p.description),1)):oi("",!0)],8,iW),Y("input",{id:`param-${p.name}`,type:"number",value:h(p.name),onInput:g=>u(p.name,parseFloat(g.target.value)),step:"0.1",class:"input"},null,40,sW)]))),128))]),Y("div",rW,[Y("button",{onClick:l,class:"btn btn-primary apply-btn"}," Apply Transform "),Y("button",{onClick:d[0]||(d[0]=p=>i.registry.undo()),disabled:!i.registry.canUndo(),class:"btn btn-ghost undo-btn"}," ↶ Undo ",8,oW),Y("button",{onClick:d[1]||(d[1]=p=>i.registry.redo()),disabled:!i.registry.canRedo(),class:"btn btn-ghost redo-btn"}," ↷ Redo ",8,aW)])])):oi("",!0)])]))}}),cW=xh(lW,[["__scopeId","data-v-a4144f51"]]);var hW=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],IC=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],uW="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߽߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࢗ-࢟࣊-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯৾ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ૺ-૿ଁ-ଃ଼ା-ୄେୈୋ-୍୕-ୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఄ఼ా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ೳഀ-ഃ഻഼ാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ඁ-ඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ຼ່-໎໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜕ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠏-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᪿ-ᫎᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭᳴᳷-᳹᷀-᷿‌‍‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯・꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧ꠬ꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱ꣿ-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿･",QC="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙՠ-ֈא-תׯ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࡠ-ࡪࡰ-ࢇࢉ-ࢎࢠ-ࣉऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱৼਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౝౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೝೞೠೡೱೲഄ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄຆ-ຊຌ-ຣລວ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜑᜟ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡸᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭌᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲊᲐ-ᲺᲽ-Ჿᳩ-ᳬᳮ-ᳳᳵᳶᳺᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄯㄱ-ㆎㆠ-ㆿㇰ-ㇿ㐀-䶿一-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꟍꟐꟑꟓꟕ-Ƛꟲ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꣾꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭩꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",Ag={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Mg="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",fW={5:Mg,"5module":Mg+" export import",6:Mg+" const class extends export import super"},dW=/^in(stanceof)?$/,pW=new RegExp("["+QC+"]"),gW=new RegExp("["+QC+uW+"]");function x0(i,t){for(var e=65536,n=0;n<t.length;n+=2){if(e+=t[n],e>i)return!1;if(e+=t[n+1],e>=i)return!0}return!1}function ks(i,t){return i<65?i===36:i<91?!0:i<97?i===95:i<123?!0:i<=65535?i>=170&&pW.test(String.fromCharCode(i)):t===!1?!1:x0(i,IC)}function jr(i,t){return i<48?i===36:i<58?!0:i<65?!1:i<91?!0:i<97?i===95:i<123?!0:i<=65535?i>=170&&gW.test(String.fromCharCode(i)):t===!1?!1:x0(i,IC)||x0(i,hW)}var Xt=function(t,e){e===void 0&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function gn(i,t){return new Xt(i,{beforeExpr:!0,binop:t})}var mn={beforeExpr:!0},Ni={startsExpr:!0},k1={};function Zt(i,t){return t===void 0&&(t={}),t.keyword=i,k1[i]=new Xt(i,t)}var w={num:new Xt("num",Ni),regexp:new Xt("regexp",Ni),string:new Xt("string",Ni),name:new Xt("name",Ni),privateId:new Xt("privateId",Ni),eof:new Xt("eof"),bracketL:new Xt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Xt("]"),braceL:new Xt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Xt("}"),parenL:new Xt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Xt(")"),comma:new Xt(",",mn),semi:new Xt(";",mn),colon:new Xt(":",mn),dot:new Xt("."),question:new Xt("?",mn),questionDot:new Xt("?."),arrow:new Xt("=>",mn),template:new Xt("template"),invalidTemplate:new Xt("invalidTemplate"),ellipsis:new Xt("...",mn),backQuote:new Xt("`",Ni),dollarBraceL:new Xt("${",{beforeExpr:!0,startsExpr:!0}),eq:new Xt("=",{beforeExpr:!0,isAssign:!0}),assign:new Xt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Xt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Xt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:gn("||",1),logicalAND:gn("&&",2),bitwiseOR:gn("|",3),bitwiseXOR:gn("^",4),bitwiseAND:gn("&",5),equality:gn("==/!=/===/!==",6),relational:gn("</>/<=/>=",7),bitShift:gn("<</>>/>>>",8),plusMin:new Xt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:gn("%",10),star:gn("*",10),slash:gn("/",10),starstar:new Xt("**",{beforeExpr:!0}),coalesce:gn("??",1),_break:Zt("break"),_case:Zt("case",mn),_catch:Zt("catch"),_continue:Zt("continue"),_debugger:Zt("debugger"),_default:Zt("default",mn),_do:Zt("do",{isLoop:!0,beforeExpr:!0}),_else:Zt("else",mn),_finally:Zt("finally"),_for:Zt("for",{isLoop:!0}),_function:Zt("function",Ni),_if:Zt("if"),_return:Zt("return",mn),_switch:Zt("switch"),_throw:Zt("throw",mn),_try:Zt("try"),_var:Zt("var"),_const:Zt("const"),_while:Zt("while",{isLoop:!0}),_with:Zt("with"),_new:Zt("new",{beforeExpr:!0,startsExpr:!0}),_this:Zt("this",Ni),_super:Zt("super",Ni),_class:Zt("class",Ni),_extends:Zt("extends",mn),_export:Zt("export"),_import:Zt("import",Ni),_null:Zt("null",Ni),_true:Zt("true",Ni),_false:Zt("false",Ni),_in:Zt("in",{beforeExpr:!0,binop:7}),_instanceof:Zt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Zt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Zt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Zt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Yi=/\r\n?|\n|\u2028|\u2029/,mW=new RegExp(Yi.source,"g");function vl(i){return i===10||i===13||i===8232||i===8233}function NC(i,t,e){e===void 0&&(e=i.length);for(var n=t;n<e;n++){var s=i.charCodeAt(n);if(vl(s))return n<e-1&&s===13&&i.charCodeAt(n+1)===10?n+2:n+1}return-1}var $C=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ui=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,DC=Object.prototype,OW=DC.hasOwnProperty,yW=DC.toString,_l=Object.hasOwn||(function(i,t){return OW.call(i,t)}),Fv=Array.isArray||(function(i){return yW.call(i)==="[object Array]"}),Wv=Object.create(null);function Er(i){return Wv[i]||(Wv[i]=new RegExp("^(?:"+i.replace(/ /g,"|")+")$"))}function tr(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}var bW=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,ih=function(t,e){this.line=t,this.column=e};ih.prototype.offset=function(t){return new ih(this.line,this.column+t)};var mp=function(t,e,n){this.start=e,this.end=n,t.sourceFile!==null&&(this.source=t.sourceFile)};function LC(i,t){for(var e=1,n=0;;){var s=NC(i,n,t);if(s<0)return new ih(e,t-n);++e,n=s}}var S0={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},qv=!1;function vW(i){var t={};for(var e in S0)t[e]=i&&_l(i,e)?i[e]:S0[e];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!qv&&typeof console=="object"&&console.warn&&(qv=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!i||i.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),Fv(t.onToken)){var n=t.onToken;t.onToken=function(s){return n.push(s)}}return Fv(t.onComment)&&(t.onComment=_W(t,t.onComment)),t}function _W(i,t){return function(e,n,s,r,o,a){var l={type:e?"Block":"Line",value:n,start:s,end:r};i.locations&&(l.loc=new mp(this,o,a)),i.ranges&&(l.range=[s,r]),t.push(l)}}var nh=1,xl=2,C1=4,VC=8,T1=16,BC=32,Op=64,ZC=128,Ko=256,Zh=512,yp=nh|xl|Ko;function P1(i,t){return xl|(i?C1:0)|(t?VC:0)}var yd=0,A1=1,ur=2,FC=3,WC=4,qC=5,Ge=function(t,e,n){this.options=t=vW(t),this.sourceFile=t.sourceFile,this.keywords=Er(fW[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var s="";t.allowReserved!==!0&&(s=Ag[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(s+=" await")),this.reservedWords=Er(s);var r=(s?s+" ":"")+Ag.strict;this.reservedWordsStrict=Er(r),this.reservedWordsStrictBind=Er(r+" "+Ag.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf(`
`,n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Yi).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=w.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(nh),this.regexpState=null,this.privateNameStack=[]},Rs={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Ge.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};Rs.inFunction.get=function(){return(this.currentVarScope().flags&xl)>0};Rs.inGenerator.get=function(){return(this.currentVarScope().flags&VC)>0};Rs.inAsync.get=function(){return(this.currentVarScope().flags&C1)>0};Rs.canAwait.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var t=this.scopeStack[i],e=t.flags;if(e&(Ko|Zh))return!1;if(e&xl)return(e&C1)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};Rs.allowSuper.get=function(){var i=this.currentThisScope(),t=i.flags;return(t&Op)>0||this.options.allowSuperOutsideMethod};Rs.allowDirectSuper.get=function(){return(this.currentThisScope().flags&ZC)>0};Rs.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};Rs.allowNewDotTarget.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var t=this.scopeStack[i],e=t.flags;if(e&(Ko|Zh)||e&xl&&!(e&T1))return!0}return!1};Rs.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Ko)>0};Ge.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,s=0;s<t.length;s++)n=t[s](n);return n};Ge.parse=function(t,e){return new this(e,t).parse()};Ge.parseExpressionAt=function(t,e,n){var s=new this(n,t,e);return s.nextToken(),s.parseExpression()};Ge.tokenizer=function(t,e){return new this(e,t)};Object.defineProperties(Ge.prototype,Rs);var Ri=Ge.prototype,xW=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Ri.strictDirective=function(i){if(this.options.ecmaVersion<5)return!1;for(;;){ui.lastIndex=i,i+=ui.exec(this.input)[0].length;var t=xW.exec(this.input.slice(i));if(!t)return!1;if((t[1]||t[2])==="use strict"){ui.lastIndex=i+t[0].length;var e=ui.exec(this.input),n=e.index+e[0].length,s=this.input.charAt(n);return s===";"||s==="}"||Yi.test(e[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(s)||s==="!"&&this.input.charAt(n+1)==="=")}i+=t[0].length,ui.lastIndex=i,i+=ui.exec(this.input)[0].length,this.input[i]===";"&&i++}};Ri.eat=function(i){return this.type===i?(this.next(),!0):!1};Ri.isContextual=function(i){return this.type===w.name&&this.value===i&&!this.containsEsc};Ri.eatContextual=function(i){return this.isContextual(i)?(this.next(),!0):!1};Ri.expectContextual=function(i){this.eatContextual(i)||this.unexpected()};Ri.canInsertSemicolon=function(){return this.type===w.eof||this.type===w.braceR||Yi.test(this.input.slice(this.lastTokEnd,this.start))};Ri.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Ri.semicolon=function(){!this.eat(w.semi)&&!this.insertSemicolon()&&this.unexpected()};Ri.afterTrailingComma=function(i,t){if(this.type===i)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};Ri.expect=function(i){this.eat(i)||this.unexpected()};Ri.unexpected=function(i){this.raise(i??this.start,"Unexpected token")};var bp=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Ri.checkPatternErrors=function(i,t){if(i){i.trailingComma>-1&&this.raiseRecoverable(i.trailingComma,"Comma is not permitted after the rest element");var e=t?i.parenthesizedAssign:i.parenthesizedBind;e>-1&&this.raiseRecoverable(e,t?"Assigning to rvalue":"Parenthesized pattern")}};Ri.checkExpressionErrors=function(i,t){if(!i)return!1;var e=i.shorthandAssign,n=i.doubleProto;if(!t)return e>=0||n>=0;e>=0&&this.raise(e,"Shorthand property assignments are valid only in destructuring patterns"),n>=0&&this.raiseRecoverable(n,"Redefinition of __proto__ property")};Ri.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Ri.isSimpleAssignTarget=function(i){return i.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(i.expression):i.type==="Identifier"||i.type==="MemberExpression"};var gt=Ge.prototype;gt.parseTopLevel=function(i){var t=Object.create(null);for(i.body||(i.body=[]);this.type!==w.eof;){var e=this.parseStatement(null,!0,t);i.body.push(e)}if(this.inModule)for(var n=0,s=Object.keys(this.undefinedExports);n<s.length;n+=1){var r=s[n];this.raiseRecoverable(this.undefinedExports[r].start,"Export '"+r+"' is not defined")}return this.adaptDirectivePrologue(i.body),this.next(),i.sourceType=this.options.sourceType,this.finishNode(i,"Program")};var M1={kind:"loop"},SW={kind:"switch"};gt.isLet=function(i){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ui.lastIndex=this.pos;var t=ui.exec(this.input),e=this.pos+t[0].length,n=this.input.charCodeAt(e);if(n===91||n===92)return!0;if(i)return!1;if(n===123||n>55295&&n<56320)return!0;if(ks(n,!0)){for(var s=e+1;jr(n=this.input.charCodeAt(s),!0);)++s;if(n===92||n>55295&&n<56320)return!0;var r=this.input.slice(e,s);if(!dW.test(r))return!0}return!1};gt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ui.lastIndex=this.pos;var i=ui.exec(this.input),t=this.pos+i[0].length,e;return!Yi.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(jr(e=this.input.charCodeAt(t+8))||e>55295&&e<56320))};gt.isUsingKeyword=function(i,t){if(this.options.ecmaVersion<17||!this.isContextual(i?"await":"using"))return!1;ui.lastIndex=this.pos;var e=ui.exec(this.input),n=this.pos+e[0].length;if(Yi.test(this.input.slice(this.pos,n)))return!1;if(i){var s=n+5,r;if(this.input.slice(n,s)!=="using"||s===this.input.length||jr(r=this.input.charCodeAt(s))||r>55295&&r<56320)return!1;ui.lastIndex=s;var o=ui.exec(this.input);if(o&&Yi.test(this.input.slice(s,s+o[0].length)))return!1}if(t){var a=n+2,l;if(this.input.slice(n,a)==="of"&&(a===this.input.length||!jr(l=this.input.charCodeAt(a))&&!(l>55295&&l<56320)))return!1}var c=this.input.charCodeAt(n);return ks(c,!0)||c===92};gt.isAwaitUsing=function(i){return this.isUsingKeyword(!0,i)};gt.isUsing=function(i){return this.isUsingKeyword(!1,i)};gt.parseStatement=function(i,t,e){var n=this.type,s=this.startNode(),r;switch(this.isLet(i)&&(n=w._var,r="let"),n){case w._break:case w._continue:return this.parseBreakContinueStatement(s,n.keyword);case w._debugger:return this.parseDebuggerStatement(s);case w._do:return this.parseDoStatement(s);case w._for:return this.parseForStatement(s);case w._function:return i&&(this.strict||i!=="if"&&i!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!i);case w._class:return i&&this.unexpected(),this.parseClass(s,!0);case w._if:return this.parseIfStatement(s);case w._return:return this.parseReturnStatement(s);case w._switch:return this.parseSwitchStatement(s);case w._throw:return this.parseThrowStatement(s);case w._try:return this.parseTryStatement(s);case w._const:case w._var:return r=r||this.value,i&&r!=="var"&&this.unexpected(),this.parseVarStatement(s,r);case w._while:return this.parseWhileStatement(s);case w._with:return this.parseWithStatement(s);case w.braceL:return this.parseBlock(!0,s);case w.semi:return this.parseEmptyStatement(s);case w._export:case w._import:if(this.options.ecmaVersion>10&&n===w._import){ui.lastIndex=this.pos;var o=ui.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(l===40||l===46)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),n===w._import?this.parseImport(s):this.parseExport(s,e);default:if(this.isAsyncFunction())return i&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!i);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),c==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(s,!1,c),this.semicolon(),this.finishNode(s,"VariableDeclaration");var h=this.value,u=this.parseExpression();return n===w.name&&u.type==="Identifier"&&this.eat(w.colon)?this.parseLabeledStatement(s,h,u,i):this.parseExpressionStatement(s,u)}};gt.parseBreakContinueStatement=function(i,t){var e=t==="break";this.next(),this.eat(w.semi)||this.insertSemicolon()?i.label=null:this.type!==w.name?this.unexpected():(i.label=this.parseIdent(),this.semicolon());for(var n=0;n<this.labels.length;++n){var s=this.labels[n];if((i.label==null||s.name===i.label.name)&&(s.kind!=null&&(e||s.kind==="loop")||i.label&&e))break}return n===this.labels.length&&this.raise(i.start,"Unsyntactic "+t),this.finishNode(i,e?"BreakStatement":"ContinueStatement")};gt.parseDebuggerStatement=function(i){return this.next(),this.semicolon(),this.finishNode(i,"DebuggerStatement")};gt.parseDoStatement=function(i){return this.next(),this.labels.push(M1),i.body=this.parseStatement("do"),this.labels.pop(),this.expect(w._while),i.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(w.semi):this.semicolon(),this.finishNode(i,"DoWhileStatement")};gt.parseForStatement=function(i){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(M1),this.enterScope(0),this.expect(w.parenL),this.type===w.semi)return t>-1&&this.unexpected(t),this.parseFor(i,null);var e=this.isLet();if(this.type===w._var||this.type===w._const||e){var n=this.startNode(),s=e?"let":this.value;return this.next(),this.parseVar(n,!0,s),this.finishNode(n,"VariableDeclaration"),this.parseForAfterInit(i,n,t)}var r=this.isContextual("let"),o=!1,a=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(a){var l=this.startNode();return this.next(),a==="await using"&&this.next(),this.parseVar(l,!0,a),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(i,l,t)}var c=this.containsEsc,h=new bp,u=this.start,f=t>-1?this.parseExprSubscripts(h,"await"):this.parseExpression(!0,h);return this.type===w._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===w._in&&this.unexpected(t),i.await=!0):o&&this.options.ecmaVersion>=8&&(f.start===u&&!c&&f.type==="Identifier"&&f.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(i.await=!1)),r&&o&&this.raise(f.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(f,!1,h),this.checkLValPattern(f),this.parseForIn(i,f)):(this.checkExpressionErrors(h,!0),t>-1&&this.unexpected(t),this.parseFor(i,f))};gt.parseForAfterInit=function(i,t,e){return(this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===w._in?e>-1&&this.unexpected(e):i.await=e>-1),this.parseForIn(i,t)):(e>-1&&this.unexpected(e),this.parseFor(i,t))};gt.parseFunctionStatement=function(i,t,e){return this.next(),this.parseFunction(i,Pc|(e?0:w0),!1,t)};gt.parseIfStatement=function(i){return this.next(),i.test=this.parseParenExpression(),i.consequent=this.parseStatement("if"),i.alternate=this.eat(w._else)?this.parseStatement("if"):null,this.finishNode(i,"IfStatement")};gt.parseReturnStatement=function(i){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(w.semi)||this.insertSemicolon()?i.argument=null:(i.argument=this.parseExpression(),this.semicolon()),this.finishNode(i,"ReturnStatement")};gt.parseSwitchStatement=function(i){this.next(),i.discriminant=this.parseParenExpression(),i.cases=[],this.expect(w.braceL),this.labels.push(SW),this.enterScope(0);for(var t,e=!1;this.type!==w.braceR;)if(this.type===w._case||this.type===w._default){var n=this.type===w._case;t&&this.finishNode(t,"SwitchCase"),i.cases.push(t=this.startNode()),t.consequent=[],this.next(),n?t.test=this.parseExpression():(e&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),e=!0,t.test=null),this.expect(w.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(i,"SwitchStatement")};gt.parseThrowStatement=function(i){return this.next(),Yi.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),i.argument=this.parseExpression(),this.semicolon(),this.finishNode(i,"ThrowStatement")};var wW=[];gt.parseCatchClauseParam=function(){var i=this.parseBindingAtom(),t=i.type==="Identifier";return this.enterScope(t?BC:0),this.checkLValPattern(i,t?WC:ur),this.expect(w.parenR),i};gt.parseTryStatement=function(i){if(this.next(),i.block=this.parseBlock(),i.handler=null,this.type===w._catch){var t=this.startNode();this.next(),this.eat(w.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),i.handler=this.finishNode(t,"CatchClause")}return i.finalizer=this.eat(w._finally)?this.parseBlock():null,!i.handler&&!i.finalizer&&this.raise(i.start,"Missing catch or finally clause"),this.finishNode(i,"TryStatement")};gt.parseVarStatement=function(i,t,e){return this.next(),this.parseVar(i,!1,t,e),this.semicolon(),this.finishNode(i,"VariableDeclaration")};gt.parseWhileStatement=function(i){return this.next(),i.test=this.parseParenExpression(),this.labels.push(M1),i.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(i,"WhileStatement")};gt.parseWithStatement=function(i){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),i.object=this.parseParenExpression(),i.body=this.parseStatement("with"),this.finishNode(i,"WithStatement")};gt.parseEmptyStatement=function(i){return this.next(),this.finishNode(i,"EmptyStatement")};gt.parseLabeledStatement=function(i,t,e,n){for(var s=0,r=this.labels;s<r.length;s+=1){var o=r[s];o.name===t&&this.raise(e.start,"Label '"+t+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===w._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===i.start)c.statementStart=this.start,c.kind=a;else break}return this.labels.push({name:t,kind:a,statementStart:this.start}),i.body=this.parseStatement(n?n.indexOf("label")===-1?n+"label":n:"label"),this.labels.pop(),i.label=e,this.finishNode(i,"LabeledStatement")};gt.parseExpressionStatement=function(i,t){return i.expression=t,this.semicolon(),this.finishNode(i,"ExpressionStatement")};gt.parseBlock=function(i,t,e){for(i===void 0&&(i=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(w.braceL),i&&this.enterScope(0);this.type!==w.braceR;){var n=this.parseStatement(null);t.body.push(n)}return e&&(this.strict=!1),this.next(),i&&this.exitScope(),this.finishNode(t,"BlockStatement")};gt.parseFor=function(i,t){return i.init=t,this.expect(w.semi),i.test=this.type===w.semi?null:this.parseExpression(),this.expect(w.semi),i.update=this.type===w.parenR?null:this.parseExpression(),this.expect(w.parenR),i.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(i,"ForStatement")};gt.parseForIn=function(i,t){var e=this.type===w._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!e||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(e?"for-in":"for-of")+" loop variable declaration may not have an initializer"),i.left=t,i.right=e?this.parseExpression():this.parseMaybeAssign(),this.expect(w.parenR),i.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(i,e?"ForInStatement":"ForOfStatement")};gt.parseVar=function(i,t,e,n){for(i.declarations=[],i.kind=e;;){var s=this.startNode();if(this.parseVarId(s,e),this.eat(w.eq)?s.init=this.parseMaybeAssign(t):!n&&e==="const"&&!(this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!n&&(e==="using"||e==="await using")&&this.options.ecmaVersion>=17&&this.type!==w._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+e+" declaration"):!n&&s.id.type!=="Identifier"&&!(t&&(this.type===w._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):s.init=null,i.declarations.push(this.finishNode(s,"VariableDeclarator")),!this.eat(w.comma))break}return i};gt.parseVarId=function(i,t){i.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(i.id,t==="var"?A1:ur,!1)};var Pc=1,w0=2,XC=4;gt.parseFunction=function(i,t,e,n,s){this.initFunction(i),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!n)&&(this.type===w.star&&t&w0&&this.unexpected(),i.generator=this.eat(w.star)),this.options.ecmaVersion>=8&&(i.async=!!n),t&Pc&&(i.id=t&XC&&this.type!==w.name?null:this.parseIdent(),i.id&&!(t&w0)&&this.checkLValSimple(i.id,this.strict||i.generator||i.async?this.treatFunctionsAsVar?A1:ur:FC));var r=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(P1(i.async,i.generator)),t&Pc||(i.id=this.type===w.name?this.parseIdent():null),this.parseFunctionParams(i),this.parseFunctionBody(i,e,!1,s),this.yieldPos=r,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(i,t&Pc?"FunctionDeclaration":"FunctionExpression")};gt.parseFunctionParams=function(i){this.expect(w.parenL),i.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};gt.parseClass=function(i,t){this.next();var e=this.strict;this.strict=!0,this.parseClassId(i,t),this.parseClassSuper(i);var n=this.enterClassBody(),s=this.startNode(),r=!1;for(s.body=[],this.expect(w.braceL);this.type!==w.braceR;){var o=this.parseClassElement(i.superClass!==null);o&&(s.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(r&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),r=!0):o.key&&o.key.type==="PrivateIdentifier"&&kW(n,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=e,this.next(),i.body=this.finishNode(s,"ClassBody"),this.exitClassBody(),this.finishNode(i,t?"ClassDeclaration":"ClassExpression")};gt.parseClassElement=function(i){if(this.eat(w.semi))return null;var t=this.options.ecmaVersion,e=this.startNode(),n="",s=!1,r=!1,o="method",a=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(w.braceL))return this.parseClassStaticBlock(e),e;this.isClassElementNameStart()||this.type===w.star?a=!0:n="static"}if(e.static=a,!n&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===w.star)&&!this.canInsertSemicolon()?r=!0:n="async"),!n&&(t>=9||!r)&&this.eat(w.star)&&(s=!0),!n&&!r&&!s){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:n=l)}if(n?(e.computed=!1,e.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),e.key.name=n,this.finishNode(e.key,"Identifier")):this.parseClassElementName(e),t<13||this.type===w.parenL||o!=="method"||s||r){var c=!e.static&&bd(e,"constructor"),h=c&&i;c&&o!=="method"&&this.raise(e.key.start,"Constructor can't have get/set modifier"),e.kind=c?"constructor":o,this.parseClassMethod(e,s,r,h)}else this.parseClassField(e);return e};gt.isClassElementNameStart=function(){return this.type===w.name||this.type===w.privateId||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword};gt.parseClassElementName=function(i){this.type===w.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),i.computed=!1,i.key=this.parsePrivateIdent()):this.parsePropertyName(i)};gt.parseClassMethod=function(i,t,e,n){var s=i.key;i.kind==="constructor"?(t&&this.raise(s.start,"Constructor can't be a generator"),e&&this.raise(s.start,"Constructor can't be an async method")):i.static&&bd(i,"prototype")&&this.raise(s.start,"Classes may not have a static property named prototype");var r=i.value=this.parseMethod(t,e,n);return i.kind==="get"&&r.params.length!==0&&this.raiseRecoverable(r.start,"getter should have no params"),i.kind==="set"&&r.params.length!==1&&this.raiseRecoverable(r.start,"setter should have exactly one param"),i.kind==="set"&&r.params[0].type==="RestElement"&&this.raiseRecoverable(r.params[0].start,"Setter cannot use rest params"),this.finishNode(i,"MethodDefinition")};gt.parseClassField=function(i){return bd(i,"constructor")?this.raise(i.key.start,"Classes can't have a field named 'constructor'"):i.static&&bd(i,"prototype")&&this.raise(i.key.start,"Classes can't have a static field named 'prototype'"),this.eat(w.eq)?(this.enterScope(Zh|Op),i.value=this.parseMaybeAssign(),this.exitScope()):i.value=null,this.semicolon(),this.finishNode(i,"PropertyDefinition")};gt.parseClassStaticBlock=function(i){i.body=[];var t=this.labels;for(this.labels=[],this.enterScope(Ko|Op);this.type!==w.braceR;){var e=this.parseStatement(null);i.body.push(e)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(i,"StaticBlock")};gt.parseClassId=function(i,t){this.type===w.name?(i.id=this.parseIdent(),t&&this.checkLValSimple(i.id,ur,!1)):(t===!0&&this.unexpected(),i.id=null)};gt.parseClassSuper=function(i){i.superClass=this.eat(w._extends)?this.parseExprSubscripts(null,!1):null};gt.enterClassBody=function(){var i={declared:Object.create(null),used:[]};return this.privateNameStack.push(i),i.declared};gt.exitClassBody=function(){var i=this.privateNameStack.pop(),t=i.declared,e=i.used;if(this.options.checkPrivateFields)for(var n=this.privateNameStack.length,s=n===0?null:this.privateNameStack[n-1],r=0;r<e.length;++r){var o=e[r];_l(t,o.name)||(s?s.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function kW(i,t){var e=t.key.name,n=i[e],s="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(s=(t.static?"s":"i")+t.kind),n==="iget"&&s==="iset"||n==="iset"&&s==="iget"||n==="sget"&&s==="sset"||n==="sset"&&s==="sget"?(i[e]="true",!1):n?!0:(i[e]=s,!1)}function bd(i,t){var e=i.computed,n=i.key;return!e&&(n.type==="Identifier"&&n.name===t||n.type==="Literal"&&n.value===t)}gt.parseExportAllDeclaration=function(i,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(i.exported=this.parseModuleExportName(),this.checkExport(t,i.exported,this.lastTokStart)):i.exported=null),this.expectContextual("from"),this.type!==w.string&&this.unexpected(),i.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(i,"ExportAllDeclaration")};gt.parseExport=function(i,t){if(this.next(),this.eat(w.star))return this.parseExportAllDeclaration(i,t);if(this.eat(w._default))return this.checkExport(t,"default",this.lastTokStart),i.declaration=this.parseExportDefaultDeclaration(),this.finishNode(i,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())i.declaration=this.parseExportDeclaration(i),i.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,i.declaration.declarations):this.checkExport(t,i.declaration.id,i.declaration.id.start),i.specifiers=[],i.source=null,this.options.ecmaVersion>=16&&(i.attributes=[]);else{if(i.declaration=null,i.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==w.string&&this.unexpected(),i.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause());else{for(var e=0,n=i.specifiers;e<n.length;e+=1){var s=n[e];this.checkUnreserved(s.local),this.checkLocalExport(s.local),s.local.type==="Literal"&&this.raise(s.local.start,"A string literal cannot be used as an exported binding without `from`.")}i.source=null,this.options.ecmaVersion>=16&&(i.attributes=[])}this.semicolon()}return this.finishNode(i,"ExportNamedDeclaration")};gt.parseExportDeclaration=function(i){return this.parseStatement(null)};gt.parseExportDefaultDeclaration=function(){var i;if(this.type===w._function||(i=this.isAsyncFunction())){var t=this.startNode();return this.next(),i&&this.next(),this.parseFunction(t,Pc|XC,!1,i)}else if(this.type===w._class){var e=this.startNode();return this.parseClass(e,"nullableID")}else{var n=this.parseMaybeAssign();return this.semicolon(),n}};gt.checkExport=function(i,t,e){i&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),_l(i,t)&&this.raiseRecoverable(e,"Duplicate export '"+t+"'"),i[t]=!0)};gt.checkPatternExport=function(i,t){var e=t.type;if(e==="Identifier")this.checkExport(i,t,t.start);else if(e==="ObjectPattern")for(var n=0,s=t.properties;n<s.length;n+=1){var r=s[n];this.checkPatternExport(i,r)}else if(e==="ArrayPattern")for(var o=0,a=t.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(i,l)}else e==="Property"?this.checkPatternExport(i,t.value):e==="AssignmentPattern"?this.checkPatternExport(i,t.left):e==="RestElement"&&this.checkPatternExport(i,t.argument)};gt.checkVariableExport=function(i,t){if(i)for(var e=0,n=t;e<n.length;e+=1){var s=n[e];this.checkPatternExport(i,s.id)}};gt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};gt.parseExportSpecifier=function(i){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(i,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};gt.parseExportSpecifiers=function(i){var t=[],e=!0;for(this.expect(w.braceL);!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;t.push(this.parseExportSpecifier(i))}return t};gt.parseImport=function(i){return this.next(),this.type===w.string?(i.specifiers=wW,i.source=this.parseExprAtom()):(i.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),i.source=this.type===w.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(i,"ImportDeclaration")};gt.parseImportSpecifier=function(){var i=this.startNode();return i.imported=this.parseModuleExportName(),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLValSimple(i.local,ur),this.finishNode(i,"ImportSpecifier")};gt.parseImportDefaultSpecifier=function(){var i=this.startNode();return i.local=this.parseIdent(),this.checkLValSimple(i.local,ur),this.finishNode(i,"ImportDefaultSpecifier")};gt.parseImportNamespaceSpecifier=function(){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLValSimple(i.local,ur),this.finishNode(i,"ImportNamespaceSpecifier")};gt.parseImportSpecifiers=function(){var i=[],t=!0;if(this.type===w.name&&(i.push(this.parseImportDefaultSpecifier()),!this.eat(w.comma)))return i;if(this.type===w.star)return i.push(this.parseImportNamespaceSpecifier()),i;for(this.expect(w.braceL);!this.eat(w.braceR);){if(t)t=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;i.push(this.parseImportSpecifier())}return i};gt.parseWithClause=function(){var i=[];if(!this.eat(w._with))return i;this.expect(w.braceL);for(var t={},e=!0;!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var n=this.parseImportAttribute(),s=n.key.type==="Identifier"?n.key.name:n.key.value;_l(t,s)&&this.raiseRecoverable(n.key.start,"Duplicate attribute key '"+s+"'"),t[s]=!0,i.push(n)}return i};gt.parseImportAttribute=function(){var i=this.startNode();return i.key=this.type===w.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(w.colon),this.type!==w.string&&this.unexpected(),i.value=this.parseExprAtom(),this.finishNode(i,"ImportAttribute")};gt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===w.string){var i=this.parseLiteral(this.value);return bW.test(i.value)&&this.raise(i.start,"An export name cannot include a lone surrogate."),i}return this.parseIdent(!0)};gt.adaptDirectivePrologue=function(i){for(var t=0;t<i.length&&this.isDirectiveCandidate(i[t]);++t)i[t].directive=i[t].expression.raw.slice(1,-1)};gt.isDirectiveCandidate=function(i){return this.options.ecmaVersion>=5&&i.type==="ExpressionStatement"&&i.expression.type==="Literal"&&typeof i.expression.value=="string"&&(this.input[i.start]==='"'||this.input[i.start]==="'")};var En=Ge.prototype;En.toAssignable=function(i,t,e){if(this.options.ecmaVersion>=6&&i)switch(i.type){case"Identifier":this.inAsync&&i.name==="await"&&this.raise(i.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":i.type="ObjectPattern",e&&this.checkPatternErrors(e,!0);for(var n=0,s=i.properties;n<s.length;n+=1){var r=s[n];this.toAssignable(r,t),r.type==="RestElement"&&(r.argument.type==="ArrayPattern"||r.argument.type==="ObjectPattern")&&this.raise(r.argument.start,"Unexpected token")}break;case"Property":i.kind!=="init"&&this.raise(i.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(i.value,t);break;case"ArrayExpression":i.type="ArrayPattern",e&&this.checkPatternErrors(e,!0),this.toAssignableList(i.elements,t);break;case"SpreadElement":i.type="RestElement",this.toAssignable(i.argument,t),i.argument.type==="AssignmentPattern"&&this.raise(i.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":i.operator!=="="&&this.raise(i.left.end,"Only '=' operator can be used for specifying default value."),i.type="AssignmentPattern",delete i.operator,this.toAssignable(i.left,t);break;case"ParenthesizedExpression":this.toAssignable(i.expression,t,e);break;case"ChainExpression":this.raiseRecoverable(i.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(i.start,"Assigning to rvalue")}else e&&this.checkPatternErrors(e,!0);return i};En.toAssignableList=function(i,t){for(var e=i.length,n=0;n<e;n++){var s=i[n];s&&this.toAssignable(s,t)}if(e){var r=i[e-1];this.options.ecmaVersion===6&&t&&r&&r.type==="RestElement"&&r.argument.type!=="Identifier"&&this.unexpected(r.argument.start)}return i};En.parseSpread=function(i){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,i),this.finishNode(t,"SpreadElement")};En.parseRestBinding=function(){var i=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==w.name&&this.unexpected(),i.argument=this.parseBindingAtom(),this.finishNode(i,"RestElement")};En.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case w.bracketL:var i=this.startNode();return this.next(),i.elements=this.parseBindingList(w.bracketR,!0,!0),this.finishNode(i,"ArrayPattern");case w.braceL:return this.parseObj(!0)}return this.parseIdent()};En.parseBindingList=function(i,t,e,n){for(var s=[],r=!0;!this.eat(i);)if(r?r=!1:this.expect(w.comma),t&&this.type===w.comma)s.push(null);else{if(e&&this.afterTrailingComma(i))break;if(this.type===w.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),s.push(o),this.type===w.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(i);break}else s.push(this.parseAssignableListItem(n))}return s};En.parseAssignableListItem=function(i){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};En.parseBindingListItem=function(i){return i};En.parseMaybeDefault=function(i,t,e){if(e=e||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(w.eq))return e;var n=this.startNodeAt(i,t);return n.left=e,n.right=this.parseMaybeAssign(),this.finishNode(n,"AssignmentPattern")};En.checkLValSimple=function(i,t,e){t===void 0&&(t=yd);var n=t!==yd;switch(i.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(i.name)&&this.raiseRecoverable(i.start,(n?"Binding ":"Assigning to ")+i.name+" in strict mode"),n&&(t===ur&&i.name==="let"&&this.raiseRecoverable(i.start,"let is disallowed as a lexically bound name"),e&&(_l(e,i.name)&&this.raiseRecoverable(i.start,"Argument name clash"),e[i.name]=!0),t!==qC&&this.declareName(i.name,t,i.start));break;case"ChainExpression":this.raiseRecoverable(i.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":n&&this.raiseRecoverable(i.start,"Binding member expression");break;case"ParenthesizedExpression":return n&&this.raiseRecoverable(i.start,"Binding parenthesized expression"),this.checkLValSimple(i.expression,t,e);default:this.raise(i.start,(n?"Binding":"Assigning to")+" rvalue")}};En.checkLValPattern=function(i,t,e){switch(t===void 0&&(t=yd),i.type){case"ObjectPattern":for(var n=0,s=i.properties;n<s.length;n+=1){var r=s[n];this.checkLValInnerPattern(r,t,e)}break;case"ArrayPattern":for(var o=0,a=i.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLValInnerPattern(l,t,e)}break;default:this.checkLValSimple(i,t,e)}};En.checkLValInnerPattern=function(i,t,e){switch(t===void 0&&(t=yd),i.type){case"Property":this.checkLValInnerPattern(i.value,t,e);break;case"AssignmentPattern":this.checkLValPattern(i.left,t,e);break;case"RestElement":this.checkLValPattern(i.argument,t,e);break;default:this.checkLValPattern(i,t,e)}};var Rn=function(t,e,n,s,r){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=s,this.generator=!!r},ve={b_stat:new Rn("{",!1),b_expr:new Rn("{",!0),b_tmpl:new Rn("${",!1),p_stat:new Rn("(",!1),p_expr:new Rn("(",!0),q_tmpl:new Rn("`",!0,!0,function(i){return i.tryReadTemplateToken()}),f_stat:new Rn("function",!1),f_expr:new Rn("function",!0),f_expr_gen:new Rn("function",!0,!1,null,!0),f_gen:new Rn("function",!1,!1,null,!0)},Sl=Ge.prototype;Sl.initialContext=function(){return[ve.b_stat]};Sl.curContext=function(){return this.context[this.context.length-1]};Sl.braceIsBlock=function(i){var t=this.curContext();return t===ve.f_expr||t===ve.f_stat?!0:i===w.colon&&(t===ve.b_stat||t===ve.b_expr)?!t.isExpr:i===w._return||i===w.name&&this.exprAllowed?Yi.test(this.input.slice(this.lastTokEnd,this.start)):i===w._else||i===w.semi||i===w.eof||i===w.parenR||i===w.arrow?!0:i===w.braceL?t===ve.b_stat:i===w._var||i===w._const||i===w.name?!1:!this.exprAllowed};Sl.inGeneratorContext=function(){for(var i=this.context.length-1;i>=1;i--){var t=this.context[i];if(t.token==="function")return t.generator}return!1};Sl.updateContext=function(i){var t,e=this.type;e.keyword&&i===w.dot?this.exprAllowed=!1:(t=e.updateContext)?t.call(this,i):this.exprAllowed=e.beforeExpr};Sl.overrideContext=function(i){this.curContext()!==i&&(this.context[this.context.length-1]=i)};w.parenR.updateContext=w.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var i=this.context.pop();i===ve.b_stat&&this.curContext().token==="function"&&(i=this.context.pop()),this.exprAllowed=!i.isExpr};w.braceL.updateContext=function(i){this.context.push(this.braceIsBlock(i)?ve.b_stat:ve.b_expr),this.exprAllowed=!0};w.dollarBraceL.updateContext=function(){this.context.push(ve.b_tmpl),this.exprAllowed=!0};w.parenL.updateContext=function(i){var t=i===w._if||i===w._for||i===w._with||i===w._while;this.context.push(t?ve.p_stat:ve.p_expr),this.exprAllowed=!0};w.incDec.updateContext=function(){};w._function.updateContext=w._class.updateContext=function(i){i.beforeExpr&&i!==w._else&&!(i===w.semi&&this.curContext()!==ve.p_stat)&&!(i===w._return&&Yi.test(this.input.slice(this.lastTokEnd,this.start)))&&!((i===w.colon||i===w.braceL)&&this.curContext()===ve.b_stat)?this.context.push(ve.f_expr):this.context.push(ve.f_stat),this.exprAllowed=!1};w.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};w.backQuote.updateContext=function(){this.curContext()===ve.q_tmpl?this.context.pop():this.context.push(ve.q_tmpl),this.exprAllowed=!1};w.star.updateContext=function(i){if(i===w._function){var t=this.context.length-1;this.context[t]===ve.f_expr?this.context[t]=ve.f_expr_gen:this.context[t]=ve.f_gen}this.exprAllowed=!0};w.name.updateContext=function(i){var t=!1;this.options.ecmaVersion>=6&&i!==w.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var kt=Ge.prototype;kt.checkPropClash=function(i,t,e){if(!(this.options.ecmaVersion>=9&&i.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(i.computed||i.method||i.shorthand))){var n=i.key,s;switch(n.type){case"Identifier":s=n.name;break;case"Literal":s=String(n.value);break;default:return}var r=i.kind;if(this.options.ecmaVersion>=6){s==="__proto__"&&r==="init"&&(t.proto&&(e?e.doubleProto<0&&(e.doubleProto=n.start):this.raiseRecoverable(n.start,"Redefinition of __proto__ property")),t.proto=!0);return}s="$"+s;var o=t[s];if(o){var a;r==="init"?a=this.strict&&o.init||o.get||o.set:a=o.init||o[r],a&&this.raiseRecoverable(n.start,"Redefinition of property")}else o=t[s]={init:!1,get:!1,set:!1};o[r]=!0}};kt.parseExpression=function(i,t){var e=this.start,n=this.startLoc,s=this.parseMaybeAssign(i,t);if(this.type===w.comma){var r=this.startNodeAt(e,n);for(r.expressions=[s];this.eat(w.comma);)r.expressions.push(this.parseMaybeAssign(i,t));return this.finishNode(r,"SequenceExpression")}return s};kt.parseMaybeAssign=function(i,t,e){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(i);this.exprAllowed=!1}var n=!1,s=-1,r=-1,o=-1;t?(s=t.parenthesizedAssign,r=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new bp,n=!0);var a=this.start,l=this.startLoc;(this.type===w.parenL||this.type===w.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=i==="await");var c=this.parseMaybeConditional(i,t);if(e&&(c=e.call(this,c,a,l)),this.type.isAssign){var h=this.startNodeAt(a,l);return h.operator=this.value,this.type===w.eq&&(c=this.toAssignable(c,!1,t)),n||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.start&&(t.shorthandAssign=-1),this.type===w.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(i),o>-1&&(t.doubleProto=o),this.finishNode(h,"AssignmentExpression")}else n&&this.checkExpressionErrors(t,!0);return s>-1&&(t.parenthesizedAssign=s),r>-1&&(t.trailingComma=r),c};kt.parseMaybeConditional=function(i,t){var e=this.start,n=this.startLoc,s=this.parseExprOps(i,t);if(this.checkExpressionErrors(t))return s;if(this.eat(w.question)){var r=this.startNodeAt(e,n);return r.test=s,r.consequent=this.parseMaybeAssign(),this.expect(w.colon),r.alternate=this.parseMaybeAssign(i),this.finishNode(r,"ConditionalExpression")}return s};kt.parseExprOps=function(i,t){var e=this.start,n=this.startLoc,s=this.parseMaybeUnary(t,!1,!1,i);return this.checkExpressionErrors(t)||s.start===e&&s.type==="ArrowFunctionExpression"?s:this.parseExprOp(s,e,n,-1,i)};kt.parseExprOp=function(i,t,e,n,s){var r=this.type.binop;if(r!=null&&(!s||this.type!==w._in)&&r>n){var o=this.type===w.logicalOR||this.type===w.logicalAND,a=this.type===w.coalesce;a&&(r=w.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,s),c,h,r,s),f=this.buildBinary(t,e,i,u,l,o||a);return(o&&this.type===w.coalesce||a&&(this.type===w.logicalOR||this.type===w.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(f,t,e,n,s)}return i};kt.buildBinary=function(i,t,e,n,s,r){n.type==="PrivateIdentifier"&&this.raise(n.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(i,t);return o.left=e,o.operator=s,o.right=n,this.finishNode(o,r?"LogicalExpression":"BinaryExpression")};kt.parseMaybeUnary=function(i,t,e,n){var s=this.start,r=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(n),t=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===w.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,n),this.checkExpressionErrors(i,!0),l?this.checkLValSimple(a.argument):this.strict&&a.operator==="delete"&&zC(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):a.operator==="delete"&&k0(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===w.privateId)(n||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==w._in&&this.unexpected();else{if(o=this.parseExprSubscripts(i,n),this.checkExpressionErrors(i))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(s,r);c.operator=this.value,c.prefix=!1,c.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(c,"UpdateExpression")}}if(!e&&this.eat(w.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(s,r,o,this.parseMaybeUnary(null,!1,!1,n),"**",!1);else return o};function zC(i){return i.type==="Identifier"||i.type==="ParenthesizedExpression"&&zC(i.expression)}function k0(i){return i.type==="MemberExpression"&&i.property.type==="PrivateIdentifier"||i.type==="ChainExpression"&&k0(i.expression)||i.type==="ParenthesizedExpression"&&k0(i.expression)}kt.parseExprSubscripts=function(i,t){var e=this.start,n=this.startLoc,s=this.parseExprAtom(i,t);if(s.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return s;var r=this.parseSubscripts(s,e,n,!1,t);return i&&r.type==="MemberExpression"&&(i.parenthesizedAssign>=r.start&&(i.parenthesizedAssign=-1),i.parenthesizedBind>=r.start&&(i.parenthesizedBind=-1),i.trailingComma>=r.start&&(i.trailingComma=-1)),r};kt.parseSubscripts=function(i,t,e,n,s){for(var r=this.options.ecmaVersion>=8&&i.type==="Identifier"&&i.name==="async"&&this.lastTokEnd===i.end&&!this.canInsertSemicolon()&&i.end-i.start===5&&this.potentialArrowAt===i.start,o=!1;;){var a=this.parseSubscript(i,t,e,n,r,o,s);if(a.optional&&(o=!0),a===i||a.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(t,e);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}i=a}};kt.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(w.arrow)};kt.parseSubscriptAsyncArrow=function(i,t,e,n){return this.parseArrowExpression(this.startNodeAt(i,t),e,!0,n)};kt.parseSubscript=function(i,t,e,n,s,r,o){var a=this.options.ecmaVersion>=11,l=a&&this.eat(w.questionDot);n&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(w.bracketL);if(c||l&&this.type!==w.parenL&&this.type!==w.backQuote||this.eat(w.dot)){var h=this.startNodeAt(t,e);h.object=i,c?(h.property=this.parseExpression(),this.expect(w.bracketR)):this.type===w.privateId&&i.type!=="Super"?h.property=this.parsePrivateIdent():h.property=this.parseIdent(this.options.allowReserved!=="never"),h.computed=!!c,a&&(h.optional=l),i=this.finishNode(h,"MemberExpression")}else if(!n&&this.eat(w.parenL)){var u=new bp,f=this.yieldPos,d=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var g=this.parseExprList(w.parenR,this.options.ecmaVersion>=8,!1,u);if(s&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=f,this.awaitPos=d,this.awaitIdentPos=p,this.parseSubscriptAsyncArrow(t,e,g,o);this.checkExpressionErrors(u,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=d||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var m=this.startNodeAt(t,e);m.callee=i,m.arguments=g,a&&(m.optional=l),i=this.finishNode(m,"CallExpression")}else if(this.type===w.backQuote){(l||r)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var O=this.startNodeAt(t,e);O.tag=i,O.quasi=this.parseTemplate({isTagged:!0}),i=this.finishNode(O,"TaggedTemplateExpression")}return i};kt.parseExprAtom=function(i,t,e){this.type===w.slash&&this.readRegexp();var n,s=this.potentialArrowAt===this.start;switch(this.type){case w._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),n=this.startNode(),this.next(),this.type===w.parenL&&!this.allowDirectSuper&&this.raise(n.start,"super() call outside constructor of a subclass"),this.type!==w.dot&&this.type!==w.bracketL&&this.type!==w.parenL&&this.unexpected(),this.finishNode(n,"Super");case w._this:return n=this.startNode(),this.next(),this.finishNode(n,"ThisExpression");case w.name:var r=this.start,o=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(w._function))return this.overrideContext(ve.f_expr),this.parseFunction(this.startNodeAt(r,o),0,!1,!0,t);if(s&&!this.canInsertSemicolon()){if(this.eat(w.arrow))return this.parseArrowExpression(this.startNodeAt(r,o),[l],!1,t);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===w.name&&!a&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(w.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,o),[l],!0,t)}return l;case w.regexp:var c=this.value;return n=this.parseLiteral(c.value),n.regex={pattern:c.pattern,flags:c.flags},n;case w.num:case w.string:return this.parseLiteral(this.value);case w._null:case w._true:case w._false:return n=this.startNode(),n.value=this.type===w._null?null:this.type===w._true,n.raw=this.type.keyword,this.next(),this.finishNode(n,"Literal");case w.parenL:var h=this.start,u=this.parseParenAndDistinguishExpression(s,t);return i&&(i.parenthesizedAssign<0&&!this.isSimpleAssignTarget(u)&&(i.parenthesizedAssign=h),i.parenthesizedBind<0&&(i.parenthesizedBind=h)),u;case w.bracketL:return n=this.startNode(),this.next(),n.elements=this.parseExprList(w.bracketR,!0,!0,i),this.finishNode(n,"ArrayExpression");case w.braceL:return this.overrideContext(ve.b_expr),this.parseObj(!1,i);case w._function:return n=this.startNode(),this.next(),this.parseFunction(n,0);case w._class:return this.parseClass(this.startNode(),!1);case w._new:return this.parseNew();case w.backQuote:return this.parseTemplate();case w._import:return this.options.ecmaVersion>=11?this.parseExprImport(e):this.unexpected();default:return this.parseExprAtomDefault()}};kt.parseExprAtomDefault=function(){this.unexpected()};kt.parseExprImport=function(i){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===w.parenL&&!i)return this.parseDynamicImport(t);if(this.type===w.dot){var e=this.startNodeAt(t.start,t.loc&&t.loc.start);return e.name="import",t.meta=this.finishNode(e,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};kt.parseDynamicImport=function(i){if(this.next(),i.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(w.parenR)?i.options=null:(this.expect(w.comma),this.afterTrailingComma(w.parenR)?i.options=null:(i.options=this.parseMaybeAssign(),this.eat(w.parenR)||(this.expect(w.comma),this.afterTrailingComma(w.parenR)||this.unexpected())));else if(!this.eat(w.parenR)){var t=this.start;this.eat(w.comma)&&this.eat(w.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(i,"ImportExpression")};kt.parseImportMeta=function(i){this.next();var t=this.containsEsc;return i.property=this.parseIdent(!0),i.property.name!=="meta"&&this.raiseRecoverable(i.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(i.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(i.start,"Cannot use 'import.meta' outside a module"),this.finishNode(i,"MetaProperty")};kt.parseLiteral=function(i){var t=this.startNode();return t.value=i,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};kt.parseParenExpression=function(){this.expect(w.parenL);var i=this.parseExpression();return this.expect(w.parenR),i};kt.shouldParseArrow=function(i){return!this.canInsertSemicolon()};kt.parseParenAndDistinguishExpression=function(i,t){var e=this.start,n=this.startLoc,s,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,a=this.startLoc,l=[],c=!0,h=!1,u=new bp,f=this.yieldPos,d=this.awaitPos,p;for(this.yieldPos=0,this.awaitPos=0;this.type!==w.parenR;)if(c?c=!1:this.expect(w.comma),r&&this.afterTrailingComma(w.parenR,!0)){h=!0;break}else if(this.type===w.ellipsis){p=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===w.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,u,this.parseParenItem));var g=this.lastTokEnd,m=this.lastTokEndLoc;if(this.expect(w.parenR),i&&this.shouldParseArrow(l)&&this.eat(w.arrow))return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=f,this.awaitPos=d,this.parseParenArrowList(e,n,l,t);(!l.length||h)&&this.unexpected(this.lastTokStart),p&&this.unexpected(p),this.checkExpressionErrors(u,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=d||this.awaitPos,l.length>1?(s=this.startNodeAt(o,a),s.expressions=l,this.finishNodeAt(s,"SequenceExpression",g,m)):s=l[0]}else s=this.parseParenExpression();if(this.options.preserveParens){var O=this.startNodeAt(e,n);return O.expression=s,this.finishNode(O,"ParenthesizedExpression")}else return s};kt.parseParenItem=function(i){return i};kt.parseParenArrowList=function(i,t,e,n){return this.parseArrowExpression(this.startNodeAt(i,t),e,!1,n)};var CW=[];kt.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var i=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===w.dot){var t=this.startNodeAt(i.start,i.loc&&i.loc.start);t.name="new",i.meta=this.finishNode(t,"Identifier"),this.next();var e=this.containsEsc;return i.property=this.parseIdent(!0),i.property.name!=="target"&&this.raiseRecoverable(i.property.start,"The only valid meta property for new is 'new.target'"),e&&this.raiseRecoverable(i.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(i.start,"'new.target' can only be used in functions and class static block"),this.finishNode(i,"MetaProperty")}var n=this.start,s=this.startLoc;return i.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),n,s,!0,!1),this.eat(w.parenL)?i.arguments=this.parseExprList(w.parenR,this.options.ecmaVersion>=8,!1):i.arguments=CW,this.finishNode(i,"NewExpression")};kt.parseTemplateElement=function(i){var t=i.isTagged,e=this.startNode();return this.type===w.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),e.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):e.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),e.tail=this.type===w.backQuote,this.finishNode(e,"TemplateElement")};kt.parseTemplate=function(i){i===void 0&&(i={});var t=i.isTagged;t===void 0&&(t=!1);var e=this.startNode();this.next(),e.expressions=[];var n=this.parseTemplateElement({isTagged:t});for(e.quasis=[n];!n.tail;)this.type===w.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(w.dollarBraceL),e.expressions.push(this.parseExpression()),this.expect(w.braceR),e.quasis.push(n=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(e,"TemplateLiteral")};kt.isAsyncProp=function(i){return!i.computed&&i.key.type==="Identifier"&&i.key.name==="async"&&(this.type===w.name||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===w.star)&&!Yi.test(this.input.slice(this.lastTokEnd,this.start))};kt.parseObj=function(i,t){var e=this.startNode(),n=!0,s={};for(e.properties=[],this.next();!this.eat(w.braceR);){if(n)n=!1;else if(this.expect(w.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(w.braceR))break;var r=this.parseProperty(i,t);i||this.checkPropClash(r,s,t),e.properties.push(r)}return this.finishNode(e,i?"ObjectPattern":"ObjectExpression")};kt.parseProperty=function(i,t){var e=this.startNode(),n,s,r,o;if(this.options.ecmaVersion>=9&&this.eat(w.ellipsis))return i?(e.argument=this.parseIdent(!1),this.type===w.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(e,"RestElement")):(e.argument=this.parseMaybeAssign(!1,t),this.type===w.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(e,"SpreadElement"));this.options.ecmaVersion>=6&&(e.method=!1,e.shorthand=!1,(i||t)&&(r=this.start,o=this.startLoc),i||(n=this.eat(w.star)));var a=this.containsEsc;return this.parsePropertyName(e),!i&&!a&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(e)?(s=!0,n=this.options.ecmaVersion>=9&&this.eat(w.star),this.parsePropertyName(e)):s=!1,this.parsePropertyValue(e,i,n,s,r,o,t,a),this.finishNode(e,"Property")};kt.parseGetterSetter=function(i){var t=i.key.name;this.parsePropertyName(i),i.value=this.parseMethod(!1),i.kind=t;var e=i.kind==="get"?0:1;if(i.value.params.length!==e){var n=i.value.start;i.kind==="get"?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else i.kind==="set"&&i.value.params[0].type==="RestElement"&&this.raiseRecoverable(i.value.params[0].start,"Setter cannot use rest params")};kt.parsePropertyValue=function(i,t,e,n,s,r,o,a){(e||n)&&this.type===w.colon&&this.unexpected(),this.eat(w.colon)?(i.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),i.kind="init"):this.options.ecmaVersion>=6&&this.type===w.parenL?(t&&this.unexpected(),i.method=!0,i.value=this.parseMethod(e,n),i.kind="init"):!t&&!a&&this.options.ecmaVersion>=5&&!i.computed&&i.key.type==="Identifier"&&(i.key.name==="get"||i.key.name==="set")&&this.type!==w.comma&&this.type!==w.braceR&&this.type!==w.eq?((e||n)&&this.unexpected(),this.parseGetterSetter(i)):this.options.ecmaVersion>=6&&!i.computed&&i.key.type==="Identifier"?((e||n)&&this.unexpected(),this.checkUnreserved(i.key),i.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=s),t?i.value=this.parseMaybeDefault(s,r,this.copyNode(i.key)):this.type===w.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),i.value=this.parseMaybeDefault(s,r,this.copyNode(i.key))):i.value=this.copyNode(i.key),i.kind="init",i.shorthand=!0):this.unexpected()};kt.parsePropertyName=function(i){if(this.options.ecmaVersion>=6){if(this.eat(w.bracketL))return i.computed=!0,i.key=this.parseMaybeAssign(),this.expect(w.bracketR),i.key;i.computed=!1}return i.key=this.type===w.num||this.type===w.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};kt.initFunction=function(i){i.id=null,this.options.ecmaVersion>=6&&(i.generator=i.expression=!1),this.options.ecmaVersion>=8&&(i.async=!1)};kt.parseMethod=function(i,t,e){var n=this.startNode(),s=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(n),this.options.ecmaVersion>=6&&(n.generator=i),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(P1(t,n.generator)|Op|(e?ZC:0)),this.expect(w.parenL),n.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1,!0,!1),this.yieldPos=s,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(n,"FunctionExpression")};kt.parseArrowExpression=function(i,t,e,n){var s=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(P1(e,!1)|T1),this.initFunction(i),this.options.ecmaVersion>=8&&(i.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,i.params=this.toAssignableList(t,!0),this.parseFunctionBody(i,!0,!1,n),this.yieldPos=s,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(i,"ArrowFunctionExpression")};kt.parseFunctionBody=function(i,t,e,n){var s=t&&this.type!==w.braceL,r=this.strict,o=!1;if(s)i.body=this.parseMaybeAssign(n),i.expression=!0,this.checkParams(i,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(i.params);(!r||a)&&(o=this.strictDirective(this.end),o&&a&&this.raiseRecoverable(i.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(i,!r&&!o&&!t&&!e&&this.isSimpleParamList(i.params)),this.strict&&i.id&&this.checkLValSimple(i.id,qC),i.body=this.parseBlock(!1,void 0,o&&!r),i.expression=!1,this.adaptDirectivePrologue(i.body.body),this.labels=l}this.exitScope()};kt.isSimpleParamList=function(i){for(var t=0,e=i;t<e.length;t+=1){var n=e[t];if(n.type!=="Identifier")return!1}return!0};kt.checkParams=function(i,t){for(var e=Object.create(null),n=0,s=i.params;n<s.length;n+=1){var r=s[n];this.checkLValInnerPattern(r,A1,t?null:e)}};kt.parseExprList=function(i,t,e,n){for(var s=[],r=!0;!this.eat(i);){if(r)r=!1;else if(this.expect(w.comma),t&&this.afterTrailingComma(i))break;var o=void 0;e&&this.type===w.comma?o=null:this.type===w.ellipsis?(o=this.parseSpread(n),n&&this.type===w.comma&&n.trailingComma<0&&(n.trailingComma=this.start)):o=this.parseMaybeAssign(!1,n),s.push(o)}return s};kt.checkUnreserved=function(i){var t=i.start,e=i.end,n=i.name;if(this.inGenerator&&n==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&n==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&yp)&&n==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(n==="arguments"||n==="await")&&this.raise(t,"Cannot use "+n+" in class static initialization block"),this.keywords.test(n)&&this.raise(t,"Unexpected keyword '"+n+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,e).indexOf("\\")!==-1)){var s=this.strict?this.reservedWordsStrict:this.reservedWords;s.test(n)&&(!this.inAsync&&n==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+n+"' is reserved"))}};kt.parseIdent=function(i){var t=this.parseIdentNode();return this.next(!!i),this.finishNode(t,"Identifier"),i||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};kt.parseIdentNode=function(){var i=this.startNode();return this.type===w.name?i.name=this.value:this.type.keyword?(i.name=this.type.keyword,(i.name==="class"||i.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=w.name):this.unexpected(),i};kt.parsePrivateIdent=function(){var i=this.startNode();return this.type===w.privateId?i.name=this.value:this.unexpected(),this.next(),this.finishNode(i,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(i.start,"Private field '#"+i.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(i)),i};kt.parseYield=function(i){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===w.semi||this.canInsertSemicolon()||this.type!==w.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(w.star),t.argument=this.parseMaybeAssign(i)),this.finishNode(t,"YieldExpression")};kt.parseAwait=function(i){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,i),this.finishNode(t,"AwaitExpression")};var vd=Ge.prototype;vd.raise=function(i,t){var e=LC(this.input,i);t+=" ("+e.line+":"+e.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var n=new SyntaxError(t);throw n.pos=i,n.loc=e,n.raisedAt=this.pos,n};vd.raiseRecoverable=vd.raise;vd.curPosition=function(){if(this.options.locations)return new ih(this.curLine,this.pos-this.lineStart)};var so=Ge.prototype,TW=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};so.enterScope=function(i){this.scopeStack.push(new TW(i))};so.exitScope=function(){this.scopeStack.pop()};so.treatFunctionsAsVarInScope=function(i){return i.flags&xl||!this.inModule&&i.flags&nh};so.declareName=function(i,t,e){var n=!1;if(t===ur){var s=this.currentScope();n=s.lexical.indexOf(i)>-1||s.functions.indexOf(i)>-1||s.var.indexOf(i)>-1,s.lexical.push(i),this.inModule&&s.flags&nh&&delete this.undefinedExports[i]}else if(t===WC){var r=this.currentScope();r.lexical.push(i)}else if(t===FC){var o=this.currentScope();this.treatFunctionsAsVar?n=o.lexical.indexOf(i)>-1:n=o.lexical.indexOf(i)>-1||o.var.indexOf(i)>-1,o.functions.push(i)}else for(var a=this.scopeStack.length-1;a>=0;--a){var l=this.scopeStack[a];if(l.lexical.indexOf(i)>-1&&!(l.flags&BC&&l.lexical[0]===i)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(i)>-1){n=!0;break}if(l.var.push(i),this.inModule&&l.flags&nh&&delete this.undefinedExports[i],l.flags&yp)break}n&&this.raiseRecoverable(e,"Identifier '"+i+"' has already been declared")};so.checkLocalExport=function(i){this.scopeStack[0].lexical.indexOf(i.name)===-1&&this.scopeStack[0].var.indexOf(i.name)===-1&&(this.undefinedExports[i.name]=i)};so.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};so.currentVarScope=function(){for(var i=this.scopeStack.length-1;;i--){var t=this.scopeStack[i];if(t.flags&(yp|Zh|Ko))return t}};so.currentThisScope=function(){for(var i=this.scopeStack.length-1;;i--){var t=this.scopeStack[i];if(t.flags&(yp|Zh|Ko)&&!(t.flags&T1))return t}};var vp=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new mp(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},Fh=Ge.prototype;Fh.startNode=function(){return new vp(this,this.start,this.startLoc)};Fh.startNodeAt=function(i,t){return new vp(this,i,t)};function GC(i,t,e,n){return i.type=t,i.end=e,this.options.locations&&(i.loc.end=n),this.options.ranges&&(i.range[1]=e),i}Fh.finishNode=function(i,t){return GC.call(this,i,t,this.lastTokEnd,this.lastTokEndLoc)};Fh.finishNodeAt=function(i,t,e,n){return GC.call(this,i,t,e,n)};Fh.copyNode=function(i){var t=new vp(this,i.start,this.startLoc);for(var e in i)t[e]=i[e];return t};var PW="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",jC="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",UC=jC+" Extended_Pictographic",YC=UC,HC=YC+" EBase EComp EMod EPres ExtPict",KC=HC,AW=KC,MW={9:jC,10:UC,11:YC,12:HC,13:KC,14:AW},EW="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",RW={9:"",10:"",11:"",12:"",13:"",14:EW},Xv="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",JC="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",t3=JC+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",e3=t3+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",i3=e3+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",n3=i3+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",IW=n3+" "+PW,QW={9:JC,10:t3,11:e3,12:i3,13:n3,14:IW},s3={};function NW(i){var t=s3[i]={binary:Er(MW[i]+" "+Xv),binaryOfStrings:Er(RW[i]),nonBinary:{General_Category:Er(Xv),Script:Er(QW[i])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var Eg=0,zv=[9,10,11,12,13,14];Eg<zv.length;Eg+=1){var $W=zv[Eg];NW($W)}var ft=Ge.prototype,_d=function(t,e){this.parent=t,this.base=e||this};_d.prototype.separatedFrom=function(t){for(var e=this;e;e=e.parent)for(var n=t;n;n=n.parent)if(e.base===n.base&&e!==n)return!0;return!1};_d.prototype.sibling=function(){return new _d(this.parent,this.base)};var Is=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=s3[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Is.prototype.reset=function(t,e,n){var s=n.indexOf("v")!==-1,r=n.indexOf("u")!==-1;this.start=t|0,this.source=e+"",this.flags=n,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)};Is.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};Is.prototype.at=function(t,e){e===void 0&&(e=!1);var n=this.source,s=n.length;if(t>=s)return-1;var r=n.charCodeAt(t);if(!(e||this.switchU)||r<=55295||r>=57344||t+1>=s)return r;var o=n.charCodeAt(t+1);return o>=56320&&o<=57343?(r<<10)+o-56613888:r};Is.prototype.nextIndex=function(t,e){e===void 0&&(e=!1);var n=this.source,s=n.length;if(t>=s)return s;var r=n.charCodeAt(t),o;return!(e||this.switchU)||r<=55295||r>=57344||t+1>=s||(o=n.charCodeAt(t+1))<56320||o>57343?t+1:t+2};Is.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};Is.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};Is.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};Is.prototype.eat=function(t,e){return e===void 0&&(e=!1),this.current(e)===t?(this.advance(e),!0):!1};Is.prototype.eatChars=function(t,e){e===void 0&&(e=!1);for(var n=this.pos,s=0,r=t;s<r.length;s+=1){var o=r[s],a=this.at(n,e);if(a===-1||a!==o)return!1;n=this.nextIndex(n,e)}return this.pos=n,!0};ft.validateRegExpFlags=function(i){for(var t=i.validFlags,e=i.flags,n=!1,s=!1,r=0;r<e.length;r++){var o=e.charAt(r);t.indexOf(o)===-1&&this.raise(i.start,"Invalid regular expression flag"),e.indexOf(o,r+1)>-1&&this.raise(i.start,"Duplicate regular expression flag"),o==="u"&&(n=!0),o==="v"&&(s=!0)}this.options.ecmaVersion>=15&&n&&s&&this.raise(i.start,"Invalid regular expression flag")};function DW(i){for(var t in i)return!0;return!1}ft.validateRegExpPattern=function(i){this.regexp_pattern(i),!i.switchN&&this.options.ecmaVersion>=9&&DW(i.groupNames)&&(i.switchN=!0,this.regexp_pattern(i))};ft.regexp_pattern=function(i){i.pos=0,i.lastIntValue=0,i.lastStringValue="",i.lastAssertionIsQuantifiable=!1,i.numCapturingParens=0,i.maxBackReference=0,i.groupNames=Object.create(null),i.backReferenceNames.length=0,i.branchID=null,this.regexp_disjunction(i),i.pos!==i.source.length&&(i.eat(41)&&i.raise("Unmatched ')'"),(i.eat(93)||i.eat(125))&&i.raise("Lone quantifier brackets")),i.maxBackReference>i.numCapturingParens&&i.raise("Invalid escape");for(var t=0,e=i.backReferenceNames;t<e.length;t+=1){var n=e[t];i.groupNames[n]||i.raise("Invalid named capture referenced")}};ft.regexp_disjunction=function(i){var t=this.options.ecmaVersion>=16;for(t&&(i.branchID=new _d(i.branchID,null)),this.regexp_alternative(i);i.eat(124);)t&&(i.branchID=i.branchID.sibling()),this.regexp_alternative(i);t&&(i.branchID=i.branchID.parent),this.regexp_eatQuantifier(i,!0)&&i.raise("Nothing to repeat"),i.eat(123)&&i.raise("Lone quantifier brackets")};ft.regexp_alternative=function(i){for(;i.pos<i.source.length&&this.regexp_eatTerm(i););};ft.regexp_eatTerm=function(i){return this.regexp_eatAssertion(i)?(i.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(i)&&i.switchU&&i.raise("Invalid quantifier"),!0):(i.switchU?this.regexp_eatAtom(i):this.regexp_eatExtendedAtom(i))?(this.regexp_eatQuantifier(i),!0):!1};ft.regexp_eatAssertion=function(i){var t=i.pos;if(i.lastAssertionIsQuantifiable=!1,i.eat(94)||i.eat(36))return!0;if(i.eat(92)){if(i.eat(66)||i.eat(98))return!0;i.pos=t}if(i.eat(40)&&i.eat(63)){var e=!1;if(this.options.ecmaVersion>=9&&(e=i.eat(60)),i.eat(61)||i.eat(33))return this.regexp_disjunction(i),i.eat(41)||i.raise("Unterminated group"),i.lastAssertionIsQuantifiable=!e,!0}return i.pos=t,!1};ft.regexp_eatQuantifier=function(i,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(i,t)?(i.eat(63),!0):!1};ft.regexp_eatQuantifierPrefix=function(i,t){return i.eat(42)||i.eat(43)||i.eat(63)||this.regexp_eatBracedQuantifier(i,t)};ft.regexp_eatBracedQuantifier=function(i,t){var e=i.pos;if(i.eat(123)){var n=0,s=-1;if(this.regexp_eatDecimalDigits(i)&&(n=i.lastIntValue,i.eat(44)&&this.regexp_eatDecimalDigits(i)&&(s=i.lastIntValue),i.eat(125)))return s!==-1&&s<n&&!t&&i.raise("numbers out of order in {} quantifier"),!0;i.switchU&&!t&&i.raise("Incomplete quantifier"),i.pos=e}return!1};ft.regexp_eatAtom=function(i){return this.regexp_eatPatternCharacters(i)||i.eat(46)||this.regexp_eatReverseSolidusAtomEscape(i)||this.regexp_eatCharacterClass(i)||this.regexp_eatUncapturingGroup(i)||this.regexp_eatCapturingGroup(i)};ft.regexp_eatReverseSolidusAtomEscape=function(i){var t=i.pos;if(i.eat(92)){if(this.regexp_eatAtomEscape(i))return!0;i.pos=t}return!1};ft.regexp_eatUncapturingGroup=function(i){var t=i.pos;if(i.eat(40)){if(i.eat(63)){if(this.options.ecmaVersion>=16){var e=this.regexp_eatModifiers(i),n=i.eat(45);if(e||n){for(var s=0;s<e.length;s++){var r=e.charAt(s);e.indexOf(r,s+1)>-1&&i.raise("Duplicate regular expression modifiers")}if(n){var o=this.regexp_eatModifiers(i);!e&&!o&&i.current()===58&&i.raise("Invalid regular expression modifiers");for(var a=0;a<o.length;a++){var l=o.charAt(a);(o.indexOf(l,a+1)>-1||e.indexOf(l)>-1)&&i.raise("Duplicate regular expression modifiers")}}}}if(i.eat(58)){if(this.regexp_disjunction(i),i.eat(41))return!0;i.raise("Unterminated group")}}i.pos=t}return!1};ft.regexp_eatCapturingGroup=function(i){if(i.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(i):i.current()===63&&i.raise("Invalid group"),this.regexp_disjunction(i),i.eat(41))return i.numCapturingParens+=1,!0;i.raise("Unterminated group")}return!1};ft.regexp_eatModifiers=function(i){for(var t="",e=0;(e=i.current())!==-1&&LW(e);)t+=tr(e),i.advance();return t};function LW(i){return i===105||i===109||i===115}ft.regexp_eatExtendedAtom=function(i){return i.eat(46)||this.regexp_eatReverseSolidusAtomEscape(i)||this.regexp_eatCharacterClass(i)||this.regexp_eatUncapturingGroup(i)||this.regexp_eatCapturingGroup(i)||this.regexp_eatInvalidBracedQuantifier(i)||this.regexp_eatExtendedPatternCharacter(i)};ft.regexp_eatInvalidBracedQuantifier=function(i){return this.regexp_eatBracedQuantifier(i,!0)&&i.raise("Nothing to repeat"),!1};ft.regexp_eatSyntaxCharacter=function(i){var t=i.current();return r3(t)?(i.lastIntValue=t,i.advance(),!0):!1};function r3(i){return i===36||i>=40&&i<=43||i===46||i===63||i>=91&&i<=94||i>=123&&i<=125}ft.regexp_eatPatternCharacters=function(i){for(var t=i.pos,e=0;(e=i.current())!==-1&&!r3(e);)i.advance();return i.pos!==t};ft.regexp_eatExtendedPatternCharacter=function(i){var t=i.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(i.advance(),!0):!1};ft.regexp_groupSpecifier=function(i){if(i.eat(63)){this.regexp_eatGroupName(i)||i.raise("Invalid group");var t=this.options.ecmaVersion>=16,e=i.groupNames[i.lastStringValue];if(e)if(t)for(var n=0,s=e;n<s.length;n+=1){var r=s[n];r.separatedFrom(i.branchID)||i.raise("Duplicate capture group name")}else i.raise("Duplicate capture group name");t?(e||(i.groupNames[i.lastStringValue]=[])).push(i.branchID):i.groupNames[i.lastStringValue]=!0}};ft.regexp_eatGroupName=function(i){if(i.lastStringValue="",i.eat(60)){if(this.regexp_eatRegExpIdentifierName(i)&&i.eat(62))return!0;i.raise("Invalid capture group name")}return!1};ft.regexp_eatRegExpIdentifierName=function(i){if(i.lastStringValue="",this.regexp_eatRegExpIdentifierStart(i)){for(i.lastStringValue+=tr(i.lastIntValue);this.regexp_eatRegExpIdentifierPart(i);)i.lastStringValue+=tr(i.lastIntValue);return!0}return!1};ft.regexp_eatRegExpIdentifierStart=function(i){var t=i.pos,e=this.options.ecmaVersion>=11,n=i.current(e);return i.advance(e),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(i,e)&&(n=i.lastIntValue),VW(n)?(i.lastIntValue=n,!0):(i.pos=t,!1)};function VW(i){return ks(i,!0)||i===36||i===95}ft.regexp_eatRegExpIdentifierPart=function(i){var t=i.pos,e=this.options.ecmaVersion>=11,n=i.current(e);return i.advance(e),n===92&&this.regexp_eatRegExpUnicodeEscapeSequence(i,e)&&(n=i.lastIntValue),BW(n)?(i.lastIntValue=n,!0):(i.pos=t,!1)};function BW(i){return jr(i,!0)||i===36||i===95||i===8204||i===8205}ft.regexp_eatAtomEscape=function(i){return this.regexp_eatBackReference(i)||this.regexp_eatCharacterClassEscape(i)||this.regexp_eatCharacterEscape(i)||i.switchN&&this.regexp_eatKGroupName(i)?!0:(i.switchU&&(i.current()===99&&i.raise("Invalid unicode escape"),i.raise("Invalid escape")),!1)};ft.regexp_eatBackReference=function(i){var t=i.pos;if(this.regexp_eatDecimalEscape(i)){var e=i.lastIntValue;if(i.switchU)return e>i.maxBackReference&&(i.maxBackReference=e),!0;if(e<=i.numCapturingParens)return!0;i.pos=t}return!1};ft.regexp_eatKGroupName=function(i){if(i.eat(107)){if(this.regexp_eatGroupName(i))return i.backReferenceNames.push(i.lastStringValue),!0;i.raise("Invalid named reference")}return!1};ft.regexp_eatCharacterEscape=function(i){return this.regexp_eatControlEscape(i)||this.regexp_eatCControlLetter(i)||this.regexp_eatZero(i)||this.regexp_eatHexEscapeSequence(i)||this.regexp_eatRegExpUnicodeEscapeSequence(i,!1)||!i.switchU&&this.regexp_eatLegacyOctalEscapeSequence(i)||this.regexp_eatIdentityEscape(i)};ft.regexp_eatCControlLetter=function(i){var t=i.pos;if(i.eat(99)){if(this.regexp_eatControlLetter(i))return!0;i.pos=t}return!1};ft.regexp_eatZero=function(i){return i.current()===48&&!_p(i.lookahead())?(i.lastIntValue=0,i.advance(),!0):!1};ft.regexp_eatControlEscape=function(i){var t=i.current();return t===116?(i.lastIntValue=9,i.advance(),!0):t===110?(i.lastIntValue=10,i.advance(),!0):t===118?(i.lastIntValue=11,i.advance(),!0):t===102?(i.lastIntValue=12,i.advance(),!0):t===114?(i.lastIntValue=13,i.advance(),!0):!1};ft.regexp_eatControlLetter=function(i){var t=i.current();return o3(t)?(i.lastIntValue=t%32,i.advance(),!0):!1};function o3(i){return i>=65&&i<=90||i>=97&&i<=122}ft.regexp_eatRegExpUnicodeEscapeSequence=function(i,t){t===void 0&&(t=!1);var e=i.pos,n=t||i.switchU;if(i.eat(117)){if(this.regexp_eatFixedHexDigits(i,4)){var s=i.lastIntValue;if(n&&s>=55296&&s<=56319){var r=i.pos;if(i.eat(92)&&i.eat(117)&&this.regexp_eatFixedHexDigits(i,4)){var o=i.lastIntValue;if(o>=56320&&o<=57343)return i.lastIntValue=(s-55296)*1024+(o-56320)+65536,!0}i.pos=r,i.lastIntValue=s}return!0}if(n&&i.eat(123)&&this.regexp_eatHexDigits(i)&&i.eat(125)&&ZW(i.lastIntValue))return!0;n&&i.raise("Invalid unicode escape"),i.pos=e}return!1};function ZW(i){return i>=0&&i<=1114111}ft.regexp_eatIdentityEscape=function(i){if(i.switchU)return this.regexp_eatSyntaxCharacter(i)?!0:i.eat(47)?(i.lastIntValue=47,!0):!1;var t=i.current();return t!==99&&(!i.switchN||t!==107)?(i.lastIntValue=t,i.advance(),!0):!1};ft.regexp_eatDecimalEscape=function(i){i.lastIntValue=0;var t=i.current();if(t>=49&&t<=57){do i.lastIntValue=10*i.lastIntValue+(t-48),i.advance();while((t=i.current())>=48&&t<=57);return!0}return!1};var a3=0,er=1,bn=2;ft.regexp_eatCharacterClassEscape=function(i){var t=i.current();if(FW(t))return i.lastIntValue=-1,i.advance(),er;var e=!1;if(i.switchU&&this.options.ecmaVersion>=9&&((e=t===80)||t===112)){i.lastIntValue=-1,i.advance();var n;if(i.eat(123)&&(n=this.regexp_eatUnicodePropertyValueExpression(i))&&i.eat(125))return e&&n===bn&&i.raise("Invalid property name"),n;i.raise("Invalid property name")}return a3};function FW(i){return i===100||i===68||i===115||i===83||i===119||i===87}ft.regexp_eatUnicodePropertyValueExpression=function(i){var t=i.pos;if(this.regexp_eatUnicodePropertyName(i)&&i.eat(61)){var e=i.lastStringValue;if(this.regexp_eatUnicodePropertyValue(i)){var n=i.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(i,e,n),er}}if(i.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(i)){var s=i.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(i,s)}return a3};ft.regexp_validateUnicodePropertyNameAndValue=function(i,t,e){_l(i.unicodeProperties.nonBinary,t)||i.raise("Invalid property name"),i.unicodeProperties.nonBinary[t].test(e)||i.raise("Invalid property value")};ft.regexp_validateUnicodePropertyNameOrValue=function(i,t){if(i.unicodeProperties.binary.test(t))return er;if(i.switchV&&i.unicodeProperties.binaryOfStrings.test(t))return bn;i.raise("Invalid property name")};ft.regexp_eatUnicodePropertyName=function(i){var t=0;for(i.lastStringValue="";l3(t=i.current());)i.lastStringValue+=tr(t),i.advance();return i.lastStringValue!==""};function l3(i){return o3(i)||i===95}ft.regexp_eatUnicodePropertyValue=function(i){var t=0;for(i.lastStringValue="";WW(t=i.current());)i.lastStringValue+=tr(t),i.advance();return i.lastStringValue!==""};function WW(i){return l3(i)||_p(i)}ft.regexp_eatLoneUnicodePropertyNameOrValue=function(i){return this.regexp_eatUnicodePropertyValue(i)};ft.regexp_eatCharacterClass=function(i){if(i.eat(91)){var t=i.eat(94),e=this.regexp_classContents(i);return i.eat(93)||i.raise("Unterminated character class"),t&&e===bn&&i.raise("Negated character class may contain strings"),!0}return!1};ft.regexp_classContents=function(i){return i.current()===93?er:i.switchV?this.regexp_classSetExpression(i):(this.regexp_nonEmptyClassRanges(i),er)};ft.regexp_nonEmptyClassRanges=function(i){for(;this.regexp_eatClassAtom(i);){var t=i.lastIntValue;if(i.eat(45)&&this.regexp_eatClassAtom(i)){var e=i.lastIntValue;i.switchU&&(t===-1||e===-1)&&i.raise("Invalid character class"),t!==-1&&e!==-1&&t>e&&i.raise("Range out of order in character class")}}};ft.regexp_eatClassAtom=function(i){var t=i.pos;if(i.eat(92)){if(this.regexp_eatClassEscape(i))return!0;if(i.switchU){var e=i.current();(e===99||u3(e))&&i.raise("Invalid class escape"),i.raise("Invalid escape")}i.pos=t}var n=i.current();return n!==93?(i.lastIntValue=n,i.advance(),!0):!1};ft.regexp_eatClassEscape=function(i){var t=i.pos;if(i.eat(98))return i.lastIntValue=8,!0;if(i.switchU&&i.eat(45))return i.lastIntValue=45,!0;if(!i.switchU&&i.eat(99)){if(this.regexp_eatClassControlLetter(i))return!0;i.pos=t}return this.regexp_eatCharacterClassEscape(i)||this.regexp_eatCharacterEscape(i)};ft.regexp_classSetExpression=function(i){var t=er,e;if(!this.regexp_eatClassSetRange(i))if(e=this.regexp_eatClassSetOperand(i)){e===bn&&(t=bn);for(var n=i.pos;i.eatChars([38,38]);){if(i.current()!==38&&(e=this.regexp_eatClassSetOperand(i))){e!==bn&&(t=er);continue}i.raise("Invalid character in character class")}if(n!==i.pos)return t;for(;i.eatChars([45,45]);)this.regexp_eatClassSetOperand(i)||i.raise("Invalid character in character class");if(n!==i.pos)return t}else i.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(i)){if(e=this.regexp_eatClassSetOperand(i),!e)return t;e===bn&&(t=bn)}};ft.regexp_eatClassSetRange=function(i){var t=i.pos;if(this.regexp_eatClassSetCharacter(i)){var e=i.lastIntValue;if(i.eat(45)&&this.regexp_eatClassSetCharacter(i)){var n=i.lastIntValue;return e!==-1&&n!==-1&&e>n&&i.raise("Range out of order in character class"),!0}i.pos=t}return!1};ft.regexp_eatClassSetOperand=function(i){return this.regexp_eatClassSetCharacter(i)?er:this.regexp_eatClassStringDisjunction(i)||this.regexp_eatNestedClass(i)};ft.regexp_eatNestedClass=function(i){var t=i.pos;if(i.eat(91)){var e=i.eat(94),n=this.regexp_classContents(i);if(i.eat(93))return e&&n===bn&&i.raise("Negated character class may contain strings"),n;i.pos=t}if(i.eat(92)){var s=this.regexp_eatCharacterClassEscape(i);if(s)return s;i.pos=t}return null};ft.regexp_eatClassStringDisjunction=function(i){var t=i.pos;if(i.eatChars([92,113])){if(i.eat(123)){var e=this.regexp_classStringDisjunctionContents(i);if(i.eat(125))return e}else i.raise("Invalid escape");i.pos=t}return null};ft.regexp_classStringDisjunctionContents=function(i){for(var t=this.regexp_classString(i);i.eat(124);)this.regexp_classString(i)===bn&&(t=bn);return t};ft.regexp_classString=function(i){for(var t=0;this.regexp_eatClassSetCharacter(i);)t++;return t===1?er:bn};ft.regexp_eatClassSetCharacter=function(i){var t=i.pos;if(i.eat(92))return this.regexp_eatCharacterEscape(i)||this.regexp_eatClassSetReservedPunctuator(i)?!0:i.eat(98)?(i.lastIntValue=8,!0):(i.pos=t,!1);var e=i.current();return e<0||e===i.lookahead()&&qW(e)||XW(e)?!1:(i.advance(),i.lastIntValue=e,!0)};function qW(i){return i===33||i>=35&&i<=38||i>=42&&i<=44||i===46||i>=58&&i<=64||i===94||i===96||i===126}function XW(i){return i===40||i===41||i===45||i===47||i>=91&&i<=93||i>=123&&i<=125}ft.regexp_eatClassSetReservedPunctuator=function(i){var t=i.current();return zW(t)?(i.lastIntValue=t,i.advance(),!0):!1};function zW(i){return i===33||i===35||i===37||i===38||i===44||i===45||i>=58&&i<=62||i===64||i===96||i===126}ft.regexp_eatClassControlLetter=function(i){var t=i.current();return _p(t)||t===95?(i.lastIntValue=t%32,i.advance(),!0):!1};ft.regexp_eatHexEscapeSequence=function(i){var t=i.pos;if(i.eat(120)){if(this.regexp_eatFixedHexDigits(i,2))return!0;i.switchU&&i.raise("Invalid escape"),i.pos=t}return!1};ft.regexp_eatDecimalDigits=function(i){var t=i.pos,e=0;for(i.lastIntValue=0;_p(e=i.current());)i.lastIntValue=10*i.lastIntValue+(e-48),i.advance();return i.pos!==t};function _p(i){return i>=48&&i<=57}ft.regexp_eatHexDigits=function(i){var t=i.pos,e=0;for(i.lastIntValue=0;c3(e=i.current());)i.lastIntValue=16*i.lastIntValue+h3(e),i.advance();return i.pos!==t};function c3(i){return i>=48&&i<=57||i>=65&&i<=70||i>=97&&i<=102}function h3(i){return i>=65&&i<=70?10+(i-65):i>=97&&i<=102?10+(i-97):i-48}ft.regexp_eatLegacyOctalEscapeSequence=function(i){if(this.regexp_eatOctalDigit(i)){var t=i.lastIntValue;if(this.regexp_eatOctalDigit(i)){var e=i.lastIntValue;t<=3&&this.regexp_eatOctalDigit(i)?i.lastIntValue=t*64+e*8+i.lastIntValue:i.lastIntValue=t*8+e}else i.lastIntValue=t;return!0}return!1};ft.regexp_eatOctalDigit=function(i){var t=i.current();return u3(t)?(i.lastIntValue=t-48,i.advance(),!0):(i.lastIntValue=0,!1)};function u3(i){return i>=48&&i<=55}ft.regexp_eatFixedHexDigits=function(i,t){var e=i.pos;i.lastIntValue=0;for(var n=0;n<t;++n){var s=i.current();if(!c3(s))return i.pos=e,!1;i.lastIntValue=16*i.lastIntValue+h3(s),i.advance()}return!0};var E1=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new mp(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Bt=Ge.prototype;Bt.next=function(i){!i&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new E1(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Bt.getToken=function(){return this.next(),new E1(this)};typeof Symbol<"u"&&(Bt[Symbol.iterator]=function(){var i=this;return{next:function(){var t=i.getToken();return{done:t.type===w.eof,value:t}}}});Bt.nextToken=function(){var i=this.curContext();if((!i||!i.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(w.eof);if(i.override)return i.override(this);this.readToken(this.fullCharCodeAtPos())};Bt.readToken=function(i){return ks(i,this.options.ecmaVersion>=6)||i===92?this.readWord():this.getTokenFromCode(i)};Bt.fullCharCodeAtPos=function(){var i=this.input.charCodeAt(this.pos);if(i<=55295||i>=56320)return i;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?i:(i<<10)+t-56613888};Bt.skipBlockComment=function(){var i=this.options.onComment&&this.curPosition(),t=this.pos,e=this.input.indexOf("*/",this.pos+=2);if(e===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=e+2,this.options.locations)for(var n=void 0,s=t;(n=NC(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=n;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,e),t,this.pos,i,this.curPosition())};Bt.skipLineComment=function(i){for(var t=this.pos,e=this.options.onComment&&this.curPosition(),n=this.input.charCodeAt(this.pos+=i);this.pos<this.input.length&&!vl(n);)n=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+i,this.pos),t,this.pos,e,this.curPosition())};Bt.skipSpace=function(){t:for(;this.pos<this.input.length;){var i=this.input.charCodeAt(this.pos);switch(i){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(i>8&&i<14||i>=5760&&$C.test(String.fromCharCode(i)))++this.pos;else break t}}};Bt.finishToken=function(i,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var e=this.type;this.type=i,this.value=t,this.updateContext(e)};Bt.readToken_dot=function(){var i=this.input.charCodeAt(this.pos+1);if(i>=48&&i<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&i===46&&t===46?(this.pos+=3,this.finishToken(w.ellipsis)):(++this.pos,this.finishToken(w.dot))};Bt.readToken_slash=function(){var i=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):i===61?this.finishOp(w.assign,2):this.finishOp(w.slash,1)};Bt.readToken_mult_modulo_exp=function(i){var t=this.input.charCodeAt(this.pos+1),e=1,n=i===42?w.star:w.modulo;return this.options.ecmaVersion>=7&&i===42&&t===42&&(++e,n=w.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(w.assign,e+1):this.finishOp(n,e)};Bt.readToken_pipe_amp=function(i){var t=this.input.charCodeAt(this.pos+1);if(t===i){if(this.options.ecmaVersion>=12){var e=this.input.charCodeAt(this.pos+2);if(e===61)return this.finishOp(w.assign,3)}return this.finishOp(i===124?w.logicalOR:w.logicalAND,2)}return t===61?this.finishOp(w.assign,2):this.finishOp(i===124?w.bitwiseOR:w.bitwiseAND,1)};Bt.readToken_caret=function(){var i=this.input.charCodeAt(this.pos+1);return i===61?this.finishOp(w.assign,2):this.finishOp(w.bitwiseXOR,1)};Bt.readToken_plus_min=function(i){var t=this.input.charCodeAt(this.pos+1);return t===i?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Yi.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(w.incDec,2):t===61?this.finishOp(w.assign,2):this.finishOp(w.plusMin,1)};Bt.readToken_lt_gt=function(i){var t=this.input.charCodeAt(this.pos+1),e=1;return t===i?(e=i===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+e)===61?this.finishOp(w.assign,e+1):this.finishOp(w.bitShift,e)):t===33&&i===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(e=2),this.finishOp(w.relational,e))};Bt.readToken_eq_excl=function(i){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(w.equality,this.input.charCodeAt(this.pos+2)===61?3:2):i===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(w.arrow)):this.finishOp(i===61?w.eq:w.prefix,1)};Bt.readToken_question=function(){var i=this.options.ecmaVersion;if(i>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var e=this.input.charCodeAt(this.pos+2);if(e<48||e>57)return this.finishOp(w.questionDot,2)}if(t===63){if(i>=12){var n=this.input.charCodeAt(this.pos+2);if(n===61)return this.finishOp(w.assign,3)}return this.finishOp(w.coalesce,2)}}return this.finishOp(w.question,1)};Bt.readToken_numberSign=function(){var i=this.options.ecmaVersion,t=35;if(i>=13&&(++this.pos,t=this.fullCharCodeAtPos(),ks(t,!0)||t===92))return this.finishToken(w.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+tr(t)+"'")};Bt.getTokenFromCode=function(i){switch(i){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(w.parenL);case 41:return++this.pos,this.finishToken(w.parenR);case 59:return++this.pos,this.finishToken(w.semi);case 44:return++this.pos,this.finishToken(w.comma);case 91:return++this.pos,this.finishToken(w.bracketL);case 93:return++this.pos,this.finishToken(w.bracketR);case 123:return++this.pos,this.finishToken(w.braceL);case 125:return++this.pos,this.finishToken(w.braceR);case 58:return++this.pos,this.finishToken(w.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(w.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(i);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(i);case 124:case 38:return this.readToken_pipe_amp(i);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(i);case 60:case 62:return this.readToken_lt_gt(i);case 61:case 33:return this.readToken_eq_excl(i);case 63:return this.readToken_question();case 126:return this.finishOp(w.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+tr(i)+"'")};Bt.finishOp=function(i,t){var e=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(i,e)};Bt.readRegexp=function(){for(var i,t,e=this.pos;;){this.pos>=this.input.length&&this.raise(e,"Unterminated regular expression");var n=this.input.charAt(this.pos);if(Yi.test(n)&&this.raise(e,"Unterminated regular expression"),i)i=!1;else{if(n==="[")t=!0;else if(n==="]"&&t)t=!1;else if(n==="/"&&!t)break;i=n==="\\"}++this.pos}var s=this.input.slice(e,this.pos);++this.pos;var r=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(r);var a=this.regexpState||(this.regexpState=new Is(this));a.reset(e,s,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(s,o)}catch{}return this.finishToken(w.regexp,{pattern:s,flags:o,value:l})};Bt.readInt=function(i,t,e){for(var n=this.options.ecmaVersion>=12&&t===void 0,s=e&&this.input.charCodeAt(this.pos)===48,r=this.pos,o=0,a=0,l=0,c=t??1/0;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),u=void 0;if(n&&h===95){s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),a===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=h;continue}if(h>=97?u=h-97+10:h>=65?u=h-65+10:h>=48&&h<=57?u=h-48:u=1/0,u>=i)break;a=h,o=o*i+u}return n&&a===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===r||t!=null&&this.pos-r!==t?null:o};function GW(i,t){return t?parseInt(i,8):parseFloat(i.replace(/_/g,""))}function f3(i){return typeof BigInt!="function"?null:BigInt(i.replace(/_/g,""))}Bt.readRadixNumber=function(i){var t=this.pos;this.pos+=2;var e=this.readInt(i);return e==null&&this.raise(this.start+2,"Expected number in radix "+i),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(e=f3(this.input.slice(t,this.pos)),++this.pos):ks(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,e)};Bt.readNumber=function(i){var t=this.pos;!i&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var e=this.pos-t>=2&&this.input.charCodeAt(t)===48;e&&this.strict&&this.raise(t,"Invalid number");var n=this.input.charCodeAt(this.pos);if(!e&&!i&&this.options.ecmaVersion>=11&&n===110){var s=f3(this.input.slice(t,this.pos));return++this.pos,ks(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,s)}e&&/[89]/.test(this.input.slice(t,this.pos))&&(e=!1),n===46&&!e&&(++this.pos,this.readInt(10),n=this.input.charCodeAt(this.pos)),(n===69||n===101)&&!e&&(n=this.input.charCodeAt(++this.pos),(n===43||n===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),ks(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var r=GW(this.input.slice(t,this.pos),e);return this.finishToken(w.num,r)};Bt.readCodePoint=function(){var i=this.input.charCodeAt(this.pos),t;if(i===123){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t};Bt.readString=function(i){for(var t="",e=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var n=this.input.charCodeAt(this.pos);if(n===i)break;n===92?(t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!1),e=this.pos):n===8232||n===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(vl(n)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(e,this.pos++),this.finishToken(w.string,t)};var d3={};Bt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(i){if(i===d3)this.readInvalidTemplateToken();else throw i}this.inTemplateElement=!1};Bt.invalidStringToken=function(i,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw d3;this.raise(i,t)};Bt.readTmplToken=function(){for(var i="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var e=this.input.charCodeAt(this.pos);if(e===96||e===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===w.template||this.type===w.invalidTemplate)?e===36?(this.pos+=2,this.finishToken(w.dollarBraceL)):(++this.pos,this.finishToken(w.backQuote)):(i+=this.input.slice(t,this.pos),this.finishToken(w.template,i));if(e===92)i+=this.input.slice(t,this.pos),i+=this.readEscapedChar(!0),t=this.pos;else if(vl(e)){switch(i+=this.input.slice(t,this.pos),++this.pos,e){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:i+=`
`;break;default:i+=String.fromCharCode(e);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};Bt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(w.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};Bt.readEscapedChar=function(i){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return tr(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),i){var e=this.pos-1;this.invalidStringToken(e,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],s=parseInt(n,8);return s>255&&(n=n.slice(0,-1),s=parseInt(n,8)),this.pos+=n.length-1,t=this.input.charCodeAt(this.pos),(n!=="0"||t===56||t===57)&&(this.strict||i)&&this.invalidStringToken(this.pos-1-n.length,i?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(s)}return vl(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};Bt.readHexChar=function(i){var t=this.pos,e=this.readInt(16,i);return e===null&&this.invalidStringToken(t,"Bad character escape sequence"),e};Bt.readWord1=function(){this.containsEsc=!1;for(var i="",t=!0,e=this.pos,n=this.options.ecmaVersion>=6;this.pos<this.input.length;){var s=this.fullCharCodeAtPos();if(jr(s,n))this.pos+=s<=65535?1:2;else if(s===92){this.containsEsc=!0,i+=this.input.slice(e,this.pos);var r=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?ks:jr)(o,n)||this.invalidStringToken(r,"Invalid Unicode escape"),i+=tr(o),e=this.pos}else break;t=!1}return i+this.input.slice(e,this.pos)};Bt.readWord=function(){var i=this.readWord1(),t=w.name;return this.keywords.test(i)&&(t=k1[i]),this.finishToken(t,i)};var jW="8.15.0";Ge.acorn={Parser:Ge,version:jW,defaultOptions:S0,Position:ih,SourceLocation:mp,getLineInfo:LC,Node:vp,TokenType:Xt,tokTypes:w,keywordTypes:k1,TokContext:Rn,tokContexts:ve,isIdentifierChar:jr,isIdentifierStart:ks,Token:E1,isNewLine:vl,lineBreak:Yi,lineBreakG:mW,nonASCIIwhitespace:$C};function UW(i,t,e,n,s){e||(e=at),(function r(o,a,l){var c=l||o.type;e[c](o,a,r),t[c]&&t[c](o,a)})(i,n,s)}function R1(i,t,e){e(i,t)}function Jo(i,t,e){}var at={};at.Program=at.BlockStatement=at.StaticBlock=function(i,t,e){for(var n=0,s=i.body;n<s.length;n+=1){var r=s[n];e(r,t,"Statement")}};at.Statement=R1;at.EmptyStatement=Jo;at.ExpressionStatement=at.ParenthesizedExpression=at.ChainExpression=function(i,t,e){return e(i.expression,t,"Expression")};at.IfStatement=function(i,t,e){e(i.test,t,"Expression"),e(i.consequent,t,"Statement"),i.alternate&&e(i.alternate,t,"Statement")};at.LabeledStatement=function(i,t,e){return e(i.body,t,"Statement")};at.BreakStatement=at.ContinueStatement=Jo;at.WithStatement=function(i,t,e){e(i.object,t,"Expression"),e(i.body,t,"Statement")};at.SwitchStatement=function(i,t,e){e(i.discriminant,t,"Expression");for(var n=0,s=i.cases;n<s.length;n+=1){var r=s[n];e(r,t)}};at.SwitchCase=function(i,t,e){i.test&&e(i.test,t,"Expression");for(var n=0,s=i.consequent;n<s.length;n+=1){var r=s[n];e(r,t,"Statement")}};at.ReturnStatement=at.YieldExpression=at.AwaitExpression=function(i,t,e){i.argument&&e(i.argument,t,"Expression")};at.ThrowStatement=at.SpreadElement=function(i,t,e){return e(i.argument,t,"Expression")};at.TryStatement=function(i,t,e){e(i.block,t,"Statement"),i.handler&&e(i.handler,t),i.finalizer&&e(i.finalizer,t,"Statement")};at.CatchClause=function(i,t,e){i.param&&e(i.param,t,"Pattern"),e(i.body,t,"Statement")};at.WhileStatement=at.DoWhileStatement=function(i,t,e){e(i.test,t,"Expression"),e(i.body,t,"Statement")};at.ForStatement=function(i,t,e){i.init&&e(i.init,t,"ForInit"),i.test&&e(i.test,t,"Expression"),i.update&&e(i.update,t,"Expression"),e(i.body,t,"Statement")};at.ForInStatement=at.ForOfStatement=function(i,t,e){e(i.left,t,"ForInit"),e(i.right,t,"Expression"),e(i.body,t,"Statement")};at.ForInit=function(i,t,e){i.type==="VariableDeclaration"?e(i,t):e(i,t,"Expression")};at.DebuggerStatement=Jo;at.FunctionDeclaration=function(i,t,e){return e(i,t,"Function")};at.VariableDeclaration=function(i,t,e){for(var n=0,s=i.declarations;n<s.length;n+=1){var r=s[n];e(r,t)}};at.VariableDeclarator=function(i,t,e){e(i.id,t,"Pattern"),i.init&&e(i.init,t,"Expression")};at.Function=function(i,t,e){i.id&&e(i.id,t,"Pattern");for(var n=0,s=i.params;n<s.length;n+=1){var r=s[n];e(r,t,"Pattern")}e(i.body,t,i.expression?"Expression":"Statement")};at.Pattern=function(i,t,e){i.type==="Identifier"?e(i,t,"VariablePattern"):i.type==="MemberExpression"?e(i,t,"MemberPattern"):e(i,t)};at.VariablePattern=Jo;at.MemberPattern=R1;at.RestElement=function(i,t,e){return e(i.argument,t,"Pattern")};at.ArrayPattern=function(i,t,e){for(var n=0,s=i.elements;n<s.length;n+=1){var r=s[n];r&&e(r,t,"Pattern")}};at.ObjectPattern=function(i,t,e){for(var n=0,s=i.properties;n<s.length;n+=1){var r=s[n];r.type==="Property"?(r.computed&&e(r.key,t,"Expression"),e(r.value,t,"Pattern")):r.type==="RestElement"&&e(r.argument,t,"Pattern")}};at.Expression=R1;at.ThisExpression=at.Super=at.MetaProperty=Jo;at.ArrayExpression=function(i,t,e){for(var n=0,s=i.elements;n<s.length;n+=1){var r=s[n];r&&e(r,t,"Expression")}};at.ObjectExpression=function(i,t,e){for(var n=0,s=i.properties;n<s.length;n+=1){var r=s[n];e(r,t)}};at.FunctionExpression=at.ArrowFunctionExpression=at.FunctionDeclaration;at.SequenceExpression=function(i,t,e){for(var n=0,s=i.expressions;n<s.length;n+=1){var r=s[n];e(r,t,"Expression")}};at.TemplateLiteral=function(i,t,e){for(var n=0,s=i.quasis;n<s.length;n+=1){var r=s[n];e(r,t)}for(var o=0,a=i.expressions;o<a.length;o+=1){var l=a[o];e(l,t,"Expression")}};at.TemplateElement=Jo;at.UnaryExpression=at.UpdateExpression=function(i,t,e){e(i.argument,t,"Expression")};at.BinaryExpression=at.LogicalExpression=function(i,t,e){e(i.left,t,"Expression"),e(i.right,t,"Expression")};at.AssignmentExpression=at.AssignmentPattern=function(i,t,e){e(i.left,t,"Pattern"),e(i.right,t,"Expression")};at.ConditionalExpression=function(i,t,e){e(i.test,t,"Expression"),e(i.consequent,t,"Expression"),e(i.alternate,t,"Expression")};at.NewExpression=at.CallExpression=function(i,t,e){if(e(i.callee,t,"Expression"),i.arguments)for(var n=0,s=i.arguments;n<s.length;n+=1){var r=s[n];e(r,t,"Expression")}};at.MemberExpression=function(i,t,e){e(i.object,t,"Expression"),i.computed&&e(i.property,t,"Expression")};at.ExportNamedDeclaration=at.ExportDefaultDeclaration=function(i,t,e){i.declaration&&e(i.declaration,t,i.type==="ExportNamedDeclaration"||i.declaration.id?"Statement":"Expression"),i.source&&e(i.source,t,"Expression")};at.ExportAllDeclaration=function(i,t,e){i.exported&&e(i.exported,t),e(i.source,t,"Expression")};at.ImportDeclaration=function(i,t,e){for(var n=0,s=i.specifiers;n<s.length;n+=1){var r=s[n];e(r,t)}e(i.source,t,"Expression")};at.ImportExpression=function(i,t,e){e(i.source,t,"Expression")};at.ImportSpecifier=at.ImportDefaultSpecifier=at.ImportNamespaceSpecifier=at.Identifier=at.PrivateIdentifier=at.Literal=Jo;at.TaggedTemplateExpression=function(i,t,e){e(i.tag,t,"Expression"),e(i.quasi,t,"Expression")};at.ClassDeclaration=at.ClassExpression=function(i,t,e){return e(i,t,"Class")};at.Class=function(i,t,e){i.id&&e(i.id,t,"Pattern"),i.superClass&&e(i.superClass,t,"Expression"),e(i.body,t)};at.ClassBody=function(i,t,e){for(var n=0,s=i.body;n<s.length;n+=1){var r=s[n];e(r,t)}};at.MethodDefinition=at.PropertyDefinition=at.Property=function(i,t,e){i.computed&&e(i.key,t,"Expression"),i.value&&e(i.value,t,"Expression")};const YW=512,HW=20;function KW(i,t){return i.slice(0,YW).map((n,s)=>{const r=Math.max(0,Math.min(127,Math.round(n.pitch??60))),o=Math.max(0,n.position??0),a=1/t.subdivision,l=Math.max(a,n.duration??.25),c=Math.max(0,Math.min(127,n.velocity??100)),h=Math.max(a,t.maxLength-o);return{id:n.id||`note-${Date.now()}-${s}`,pitch:r,position:o,duration:Math.min(l,h),velocity:c}})}function JW(i,t){const e=t.map(s=>({name:s}));let n;for(const s of i)if(s.type==="Block"&&s.value.trim().startsWith("*")){const r=s.value.split(`
`).map(o=>o.trim());for(const o of r){const a=o.replace(/^\*\s*/,"").trim();if(a&&!a.startsWith("@")){n=a;break}}for(const o of r){const a=o.match(/@param\s*\{[^}]+\}\s*(\w+)\s*-?\s*(.*)/);if(a){const[,l,c]=a,h=e.find(u=>u.name===l);h&&c&&(h.description=c.trim())}}for(const o of e)if(o.name!=="notes"&&!o.description){for(const a of r)if(a.includes(o.name)&&!a.startsWith("function")){o.description=a.replace(/^\*\s*/,"").replace(/@param.*/,"").trim();break}}break}return{params:e,summary:n}}function tq(i){const t=[],e=[];try{const n=Ge.parse(i,{ecmaVersion:"latest",locations:!0,onComment:(d,p,g,m)=>{e.push({type:d?"Block":"Line",value:p,start:g,end:m})}});let s=null,r,o=[],a=null;if(UW(n,{FunctionDeclaration(d){if(d.id&&!s){s=d,r=d.id.name,o=d.params.map(p=>p.name);for(const p of e)p.end<d.start&&(a=p)}},VariableDeclarator(d){if(d.id&&!s&&d.init&&(d.init.type==="FunctionExpression"||d.init.type==="ArrowFunctionExpression")){s=d.init,r=d.id.name,o=d.init.params.map(g=>g.name);const p=d.start;for(const g of e)g.end<p&&(a=g)}}}),!s)return t.push("No function found. Please define a function with notes as the first parameter."),{valid:!1,errors:t};if(o.length===0)return t.push("Transform function must have at least one parameter (notes)"),{valid:!1,errors:t};if(o[0]!=="notes")return t.push('First parameter must be named "notes"'),{valid:!1,errors:t};if(!a||a.type!=="Block"||!a.value.trim().startsWith("*"))return t.push("Transform function must have a JSDoc comment"),{valid:!1,errors:t};const{params:l,summary:c}=JW([a],o);for(let d=1;d<o.length;d++){const p=o[d];a.value.includes(p)||t.push(`Parameter "${p}" is not documented in JSDoc`)}if(t.length>0)return{valid:!1,errors:t};const u=new Function(`"use strict";
`+i+`
if (typeof ${r} !== "function") throw new Error("${r} is not defined");
return ${r};`)(),f=u([]);return Array.isArray(f)?{valid:!0,errors:[],functionName:r,params:l,jsdocSummary:c,compiled:u}:(t.push("Function must return an array"),{valid:!1,errors:t})}catch(n){return t.push(`Parse error: ${n.message}`),{valid:!1,errors:t}}}function eq(i){const{getNotes:t,setNotes:e,getGrid:n}=i,s=Qo(Array.from({length:8},(y,_)=>({code:"",isValid:!1,name:`Slot ${_+1}`,params:[],errors:[],compiled:void 0,jsdocSummary:void 0}))),r=ue([]),o=ue([]);function a(y,_){if(y<0||y>=8)return;const v=s[y];v.code=_,v.isValid=!1,v.errors=[],v.compiled=void 0,v.params=[],v.jsdocSummary=void 0}function l(y){if(y<0||y>=8)return{valid:!1,errors:["Invalid slot index"]};const _=s[y],v=tq(_.code);return _.isValid=v.valid,_.errors=v.errors,v.valid&&v.compiled&&(_.compiled=v.compiled,_.functionName=v.functionName,_.params=v.params||[],_.jsdocSummary=v.jsdocSummary),v}function c(y,_){if(y<0||y>=8)return{status:"error",count:0,error:"Invalid slot index"};const v=s[y];if(!v.isValid||!v.compiled)return{status:"error",count:0,error:"Slot not validated"};try{const b=t();r.value.push(b),r.value.length>HW&&r.value.shift(),o.value=[];const k=v.compiled(b,..._),x=KW(k,n());return e(x),{status:"ok",count:x.length}}catch(b){return{status:"error",count:0,error:b.message}}}function h(){if(r.value.length===0)return;const y=t(),_=r.value.pop();o.value.push(y),e(_)}function u(){if(o.value.length===0)return;const y=t(),_=o.value.pop();r.value.push(y),e(_)}function f(){const y=[];for(let _=0;_<s.length;_++){const v=s[_];if(!v.isValid)continue;const b={},k=[];for(const x of v.params)x.name!=="notes"&&(b[x.name]={type:"number",description:x.description||`Parameter ${x.name}`},k.push(x.name));y.push({name:`transform_slot_${_+1}`,description:v.jsdocSummary||`User-defined transform in ${v.name}`,input_schema:{type:"object",properties:b,required:k}})}return y}function d(){const y=new Map;for(let _=0;_<s.length;_++){const v=s[_];if(!v.isValid)continue;const b=`transform_slot_${_+1}`;y.set(b,async k=>{const x=v.params.filter(R=>R.name!=="notes").map(R=>k[R.name]||0),C=c(_,x),I=n();return{status:C.status,count:C.count,error:C.error,grid:I}})}return y}function p(y,_){return a(y,_),l(y)}function g(){if(s.filter(v=>v.isValid).length===0)return"No transform tools currently available.";const _=[];for(let v=0;v<s.length;v++){const b=s[v];if(!b.isValid)continue;const k=`transform_slot_${v+1}`,x=b.functionName||"unnamed",C=b.jsdocSummary||"User-defined transform",I=b.params.filter(R=>R.name!=="notes").map(R=>`${R.name}${R.description?` (${R.description})`:""}`).join(", ");_.push(`- ${k} (${x}): ${C}${I?` | Params: ${I}`:""}`)}return _.join(`
`)}function m(){return r.value.length>0}function O(){return o.value.length>0}return{slots:s,setCode:a,validateSlot:l,applyTransform:c,undo:h,redo:u,canUndo:m,canRedo:O,getToolDefs:f,getToolHandlers:d,writeTransformFunction:p,summarizeTransforms:g}}function iq(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var t=i.default;if(typeof t=="function"){var e=function n(){var s=!1;try{s=this instanceof n}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(n){var s=Object.getOwnPropertyDescriptor(i,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return i[n]}})}),e}var nq=Object.defineProperty,qe=(i,t)=>nq(i,"name",{value:t,configurable:!0});Symbol.dispose??=Symbol("Symbol.dispose");Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");var sq=qe(i=>{const t=qe(()=>i(),"wrapped");return t[Symbol.dispose]=()=>t(),t},"wrapDispose"),wo,as,Da,p3=(Da=class{constructor(t){ro(this,wo);ro(this,as);fr(this,wo,t),fr(this,as,[])}on(t,e){const n=qe((...s)=>e(...s),"wrappedFn");return xe(this,wo).on(t,n),xe(this,as).push({name:t,wrappedFn:n,fn:e}),()=>{this.off(t,n)}}off(t,e){const n=xe(this,as).find(s=>s.name===t&&s.fn===e);if(!n)throw new Error("Event you are trying to unregister was not registered via this Registrator");xe(this,wo).off(t,n.wrappedFn),fr(this,as,xe(this,as).filter(s=>!(s.name===t&&s.fn===e)))}offAll(){xe(this,as).forEach(({name:t,wrappedFn:e})=>{xe(this,wo).off(t,e)}),fr(this,as,[])}[Symbol.dispose](){this.offAll()}},wo=new WeakMap,as=new WeakMap,qe(Da,"OmnibusRegistrator"),Da),Mo,g3=(Mo=class{call=async(t,...e)=>t(...e);map(t){const e=this.call;return this.call=async(n,...s)=>{await e(qe(async(...o)=>{const a=await t(...o),l=Array.isArray(a)?a:[a];await n(...l)},"trigger"),...s)},this}filter(t){const e=this.call;return this.call=async(n,...s)=>{await t(...s)&&await e(n,...s)},this}reduce(t,e){const n=this.call;let s=Array.isArray(e)?e:[e];return this.call=async(r,...o)=>{await n(qe(async(...l)=>{const c=await t(...l,...s);s=Array.isArray(c)?c:[c],await r(c)},"trigger"),...o)},this}shouldMemoize=!1;memoize(){return this.shouldMemoize=!0,this}static init(){return new Mo}},qe(Mo,"Builder"),Mo),Eo,rq=(Eo=class extends g3{build(){if(!this.shouldMemoize)return this.call;const t=new Map;return async(e,...n)=>{const s=n.map(o=>o.toString()).join("::::");if(t.has(s))return t.get(s);const r=qe((...o)=>(t.set(s,o),e(...o)),"newT");this.call(r,...n)}}static init(){return new Eo}map(t){return super.map(t)}reduce(t,e){return super.reduce(t,e)}},qe(Eo,"BuildableBuilder"),Eo),oq=qe(()=>new g3,"args"),aq=qe((i,t)=>!!i[`on${t}`]&&typeof i[`on${t}`]=="function","isOldschoolOnRegistrator"),lq=qe(i=>!!i.addEventListener&&typeof i.addEventListener=="function","isEventListenerRegistrator"),cq=qe(i=>typeof i=="function","isCallbackRegistrator"),hq=qe(i=>!!i.on&&typeof i.on=="function","isOmnibusRegistrator"),Tr,sh,Ro,m3=(Ro=class{constructor(){ro(this,Tr,new Map);ro(this,sh,[])}register(t,e){return this}derive(t,e,n){xe(this,Tr).has(e)||xe(this,Tr).set(e,[]);const s=n(new rq).build();return xe(this,Tr).set(e,[...xe(this,Tr).get(e),{targetKey:t,transformer:s}]),this}from(t,e,n){const s=qe(r=>{if(lq(t)){const o=qe((...a)=>{r.trigger(n||e,...a)},"cb");t.addEventListener(e,o)}if(hq(t)&&t.on(e,(...o)=>r.trigger(n||e,...o)),aq(t,e)){const o=t[`on${e}`](t)[`on${e}`]=(...a)=>(r.trigger(n||e,...a),o(...a));return}if(cq(t)){t(e,(...o)=>r.trigger(n||e,...o));return}},"register");return xe(this,sh).push(s),this}build(){const t=new O3(xe(this,Tr));return xe(this,sh).forEach(e=>e(t)),t}static init(){return new Ro}},Tr=new WeakMap,sh=new WeakMap,qe(Ro,"BusBuilder"),Ro),In,La,Va,O3=(Va=class{constructor(t){ro(this,In);ro(this,La);fr(this,In,new Map),fr(this,La,t||new Map),this.on=this.on.bind(this)}static builder(){return new m3}on(t,e){return xe(this,In).has(t)||xe(this,In).set(t,[]),xe(this,In).get(t).push(e),sq(()=>{this.off(t,e)})}once(t,e){if(e){const n=qe((...s)=>{this.off(t,n),e(...s)},"callback");return this.on(t,n)}return new Promise(n=>{const s=this.on(t,(...r)=>{s(),r.length===1?n(r[0]):n(r)})})}off(t,e){const n=xe(this,In).get(t)||[];xe(this,In).set(t,n.filter(s=>s!==e))}offAll(){fr(this,In,new Map)}async trigger(t,...e){const n=xe(this,In).get(t)||[];await Promise.all(n.map(s=>s(...e))).then(()=>{}),xe(this,La).has(t)&&await Promise.all(xe(this,La).get(t).map(({targetKey:s,transformer:r})=>r((...o)=>this.trigger(s,...o),...e)))}getRegistrator(){return new p3(this)}},In=new WeakMap,La=new WeakMap,qe(Va,"Omnibus"),Va);const uq=Object.freeze(Object.defineProperty({__proto__:null,BusBuilder:m3,Omnibus:O3,OmnibusRegistrator:p3,args:oq},Symbol.toStringTag,{value:"Module"})),Rg=iq(uq);var Ig,Gv;function fq(){if(Gv)return Ig;Gv=1;var i=Object.defineProperty,t=Object.defineProperties,e=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertyNames,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(T,S,A)=>S in T?i(T,S,{enumerable:!0,configurable:!0,writable:!0,value:A}):T[S]=A,c=(T,S)=>{for(var A in S||(S={}))o.call(S,A)&&l(T,A,S[A]);if(r)for(var A of r(S))a.call(S,A)&&l(T,A,S[A]);return T},h=(T,S)=>t(T,n(S)),u=(T,S)=>{for(var A in S)i(T,A,{get:S[A],enumerable:!0})},f=(T,S,A,D)=>{if(S&&typeof S=="object"||typeof S=="function")for(let q of s(S))!o.call(T,q)&&q!==A&&i(T,q,{get:()=>S[q],enumerable:!(D=e(S,q))||D.enumerable});return T},d=T=>f(i({},"__esModule",{value:!0}),T),p=(T,S,A)=>new Promise((D,q)=>{var K=rt=>{try{pt(A.next(rt))}catch(yt){q(yt)}},J=rt=>{try{pt(A.throw(rt))}catch(yt){q(yt)}},pt=rt=>rt.done?D(rt.value):Promise.resolve(rt.value).then(K,J);pt((A=A.apply(T,S)).next())}),g={};u(g,{Callback:()=>G.CallbackType,MIDIVal:()=>Q,MIDIValInput:()=>Nt,MIDIValOutput:()=>Mt,UnregisterCallback:()=>G.UnregisterCallback}),Ig=d(g);var m=T=>T>=120,O=([T,S,A])=>{const D=T>>4<<4;return{channel:T-D+1,command:D,data1:S,data2:A}},y=T=>{if(T<-1||T>1)throw new Error("Pitch bend value outside the range");return Math.ceil((T+1)*16383/2)},_=T=>v(y(T)),v=T=>{let S=[];return S[0]=127&T,S[1]=T>>7,S},b=T=>{var S,A;return((S=T[0])!=null?S:0)+(((A=T[1])!=null?A:0)<<7)},k=T=>(b(T)/16363-.5)*2,x={NoteOn:144,NoteOff:128,PolyKeyPressure:160,ControlChange:176,ProgramChange:192,ChannelPressure:208,PitchBend:224,Clock:{Start:250,Continue:251,Stop:252,Pulse:248}},C=(T,S)=>T+S,I=T=>{const S=[];for(let A=1;A<T.length;A++)S.push(T[A]-T[A-1]);return S},R=T=>!T||!T.length?0:T.reduce(C)/T.length,$=T=>6e4/(T*24),E=T=>!T||T.length<2?0:$(R(I(T))),Z=class extends Error{constructor(T){super(T)}get name(){return this.constructor.name}},F=class extends Z{},W=T=>{var S;return h(c({},T),{note:T.data1,velocity:(S=T.data2)!=null?S:0})},B=T=>{var S;return h(c({},T),{control:T.data1,value:(S=T.data2)!=null?S:0})},U=T=>{var S;return h(c({},T),{program:T.data1,value:(S=T.data2)!=null?S:0})},V={PITCH_BEND_SENSITIVITY:[0,0],CHANNEL_FINE_TUNING:[0,1],CHANNEL_COARSE_TUNING:[0,2],TUNING_PROGRAM_CHANGE:[0,3],TUNING_BANK_SELECT:[0,4],MODULATION_DEPTH_CHANGE:[0,5],MPE_CONFIGURATION_MESSAGE:[0,6]},X=T=>{const[S,A]=T.map(D=>D??-1);for(const[D,q]of Object.entries(V))if(q[0]===S&&q[1]===A)return D;throw new Error("Unknown registered parameter")},j=Rg,tt=()=>j.Omnibus.builder().register("pithchBend",(0,j.args)()).register("sysex",(0,j.args)()).register("channelPressure",(0,j.args)()).register("noteOn",(0,j.args)()).register("noteOff",(0,j.args)()).register("controlChange",(0,j.args)()).register("programChange",(0,j.args)()).register("polyKeyPressure",(0,j.args)()).register("clockPulse",(0,j.args)()).register("clockStart",(0,j.args)()).register("clockStop",(0,j.args)()).register("clockContinue",(0,j.args)()).register("registeredParameterData",(0,j.args)()).register("message",(0,j.args)()).build(),it=20,_t={computeClockTempo:!1},Nt=class C0{constructor(S,A=_t){this.options=A,this.omnibus=tt(),this.tempoSamples=[],this.rpn=[-1,-1],this.registerInput(S)}static fromInterfaceId(S,A){return p(this,null,function*(){const q=(yield this.getMidiAccess()).inputs.find(({id:K})=>K===S);if(!q)throw new Z(`${S} not found`);return new C0(q,A)})}static fromInterfaceName(S,A){return p(this,null,function*(){const q=(yield this.getMidiAccess()).inputs.find(({name:K})=>K===S);if(!q)throw new Z(`${S} not found`);return new C0(q,A)})}static getMidiAccess(){return p(this,null,function*(){return yield Q.connect()})}get tempo(){if(!this.options.computeClockTempo)throw new F("To use MIDIValInput.tempo you need to enable computeClockTempo option.");return E(this.tempoSamples)}once(S,A){return this.omnibus.once(S,A)}registerInput(S){return p(this,null,function*(){if(this.unregisterInput=yield S.onMessage(A=>{if(A.data[0]===240){this.omnibus.trigger("sysex",A.data);return}if(this.isClockCommand(A))return;const D=O(A.data);switch(this.omnibus.trigger("message",D),D.command){case x.NoteOn:this.omnibus.trigger("noteOn",W(D));break;case x.NoteOff:this.omnibus.trigger("noteOff",W(D));break;case x.ControlChange:this.omnibus.trigger("controlChange",B(D));break;case x.ProgramChange:this.omnibus.trigger("programChange",U(D));break;case x.PolyKeyPressure:this.omnibus.trigger("polyKeyPressure",D);break;case x.PitchBend:this.omnibus.trigger("pithchBend",{channel:D.channel,value:k([D.data1,D.data2])});break;case x.ChannelPressure:this.omnibus.trigger("channelPressure",D);break}}),this.options.computeClockTempo){this.onClockPulse(()=>{this.tempoSamples.push(performance.now()),this.tempoSamples.length>it&&this.tempoSamples.shift()});const A=()=>{this.tempoSamples=[]};this.onClockContinue(A),this.onClockStart(A)}this.onControlChange(101,A=>{var D;this.rpn=[(D=A.data2)!=null?D:0,this.rpn[1]]}),this.onControlChange(100,A=>{var D;this.rpn=[this.rpn[0],(D=A.data2)!=null?D:0]}),this.onControlChange(6,A=>{const D=X(this.rpn);this.omnibus.trigger("registeredParameterData",{channel:A.channel,parameter:D,msb:A.data2,lsb:null})}),this.onControlChange(38,A=>{const D=X(this.rpn);this.omnibus.trigger("registeredParameterData",{channel:A.channel,parameter:D,msb:null,lsb:A.data2})})})}isClockCommand(S){switch(S.data[0]){case x.Clock.Pulse:return this.omnibus.trigger("clockPulse"),!0;case x.Clock.Start:return this.omnibus.trigger("clockStart"),!0;case x.Clock.Continue:return this.omnibus.trigger("clockContinue"),!0;case x.Clock.Stop:return this.omnibus.trigger("clockStop"),!0;default:return!1}}onBusKeyValue(S,A,D,q){return this.omnibus.on(S,(...K)=>{if(!K.length)return;const J=K[0];typeof J=="object"&&J[A]===D&&q(J)})}disconnect(){this.omnibus.offAll(),this.unregisterInput&&this.unregisterInput()}onAllNoteOn(S){return this.omnibus.on("noteOn",S)}onNoteOn(S,A){return this.omnibus.on("noteOn",D=>{if(D.note===S)return A(D)})}onAllNoteOff(S){return this.omnibus.on("noteOff",S)}onNoteOff(S,A){return this.onBusKeyValue("noteOff","note",S,A)}onPitchBend(S){return this.omnibus.on("pithchBend",S)}onAllControlChange(S){return this.omnibus.on("controlChange",S)}onControlChange(S,A){return m(S)&&console.warn("use designated Channel Mode callback instead of onControlChange for "+S),this.omnibus.on("controlChange",D=>{D.control===S&&A(D)})}onAllProgramChange(S){return this.omnibus.on("programChange",S)}onProgramChange(S,A){return this.onBusKeyValue("programChange","program",S,A)}onAllPolyKeyPressure(S){return this.omnibus.on("polyKeyPressure",S)}onPolyKeyPressure(S,A){return this.onBusKeyValue("polyKeyPressure","data1",S,A)}onSysex(S){return this.omnibus.on("sysex",S)}onAllSoundsOff(S){return this.onBusKeyValue("controlChange","control",120,S)}onResetAllControllers(S){return this.onBusKeyValue("controlChange","control",121,S)}onLocalControlChange(S){return this.onBusKeyValue("controlChange","control",122,A=>{S(A.data2===127,A)})}onAllNotesOff(S){return this.onBusKeyValue("controlChange","control",123,S)}onChannelPressure(S){return this.omnibus.on("channelPressure",S)}onOmniModeOff(S){return this.onBusKeyValue("controlChange","control",124,S)}onOmniModeOn(S){return this.onBusKeyValue("controlChange","control",125,S)}onMonoModeOn(S){return this.onBusKeyValue("controlChange","control",126,S)}onPolyModeOn(S){return this.onBusKeyValue("controlChange","control",127,S)}onClockPulse(S){return this.omnibus.on("clockPulse",S)}onClockStart(S){return this.omnibus.on("clockStart",S)}onClockStop(S){return this.omnibus.on("clockStop",S)}onClockContinue(S){return this.omnibus.on("clockContinue",S)}onMpeConfiguration(S){return this.onBusKeyValue("registeredParameterData","parameter","MPE_CONFIGURATION_MESSAGE",S)}onPitchBendSensitivity(S){return this.onBusKeyValue("registeredParameterData","parameter","PITCH_BEND_SENSITIVITY",S)}onChannelFineTuning(S){return this.onBusKeyValue("registeredParameterData","parameter","CHANNEL_FINE_TUNING",S)}onChannelCoarseTuning(S){return this.onBusKeyValue("registeredParameterData","parameter","CHANNEL_COARSE_TUNING",S)}onTuningProgramChange(S){return this.onBusKeyValue("registeredParameterData","parameter","TUNING_PROGRAM_CHANGE",S)}onTuningBankChange(S){return this.onBusKeyValue("registeredParameterData","parameter","TUNING_BANK_SELECT",S)}onModulationDepthChange(S){return this.onBusKeyValue("registeredParameterData","parameter","MODULATION_DEPTH_CHANGE",S)}},Ot=T=>new Promise(S=>setInterval(S,T)),Mt=class y3{constructor(S){this.midiOutput=S,this.defaultChannel=1}send(S){this.midiOutput&&this.midiOutput.send(S)}setChannel(S){this.defaultChannel=S}getChannel(S){return S?S-1:this.defaultChannel-1}static fromInterfaceName(S){return p(this,null,function*(){const D=(yield this.getMidiAccess()).outputs.find(({name:q})=>q===S);if(!D)throw new Error(`${S} not found`);return new y3(D)})}static getMidiAccess(){return p(this,null,function*(){return yield Q.connect()})}sendNoteOn(S,A,D){return this.send([x.NoteOn+this.getChannel(D),S,A])}sendNoteOff(S,A){return this.send([x.NoteOff+this.getChannel(A),S,0])}sendPolyKeyPressure(S,A,D){return this.send([x.PolyKeyPressure+this.getChannel(D),S,A])}sendControlChange(S,A,D){return this.send([x.ControlChange+this.getChannel(D),S,A])}sendProgramChange(S,A){return this.send([x.ProgramChange+this.getChannel(A),S])}sendChannelPressure(S,A){return this.send([x.ChannelPressure+this.getChannel(A),S])}sendPitchBend(S,A){return this.send(new Uint8Array([x.PitchBend+this.getChannel(A),..._(S)]))}sendAllSoundOff(S){return this.send([x.ControlChange+this.getChannel(S),120,0])}sendResetAllControllers(S){return this.send([x.ControlChange+this.getChannel(S),121,0])}sendLocalControlOff(S){return this.send([x.ControlChange+this.getChannel(S),122,0])}sendLocalControlOn(S){return this.send([x.ControlChange+this.getChannel(S),122,127])}sendAllNotesOff(S){return this.send([x.ControlChange+this.getChannel(S),123,0])}sendClockStart(){return this.send([x.Clock.Start])}sendClockStop(){return this.send([x.Clock.Stop])}sendClockContinue(){return this.send([x.Clock.Continue])}sendClockPulse(){return this.send([x.Clock.Pulse])}sendRPNSelection([S,A],D){this.sendControlChange(101,S,D),this.sendControlChange(100,A,D)}sendRPDataMSB(S,A){this.sendControlChange(6,S,A)}sendRPDataLSB(S,A){this.sendControlChange(38,S,A)}incrementRPData(S,A){this.sendControlChange(96,S,A)}decrementRPData(S,A){this.sendControlChange(97,S,A)}sendRPNNull(){}initializeMPE(S,A,D=100){return p(this,null,function*(){this.sendRPNSelection(V.MPE_CONFIGURATION_MESSAGE,1),yield Ot(D),this.sendRPDataMSB(S,1),yield Ot(D),this.sendRPDataMSB(A,16),yield Ot(D),this.sendRPNNull(),yield Ot(D)})}setPitchBendSensitivity(S,A,D,q=100){return p(this,null,function*(){this.sendRPNSelection(V.PITCH_BEND_SENSITIVITY,D),yield Ot(q),this.sendRPDataMSB(S,D),yield Ot(q),this.sendRPNNull()})}},Yt=class{constructor(T){this.output=T}send(T){this.output.send(T)}get id(){return this.output.id}get name(){return this.output.name||""}get manufacturer(){return this.output.manufacturer||""}},dt=class{constructor(T){this.input=T}onMessage(T){return p(this,null,function*(){yield this.input.open();const S=A=>{T({data:A.data,receivedTime:A.timeStamp})};return this.input.addEventListener("midimessage",S),()=>{this.input.removeEventListener("midimessage",S)}})}get id(){return this.input.id}get name(){return this.input.name||""}get manufacturer(){return this.input.manufacturer||""}},Et=Rg,bt=class{constructor(){this.access=null,this.bus=new Et.Omnibus}onInputConnected(T){return this.bus.on("inputConnected",T)}onInputDisconnected(T){return this.bus.on("inputDisconnected",T)}onOutputConnected(T){return this.bus.on("outputConnected",T)}onOutputDisconnected(T){return this.bus.on("outputDisconnected",T)}connect(T=!1){return p(this,null,function*(){if(!navigator.requestMIDIAccess)throw new Error("requestMIDIAccess not available, make sure you are using MIDI-compatible browser.");this.access=yield navigator.requestMIDIAccess({sysex:T}),this.listenOnStateChange()})}get outputs(){if(!this.access)throw new Error("MIDI access not initialized, call connect() first");return Array.from(this.access.outputs).map(([,T])=>new Yt(T))}get inputs(){if(!this.access)throw new Error("MIDI access not initialized, call connect() first");return Array.from(this.access.inputs).map(([,T])=>new dt(T))}getInputById(T){if(!this.access)throw new Error("MIDI access not initialized, call connect() first");const S=Array.from(this.access.inputs).map(([,A])=>A).find(({id:A})=>A===T);if(!S)throw new Error(`Cannot find input ${T}`);return new dt(S)}getOutputById(T){if(!this.access)throw new Error("MIDI access not initialized, call connect() first");const S=Array.from(this.access.outputs).map(([,A])=>A).find(({id:A})=>A===T);if(!S)throw new Error(`Cannot find output ${T}`);return new Yt(S)}listenOnStateChange(){if(!this.access)throw new Error("MIDI access not initialized, call connect() first");this.access.addEventListener("statechange",T=>{var S,A,D;if(((S=T.port)==null?void 0:S.type)==="input")switch((A=T.port)==null?void 0:A.state){case"disconnected":this.bus.trigger("inputDisconnected",new dt(T.port));break;case"connected":this.bus.trigger("inputConnected",new dt(T.port));break}else switch((D=T.port)==null?void 0:D.state){case"disconnected":this.bus.trigger("outputDisconnected",new Yt(T.port));break;case"connected":this.bus.trigger("outputConnected",new Yt(T.port));break}})}},Wt=(T,S)=>Object.keys(S).reduce((A,D)=>{const q=S[D];return typeof q=="string"?A&&T[D]===q:A&&q.test(T[D])},!0),M={sysex:!1},Q=class{static configureAccessObject(T){this.isSetupComplete=!1,this.accessObject=T}static onInputDeviceConnected(T,S=!1){return p(this,null,function*(){return S&&this.accessObject.inputs.forEach(T),this.accessObject.onInputConnected(T)})}static onInputDeviceWithConfigConnected(T,S,A=!1){return p(this,null,function*(){return this.onInputDeviceConnected(D=>{Wt(D,T)&&S(new Nt(D))},A)})}static onOutputDeviceWithConfigConnected(T,S,A=!1){return p(this,null,function*(){return this.onOutputDeviceConnected(D=>{Wt(D,T)&&S(new Mt(D))},A)})}static onOutputDeviceConnected(T,S=!1){return p(this,null,function*(){return S&&this.accessObject.outputs.forEach(T),this.accessObject.onOutputConnected(T)})}static onInputDeviceDisconnected(T){return p(this,null,function*(){return this.accessObject.onInputDisconnected(T)})}static onOutputDeviceDisconnected(T){return p(this,null,function*(){return this.accessObject.onOutputDisconnected(T)})}static fromMIDIInput(T){return new Nt(T)}static fromMIDIOutput(T){return new Mt(T)}static connect(){return p(this,arguments,function*(T=M){return this.connectionConfig=T,yield this.setupDeviceWatchers(),this.accessObject})}static setupDeviceWatchers(){return p(this,null,function*(){this.isSetupComplete||(this.isSetupComplete=!0,this.accessObject||(this.accessObject=new bt),yield this.accessObject.connect(this.connectionConfig.sysex))})}};Q.isSetupComplete=!1;var G=Rg;return Ig}var jv=fq();class dq{midiOutput=null;availableOutputs=[];selectedDeviceId=null;midiEnabled=!1;midiAccess=null;async initialize(){try{this.midiAccess=await jv.MIDIVal.connect(),this.updateAvailableDevices()}catch(t){throw console.error("Failed to initialize MIDI:",t),t}}updateAvailableDevices(){if(!this.midiAccess?.outputs)return;this.availableOutputs=Array.from(this.midiAccess.outputs).map(e=>({id:e?.id||"",name:e?.name||"Unknown Device"}));const t=this.availableOutputs[0];!this.selectedDeviceId&&t&&this.selectDevice(t.id)}getAvailableDevices(){return this.availableOutputs}selectDevice(t){if(!this.midiAccess?.outputs)return;const e=Array.from(this.midiAccess.outputs).find(n=>n?.id===t);e&&(this.selectedDeviceId=t,this.midiOutput=new jv.MIDIValOutput(e))}getSelectedDeviceId(){return this.selectedDeviceId}setEnabled(t){this.midiEnabled=t}isEnabled(){return this.midiEnabled}sendNoteOn(t,e,n=0){if(!(!this.midiEnabled||!this.midiOutput))try{const s=e<=1?Math.round(e*127):e;this.midiOutput.sendNoteOn(t,Math.max(1,Math.min(127,s)),n)}catch(s){console.error("Failed to send MIDI note on:",s)}}sendNoteOff(t,e=0){if(!(!this.midiEnabled||!this.midiOutput))try{this.midiOutput.sendNoteOff(t,e)}catch(n){console.error("Failed to send MIDI note off:",n)}}disconnect(){this.midiOutput=null}}const pq={class:"layout"},gq={class:"piano-roll-row"},mq={class:"piano-roll-card"},Oq={class:"controls"},yq=["disabled","aria-pressed","title"],bq={class:"midi-control"},vq=["disabled"],_q={key:0,class:"midi-control"},xq=["disabled"],Sq=["value"],wq={class:"meta"},kq={class:"bottom-row"},Cq={class:"transform-card"},Tq={class:"chatbot-card"},Pq=.05,Aq=al({__name:"PianoRollDemo",setup(i){const t=[{id:"note-1",pitch:60,position:0,duration:1,velocity:110},{id:"note-2",pitch:64,position:0,duration:1,velocity:105},{id:"note-3",pitch:67,position:0,duration:1,velocity:108},{id:"note-4",pitch:72,position:0,duration:1,velocity:102},{id:"note-5",pitch:60,position:2,duration:1.5,velocity:110},{id:"note-6",pitch:67,position:2,duration:1.5,velocity:108},{id:"note-7",pitch:74,position:2,duration:1.5,velocity:104},{id:"note-8",pitch:62,position:4,duration:.5,velocity:99},{id:"note-9",pitch:65,position:4.5,duration:.5,velocity:98},{id:"note-10",pitch:69,position:5,duration:1,velocity:101},{id:"note-11",pitch:72,position:6,duration:1,velocity:102},{id:"note-12",pitch:79,position:6.5,duration:.75,velocity:96}],e=ue(null),n=Qo({notes:[],playheadPosition:0,queuePosition:0,grid:{maxLength:16,timeSignature:4,subdivision:16}}),s=ue(!1),r=fs(()=>s.value?"Playing":"Stopped"),o=fs(()=>n.notes.length>0),a=fs(()=>n.queuePosition.toFixed(2)),l=ue(!1),c=ue([]),h=ue("");let u=null;const f=new Set;let d=null,p=null,g=null,m=null,O=0;const y=()=>60/Ki.bpm.value,_=()=>Ki.bpm.value/60,v=()=>{g!==null&&(cancelAnimationFrame(g),g=null)},b=V=>{n.playheadPosition=V,e.value?.setLivePlayheadPosition(V)},k=V=>{n.queuePosition=V,s.value||b(V)},x=()=>{m!==null&&(Ki.clear(m),m=null),Ki.cancel()},C=(V=!0)=>{if(!(!s.value&&!p)&&(Ki.stop(),x(),p&&(p.stop(0),p.dispose(),p=null),v(),s.value=!1,u&&(f.forEach(X=>{u?.sendNoteOff(X)}),f.clear()),V)){const X=e.value?.getPlayStartPosition?.()??n.queuePosition??0;b(X)}},I=()=>{v();const V=()=>{if(!s.value)return;const X=Ki.seconds,j=O+X*_();b(j),g=requestAnimationFrame(V)};g=requestAnimationFrame(V)},R=async()=>{if(!o.value)return;d??=new TO(ja).toDestination(),await p7(),s.value&&C(!1),O=e.value?.getPlayStartPosition?.()??n.queuePosition;const V=n.notes.filter(it=>it.position+it.duration>O).map(it=>({note:it,offset:Math.max(0,it.position-O)}));if(!V.length){b(O);return}const X=y(),j=V.map(it=>{const _t=Math.max(0,Math.min(1,(it.note.velocity??100)/127));return{note:it.note,time:it.offset*X,velocity:_t,duration:Math.max(it.note.duration,.0625)*X}});p&&(p.stop(0),p.dispose(),p=null),x(),p=new Vf((it,_t)=>{if(!l.value){const Nt=_7(_t.note.pitch,"midi").toNote();d?.triggerAttackRelease(Nt,_t.duration,it,_t.velocity)}if(l.value&&u){const Nt=_t.note.pitch;u.sendNoteOn(Nt,_t.velocity),f.add(Nt);const Ot=u;Ki.scheduleOnce(()=>{Ot?.sendNoteOff(Nt),f.delete(Nt)},`+${_t.duration}`)}},j),p.start(0),Ki.stop(),Ki.position=0,Ki.start(`+${Pq.toFixed(3)}`),s.value=!0,b(O);const tt=j.reduce((it,_t)=>Math.max(it,_t.time+_t.duration),0);m=Ki.scheduleOnce(()=>{C()},tt+.1),I()},$=()=>{R().catch(V=>console.error(V))},E=()=>{C()},Z=V=>{const X=Array.from(V.notes.values()).map(j=>({id:j.id,pitch:j.pitch,position:j.position,duration:j.duration,velocity:j.velocity,selected:V.selection.selectedIds.has(j.id)})).sort((j,tt)=>j.position-tt.position);n.notes=X,n.grid.maxLength=V.grid.maxLength,n.grid.timeSignature=V.grid.timeSignature,n.grid.subdivision=V.grid.subdivision,k(V.queuePlayhead.position),C()},F=()=>n.notes.map(V=>({id:V.id,pitch:V.pitch,position:V.position,duration:V.duration,velocity:V.velocity??100,selected:V.selected})),W=V=>{e.value?.setNotes(V)},B=()=>({maxLength:n.grid.maxLength,timeSignature:n.grid.timeSignature,subdivision:n.grid.subdivision}),U=eq({getNotes:F,setNotes:W,getGrid:B});return Ad(async()=>{Ki.loop=!1,Ki.bpm.value=120;try{u=new dq,await u.initialize(),c.value=u.getAvailableDevices(),c.value.length>0&&(h.value=c.value[0]?.id||"",h.value&&u.selectDevice(h.value))}catch(V){console.warn("MIDI not available:",V)}Td(()=>{e.value&&(e.value.setNotes(t),e.value.fitZoomToNotes(),k(e.value.getPlayStartPosition?.()??0))})}),Z0(()=>{C(!1),x(),d?.dispose(),d=null,u?.disconnect(),u=null}),ti(l,V=>{u?.setEnabled(V)}),ti(h,V=>{V&&u&&u.selectDevice(V)}),(V,X)=>(It(),$t("div",pq,[Y("div",gq,[Y("section",mq,[Y("div",Oq,[Y("button",{class:Ln(["play-toggle",{playing:s.value}]),onClick:X[0]||(X[0]=j=>s.value?E():$()),disabled:!s.value&&!o.value,"aria-pressed":s.value,title:s.value?"Stop":"Play"},Pe(s.value?"Stop":"Play"),11,yq),Y("span",{class:Ln(["status",{playing:s.value}])},Pe(r.value),3),X[5]||(X[5]=Y("span",{class:"separator"},"|",-1)),Y("label",bq,[Rc(Y("input",{type:"checkbox","onUpdate:modelValue":X[1]||(X[1]=j=>l.value=j),disabled:c.value.length===0},null,8,vq),[[Y_,l.value]]),X[3]||(X[3]=Fi(" MIDI Out ",-1))]),c.value.length>0?(It(),$t("label",_q,[X[4]||(X[4]=Fi(" Device: ",-1)),Rc(Y("select",{"onUpdate:modelValue":X[2]||(X[2]=j=>h.value=j),disabled:!l.value},[(It(!0),$t(ci,null,yo(c.value,j=>(It(),$t("option",{key:j.id,value:j.id},Pe(j.name),9,Sq))),128))],8,xq),[[z0,h.value]])])):oi("",!0)]),X[7]||(X[7]=Y("p",{class:"note"},"Use the green queue playhead inside the roll to choose a start point, then press play.",-1)),Y("p",wq,[X[6]||(X[6]=Fi("Queue start (quarter notes): ",-1)),Y("span",null,Pe(a.value),1)]),We(JR,{ref_key:"pianoRollRef",ref:e,width:600,height:340,"show-control-panel":!0,interactive:!0,"sync-state":Z},null,512)])]),Y("div",kq,[Y("section",Cq,[We(cW,{registry:Re(U)},null,8,["registry"])]),Y("section",Tq,[We(gQ,{"get-notes":F,"set-notes":W,"get-grid":B,registry:Re(U)},null,8,["registry"])])])]))}}),Mq=xh(Aq,[["__scopeId","data-v-8fab6a03"]]),Eq={class:"page"},Rq=al({__name:"App",setup(i){return(t,e)=>(It(),$t("main",Eq,[e[0]||(e[0]=Y("h1",null,"LLM MIDI Mangler",-1)),e[1]||(e[1]=Y("div",{class:"description"},[Y("p",null,[Fi(" This is an LLM powered MIDI mangling workbench. A central piano roll lets you manually write out MIDI, and it is played back using "),Y("a",{href:"https://tonejs.github.io/",target:"_blank",rel:"noreferrer"},"Tone.js"),Fi(". A chatbot powered by Claude Sonnet can read and write from the piano roll with tool calls. Additionally, there is a workbench at the bottom of the page that lets you define custom functions for transforming the piano roll. The chatbot can write new functions into specific slots, or can even call your functions as tools (instead of generating raw MIDI as an LLM response). You can also manually apply your transformation functions with the controls under the text editor. "),Y("br"),Y("br"),Fi(" The source code for this is on "),Y("a",{href:"https://github.com/AvneeshSarwate/pianoRollChatbot",target:"_blank",rel:"noreferrer"},"GitHub"),Fi(". ")])],-1)),We(Mq)]))}}),Iq=xh(Rq,[["__scopeId","data-v-059df724"]]);FP(Iq).mount("#app");
