(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function _0(i){const t=Object.create(null);for(const e of i.split(","))t[e]=1;return e=>e in t}const oe={},va=[],On=()=>{},F_=()=>!1,yd=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&(i.charCodeAt(2)>122||i.charCodeAt(2)<97),x0=i=>i.startsWith("onUpdate:"),gi=Object.assign,S0=(i,t)=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)},c3=Object.prototype.hasOwnProperty,Ht=(i,t)=>c3.call(i,t),St=Array.isArray,_a=i=>Hc(i)==="[object Map]",Ua=i=>Hc(i)==="[object Set]",R1=i=>Hc(i)==="[object Date]",It=i=>typeof i=="function",Ze=i=>typeof i=="string",vn=i=>typeof i=="symbol",ae=i=>i!==null&&typeof i=="object",W_=i=>(ae(i)||It(i))&&It(i.then)&&It(i.catch),q_=Object.prototype.toString,Hc=i=>q_.call(i),h3=i=>Hc(i).slice(8,-1),X_=i=>Hc(i)==="[object Object]",w0=i=>Ze(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,tc=_0(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),bd=i=>{const t=Object.create(null);return(e=>t[e]||(t[e]=i(e)))},u3=/-\w/g,Lr=bd(i=>i.replace(u3,t=>t.slice(1).toUpperCase())),f3=/\B([A-Z])/g,Lo=bd(i=>i.replace(f3,"-$1").toLowerCase()),z_=bd(i=>i.charAt(0).toUpperCase()+i.slice(1)),vp=bd(i=>i?`on${z_(i)}`:""),Ir=(i,t)=>!Object.is(i,t),Zu=(i,...t)=>{for(let e=0;e<i.length;e++)i[e](...t)},j_=(i,t,e,s=!1)=>{Object.defineProperty(i,t,{configurable:!0,enumerable:!1,writable:s,value:e})},cf=i=>{const t=parseFloat(i);return isNaN(t)?i:t};let Q1;const vd=()=>Q1||(Q1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function kr(i){if(St(i)){const t={};for(let e=0;e<i.length;e++){const s=i[e],n=Ze(s)?m3(s):kr(s);if(n)for(const r in n)t[r]=n[r]}return t}else if(Ze(i)||ae(i))return i}const d3=/;(?![^(]*\))/g,p3=/:([^]+)/,g3=/\/\*[^]*?\*\//g;function m3(i){const t={};return i.replace(g3,"").split(d3).forEach(e=>{if(e){const s=e.split(p3);s.length>1&&(t[s[0].trim()]=s[1].trim())}}),t}function Ds(i){let t="";if(Ze(i))t=i;else if(St(i))for(let e=0;e<i.length;e++){const s=Ds(i[e]);s&&(t+=s+" ")}else if(ae(i))for(const e in i)i[e]&&(t+=e+" ");return t.trim()}const O3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",y3=_0(O3);function G_(i){return!!i||i===""}function b3(i,t){if(i.length!==t.length)return!1;let e=!0;for(let s=0;e&&s<i.length;s++)e=Ao(i[s],t[s]);return e}function Ao(i,t){if(i===t)return!0;let e=R1(i),s=R1(t);if(e||s)return e&&s?i.getTime()===t.getTime():!1;if(e=vn(i),s=vn(t),e||s)return i===t;if(e=St(i),s=St(t),e||s)return e&&s?b3(i,t):!1;if(e=ae(i),s=ae(t),e||s){if(!e||!s)return!1;const n=Object.keys(i).length,r=Object.keys(t).length;if(n!==r)return!1;for(const o in i){const a=i.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!Ao(i[o],t[o]))return!1}}return String(i)===String(t)}function k0(i,t){return i.findIndex(e=>Ao(e,t))}const Y_=i=>!!(i&&i.__v_isRef===!0),Ie=i=>Ze(i)?i:i==null?"":St(i)||ae(i)&&(i.toString===q_||!It(i.toString))?Y_(i)?Ie(i.value):JSON.stringify(i,U_,2):String(i),U_=(i,t)=>Y_(t)?U_(i,t.value):_a(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[s,n],r)=>(e[_p(s,r)+" =>"]=n,e),{})}:Ua(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>_p(e))}:vn(t)?_p(t):ae(t)&&!St(t)&&!X_(t)?String(t):t,_p=(i,t="")=>{var e;return vn(i)?`Symbol(${(e=i.description)!=null?e:t})`:i};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Li;class v3{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Li,!t&&Li&&(this.index=(Li.scopes||(Li.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].pause();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,e;if(this.scopes)for(t=0,e=this.scopes.length;t<e;t++)this.scopes[t].resume();for(t=0,e=this.effects.length;t<e;t++)this.effects[t].resume()}}run(t){if(this._active){const e=Li;try{return Li=this,t()}finally{Li=e}}}on(){++this._on===1&&(this.prevScope=Li,Li=this)}off(){this._on>0&&--this._on===0&&(Li=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let e,s;for(e=0,s=this.effects.length;e<s;e++)this.effects[e].stop();for(this.effects.length=0,e=0,s=this.cleanups.length;e<s;e++)this.cleanups[e]();if(this.cleanups.length=0,this.scopes){for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function _3(){return Li}let ue;const xp=new WeakSet;class H_{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Li&&Li.active&&Li.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,xp.has(this)&&(xp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||J_(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,I1(this),tx(this);const t=ue,e=Ls;ue=this,Ls=!0;try{return this.fn()}finally{ex(this),ue=t,Ls=e,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)P0(t);this.deps=this.depsTail=void 0,I1(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?xp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Mg(this)&&this.run()}get dirty(){return Mg(this)}}let K_=0,ec,ic;function J_(i,t=!1){if(i.flags|=8,t){i.next=ic,ic=i;return}i.next=ec,ec=i}function C0(){K_++}function T0(){if(--K_>0)return;if(ic){let t=ic;for(ic=void 0;t;){const e=t.next;t.next=void 0,t.flags&=-9,t=e}}let i;for(;ec;){let t=ec;for(ec=void 0;t;){const e=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(s){i||(i=s)}t=e}}if(i)throw i}function tx(i){for(let t=i.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function ex(i){let t,e=i.depsTail,s=e;for(;s;){const n=s.prevDep;s.version===-1?(s===e&&(e=n),P0(s),x3(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=n}i.deps=t,i.depsTail=e}function Mg(i){for(let t=i.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(ix(t.dep.computed)||t.dep.version!==t.version))return!0;return!!i._dirty}function ix(i){if(i.flags&4&&!(i.flags&16)||(i.flags&=-17,i.globalVersion===vc)||(i.globalVersion=vc,!i.isSSR&&i.flags&128&&(!i.deps&&!i._dirty||!Mg(i))))return;i.flags|=2;const t=i.dep,e=ue,s=Ls;ue=i,Ls=!0;try{tx(i);const n=i.fn(i._value);(t.version===0||Ir(n,i._value))&&(i.flags|=128,i._value=n,t.version++)}catch(n){throw t.version++,n}finally{ue=e,Ls=s,ex(i),i.flags&=-3}}function P0(i,t=!1){const{dep:e,prevSub:s,nextSub:n}=i;if(s&&(s.nextSub=n,i.prevSub=void 0),n&&(n.prevSub=s,i.nextSub=void 0),e.subs===i&&(e.subs=s,!s&&e.computed)){e.computed.flags&=-5;for(let r=e.computed.deps;r;r=r.nextDep)P0(r,!0)}!t&&!--e.sc&&e.map&&e.map.delete(e.key)}function x3(i){const{prevDep:t,nextDep:e}=i;t&&(t.nextDep=e,i.prevDep=void 0),e&&(e.prevDep=t,i.nextDep=void 0)}let Ls=!0;const sx=[];function jn(){sx.push(Ls),Ls=!1}function Gn(){const i=sx.pop();Ls=i===void 0?!0:i}function I1(i){const{cleanup:t}=i;if(i.cleanup=void 0,t){const e=ue;ue=void 0;try{t()}finally{ue=e}}}let vc=0;class S3{constructor(t,e){this.sub=t,this.dep=e,this.version=e.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class A0{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!ue||!Ls||ue===this.computed)return;let e=this.activeLink;if(e===void 0||e.sub!==ue)e=this.activeLink=new S3(ue,this),ue.deps?(e.prevDep=ue.depsTail,ue.depsTail.nextDep=e,ue.depsTail=e):ue.deps=ue.depsTail=e,nx(e);else if(e.version===-1&&(e.version=this.version,e.nextDep)){const s=e.nextDep;s.prevDep=e.prevDep,e.prevDep&&(e.prevDep.nextDep=s),e.prevDep=ue.depsTail,e.nextDep=void 0,ue.depsTail.nextDep=e,ue.depsTail=e,ue.deps===e&&(ue.deps=s)}return e}trigger(t){this.version++,vc++,this.notify(t)}notify(t){C0();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{T0()}}}function nx(i){if(i.dep.sc++,i.sub.flags&4){const t=i.dep.computed;if(t&&!i.dep.subs){t.flags|=20;for(let s=t.deps;s;s=s.nextDep)nx(s)}const e=i.dep.subs;e!==i&&(i.prevSub=e,e&&(e.nextSub=i)),i.dep.subs=i}}const Eg=new WeakMap,wo=Symbol(""),Rg=Symbol(""),_c=Symbol("");function ci(i,t,e){if(Ls&&ue){let s=Eg.get(i);s||Eg.set(i,s=new Map);let n=s.get(e);n||(s.set(e,n=new A0),n.map=s,n.key=e),n.track()}}function Bn(i,t,e,s,n,r){const o=Eg.get(i);if(!o){vc++;return}const a=l=>{l&&l.trigger()};if(C0(),t==="clear")o.forEach(a);else{const l=St(i),c=l&&w0(e);if(l&&e==="length"){const h=Number(s);o.forEach((u,f)=>{(f==="length"||f===_c||!vn(f)&&f>=h)&&a(u)})}else switch((e!==void 0||o.has(void 0))&&a(o.get(e)),c&&a(o.get(_c)),t){case"add":l?c&&a(o.get("length")):(a(o.get(wo)),_a(i)&&a(o.get(Rg)));break;case"delete":l||(a(o.get(wo)),_a(i)&&a(o.get(Rg)));break;case"set":_a(i)&&a(o.get(wo));break}}T0()}function Uo(i){const t=Gt(i);return t===i?t:(ci(t,"iterate",_c),xs(i)?t:t.map(ei))}function _d(i){return ci(i=Gt(i),"iterate",_c),i}const w3={__proto__:null,[Symbol.iterator](){return Sp(this,Symbol.iterator,ei)},concat(...i){return Uo(this).concat(...i.map(t=>St(t)?Uo(t):t))},entries(){return Sp(this,"entries",i=>(i[1]=ei(i[1]),i))},every(i,t){return Qn(this,"every",i,t,void 0,arguments)},filter(i,t){return Qn(this,"filter",i,t,e=>e.map(ei),arguments)},find(i,t){return Qn(this,"find",i,t,ei,arguments)},findIndex(i,t){return Qn(this,"findIndex",i,t,void 0,arguments)},findLast(i,t){return Qn(this,"findLast",i,t,ei,arguments)},findLastIndex(i,t){return Qn(this,"findLastIndex",i,t,void 0,arguments)},forEach(i,t){return Qn(this,"forEach",i,t,void 0,arguments)},includes(...i){return wp(this,"includes",i)},indexOf(...i){return wp(this,"indexOf",i)},join(i){return Uo(this).join(i)},lastIndexOf(...i){return wp(this,"lastIndexOf",i)},map(i,t){return Qn(this,"map",i,t,void 0,arguments)},pop(){return gl(this,"pop")},push(...i){return gl(this,"push",i)},reduce(i,...t){return $1(this,"reduce",i,t)},reduceRight(i,...t){return $1(this,"reduceRight",i,t)},shift(){return gl(this,"shift")},some(i,t){return Qn(this,"some",i,t,void 0,arguments)},splice(...i){return gl(this,"splice",i)},toReversed(){return Uo(this).toReversed()},toSorted(i){return Uo(this).toSorted(i)},toSpliced(...i){return Uo(this).toSpliced(...i)},unshift(...i){return gl(this,"unshift",i)},values(){return Sp(this,"values",ei)}};function Sp(i,t,e){const s=_d(i),n=s[t]();return s!==i&&!xs(i)&&(n._next=n.next,n.next=()=>{const r=n._next();return r.done||(r.value=e(r.value)),r}),n}const k3=Array.prototype;function Qn(i,t,e,s,n,r){const o=_d(i),a=o!==i&&!xs(i),l=o[t];if(l!==k3[t]){const u=l.apply(i,r);return a?ei(u):u}let c=e;o!==i&&(a?c=function(u,f){return e.call(this,ei(u),f,i)}:e.length>2&&(c=function(u,f){return e.call(this,u,f,i)}));const h=l.call(o,c,s);return a&&n?n(h):h}function $1(i,t,e,s){const n=_d(i);let r=e;return n!==i&&(xs(i)?e.length>3&&(r=function(o,a,l){return e.call(this,o,a,l,i)}):r=function(o,a,l){return e.call(this,o,ei(a),l,i)}),n[t](r,...s)}function wp(i,t,e){const s=Gt(i);ci(s,"iterate",_c);const n=s[t](...e);return(n===-1||n===!1)&&R0(e[0])?(e[0]=Gt(e[0]),s[t](...e)):n}function gl(i,t,e=[]){jn(),C0();const s=Gt(i)[t].apply(i,e);return T0(),Gn(),s}const C3=_0("__proto__,__v_isRef,__isVue"),rx=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(vn));function T3(i){vn(i)||(i=String(i));const t=Gt(this);return ci(t,"has",i),t.hasOwnProperty(i)}class ox{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,s){if(e==="__v_skip")return t.__v_skip;const n=this._isReadonly,r=this._isShallow;if(e==="__v_isReactive")return!n;if(e==="__v_isReadonly")return n;if(e==="__v_isShallow")return r;if(e==="__v_raw")return s===(n?r?D3:hx:r?cx:lx).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(s)?t:void 0;const o=St(t);if(!n){let l;if(o&&(l=w3[e]))return l;if(e==="hasOwnProperty")return T3}const a=Reflect.get(t,e,di(t)?t:s);if((vn(e)?rx.has(e):C3(e))||(n||ci(t,"get",e),r))return a;if(di(a)){const l=o&&w0(e)?a:a.value;return n&&ae(l)?Ig(l):l}return ae(a)?n?Ig(a):Mo(a):a}}class ax extends ox{constructor(t=!1){super(!1,t)}set(t,e,s,n){let r=t[e];if(!this._isShallow){const l=Vr(r);if(!xs(s)&&!Vr(s)&&(r=Gt(r),s=Gt(s)),!St(t)&&di(r)&&!di(s))return l||(r.value=s),!0}const o=St(t)&&w0(e)?Number(e)<t.length:Ht(t,e),a=Reflect.set(t,e,s,di(t)?t:n);return t===Gt(n)&&(o?Ir(s,r)&&Bn(t,"set",e,s):Bn(t,"add",e,s)),a}deleteProperty(t,e){const s=Ht(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&s&&Bn(t,"delete",e,void 0),n}has(t,e){const s=Reflect.has(t,e);return(!vn(e)||!rx.has(e))&&ci(t,"has",e),s}ownKeys(t){return ci(t,"iterate",St(t)?"length":wo),Reflect.ownKeys(t)}}class P3 extends ox{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const A3=new ax,M3=new P3,E3=new ax(!0);const Qg=i=>i,$h=i=>Reflect.getPrototypeOf(i);function R3(i,t,e){return function(...s){const n=this.__v_raw,r=Gt(n),o=_a(r),a=i==="entries"||i===Symbol.iterator&&o,l=i==="keys"&&o,c=n[i](...s),h=e?Qg:t?hf:ei;return!t&&ci(r,"iterate",l?Rg:wo),{next(){const{value:u,done:f}=c.next();return f?{value:u,done:f}:{value:a?[h(u[0]),h(u[1])]:h(u),done:f}},[Symbol.iterator](){return this}}}}function Nh(i){return function(...t){return i==="delete"?!1:i==="clear"?void 0:this}}function Q3(i,t){const e={get(n){const r=this.__v_raw,o=Gt(r),a=Gt(n);i||(Ir(n,a)&&ci(o,"get",n),ci(o,"get",a));const{has:l}=$h(o),c=t?Qg:i?hf:ei;if(l.call(o,n))return c(r.get(n));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(n)},get size(){const n=this.__v_raw;return!i&&ci(Gt(n),"iterate",wo),n.size},has(n){const r=this.__v_raw,o=Gt(r),a=Gt(n);return i||(Ir(n,a)&&ci(o,"has",n),ci(o,"has",a)),n===a?r.has(n):r.has(n)||r.has(a)},forEach(n,r){const o=this,a=o.__v_raw,l=Gt(a),c=t?Qg:i?hf:ei;return!i&&ci(l,"iterate",wo),a.forEach((h,u)=>n.call(r,c(h),c(u),o))}};return gi(e,i?{add:Nh("add"),set:Nh("set"),delete:Nh("delete"),clear:Nh("clear")}:{add(n){!t&&!xs(n)&&!Vr(n)&&(n=Gt(n));const r=Gt(this);return $h(r).has.call(r,n)||(r.add(n),Bn(r,"add",n,n)),this},set(n,r){!t&&!xs(r)&&!Vr(r)&&(r=Gt(r));const o=Gt(this),{has:a,get:l}=$h(o);let c=a.call(o,n);c||(n=Gt(n),c=a.call(o,n));const h=l.call(o,n);return o.set(n,r),c?Ir(r,h)&&Bn(o,"set",n,r):Bn(o,"add",n,r),this},delete(n){const r=Gt(this),{has:o,get:a}=$h(r);let l=o.call(r,n);l||(n=Gt(n),l=o.call(r,n)),a&&a.call(r,n);const c=r.delete(n);return l&&Bn(r,"delete",n,void 0),c},clear(){const n=Gt(this),r=n.size!==0,o=n.clear();return r&&Bn(n,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(n=>{e[n]=R3(n,i,t)}),e}function M0(i,t){const e=Q3(i,t);return(s,n,r)=>n==="__v_isReactive"?!i:n==="__v_isReadonly"?i:n==="__v_raw"?s:Reflect.get(Ht(e,n)&&n in s?e:s,n,r)}const I3={get:M0(!1,!1)},$3={get:M0(!1,!0)},N3={get:M0(!0,!1)};const lx=new WeakMap,cx=new WeakMap,hx=new WeakMap,D3=new WeakMap;function L3(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function V3(i){return i.__v_skip||!Object.isExtensible(i)?0:L3(h3(i))}function Mo(i){return Vr(i)?i:E0(i,!1,A3,I3,lx)}function B3(i){return E0(i,!1,E3,$3,cx)}function Ig(i){return E0(i,!0,M3,N3,hx)}function E0(i,t,e,s,n){if(!ae(i)||i.__v_raw&&!(t&&i.__v_isReactive))return i;const r=V3(i);if(r===0)return i;const o=n.get(i);if(o)return o;const a=new Proxy(i,r===2?s:e);return n.set(i,a),a}function xa(i){return Vr(i)?xa(i.__v_raw):!!(i&&i.__v_isReactive)}function Vr(i){return!!(i&&i.__v_isReadonly)}function xs(i){return!!(i&&i.__v_isShallow)}function R0(i){return i?!!i.__v_raw:!1}function Gt(i){const t=i&&i.__v_raw;return t?Gt(t):i}function Z3(i){return!Ht(i,"__v_skip")&&Object.isExtensible(i)&&j_(i,"__v_skip",!0),i}const ei=i=>ae(i)?Mo(i):i,hf=i=>ae(i)?Ig(i):i;function di(i){return i?i.__v_isRef===!0:!1}function Xt(i){return ux(i,!1)}function kp(i){return ux(i,!0)}function ux(i,t){return di(i)?i:new F3(i,t)}class F3{constructor(t,e){this.dep=new A0,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=e?t:Gt(t),this._value=e?t:ei(t),this.__v_isShallow=e}get value(){return this.dep.track(),this._value}set value(t){const e=this._rawValue,s=this.__v_isShallow||xs(t)||Vr(t);t=s?t:Gt(t),Ir(t,e)&&(this._rawValue=t,this._value=s?t:ei(t),this.dep.trigger())}}function Te(i){return di(i)?i.value:i}const W3={get:(i,t,e)=>t==="__v_raw"?i:Te(Reflect.get(i,t,e)),set:(i,t,e,s)=>{const n=i[t];return di(n)&&!di(e)?(n.value=e,!0):Reflect.set(i,t,e,s)}};function fx(i){return xa(i)?i:new Proxy(i,W3)}class q3{constructor(t,e,s){this.fn=t,this.setter=e,this._value=void 0,this.dep=new A0(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=vc-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!e,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&ue!==this)return J_(this,!0),!0}get value(){const t=this.dep.track();return ix(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function X3(i,t,e=!1){let s,n;return It(i)?s=i:(s=i.get,n=i.set),new q3(s,n,e)}const Dh={},uf=new WeakMap;let fo;function z3(i,t=!1,e=fo){if(e){let s=uf.get(e);s||uf.set(e,s=[]),s.push(i)}}function j3(i,t,e=oe){const{immediate:s,deep:n,once:r,scheduler:o,augmentJob:a,call:l}=e,c=v=>n?v:xs(v)||n===!1||n===0?Zn(v,1):Zn(v);let h,u,f,d,p=!1,g=!1;if(di(i)?(u=()=>i.value,p=xs(i)):xa(i)?(u=()=>c(i),p=!0):St(i)?(g=!0,p=i.some(v=>xa(v)||xs(v)),u=()=>i.map(v=>{if(di(v))return v.value;if(xa(v))return c(v);if(It(v))return l?l(v,2):v()})):It(i)?t?u=l?()=>l(i,2):i:u=()=>{if(f){jn();try{f()}finally{Gn()}}const v=fo;fo=h;try{return l?l(i,3,[d]):i(d)}finally{fo=v}}:u=On,t&&n){const v=u,y=n===!0?1/0:n;u=()=>Zn(v(),y)}const m=_3(),O=()=>{h.stop(),m&&m.active&&S0(m.effects,h)};if(r&&t){const v=t;t=(...y)=>{v(...y),O()}}let b=g?new Array(i.length).fill(Dh):Dh;const x=v=>{if(!(!(h.flags&1)||!h.dirty&&!v))if(t){const y=h.run();if(n||p||(g?y.some((_,S)=>Ir(_,b[S])):Ir(y,b))){f&&f();const _=fo;fo=h;try{const S=[y,b===Dh?void 0:g&&b[0]===Dh?[]:b,d];b=y,l?l(t,3,S):t(...S)}finally{fo=_}}}else h.run()};return a&&a(x),h=new H_(u),h.scheduler=o?()=>o(x,!1):x,d=v=>z3(v,!1,h),f=h.onStop=()=>{const v=uf.get(h);if(v){if(l)l(v,4);else for(const y of v)y();uf.delete(h)}},t?s?x(!0):b=h.run():o?o(x.bind(null,!0),!0):h.run(),O.pause=h.pause.bind(h),O.resume=h.resume.bind(h),O.stop=O,O}function Zn(i,t=1/0,e){if(t<=0||!ae(i)||i.__v_skip||(e=e||new Map,(e.get(i)||0)>=t))return i;if(e.set(i,t),t--,di(i))Zn(i.value,t,e);else if(St(i))for(let s=0;s<i.length;s++)Zn(i[s],t,e);else if(Ua(i)||_a(i))i.forEach(s=>{Zn(s,t,e)});else if(X_(i)){for(const s in i)Zn(i[s],t,e);for(const s of Object.getOwnPropertySymbols(i))Object.prototype.propertyIsEnumerable.call(i,s)&&Zn(i[s],t,e)}return i}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Kc(i,t,e,s){try{return s?i(...s):i()}catch(n){xd(n,t,e)}}function _n(i,t,e,s){if(It(i)){const n=Kc(i,t,e,s);return n&&W_(n)&&n.catch(r=>{xd(r,t,e)}),n}if(St(i)){const n=[];for(let r=0;r<i.length;r++)n.push(_n(i[r],t,e,s));return n}}function xd(i,t,e,s=!0){const n=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||oe;if(t){let a=t.parent;const l=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${e}`;for(;a;){const h=a.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](i,l,c)===!1)return}a=a.parent}if(r){jn(),Kc(r,null,10,[i,l,c]),Gn();return}}G3(i,e,n,s,o)}function G3(i,t,e,s=!0,n=!1){if(n)throw i;console.error(i)}const wi=[];let an=-1;const Sa=[];let vr=null,ra=0;const dx=Promise.resolve();let ff=null;function Sd(i){const t=ff||dx;return i?t.then(this?i.bind(this):i):t}function Y3(i){let t=an+1,e=wi.length;for(;t<e;){const s=t+e>>>1,n=wi[s],r=xc(n);r<i||r===i&&n.flags&2?t=s+1:e=s}return t}function Q0(i){if(!(i.flags&1)){const t=xc(i),e=wi[wi.length-1];!e||!(i.flags&2)&&t>=xc(e)?wi.push(i):wi.splice(Y3(t),0,i),i.flags|=1,px()}}function px(){ff||(ff=dx.then(mx))}function U3(i){St(i)?Sa.push(...i):vr&&i.id===-1?vr.splice(ra+1,0,i):i.flags&1||(Sa.push(i),i.flags|=1),px()}function N1(i,t,e=an+1){for(;e<wi.length;e++){const s=wi[e];if(s&&s.flags&2){if(i&&s.id!==i.uid)continue;wi.splice(e,1),e--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function gx(i){if(Sa.length){const t=[...new Set(Sa)].sort((e,s)=>xc(e)-xc(s));if(Sa.length=0,vr){vr.push(...t);return}for(vr=t,ra=0;ra<vr.length;ra++){const e=vr[ra];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}vr=null,ra=0}}const xc=i=>i.id==null?i.flags&2?-1:1/0:i.id;function mx(i){try{for(an=0;an<wi.length;an++){const t=wi[an];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Kc(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;an<wi.length;an++){const t=wi[an];t&&(t.flags&=-2)}an=-1,wi.length=0,gx(),ff=null,(wi.length||Sa.length)&&mx()}}let ys=null,Ox=null;function df(i){const t=ys;return ys=i,Ox=i&&i.type.__scopeId||null,t}function H3(i,t=ys,e){if(!t||i._n)return i;const s=(...n)=>{s._d&&mf(-1);const r=df(t);let o;try{o=i(...n)}finally{df(r),s._d&&mf(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function Ar(i,t){if(ys===null)return i;const e=Pd(ys),s=i.dirs||(i.dirs=[]);for(let n=0;n<t.length;n++){let[r,o,a,l=oe]=t[n];r&&(It(r)&&(r={mounted:r,updated:r}),r.deep&&Zn(o),s.push({dir:r,instance:e,value:o,oldValue:void 0,arg:a,modifiers:l}))}return i}function ao(i,t,e,s){const n=i.dirs,r=t&&t.dirs;for(let o=0;o<n.length;o++){const a=n[o];r&&(a.oldValue=r[o].value);let l=a.dir[s];l&&(jn(),_n(l,e,8,[i.el,a,i,t]),Gn())}}const K3=Symbol("_vte"),J3=i=>i.__isTeleport,tT=Symbol("_leaveCb");function I0(i,t){i.shapeFlag&6&&i.component?(i.transition=t,I0(i.component.subTree,t)):i.shapeFlag&128?(i.ssContent.transition=t.clone(i.ssContent),i.ssFallback.transition=t.clone(i.ssFallback)):i.transition=t}function Vo(i,t){return It(i)?gi({name:i.name},t,{setup:i}):i}function yx(i){i.ids=[i.ids[0]+i.ids[2]+++"-",0,0]}const pf=new WeakMap;function sc(i,t,e,s,n=!1){if(St(i)){i.forEach((p,g)=>sc(p,t&&(St(t)?t[g]:t),e,s,n));return}if(nc(s)&&!n){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&sc(i,t,e,s.component.subTree);return}const r=s.shapeFlag&4?Pd(s.component):s.el,o=n?null:r,{i:a,r:l}=i,c=t&&t.r,h=a.refs===oe?a.refs={}:a.refs,u=a.setupState,f=Gt(u),d=u===oe?F_:p=>Ht(f,p);if(c!=null&&c!==l){if(D1(t),Ze(c))h[c]=null,d(c)&&(u[c]=null);else if(di(c)){c.value=null;const p=t;p.k&&(h[p.k]=null)}}if(It(l))Kc(l,a,12,[o,h]);else{const p=Ze(l),g=di(l);if(p||g){const m=()=>{if(i.f){const O=p?d(l)?u[l]:h[l]:l.value;if(n)St(O)&&S0(O,r);else if(St(O))O.includes(r)||O.push(r);else if(p)h[l]=[r],d(l)&&(u[l]=h[l]);else{const b=[r];l.value=b,i.k&&(h[i.k]=b)}}else p?(h[l]=o,d(l)&&(u[l]=o)):g&&(l.value=o,i.k&&(h[i.k]=o))};if(o){const O=()=>{m(),pf.delete(i)};O.id=-1,pf.set(i,O),is(O,e)}else D1(i),m()}}}function D1(i){const t=pf.get(i);t&&(t.flags|=8,pf.delete(i))}vd().requestIdleCallback;vd().cancelIdleCallback;const nc=i=>!!i.type.__asyncLoader,bx=i=>i.type.__isKeepAlive;function eT(i,t){vx(i,"a",t)}function iT(i,t){vx(i,"da",t)}function vx(i,t,e=Ti){const s=i.__wdc||(i.__wdc=()=>{let n=e;for(;n;){if(n.isDeactivated)return;n=n.parent}return i()});if(wd(t,s,e),e){let n=e.parent;for(;n&&n.parent;)bx(n.parent.vnode)&&sT(s,t,e,n),n=n.parent}}function sT(i,t,e,s){const n=wd(t,i,s,!0);kd(()=>{S0(s[t],n)},e)}function wd(i,t,e=Ti,s=!1){if(e){const n=e[i]||(e[i]=[]),r=t.__weh||(t.__weh=(...o)=>{jn();const a=th(e),l=_n(t,e,i,o);return a(),Gn(),l});return s?n.unshift(r):n.push(r),r}}const nr=i=>(t,e=Ti)=>{(!wc||i==="sp")&&wd(i,(...s)=>t(...s),e)},nT=nr("bm"),Jc=nr("m"),rT=nr("bu"),oT=nr("u"),$0=nr("bum"),kd=nr("um"),aT=nr("sp"),lT=nr("rtg"),cT=nr("rtc");function hT(i,t=Ti){wd("ec",i,t)}const uT=Symbol.for("v-ndc");function Cr(i,t,e,s){let n;const r=e,o=St(i);if(o||Ze(i)){const a=o&&xa(i);let l=!1,c=!1;a&&(l=!xs(i),c=Vr(i),i=_d(i)),n=new Array(i.length);for(let h=0,u=i.length;h<u;h++)n[h]=t(l?c?hf(ei(i[h])):ei(i[h]):i[h],h,void 0,r)}else if(typeof i=="number"){n=new Array(i);for(let a=0;a<i;a++)n[a]=t(a+1,a,void 0,r)}else if(ae(i))if(i[Symbol.iterator])n=Array.from(i,(a,l)=>t(a,l,void 0,r));else{const a=Object.keys(i);n=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];n[l]=t(i[h],h,l,r)}}else n=[];return n}const $g=i=>i?Zx(i)?Pd(i):$g(i.parent):null,rc=gi(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>$g(i.parent),$root:i=>$g(i.root),$host:i=>i.ce,$emit:i=>i.emit,$options:i=>xx(i),$forceUpdate:i=>i.f||(i.f=()=>{Q0(i.update)}),$nextTick:i=>i.n||(i.n=Sd.bind(i.proxy)),$watch:i=>QT.bind(i)}),Cp=(i,t)=>i!==oe&&!i.__isScriptSetup&&Ht(i,t),fT={get({_:i},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:s,data:n,props:r,accessCache:o,type:a,appContext:l}=i;let c;if(t[0]!=="$"){const d=o[t];if(d!==void 0)switch(d){case 1:return s[t];case 2:return n[t];case 4:return e[t];case 3:return r[t]}else{if(Cp(s,t))return o[t]=1,s[t];if(n!==oe&&Ht(n,t))return o[t]=2,n[t];if((c=i.propsOptions[0])&&Ht(c,t))return o[t]=3,r[t];if(e!==oe&&Ht(e,t))return o[t]=4,e[t];Ng&&(o[t]=0)}}const h=rc[t];let u,f;if(h)return t==="$attrs"&&ci(i.attrs,"get",""),h(i);if((u=a.__cssModules)&&(u=u[t]))return u;if(e!==oe&&Ht(e,t))return o[t]=4,e[t];if(f=l.config.globalProperties,Ht(f,t))return f[t]},set({_:i},t,e){const{data:s,setupState:n,ctx:r}=i;return Cp(n,t)?(n[t]=e,!0):s!==oe&&Ht(s,t)?(s[t]=e,!0):Ht(i.props,t)||t[0]==="$"&&t.slice(1)in i?!1:(r[t]=e,!0)},has({_:{data:i,setupState:t,accessCache:e,ctx:s,appContext:n,propsOptions:r,type:o}},a){let l,c;return!!(e[a]||i!==oe&&a[0]!=="$"&&Ht(i,a)||Cp(t,a)||(l=r[0])&&Ht(l,a)||Ht(s,a)||Ht(rc,a)||Ht(n.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(i,t,e){return e.get!=null?i._.accessCache[t]=0:Ht(e,"value")&&this.set(i,t,e.value,null),Reflect.defineProperty(i,t,e)}};function L1(i){return St(i)?i.reduce((t,e)=>(t[e]=null,t),{}):i}let Ng=!0;function dT(i){const t=xx(i),e=i.proxy,s=i.ctx;Ng=!1,t.beforeCreate&&V1(t.beforeCreate,i,"bc");const{data:n,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:u,mounted:f,beforeUpdate:d,updated:p,activated:g,deactivated:m,beforeDestroy:O,beforeUnmount:b,destroyed:x,unmounted:v,render:y,renderTracked:_,renderTriggered:S,errorCaptured:k,serverPrefetch:A,expose:M,inheritAttrs:R,components:C,directives:$,filters:N}=t;if(c&&pT(c,s,null),o)for(const Z in o){const F=o[Z];It(F)&&(s[Z]=F.bind(e))}if(n){const Z=n.call(e,e);ae(Z)&&(i.data=Mo(Z))}if(Ng=!0,r)for(const Z in r){const F=r[Z],z=It(F)?F.bind(e,e):It(F.get)?F.get.bind(e,e):On,et=!It(F)&&It(F.set)?F.set.bind(e):On,K=Rs({get:z,set:et});Object.defineProperty(s,Z,{enumerable:!0,configurable:!0,get:()=>K.value,set:ot=>K.value=ot})}if(a)for(const Z in a)_x(a[Z],s,e,Z);if(l){const Z=It(l)?l.call(e):l;Reflect.ownKeys(Z).forEach(F=>{vT(F,Z[F])})}h&&V1(h,i,"c");function I(Z,F){St(F)?F.forEach(z=>Z(z.bind(e))):F&&Z(F.bind(e))}if(I(nT,u),I(Jc,f),I(rT,d),I(oT,p),I(eT,g),I(iT,m),I(hT,k),I(cT,_),I(lT,S),I($0,b),I(kd,v),I(aT,A),St(M))if(M.length){const Z=i.exposed||(i.exposed={});M.forEach(F=>{Object.defineProperty(Z,F,{get:()=>e[F],set:z=>e[F]=z,enumerable:!0})})}else i.exposed||(i.exposed={});y&&i.render===On&&(i.render=y),R!=null&&(i.inheritAttrs=R),C&&(i.components=C),$&&(i.directives=$),A&&yx(i)}function pT(i,t,e=On){St(i)&&(i=Dg(i));for(const s in i){const n=i[s];let r;ae(n)?"default"in n?r=oc(n.from||s,n.default,!0):r=oc(n.from||s):r=oc(n),di(r)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):t[s]=r}}function V1(i,t,e){_n(St(i)?i.map(s=>s.bind(t.proxy)):i.bind(t.proxy),t,e)}function _x(i,t,e,s){let n=s.includes(".")?$x(e,s):()=>e[s];if(Ze(i)){const r=t[i];It(r)&&We(n,r)}else if(It(i))We(n,i.bind(e));else if(ae(i))if(St(i))i.forEach(r=>_x(r,t,e,s));else{const r=It(i.handler)?i.handler.bind(e):t[i.handler];It(r)&&We(n,r,i)}}function xx(i){const t=i.type,{mixins:e,extends:s}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=i.appContext,a=r.get(t);let l;return a?l=a:!n.length&&!e&&!s?l=t:(l={},n.length&&n.forEach(c=>gf(l,c,o,!0)),gf(l,t,o)),ae(t)&&r.set(t,l),l}function gf(i,t,e,s=!1){const{mixins:n,extends:r}=t;r&&gf(i,r,e,!0),n&&n.forEach(o=>gf(i,o,e,!0));for(const o in t)if(!(s&&o==="expose")){const a=gT[o]||e&&e[o];i[o]=a?a(i[o],t[o]):t[o]}return i}const gT={data:B1,props:Z1,emits:Z1,methods:Zl,computed:Zl,beforeCreate:vi,created:vi,beforeMount:vi,mounted:vi,beforeUpdate:vi,updated:vi,beforeDestroy:vi,beforeUnmount:vi,destroyed:vi,unmounted:vi,activated:vi,deactivated:vi,errorCaptured:vi,serverPrefetch:vi,components:Zl,directives:Zl,watch:OT,provide:B1,inject:mT};function B1(i,t){return t?i?function(){return gi(It(i)?i.call(this,this):i,It(t)?t.call(this,this):t)}:t:i}function mT(i,t){return Zl(Dg(i),Dg(t))}function Dg(i){if(St(i)){const t={};for(let e=0;e<i.length;e++)t[i[e]]=i[e];return t}return i}function vi(i,t){return i?[...new Set([].concat(i,t))]:t}function Zl(i,t){return i?gi(Object.create(null),i,t):t}function Z1(i,t){return i?St(i)&&St(t)?[...new Set([...i,...t])]:gi(Object.create(null),L1(i),L1(t??{})):t}function OT(i,t){if(!i)return t;if(!t)return i;const e=gi(Object.create(null),i);for(const s in t)e[s]=vi(i[s],t[s]);return e}function Sx(){return{app:null,config:{isNativeTag:F_,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yT=0;function bT(i,t){return function(s,n=null){It(s)||(s=gi({},s)),n!=null&&!ae(n)&&(n=null);const r=Sx(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:yT++,_component:s,_props:n,_container:null,_context:r,_instance:null,version:s4,get config(){return r.config},set config(h){},use(h,...u){return o.has(h)||(h&&It(h.install)?(o.add(h),h.install(c,...u)):It(h)&&(o.add(h),h(c,...u))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,u){return u?(r.components[h]=u,c):r.components[h]},directive(h,u){return u?(r.directives[h]=u,c):r.directives[h]},mount(h,u,f){if(!l){const d=c._ceVNode||Ne(s,n);return d.appContext=r,f===!0?f="svg":f===!1&&(f=void 0),i(d,h,f),l=!0,c._container=h,h.__vue_app__=c,Pd(d.component)}},onUnmount(h){a.push(h)},unmount(){l&&(_n(a,c._instance,16),i(null,c._container),delete c._container.__vue_app__)},provide(h,u){return r.provides[h]=u,c},runWithContext(h){const u=wa;wa=c;try{return h()}finally{wa=u}}};return c}}let wa=null;function vT(i,t){if(Ti){let e=Ti.provides;const s=Ti.parent&&Ti.parent.provides;s===e&&(e=Ti.provides=Object.create(s)),e[i]=t}}function oc(i,t,e=!1){const s=UT();if(s||wa){let n=wa?wa._context.provides:s?s.parent==null||s.ce?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(n&&i in n)return n[i];if(arguments.length>1)return e&&It(t)?t.call(s&&s.proxy):t}}const wx={},kx=()=>Object.create(wx),Cx=i=>Object.getPrototypeOf(i)===wx;function _T(i,t,e,s=!1){const n={},r=kx();i.propsDefaults=Object.create(null),Tx(i,t,n,r);for(const o in i.propsOptions[0])o in n||(n[o]=void 0);e?i.props=s?n:B3(n):i.type.props?i.props=n:i.props=r,i.attrs=r}function xT(i,t,e,s){const{props:n,attrs:r,vnode:{patchFlag:o}}=i,a=Gt(n),[l]=i.propsOptions;let c=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=i.vnode.dynamicProps;for(let u=0;u<h.length;u++){let f=h[u];if(Cd(i.emitsOptions,f))continue;const d=t[f];if(l)if(Ht(r,f))d!==r[f]&&(r[f]=d,c=!0);else{const p=Lr(f);n[p]=Lg(l,a,p,d,i,!1)}else d!==r[f]&&(r[f]=d,c=!0)}}}else{Tx(i,t,n,r)&&(c=!0);let h;for(const u in a)(!t||!Ht(t,u)&&((h=Lo(u))===u||!Ht(t,h)))&&(l?e&&(e[u]!==void 0||e[h]!==void 0)&&(n[u]=Lg(l,a,u,void 0,i,!0)):delete n[u]);if(r!==a)for(const u in r)(!t||!Ht(t,u))&&(delete r[u],c=!0)}c&&Bn(i.attrs,"set","")}function Tx(i,t,e,s){const[n,r]=i.propsOptions;let o=!1,a;if(t)for(let l in t){if(tc(l))continue;const c=t[l];let h;n&&Ht(n,h=Lr(l))?!r||!r.includes(h)?e[h]=c:(a||(a={}))[h]=c:Cd(i.emitsOptions,l)||(!(l in s)||c!==s[l])&&(s[l]=c,o=!0)}if(r){const l=Gt(e),c=a||oe;for(let h=0;h<r.length;h++){const u=r[h];e[u]=Lg(n,l,u,c[u],i,!Ht(c,u))}}return o}function Lg(i,t,e,s,n,r){const o=i[e];if(o!=null){const a=Ht(o,"default");if(a&&s===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&It(l)){const{propsDefaults:c}=n;if(e in c)s=c[e];else{const h=th(n);s=c[e]=l.call(null,t),h()}}else s=l;n.ce&&n.ce._setProp(e,s)}o[0]&&(r&&!a?s=!1:o[1]&&(s===""||s===Lo(e))&&(s=!0))}return s}const ST=new WeakMap;function Px(i,t,e=!1){const s=e?ST:t.propsCache,n=s.get(i);if(n)return n;const r=i.props,o={},a=[];let l=!1;if(!It(i)){const h=u=>{l=!0;const[f,d]=Px(u,t,!0);gi(o,f),d&&a.push(...d)};!e&&t.mixins.length&&t.mixins.forEach(h),i.extends&&h(i.extends),i.mixins&&i.mixins.forEach(h)}if(!r&&!l)return ae(i)&&s.set(i,va),va;if(St(r))for(let h=0;h<r.length;h++){const u=Lr(r[h]);F1(u)&&(o[u]=oe)}else if(r)for(const h in r){const u=Lr(h);if(F1(u)){const f=r[h],d=o[u]=St(f)||It(f)?{type:f}:gi({},f),p=d.type;let g=!1,m=!0;if(St(p))for(let O=0;O<p.length;++O){const b=p[O],x=It(b)&&b.name;if(x==="Boolean"){g=!0;break}else x==="String"&&(m=!1)}else g=It(p)&&p.name==="Boolean";d[0]=g,d[1]=m,(g||Ht(d,"default"))&&a.push(u)}}const c=[o,a];return ae(i)&&s.set(i,c),c}function F1(i){return i[0]!=="$"&&!tc(i)}const N0=i=>i==="_"||i==="_ctx"||i==="$stable",D0=i=>St(i)?i.map(cn):[cn(i)],wT=(i,t,e)=>{if(t._n)return t;const s=H3((...n)=>D0(t(...n)),e);return s._c=!1,s},Ax=(i,t,e)=>{const s=i._ctx;for(const n in i){if(N0(n))continue;const r=i[n];if(It(r))t[n]=wT(n,r,s);else if(r!=null){const o=D0(r);t[n]=()=>o}}},Mx=(i,t)=>{const e=D0(t);i.slots.default=()=>e},Ex=(i,t,e)=>{for(const s in t)(e||!N0(s))&&(i[s]=t[s])},kT=(i,t,e)=>{const s=i.slots=kx();if(i.vnode.shapeFlag&32){const n=t._;n?(Ex(s,t,e),e&&j_(s,"_",n,!0)):Ax(t,s)}else t&&Mx(i,t)},CT=(i,t,e)=>{const{vnode:s,slots:n}=i;let r=!0,o=oe;if(s.shapeFlag&32){const a=t._;a?e&&a===1?r=!1:Ex(n,t,e):(r=!t.$stable,Ax(t,n)),o=t}else t&&(Mx(i,t),o={default:1});if(r)for(const a in n)!N0(a)&&o[a]==null&&delete n[a]},is=ZT;function TT(i){return PT(i)}function PT(i,t){const e=vd();e.__VUE__=!0;const{insert:s,remove:n,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:u,nextSibling:f,setScopeId:d=On,insertStaticContent:p}=i,g=(P,Q,q,V=null,B=null,j=null,tt=void 0,Y=null,H=!!Q.dynamicChildren)=>{if(P===Q)return;P&&!ml(P,Q)&&(V=Ut(P),ot(P,B,j,!0),P=null),Q.patchFlag===-2&&(H=!1,Q.dynamicChildren=null);const{type:U,ref:bt,shapeFlag:ct}=Q;switch(U){case Td:m(P,Q,q,V);break;case Br:O(P,Q,q,V);break;case Fu:P==null&&b(Q,q,V,tt);break;case ii:C(P,Q,q,V,B,j,tt,Y,H);break;default:ct&1?y(P,Q,q,V,B,j,tt,Y,H):ct&6?$(P,Q,q,V,B,j,tt,Y,H):(ct&64||ct&128)&&U.process(P,Q,q,V,B,j,tt,Y,H,nt)}bt!=null&&B?sc(bt,P&&P.ref,j,Q||P,!Q):bt==null&&P&&P.ref!=null&&sc(P.ref,null,j,P,!0)},m=(P,Q,q,V)=>{if(P==null)s(Q.el=a(Q.children),q,V);else{const B=Q.el=P.el;Q.children!==P.children&&c(B,Q.children)}},O=(P,Q,q,V)=>{P==null?s(Q.el=l(Q.children||""),q,V):Q.el=P.el},b=(P,Q,q,V)=>{[P.el,P.anchor]=p(P.children,Q,q,V,P.el,P.anchor)},x=({el:P,anchor:Q},q,V)=>{let B;for(;P&&P!==Q;)B=f(P),s(P,q,V),P=B;s(Q,q,V)},v=({el:P,anchor:Q})=>{let q;for(;P&&P!==Q;)q=f(P),n(P),P=q;n(Q)},y=(P,Q,q,V,B,j,tt,Y,H)=>{Q.type==="svg"?tt="svg":Q.type==="math"&&(tt="mathml"),P==null?_(Q,q,V,B,j,tt,Y,H):A(P,Q,B,j,tt,Y,H)},_=(P,Q,q,V,B,j,tt,Y)=>{let H,U;const{props:bt,shapeFlag:ct,transition:_t,dirs:Ct}=P;if(H=P.el=o(P.type,j,bt&&bt.is,bt),ct&8?h(H,P.children):ct&16&&k(P.children,H,null,V,B,Tp(P,j),tt,Y),Ct&&ao(P,null,V,"created"),S(H,P,P.scopeId,tt,V),bt){for(const ce in bt)ce!=="value"&&!tc(ce)&&r(H,ce,null,bt[ce],j,V);"value"in bt&&r(H,"value",null,bt.value,j),(U=bt.onVnodeBeforeMount)&&tn(U,V,P)}Ct&&ao(P,null,V,"beforeMount");const Lt=AT(B,_t);Lt&&_t.beforeEnter(H),s(H,Q,q),((U=bt&&bt.onVnodeMounted)||Lt||Ct)&&is(()=>{U&&tn(U,V,P),Lt&&_t.enter(H),Ct&&ao(P,null,V,"mounted")},B)},S=(P,Q,q,V,B)=>{if(q&&d(P,q),V)for(let j=0;j<V.length;j++)d(P,V[j]);if(B){let j=B.subTree;if(Q===j||Dx(j.type)&&(j.ssContent===Q||j.ssFallback===Q)){const tt=B.vnode;S(P,tt,tt.scopeId,tt.slotScopeIds,B.parent)}}},k=(P,Q,q,V,B,j,tt,Y,H=0)=>{for(let U=H;U<P.length;U++){const bt=P[U]=Y?_r(P[U]):cn(P[U]);g(null,bt,Q,q,V,B,j,tt,Y)}},A=(P,Q,q,V,B,j,tt)=>{const Y=Q.el=P.el;let{patchFlag:H,dynamicChildren:U,dirs:bt}=Q;H|=P.patchFlag&16;const ct=P.props||oe,_t=Q.props||oe;let Ct;if(q&&lo(q,!1),(Ct=_t.onVnodeBeforeUpdate)&&tn(Ct,q,Q,P),bt&&ao(Q,P,q,"beforeUpdate"),q&&lo(q,!0),(ct.innerHTML&&_t.innerHTML==null||ct.textContent&&_t.textContent==null)&&h(Y,""),U?M(P.dynamicChildren,U,Y,q,V,Tp(Q,B),j):tt||F(P,Q,Y,null,q,V,Tp(Q,B),j,!1),H>0){if(H&16)R(Y,ct,_t,q,B);else if(H&2&&ct.class!==_t.class&&r(Y,"class",null,_t.class,B),H&4&&r(Y,"style",ct.style,_t.style,B),H&8){const Lt=Q.dynamicProps;for(let ce=0;ce<Lt.length;ce++){const Kt=Lt[ce],Qi=ct[Kt],Ii=_t[Kt];(Ii!==Qi||Kt==="value")&&r(Y,Kt,Qi,Ii,B,q)}}H&1&&P.children!==Q.children&&h(Y,Q.children)}else!tt&&U==null&&R(Y,ct,_t,q,B);((Ct=_t.onVnodeUpdated)||bt)&&is(()=>{Ct&&tn(Ct,q,Q,P),bt&&ao(Q,P,q,"updated")},V)},M=(P,Q,q,V,B,j,tt)=>{for(let Y=0;Y<Q.length;Y++){const H=P[Y],U=Q[Y],bt=H.el&&(H.type===ii||!ml(H,U)||H.shapeFlag&198)?u(H.el):q;g(H,U,bt,null,V,B,j,tt,!0)}},R=(P,Q,q,V,B)=>{if(Q!==q){if(Q!==oe)for(const j in Q)!tc(j)&&!(j in q)&&r(P,j,Q[j],null,B,V);for(const j in q){if(tc(j))continue;const tt=q[j],Y=Q[j];tt!==Y&&j!=="value"&&r(P,j,Y,tt,B,V)}"value"in q&&r(P,"value",Q.value,q.value,B)}},C=(P,Q,q,V,B,j,tt,Y,H)=>{const U=Q.el=P?P.el:a(""),bt=Q.anchor=P?P.anchor:a("");let{patchFlag:ct,dynamicChildren:_t,slotScopeIds:Ct}=Q;Ct&&(Y=Y?Y.concat(Ct):Ct),P==null?(s(U,q,V),s(bt,q,V),k(Q.children||[],q,bt,B,j,tt,Y,H)):ct>0&&ct&64&&_t&&P.dynamicChildren?(M(P.dynamicChildren,_t,q,B,j,tt,Y),(Q.key!=null||B&&Q===B.subTree)&&Rx(P,Q,!0)):F(P,Q,q,bt,B,j,tt,Y,H)},$=(P,Q,q,V,B,j,tt,Y,H)=>{Q.slotScopeIds=Y,P==null?Q.shapeFlag&512?B.ctx.activate(Q,q,V,tt,H):N(Q,q,V,B,j,tt,H):L(P,Q,H)},N=(P,Q,q,V,B,j,tt)=>{const Y=P.component=YT(P,V,B);if(bx(P)&&(Y.ctx.renderer=nt),HT(Y,!1,tt),Y.asyncDep){if(B&&B.registerDep(Y,I,tt),!P.el){const H=Y.subTree=Ne(Br);O(null,H,Q,q),P.placeholder=H.el}}else I(Y,P,Q,q,B,j,tt)},L=(P,Q,q)=>{const V=Q.component=P.component;if(VT(P,Q,q))if(V.asyncDep&&!V.asyncResolved){Z(V,Q,q);return}else V.next=Q,V.update();else Q.el=P.el,V.vnode=Q},I=(P,Q,q,V,B,j,tt)=>{const Y=()=>{if(P.isMounted){let{next:ct,bu:_t,u:Ct,parent:Lt,vnode:ce}=P;{const Ks=Qx(P);if(Ks){ct&&(ct.el=ce.el,Z(P,ct,tt)),Ks.asyncDep.then(()=>{P.isUnmounted||Y()});return}}let Kt=ct,Qi;lo(P,!1),ct?(ct.el=ce.el,Z(P,ct,tt)):ct=ce,_t&&Zu(_t),(Qi=ct.props&&ct.props.onVnodeBeforeUpdate)&&tn(Qi,Lt,ct,ce),lo(P,!0);const Ii=q1(P),Hs=P.subTree;P.subTree=Ii,g(Hs,Ii,u(Hs.el),Ut(Hs),P,B,j),ct.el=Ii.el,Kt===null&&BT(P,Ii.el),Ct&&is(Ct,B),(Qi=ct.props&&ct.props.onVnodeUpdated)&&is(()=>tn(Qi,Lt,ct,ce),B)}else{let ct;const{el:_t,props:Ct}=Q,{bm:Lt,m:ce,parent:Kt,root:Qi,type:Ii}=P,Hs=nc(Q);lo(P,!1),Lt&&Zu(Lt),!Hs&&(ct=Ct&&Ct.onVnodeBeforeMount)&&tn(ct,Kt,Q),lo(P,!0);{Qi.ce&&Qi.ce._def.shadowRoot!==!1&&Qi.ce._injectChildStyle(Ii);const Ks=P.subTree=q1(P);g(null,Ks,q,V,P,B,j),Q.el=Ks.el}if(ce&&is(ce,B),!Hs&&(ct=Ct&&Ct.onVnodeMounted)){const Ks=Q;is(()=>tn(ct,Kt,Ks),B)}(Q.shapeFlag&256||Kt&&nc(Kt.vnode)&&Kt.vnode.shapeFlag&256)&&P.a&&is(P.a,B),P.isMounted=!0,Q=q=V=null}};P.scope.on();const H=P.effect=new H_(Y);P.scope.off();const U=P.update=H.run.bind(H),bt=P.job=H.runIfDirty.bind(H);bt.i=P,bt.id=P.uid,H.scheduler=()=>Q0(bt),lo(P,!0),U()},Z=(P,Q,q)=>{Q.component=P;const V=P.vnode.props;P.vnode=Q,P.next=null,xT(P,Q.props,V,q),CT(P,Q.children,q),jn(),N1(P),Gn()},F=(P,Q,q,V,B,j,tt,Y,H=!1)=>{const U=P&&P.children,bt=P?P.shapeFlag:0,ct=Q.children,{patchFlag:_t,shapeFlag:Ct}=Q;if(_t>0){if(_t&128){et(U,ct,q,V,B,j,tt,Y,H);return}else if(_t&256){z(U,ct,q,V,B,j,tt,Y,H);return}}Ct&8?(bt&16&&wt(U,B,j),ct!==U&&h(q,ct)):bt&16?Ct&16?et(U,ct,q,V,B,j,tt,Y,H):wt(U,B,j,!0):(bt&8&&h(q,""),Ct&16&&k(ct,q,V,B,j,tt,Y,H))},z=(P,Q,q,V,B,j,tt,Y,H)=>{P=P||va,Q=Q||va;const U=P.length,bt=Q.length,ct=Math.min(U,bt);let _t;for(_t=0;_t<ct;_t++){const Ct=Q[_t]=H?_r(Q[_t]):cn(Q[_t]);g(P[_t],Ct,q,null,B,j,tt,Y,H)}U>bt?wt(P,B,j,!0,!1,ct):k(Q,q,V,B,j,tt,Y,H,ct)},et=(P,Q,q,V,B,j,tt,Y,H)=>{let U=0;const bt=Q.length;let ct=P.length-1,_t=bt-1;for(;U<=ct&&U<=_t;){const Ct=P[U],Lt=Q[U]=H?_r(Q[U]):cn(Q[U]);if(ml(Ct,Lt))g(Ct,Lt,q,null,B,j,tt,Y,H);else break;U++}for(;U<=ct&&U<=_t;){const Ct=P[ct],Lt=Q[_t]=H?_r(Q[_t]):cn(Q[_t]);if(ml(Ct,Lt))g(Ct,Lt,q,null,B,j,tt,Y,H);else break;ct--,_t--}if(U>ct){if(U<=_t){const Ct=_t+1,Lt=Ct<bt?Q[Ct].el:V;for(;U<=_t;)g(null,Q[U]=H?_r(Q[U]):cn(Q[U]),q,Lt,B,j,tt,Y,H),U++}}else if(U>_t)for(;U<=ct;)ot(P[U],B,j,!0),U++;else{const Ct=U,Lt=U,ce=new Map;for(U=Lt;U<=_t;U++){const Hi=Q[U]=H?_r(Q[U]):cn(Q[U]);Hi.key!=null&&ce.set(Hi.key,U)}let Kt,Qi=0;const Ii=_t-Lt+1;let Hs=!1,Ks=0;const pl=new Array(Ii);for(U=0;U<Ii;U++)pl[U]=0;for(U=Ct;U<=ct;U++){const Hi=P[U];if(Qi>=Ii){ot(Hi,B,j,!0);continue}let Js;if(Hi.key!=null)Js=ce.get(Hi.key);else for(Kt=Lt;Kt<=_t;Kt++)if(pl[Kt-Lt]===0&&ml(Hi,Q[Kt])){Js=Kt;break}Js===void 0?ot(Hi,B,j,!0):(pl[Js-Lt]=U+1,Js>=Ks?Ks=Js:Hs=!0,g(Hi,Q[Js],q,null,B,j,tt,Y,H),Qi++)}const A1=Hs?MT(pl):va;for(Kt=A1.length-1,U=Ii-1;U>=0;U--){const Hi=Lt+U,Js=Q[Hi],M1=Q[Hi+1],E1=Hi+1<bt?M1.el||M1.placeholder:V;pl[U]===0?g(null,Js,q,E1,B,j,tt,Y,H):Hs&&(Kt<0||U!==A1[Kt]?K(Js,q,E1,2):Kt--)}}},K=(P,Q,q,V,B=null)=>{const{el:j,type:tt,transition:Y,children:H,shapeFlag:U}=P;if(U&6){K(P.component.subTree,Q,q,V);return}if(U&128){P.suspense.move(Q,q,V);return}if(U&64){tt.move(P,Q,q,nt);return}if(tt===ii){s(j,Q,q);for(let ct=0;ct<H.length;ct++)K(H[ct],Q,q,V);s(P.anchor,Q,q);return}if(tt===Fu){x(P,Q,q);return}if(V!==2&&U&1&&Y)if(V===0)Y.beforeEnter(j),s(j,Q,q),is(()=>Y.enter(j),B);else{const{leave:ct,delayLeave:_t,afterLeave:Ct}=Y,Lt=()=>{P.ctx.isUnmounted?n(j):s(j,Q,q)},ce=()=>{j._isLeaving&&j[tT](!0),ct(j,()=>{Lt(),Ct&&Ct()})};_t?_t(j,Lt,ce):ce()}else s(j,Q,q)},ot=(P,Q,q,V=!1,B=!1)=>{const{type:j,props:tt,ref:Y,children:H,dynamicChildren:U,shapeFlag:bt,patchFlag:ct,dirs:_t,cacheIndex:Ct}=P;if(ct===-2&&(B=!1),Y!=null&&(jn(),sc(Y,null,q,P,!0),Gn()),Ct!=null&&(Q.renderCache[Ct]=void 0),bt&256){Q.ctx.deactivate(P);return}const Lt=bt&1&&_t,ce=!nc(P);let Kt;if(ce&&(Kt=tt&&tt.onVnodeBeforeUnmount)&&tn(Kt,Q,P),bt&6)yt(P.component,q,V);else{if(bt&128){P.suspense.unmount(q,V);return}Lt&&ao(P,null,Q,"beforeUnmount"),bt&64?P.type.remove(P,Q,q,nt,V):U&&!U.hasOnce&&(j!==ii||ct>0&&ct&64)?wt(U,Q,q,!1,!0):(j===ii&&ct&384||!B&&bt&16)&&wt(H,Q,q),V&&Mt(P)}(ce&&(Kt=tt&&tt.onVnodeUnmounted)||Lt)&&is(()=>{Kt&&tn(Kt,Q,P),Lt&&ao(P,null,Q,"unmounted")},q)},Mt=P=>{const{type:Q,el:q,anchor:V,transition:B}=P;if(Q===ii){jt(q,V);return}if(Q===Fu){v(P);return}const j=()=>{n(q),B&&!B.persisted&&B.afterLeave&&B.afterLeave()};if(P.shapeFlag&1&&B&&!B.persisted){const{leave:tt,delayLeave:Y}=B,H=()=>tt(q,j);Y?Y(P.el,j,H):H()}else j()},jt=(P,Q)=>{let q;for(;P!==Q;)q=f(P),n(P),P=q;n(Q)},yt=(P,Q,q)=>{const{bum:V,scope:B,job:j,subTree:tt,um:Y,m:H,a:U}=P;W1(H),W1(U),V&&Zu(V),B.stop(),j&&(j.flags|=8,ot(tt,P,Q,q)),Y&&is(Y,Q),is(()=>{P.isUnmounted=!0},Q)},wt=(P,Q,q,V=!1,B=!1,j=0)=>{for(let tt=j;tt<P.length;tt++)ot(P[tt],Q,q,V,B)},Ut=P=>{if(P.shapeFlag&6)return Ut(P.component.subTree);if(P.shapeFlag&128)return P.suspense.next();const Q=f(P.anchor||P.el),q=Q&&Q[K3];return q?f(q):Q};let gt=!1;const mt=(P,Q,q)=>{P==null?Q._vnode&&ot(Q._vnode,null,null,!0):g(Q._vnode||null,P,Q,null,null,null,q),Q._vnode=P,gt||(gt=!0,N1(),gx(),gt=!1)},nt={p:g,um:ot,m:K,r:Mt,mt:N,mc:k,pc:F,pbc:M,n:Ut,o:i};return{render:mt,hydrate:void 0,createApp:bT(mt)}}function Tp({type:i,props:t},e){return e==="svg"&&i==="foreignObject"||e==="mathml"&&i==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function lo({effect:i,job:t},e){e?(i.flags|=32,t.flags|=4):(i.flags&=-33,t.flags&=-5)}function AT(i,t){return(!i||i&&!i.pendingBranch)&&t&&!t.persisted}function Rx(i,t,e=!1){const s=i.children,n=t.children;if(St(s)&&St(n))for(let r=0;r<s.length;r++){const o=s[r];let a=n[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=n[r]=_r(n[r]),a.el=o.el),!e&&a.patchFlag!==-2&&Rx(o,a)),a.type===Td&&a.patchFlag!==-1&&(a.el=o.el),a.type===Br&&!a.el&&(a.el=o.el)}}function MT(i){const t=i.slice(),e=[0];let s,n,r,o,a;const l=i.length;for(s=0;s<l;s++){const c=i[s];if(c!==0){if(n=e[e.length-1],i[n]<c){t[s]=n,e.push(s);continue}for(r=0,o=e.length-1;r<o;)a=r+o>>1,i[e[a]]<c?r=a+1:o=a;c<i[e[r]]&&(r>0&&(t[s]=e[r-1]),e[r]=s)}}for(r=e.length,o=e[r-1];r-- >0;)e[r]=o,o=t[o];return e}function Qx(i){const t=i.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Qx(t)}function W1(i){if(i)for(let t=0;t<i.length;t++)i[t].flags|=8}const ET=Symbol.for("v-scx"),RT=()=>oc(ET);function We(i,t,e){return Ix(i,t,e)}function Ix(i,t,e=oe){const{immediate:s,deep:n,flush:r,once:o}=e,a=gi({},e),l=t&&s||!t&&r!=="post";let c;if(wc){if(r==="sync"){const d=RT();c=d.__watcherHandles||(d.__watcherHandles=[])}else if(!l){const d=()=>{};return d.stop=On,d.resume=On,d.pause=On,d}}const h=Ti;a.call=(d,p,g)=>_n(d,h,p,g);let u=!1;r==="post"?a.scheduler=d=>{is(d,h&&h.suspense)}:r!=="sync"&&(u=!0,a.scheduler=(d,p)=>{p?d():Q0(d)}),a.augmentJob=d=>{t&&(d.flags|=4),u&&(d.flags|=2,h&&(d.id=h.uid,d.i=h))};const f=j3(i,t,a);return wc&&(c?c.push(f):l&&f()),f}function QT(i,t,e){const s=this.proxy,n=Ze(i)?i.includes(".")?$x(s,i):()=>s[i]:i.bind(s,s);let r;It(t)?r=t:(r=t.handler,e=t);const o=th(this),a=Ix(n,r.bind(s),e);return o(),a}function $x(i,t){const e=t.split(".");return()=>{let s=i;for(let n=0;n<e.length&&s;n++)s=s[e[n]];return s}}const IT=(i,t)=>t==="modelValue"||t==="model-value"?i.modelModifiers:i[`${t}Modifiers`]||i[`${Lr(t)}Modifiers`]||i[`${Lo(t)}Modifiers`];function $T(i,t,...e){if(i.isUnmounted)return;const s=i.vnode.props||oe;let n=e;const r=t.startsWith("update:"),o=r&&IT(s,t.slice(7));o&&(o.trim&&(n=e.map(h=>Ze(h)?h.trim():h)),o.number&&(n=e.map(cf)));let a,l=s[a=vp(t)]||s[a=vp(Lr(t))];!l&&r&&(l=s[a=vp(Lo(t))]),l&&_n(l,i,6,n);const c=s[a+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[a])return;i.emitted[a]=!0,_n(c,i,6,n)}}const NT=new WeakMap;function Nx(i,t,e=!1){const s=e?NT:t.emitsCache,n=s.get(i);if(n!==void 0)return n;const r=i.emits;let o={},a=!1;if(!It(i)){const l=c=>{const h=Nx(c,t,!0);h&&(a=!0,gi(o,h))};!e&&t.mixins.length&&t.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!r&&!a?(ae(i)&&s.set(i,null),null):(St(r)?r.forEach(l=>o[l]=null):gi(o,r),ae(i)&&s.set(i,o),o)}function Cd(i,t){return!i||!yd(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ht(i,t[0].toLowerCase()+t.slice(1))||Ht(i,Lo(t))||Ht(i,t))}function q1(i){const{type:t,vnode:e,proxy:s,withProxy:n,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:u,data:f,setupState:d,ctx:p,inheritAttrs:g}=i,m=df(i);let O,b;try{if(e.shapeFlag&4){const v=n||s,y=v;O=cn(c.call(y,v,h,u,d,f,p)),b=a}else{const v=t;O=cn(v.length>1?v(u,{attrs:a,slots:o,emit:l}):v(u,null)),b=t.props?a:DT(a)}}catch(v){ac.length=0,xd(v,i,1),O=Ne(Br)}let x=O;if(b&&g!==!1){const v=Object.keys(b),{shapeFlag:y}=x;v.length&&y&7&&(r&&v.some(x0)&&(b=LT(b,r)),x=Qa(x,b,!1,!0))}return e.dirs&&(x=Qa(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(e.dirs):e.dirs),e.transition&&I0(x,e.transition),O=x,df(m),O}const DT=i=>{let t;for(const e in i)(e==="class"||e==="style"||yd(e))&&((t||(t={}))[e]=i[e]);return t},LT=(i,t)=>{const e={};for(const s in i)(!x0(s)||!(s.slice(9)in t))&&(e[s]=i[s]);return e};function VT(i,t,e){const{props:s,children:n,component:r}=i,{props:o,children:a,patchFlag:l}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return s?X1(s,o,c):!!o;if(l&8){const h=t.dynamicProps;for(let u=0;u<h.length;u++){const f=h[u];if(o[f]!==s[f]&&!Cd(c,f))return!0}}}else return(n||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?X1(s,o,c):!0:!!o;return!1}function X1(i,t,e){const s=Object.keys(t);if(s.length!==Object.keys(i).length)return!0;for(let n=0;n<s.length;n++){const r=s[n];if(t[r]!==i[r]&&!Cd(e,r))return!0}return!1}function BT({vnode:i,parent:t},e){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===i&&(s.el=i.el),s===i)(i=t.vnode).el=e,t=t.parent;else break}}const Dx=i=>i.__isSuspense;function ZT(i,t){t&&t.pendingBranch?St(i)?t.effects.push(...i):t.effects.push(i):U3(i)}const ii=Symbol.for("v-fgt"),Td=Symbol.for("v-txt"),Br=Symbol.for("v-cmt"),Fu=Symbol.for("v-stc"),ac=[];let os=null;function Tt(i=!1){ac.push(os=i?null:[])}function FT(){ac.pop(),os=ac[ac.length-1]||null}let Sc=1;function mf(i,t=!1){Sc+=i,i<0&&os&&t&&(os.hasOnce=!0)}function Lx(i){return i.dynamicChildren=Sc>0?os||va:null,FT(),Sc>0&&os&&os.push(i),i}function Rt(i,t,e,s,n,r){return Lx(X(i,t,e,s,n,r,!0))}function Vx(i,t,e,s,n){return Lx(Ne(i,t,e,s,n,!0))}function Of(i){return i?i.__v_isVNode===!0:!1}function ml(i,t){return i.type===t.type&&i.key===t.key}const Bx=({key:i})=>i??null,Wu=({ref:i,ref_key:t,ref_for:e})=>(typeof i=="number"&&(i=""+i),i!=null?Ze(i)||di(i)||It(i)?{i:ys,r:i,k:t,f:!!e}:i:null);function X(i,t=null,e=null,s=0,n=null,r=i===ii?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:t,key:t&&Bx(t),ref:t&&Wu(t),scopeId:Ox,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:ys};return a?(L0(l,e),r&128&&i.normalize(l)):e&&(l.shapeFlag|=Ze(e)?8:16),Sc>0&&!o&&os&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&os.push(l),l}const Ne=WT;function WT(i,t=null,e=null,s=0,n=null,r=!1){if((!i||i===uT)&&(i=Br),Of(i)){const a=Qa(i,t,!0);return e&&L0(a,e),Sc>0&&!r&&os&&(a.shapeFlag&6?os[os.indexOf(i)]=a:os.push(a)),a.patchFlag=-2,a}if(e4(i)&&(i=i.__vccOpts),t){t=qT(t);let{class:a,style:l}=t;a&&!Ze(a)&&(t.class=Ds(a)),ae(l)&&(R0(l)&&!St(l)&&(l=gi({},l)),t.style=kr(l))}const o=Ze(i)?1:Dx(i)?128:J3(i)?64:ae(i)?4:It(i)?2:0;return X(i,t,e,s,n,o,r,!0)}function qT(i){return i?R0(i)||Cx(i)?gi({},i):i:null}function Qa(i,t,e=!1,s=!1){const{props:n,ref:r,patchFlag:o,children:a,transition:l}=i,c=t?zT(n||{},t):n,h={__v_isVNode:!0,__v_skip:!0,type:i.type,props:c,key:c&&Bx(c),ref:t&&t.ref?e&&r?St(r)?r.concat(Wu(t)):[r,Wu(t)]:Wu(t):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetStart:i.targetStart,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:t&&i.type!==ii?o===-1?16:o|16:o,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:l,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&Qa(i.ssContent),ssFallback:i.ssFallback&&Qa(i.ssFallback),placeholder:i.placeholder,el:i.el,anchor:i.anchor,ctx:i.ctx,ce:i.ce};return l&&s&&I0(h,l.clone(h)),h}function Fi(i=" ",t=0){return Ne(Td,null,i,t)}function XT(i,t){const e=Ne(Fu,null,i);return e.staticCount=t,e}function Ae(i="",t=!1){return t?(Tt(),Vx(Br,null,i)):Ne(Br,null,i)}function cn(i){return i==null||typeof i=="boolean"?Ne(Br):St(i)?Ne(ii,null,i.slice()):Of(i)?_r(i):Ne(Td,null,String(i))}function _r(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:Qa(i)}function L0(i,t){let e=0;const{shapeFlag:s}=i;if(t==null)t=null;else if(St(t))e=16;else if(typeof t=="object")if(s&65){const n=t.default;n&&(n._c&&(n._d=!1),L0(i,n()),n._c&&(n._d=!0));return}else{e=32;const n=t._;!n&&!Cx(t)?t._ctx=ys:n===3&&ys&&(ys.slots._===1?t._=1:(t._=2,i.patchFlag|=1024))}else It(t)?(t={default:t,_ctx:ys},e=32):(t=String(t),s&64?(e=16,t=[Fi(t)]):e=8);i.children=t,i.shapeFlag|=e}function zT(...i){const t={};for(let e=0;e<i.length;e++){const s=i[e];for(const n in s)if(n==="class")t.class!==s.class&&(t.class=Ds([t.class,s.class]));else if(n==="style")t.style=kr([t.style,s.style]);else if(yd(n)){const r=t[n],o=s[n];o&&r!==o&&!(St(r)&&r.includes(o))&&(t[n]=r?[].concat(r,o):o)}else n!==""&&(t[n]=s[n])}return t}function tn(i,t,e,s=null){_n(i,t,7,[e,s])}const jT=Sx();let GT=0;function YT(i,t,e){const s=i.type,n=(t?t.appContext:i.appContext)||jT,r={uid:GT++,vnode:i,type:s,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new v3(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Px(s,n),emitsOptions:Nx(s,n),emit:null,emitted:null,propsDefaults:oe,inheritAttrs:s.inheritAttrs,ctx:oe,data:oe,props:oe,attrs:oe,slots:oe,refs:oe,setupState:oe,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=$T.bind(null,r),i.ce&&i.ce(r),r}let Ti=null;const UT=()=>Ti||ys;let yf,Vg;{const i=vd(),t=(e,s)=>{let n;return(n=i[e])||(n=i[e]=[]),n.push(s),r=>{n.length>1?n.forEach(o=>o(r)):n[0](r)}};yf=t("__VUE_INSTANCE_SETTERS__",e=>Ti=e),Vg=t("__VUE_SSR_SETTERS__",e=>wc=e)}const th=i=>{const t=Ti;return yf(i),i.scope.on(),()=>{i.scope.off(),yf(t)}},z1=()=>{Ti&&Ti.scope.off(),yf(null)};function Zx(i){return i.vnode.shapeFlag&4}let wc=!1;function HT(i,t=!1,e=!1){t&&Vg(t);const{props:s,children:n}=i.vnode,r=Zx(i);_T(i,s,r,t),kT(i,n,e||t);const o=r?KT(i,t):void 0;return t&&Vg(!1),o}function KT(i,t){const e=i.type;i.accessCache=Object.create(null),i.proxy=new Proxy(i.ctx,fT);const{setup:s}=e;if(s){jn();const n=i.setupContext=s.length>1?t4(i):null,r=th(i),o=Kc(s,i,0,[i.props,n]),a=W_(o);if(Gn(),r(),(a||i.sp)&&!nc(i)&&yx(i),a){if(o.then(z1,z1),t)return o.then(l=>{j1(i,l)}).catch(l=>{xd(l,i,0)});i.asyncDep=o}else j1(i,o)}else Fx(i)}function j1(i,t,e){It(t)?i.type.__ssrInlineRender?i.ssrRender=t:i.render=t:ae(t)&&(i.setupState=fx(t)),Fx(i)}function Fx(i,t,e){const s=i.type;i.render||(i.render=s.render||On);{const n=th(i);jn();try{dT(i)}finally{Gn(),n()}}}const JT={get(i,t){return ci(i,"get",""),i[t]}};function t4(i){const t=e=>{i.exposed=e||{}};return{attrs:new Proxy(i.attrs,JT),slots:i.slots,emit:i.emit,expose:t}}function Pd(i){return i.exposed?i.exposeProxy||(i.exposeProxy=new Proxy(fx(Z3(i.exposed)),{get(t,e){if(e in t)return t[e];if(e in rc)return rc[e](i)},has(t,e){return e in t||e in rc}})):i.proxy}function e4(i){return It(i)&&"__vccOpts"in i}const Rs=(i,t)=>X3(i,t,wc);function i4(i,t,e){try{mf(-1);const s=arguments.length;return s===2?ae(t)&&!St(t)?Of(t)?Ne(i,null,[t]):Ne(i,t):Ne(i,null,t):(s>3?e=Array.prototype.slice.call(arguments,2):s===3&&Of(e)&&(e=[e]),Ne(i,t,e))}finally{mf(1)}}const s4="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Bg;const G1=typeof window<"u"&&window.trustedTypes;if(G1)try{Bg=G1.createPolicy("vue",{createHTML:i=>i})}catch{}const Wx=Bg?i=>Bg.createHTML(i):i=>i,n4="http://www.w3.org/2000/svg",r4="http://www.w3.org/1998/Math/MathML",Dn=typeof document<"u"?document:null,Y1=Dn&&Dn.createElement("template"),o4={insert:(i,t,e)=>{t.insertBefore(i,e||null)},remove:i=>{const t=i.parentNode;t&&t.removeChild(i)},createElement:(i,t,e,s)=>{const n=t==="svg"?Dn.createElementNS(n4,i):t==="mathml"?Dn.createElementNS(r4,i):e?Dn.createElement(i,{is:e}):Dn.createElement(i);return i==="select"&&s&&s.multiple!=null&&n.setAttribute("multiple",s.multiple),n},createText:i=>Dn.createTextNode(i),createComment:i=>Dn.createComment(i),setText:(i,t)=>{i.nodeValue=t},setElementText:(i,t)=>{i.textContent=t},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>Dn.querySelector(i),setScopeId(i,t){i.setAttribute(t,"")},insertStaticContent(i,t,e,s,n,r){const o=e?e.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),e),!(n===r||!(n=n.nextSibling)););else{Y1.innerHTML=Wx(s==="svg"?`<svg>${i}</svg>`:s==="mathml"?`<math>${i}</math>`:i);const a=Y1.content;if(s==="svg"||s==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},a4=Symbol("_vtc");function l4(i,t,e){const s=i[a4];s&&(t=(t?[t,...s]:[...s]).join(" ")),t==null?i.removeAttribute("class"):e?i.setAttribute("class",t):i.className=t}const bf=Symbol("_vod"),qx=Symbol("_vsh"),c4={name:"show",beforeMount(i,{value:t},{transition:e}){i[bf]=i.style.display==="none"?"":i.style.display,e&&t?e.beforeEnter(i):Ol(i,t)},mounted(i,{value:t},{transition:e}){e&&t&&e.enter(i)},updated(i,{value:t,oldValue:e},{transition:s}){!t!=!e&&(s?t?(s.beforeEnter(i),Ol(i,!0),s.enter(i)):s.leave(i,()=>{Ol(i,!1)}):Ol(i,t))},beforeUnmount(i,{value:t}){Ol(i,t)}};function Ol(i,t){i.style.display=t?i[bf]:"none",i[qx]=!t}const h4=Symbol(""),u4=/(?:^|;)\s*display\s*:/;function f4(i,t,e){const s=i.style,n=Ze(e);let r=!1;if(e&&!n){if(t)if(Ze(t))for(const o of t.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&qu(s,a,"")}else for(const o in t)e[o]==null&&qu(s,o,"");for(const o in e)o==="display"&&(r=!0),qu(s,o,e[o])}else if(n){if(t!==e){const o=s[h4];o&&(e+=";"+o),s.cssText=e,r=u4.test(e)}}else t&&i.removeAttribute("style");bf in i&&(i[bf]=r?s.display:"",i[qx]&&(s.display="none"))}const U1=/\s*!important$/;function qu(i,t,e){if(St(e))e.forEach(s=>qu(i,t,s));else if(e==null&&(e=""),t.startsWith("--"))i.setProperty(t,e);else{const s=d4(i,t);U1.test(e)?i.setProperty(Lo(s),e.replace(U1,""),"important"):i[s]=e}}const H1=["Webkit","Moz","ms"],Pp={};function d4(i,t){const e=Pp[t];if(e)return e;let s=Lr(t);if(s!=="filter"&&s in i)return Pp[t]=s;s=z_(s);for(let n=0;n<H1.length;n++){const r=H1[n]+s;if(r in i)return Pp[t]=r}return t}const K1="http://www.w3.org/1999/xlink";function J1(i,t,e,s,n,r=y3(t)){s&&t.startsWith("xlink:")?e==null?i.removeAttributeNS(K1,t.slice(6,t.length)):i.setAttributeNS(K1,t,e):e==null||r&&!G_(e)?i.removeAttribute(t):i.setAttribute(t,r?"":vn(e)?String(e):e)}function ty(i,t,e,s,n){if(t==="innerHTML"||t==="textContent"){e!=null&&(i[t]=t==="innerHTML"?Wx(e):e);return}const r=i.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?i.getAttribute("value")||"":i.value,l=e==null?i.type==="checkbox"?"on":"":String(e);(a!==l||!("_value"in i))&&(i.value=l),e==null&&i.removeAttribute(t),i._value=e;return}let o=!1;if(e===""||e==null){const a=typeof i[t];a==="boolean"?e=G_(e):e==null&&a==="string"?(e="",o=!0):a==="number"&&(e=0,o=!0)}try{i[t]=e}catch{}o&&i.removeAttribute(n||t)}function Fn(i,t,e,s){i.addEventListener(t,e,s)}function p4(i,t,e,s){i.removeEventListener(t,e,s)}const ey=Symbol("_vei");function g4(i,t,e,s,n=null){const r=i[ey]||(i[ey]={}),o=r[t];if(s&&o)o.value=s;else{const[a,l]=m4(t);if(s){const c=r[t]=b4(s,n);Fn(i,a,c,l)}else o&&(p4(i,a,o,l),r[t]=void 0)}}const iy=/(?:Once|Passive|Capture)$/;function m4(i){let t;if(iy.test(i)){t={};let s;for(;s=i.match(iy);)i=i.slice(0,i.length-s[0].length),t[s[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):Lo(i.slice(2)),t]}let Ap=0;const O4=Promise.resolve(),y4=()=>Ap||(O4.then(()=>Ap=0),Ap=Date.now());function b4(i,t){const e=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=e.attached)return;_n(v4(s,e.value),t,5,[s])};return e.value=i,e.attached=y4(),e}function v4(i,t){if(St(t)){const e=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{e.call(i),i._stopped=!0},t.map(s=>n=>!n._stopped&&s&&s(n))}else return t}const sy=i=>i.charCodeAt(0)===111&&i.charCodeAt(1)===110&&i.charCodeAt(2)>96&&i.charCodeAt(2)<123,_4=(i,t,e,s,n,r)=>{const o=n==="svg";t==="class"?l4(i,s,o):t==="style"?f4(i,e,s):yd(t)?x0(t)||g4(i,t,e,s,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):x4(i,t,s,o))?(ty(i,t,s),!i.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&J1(i,t,s,o,r,t!=="value")):i._isVueCE&&(/[A-Z]/.test(t)||!Ze(s))?ty(i,Lr(t),s,r,t):(t==="true-value"?i._trueValue=s:t==="false-value"&&(i._falseValue=s),J1(i,t,s,o))};function x4(i,t,e,s){if(s)return!!(t==="innerHTML"||t==="textContent"||t in i&&sy(t)&&It(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&i.tagName==="INPUT"||t==="type"&&i.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=i.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return sy(t)&&Ze(e)?!1:t in i}const Zr=i=>{const t=i.props["onUpdate:modelValue"]||!1;return St(t)?e=>Zu(t,e):t};function S4(i){i.target.composing=!0}function ny(i){const t=i.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ss=Symbol("_assign"),vf={created(i,{modifiers:{lazy:t,trim:e,number:s}},n){i[Ss]=Zr(n);const r=s||n.props&&n.props.type==="number";Fn(i,t?"change":"input",o=>{if(o.target.composing)return;let a=i.value;e&&(a=a.trim()),r&&(a=cf(a)),i[Ss](a)}),e&&Fn(i,"change",()=>{i.value=i.value.trim()}),t||(Fn(i,"compositionstart",S4),Fn(i,"compositionend",ny),Fn(i,"change",ny))},mounted(i,{value:t}){i.value=t??""},beforeUpdate(i,{value:t,oldValue:e,modifiers:{lazy:s,trim:n,number:r}},o){if(i[Ss]=Zr(o),i.composing)return;const a=(r||i.type==="number")&&!/^0\d/.test(i.value)?cf(i.value):i.value,l=t??"";a!==l&&(document.activeElement===i&&i.type!=="range"&&(s&&t===e||n&&i.value.trim()===l)||(i.value=l))}},Zg={deep:!0,created(i,t,e){i[Ss]=Zr(e),Fn(i,"change",()=>{const s=i._modelValue,n=Ia(i),r=i.checked,o=i[Ss];if(St(s)){const a=k0(s,n),l=a!==-1;if(r&&!l)o(s.concat(n));else if(!r&&l){const c=[...s];c.splice(a,1),o(c)}}else if(Ua(s)){const a=new Set(s);r?a.add(n):a.delete(n),o(a)}else o(Xx(i,r))})},mounted:ry,beforeUpdate(i,t,e){i[Ss]=Zr(e),ry(i,t,e)}};function ry(i,{value:t,oldValue:e},s){i._modelValue=t;let n;if(St(t))n=k0(t,s.props.value)>-1;else if(Ua(t))n=t.has(s.props.value);else{if(t===e)return;n=Ao(t,Xx(i,!0))}i.checked!==n&&(i.checked=n)}const w4={created(i,{value:t},e){i.checked=Ao(t,e.props.value),i[Ss]=Zr(e),Fn(i,"change",()=>{i[Ss](Ia(i))})},beforeUpdate(i,{value:t,oldValue:e},s){i[Ss]=Zr(s),t!==e&&(i.checked=Ao(t,s.props.value))}},V0={deep:!0,created(i,{value:t,modifiers:{number:e}},s){const n=Ua(t);Fn(i,"change",()=>{const r=Array.prototype.filter.call(i.options,o=>o.selected).map(o=>e?cf(Ia(o)):Ia(o));i[Ss](i.multiple?n?new Set(r):r:r[0]),i._assigning=!0,Sd(()=>{i._assigning=!1})}),i[Ss]=Zr(s)},mounted(i,{value:t}){oy(i,t)},beforeUpdate(i,t,e){i[Ss]=Zr(e)},updated(i,{value:t}){i._assigning||oy(i,t)}};function oy(i,t){const e=i.multiple,s=St(t);if(!(e&&!s&&!Ua(t))){for(let n=0,r=i.options.length;n<r;n++){const o=i.options[n],a=Ia(o);if(e)if(s){const l=typeof a;l==="string"||l==="number"?o.selected=t.some(c=>String(c)===String(a)):o.selected=k0(t,a)>-1}else o.selected=t.has(a);else if(Ao(Ia(o),t)){i.selectedIndex!==n&&(i.selectedIndex=n);return}}!e&&i.selectedIndex!==-1&&(i.selectedIndex=-1)}}function Ia(i){return"_value"in i?i._value:i.value}function Xx(i,t){const e=t?"_trueValue":"_falseValue";return e in i?i[e]:t}const k4={created(i,t,e){Lh(i,t,e,null,"created")},mounted(i,t,e){Lh(i,t,e,null,"mounted")},beforeUpdate(i,t,e,s){Lh(i,t,e,s,"beforeUpdate")},updated(i,t,e,s){Lh(i,t,e,s,"updated")}};function C4(i,t){switch(i){case"SELECT":return V0;case"TEXTAREA":return vf;default:switch(t){case"checkbox":return Zg;case"radio":return w4;default:return vf}}}function Lh(i,t,e,s,n){const o=C4(i.tagName,e.props&&e.props.type)[n];o&&o(i,t,e,s)}const T4=["ctrl","shift","alt","meta"],P4={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,t)=>T4.some(e=>i[`${e}Key`]&&!t.includes(e))},ln=(i,t)=>{const e=i._withMods||(i._withMods={}),s=t.join(".");return e[s]||(e[s]=((n,...r)=>{for(let o=0;o<t.length;o++){const a=P4[t[o]];if(a&&a(n,t))return}return i(n,...r)}))},A4=gi({patchProp:_4},o4);let ay;function M4(){return ay||(ay=TT(A4))}const E4=((...i)=>{const t=M4().createApp(...i),{mount:e}=t;return t.mount=s=>{const n=Q4(s);if(!n)return;const r=t._component;!It(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const o=e(n,!1,R4(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t});function R4(i){if(i instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&i instanceof MathMLElement)return"mathml"}function Q4(i){return Ze(i)?document.querySelector(i):i}const zx="15.1.22",ly=(i,t,e)=>({endTime:t,insertTime:e,type:"exponentialRampToValue",value:i}),cy=(i,t,e)=>({endTime:t,insertTime:e,type:"linearRampToValue",value:i}),Fg=(i,t)=>({startTime:t,type:"setValue",value:i}),jx=(i,t,e)=>({duration:e,startTime:t,type:"setValueCurve",values:i}),Gx=(i,t,{startTime:e,target:s,timeConstant:n})=>s+(t-s)*Math.exp((e-i)/n),fa=i=>i.type==="exponentialRampToValue",_f=i=>i.type==="linearRampToValue",xr=i=>fa(i)||_f(i),B0=i=>i.type==="setValue",Ln=i=>i.type==="setValueCurve",xf=(i,t,e,s)=>{const n=i[t];return n===void 0?s:xr(n)||B0(n)?n.value:Ln(n)?n.values[n.values.length-1]:Gx(e,xf(i,t-1,n.startTime,s),n)},hy=(i,t,e,s,n)=>e===void 0?[s.insertTime,n]:xr(e)?[e.endTime,e.value]:B0(e)?[e.startTime,e.value]:Ln(e)?[e.startTime+e.duration,e.values[e.values.length-1]]:[e.startTime,xf(i,t-1,e.startTime,n)],Wg=i=>i.type==="cancelAndHold",qg=i=>i.type==="cancelScheduledValues",pr=i=>Wg(i)||qg(i)?i.cancelTime:fa(i)||_f(i)?i.endTime:i.startTime,uy=(i,t,e,{endTime:s,value:n})=>e===n?n:0<e&&0<n||e<0&&n<0?e*(n/e)**((i-t)/(s-t)):0,fy=(i,t,e,{endTime:s,value:n})=>e+(i-t)/(s-t)*(n-e),I4=(i,t)=>{const e=Math.floor(t),s=Math.ceil(t);return e===s?i[e]:(1-(t-e))*i[e]+(1-(s-t))*i[s]},$4=(i,{duration:t,startTime:e,values:s})=>{const n=(i-e)/t*(s.length-1);return I4(s,n)},Vh=i=>i.type==="setTarget";class N4{constructor(t){this._automationEvents=[],this._currenTime=0,this._defaultValue=t}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(t){const e=pr(t);if(Wg(t)||qg(t)){const s=this._automationEvents.findIndex(r=>qg(t)&&Ln(r)?r.startTime+r.duration>=e:pr(r)>=e),n=this._automationEvents[s];if(s!==-1&&(this._automationEvents=this._automationEvents.slice(0,s)),Wg(t)){const r=this._automationEvents[this._automationEvents.length-1];if(n!==void 0&&xr(n)){if(r!==void 0&&Vh(r))throw new Error("The internal list is malformed.");const o=r===void 0?n.insertTime:Ln(r)?r.startTime+r.duration:pr(r),a=r===void 0?this._defaultValue:Ln(r)?r.values[r.values.length-1]:r.value,l=fa(n)?uy(e,o,a,n):fy(e,o,a,n),c=fa(n)?ly(l,e,this._currenTime):cy(l,e,this._currenTime);this._automationEvents.push(c)}if(r!==void 0&&Vh(r)&&this._automationEvents.push(Fg(this.getValue(e),e)),r!==void 0&&Ln(r)&&r.startTime+r.duration>e){const o=e-r.startTime,a=(r.values.length-1)/r.duration,l=Math.max(2,1+Math.ceil(o*a)),c=o/(l-1)*a,h=r.values.slice(0,l);if(c<1)for(let u=1;u<l;u+=1){const f=c*u%1;h[u]=r.values[u-1]*(1-f)+r.values[u]*f}this._automationEvents[this._automationEvents.length-1]=jx(h,r.startTime,o)}}}else{const s=this._automationEvents.findIndex(o=>pr(o)>e),n=s===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(n!==void 0&&Ln(n)&&pr(n)+n.duration>e)return!1;const r=fa(t)?ly(t.value,t.endTime,this._currenTime):_f(t)?cy(t.value,e,this._currenTime):t;if(s===-1)this._automationEvents.push(r);else{if(Ln(t)&&e+t.duration>pr(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,r)}}return!0}flush(t){const e=this._automationEvents.findIndex(s=>pr(s)>t);if(e>1){const s=this._automationEvents.slice(e-1),n=s[0];Vh(n)&&s.unshift(Fg(xf(this._automationEvents,e-2,n.startTime,this._defaultValue),n.startTime)),this._automationEvents=s}}getValue(t){if(this._automationEvents.length===0)return this._defaultValue;const e=this._automationEvents.findIndex(o=>pr(o)>t),s=this._automationEvents[e],n=(e===-1?this._automationEvents.length:e)-1,r=this._automationEvents[n];if(r!==void 0&&Vh(r)&&(s===void 0||!xr(s)||s.insertTime>t))return Gx(t,xf(this._automationEvents,n-1,r.startTime,this._defaultValue),r);if(r!==void 0&&B0(r)&&(s===void 0||!xr(s)))return r.value;if(r!==void 0&&Ln(r)&&(s===void 0||!xr(s)||r.startTime+r.duration>t))return t<r.startTime+r.duration?$4(t,r):r.values[r.values.length-1];if(r!==void 0&&xr(r)&&(s===void 0||!xr(s)))return r.value;if(s!==void 0&&fa(s)){const[o,a]=hy(this._automationEvents,n,r,s,this._defaultValue);return uy(t,o,a,s)}if(s!==void 0&&_f(s)){const[o,a]=hy(this._automationEvents,n,r,s,this._defaultValue);return fy(t,o,a,s)}return this._defaultValue}}const D4=i=>({cancelTime:i,type:"cancelAndHold"}),L4=i=>({cancelTime:i,type:"cancelScheduledValues"}),V4=(i,t)=>({endTime:t,type:"exponentialRampToValue",value:i}),B4=(i,t)=>({endTime:t,type:"linearRampToValue",value:i}),Z4=(i,t,e)=>({startTime:t,target:i,timeConstant:e,type:"setTarget"}),F4=()=>new DOMException("","AbortError"),W4=i=>(t,e,[s,n,r],o)=>{i(t[n],[e,s,r],a=>a[0]===e&&a[1]===s,o)},q4=i=>(t,e,s)=>{const n=[];for(let r=0;r<s.numberOfInputs;r+=1)n.push(new Set);i.set(t,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:e})},X4=i=>(t,e)=>{i.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})},$a=new WeakSet,Yx=new WeakMap,Z0=new WeakMap,Ux=new WeakMap,F0=new WeakMap,Ad=new WeakMap,Hx=new WeakMap,Xg=new WeakMap,zg=new WeakMap,jg=new WeakMap,Kx={construct(){return Kx}},z4=i=>{try{const t=new Proxy(i,Kx);new t}catch{return!1}return!0},dy=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,py=(i,t)=>{const e=[];let s=i.replace(/^[\s]+/,""),n=s.match(dy);for(;n!==null;){const r=n[1].slice(1,-1),o=n[0].replace(/([\s]+)?;?$/,"").replace(r,new URL(r,t).toString());e.push(o),s=s.slice(n[0].length).replace(/^[\s]+/,""),n=s.match(dy)}return[e.join(";"),s]},gy=i=>{if(i!==void 0&&!Array.isArray(i))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},my=i=>{if(!z4(i))throw new TypeError("The given value for processorCtor should be a constructor.");if(i.prototype===null||typeof i.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},j4=(i,t,e,s,n,r,o,a,l,c,h,u,f)=>{let d=0;return(p,g,m={credentials:"omit"})=>{const O=h.get(p);if(O!==void 0&&O.has(g))return Promise.resolve();const b=c.get(p);if(b!==void 0){const y=b.get(g);if(y!==void 0)return y}const x=r(p),v=x.audioWorklet===void 0?n(g).then(([y,_])=>{const[S,k]=py(y,_),A=`${S};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return e(A)}).then(()=>{const y=f._AWGS.pop();if(y===void 0)throw new SyntaxError;s(x.currentTime,x.sampleRate,()=>y(class{},void 0,(_,S)=>{if(_.trim()==="")throw t();const k=zg.get(x);if(k!==void 0){if(k.has(_))throw t();my(S),gy(S.parameterDescriptors),k.set(_,S)}else my(S),gy(S.parameterDescriptors),zg.set(x,new Map([[_,S]]))},x.sampleRate,void 0,void 0))}):Promise.all([n(g),Promise.resolve(i(u,u))]).then(([[y,_],S])=>{const k=d+1;d=k;const[A,M]=py(y,_),N=`${A};((AudioWorkletProcessor,registerProcessor)=>{${M}
})(${S?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${S?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${S?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,L=new Blob([N],{type:"application/javascript; charset=utf-8"}),I=URL.createObjectURL(L);return x.audioWorklet.addModule(I,m).then(()=>{if(a(x))return x;const Z=o(x);return Z.audioWorklet.addModule(I,m).then(()=>Z)}).then(Z=>{if(l===null)throw new SyntaxError;try{new l(Z,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(I))});return b===void 0?c.set(p,new Map([[g,v]])):b.set(g,v),v.then(()=>{const y=h.get(p);y===void 0?h.set(p,new Set([g])):y.add(g)}).finally(()=>{const y=c.get(p);y!==void 0&&y.delete(g)}),v}},Bs=(i,t)=>{const e=i.get(t);if(e===void 0)throw new Error("A value with the given key could not be found.");return e},Md=(i,t)=>{const e=Array.from(i).filter(t);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");const[s]=e;return i.delete(s),s},Jx=(i,t,e,s)=>{const n=Bs(i,t),r=Md(n,o=>o[0]===e&&o[1]===s);return n.size===0&&i.delete(t),r},eh=i=>Bs(Hx,i),Na=i=>{if($a.has(i))throw new Error("The AudioNode is already stored.");$a.add(i),eh(i).forEach(t=>t(!0))},t2=i=>"port"in i,ih=i=>{if(!$a.has(i))throw new Error("The AudioNode is not stored.");$a.delete(i),eh(i).forEach(t=>t(!1))},Gg=(i,t)=>{!t2(i)&&t.every(e=>e.size===0)&&ih(i)},G4=(i,t,e,s,n,r,o,a,l,c,h,u,f)=>{const d=new WeakMap;return(p,g,m,O,b)=>{const{activeInputs:x,passiveInputs:v}=r(g),{outputs:y}=r(p),_=a(p),S=k=>{const A=l(g),M=l(p);if(k){const R=Jx(v,p,m,O);i(x,p,R,!1),!b&&!u(p)&&e(M,A,m,O),f(g)&&Na(g)}else{const R=s(x,p,m,O);t(v,O,R,!1),!b&&!u(p)&&n(M,A,m,O);const C=o(g);if(C===0)h(g)&&Gg(g,x);else{const $=d.get(g);$!==void 0&&clearTimeout($),d.set(g,setTimeout(()=>{h(g)&&Gg(g,x)},C*1e3))}}};return c(y,[g,m,O],k=>k[0]===g&&k[1]===m&&k[2]===O,!0)?(_.add(S),h(p)?i(x,p,[m,O,S],!0):t(v,O,[p,m,S],!0),!0):!1}},Y4=i=>(t,e,[s,n,r],o)=>{const a=t.get(s);a===void 0?t.set(s,new Set([[n,e,r]])):i(a,[n,e,r],l=>l[0]===n&&l[1]===e,o)},U4=i=>(t,e)=>{const s=i(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(s).connect(t.destination);const n=()=>{e.removeEventListener("ended",n),e.disconnect(s),s.disconnect()};e.addEventListener("ended",n)},H4=i=>(t,e)=>{i(t).add(e)},K4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},J4=(i,t,e,s,n,r)=>class extends i{constructor(a,l){const c=n(a),h={...K4,...l},u=s(c,h),f=r(c)?t():null;super(a,!1,u,f),this._nativeAnalyserNode=u}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=l,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},yi=(i,t)=>i.context===t,tP=(i,t,e)=>()=>{const s=new WeakMap,n=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=i(o,c)}return s.set(o,a),await e(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):n(r,o)}}},Sf=i=>{try{i.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},kn=()=>new DOMException("","IndexSizeError"),W0=i=>{i.getChannelData=(t=>e=>{try{return t.call(i,e)}catch(s){throw s.code===12?kn():s}})(i.getChannelData)},eP={numberOfChannels:1},iP=(i,t,e,s,n,r,o,a)=>{let l=null;return class e2{constructor(h){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:u,numberOfChannels:f,sampleRate:d}={...eP,...h};l===null&&(l=new n(1,1,44100));const p=s!==null&&t(r,r)?new s({length:u,numberOfChannels:f,sampleRate:d}):l.createBuffer(f,u,d);if(p.numberOfChannels===0)throw e();return typeof p.copyFromChannel!="function"?(o(p),W0(p)):t(Sf,()=>Sf(p))||a(p),i.add(p),p}static[Symbol.hasInstance](h){return h!==null&&typeof h=="object"&&Object.getPrototypeOf(h)===e2.prototype||i.has(h)}}},Vi=-34028234663852886e22,ki=-Vi,Xn=i=>$a.has(i),sP={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},nP=(i,t,e,s,n,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f={...sP,...h},d=n(u,f),p=o(u),g=p?t():null;super(c,!1,d,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=e(this,p,d.playbackRate,ki,Vi)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const h=typeof c=="function"?a(this,c):null;this._nativeAudioBufferSourceNode.onended=h;const u=this._nativeAudioBufferSourceNode.onended;this._onended=u!==null&&u===h?c:u}get playbackRate(){return this._playbackRate}start(c=0,h=0,u){if(this._nativeAudioBufferSourceNode.start(c,h,u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=u===void 0?[c,h]:[c,h,u]),this.context.state!=="closed"){Na(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Xn(this)&&ih(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},rP=(i,t,e,s,n)=>()=>{const r=new WeakMap;let o=null,a=null;const l=async(c,h)=>{let u=e(c);const f=yi(u,h);if(!f){const d={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,loop:u.loop,loopEnd:u.loopEnd,loopStart:u.loopStart,playbackRate:u.playbackRate.value};u=t(h,d),o!==null&&u.start(...o),a!==null&&u.stop(a)}return r.set(h,u),f?await i(h,c.playbackRate,u.playbackRate):await s(h,c.playbackRate,u.playbackRate),await n(c,h,u),u};return{set start(c){o=c},set stop(c){a=c},render(c,h){const u=r.get(h);return u!==void 0?Promise.resolve(u):l(c,h)}}},oP=i=>"playbackRate"in i,aP=i=>"frequency"in i&&"gain"in i,lP=i=>"offset"in i,cP=i=>!("frequency"in i)&&"gain"in i,hP=i=>"detune"in i&&"frequency"in i&&!("gain"in i),uP=i=>"pan"in i,Pi=i=>Bs(Yx,i),sh=i=>Bs(Ux,i),Yg=(i,t)=>{const{activeInputs:e}=Pi(i);e.forEach(n=>n.forEach(([r])=>{t.includes(i)||Yg(r,[...t,i])}));const s=oP(i)?[i.playbackRate]:t2(i)?Array.from(i.parameters.values()):aP(i)?[i.Q,i.detune,i.frequency,i.gain]:lP(i)?[i.offset]:cP(i)?[i.gain]:hP(i)?[i.detune,i.frequency]:uP(i)?[i.pan]:[];for(const n of s){const r=sh(n);r!==void 0&&r.activeInputs.forEach(([o])=>Yg(o,t))}Xn(i)&&ih(i)},i2=i=>{Yg(i.destination,[])},fP=i=>i===void 0||typeof i=="number"||typeof i=="string"&&(i==="balanced"||i==="interactive"||i==="playback"),dP=(i,t,e,s,n,r,o,a,l)=>class extends i{constructor(h={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let u;try{u=new l(h)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?e():p}if(u===null)throw s();if(!fP(h.latencyHint))throw new TypeError(`The provided value '${h.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(h.sampleRate!==void 0&&u.sampleRate!==h.sampleRate)throw e();super(u,2);const{latencyHint:f}=h,{sampleRate:d}=u;if(this._baseLatency=typeof u.baseLatency=="number"?u.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=u,l.name==="webkitAudioContext"?(this._nativeGainNode=u.createGain(),this._nativeOscillatorNode=u.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(u.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,u.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),u.removeEventListener("statechange",p)};u.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),i2(this)}))}createMediaElementSource(h){return new n(this,{mediaElement:h})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(h){return new o(this,{mediaStream:h})}createMediaStreamTrackSource(h){return new a(this,{mediaStreamTrack:h})}resume(){return this._state==="suspended"?new Promise((h,u)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?h():this.resume().then(h,u)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(h=>{throw h===void 0||h.code===15?t():h})}suspend(){return this._nativeAudioContext.suspend().catch(h=>{throw h===void 0?t():h})}},pP=(i,t,e,s,n,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f=o(u),d=n(u,h,f),p=f?t(a):null;super(c,!1,d,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},gP=i=>{const t=new WeakMap,e=async(s,n)=>{const r=n.destination;return t.set(n,r),await i(s,n,r),r};return{render(s,n){const r=t.get(n);return r!==void 0?Promise.resolve(r):e(s,n)}}},mP=(i,t,e,s,n,r,o,a)=>(l,c)=>{const h=c.listener,u=()=>{const y=new Float32Array(1),_=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),S=o(c);let k=!1,A=[0,0,-1,0,1,0],M=[0,0,0];const R=()=>{if(k)return;k=!0;const L=s(c,256,9,0);L.onaudioprocess=({inputBuffer:I})=>{const Z=[r(I,y,0),r(I,y,1),r(I,y,2),r(I,y,3),r(I,y,4),r(I,y,5)];Z.some((z,et)=>z!==A[et])&&(h.setOrientation(...Z),A=Z);const F=[r(I,y,6),r(I,y,7),r(I,y,8)];F.some((z,et)=>z!==M[et])&&(h.setPosition(...F),M=F)},_.connect(L)},C=L=>I=>{I!==A[L]&&(A[L]=I,h.setOrientation(...A))},$=L=>I=>{I!==M[L]&&(M[L]=I,h.setPosition(...M))},N=(L,I,Z)=>{const F=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:I});F.connect(_,0,L),F.start(),Object.defineProperty(F.offset,"defaultValue",{get(){return I}});const z=i({context:l},S,F.offset,ki,Vi);return a(z,"value",et=>()=>et.call(z),et=>K=>{try{et.call(z,K)}catch(ot){if(ot.code!==9)throw ot}R(),S&&Z(K)}),z.cancelAndHoldAtTime=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.cancelAndHoldAtTime),z.cancelScheduledValues=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.cancelScheduledValues),z.exponentialRampToValueAtTime=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.exponentialRampToValueAtTime),z.linearRampToValueAtTime=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.linearRampToValueAtTime),z.setTargetAtTime=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.setTargetAtTime),z.setValueAtTime=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.setValueAtTime),z.setValueCurveAtTime=(et=>S?()=>{throw n()}:(...K)=>{const ot=et.apply(z,K);return R(),ot})(z.setValueCurveAtTime),z};return{forwardX:N(0,0,C(0)),forwardY:N(1,0,C(1)),forwardZ:N(2,-1,C(2)),positionX:N(6,0,$(0)),positionY:N(7,0,$(1)),positionZ:N(8,0,$(2)),upX:N(3,0,C(3)),upY:N(4,1,C(4)),upZ:N(5,0,C(5))}},{forwardX:f,forwardY:d,forwardZ:p,positionX:g,positionY:m,positionZ:O,upX:b,upY:x,upZ:v}=h.forwardX===void 0?u():h;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return p},get positionX(){return g},get positionY(){return m},get positionZ(){return O},get upX(){return b},get upY(){return x},get upZ(){return v}}},wf=i=>"context"in i,nh=i=>wf(i[0]),Bo=(i,t,e,s)=>{for(const n of i)if(e(n)){if(s)return!1;throw Error("The set contains at least one similar element.")}return i.add(t),!0},Oy=(i,t,[e,s],n)=>{Bo(i,[t,e,s],r=>r[0]===t&&r[1]===e,n)},yy=(i,[t,e,s],n)=>{const r=i.get(t);r===void 0?i.set(t,new Set([[e,s]])):Bo(r,[e,s],o=>o[0]===e,n)},Ha=i=>"inputs"in i,kf=(i,t,e,s)=>{if(Ha(t)){const n=t.inputs[s];return i.connect(n,e,0),[n,e,0]}return i.connect(t,e,s),[t,e,s]},s2=(i,t,e)=>{for(const s of i)if(s[0]===t&&s[1]===e)return i.delete(s),s;return null},OP=(i,t,e)=>Md(i,s=>s[0]===t&&s[1]===e),n2=(i,t)=>{if(!eh(i).delete(t))throw new Error("Missing the expected event listener.")},r2=(i,t,e)=>{const s=Bs(i,t),n=Md(s,r=>r[0]===e);return s.size===0&&i.delete(t),n},Cf=(i,t,e,s)=>{Ha(t)?i.disconnect(t.inputs[s],e,0):i.disconnect(t,e,s)},ye=i=>Bs(Z0,i),kc=i=>Bs(F0,i),Eo=i=>Xg.has(i),Xu=i=>!$a.has(i),by=(i,t)=>new Promise(e=>{if(t!==null)e(!0);else{const s=i.createScriptProcessor(256,1,1),n=i.createGain(),r=i.createBuffer(1,2,44100),o=r.getChannelData(0);o[0]=1,o[1]=1;const a=i.createBufferSource();a.buffer=r,a.loop=!0,a.connect(s).connect(i.destination),a.connect(n),a.disconnect(n),s.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,h=>h===1)?e(!0):e(!1),a.stop(),s.onaudioprocess=null,a.disconnect(s),s.disconnect(i.destination)},a.start()}}),Mp=(i,t)=>{const e=new Map;for(const s of i)for(const n of s){const r=e.get(n);e.set(n,r===void 0?1:r+1)}e.forEach((s,n)=>t(n,s))},Tf=i=>"context"in i,yP=i=>{const t=new Map;i.connect=(e=>(s,n=0,r=0)=>{const o=Tf(s)?e(s,n,r):e(s,n),a=t.get(s);return a===void 0?t.set(s,[{input:r,output:n}]):a.every(l=>l.input!==r||l.output!==n)&&a.push({input:r,output:n}),o})(i.connect.bind(i)),i.disconnect=(e=>(s,n,r)=>{if(e.apply(i),s===void 0)t.clear();else if(typeof s=="number")for(const[o,a]of t){const l=a.filter(c=>c.output!==s);l.length===0?t.delete(o):t.set(o,l)}else if(t.has(s))if(n===void 0)t.delete(s);else{const o=t.get(s);if(o!==void 0){const a=o.filter(l=>l.output!==n&&(l.input!==r||r===void 0));a.length===0?t.delete(s):t.set(s,a)}}for(const[o,a]of t)a.forEach(l=>{Tf(o)?i.connect(o,l.output,l.input):i.connect(o,l.output)})})(i.disconnect)},bP=(i,t,e,s)=>{const{activeInputs:n,passiveInputs:r}=sh(t),{outputs:o}=Pi(i),a=eh(i),l=c=>{const h=ye(i),u=kc(t);if(c){const f=r2(r,i,e);Oy(n,i,f,!1),!s&&!Eo(i)&&h.connect(u,e)}else{const f=OP(n,i,e);yy(r,f,!1),!s&&!Eo(i)&&h.disconnect(u,e)}};return Bo(o,[t,e],c=>c[0]===t&&c[1]===e,!0)?(a.add(l),Xn(i)?Oy(n,i,[e,l],!0):yy(r,[i,e,l],!0),!0):!1},vP=(i,t,e,s)=>{const{activeInputs:n,passiveInputs:r}=Pi(t),o=s2(n[s],i,e);return o===null?[Jx(r,i,e,s)[2],!1]:[o[2],!0]},_P=(i,t,e)=>{const{activeInputs:s,passiveInputs:n}=sh(t),r=s2(s,i,e);return r===null?[r2(n,i,e)[1],!1]:[r[2],!0]},q0=(i,t,e,s,n)=>{const[r,o]=vP(i,e,s,n);if(r!==null&&(n2(i,r),o&&!t&&!Eo(i)&&Cf(ye(i),ye(e),s,n)),Xn(e)){const{activeInputs:a}=Pi(e);Gg(e,a)}},X0=(i,t,e,s)=>{const[n,r]=_P(i,e,s);n!==null&&(n2(i,n),r&&!t&&!Eo(i)&&ye(i).disconnect(kc(e),s))},xP=(i,t)=>{const e=Pi(i),s=[];for(const n of e.outputs)nh(n)?q0(i,t,...n):X0(i,t,...n),s.push(n[0]);return e.outputs.clear(),s},SP=(i,t,e)=>{const s=Pi(i),n=[];for(const r of s.outputs)r[1]===e&&(nh(r)?q0(i,t,...r):X0(i,t,...r),n.push(r[0]),s.outputs.delete(r));return n},wP=(i,t,e,s,n)=>{const r=Pi(i);return Array.from(r.outputs).filter(o=>o[0]===e&&(s===void 0||o[1]===s)&&(n===void 0||o[2]===n)).map(o=>(nh(o)?q0(i,t,...o):X0(i,t,...o),r.outputs.delete(o),o[0]))},kP=(i,t,e,s,n,r,o,a,l,c,h,u,f,d,p,g)=>class extends c{constructor(O,b,x,v){super(x),this._context=O,this._nativeAudioNode=x;const y=h(O);u(y)&&e(by,()=>by(y,g))!==!0&&yP(x),Z0.set(this,x),Hx.set(this,new Set),O.state!=="closed"&&b&&Na(this),i(this,v,x)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(O){this._nativeAudioNode.channelCount=O}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(O){this._nativeAudioNode.channelCountMode=O}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(O){this._nativeAudioNode.channelInterpretation=O}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(O,b=0,x=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw n();const v=h(this._context),y=p(v);if(f(O)||d(O))throw r();if(wf(O)){const k=ye(O);try{const M=kf(this._nativeAudioNode,k,b,x),R=Xu(this);(y||R)&&this._nativeAudioNode.disconnect(...M),this.context.state!=="closed"&&!R&&Xu(O)&&Na(O)}catch(M){throw M.code===12?r():M}if(t(this,O,b,x,y)){const M=l([this],O);Mp(M,s(y))}return O}const _=kc(O);if(_.name==="playbackRate"&&_.maxValue===1024)throw o();try{this._nativeAudioNode.connect(_,b),(y||Xu(this))&&this._nativeAudioNode.disconnect(_,b)}catch(k){throw k.code===12?r():k}if(bP(this,O,b,y)){const k=l([this],O);Mp(k,s(y))}}disconnect(O,b,x){let v;const y=h(this._context),_=p(y);if(O===void 0)v=xP(this,_);else if(typeof O=="number"){if(O<0||O>=this.numberOfOutputs)throw n();v=SP(this,_,O)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||wf(O)&&x!==void 0&&(x<0||x>=O.numberOfInputs))throw n();if(v=wP(this,_,O,b,x),v.length===0)throw r()}for(const S of v){const k=l([this],S);Mp(k,a)}}},CP=(i,t,e,s,n,r,o,a,l,c,h,u,f)=>(d,p,g,m=null,O=null)=>{const b=g.value,x=new N4(b),v=p?s(x):null,y={get defaultValue(){return b},get maxValue(){return m===null?g.maxValue:m},get minValue(){return O===null?g.minValue:O},get value(){return g.value},set value(_){g.value=_,y.setValueAtTime(_,d.context.currentTime)},cancelAndHoldAtTime(_){if(typeof g.cancelAndHoldAtTime=="function")v===null&&x.flush(d.context.currentTime),x.add(n(_)),g.cancelAndHoldAtTime(_);else{const S=Array.from(x).pop();v===null&&x.flush(d.context.currentTime),x.add(n(_));const k=Array.from(x).pop();g.cancelScheduledValues(_),S!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?g.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?g.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&g.setValueCurveAtTime(k.values,k.startTime,k.duration))}return y},cancelScheduledValues(_){return v===null&&x.flush(d.context.currentTime),x.add(r(_)),g.cancelScheduledValues(_),y},exponentialRampToValueAtTime(_,S){if(_===0)throw new RangeError;if(!Number.isFinite(S)||S<0)throw new RangeError;const k=d.context.currentTime;return v===null&&x.flush(k),Array.from(x).length===0&&(x.add(c(b,k)),g.setValueAtTime(b,k)),x.add(o(_,S)),g.exponentialRampToValueAtTime(_,S),y},linearRampToValueAtTime(_,S){const k=d.context.currentTime;return v===null&&x.flush(k),Array.from(x).length===0&&(x.add(c(b,k)),g.setValueAtTime(b,k)),x.add(a(_,S)),g.linearRampToValueAtTime(_,S),y},setTargetAtTime(_,S,k){return v===null&&x.flush(d.context.currentTime),x.add(l(_,S,k)),g.setTargetAtTime(_,S,k),y},setValueAtTime(_,S){return v===null&&x.flush(d.context.currentTime),x.add(c(_,S)),g.setValueAtTime(_,S),y},setValueCurveAtTime(_,S,k){const A=_ instanceof Float32Array?_:new Float32Array(_);if(u!==null&&u.name==="webkitAudioContext"){const M=S+k,R=d.context.sampleRate,C=Math.ceil(S*R),$=Math.floor(M*R),N=$-C,L=new Float32Array(N);for(let Z=0;Z<N;Z+=1){const F=(A.length-1)/k*((C+Z)/R-S),z=Math.floor(F),et=Math.ceil(F);L[Z]=z===et?A[z]:(1-(F-z))*A[z]+(1-(et-F))*A[et]}v===null&&x.flush(d.context.currentTime),x.add(h(L,S,k)),g.setValueCurveAtTime(L,S,k);const I=$/R;I<M&&f(y,L[L.length-1],I),f(y,A[A.length-1],M)}else v===null&&x.flush(d.context.currentTime),x.add(h(A,S,k)),g.setValueCurveAtTime(A,S,k);return y}};return e.set(y,g),t.set(y,d),i(y,v),y},TP=i=>({replay(t){for(const e of i)if(e.type==="exponentialRampToValue"){const{endTime:s,value:n}=e;t.exponentialRampToValueAtTime(n,s)}else if(e.type==="linearRampToValue"){const{endTime:s,value:n}=e;t.linearRampToValueAtTime(n,s)}else if(e.type==="setTarget"){const{startTime:s,target:n,timeConstant:r}=e;t.setTargetAtTime(n,s,r)}else if(e.type==="setValue"){const{startTime:s,value:n}=e;t.setValueAtTime(n,s)}else if(e.type==="setValueCurve"){const{duration:s,startTime:n,values:r}=e;t.setValueCurveAtTime(r,n,s)}else throw new Error("Can't apply an unknown automation.")}});class o2{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((s,n)=>t.call(e,s,n,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const PP={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},AP=(i,t,e,s,n,r,o,a,l,c,h,u,f,d)=>class extends t{constructor(g,m,O){var b;const x=a(g),v=l(x),y=h({...PP,...O});f(y);const _=zg.get(x),S=_?.get(m),k=v||x.state!=="closed"?x:(b=o(x))!==null&&b!==void 0?b:x,A=n(k,v?null:g.baseLatency,c,m,S,y),M=v?s(m,y,S):null;super(g,!0,A,M);const R=[];A.parameters.forEach(($,N)=>{const L=e(this,v,$);R.push([N,L])}),this._nativeAudioWorkletNode=A,this._onprocessorerror=null,this._parameters=new o2(R),v&&i(x,this);const{activeInputs:C}=r(this);u(A,C)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const m=typeof g=="function"?d(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=m;const O=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=O!==null&&O===m?g:O}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Pf(i,t,e,s,n){if(typeof i.copyFromChannel=="function")t[e].byteLength===0&&(t[e]=new Float32Array(128)),i.copyFromChannel(t[e],s,n);else{const r=i.getChannelData(s);if(t[e].byteLength===0)t[e]=r.slice(n,n+128);else{const o=new Float32Array(r.buffer,n*Float32Array.BYTES_PER_ELEMENT,128);t[e].set(o)}}}const a2=(i,t,e,s,n)=>{typeof i.copyToChannel=="function"?t[e].byteLength!==0&&i.copyToChannel(t[e],s,n):t[e].byteLength!==0&&i.getChannelData(s).set(t[e],n)},Af=(i,t)=>{const e=[];for(let s=0;s<i;s+=1){const n=[],r=typeof t=="number"?t:t[s];for(let o=0;o<r;o+=1)n.push(new Float32Array(128));e.push(n)}return e},MP=(i,t)=>{const e=Bs(jg,i),s=ye(t);return Bs(e,s)},EP=async(i,t,e,s,n,r,o)=>{const a=t===null?Math.ceil(i.context.length/128)*128:t.length,l=s.channelCount*s.numberOfInputs,c=n.reduce((m,O)=>m+O,0),h=c===0?null:e.createBuffer(c,a,e.sampleRate);if(r===void 0)throw new Error("Missing the processor constructor.");const u=Pi(i),f=await MP(e,i),d=Af(s.numberOfInputs,s.channelCount),p=Af(s.numberOfOutputs,n),g=Array.from(i.parameters.keys()).reduce((m,O)=>({...m,[O]:new Float32Array(128)}),{});for(let m=0;m<a;m+=128){if(s.numberOfInputs>0&&t!==null)for(let O=0;O<s.numberOfInputs;O+=1)for(let b=0;b<s.channelCount;b+=1)Pf(t,d[O],b,b,m);r.parameterDescriptors!==void 0&&t!==null&&r.parameterDescriptors.forEach(({name:O},b)=>{Pf(t,g,O,l+b,m)});for(let O=0;O<s.numberOfInputs;O+=1)for(let b=0;b<n[O];b+=1)p[O][b].byteLength===0&&(p[O][b]=new Float32Array(128));try{const O=d.map((x,v)=>u.activeInputs[v].size===0?[]:x),b=o(m/e.sampleRate,e.sampleRate,()=>f.process(O,p,g));if(h!==null)for(let x=0,v=0;x<s.numberOfOutputs;x+=1){for(let y=0;y<n[x];y+=1)a2(h,p[x],y,v+y,m);v+=n[x]}if(!b)break}catch(O){i.dispatchEvent(new ErrorEvent("processorerror",{colno:O.colno,filename:O.filename,lineno:O.lineno,message:O.message}));break}}return h},RP=(i,t,e,s,n,r,o,a,l,c,h,u,f,d,p,g)=>(m,O,b)=>{const x=new WeakMap;let v=null;const y=async(_,S)=>{let k=h(_),A=null;const M=yi(k,S),R=Array.isArray(O.outputChannelCount)?O.outputChannelCount:Array.from(O.outputChannelCount);if(u===null){const C=R.reduce((I,Z)=>I+Z,0),$=n(S,{channelCount:Math.max(1,C),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,C)}),N=[];for(let I=0;I<_.numberOfOutputs;I+=1)N.push(s(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[I]}));const L=o(S,{channelCount:O.channelCount,channelCountMode:O.channelCountMode,channelInterpretation:O.channelInterpretation,gain:1});L.connect=t.bind(null,N),L.disconnect=l.bind(null,N),A=[$,N,L]}else M||(k=new u(S,m));if(x.set(S,A===null?k:A[2]),A!==null){if(v===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Z=_.channelCount*_.numberOfInputs,F=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,z=Z+F;v=EP(_,z===0?null:await(async()=>{const K=new f(z,Math.ceil(_.context.length/128)*128,S.sampleRate),ot=[],Mt=[];for(let wt=0;wt<O.numberOfInputs;wt+=1)ot.push(o(K,{channelCount:O.channelCount,channelCountMode:O.channelCountMode,channelInterpretation:O.channelInterpretation,gain:1})),Mt.push(n(K,{channelCount:O.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:O.channelCount}));const jt=await Promise.all(Array.from(_.parameters.values()).map(async wt=>{const Ut=r(K,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:wt.value});return await d(K,wt,Ut.offset),Ut})),yt=s(K,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Z+F)});for(let wt=0;wt<O.numberOfInputs;wt+=1){ot[wt].connect(Mt[wt]);for(let Ut=0;Ut<O.channelCount;Ut+=1)Mt[wt].connect(yt,Ut,wt*O.channelCount+Ut)}for(const[wt,Ut]of jt.entries())Ut.connect(yt,0,Z+wt),Ut.start(0);return yt.connect(K.destination),await Promise.all(ot.map(wt=>p(_,K,wt))),g(K)})(),S,O,R,b,c)}const C=await v,$=e(S,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[N,L,I]=A;C!==null&&($.buffer=C,$.start(0)),$.connect(N);for(let Z=0,F=0;Z<_.numberOfOutputs;Z+=1){const z=L[Z];for(let et=0;et<R[Z];et+=1)N.connect(z,F+et,et);F+=R[Z]}return I}if(M)for(const[C,$]of _.parameters.entries())await i(S,$,k.parameters.get(C));else for(const[C,$]of _.parameters.entries())await d(S,$,k.parameters.get(C));return await p(_,S,k),k};return{render(_,S){a(S,_);const k=x.get(S);return k!==void 0?Promise.resolve(k):y(_,S)}}},QP=(i,t,e,s,n,r,o,a,l,c,h,u,f,d,p,g,m,O,b,x)=>class extends p{constructor(y,_){super(y,_),this._nativeContext=y,this._audioWorklet=i===void 0?void 0:{addModule:(S,k)=>i(this,S,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new n(this)}createBuffer(y,_,S){return new e({length:_,numberOfChannels:y,sampleRate:S})}createBufferSource(){return new s(this)}createChannelMerger(y=6){return new r(this,{numberOfInputs:y})}createChannelSplitter(y=6){return new o(this,{numberOfOutputs:y})}createConstantSource(){return new a(this)}createConvolver(){return new l(this)}createDelay(y=1){return new h(this,{maxDelayTime:y})}createDynamicsCompressor(){return new u(this)}createGain(){return new f(this)}createIIRFilter(y,_){return new d(this,{feedback:_,feedforward:y})}createOscillator(){return new g(this)}createPanner(){return new m(this)}createPeriodicWave(y,_,S={disableNormalization:!1}){return new O(this,{...S,imag:_,real:y})}createStereoPanner(){return new b(this)}createWaveShaper(){return new x(this)}decodeAudioData(y,_,S){return c(this._nativeContext,y).then(k=>(typeof _=="function"&&_(k),k),k=>{throw typeof S=="function"&&S(k),k})}},IP={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},$P=(i,t,e,s,n,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f={...IP,...h},d=n(u,f),p=o(u),g=p?e():null;super(c,!1,d,g),this._Q=t(this,p,d.Q,ki,Vi),this._detune=t(this,p,d.detune,1200*Math.log2(ki),-1200*Math.log2(ki)),this._frequency=t(this,p,d.frequency,c.sampleRate/2,0),this._gain=t(this,p,d.gain,40*Math.log10(ki),Vi),this._nativeBiquadFilterNode=d,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,h,u){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,h,u)}catch(f){throw f.code===11?s():f}if(c.length!==h.length||h.length!==u.length)throw s()}},NP=(i,t,e,s,n)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=t(l,u)}return r.set(l,c),h?(await i(l,a.Q,c.Q),await i(l,a.detune,c.detune),await i(l,a.frequency,c.frequency),await i(l,a.gain,c.gain)):(await s(l,a.Q,c.Q),await s(l,a.detune,c.detune),await s(l,a.frequency,c.frequency),await s(l,a.gain,c.gain)),await n(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},DP=(i,t)=>(e,s)=>{const n=t.get(e);if(n!==void 0)return n;const r=i.get(e);if(r!==void 0)return r;try{const o=s();return o instanceof Promise?(i.set(e,o),o.catch(()=>!1).then(a=>(i.delete(e),t.set(e,a),a))):(t.set(e,o),o)}catch{return t.set(e,!1),!1}},LP={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},VP=(i,t,e,s,n)=>class extends i{constructor(o,a){const l=s(o),c={...LP,...a},h=e(l,c),u=n(l)?t():null;super(o,!1,h,u)}},BP=(i,t,e)=>()=>{const s=new WeakMap,n=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=i(o,c)}return s.set(o,a),await e(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):n(r,o)}}},ZP={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},FP=(i,t,e,s,n,r)=>class extends i{constructor(a,l){const c=s(a),h=r({...ZP,...l}),u=e(c,h),f=n(c)?t():null;super(a,!1,u,f)}},WP=(i,t,e)=>()=>{const s=new WeakMap,n=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=i(o,c)}return s.set(o,a),await e(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):n(r,o)}}},qP=i=>(t,e,s)=>i(e,t,s),XP=i=>(t,e,s=0,n=0)=>{const r=t[s];if(r===void 0)throw i();return Tf(e)?r.connect(e,0,n):r.connect(e,0)},zP=i=>(t,e)=>{const s=i(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=t.createBuffer(1,2,44100);return s.buffer=n,s.loop=!0,s.connect(e),s.start(),()=>{s.stop(),s.disconnect(e)}},jP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},GP=(i,t,e,s,n,r,o)=>class extends i{constructor(l,c){const h=n(l),u={...jP,...c},f=s(h,u),d=r(h),p=d?e():null;super(l,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=t(this,d,f.offset,ki,Vi),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?o(this,l):null;this._nativeConstantSourceNode.onended=c;const h=this._nativeConstantSourceNode.onended;this._onended=h!==null&&h===c?l:h}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){Na(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),Xn(this)&&ih(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},YP=(i,t,e,s,n)=>()=>{const r=new WeakMap;let o=null,a=null;const l=async(c,h)=>{let u=e(c);const f=yi(u,h);if(!f){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,offset:u.offset.value};u=t(h,d),o!==null&&u.start(o),a!==null&&u.stop(a)}return r.set(h,u),f?await i(h,c.offset,u.offset):await s(h,c.offset,u.offset),await n(c,h,u),u};return{set start(c){o=c},set stop(c){a=c},render(c,h){const u=r.get(h);return u!==void 0?Promise.resolve(u):l(c,h)}}},UP=i=>t=>(i[0]=t,i[0]),HP={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},KP=(i,t,e,s,n,r)=>class extends i{constructor(a,l){const c=s(a),h={...HP,...l},u=e(c,h),d=n(c)?t():null;super(a,!1,u,d),this._isBufferNullified=!1,this._nativeConvolverNode=u,h.buffer!==null&&r(this,h.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},JP=(i,t,e)=>()=>{const s=new WeakMap,n=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=i(o,c)}return s.set(o,a),Ha(a)?await e(r,o,a.inputs[0]):await e(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):n(r,o)}}},t6=(i,t)=>(e,s,n)=>{if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(e,s,n)}catch(r){throw r.name==="SyntaxError"?i():r}},e6=()=>new DOMException("","DataCloneError"),vy=i=>{const{port1:t,port2:e}=new MessageChannel;return new Promise(s=>{const n=()=>{e.onmessage=null,t.close(),e.close(),s()};e.onmessage=()=>n();try{t.postMessage(i,[i])}catch{}finally{n()}})},i6=(i,t,e,s,n,r,o,a,l,c,h)=>(u,f)=>{const d=o(u)?u:r(u);if(n.has(f)){const p=e();return Promise.reject(p)}try{n.add(f)}catch{}return t(l,()=>l(d))?d.decodeAudioData(f).then(p=>(vy(f).catch(()=>{}),t(a,()=>a(p))||h(p),i.add(p),p)):new Promise((p,g)=>{const m=async()=>{try{await vy(f)}catch{}},O=b=>{g(b),m()};try{d.decodeAudioData(f,b=>{typeof b.copyFromChannel!="function"&&(c(b),W0(b)),i.add(b),m().then(()=>p(b))},b=>{O(b===null?s():b)})}catch(b){O(b)}})},s6=(i,t,e,s,n,r,o,a)=>(l,c)=>{const h=t.get(l);if(h===void 0)throw new Error("Missing the expected cycle count.");const u=r(l.context),f=a(u);if(h===c){if(t.delete(l),!f&&o(l)){const d=s(l),{outputs:p}=e(l);for(const g of p)if(nh(g)){const m=s(g[0]);i(d,m,g[1],g[2])}else{const m=n(g[0]);d.connect(m,g[1])}}}else t.set(l,h-c)},n6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},r6=(i,t,e,s,n,r,o)=>class extends i{constructor(l,c){const h=n(l),u={...n6,...c},f=s(h,u),d=r(h),p=d?e(u.maxDelayTime):null;super(l,!1,f,p),this._delayTime=t(this,d,f.delayTime),o(this,u.maxDelayTime)}get delayTime(){return this._delayTime}},o6=(i,t,e,s,n)=>r=>{const o=new WeakMap,a=async(l,c)=>{let h=e(l);const u=yi(h,c);if(!u){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:r};h=t(c,f)}return o.set(c,h),u?await i(c,l.delayTime,h.delayTime):await s(c,l.delayTime,h.delayTime),await n(l,c,h),h};return{render(l,c){const h=o.get(c);return h!==void 0?Promise.resolve(h):a(l,c)}}},a6=i=>(t,e,s,n)=>i(t[n],r=>r[0]===e&&r[1]===s),l6=i=>(t,e)=>{i(t).delete(e)},c6=i=>"delayTime"in i,h6=(i,t,e)=>function s(n,r){const o=wf(r)?r:e(i,r);if(c6(o))return[];if(n[0]===o)return[n];if(n.includes(o))return[];const{outputs:a}=t(o);return Array.from(a).map(l=>s([...n,o],l[0])).reduce((l,c)=>l.concat(c),[])},Bh=(i,t,e)=>{const s=t[e];if(s===void 0)throw i();return s},u6=i=>(t,e=void 0,s=void 0,n=0)=>e===void 0?t.forEach(r=>r.disconnect()):typeof e=="number"?Bh(i,t,e).disconnect():Tf(e)?s===void 0?t.forEach(r=>r.disconnect(e)):n===void 0?Bh(i,t,s).disconnect(e,0):Bh(i,t,s).disconnect(e,0,n):s===void 0?t.forEach(r=>r.disconnect(e)):Bh(i,t,s).disconnect(e,0),f6={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},d6=(i,t,e,s,n,r,o,a)=>class extends i{constructor(c,h){const u=r(c),f={...f6,...h},d=s(u,f),p=o(u),g=p?e():null;super(c,!1,d,g),this._attack=t(this,p,d.attack),this._knee=t(this,p,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=t(this,p,d.ratio),this._release=t(this,p,d.release),this._threshold=t(this,p,d.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const h=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=h,n()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const h=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=h,n()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},p6=(i,t,e,s,n)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=t(l,u)}return r.set(l,c),h?(await i(l,a.attack,c.attack),await i(l,a.knee,c.knee),await i(l,a.ratio,c.ratio),await i(l,a.release,c.release),await i(l,a.threshold,c.threshold)):(await s(l,a.attack,c.attack),await s(l,a.knee,c.knee),await s(l,a.ratio,c.ratio),await s(l,a.release,c.release),await s(l,a.threshold,c.threshold)),await n(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},g6=()=>new DOMException("","EncodingError"),m6=i=>t=>new Promise((e,s)=>{if(i===null){s(new SyntaxError);return}const n=i.document.head;if(n===null)s(new SyntaxError);else{const r=i.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(o),l=i.onerror,c=()=>{i.onerror=l,URL.revokeObjectURL(a)};i.onerror=(h,u,f,d,p)=>{if(u===a||u===i.location.href&&f===1&&d===1)return c(),s(p),!1;if(l!==null)return l(h,u,f,d,p)},r.onerror=()=>{c(),s(new SyntaxError)},r.onload=()=>{c(),e()},r.src=a,r.type="module",n.appendChild(r)}}),O6=i=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,s,n){if(s!==null){let r=this._listeners.get(s);r===void 0&&(r=i(this,s),typeof s=="function"&&this._listeners.set(s,r)),this._nativeEventTarget.addEventListener(e,r,n)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,s,n){const r=s===null?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(e,r===void 0?null:r,n)}},y6=i=>(t,e,s)=>{Object.defineProperties(i,{currentFrame:{configurable:!0,get(){return Math.round(t*e)}},currentTime:{configurable:!0,get(){return t}}});try{return s()}finally{i!==null&&(delete i.currentFrame,delete i.currentTime)}},b6=i=>async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw i()},v6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},_6=(i,t,e,s,n,r)=>class extends i{constructor(a,l){const c=n(a),h={...v6,...l},u=s(c,h),f=r(c),d=f?e():null;super(a,!1,u,d),this._gain=t(this,f,u.gain,ki,Vi)}get gain(){return this._gain}},x6=(i,t,e,s,n)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=t(l,u)}return r.set(l,c),h?await i(l,a.gain,c.gain):await s(l,a.gain,c.gain),await n(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},S6=(i,t)=>e=>t(i,e),w6=i=>t=>{const e=i(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer},k6=i=>t=>{var e;return(e=i.get(t))!==null&&e!==void 0?e:0},C6=i=>t=>{const e=i(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer},T6=i=>t=>i.get(t),Ke=()=>new DOMException("","InvalidStateError"),P6=i=>t=>{const e=i.get(t);if(e===void 0)throw Ke();return e},A6=(i,t)=>e=>{let s=i.get(e);if(s!==void 0)return s;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new t(1,1,44100),i.set(e,s),s},M6=i=>t=>{const e=i.get(t);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e},Ed=()=>new DOMException("","InvalidAccessError"),E6=i=>{i.getFrequencyResponse=(t=>(e,s,n)=>{if(e.length!==s.length||s.length!==n.length)throw Ed();return t.call(i,e,s,n)})(i.getFrequencyResponse)},R6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Q6=(i,t,e,s,n,r)=>class extends i{constructor(a,l){const c=s(a),h=n(c),u={...R6,...l},f=t(c,h?null:a.baseLatency,u),d=h?e(u.feedback,u.feedforward):null;super(a,!1,f,d),E6(f),this._nativeIIRFilterNode=f,r(this,1)}getFrequencyResponse(a,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(a,l,c)}},l2=(i,t,e,s,n,r,o,a,l,c,h)=>{const u=c.length;let f=a;for(let d=0;d<u;d+=1){let p=e[0]*c[d];for(let g=1;g<n;g+=1){const m=f-g&l-1;p+=e[g]*r[m],p-=i[g]*o[m]}for(let g=n;g<s;g+=1)p+=e[g]*r[f-g&l-1];for(let g=n;g<t;g+=1)p-=i[g]*o[f-g&l-1];r[f]=c[d],o[f]=p,f=f+1&l-1,h[d]=p}return f},I6=(i,t,e,s)=>{const n=e instanceof Float64Array?e:new Float64Array(e),r=s instanceof Float64Array?s:new Float64Array(s),o=n.length,a=r.length,l=Math.min(o,a);if(n[0]!==1){for(let p=0;p<o;p+=1)r[p]/=n[0];for(let p=1;p<a;p+=1)n[p]/=n[0]}const c=32,h=new Float32Array(c),u=new Float32Array(c),f=t.createBuffer(i.numberOfChannels,i.length,i.sampleRate),d=i.numberOfChannels;for(let p=0;p<d;p+=1){const g=i.getChannelData(p),m=f.getChannelData(p);h.fill(0),u.fill(0),l2(n,o,r,a,l,h,u,0,c,g,m)}return f},$6=(i,t,e,s,n)=>(r,o)=>{const a=new WeakMap;let l=null;const c=async(h,u)=>{let f=null,d=t(h);const p=yi(d,u);if(u.createIIRFilter===void 0?f=i(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=u.createIIRFilter(o,r)),a.set(u,f===null?d:f),f!==null){if(l===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");const m=new e(h.context.destination.channelCount,h.context.length,u.sampleRate);l=(async()=>{await s(h,m,m.destination);const O=await n(m);return I6(O,u,r,o)})()}const g=await l;return f.buffer=g,f.start(0),f}return await s(h,u,d),d};return{render(h,u){const f=a.get(u);return f!==void 0?Promise.resolve(f):c(h,u)}}},N6=(i,t,e,s,n,r)=>o=>(a,l)=>{const c=i.get(a);if(c===void 0){if(!o&&r(a)){const h=s(a),{outputs:u}=e(a);for(const f of u)if(nh(f)){const d=s(f[0]);t(h,d,f[1],f[2])}else{const d=n(f[0]);h.disconnect(d,f[1])}}i.set(a,l)}else i.set(a,c+l)},D6=(i,t)=>e=>{const s=i.get(e);return t(s)||t(e)},L6=(i,t)=>e=>i.has(e)||t(e),V6=(i,t)=>e=>i.has(e)||t(e),B6=(i,t)=>e=>{const s=i.get(e);return t(s)||t(e)},Z6=i=>t=>i!==null&&t instanceof i,F6=i=>t=>i!==null&&typeof i.AudioNode=="function"&&t instanceof i.AudioNode,W6=i=>t=>i!==null&&typeof i.AudioParam=="function"&&t instanceof i.AudioParam,q6=(i,t)=>e=>i(e)||t(e),X6=i=>t=>i!==null&&t instanceof i,z6=i=>i!==null&&i.isSecureContext,j6=(i,t,e,s)=>class extends i{constructor(r,o){const a=e(r),l=t(a,o);if(s(a))throw TypeError();super(r,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},G6={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Y6=(i,t,e,s)=>class extends i{constructor(r,o){const a=e(r);if(s(a))throw new TypeError;const l={...G6,...o},c=t(a,l);super(r,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},U6=(i,t,e,s)=>class extends i{constructor(r,o){const a=e(r),l=t(a,o);if(s(a))throw new TypeError;super(r,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},H6=(i,t,e)=>class extends i{constructor(n,r){const o=e(n),a=t(o,r);super(n,!0,a,null)}},K6=(i,t,e,s,n,r)=>class extends e{constructor(a,l){super(a),this._nativeContext=a,Ad.set(this,a),s(a)&&n.set(a,new Set),this._destination=new i(this,l),this._listener=t(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const l=typeof a=="function"?r(this,a):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?a:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Cc=i=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const e=i.decodeAudioData(t.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch{}return!1},J6=(i,t)=>(e,s,n)=>{const r=new Set;return e.connect=(o=>(a,l=0,c=0)=>{const h=r.size===0;if(t(a))return o.call(e,a,l,c),i(r,[a,l,c],u=>u[0]===a&&u[1]===l&&u[2]===c,!0),h&&s(),a;o.call(e,a,l),i(r,[a,l],u=>u[0]===a&&u[1]===l,!0),h&&s()})(e.connect),e.disconnect=(o=>(a,l,c)=>{const h=r.size>0;if(a===void 0)o.apply(e),r.clear();else if(typeof a=="number"){o.call(e,a);for(const f of r)f[1]===a&&r.delete(f)}else{t(a)?o.call(e,a,l,c):o.call(e,a,l);for(const f of r)f[0]===a&&(l===void 0||f[1]===l)&&(c===void 0||f[2]===c)&&r.delete(f)}const u=r.size===0;h&&u&&n()})(e.disconnect),e},xe=(i,t,e)=>{const s=t[e];s!==void 0&&s!==i[e]&&(i[e]=s)},je=(i,t)=>{xe(i,t,"channelCount"),xe(i,t,"channelCountMode"),xe(i,t,"channelInterpretation")},_y=i=>typeof i.getFloatTimeDomainData=="function",tA=i=>{i.getFloatTimeDomainData=t=>{const e=new Uint8Array(t.length);i.getByteTimeDomainData(e);const s=Math.max(e.length,i.fftSize);for(let n=0;n<s;n+=1)t[n]=(e[n]-128)*.0078125;return t}},eA=(i,t)=>(e,s)=>{const n=e.createAnalyser();if(je(n,s),!(s.maxDecibels>s.minDecibels))throw t();return xe(n,s,"fftSize"),xe(n,s,"maxDecibels"),xe(n,s,"minDecibels"),xe(n,s,"smoothingTimeConstant"),i(_y,()=>_y(n))||tA(n),n},iA=i=>i===null?null:i.hasOwnProperty("AudioBuffer")?i.AudioBuffer:null,Ce=(i,t,e)=>{const s=t[e];s!==void 0&&s!==i[e].value&&(i[e].value=s)},sA=i=>{i.start=(t=>{let e=!1;return(s=0,n=0,r)=>{if(e)throw Ke();t.call(i,s,n,r),e=!0}})(i.start)},z0=i=>{i.start=(t=>(e=0,s=0,n)=>{if(typeof n=="number"&&n<0||s<0||e<0)throw new RangeError("The parameters can't be negative.");t.call(i,e,s,n)})(i.start)},j0=i=>{i.stop=(t=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");t.call(i,e)})(i.stop)},nA=(i,t,e,s,n,r,o,a,l,c,h)=>(u,f)=>{const d=u.createBufferSource();return je(d,f),Ce(d,f,"playbackRate"),xe(d,f,"buffer"),xe(d,f,"loop"),xe(d,f,"loopEnd"),xe(d,f,"loopStart"),t(e,()=>e(u))||sA(d),t(s,()=>s(u))||l(d),t(n,()=>n(u))||c(d,u),t(r,()=>r(u))||z0(d),t(o,()=>o(u))||h(d,u),t(a,()=>a(u))||j0(d),i(u,d),d},rA=i=>i===null?null:i.hasOwnProperty("AudioContext")?i.AudioContext:i.hasOwnProperty("webkitAudioContext")?i.webkitAudioContext:null,oA=(i,t)=>(e,s,n)=>{const r=e.destination;if(r.channelCount!==s)try{r.channelCount=s}catch{}n&&r.channelCountMode!=="explicit"&&(r.channelCountMode="explicit"),r.maxChannelCount===0&&Object.defineProperty(r,"maxChannelCount",{value:s});const o=i(e,{channelCount:s,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return t(o,"channelCount",a=>()=>a.call(o),a=>l=>{a.call(o,l);try{r.channelCount=l}catch(c){if(l>r.maxChannelCount)throw c}}),t(o,"channelCountMode",a=>()=>a.call(o),a=>l=>{a.call(o,l),r.channelCountMode=l}),t(o,"channelInterpretation",a=>()=>a.call(o),a=>l=>{a.call(o,l),r.channelInterpretation=l}),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o},aA=i=>i===null?null:i.hasOwnProperty("AudioWorkletNode")?i.AudioWorkletNode:null,lA=i=>{const{port1:t}=new MessageChannel;try{t.postMessage(i)}finally{t.close()}},cA=(i,t,e,s,n)=>(r,o,a,l,c,h)=>{if(a!==null)try{const u=new a(r,l,h),f=new Map;let d=null;if(Object.defineProperties(u,{channelCount:{get:()=>h.channelCount,set:()=>{throw i()}},channelCountMode:{get:()=>"explicit",set:()=>{throw i()}},onprocessorerror:{get:()=>d,set:p=>{typeof d=="function"&&u.removeEventListener("processorerror",d),d=typeof p=="function"?p:null,typeof d=="function"&&u.addEventListener("processorerror",d)}}}),u.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(m!==null){const O=f.get(g[1]);O!==void 0?g[1]=O:(g[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),m(b)):m(new ErrorEvent(g[0],{...b}))},f.set(m,g[1]))}}return p.call(u,"error",g[1],g[2]),p.call(u,...g)})(u.addEventListener),u.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=f.get(g[1]);m!==void 0&&(f.delete(g[1]),g[1]=m)}return p.call(u,"error",g[1],g[2]),p.call(u,g[0],g[1],g[2])})(u.removeEventListener),h.numberOfOutputs!==0){const p=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return u.connect(p).connect(r.destination),n(u,()=>p.disconnect(),()=>p.connect(r.destination))}return u}catch(u){throw u.code===11?s():u}if(c===void 0)throw s();return lA(h),t(r,o,c,h)},c2=(i,t)=>i===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(i*t))))),hA=i=>new Promise((t,e)=>{const{port1:s,port2:n}=new MessageChannel;s.onmessage=({data:r})=>{s.close(),n.close(),t(r)},s.onmessageerror=({data:r})=>{s.close(),n.close(),e(r)},n.postMessage(i)}),uA=async(i,t)=>{const e=await hA(t);return new i(e)},fA=(i,t,e,s)=>{let n=jg.get(i);n===void 0&&(n=new WeakMap,jg.set(i,n));const r=uA(e,s);return n.set(t,r),r},dA=(i,t,e,s,n,r,o,a,l,c,h,u,f)=>(d,p,g,m)=>{if(m.numberOfInputs===0&&m.numberOfOutputs===0)throw l();const O=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(O.some(V=>V<1))throw l();if(O.length!==m.numberOfOutputs)throw t();if(m.channelCountMode!=="explicit")throw l();const b=m.channelCount*m.numberOfInputs,x=O.reduce((V,B)=>V+B,0),v=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(b+v>6||x>6)throw l();const y=new MessageChannel,_=[],S=[];for(let V=0;V<m.numberOfInputs;V+=1)_.push(o(d,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),S.push(n(d,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const k=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:V,maxValue:B,minValue:j,name:tt}of g.parameterDescriptors){const Y=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:m.parameterData[tt]!==void 0?m.parameterData[tt]:V===void 0?0:V});Object.defineProperties(Y.offset,{defaultValue:{get:()=>V===void 0?0:V},maxValue:{get:()=>B===void 0?ki:B},minValue:{get:()=>j===void 0?Vi:j}}),k.push(Y)}const A=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+v)}),M=c2(p,d.sampleRate),R=a(d,M,b+v,Math.max(1,x)),C=n(d,{channelCount:Math.max(1,x),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,x)}),$=[];for(let V=0;V<m.numberOfOutputs;V+=1)$.push(s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:O[V]}));for(let V=0;V<m.numberOfInputs;V+=1){_[V].connect(S[V]);for(let B=0;B<m.channelCount;B+=1)S[V].connect(A,B,V*m.channelCount+B)}const N=new o2(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:V},B)=>{const j=k[B];return j.connect(A,0,b+B),j.start(0),[V,j.offset]}));A.connect(R);let L=m.channelInterpretation,I=null;const Z=m.numberOfOutputs===0?[R]:$,F={get bufferSize(){return M},get channelCount(){return m.channelCount},set channelCount(V){throw e()},get channelCountMode(){return m.channelCountMode},set channelCountMode(V){throw e()},get channelInterpretation(){return L},set channelInterpretation(V){for(const B of _)B.channelInterpretation=V;L=V},get context(){return R.context},get inputs(){return _},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return I},set onprocessorerror(V){typeof I=="function"&&F.removeEventListener("processorerror",I),I=typeof V=="function"?V:null,typeof I=="function"&&F.addEventListener("processorerror",I)},get parameters(){return N},get port(){return y.port2},addEventListener(...V){return R.addEventListener(V[0],V[1],V[2])},connect:i.bind(null,Z),disconnect:c.bind(null,Z),dispatchEvent(...V){return R.dispatchEvent(V[0])},removeEventListener(...V){return R.removeEventListener(V[0],V[1],V[2])}},z=new Map;y.port1.addEventListener=(V=>(...B)=>{if(B[0]==="message"){const j=typeof B[1]=="function"?B[1]:typeof B[1]=="object"&&B[1]!==null&&typeof B[1].handleEvent=="function"?B[1].handleEvent:null;if(j!==null){const tt=z.get(B[1]);tt!==void 0?B[1]=tt:(B[1]=Y=>{h(d.currentTime,d.sampleRate,()=>j(Y))},z.set(j,B[1]))}}return V.call(y.port1,B[0],B[1],B[2])})(y.port1.addEventListener),y.port1.removeEventListener=(V=>(...B)=>{if(B[0]==="message"){const j=z.get(B[1]);j!==void 0&&(z.delete(B[1]),B[1]=j)}return V.call(y.port1,B[0],B[1],B[2])})(y.port1.removeEventListener);let et=null;Object.defineProperty(y.port1,"onmessage",{get:()=>et,set:V=>{typeof et=="function"&&y.port1.removeEventListener("message",et),et=typeof V=="function"?V:null,typeof et=="function"&&(y.port1.addEventListener("message",et),y.port1.start())}}),g.prototype.port=y.port1;let K=null;fA(d,F,g,m).then(V=>K=V);const Mt=Af(m.numberOfInputs,m.channelCount),jt=Af(m.numberOfOutputs,O),yt=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((V,{name:B})=>({...V,[B]:new Float32Array(128)}),{});let wt=!0;const Ut=()=>{m.numberOfOutputs>0&&R.disconnect(C);for(let V=0,B=0;V<m.numberOfOutputs;V+=1){const j=$[V];for(let tt=0;tt<O[V];tt+=1)C.disconnect(j,B+tt,tt);B+=O[V]}},gt=new Map;R.onaudioprocess=({inputBuffer:V,outputBuffer:B})=>{if(K!==null){const j=u(F);for(let tt=0;tt<M;tt+=128){for(let Y=0;Y<m.numberOfInputs;Y+=1)for(let H=0;H<m.channelCount;H+=1)Pf(V,Mt[Y],H,H,tt);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:Y},H)=>{Pf(V,yt,Y,b+H,tt)});for(let Y=0;Y<m.numberOfInputs;Y+=1)for(let H=0;H<O[Y];H+=1)jt[Y][H].byteLength===0&&(jt[Y][H]=new Float32Array(128));try{const Y=Mt.map((U,bt)=>{if(j[bt].size>0)return gt.set(bt,M/128),U;const _t=gt.get(bt);return _t===void 0?[]:(U.every(Ct=>Ct.every(Lt=>Lt===0))&&(_t===1?gt.delete(bt):gt.set(bt,_t-1)),U)});wt=h(d.currentTime+tt/d.sampleRate,d.sampleRate,()=>K.process(Y,jt,yt));for(let U=0,bt=0;U<m.numberOfOutputs;U+=1){for(let ct=0;ct<O[U];ct+=1)a2(B,jt[U],ct,bt+ct,tt);bt+=O[U]}}catch(Y){wt=!1,F.dispatchEvent(new ErrorEvent("processorerror",{colno:Y.colno,filename:Y.filename,lineno:Y.lineno,message:Y.message}))}if(!wt){for(let Y=0;Y<m.numberOfInputs;Y+=1){_[Y].disconnect(S[Y]);for(let H=0;H<m.channelCount;H+=1)S[tt].disconnect(A,H,Y*m.channelCount+H)}if(g.parameterDescriptors!==void 0){const Y=g.parameterDescriptors.length;for(let H=0;H<Y;H+=1){const U=k[H];U.disconnect(A,0,b+H),U.stop()}}A.disconnect(R),R.onaudioprocess=null,mt?Ut():P();break}}}};let mt=!1;const nt=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Qt=()=>R.connect(nt).connect(d.destination),P=()=>{R.disconnect(nt),nt.disconnect()},Q=()=>{if(wt){P(),m.numberOfOutputs>0&&R.connect(C);for(let V=0,B=0;V<m.numberOfOutputs;V+=1){const j=$[V];for(let tt=0;tt<O[V];tt+=1)C.connect(j,B+tt,tt);B+=O[V]}}mt=!0},q=()=>{wt&&(Qt(),Ut()),mt=!1};return Qt(),f(F,Q,q)},h2=(i,t)=>{const e=i.createBiquadFilter();return je(e,t),Ce(e,t,"Q"),Ce(e,t,"detune"),Ce(e,t,"frequency"),Ce(e,t,"gain"),xe(e,t,"type"),e},pA=(i,t)=>(e,s)=>{const n=e.createChannelMerger(s.numberOfInputs);return i!==null&&i.name==="webkitAudioContext"&&t(e,n),je(n,s),n},gA=i=>{const t=i.numberOfOutputs;Object.defineProperty(i,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Ke()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw Ke()}}),Object.defineProperty(i,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw Ke()}})},rh=(i,t)=>{const e=i.createChannelSplitter(t.numberOfOutputs);return je(e,t),gA(e),e},mA=(i,t,e,s,n)=>(r,o)=>{if(r.createConstantSource===void 0)return e(r,o);const a=r.createConstantSource();return je(a,o),Ce(a,o,"offset"),t(s,()=>s(r))||z0(a),t(n,()=>n(r))||j0(a),i(r,a),a},Ka=(i,t)=>(i.connect=t.connect.bind(t),i.disconnect=t.disconnect.bind(t),i),OA=(i,t,e,s)=>(n,{offset:r,...o})=>{const a=n.createBuffer(1,2,44100),l=t(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=e(n,{...o,gain:r}),h=a.getChannelData(0);h[0]=1,h[1]=1,l.buffer=a,l.loop=!0;const u={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},f=()=>l.connect(c),d=()=>l.disconnect(c);return i(n,l),s(Ka(u,c),f,d)},yA=(i,t)=>(e,s)=>{const n=e.createConvolver();if(je(n,s),s.disableNormalization===n.normalize&&(n.normalize=!s.disableNormalization),xe(n,s,"buffer"),s.channelCount>2||(t(n,"channelCount",r=>()=>r.call(n),r=>o=>{if(o>2)throw i();return r.call(n,o)}),s.channelCountMode==="max"))throw i();return t(n,"channelCountMode",r=>()=>r.call(n),r=>o=>{if(o==="max")throw i();return r.call(n,o)}),n},u2=(i,t)=>{const e=i.createDelay(t.maxDelayTime);return je(e,t),Ce(e,t,"delayTime"),e},bA=i=>(t,e)=>{const s=t.createDynamicsCompressor();if(je(s,e),e.channelCount>2||e.channelCountMode==="max")throw i();return Ce(s,e,"attack"),Ce(s,e,"knee"),Ce(s,e,"ratio"),Ce(s,e,"release"),Ce(s,e,"threshold"),s},Gi=(i,t)=>{const e=i.createGain();return je(e,t),Ce(e,t,"gain"),e},vA=i=>(t,e,s)=>{if(t.createIIRFilter===void 0)return i(t,e,s);const n=t.createIIRFilter(s.feedforward,s.feedback);return je(n,s),n};function _A(i,t){const e=t[0]*t[0]+t[1]*t[1];return[(i[0]*t[0]+i[1]*t[1])/e,(i[1]*t[0]-i[0]*t[1])/e]}function xA(i,t){return[i[0]*t[0]-i[1]*t[1],i[0]*t[1]+i[1]*t[0]]}function xy(i,t){let e=[0,0];for(let s=i.length-1;s>=0;s-=1)e=xA(e,t),e[0]+=i[s];return e}const SA=(i,t,e,s)=>(n,r,{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:c,feedforward:h})=>{const u=c2(r,n.sampleRate),f=c instanceof Float64Array?c:new Float64Array(c),d=h instanceof Float64Array?h:new Float64Array(h),p=f.length,g=d.length,m=Math.min(p,g);if(p===0||p>20)throw s();if(f[0]===0)throw t();if(g===0||g>20)throw s();if(d[0]===0)throw t();if(f[0]!==1){for(let k=0;k<g;k+=1)d[k]/=f[0];for(let k=1;k<p;k+=1)f[k]/=f[0]}const O=e(n,u,o,o);O.channelCount=o,O.channelCountMode=a,O.channelInterpretation=l;const b=32,x=[],v=[],y=[];for(let k=0;k<o;k+=1){x.push(0);const A=new Float32Array(b),M=new Float32Array(b);A.fill(0),M.fill(0),v.push(A),y.push(M)}O.onaudioprocess=k=>{const A=k.inputBuffer,M=k.outputBuffer,R=A.numberOfChannels;for(let C=0;C<R;C+=1){const $=A.getChannelData(C),N=M.getChannelData(C);x[C]=l2(f,p,d,g,m,v[C],y[C],x[C],b,$,N)}};const _=n.sampleRate/2;return Ka({get bufferSize(){return u},get channelCount(){return O.channelCount},set channelCount(k){O.channelCount=k},get channelCountMode(){return O.channelCountMode},set channelCountMode(k){O.channelCountMode=k},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(k){O.channelInterpretation=k},get context(){return O.context},get inputs(){return[O]},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},addEventListener(...k){return O.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return O.dispatchEvent(k[0])},getFrequencyResponse(k,A,M){if(k.length!==A.length||A.length!==M.length)throw i();const R=k.length;for(let C=0;C<R;C+=1){const $=-Math.PI*(k[C]/_),N=[Math.cos($),Math.sin($)],L=xy(d,N),I=xy(f,N),Z=_A(L,I);A[C]=Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1]),M[C]=Math.atan2(Z[1],Z[0])}},removeEventListener(...k){return O.removeEventListener(k[0],k[1],k[2])}},O)},wA=(i,t)=>i.createMediaElementSource(t.mediaElement),kA=(i,t)=>{const e=i.createMediaStreamDestination();return je(e,t),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e},CA=(i,{mediaStream:t})=>{const e=t.getAudioTracks();e.sort((r,o)=>r.id<o.id?-1:r.id>o.id?1:0);const s=e.slice(0,1),n=i.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(n,"mediaStream",{value:t}),n},TA=(i,t)=>(e,{mediaStreamTrack:s})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(s);const n=new MediaStream([s]),r=e.createMediaStreamSource(n);if(s.kind!=="audio")throw i();if(t(e))throw new TypeError;return r},PA=i=>i===null?null:i.hasOwnProperty("OfflineAudioContext")?i.OfflineAudioContext:i.hasOwnProperty("webkitOfflineAudioContext")?i.webkitOfflineAudioContext:null,AA=(i,t,e,s,n,r)=>(o,a)=>{const l=o.createOscillator();return je(l,a),Ce(l,a,"detune"),Ce(l,a,"frequency"),a.periodicWave!==void 0?l.setPeriodicWave(a.periodicWave):xe(l,a,"type"),t(e,()=>e(o))||z0(l),t(s,()=>s(o))||r(l,o),t(n,()=>n(o))||j0(l),i(o,l),l},MA=i=>(t,e)=>{const s=t.createPanner();return s.orientationX===void 0?i(t,e):(je(s,e),Ce(s,e,"orientationX"),Ce(s,e,"orientationY"),Ce(s,e,"orientationZ"),Ce(s,e,"positionX"),Ce(s,e,"positionY"),Ce(s,e,"positionZ"),xe(s,e,"coneInnerAngle"),xe(s,e,"coneOuterAngle"),xe(s,e,"coneOuterGain"),xe(s,e,"distanceModel"),xe(s,e,"maxDistance"),xe(s,e,"panningModel"),xe(s,e,"refDistance"),xe(s,e,"rolloffFactor"),s)},EA=(i,t,e,s,n,r,o,a,l,c)=>(h,{coneInnerAngle:u,coneOuterAngle:f,coneOuterGain:d,distanceModel:p,maxDistance:g,orientationX:m,orientationY:O,orientationZ:b,panningModel:x,positionX:v,positionY:y,positionZ:_,refDistance:S,rolloffFactor:k,...A})=>{const M=h.createPanner();if(A.channelCount>2||A.channelCountMode==="max")throw o();je(M,A);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},C=e(h,{...R,channelInterpretation:"speakers",numberOfInputs:6}),$=s(h,{...A,gain:1}),N=s(h,{...R,gain:1}),L=s(h,{...R,gain:0}),I=s(h,{...R,gain:0}),Z=s(h,{...R,gain:0}),F=s(h,{...R,gain:0}),z=s(h,{...R,gain:0}),et=n(h,256,6,1),K=r(h,{...R,curve:new Float32Array([1,1]),oversample:"none"});let ot=[m,O,b],Mt=[v,y,_];const jt=new Float32Array(1);et.onaudioprocess=({inputBuffer:gt})=>{const mt=[l(gt,jt,0),l(gt,jt,1),l(gt,jt,2)];mt.some((Qt,P)=>Qt!==ot[P])&&(M.setOrientation(...mt),ot=mt);const nt=[l(gt,jt,3),l(gt,jt,4),l(gt,jt,5)];nt.some((Qt,P)=>Qt!==Mt[P])&&(M.setPosition(...nt),Mt=nt)},Object.defineProperty(L.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0});const yt={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(gt){if(gt>2)throw o();$.channelCount=gt,M.channelCount=gt},get channelCountMode(){return M.channelCountMode},set channelCountMode(gt){if(gt==="max")throw o();$.channelCountMode=gt,M.channelCountMode=gt},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(gt){$.channelInterpretation=gt,M.channelInterpretation=gt},get coneInnerAngle(){return M.coneInnerAngle},set coneInnerAngle(gt){M.coneInnerAngle=gt},get coneOuterAngle(){return M.coneOuterAngle},set coneOuterAngle(gt){M.coneOuterAngle=gt},get coneOuterGain(){return M.coneOuterGain},set coneOuterGain(gt){if(gt<0||gt>1)throw t();M.coneOuterGain=gt},get context(){return M.context},get distanceModel(){return M.distanceModel},set distanceModel(gt){M.distanceModel=gt},get inputs(){return[$]},get maxDistance(){return M.maxDistance},set maxDistance(gt){if(gt<0)throw new RangeError;M.maxDistance=gt},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get orientationX(){return N.gain},get orientationY(){return L.gain},get orientationZ(){return I.gain},get panningModel(){return M.panningModel},set panningModel(gt){M.panningModel=gt},get positionX(){return Z.gain},get positionY(){return F.gain},get positionZ(){return z.gain},get refDistance(){return M.refDistance},set refDistance(gt){if(gt<0)throw new RangeError;M.refDistance=gt},get rolloffFactor(){return M.rolloffFactor},set rolloffFactor(gt){if(gt<0)throw new RangeError;M.rolloffFactor=gt},addEventListener(...gt){return $.addEventListener(gt[0],gt[1],gt[2])},dispatchEvent(...gt){return $.dispatchEvent(gt[0])},removeEventListener(...gt){return $.removeEventListener(gt[0],gt[1],gt[2])}};u!==yt.coneInnerAngle&&(yt.coneInnerAngle=u),f!==yt.coneOuterAngle&&(yt.coneOuterAngle=f),d!==yt.coneOuterGain&&(yt.coneOuterGain=d),p!==yt.distanceModel&&(yt.distanceModel=p),g!==yt.maxDistance&&(yt.maxDistance=g),m!==yt.orientationX.value&&(yt.orientationX.value=m),O!==yt.orientationY.value&&(yt.orientationY.value=O),b!==yt.orientationZ.value&&(yt.orientationZ.value=b),x!==yt.panningModel&&(yt.panningModel=x),v!==yt.positionX.value&&(yt.positionX.value=v),y!==yt.positionY.value&&(yt.positionY.value=y),_!==yt.positionZ.value&&(yt.positionZ.value=_),S!==yt.refDistance&&(yt.refDistance=S),k!==yt.rolloffFactor&&(yt.rolloffFactor=k),(ot[0]!==1||ot[1]!==0||ot[2]!==0)&&M.setOrientation(...ot),(Mt[0]!==0||Mt[1]!==0||Mt[2]!==0)&&M.setPosition(...Mt);const wt=()=>{$.connect(M),i($,K,0,0),K.connect(N).connect(C,0,0),K.connect(L).connect(C,0,1),K.connect(I).connect(C,0,2),K.connect(Z).connect(C,0,3),K.connect(F).connect(C,0,4),K.connect(z).connect(C,0,5),C.connect(et).connect(h.destination)},Ut=()=>{$.disconnect(M),a($,K,0,0),K.disconnect(N),N.disconnect(C),K.disconnect(L),L.disconnect(C),K.disconnect(I),I.disconnect(C),K.disconnect(Z),Z.disconnect(C),K.disconnect(F),F.disconnect(C),K.disconnect(z),z.disconnect(C),C.disconnect(et),et.disconnect(h.destination)};return c(Ka(yt,M),wt,Ut)},RA=i=>(t,{disableNormalization:e,imag:s,real:n})=>{const r=s instanceof Float32Array?s:new Float32Array(s),o=n instanceof Float32Array?n:new Float32Array(n),a=t.createPeriodicWave(o,r,{disableNormalization:e});if(Array.from(s).length<2)throw i();return a},oh=(i,t,e,s)=>i.createScriptProcessor(t,e,s),QA=(i,t)=>(e,s)=>{const n=s.channelCountMode;if(n==="clamped-max")throw t();if(e.createStereoPanner===void 0)return i(e,s);const r=e.createStereoPanner();return je(r,s),Ce(r,s,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>n,set:o=>{if(o!==n)throw t()}}),r},IA=(i,t,e,s,n,r)=>{const a=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...c,oversample:"none"},u=(p,g,m,O)=>{const b=new Float32Array(16385),x=new Float32Array(16385);for(let A=0;A<16385;A+=1){const M=A/16384*l;b[A]=Math.cos(M),x[A]=Math.sin(M)}const v=e(p,{...c,gain:0}),y=s(p,{...h,curve:b}),_=s(p,{...h,curve:a}),S=e(p,{...c,gain:0}),k=s(p,{...h,curve:x});return{connectGraph(){g.connect(v),g.connect(_.inputs===void 0?_:_.inputs[0]),g.connect(S),_.connect(m),m.connect(y.inputs===void 0?y:y.inputs[0]),m.connect(k.inputs===void 0?k:k.inputs[0]),y.connect(v.gain),k.connect(S.gain),v.connect(O,0,0),S.connect(O,0,1)},disconnectGraph(){g.disconnect(v),g.disconnect(_.inputs===void 0?_:_.inputs[0]),g.disconnect(S),_.disconnect(m),m.disconnect(y.inputs===void 0?y:y.inputs[0]),m.disconnect(k.inputs===void 0?k:k.inputs[0]),y.disconnect(v.gain),k.disconnect(S.gain),v.disconnect(O,0,0),S.disconnect(O,0,1)}}},f=(p,g,m,O)=>{const b=new Float32Array(16385),x=new Float32Array(16385),v=new Float32Array(16385),y=new Float32Array(16385),_=Math.floor(16385/2);for(let Z=0;Z<16385;Z+=1)if(Z>_){const F=(Z-_)/(16384-_)*l;b[Z]=Math.cos(F),x[Z]=Math.sin(F),v[Z]=0,y[Z]=1}else{const F=Z/(16384-_)*l;b[Z]=1,x[Z]=0,v[Z]=Math.cos(F),y[Z]=Math.sin(F)}const S=t(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=e(p,{...c,gain:0}),A=s(p,{...h,curve:b}),M=e(p,{...c,gain:0}),R=s(p,{...h,curve:x}),C=s(p,{...h,curve:a}),$=e(p,{...c,gain:0}),N=s(p,{...h,curve:v}),L=e(p,{...c,gain:0}),I=s(p,{...h,curve:y});return{connectGraph(){g.connect(S),g.connect(C.inputs===void 0?C:C.inputs[0]),S.connect(k,0),S.connect(M,0),S.connect($,1),S.connect(L,1),C.connect(m),m.connect(A.inputs===void 0?A:A.inputs[0]),m.connect(R.inputs===void 0?R:R.inputs[0]),m.connect(N.inputs===void 0?N:N.inputs[0]),m.connect(I.inputs===void 0?I:I.inputs[0]),A.connect(k.gain),R.connect(M.gain),N.connect($.gain),I.connect(L.gain),k.connect(O,0,0),$.connect(O,0,0),M.connect(O,0,1),L.connect(O,0,1)},disconnectGraph(){g.disconnect(S),g.disconnect(C.inputs===void 0?C:C.inputs[0]),S.disconnect(k,0),S.disconnect(M,0),S.disconnect($,1),S.disconnect(L,1),C.disconnect(m),m.disconnect(A.inputs===void 0?A:A.inputs[0]),m.disconnect(R.inputs===void 0?R:R.inputs[0]),m.disconnect(N.inputs===void 0?N:N.inputs[0]),m.disconnect(I.inputs===void 0?I:I.inputs[0]),A.disconnect(k.gain),R.disconnect(M.gain),N.disconnect($.gain),I.disconnect(L.gain),k.disconnect(O,0,0),$.disconnect(O,0,0),M.disconnect(O,0,1),L.disconnect(O,0,1)}}},d=(p,g,m,O,b)=>{if(g===1)return u(p,m,O,b);if(g===2)return f(p,m,O,b);throw n()};return(p,{channelCount:g,channelCountMode:m,pan:O,...b})=>{if(m==="max")throw n();const x=i(p,{...b,channelCount:1,channelCountMode:m,numberOfInputs:2}),v=e(p,{...b,channelCount:g,channelCountMode:m,gain:1}),y=e(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:O});let{connectGraph:_,disconnectGraph:S}=d(p,g,v,y,x);Object.defineProperty(y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(y.gain,"maxValue",{get:()=>1}),Object.defineProperty(y.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return v.channelCount},set channelCount(C){v.channelCount!==C&&(A&&S(),{connectGraph:_,disconnectGraph:S}=d(p,C,v,y,x),A&&_()),v.channelCount=C},get channelCountMode(){return v.channelCountMode},set channelCountMode(C){if(C==="clamped-max"||C==="max")throw n();v.channelCountMode=C},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(C){v.channelInterpretation=C},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get pan(){return y.gain},addEventListener(...C){return v.addEventListener(C[0],C[1],C[2])},dispatchEvent(...C){return v.dispatchEvent(C[0])},removeEventListener(...C){return v.removeEventListener(C[0],C[1],C[2])}};let A=!1;const M=()=>{_(),A=!0},R=()=>{S(),A=!1};return r(Ka(k,x),M,R)}},$A=(i,t,e,s,n,r,o)=>(a,l)=>{const c=a.createWaveShaper();if(r!==null&&r.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return e(a,l);je(c,l);const h=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(h!==null&&h.length<2)throw t();xe(c,{curve:h},"curve"),xe(c,l,"oversample");let u=null,f=!1;return o(c,"curve",g=>()=>g.call(c),g=>m=>(g.call(c,m),f&&(s(m)&&u===null?u=i(a,c):!s(m)&&u!==null&&(u(),u=null)),m)),n(c,()=>{f=!0,s(c.curve)&&(u=i(a,c))},()=>{f=!1,u!==null&&(u(),u=null)})},NA=(i,t,e,s,n)=>(r,{curve:o,oversample:a,...l})=>{const c=r.createWaveShaper(),h=r.createWaveShaper();je(c,l),je(h,l);const u=e(r,{...l,gain:1}),f=e(r,{...l,gain:-1}),d=e(r,{...l,gain:1}),p=e(r,{...l,gain:-1});let g=null,m=!1,O=null;const b={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(y){u.channelCount=y,f.channelCount=y,c.channelCount=y,d.channelCount=y,h.channelCount=y,p.channelCount=y},get channelCountMode(){return c.channelCountMode},set channelCountMode(y){u.channelCountMode=y,f.channelCountMode=y,c.channelCountMode=y,d.channelCountMode=y,h.channelCountMode=y,p.channelCountMode=y},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(y){u.channelInterpretation=y,f.channelInterpretation=y,c.channelInterpretation=y,d.channelInterpretation=y,h.channelInterpretation=y,p.channelInterpretation=y},get context(){return c.context},get curve(){return O},set curve(y){if(y!==null&&y.length<2)throw t();if(y===null)c.curve=y,h.curve=y;else{const _=y.length,S=new Float32Array(_+2-_%2),k=new Float32Array(_+2-_%2);S[0]=y[0],k[0]=-y[_-1];const A=Math.ceil((_+1)/2),M=(_+1)/2-1;for(let R=1;R<A;R+=1){const C=R/A*M,$=Math.floor(C),N=Math.ceil(C);S[R]=$===N?y[$]:(1-(C-$))*y[$]+(1-(N-C))*y[N],k[R]=$===N?-y[_-1-$]:-((1-(C-$))*y[_-1-$])-(1-(N-C))*y[_-1-N]}S[A]=_%2===1?y[A-1]:(y[A-2]+y[A-1])/2,c.curve=S,h.curve=k}O=y,m&&(s(O)&&g===null?g=i(r,u):g!==null&&(g(),g=null))},get inputs(){return[u]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(y){c.oversample=y,h.oversample=y},addEventListener(...y){return u.addEventListener(y[0],y[1],y[2])},dispatchEvent(...y){return u.dispatchEvent(y[0])},removeEventListener(...y){return u.removeEventListener(y[0],y[1],y[2])}};o!==null&&(b.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==b.oversample&&(b.oversample=a);const x=()=>{u.connect(c).connect(d),u.connect(f).connect(h).connect(p).connect(d),m=!0,s(O)&&(g=i(r,u))},v=()=>{u.disconnect(c),c.disconnect(d),u.disconnect(f),f.disconnect(h),h.disconnect(p),p.disconnect(d),m=!1,g!==null&&(g(),g=null)};return n(Ka(b,d),x,v)},Ei=()=>new DOMException("","NotSupportedError"),DA={numberOfChannels:1},LA=(i,t,e,s,n)=>class extends i{constructor(o,a,l){let c;if(typeof o=="number"&&a!==void 0&&l!==void 0)c={length:a,numberOfChannels:o,sampleRate:l};else if(typeof o=="object")c=o;else throw new Error("The given parameters are not valid.");const{length:h,numberOfChannels:u,sampleRate:f}={...DA,...c},d=s(u,h,f);t(Cc,()=>Cc(d))||d.addEventListener("statechange",(()=>{let p=0;const g=m=>{this._state==="running"&&(p>0?(d.removeEventListener("statechange",g),m.stopImmediatePropagation(),this._waitForThePromiseToSettle(m)):p+=1)};return g})()),super(d,u),this._length=h,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,i2(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},VA={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},BA=(i,t,e,s,n,r,o)=>class extends i{constructor(l,c){const h=n(l),u={...VA,...c},f=e(h,u),d=r(h),p=d?s():null,g=l.sampleRate/2;super(l,!1,f,p),this._detune=t(this,d,f.detune,153600,-153600),this._frequency=t(this,d,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&u.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=u.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?o(this,l):null;this._nativeOscillatorNode.onended=c;const h=this._nativeOscillatorNode.onended;this._onended=h!==null&&h===c?l:h}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){Na(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),Xn(this)&&ih(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},ZA=(i,t,e,s,n)=>()=>{const r=new WeakMap;let o=null,a=null,l=null;const c=async(h,u)=>{let f=e(h);const d=yi(f,u);if(!d){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=t(u,p),a!==null&&f.start(a),l!==null&&f.stop(l)}return r.set(u,f),d?(await i(u,h.detune,f.detune),await i(u,h.frequency,f.frequency)):(await s(u,h.detune,f.detune),await s(u,h.frequency,f.frequency)),await n(h,u,f),f};return{set periodicWave(h){o=h},set start(h){a=h},set stop(h){l=h},render(h,u){const f=r.get(u);return f!==void 0?Promise.resolve(f):c(h,u)}}},FA={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},WA=(i,t,e,s,n,r,o)=>class extends i{constructor(l,c){const h=n(l),u={...FA,...c},f=e(h,u),d=r(h),p=d?s():null;super(l,!1,f,p),this._nativePannerNode=f,this._orientationX=t(this,d,f.orientationX,ki,Vi),this._orientationY=t(this,d,f.orientationY,ki,Vi),this._orientationZ=t(this,d,f.orientationZ,ki,Vi),this._positionX=t(this,d,f.positionX,ki,Vi),this._positionY=t(this,d,f.positionY,ki,Vi),this._positionZ=t(this,d,f.positionZ,ki,Vi),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},qA=(i,t,e,s,n,r,o,a,l,c)=>()=>{const h=new WeakMap;let u=null;const f=async(d,p)=>{let g=null,m=r(d);const O={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},b={...O,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},x=yi(m,p);if("bufferSize"in m)g=s(p,{...O,gain:1});else if(!x){const v={...b,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=n(p,v)}if(h.set(p,g===null?m:g),g!==null){if(u===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const R=new o(6,d.context.length,p.sampleRate),C=t(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});C.connect(R.destination),u=(async()=>{const $=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(N,L)=>{const I=e(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:L===0?1:0});return await a(R,N,I.offset),I}));for(let N=0;N<6;N+=1)$[N].connect(C,0,N),$[N].start(0);return c(R)})()}const v=await u,y=s(p,{...O,gain:1});await l(d,p,y);const _=[];for(let R=0;R<v.numberOfChannels;R+=1)_.push(v.getChannelData(R));let S=[_[0][0],_[1][0],_[2][0]],k=[_[3][0],_[4][0],_[5][0]],A=s(p,{...O,gain:1}),M=n(p,{...b,orientationX:S[0],orientationY:S[1],orientationZ:S[2],positionX:k[0],positionY:k[1],positionZ:k[2]});y.connect(A).connect(M.inputs[0]),M.connect(g);for(let R=128;R<v.length;R+=128){const C=[_[0][R],_[1][R],_[2][R]],$=[_[3][R],_[4][R],_[5][R]];if(C.some((N,L)=>N!==S[L])||$.some((N,L)=>N!==k[L])){S=C,k=$;const N=R/p.sampleRate;A.gain.setValueAtTime(0,N),A=s(p,{...O,gain:0}),M=n(p,{...b,orientationX:S[0],orientationY:S[1],orientationZ:S[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),A.gain.setValueAtTime(1,N),y.connect(A).connect(M.inputs[0]),M.connect(g)}}return g}return x?(await i(p,d.orientationX,m.orientationX),await i(p,d.orientationY,m.orientationY),await i(p,d.orientationZ,m.orientationZ),await i(p,d.positionX,m.positionX),await i(p,d.positionY,m.positionY),await i(p,d.positionZ,m.positionZ)):(await a(p,d.orientationX,m.orientationX),await a(p,d.orientationY,m.orientationY),await a(p,d.orientationZ,m.orientationZ),await a(p,d.positionX,m.positionX),await a(p,d.positionY,m.positionY),await a(p,d.positionZ,m.positionZ)),Ha(m)?await l(d,p,m.inputs[0]):await l(d,p,m),m};return{render(d,p){const g=h.get(p);return g!==void 0?Promise.resolve(g):f(d,p)}}},XA={disableNormalization:!1},zA=(i,t,e,s)=>class f2{constructor(r,o){const a=t(r),l=s({...XA,...o}),c=i(a,l);return e.add(c),c}static[Symbol.hasInstance](r){return r!==null&&typeof r=="object"&&Object.getPrototypeOf(r)===f2.prototype||e.has(r)}},jA=(i,t)=>(e,s,n)=>(i(s).replay(n),t(s,e,n)),GA=(i,t,e)=>async(s,n,r)=>{const o=i(s);await Promise.all(o.activeInputs.map((a,l)=>Array.from(a).map(async([c,h])=>{const f=await t(c).render(c,n),d=s.context.destination;!e(c)&&(s!==d||!e(s))&&f.connect(r,h,l)})).reduce((a,l)=>[...a,...l],[]))},YA=(i,t,e)=>async(s,n,r)=>{const o=t(s);await Promise.all(Array.from(o.activeInputs).map(async([a,l])=>{const h=await i(a).render(a,n);e(a)||h.connect(r,l)}))},UA=(i,t,e,s)=>n=>i(Cc,()=>Cc(n))?Promise.resolve(i(s,s)).then(r=>{if(!r){const o=e(n,512,0,1);n.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>n.currentTime,o.connect(n.destination)}return n.startRendering()}):new Promise(r=>{const o=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.oncomplete=a=>{o.disconnect(),r(a.renderedBuffer)},o.connect(n.destination),n.startRendering()}),HA=i=>(t,e)=>{i.set(t,e)},KA=i=>(t,e)=>i.set(t,e),JA=(i,t,e,s,n,r,o,a)=>(l,c)=>e(l).render(l,c).then(()=>Promise.all(Array.from(s(c)).map(h=>e(h).render(h,c)))).then(()=>n(c)).then(h=>(typeof h.copyFromChannel!="function"?(o(h),W0(h)):t(r,()=>r(h))||a(h),i.add(h),h)),t8={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},e8=(i,t,e,s,n,r)=>class extends i{constructor(a,l){const c=n(a),h={...t8,...l},u=e(c,h),f=r(c),d=f?s():null;super(a,!1,u,d),this._pan=t(this,f,u.pan)}get pan(){return this._pan}},i8=(i,t,e,s,n)=>()=>{const r=new WeakMap,o=async(a,l)=>{let c=e(a);const h=yi(c,l);if(!h){const u={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=t(l,u)}return r.set(l,c),h?await i(l,a.pan,c.pan):await s(l,a.pan,c.pan),Ha(c)?await n(a,l,c.inputs[0]):await n(a,l,c),c};return{render(a,l){const c=r.get(l);return c!==void 0?Promise.resolve(c):o(a,l)}}},s8=i=>()=>{if(i===null)return!1;try{new i({length:1,sampleRate:44100})}catch{return!1}return!0},n8=(i,t)=>async()=>{if(i===null)return!0;if(t===null)return!1;const e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new t(1,128,44100),n=URL.createObjectURL(e);let r=!1,o=!1;try{await s.audioWorklet.addModule(n);const a=new i(s,"a",{numberOfOutputs:0}),l=s.createOscillator();a.port.onmessage=()=>r=!0,a.onprocessorerror=()=>o=!0,l.connect(a),l.start(0),await s.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(n)}return r&&!o},r8=(i,t)=>()=>{if(t===null)return Promise.resolve(!1);const e=new t(1,1,44100),s=i(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(n=>{e.oncomplete=()=>{s.disconnect(),n(e.currentTime!==0)},e.startRendering()})},o8=()=>new DOMException("","UnknownError"),a8={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},l8=(i,t,e,s,n,r,o)=>class extends i{constructor(l,c){const h=n(l),u={...a8,...c},f=e(h,u),p=r(h)?s():null;super(l,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},c8=(i,t,e)=>()=>{const s=new WeakMap,n=async(r,o)=>{let a=t(r);if(!yi(a,o)){const c={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=i(o,c)}return s.set(o,a),Ha(a)?await e(r,o,a.inputs[0]):await e(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):n(r,o)}}},h8=()=>typeof window>"u"?null:window,u8=(i,t)=>e=>{e.copyFromChannel=(s,n,r=0)=>{const o=i(r),a=i(n);if(a>=e.numberOfChannels)throw t();const l=e.length,c=e.getChannelData(a),h=s.length;for(let u=o<0?-o:0;u+o<l&&u<h;u+=1)s[u]=c[u+o]},e.copyToChannel=(s,n,r=0)=>{const o=i(r),a=i(n);if(a>=e.numberOfChannels)throw t();const l=e.length,c=e.getChannelData(a),h=s.length;for(let u=o<0?-o:0;u+o<l&&u<h;u+=1)c[u+o]=s[u]}},f8=i=>t=>{t.copyFromChannel=(e=>(s,n,r=0)=>{const o=i(r),a=i(n);if(o<t.length)return e.call(t,s,a,o)})(t.copyFromChannel),t.copyToChannel=(e=>(s,n,r=0)=>{const o=i(r),a=i(n);if(o<t.length)return e.call(t,s,a,o)})(t.copyToChannel)},d8=i=>(t,e)=>{const s=e.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=s),i(t,"buffer",n=>()=>{const r=n.call(t);return r===s?null:r},n=>r=>n.call(t,r===null?s:r))},p8=(i,t)=>(e,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw i()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw i()}});const n=e.createBufferSource();t(s,()=>{const a=s.numberOfInputs;for(let l=0;l<a;l+=1)n.connect(s,0,l)},()=>n.disconnect(s))},d2=(i,t,e)=>i.copyFromChannel===void 0?i.getChannelData(e)[0]:(i.copyFromChannel(t,e),t[0]),p2=i=>{if(i===null)return!1;const t=i.length;return t%2!==0?i[Math.floor(t/2)]!==0:i[t/2-1]+i[t/2]!==0},ah=(i,t,e,s)=>{let n=i;for(;!n.hasOwnProperty(t);)n=Object.getPrototypeOf(n);const{get:r,set:o}=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(i,t,{get:e(r),set:s(o)})},g8=i=>({...i,outputChannelCount:i.outputChannelCount!==void 0?i.outputChannelCount:i.numberOfInputs===1&&i.numberOfOutputs===1?[i.channelCount]:Array.from({length:i.numberOfOutputs},()=>1)}),m8=i=>({...i,channelCount:i.numberOfOutputs}),O8=i=>{const{imag:t,real:e}=i;return t===void 0?e===void 0?{...i,imag:[0,0],real:[0,0]}:{...i,imag:Array.from(e,()=>0),real:e}:e===void 0?{...i,imag:t,real:Array.from(t,()=>0)}:{...i,imag:t,real:e}},g2=(i,t,e)=>{try{i.setValueAtTime(t,e)}catch(s){if(s.code!==9)throw s;g2(i,t,e+1e-7)}},y8=i=>{const t=i.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},b8=i=>{const t=i.createBufferSource(),e=i.createBuffer(1,1,44100);t.buffer=e;try{t.start(0,1)}catch{return!1}return!0},v8=i=>{const t=i.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},G0=i=>{const t=i.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},m2=i=>{const t=i.createBuffer(1,1,44100),e=i.createBufferSource();e.buffer=t,e.start(),e.stop();try{return e.stop(),!0}catch{return!1}},Y0=i=>{const t=i.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},_8=i=>{const{port1:t,port2:e}=new MessageChannel;try{t.postMessage(i)}finally{t.close(),e.close()}},x8=i=>{i.start=(t=>(e=0,s=0,n)=>{const r=i.buffer,o=r===null?s:Math.min(r.duration,s);r!==null&&o>r.duration-.5/i.context.sampleRate?t.call(i,e,0,0):t.call(i,e,o,n)})(i.start)},O2=(i,t)=>{const e=t.createGain();i.connect(e);const s=(n=>()=>{n.call(i,e),i.removeEventListener("ended",s)})(i.disconnect);i.addEventListener("ended",s),Ka(i,e),i.stop=(n=>{let r=!1;return(o=0)=>{if(r)try{n.call(i,o)}catch{e.gain.setValueAtTime(0,o)}else n.call(i,o),r=!0}})(i.stop)},Ja=(i,t)=>e=>{const s={value:i};return Object.defineProperties(e,{currentTarget:s,target:s}),typeof t=="function"?t.call(i,e):t.handleEvent.call(i,e)},S8=W4(Bo),w8=Y4(Bo),k8=a6(Md),y2=new WeakMap,C8=k6(y2),Xs=DP(new Map,new WeakMap),xn=h8(),b2=eA(Xs,kn),U0=w6(Pi),oi=GA(Pi,U0,Eo),T8=tP(b2,ye,oi),pe=P6(Ad),rr=PA(xn),ee=X6(rr),v2=new WeakMap,_2=O6(Ja),lh=rA(xn),H0=Z6(lh),K0=F6(xn),x2=W6(xn),Tc=aA(xn),Ee=kP(q4(Yx),G4(S8,w8,kf,k8,Cf,Pi,C8,eh,ye,Bo,Xn,Eo,Xu),Xs,N6(Xg,Cf,Pi,ye,kc,Xn),kn,Ed,Ei,s6(kf,Xg,Pi,ye,kc,pe,Xn,ee),h6(v2,Pi,Bs),_2,pe,H0,K0,x2,ee,Tc),P8=J4(Ee,T8,kn,b2,pe,ee),J0=new WeakSet,Sy=iA(xn),S2=UP(new Uint32Array(1)),tO=u8(S2,kn),eO=f8(S2),w2=iP(J0,Xs,Ei,Sy,rr,s8(Sy),tO,eO),Rd=U4(Gi),k2=YA(U0,sh,Eo),Cn=qP(k2),tl=nA(Rd,Xs,y8,b8,v8,G0,m2,Y0,x8,d8(ah),O2),Tn=jA(C6(sh),k2),A8=rP(Cn,tl,ye,Tn,oi),zs=CP(X4(Ux),v2,F0,TP,D4,L4,V4,B4,Z4,Fg,jx,lh,g2),M8=nP(Ee,A8,zs,Ke,tl,pe,ee,Ja),E8=pP(Ee,gP,kn,Ke,oA(Gi,ah),pe,ee,oi),R8=NP(Cn,h2,ye,Tn,oi),Zo=KA(y2),Q8=$P(Ee,zs,R8,Ed,h2,pe,ee,Zo),Kr=J6(Bo,K0),I8=p8(Ke,Kr),Jr=pA(lh,I8),$8=BP(Jr,ye,oi),N8=VP(Ee,$8,Jr,pe,ee),D8=WP(rh,ye,oi),L8=FP(Ee,D8,rh,pe,ee,m8),V8=OA(Rd,tl,Gi,Kr),el=mA(Rd,Xs,V8,G0,Y0),B8=YP(Cn,el,ye,Tn,oi),Z8=GP(Ee,zs,B8,el,pe,ee,Ja),C2=yA(Ei,ah),F8=JP(C2,ye,oi),W8=KP(Ee,F8,C2,pe,ee,Zo),q8=o6(Cn,u2,ye,Tn,oi),X8=r6(Ee,zs,q8,u2,pe,ee,Zo),T2=bA(Ei),z8=p6(Cn,T2,ye,Tn,oi),j8=d6(Ee,zs,z8,T2,Ei,pe,ee,Zo),G8=x6(Cn,Gi,ye,Tn,oi),Y8=_6(Ee,zs,G8,Gi,pe,ee),U8=SA(Ed,Ke,oh,Ei),Qd=UA(Xs,Gi,oh,r8(Gi,rr)),H8=$6(tl,ye,rr,oi,Qd),K8=vA(U8),J8=Q6(Ee,K8,H8,pe,ee,Zo),t9=mP(zs,Jr,el,oh,Ei,d2,ee,ah),P2=new WeakMap,e9=K6(E8,t9,_2,ee,P2,Ja),A2=AA(Rd,Xs,G0,m2,Y0,O2),i9=ZA(Cn,A2,ye,Tn,oi),s9=BA(Ee,zs,A2,i9,pe,ee,Ja),M2=zP(tl),n9=NA(M2,Ke,Gi,p2,Kr),Id=$A(M2,Ke,n9,p2,Kr,lh,ah),r9=EA(kf,Ke,Jr,Gi,oh,Id,Ei,Cf,d2,Kr),E2=MA(r9),o9=qA(Cn,Jr,el,Gi,E2,ye,rr,Tn,oi,Qd),a9=WA(Ee,zs,E2,o9,pe,ee,Zo),l9=RA(kn),c9=zA(l9,pe,new WeakSet,O8),h9=IA(Jr,rh,Gi,Id,Ei,Kr),R2=QA(h9,Ei),u9=i8(Cn,R2,ye,Tn,oi),f9=e8(Ee,zs,R2,u9,pe,ee),d9=c8(Id,ye,oi),p9=l8(Ee,Ke,Id,d9,pe,ee,Zo),Q2=z6(xn),iO=y6(xn),I2=new WeakMap,g9=A6(I2,rr),m9=Q2?j4(Xs,Ei,m6(xn),iO,b6(F4),pe,g9,ee,Tc,new WeakMap,new WeakMap,n8(Tc,rr),xn):void 0,O9=q6(H0,ee),y9=i6(J0,Xs,e6,g6,new WeakSet,pe,O9,Sf,Cc,tO,eO),$2=QP(m9,P8,w2,M8,Q8,N8,L8,Z8,W8,y9,X8,j8,Y8,J8,e9,s9,a9,c9,f9,p9),b9=j6(Ee,wA,pe,ee),v9=Y6(Ee,kA,pe,ee),_9=U6(Ee,CA,pe,ee),x9=TA(Ke,ee),S9=H6(Ee,x9,pe),w9=dP($2,Ke,Ei,o8,b9,v9,_9,S9,lh),sO=M6(P2),k9=H4(sO),N2=XP(kn),C9=l6(sO),D2=u6(kn),L2=new WeakMap,T9=S6(L2,Bs),P9=dA(N2,kn,Ke,Jr,rh,el,Gi,oh,Ei,D2,iO,T9,Kr),A9=cA(Ke,P9,Gi,Ei,Kr),M9=RP(Cn,N2,tl,Jr,rh,el,Gi,C9,D2,iO,ye,Tc,rr,Tn,oi,Qd),E9=T6(I2),R9=HA(L2),wy=Q2?AP(k9,Ee,zs,M9,A9,Pi,E9,pe,ee,Tc,g8,R9,_8,Ja):void 0,Q9=t6(Ei,rr),I9=JA(J0,Xs,U0,sO,Qd,Sf,tO,eO),$9=LA($2,Xs,Ke,Q9,I9),N9=D6(Ad,H0),D9=L6(Z0,K0),L9=V6(F0,x2),V9=B6(Ad,ee);function ls(i){return i===void 0}function Nt(i){return i!==void 0}function B9(i){return typeof i=="function"}function Zs(i){return typeof i=="number"}function $r(i){return Object.prototype.toString.call(i)==="[object Object]"&&i.constructor===Object}function V2(i){return typeof i=="boolean"}function zi(i){return Array.isArray(i)}function Yn(i){return typeof i=="string"}function Zh(i){return Yn(i)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(i)}function kt(i,t){if(!i)throw new Error(t)}function Un(i,t,e=1/0){if(!(t<=i&&i<=e))throw new RangeError(`Value must be within [${t}, ${e}], got: ${i}`)}function B2(i){!i.isOffline&&i.state!=="running"&&$d('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Z2=!1,ky=!1;function Cy(i){Z2=i}function Z9(i){ls(i)&&Z2&&!ky&&(ky=!0,$d("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let F2=console;function F9(...i){F2.log(...i)}function $d(...i){F2.warn(...i)}function W9(i){return new w9(i)}function q9(i,t,e){return new $9(i,t,e)}const ns=typeof self=="object"?self:null,X9=ns&&(ns.hasOwnProperty("AudioContext")||ns.hasOwnProperty("webkitAudioContext"));function z9(i,t,e){return kt(Nt(wy),"AudioWorkletNode only works in a secure context (https or localhost)"),new(i instanceof ns?.BaseAudioContext?ns?.AudioWorkletNode:wy)(i,t,e)}function js(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function De(i,t,e,s){function n(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(h){try{c(s.next(h))}catch(u){o(u)}}function l(h){try{c(s.throw(h))}catch(u){o(u)}}function c(h){h.done?r(h.value):n(h.value).then(a,l)}c((s=s.apply(i,t||[])).next())})}class j9{constructor(t,e,s,n){this._callback=t,this._type=e,this._minimumUpdateInterval=Math.max(128/(n||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){const t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),e=URL.createObjectURL(t),s=new Worker(e);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){var e;this._updateInterval=Math.max(t,this._minimumUpdateInterval),this._type==="worker"&&((e=this._worker)===null||e===void 0||e.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Ro(i){return L9(i)}function Nr(i){return D9(i)}function zu(i){return V9(i)}function oa(i){return N9(i)}function G9(i){return i instanceof w2}function Y9(i,t){return i==="value"||Ro(t)||Nr(t)||G9(t)}function ko(i,...t){if(!t.length)return i;const e=t.shift();if($r(i)&&$r(e))for(const s in e)Y9(s,e[s])?i[s]=e[s]:$r(e[s])?(i[s]||Object.assign(i,{[s]:{}}),ko(i[s],e[s])):Object.assign(i,{[s]:e[s]});return ko(i,...t)}function U9(i,t){return i.length===t.length&&i.every((e,s)=>t[s]===e)}function xt(i,t,e=[],s){const n={},r=Array.from(t);if($r(r[0])&&s&&!Reflect.has(r[0],s)&&(Object.keys(r[0]).some(a=>Reflect.has(i,a))||(ko(n,{[s]:r[0]}),e.splice(e.indexOf(s),1),r.shift())),r.length===1&&$r(r[0]))ko(n,r[0]);else for(let o=0;o<e.length;o++)Nt(r[o])&&(n[e[o]]=r[o]);return ko(i,n)}function H9(i){return i.constructor.getDefaults()}function yn(i,t){return ls(i)?t:i}function Qs(i,t){return t.forEach(e=>{Reflect.has(i,e)&&delete i[e]}),i}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class or{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||ns&&this.toString()===ns.TONE_DEBUG_CLASS)&&F9(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}or.version=zx;const nO=1e-6;function Da(i,t){return i>t+nO}function Ug(i,t){return Da(i,t)||Es(i,t)}function Mf(i,t){return i+nO<t}function Es(i,t){return Math.abs(i-t)<nO}function K9(i,t,e){return Math.max(Math.min(i,e),t)}class ws extends or{constructor(){super(),this.name="Timeline",this._timeline=[];const t=xt(ws.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(kt(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];kt(Ug(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(t){const e=this._timeline.indexOf(t);return e!==-1&&this._timeline.splice(e,1),this}get(t,e="time"){const s=this._search(t,e);return s!==-1?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const s=this._search(t,e);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const s=this._search(t);return s-1>=0?this._timeline[s-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Es(this._timeline[e].time,t)){for(let s=e;s>=0&&Es(this._timeline[s].time,t);s--)e=s;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else this._timeline.length===1&&Ug(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(this._timeline.length===0)return-1;let s=0;const n=this._timeline.length;let r=n;if(n>0&&this._timeline[n-1][e]<=t)return n-1;for(;s<r;){let o=Math.floor(s+(r-s)/2);const a=this._timeline[o],l=this._timeline[o+1];if(Es(a[e],t)){for(let c=o;c<this._timeline.length;c++){const h=this._timeline[c];if(Es(h[e],t))o=c;else break}return o}else{if(Mf(a[e],t)&&Da(l[e],t))return o;Da(a[e],t)?r=o:s=o+1}}return-1}_iterate(t,e=0,s=this._timeline.length-1){this._timeline.slice(e,s+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const s=this._search(t);return s!==-1&&this._iterate(e,0,s),this}forEachAfter(t,e){const s=this._search(t);return this._iterate(e,s+1),this}forEachBetween(t,e,s){let n=this._search(t),r=this._search(e);return n!==-1&&r!==-1?(this._timeline[n].time!==t&&(n+=1),this._timeline[r].time===e&&(r-=1),this._iterate(s,n,r)):n===-1&&this._iterate(s,0,r),this}forEachFrom(t,e){let s=this._search(t);for(;s>=0&&this._timeline[s].time>=t;)s--;return this._iterate(e,s+1),this}forEachAtTime(t,e){const s=this._search(t);if(s!==-1&&Es(this._timeline[s].time,t)){let n=s;for(let r=s;r>=0&&Es(this._timeline[r].time,t);r--)n=r;this._iterate(r=>{e(r)},n,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const W2=[];function Nd(i){W2.push(i)}function J9(i){W2.forEach(t=>t(i))}const q2=[];function Dd(i){q2.push(i)}function t7(i){q2.forEach(t=>t(i))}class ch extends or{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(n=>{ls(this._events)&&(this._events={}),this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(e)}),this}once(t,e){const s=(...n)=>{e(...n),this.off(t,s)};return this.on(t,s),this}off(t,e){return t.split(/\W+/).forEach(n=>{if(ls(this._events)&&(this._events={}),this._events.hasOwnProperty(n))if(ls(e))this._events[n]=[];else{const r=this._events[n];for(let o=r.length-1;o>=0;o--)r[o]===e&&r.splice(o,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const s=this._events[t].slice(0);for(let n=0,r=s.length;n<r;n++)s[n].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{const s=Object.getOwnPropertyDescriptor(ch.prototype,e);Object.defineProperty(t.prototype,e,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class X2 extends ch{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}let rO=class z2 extends X2{constructor(){var t,e;super(),this.name="Context",this._constants=new Map,this._timeouts=new ws,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const s=xt(z2.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=((t=arguments[0])===null||t===void 0?void 0:t.latencyHint)||""):(this._context=W9({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new j9(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((e=arguments[0])===null||e===void 0)&&e.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(J9(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,s){return this._context.createBuffer(t,e,s)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,s){return this._context.createPeriodicWave(t,e,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return kt(oa(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return kt(oa(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return kt(oa(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){kt(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){kt(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){kt(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){kt(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return z9(this.rawContext,t,e)}addAudioWorkletModule(t){return De(this,void 0,void 0,function*(){kt(Nt(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(t)),yield this._workletPromise})}workletsAreReady(){return De(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get lookAhead(){return this._lookAhead}set lookAhead(t){this._lookAhead=t,this.updateInterval=t?t/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return oa(this._context)?this._context.resume():Promise.resolve()}close(){return De(this,void 0,void 0,function*(){oa(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&t7(this)})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),s=e.getChannelData(0);for(let r=0;r<s.length;r++)s[r]=t;const n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants.set(t,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this.close(),this}_timeoutLoop(){const t=this.now();this._timeouts.forEachBefore(t,e=>{e.callback(),this._timeouts.remove(e)})}setTimeout(t,e){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:s+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const s=++this._timeoutIds,n=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),n()},id:s,time:r+e})};return n(),s}};class e7 extends X2{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,s){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t){return De(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}}function be(i,t){zi(t)?t.forEach(e=>be(i,e)):Object.defineProperty(i,t,{enumerable:!0,writable:!1})}function oO(i,t){zi(t)?t.forEach(e=>oO(i,e)):Object.defineProperty(i,t,{writable:!0})}const Jt=()=>{};class _e extends or{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Jt;const t=xt(_e.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,Yn(t.url)?this.load(t.url).catch(t.onerror):t.url&&this.set(t.url)}static getDefaults(){return{onerror:Jt,onload:Jt,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:bs().sampleRate}set(t){return t instanceof _e?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return De(this,void 0,void 0,function*(){const e=_e.load(t).then(s=>{this.set(s),this.onload(this)});_e.downloads.push(e);try{yield e}finally{const s=_e.downloads.indexOf(e);_e.downloads.splice(s,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=zi(t)&&t[0].length>0,s=e?t.length:1,n=e?t[0].length:t.length,r=bs(),o=r.createBuffer(s,n,r.sampleRate),a=!e&&s===1?[t]:t;for(let l=0;l<s;l++)o.copyToChannel(a[l],l);return this._buffer=o,this}toMono(t){if(Zs(t))this.fromArray(this.toArray(t));else{let e=new Float32Array(this.length);const s=this.numberOfChannels;for(let n=0;n<s;n++){const r=this.toArray(n);for(let o=0;o<r.length;o++)e[o]+=r[o]}e=e.map(n=>n/s),this.fromArray(e)}return this}toArray(t){if(Zs(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{const e=[];for(let s=0;s<this.numberOfChannels;s++)e[s]=this.getChannelData(s);return e}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){kt(this.loaded,"Buffer is not loaded");const s=Math.floor(t*this.sampleRate),n=Math.floor(e*this.sampleRate);kt(s<n,"The start time must be less than the end time");const r=n-s,o=bs().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(s,n),a);return new _e(o)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new _e().fromArray(t)}static fromUrl(t){return De(this,void 0,void 0,function*(){return yield new _e().load(t)})}static load(t){return De(this,void 0,void 0,function*(){const e=_e.baseUrl===""||_e.baseUrl.endsWith("/")?_e.baseUrl:_e.baseUrl+"/",s=yield fetch(e+t);if(!s.ok)throw new Error(`could not load url: ${t}`);const n=yield s.arrayBuffer();return yield bs().decodeAudioData(n)})}static supportsType(t){const e=t.split("."),s=e[e.length-1];return document.createElement("audio").canPlayType("audio/"+s)!==""}static loaded(){return De(this,void 0,void 0,function*(){for(yield Promise.resolve();_e.downloads.length;)yield _e.downloads[0]})}}_e.baseUrl="";_e.downloads=[];class aO extends rO{constructor(){super({clockSource:"offline",context:zu(arguments[0])?arguments[0]:q9(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:zu(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=zu(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return De(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const s=Math.floor(this.sampleRate/128);t&&e%s===0&&(yield new Promise(n=>setTimeout(n,1)))}})}render(){return De(this,arguments,void 0,function*(t=!0){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new _e(e)})}close(){return Promise.resolve()}}const j2=new e7;let bo=j2;function bs(){return bo===j2&&X9&&i7(new rO),bo}function i7(i,t=!1){t&&bo.dispose(),oa(i)?bo=new rO(i):zu(i)?bo=new aO(i):bo=i}function Hg(){return bo.resume()}if(ns&&!ns.TONE_SILENCE_LOGGING){const t=` * Tone.js v${zx} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function s7(i){return Math.pow(10,i/20)}function n7(i){return 20*(Math.log(i)/Math.LN10)}function G2(i){return Math.pow(2,i/12)}let Ld=440;function r7(){return Ld}function o7(i){Ld=i}function vo(i){return Math.round(Y2(i))}function Y2(i){return 69+12*Math.log2(i/Ld)}function U2(i){return Ld*Math.pow(2,(i-69)/12)}class lO extends or{constructor(t,e,s){super(),this.defaultUnits="s",this._val=e,this._units=s,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const s=parseInt(t,10),n=e==="."?1.5:1;return s===1?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/s)*n},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(Math.floor(e)*3))},regexp:/^(\d+)t$/i},tr:{method:(t,e,s)=>{let n=0;return t&&t!=="0"&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(n+=this._beatsToUnits(parseFloat(e))),s&&s!=="0"&&(n+=this._beatsToUnits(parseFloat(s)/4)),n},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof lO&&this.fromType(this._val),ls(this._val))return this._noArg();if(Yn(this._val)&&ls(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if($r(this._val)){let t=0;for(const e in this._val)if(Nt(this._val[e])){const s=this._val[e],n=new this.constructor(this.context,e).valueOf()*s;t+=n}return t}if(Nt(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}else return Yn(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class Is extends lO{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Is(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const s=new this.constructor(this.context,t).valueOf(),n=this.valueOf(),a=Math.round(n/s)*s-n;return n+a*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let r=1;r<9;r++){const o=Math.pow(2,r);e.push(o+"n."),e.push(o+"n"),e.push(o+"t")}e.push("0");let s=e[0],n=new Is(this.context,e[0]).toSeconds();return e.forEach(r=>{const o=new Is(this.context,r).toSeconds();Math.abs(o-t)<Math.abs(n-t)&&(s=r,n=o)}),s}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const s=Math.floor(e/this._getTimeSignature());let n=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=n.toString();return r.length>3&&(n=parseFloat(parseFloat(r).toFixed(3))),[s,e,n].join(":")}toTicks(){const t=this._beatsToUnits(1);return this.valueOf()/t*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return vo(this.toFrequency())}_now(){return this.context.now()}}class Wi extends Is{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return r7()}static set A4(t){o7(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return this.defaultUnits==="midi"?t:Wi.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(t,e){const n=a7[t.toLowerCase()]+(parseInt(e,10)+1)*12;return this.defaultUnits==="midi"?n:Wi.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,s){let n=1;return t&&t!=="0"&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(n*=this._beatsToUnits(parseFloat(e))),s&&s!=="0"&&(n*=this._beatsToUnits(parseFloat(s)/4)),n}}})}transpose(t){return new Wi(this.context,this.valueOf()*G2(t))}harmonize(t){return t.map(e=>this.transpose(e))}toMidi(){return vo(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Wi.A4);let s=Math.round(12*e)+57;const n=Math.floor(s/12);return n<0&&(s+=-12*n),l7[s%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(t*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return U2(t)}static ftom(t){return vo(t)}}const a7={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},l7=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Ty(i,t){return new Wi(bs(),i,t)}class ka extends Is{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class pi extends or{constructor(){super();const t=xt(pi.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:bs()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return Z9(t),new Is(this.context,t).toSeconds()}toFrequency(t){return new Wi(this.context,t).toFrequency()}toTicks(t){return new ka(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(s=>{ls(t[s])&&delete e[s]}),e}get(){const t=H9(this);return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const s=this[e];Nt(s)&&Nt(s.value)&&Nt(s.setValueAtTime)?t[e]=s.value:s instanceof pi?t[e]=s._getPartialProperties(t[e]):zi(s)||Zs(s)||Yn(s)||V2(s)?t[e]=s:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&Nt(this[e])&&(this[e]&&Nt(this[e].value)&&Nt(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof pi?this[e].set(t[e]):this[e]=t[e])}),this}}class hh extends ws{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return e!==null?e.state:this._initial}setStateAtTime(t,e,s){return Un(e,0),this.add(Object.assign({},s,{state:t,time:e})),this}getLastState(t,e){const s=this._search(e);for(let n=s;n>=0;n--){const r=this._timeline[n];if(r.state===t)return r}}getNextState(t,e){const s=this._search(e);if(s!==-1)for(let n=s;n<this._timeline.length;n++){const r=this._timeline[n];if(r.state===t)return r}}}class ne extends pi{constructor(){const t=xt(ne.getDefaults(),arguments,["param","units","convert"]);for(super(t),this.name="Param",this.overridden=!1,this._minOutput=1e-7,kt(Nt(t.param)&&(Ro(t.param)||t.param instanceof ne),"param must be an AudioParam");!Ro(t.param);)t.param=t.param._param;this._swappable=Nt(t.swappable)?t.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new ws(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Nt(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(pi.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Nt(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Nt(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Nt(this.maxValue)&&Nt(this.minValue)&&Un(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?s7(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&this.units==="decibels"?n7(t):t}setValueAtTime(t,e){const s=this.toSeconds(e),n=this._fromType(t);return kt(isFinite(n)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",t,s),this._events.add({time:s,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,s),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),s=this._events.getAfter(e),n=this._events.get(e);let r=this._initialValue;if(n===null)r=this._initialValue;else if(n.type==="setTargetAtTime"&&(s===null||s.type==="setValueAtTime")){const o=this._events.getBefore(n.time);let a;o===null?a=this._initialValue:a=o.value,n.type==="setTargetAtTime"&&(r=this._exponentialApproach(n.time,a,n.value,n.constant,e))}else if(s===null)r=n.value;else if(s.type==="linearRampToValueAtTime"||s.type==="exponentialRampToValueAtTime"){let o=n.value;if(n.type==="setTargetAtTime"){const a=this._events.getBefore(n.time);a===null?o=this._initialValue:o=a.value}s.type==="linearRampToValueAtTime"?r=this._linearInterpolate(n.time,o,s.time,s.value,e):r=this._exponentialInterpolate(n.time,o,s.time,s.value,e)}else r=n.value;return this._toType(r)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(e)===0&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const s=this._fromType(t),n=this.toSeconds(e);return kt(isFinite(s)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(s),this._events.add({time:n,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",t,n),this._param.linearRampToValueAtTime(s,n),this}exponentialRampToValueAtTime(t,e){let s=this._fromType(t);s=Es(s,0)?this._minOutput:s,this._assertRange(s);const n=this.toSeconds(e);return kt(isFinite(s)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",t,n),this._param.exponentialRampToValueAtTime(s,n),this}exponentialRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(t,s+this.toSeconds(e)),this}linearRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(t,s+this.toSeconds(e)),this}targetRampTo(t,e,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(t,s,e),this}exponentialApproachValueAtTime(t,e,s){e=this.toSeconds(e),s=this.toSeconds(s);const n=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(t,e,n),this.cancelAndHoldAtTime(e+s*.9),this.linearRampToValueAtTime(t,e+s),this}setTargetAtTime(t,e,s){const n=this._fromType(t);kt(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(n),kt(isFinite(n)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:s,time:r,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",t,r,s),this._param.setTargetAtTime(n,r,s),this}setValueCurveAtTime(t,e,s,n=1){s=this.toSeconds(s),e=this.toSeconds(e);const r=this._fromType(t[0])*n;this.setValueAtTime(this._toType(r),e);const o=s/(t.length-1);for(let a=1;a<t.length;a++){const l=this._fromType(t[a])*n;this.linearRampToValueAtTime(this._toType(l),e+a*o)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return kt(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),s=this._fromType(this.getValueAtTime(e));kt(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+s);const n=this._events.get(e),r=this._events.getAfter(e);return n&&Es(n.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),r.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(s),e):r.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(s),e)),this._events.add({time:e,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,e),this}rampTo(t,e=.1,s){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(t,e,s):this.linearRampTo(t,e,s),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const s=this._events.get(e);if(s&&s.type==="setTargetAtTime"){const n=this._events.getAfter(s.time),r=n?n.time:e+2,o=(r-e)/10;for(let a=e;a<r;a+=o)t.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,n=>{n.type==="cancelScheduledValues"?t.cancelScheduledValues(n.time):n.type==="setTargetAtTime"?t.setTargetAtTime(n.value,n.time,n.constant):t[n.type](n.value,n.time)}),this}setParam(t){kt(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,s,n,r){return s+(e-s)*Math.exp(-(r-t)/n)}_linearInterpolate(t,e,s,n,r){return e+(n-e)*((r-t)/(s-t))}_exponentialInterpolate(t,e,s,n,r){return e*Math.pow(n/e,(r-t)/(s-t))}}class Pt extends pi{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Nt(this.input)?Ro(this.input)||this.input instanceof ne?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Nt(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Nt(t)&&(t instanceof Pt||Nr(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(s=>{s.channelCount=t.channelCount,s.channelCountMode=t.channelCountMode,s.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){const t=this._getInternalNodes();kt(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,s=0){return il(this,t,e,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return $d("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,s=0){return c7(this,t,e,s),this}chain(...t){return Pc(this,...t),this}fan(...t){return t.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),Nt(this.input)&&(this.input instanceof Pt?this.input.dispose():Nr(this.input)&&this.input.disconnect()),Nt(this.output)&&(this.output instanceof Pt?this.output.dispose():Nr(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Pc(...i){const t=i.shift();i.reduce((e,s)=>(e instanceof Pt?e.connect(s):Nr(e)&&il(e,s),s),t)}function il(i,t,e=0,s=0){for(kt(Nt(i),"Cannot connect from undefined node"),kt(Nt(t),"Cannot connect to undefined node"),(t instanceof Pt||Nr(t))&&kt(t.numberOfInputs>0,"Cannot connect to node with no inputs"),kt(i.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof Pt||t instanceof ne;)Nt(t.input)&&(t=t.input);for(;i instanceof Pt;)Nt(i.output)&&(i=i.output);Ro(t)?i.connect(t,e):i.connect(t,e,s)}function c7(i,t,e=0,s=0){if(Nt(t))for(;t instanceof Pt;)t=t.input;for(;!Nr(i);)Nt(i.output)&&(i=i.output);Ro(t)?i.disconnect(t,e):Nr(t)?i.disconnect(t,e,s):i.disconnect()}class Be extends Pt{constructor(){const t=xt(Be.getDefaults(),arguments,["gain","units"]);super(t),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new ne({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),be(this,"gain")}static getDefaults(){return Object.assign(Pt.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class La extends Pt{constructor(t){super(t),this.onended=Jt,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Be({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){const s=this.toSeconds(e);return this._startTime!==-1&&s>=this._startTime&&(this._stopTime===-1||s<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Pt.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Jt})}_startGain(t,e=1){kt(this._startTime===-1,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=t+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,t),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(e,t+s):this._gainNode.gain.exponentialApproachValueAtTime(e,t,s)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){kt(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.now()),e>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const s=this._curve==="exponential"?e*2:0;this._stopSource(this.now()+s),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Jt&&(this.onended(this),this.onended=Jt,!this.context.isOffline)){const t=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(t):setTimeout(t,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),kt(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Jt,this}}class cO extends La{constructor(){const t=xt(cO.getDefaults(),arguments,["offset"]);super(t),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),il(this._source,this._gainNode),this.offset=new ne({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(La.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class de extends Pt{constructor(){const t=xt(de.getDefaults(),arguments,["value","units"]);super(t),this.name="Signal",this.override=!0,this.output=this._constantSource=new cO({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Pt.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,s=0){return hO(this,t,e,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,s){return this._param.exponentialRampTo(t,e,s),this}linearRampTo(t,e,s){return this._param.linearRampTo(t,e,s),this}targetRampTo(t,e,s){return this._param.targetRampTo(t,e,s),this}exponentialApproachValueAtTime(t,e,s){return this._param.exponentialApproachValueAtTime(t,e,s),this}setTargetAtTime(t,e,s){return this._param.setTargetAtTime(t,e,s),this}setValueCurveAtTime(t,e,s,n){return this._param.setValueCurveAtTime(t,e,s,n),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,s){return this._param.rampTo(t,e,s),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function hO(i,t,e,s){(t instanceof ne||Ro(t)||t instanceof de&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof de&&(t.overridden=!0)),il(i,t,e,s)}class uO extends ne{constructor(){const t=xt(uO.getDefaults(),arguments,["value"]);super(t),this.name="TickParam",this._events=new ws(1/0),this._multiplier=1,this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ne.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,s){e=this.toSeconds(e),this.setRampPoint(e);const n=this._fromType(t),r=this._events.get(e),o=Math.round(Math.max(1/s,1));for(let a=0;a<=o;a++){const l=s*a+e,c=this._exponentialApproach(r.time,r.value,n,s,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}setValueAtTime(t,e){const s=this.toSeconds(e);super.setValueAtTime(t,e);const n=this._events.get(s),r=this._events.previousEvent(n),o=this._getTicksUntilEvent(r,s);return n.ticks=Math.max(o,0),this}linearRampToValueAtTime(t,e){const s=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const n=this._events.get(s),r=this._events.previousEvent(n),o=this._getTicksUntilEvent(r,s);return n.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const s=this._fromType(t),n=this._events.get(e),r=Math.round(Math.max((e-n.time)*10,1)),o=(e-n.time)/r;for(let a=0;a<=r;a++){const l=o*a+n.time,c=this._exponentialInterpolate(n.time,n.value,e,s,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}_getTicksUntilEvent(t,e){if(t===null)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ls(t.ticks)){const o=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(o,t.time)}const s=this._fromType(this.getValueAtTime(t.time));let n=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&r.type==="setValueAtTime"&&(n=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(s+n)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),s=this._events.get(e);return Math.max(this._getTicksUntilEvent(s,e),0)}getDurationOfTicks(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(e);return this.getTimeOfTick(n+t)-s}getTimeOfTick(t){const e=this._events.get(t,"ticks"),s=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&s&&s.type==="linearRampToValueAtTime"&&e.value!==s.value){const n=this._fromType(this.getValueAtTime(e.time)),o=(this._fromType(this.getValueAtTime(s.time))-n)/(s.time-e.time),a=Math.sqrt(Math.pow(n,2)-2*o*(e.ticks-t)),l=(-n+a)/o,c=(-n-a)/o;return(l>0?l:c)+e.time}else return e?e.value===0?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const s=this.toSeconds(e),n=this.toSeconds(t),r=this.getTicksAtTime(s);return this.getTicksAtTime(s+n)-r}_fromType(t){return this.units==="bpm"&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units==="bpm"&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class fO extends de{constructor(){const t=xt(fO.getDefaults(),arguments,["value"]);super(t),this.name="TickSignal",this.input=this._param=new uO({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(de.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class dO extends pi{constructor(){const t=xt(dO.getDefaults(),arguments,["frequency"]);super(t),this.name="TickSource",this._state=new hh,this._tickOffset=new ws,this._ticksAtTime=new ws,this._secondsAtTime=new ws,this.frequency=new fO({context:this.context,units:t.units,value:t.frequency}),be(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},pi.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const s=this.toSeconds(t);return this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),Nt(e)&&this.setTicksAtTime(e,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(t){const e=this.toSeconds(t);if(this._state.getValueAtTime(e)==="stopped"){const s=this._state.get(e);s&&s.time>0&&(this._tickOffset.cancel(s.time),this._state.cancel(s.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}pause(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e)),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),s=this._state.getLastState("stopped",e),n=this._ticksAtTime.get(e),r={state:"paused",time:e};this._state.add(r);let o=n||s,a=n?n.ticks:0,l=null;return this._state.forEachBetween(o.time,e+this.sampleTime,c=>{let h=o.time;const u=this._tickOffset.get(c.time);u&&u.time>=o.time&&(a=u.ticks,h=u.time),o.state==="started"&&c.state!=="started"&&(a+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(h),c.time!==r.time&&(l={state:c.state,time:c.time,ticks:a})),o=c}),this._state.remove(r),l&&this._ticksAtTime.add(l),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),s=this.frequency.timeToTicks(t,e);this.setTicksAtTime(s,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),s={state:"paused",time:t};this._state.add(s);const n=this._secondsAtTime.get(t);let r=n||e,o=n?n.seconds:0,a=null;return this._state.forEachBetween(r.time,t+this.sampleTime,l=>{let c=r.time;const h=this._tickOffset.get(l.time);h&&h.time>=r.time&&(o=h.seconds,c=h.time),r.state==="started"&&l.state!=="started"&&(o+=l.time-c,l.time!==s.time&&(a={state:l.state,time:l.time,seconds:o})),r=l}),this._state.remove(s),a&&this._secondsAtTime.add(a),o}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const s=this._tickOffset.get(e),n=this._state.get(e),r=Math.max(s.time,n.time),o=this.frequency.getTicksAtTime(r)+t-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(t,e,s){let n=this._state.get(t);this._state.forEachBetween(t,e,o=>{n&&n.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(n.time,t),o.time-this.sampleTime,s),n=o});let r=null;if(n&&n.state==="started"){const o=Math.max(n.time,t),a=this.frequency.getTicksAtTime(o),l=this.frequency.getTicksAtTime(n.time),c=a-l;let h=Math.ceil(c)-c;h=Es(h,1)?0:h;let u=this.frequency.getTimeOfTick(a+h);for(;u<e;){try{s(u,Math.round(this.getTicksAtTime(u)))}catch(f){r=f;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class Vd extends pi{constructor(){const t=xt(Vd.getDefaults(),arguments,["callback","frequency"]);super(t),this.name="Clock",this.callback=Jt,this._lastUpdate=0,this._state=new hh("stopped"),this._boundLoop=this._loop.bind(this),this.callback=t.callback,this._tickSource=new dO({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,be(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(pi.getDefaults(),{callback:Jt,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){B2(this.context);const s=this.toSeconds(t);return this.log("start",s),this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,e),s<this._lastUpdate&&this.emit("start",s,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const s=this.toSeconds(e),n=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(n+t,s)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,s=>{switch(s.state){case"started":const n=this._tickSource.getTicksAtTime(s.time);this.emit("start",s.time,n);break;case"stopped":s.time!==0&&this.emit("stop",s.time);break;case"paused":this.emit("pause",s.time);break}}),this._tickSource.forEachTickBetween(t,e,(s,n)=>{this.callback(s,n)}))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ch.mixin(Vd);class sl extends Pt{constructor(){const t=xt(sl.getDefaults(),arguments,["volume"]);super(t),this.name="Volume",this.input=this.output=new Be({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,be(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Pt.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class pO extends Pt{constructor(){const t=xt(pO.getDefaults(),arguments);super(t),this.name="Destination",this.input=new sl({context:this.context}),this.output=new Be({context:this.context}),this.volume=this.input.volume,Pc(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Pt.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Pc(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}Nd(i=>{i.destination=new pO({context:i})});Dd(i=>{i.destination.dispose()});class h7 extends Pt{constructor(){super(...arguments),this.name="Listener",this.positionX=new ne({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ne({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ne({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ne({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ne({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ne({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ne({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ne({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ne({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Pt.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}Nd(i=>{i.listener=new h7({context:i})});Dd(i=>{i.listener.dispose()});class gO extends or{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=xt(gO.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const s=t.urls[e];this.add(e,s,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Jt,onload:Jt,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return kt(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,s=Jt,n=Jt){return Yn(e)?(this.baseUrl&&e.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(t.toString(),new _e(this.baseUrl+e,s,n))):this._buffers.set(t.toString(),new _e(e,s,n)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}}class Ef extends Wi{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return vo(super._frequencyToUnits(t))}_ticksToUnits(t){return vo(super._ticksToUnits(t))}_beatsToUnits(t){return vo(super._beatsToUnits(t))}_secondsToUnits(t){return vo(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return U2(this.toMidi())}transpose(t){return new Ef(this.context,this.toMidi()+t)}}class qe extends ka{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class u7 extends pi{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new ws,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;this._events.forEachBefore(t+this.anticipation,e=>{t-e.time<=this.expiration&&e.callback(),this._events.remove(e)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}Nd(i=>{i.draw=new u7({context:i})});Dd(i=>{i.draw.dispose()});class f7 extends or{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){kt(Nt(t.time),"Events must have a time property"),kt(Nt(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new d7(t.time,t.time+t.duration,t);for(this._root===null?this._root=e:this._root.insert(e),this._length++;e!==null;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(this._root!==null){const e=[];this._root.search(t.time,e);for(const s of e)if(s.event===t){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,e=>this.remove(e)),this}_setRoot(t){this._root=t,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(t,e){t.parent!==null?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(t.left===null&&t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{const e=t.getBalance();let s,n=null;if(e>0)if(t.left.right===null)s=t.left,s.right=t.right,n=s;else{for(s=t.left.right;s.right!==null;)s=s.right;s.parent&&(s.parent.right=s.left,n=s.parent,s.left=t.left,s.right=t.right)}else if(t.right.left===null)s=t.right,s.left=t.left,n=s;else{for(s=t.right.left;s.left!==null;)s=s.left;s.parent&&(s.parent.left=s.right,n=s.parent,s.left=t.left,s.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=s:t.parent.right=s:this._setRoot(s),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,s=t.isLeftChild(),n=t.right;n&&(t.right=n.left,n.left=t),e!==null?s?e.left=n:e.right=n:this._setRoot(n)}_rotateRight(t){const e=t.parent,s=t.isLeftChild(),n=t.left;n&&(t.left=n.right,n.right=t),e!==null?s?e.left=n:e.right=n:this._setRoot(n)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){const e=[];if(this._root.search(t,e),e.length>0){let s=e[0];for(let n=1;n<e.length;n++)e[n].low>s.low&&(s=e[n]);return s.event}}return null}forEach(t){if(this._root!==null){const e=[];this._root.traverse(s=>e.push(s)),e.forEach(s=>{s.event&&t(s.event)})}return this}forEachAtTime(t,e){if(this._root!==null){const s=[];this._root.search(t,s),s.forEach(n=>{n.event&&e(n.event)})}return this}forEachFrom(t,e){if(this._root!==null){const s=[];this._root.searchAfter(t,s),s.forEach(n=>{n.event&&e(n.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(t=>t.dispose()),this._root=null,this}}class d7{constructor(t,e,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(this.left!==null&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),!(this.low>t)&&this.right!==null&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),this.left!==null&&this.left.searchAfter(t,e)),this.right!==null&&this.right.searchAfter(t,e)}traverse(t){t(this),this.left!==null&&this.left.traverse(t),this.right!==null&&this.right.traverse(t)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null&&this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null&&(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class p7 extends or{constructor(t){super(),this.name="TimelineValue",this._timeline=new ws({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Fr extends Pt{constructor(){super(xt(Fr.getDefaults(),arguments,["context"]))}connect(t,e=0,s=0){return hO(this,t,e,s),this}}class uh extends Fr{constructor(){const t=xt(uh.getDefaults(),arguments,["mapping","length"]);super(t),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,zi(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):B9(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(de.getDefaults(),{length:1024})}setMap(t,e=1024){const s=new Float32Array(e);for(let n=0,r=e;n<r;n++){const o=n/(r-1)*2-1;s[n]=t(o,n)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){const e=["none","2x","4x"].some(s=>s.includes(t));kt(e,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Bd extends Fr{constructor(){const t=xt(Bd.getDefaults(),arguments,["value"]);super(t),this.name="Pow",this._exponentScaler=this.input=this.output=new uh({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(Fr.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Wr{constructor(t,e){this.id=Wr._eventId++,this._remainderTime=0;const s=Object.assign(Wr.getDefaults(),e);this.transport=t,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:Jt,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(t){if(this.callback){const e=this.transport.bpm.getDurationOfTicks(1,t);this.callback(t+this._remainderTime*e),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Wr._eventId=0;class mO extends Wr{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(mO.getDefaults(),e);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Wr.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvent(){return Mf(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new qe(this.context,this._nextTick).toSeconds()):-1}_createEvents(t){Mf(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new qe(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const e=this.transport.getTicksAtTime(t);Da(e,this.time)&&(this._nextTick=this.floatTime+Math.ceil((e-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class Zd extends pi{constructor(){const t=xt(Zd.getDefaults(),arguments);super(t),this.name="Transport",this._loop=new p7(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new ws,this._repeatedEvents=new f7,this._syncedSignals=[],this._swingAmount=0,this._ppq=t.ppq,this._clock=new Vd({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),be(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(pi.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!==0&&e%(this._swingTicks*2)!==0){const s=e%(this._swingTicks*2)/(this._swingTicks*2),n=Math.sin(s*Math.PI)*this._swingAmount;t+=new qe(this.context,this._swingTicks*2/3).toSeconds()*n}Cy(!0),this._timeline.forEachAtTime(e,s=>s.invoke(t)),Cy(!1)}schedule(t,e){const s=new Wr(this,{callback:t,time:new ka(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(t,e,s,n=1/0){const r=new mO(this,{callback:t,duration:new Is(this.context,n).toTicks(),interval:new Is(this.context,e).toTicks(),time:new ka(this.context,s).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(t,e){const s=new Wr(this,{callback:t,once:!0,time:new ka(this.context,e).toTicks()});return this._addEvent(s,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,s=>this.clear(s.id)),this._repeatedEvents.forEachFrom(e,s=>this.clear(s.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new qe(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){this.context.resume();let s;return Nt(e)&&(s=this.toTicks(e)),this._clock.start(t,s),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!=="started"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){zi(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Is(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Is(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new qe(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new qe(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),s=this._clock.frequency.timeToTicks(t,e);this.ticks=s}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if(this.state==="started"){const s=this._clock.getTicksAtTime(e),n=this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,e),r=e+n;this.emit("stop",r),this._clock.setTicksAtTime(t,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this.emit("ticks",e),this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return this._clock.getTicksAtTime(t)}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!=="started")return 0;{const e=this.now(),s=this.getTicksAtTime(e),n=t-s%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){const s=this.now();let n=this.bpm,r=1/(60/n.getValueAtTime(s)/this.PPQ),o=[];if(t.units==="time"){const l=.015625/r,c=new Be(l),h=new Bd(-1),u=new Be(l);n.chain(c,h,u),n=u,r=1/r,o=[c,h,u]}e||(t.getValueAtTime(s)!==0?e=t.getValueAtTime(s)/r:e=0);const a=new Be(e);return n.connect(a),a.connect(t._param),o.push(a),this._syncedSignals.push({initial:t.value,nodes:o,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const s=this._syncedSignals[e];s.signal===t&&(s.nodes.forEach(n=>n.dispose()),s.signal.value=s.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),oO(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ch.mixin(Zd);Nd(i=>{i.transport=new Zd({context:i})});Dd(i=>{i.transport.dispose()});class mi extends Pt{constructor(t){super(t),this.input=void 0,this._state=new hh("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Jt,this._syncedStop=Jt,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new sl({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,be(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Pt.getDefaults(),{mute:!1,onstop:Jt,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,s){let n=ls(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(n=this._clampToCurrentTime(n),!this._synced&&this._state.getValueAtTime(n)==="started")kt(Da(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,e,s);else if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){const r=this._state.get(n);r&&(r.offset=this.toSeconds(yn(e,0)),r.duration=s?this.toSeconds(s):void 0);const o=this.context.transport.schedule(a=>{this._start(a,e,s)},n);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else B2(this.context),this._start(n,e,s);return this}stop(t){let e=ls(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this._state.getValueAtTime(e)==="started"||Nt(this._state.getNextState("started",e))){if(this.log("stop",e),!this._synced)this._stop(e);else{const s=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(s)}this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,s){return t=this.toSeconds(t),this._state.getValueAtTime(t)==="started"&&(this._state.cancel(t),this._restart(t,e,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(Da(e,0)){const s=this._state.get(e);if(s&&s.state==="started"&&s.time!==e){const n=e-this.toSeconds(s.time);let r;s.duration&&(r=this.toSeconds(s.duration)-n),this._start(t,this.toSeconds(s.offset)+n,r)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)==="started"&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Jt,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Fd extends La{constructor(){const t=xt(Fd.getDefaults(),arguments,["url","onload"]);super(t),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,il(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ne({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new _e(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(La.getDefaults(),{url:new _e,loop:!1,loopEnd:0,loopStart:0,onload:Jt,onerror:Jt,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,s,n=1){kt(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,n),this.loop?e=yn(e,this.loopStart):e=yn(e,0);let o=Math.max(this.toSeconds(e),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),c=a-l;Ug(o,a)&&(o=(o-l)%c+l),Es(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Mf(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,o)),Nt(s)){let a=this.toSeconds(s);a=Math.max(a,0),this.stop(r+a)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function Fo(i,t){return De(this,void 0,void 0,function*(){const e=t/i.context.sampleRate,s=new aO(1,e,i.context.sampleRate);return new i.constructor(Object.assign(i.get(),{frequency:2/e,detune:0,context:s})).toDestination().start(0),(yield s.render()).getChannelData(0)})}class OO extends La{constructor(){const t=xt(OO.getDefaults(),arguments,["frequency","type"]);super(t),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],il(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new ne({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new ne({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),be(this,["frequency","detune"])}static getDefaults(){return Object.assign(La.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class $e extends mi{constructor(){const t=xt($e.getDefaults(),arguments,["frequency","type"]);super(t),this.name="Oscillator",this._oscillator=null,this.frequency=new de({context:this.context,units:"frequency",value:t.frequency}),be(this,"frequency"),this.detune=new de({context:this.context,units:"cents",value:t.detune}),be(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&t.type!=="custom"&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(mi.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),s=new OO({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return $e._periodicWaveCache.find(e=>e.phase===this._phase&&U9(e.partials,this._partials));{const t=$e._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=["sine","square","sawtooth","triangle"].indexOf(t)!==-1;if(this._phase===0&&e)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=t);else{const s=this._getCachedPeriodicWave();if(Nt(s)){const{partials:n,wave:r}=s;this._wave=r,this._partials=n,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[n,r]=this._getRealImaginary(t,this._phase),o=this.context.createPeriodicWave(n,r);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),$e._periodicWaveCache.push({imag:r,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:n,type:this._type,wave:this._wave}),$e._periodicWaveCache.length>100&&$e._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&this._type!=="custom"&&t!=="custom"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Un(t,0);let e=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(e=s[1]),this._type!=="custom")t===0?this.type=e:this.type=e+t.toString();else{const n=new Float32Array(t);this._partials.forEach((r,o)=>n[o]=r),this._partials=Array.from(n),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const r=new Float32Array(n),o=new Float32Array(n);let a=1;if(t==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,n=a,this._partials.length===0)return[r,o]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);l?(a=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),t=l[1],a=Math.max(a,2),n=a):this._partialCount=0,this._partials=[]}for(let l=1;l<n;++l){const c=2/(l*Math.PI);let h;switch(t){case"sine":h=l<=a?1:0,this._partials[l-1]=h;break;case"square":h=l&1?2*c:0,this._partials[l-1]=h;break;case"sawtooth":h=c*(l&1?1:-1),this._partials[l-1]=h;break;case"triangle":l&1?h=2*(c*c)*(l-1>>1&1?-1:1):h=0,this._partials[l-1]=h;break;case"custom":h=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}h!==0?(r[l]=-h*Math.sin(e*l),o[l]=h*Math.cos(e*l)):(r[l]=0,o[l]=0)}return[r,o]}_inverseFFT(t,e,s){let n=0;const r=t.length;for(let o=0;o<r;o++)n+=t[o]*Math.cos(o*s)+e[o]*Math.sin(o*s);return n}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let s=0;const n=Math.PI*2,r=32;for(let o=0;o<r;o++)s=Math.max(this._inverseFFT(t,e,o/r*n),s);return K9(-this._inverseFFT(t,e,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}$e._periodicWaveCache=[];class H2 extends Fr{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new uh({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Hn extends de{constructor(){const t=xt(Hn.getDefaults(),arguments,["value"]);super(t),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new Be({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(de.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Wd extends mi{constructor(){const t=xt(Wd.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="AMOscillator",this._modulationScale=new H2({context:this.context}),this._modulationNode=new Be({context:this.context}),this._carrier=new $e({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new $e({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Hn({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),be(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign($e.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class qd extends mi{constructor(){const t=xt(qd.getDefaults(),arguments,["frequency","type","modulationType"]);super(t),this.name="FMOscillator",this._modulationNode=new Be({context:this.context,gain:0}),this._carrier=new $e({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new de({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new $e({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Hn({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Hn({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),be(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign($e.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class fh extends mi{constructor(){const t=xt(fh.getDefaults(),arguments,["frequency","width"]);super(t),this.name="PulseOscillator",this._widthGate=new Be({context:this.context,gain:0}),this._thresh=new uh({context:this.context,mapping:e=>e<=0?-1:1}),this.width=new de({context:this.context,units:"audioRange",value:t.width}),this._triangle=new $e({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),be(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(mi.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Xd extends mi{constructor(){const t=xt(Xd.getDefaults(),arguments,["frequency","type","spread"]);super(t),this.name="FatOscillator",this._oscillators=[],this.frequency=new de({context:this.context,units:"frequency",value:t.frequency}),this.detune=new de({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,be(this,["frequency","detune"])}static getDefaults(){return Object.assign($e.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,s=t/(this._oscillators.length-1);this._forEach((n,r)=>n.detune.value=e+s*r)}}get count(){return this._oscillators.length}set count(t){if(Un(t,1),this._oscillators.length!==t){this._forEach(e=>e.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const s=new $e({context:this.context,volume:-6-t*1.1,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:e===0?()=>this.onstop(this):Jt});this.type==="custom"&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[e]=s}this.spread=this._spread,this.state==="started"&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((e,s)=>e.phase=this._phase+s/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}}class zd extends mi{constructor(){const t=xt(zd.getDefaults(),arguments,["frequency","modulationFrequency"]);super(t),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Hn({context:this.context,value:2}),this._pulse=new fh({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new $e({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),be(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(mi.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Py={am:Wd,fat:Xd,fm:qd,oscillator:$e,pulse:fh,pwm:zd};class qr extends mi{constructor(){const t=xt(qr.getDefaults(),arguments,["frequency","type"]);super(t),this.name="OmniOscillator",this.frequency=new de({context:this.context,units:"frequency",value:t.frequency}),this.detune=new de({context:this.context,units:"cents",value:t.detune}),be(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign($e.getDefaults(),qd.getDefaults(),Wd.getDefaults(),Xd.getDefaults(),fh.getDefaults(),zd.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):t==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=Py[t],s=this.now();if(this._oscillator){const n=this._oscillator;n.stop(s),this.context.setTimeout(()=>n.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(e=this._oscillator.type),t==="fm"?this.type="fm"+e:t==="am"?this.type="am"+e:t==="fat"?this.type="fat"+e:t==="oscillator"?this.type=e:t==="pulse"?this.type="pulse":t==="pwm"&&(this.type="pwm")}_getOscType(t,e){return t instanceof Py[e]}get baseType(){return this._oscillator.baseType}set baseType(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&t!=="pulse"&&t!=="pwm"&&(this._oscillator.baseType=t)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(t){this._getOscType(this._oscillator,"fat")&&Zs(t)&&(this._oscillator.count=t)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(t){this._getOscType(this._oscillator,"fat")&&Zs(t)&&(this._oscillator.spread=t)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Yn(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return De(this,arguments,void 0,function*(t=1024){return Fo(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class yO extends de{constructor(){super(xt(yO.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new Be({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Pc(this._constantSource,this._sum)}static getDefaults(){return Object.assign(de.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class bO extends Fr{constructor(){const t=xt(bO.getDefaults(),arguments,["min","max"]);super(t),this.name="Scale",this._mult=this.input=new Hn({context:this.context,value:t.max-t.min}),this._add=this.output=new yO({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Fr.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}function K2(i,t=1/0){const e=new WeakMap;return function(s,n){Reflect.defineProperty(s,n,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(r){Un(r,i,t),e.set(this,r)}})}}function ar(i,t=1/0){const e=new WeakMap;return function(s,n){Reflect.defineProperty(s,n,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(r){Un(this.toSeconds(r),i,t),e.set(this,r)}})}}class jd extends mi{constructor(){const t=xt(jd.getDefaults(),arguments,["url","onload"]);super(t),this.name="Player",this._activeSources=new Set,this._buffer=new _e({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(mi.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Jt,onerror:Jt,playbackRate:1,reverse:!1})}load(t){return De(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=Jt){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,s){return super.start(t,e,s),this}_start(t,e,s){this._loop?e=yn(e,this._loopStart):e=yn(e,0);const n=this.toSeconds(e),r=s;s=yn(s,Math.max(this._buffer.duration-n,0));let o=this.toSeconds(s);o=o/this._playbackRate,t=this.toSeconds(t);const a=new Fd({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&ls(r)?a.start(t,n):a.start(t,n,o-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(s=>s.stop(e))}restart(t,e,s){return super.restart(t,e,s),this}_restart(t,e,s){var n;(n=[...this._activeSources].pop())===null||n===void 0||n.stop(t),this._start(t,e,s)}seek(t,e){const s=this.toSeconds(e);if(this._state.getValueAtTime(s)==="started"){const n=this.toSeconds(t);this._stop(s),this._start(s,n)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Un(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Un(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){const e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),s=this._state.getNextState("stopped",e);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(n=>n.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}js([ar(0)],jd.prototype,"fadeIn",void 0);js([ar(0)],jd.prototype,"fadeOut",void 0);class hs extends Pt{constructor(){const t=xt(hs.getDefaults(),arguments,["attack","decay","sustain","release"]);super(t),this.name="Envelope",this._sig=new de({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Pt.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Yn(t))return t;{let s;for(s in Fh)if(Fh[s][e]===t)return s;return t}}_setCurve(t,e,s){if(Yn(s)&&Reflect.has(Fh,s)){const n=Fh[s];$r(n)?t!=="_decayCurve"&&(this[t]=n[e]):this[t]=n}else if(zi(s)&&t!=="_decayCurve")this[t]=s;else throw new Error("Envelope: invalid curve: "+s)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(t){this._setCurve("_decayCurve","Out",t)}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),o=this.getValueAtTime(t);if(o>0){const a=1/n;n=(1-o)/a}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if(this._attackCurve==="linear")this._sig.linearRampTo(e,n,t);else if(this._attackCurve==="exponential")this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let a=this._attackCurve;for(let l=1;l<a.length;l++)if(a[l-1]<=o&&o<=a[l]){a=this._attackCurve.slice(l),a[0]=o;break}this._sig.setValueCurveAtTime(a,t,n,e)}if(r&&this.sustain<1){const a=e*this.sustain,l=t+n;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,r+l):this._sig.exponentialApproachValueAtTime(a,l,r)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve==="linear"?this._sig.linearRampTo(0,s,t):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,s,t):(kt(zi(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,s,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,s=1){return e=this.toSeconds(e),this.triggerAttack(e,s),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,s=0){return hO(this,t,e,s),this}asArray(){return De(this,arguments,void 0,function*(t=1024){const e=t/this.context.sampleRate,s=new aO(1,e,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=n+this.toSeconds(this.release),o=r*.1,a=r+o,l=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/a,decay:e*this.toSeconds(this.decay)/a,release:e*this.toSeconds(this.release)/a,context:s}));return l._sig.toDestination(),l.triggerAttackRelease(e*(n+o)/a,0),(yield s.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}js([ar(0)],hs.prototype,"attack",void 0);js([ar(0)],hs.prototype,"decay",void 0);js([K2(0,1)],hs.prototype,"sustain",void 0);js([ar(0)],hs.prototype,"release",void 0);const Fh=(()=>{let t,e;const s=[];for(t=0;t<128;t++)s[t]=Math.sin(t/127*(Math.PI/2));const n=[],r=6.4;for(t=0;t<127;t++){e=t/127;const f=Math.sin(e*(Math.PI*2)*r-Math.PI/2)+1;n[t]=f/10+e*.83}n[127]=1;const o=[],a=5;for(t=0;t<128;t++)o[t]=Math.ceil(t/127*a)/a;const l=[];for(t=0;t<128;t++)e=t/127,l[t]=.5*(1-Math.cos(Math.PI*e));const c=[];for(t=0;t<128;t++){e=t/127;const f=Math.pow(e,3)*4+.2,d=Math.cos(f*Math.PI*2*e);c[t]=Math.abs(d*(1-e))}function h(f){const d=new Array(f.length);for(let p=0;p<f.length;p++)d[p]=1-f[p];return d}function u(f){return f.slice(0).reverse()}return{bounce:{In:h(c),Out:c},cosine:{In:s,Out:u(s)},exponential:"exponential",linear:"linear",ripple:{In:n,Out:h(n)},sine:{In:l,Out:h(l)},step:{In:o,Out:h(o)}}})();class Xr extends Pt{constructor(){const t=xt(Xr.getDefaults(),arguments);super(t),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=e=>this._original_triggerRelease(e),this._volume=this.output=new sl({context:this.context,volume:t.volume}),this.volume=this._volume.volume,be(this,"volume")}static getDefaults(){return Object.assign(Pt.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const s=this["_original_"+t]=this[t];this[t]=(...n)=>{const r=n[e],o=this.context.transport.schedule(a=>{n[e]=a,s.apply(this,n)},r);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(t,e,s,n){const r=this.toSeconds(s),o=this.toSeconds(e);return this.triggerAttack(t,r,n),this.triggerRelease(r+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Fs extends Xr{constructor(){const t=xt(Fs.getDefaults(),arguments);super(t),this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(Xr.getDefaults(),{detune:0,onsilence:Jt,portamento:0})}triggerAttack(t,e,s=1){this.log("triggerAttack",t,e,s);const n=this.toSeconds(e);return this._triggerEnvelopeAttack(n,s),this.setNote(t,n),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const s=this.toSeconds(e),n=t instanceof Wi?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,r,s)}else this.frequency.setValueAtTime(n,s);return this}}js([ar(0)],Fs.prototype,"portamento",void 0);class Gd extends hs{constructor(){super(xt(Gd.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Be({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Kn extends Fs{constructor(){const t=xt(Kn.getDefaults(),arguments);super(t),this.name="Synth",this.oscillator=new qr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Gd(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),be(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Fs.getDefaults(),{envelope:Object.assign(Qs(hs.getDefaults(),Object.keys(Pt.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Qs(qr.getDefaults(),[...Object.keys(mi.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+s+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Ac extends Fs{constructor(){const t=xt(Ac.getDefaults(),arguments);super(t),this.name="ModulationSynth",this._carrier=new Kn({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Kn({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new de({context:this.context,units:"frequency"}),this.detune=new de({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new Hn({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new Be({context:this.context,gain:0}),be(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(Fs.getDefaults(),{harmonicity:3,oscillator:Object.assign(Qs(qr.getDefaults(),[...Object.keys(mi.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Qs(hs.getDefaults(),Object.keys(Pt.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Qs(qr.getDefaults(),[...Object.keys(mi.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Qs(hs.getDefaults(),Object.keys(Pt.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class vO extends Ac{constructor(){super(xt(vO.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new H2({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class Rf extends Pt{constructor(){const t=xt(Rf.getDefaults(),arguments,["frequency","type"]);super(t),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new ne({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new ne({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new ne({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new ne({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(Pt.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){kt(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t)!==-1,`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let o=0;o<t;o++){const l=Math.pow(o/t,2)*19980+20;e[o]=l}const s=new Float32Array(t),n=new Float32Array(t),r=this.context.createBiquadFilter();return r.type=this.type,r.Q.value=this.Q.value,r.frequency.value=this.frequency.value,r.gain.value=this.gain.value,r.getFrequencyResponse(e,s,n),s}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Qf extends Pt{constructor(){const t=xt(Qf.getDefaults(),arguments,["frequency","type","rolloff"]);super(t),this.name="Filter",this.input=new Be({context:this.context}),this.output=new Be({context:this.context}),this._filters=[],this._filters=[],this.Q=new de({context:this.context,units:"positive",value:t.Q}),this.frequency=new de({context:this.context,units:"frequency",value:t.frequency}),this.detune=new de({context:this.context,units:"cents",value:t.detune}),this.gain=new de({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,be(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Pt.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){kt(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t)!==-1,`Invalid filter type: ${t}`),this._type=t,this._filters.forEach(s=>s.type=t)}get rolloff(){return this._rolloff}set rolloff(t){const e=Zs(t)?t:parseInt(t,10),s=[-12,-24,-48,-96];let n=s.indexOf(e);kt(n!==-1,`rolloff can only be ${s.join(", ")}`),n+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(r=>r.disconnect()),this._filters=new Array(n);for(let r=0;r<n;r++){const o=new Rf({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[r]=o}this._internalChannels=this._filters,Pc(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new Rf({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),s=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((r,o)=>s[o]*=r)}),e.dispose(),s}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose()}),oO(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class If extends hs{constructor(){const t=xt(If.getDefaults(),arguments,["attack","decay","sustain","release"]);super(t),this.name="FrequencyEnvelope",this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Bd({context:this.context,value:t.exponent}),this._scale=this.output=new bO({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(hs.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);Un(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class _O extends Fs{constructor(){const t=xt(_O.getDefaults(),arguments);super(t),this.name="MonoSynth",this.oscillator=new qr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Qf(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new If(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new Gd(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),be(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(Fs.getDefaults(),{envelope:Object.assign(Qs(hs.getDefaults(),Object.keys(Pt.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Qs(Qf.getDefaults(),Object.keys(Pt.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Qs(If.getDefaults(),Object.keys(Pt.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Qs(qr.getDefaults(),Object.keys(mi.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+s+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class xO extends Ac{constructor(){const t=xt(xO.getDefaults(),arguments);super(t),this.name="FMSynth",this.modulationIndex=new Hn({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(Ac.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}class Yd extends Kn{constructor(){const t=xt(Yd.getDefaults(),arguments);super(t),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,be(this,["oscillator","envelope"])}static getDefaults(){return ko(Fs.getDefaults(),Kn.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const s=this.toSeconds(e),n=this.toFrequency(t instanceof Wi?t.toFrequency():t),r=n*this.octaves;return this.oscillator.frequency.setValueAtTime(r,s),this.oscillator.frequency.exponentialRampToValueAtTime(n,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}js([K2(0)],Yd.prototype,"octaves",void 0);js([ar(0)],Yd.prototype,"pitchDecay",void 0);const J2=new Set;function SO(i){J2.add(i)}function tS(i,t){const e=`registerProcessor("${i}", ${t})`;J2.add(e)}const g7=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;SO(g7);const m7=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;SO(m7);const O7=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;SO(O7);const y7="feedback-comb-filter",b7=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;tS(y7,b7);class $f extends Xr{constructor(){const t=xt($f.getDefaults(),arguments,["voice","options"]);super(t),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=n=>this.releaseAll(n),kt(!Zs(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const s=this._voices.indexOf(this._dummyVoice);this._voices.splice(s,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(Xr.getDefaults(),{maxPolyphony:32,options:{},voice:Kn})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex(s=>s.voice===t);this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return kt(t instanceof Fs,"Voice must extend Monophonic class"),t.connect(this.output),this._voices.push(t),t}else $d("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,s){t.forEach(n=>{const r=new Ef(this.context,n).toMidi(),o=this._getNextAvailableVoice();o&&(o.triggerAttack(n,e,s),this._activeVoices.push({midi:r,voice:o,released:!1}),this.log("triggerAttack",n,e))})}_triggerRelease(t,e){t.forEach(s=>{const n=new Ef(this.context,s).toMidi(),r=this._activeVoices.find(({midi:o,released:a})=>o===n&&!a);r&&(r.voice.triggerRelease(e),r.released=!0,this.log("triggerRelease",s,e))})}_scheduleEvent(t,e,s,n){kt(!this.disposed,"Synth was already disposed"),s<=this.now()?t==="attack"?this._triggerAttack(e,s,n):this._triggerRelease(e,s):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(t,e,s,n)},s-this.now())}triggerAttack(t,e,s){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("attack",t,n,s),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const s=this.toSeconds(e);return this._scheduleEvent("release",t,s),this}triggerAttackRelease(t,e,s,n){const r=this.toSeconds(s);if(this.triggerAttack(t,r,n),zi(e)){kt(zi(t),"If the duration is an array, the notes must also be an array"),t=t;for(let o=0;o<t.length;o++){const a=e[Math.min(o,e.length-1)],l=this.toSeconds(a);kt(l>0,"The duration must be greater than 0"),this.triggerRelease(t[o],r+l)}}else{const o=this.toSeconds(e);kt(o>0,"The duration must be greater than 0"),this.triggerRelease(t,r+o)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(t){const e=Qs(t,["onsilence","context"]);return this.options=ko(this.options,e),this._voices.forEach(s=>s.set(e)),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach(({voice:s})=>{s.triggerRelease(e)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(t=>t.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Ud extends Xr{constructor(){const t=xt(Ud.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(t),this.name="Sampler",this._activeSources=new Map;const e={};Object.keys(t.urls).forEach(s=>{const n=parseInt(s,10);if(kt(Zh(s)||Zs(n)&&isFinite(n),`url key is neither a note or midi pitch: ${s}`),Zh(s)){const r=new Wi(this.context,s).toMidi();e[r]=t.urls[s]}else Zs(n)&&isFinite(n)&&(e[n]=t.urls[n])}),this._buffers=new gO({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(Xr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Jt,onerror:Jt,release:.1,urls:{}})}_findClosest(t){let s=0;for(;s<96;){if(this._buffers.has(t+s))return-s;if(this._buffers.has(t-s))return s;s++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,s=1){return this.log("triggerAttack",t,e,s),Array.isArray(t)||(t=[t]),t.forEach(n=>{const r=Y2(new Wi(this.context,n).toFrequency()),o=Math.round(r),a=r-o,l=this._findClosest(o),c=o-l,h=this._buffers.get(c),u=G2(l+a),f=new Fd({url:h,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);f.start(e,0,h.duration/u,s),zi(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const d=this._activeSources.get(o),p=d.indexOf(f);p!==-1&&d.splice(p,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(s=>{const n=new Wi(this.context,s).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const r=this._activeSources.get(n);e=this.toSeconds(e),r.forEach(o=>{o.stop(e)}),this._activeSources.set(n,[])}}),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(s=>{for(;s.length;)s.shift().stop(e)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,s,n=1){const r=this.toSeconds(s);return this.triggerAttack(t,r,n),zi(e)?(kt(zi(t),"notes must be an array when duration is array"),t.forEach((o,a)=>{const l=e[Math.min(a,e.length-1)];this.triggerRelease(o,r+this.toSeconds(l))})):this.triggerRelease(t,r+this.toSeconds(e)),this}add(t,e,s){if(kt(Zh(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Zh(t)){const n=new Wi(this.context,t).toMidi();this._buffers.add(n,e,s)}else this._buffers.add(t,e,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(e=>e.dispose())}),this._activeSources.clear(),this}}js([ar(0)],Ud.prototype,"attack",void 0);js([ar(0)],Ud.prototype,"release",void 0);class da extends pi{constructor(){const t=xt(da.getDefaults(),arguments,["callback","value"]);super(t),this.name="ToneEvent",this._state=new hh("stopped"),this._startOffset=0,this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(pi.getDefaults(),{callback:Jt,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,e=>{let s;if(e.state==="started"){e.id!==-1&&this.context.transport.clear(e.id);const n=e.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Zs(this._loop)&&this._loop>1){s=1/0,Zs(this._loop)&&(s=this._loop*this._getLoopDuration());const r=this._state.getAfter(n);r!==null&&(s=Math.min(s,r.time-n)),s!==1/0&&(s=new qe(this.context,s));const o=new qe(this.context,this._getLoopDuration());e.id=this.context.transport.scheduleRepeat(this._tick.bind(this),o,new qe(this.context,n),s)}else e.id=this.context.transport.schedule(this._tick.bind(this),new qe(this.context,n))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return this._state.getValueAtTime(e)==="stopped"&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if(this._state.getValueAtTime(e)==="started"){this._state.setStateAtTime("stopped",e,{id:-1});const s=this._state.getBefore(e);let n=e;s!==null&&(n=s.time),this._rescheduleEvents(n)}return this}cancel(t){t=yn(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,s=>{this.context.transport.clear(s.id)}),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&this._state.getValueAtTime(e)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let s=.02;V2(this.humanize)||(s=this.toSeconds(this.humanize)),t+=(Math.random()*2-1)*s}this.callback(t,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new qe(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new qe(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(e!==null&&e.state==="started"){const s=this._getLoopDuration();return(t-e.time)%s/s}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Mc extends da{constructor(){const t=xt(Mc.getDefaults(),arguments,["callback","events"]);super(t),this.name="Part",this._state=new hh("stopped"),this._events=new Set,this._state.increasing=!0,t.events.forEach(e=>{zi(e)?this.add(e[0],e[1]):this.add(e)})}static getDefaults(){return Object.assign(da.getDefaults(),{events:[]})}start(t,e){const s=this.toTicks(t);if(this._state.getValueAtTime(s)!=="started"){e=yn(e,this._loop?this._loopStart:0),this._loop?e=yn(e,this._loopStart):e=yn(e,0);const n=this.toTicks(e);this._state.add({id:-1,offset:n,state:"started",time:s}),this._forEach(r=>{this._startNote(r,s,n)})}return this}_startNote(t,e,s){e-=s,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<s&&(e+=this._getLoopDuration()),t.start(new qe(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=s&&(t.loop=!1,t.start(new qe(this.context,e))):t.startOffset>=s&&t.start(new qe(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach(e=>{e.startOffset+=this._startOffset})}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach(s=>{s.stop(t)}),this}at(t,e){const s=new ka(this.context,t).toTicks(),n=new qe(this.context,1).toSeconds(),r=this._events.values();let o=r.next();for(;!o.done;){const a=o.value;if(Math.abs(s-a.startOffset)<n)return Nt(e)&&(a.value=e),a;o=r.next()}return Nt(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(e=t,t=e.time);const s=this.toTicks(t);let n;return e instanceof da?(n=e,n.callback=this._tick.bind(this)):n=new da({callback:this._tick.bind(this),context:this.context,value:e}),n.startOffset=s,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}_restartEvent(t){this._state.forEach(e=>{e.state==="started"?this._startNote(t,e.time,e.offset):t.stop(new qe(this.context,e.time))})}remove(t,e){return $r(t)&&t.hasOwnProperty("time")&&(e=t,t=e.time),t=this.toTicks(t),this._events.forEach(s=>{s.startOffset===t&&(ls(e)||Nt(e)&&s.value===e)&&(this._events.delete(s),s.dispose())}),this}clear(){return this._forEach(t=>t.dispose()),this._events.clear(),this}cancel(t){return this._forEach(e=>e.cancel(t)),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach(e=>{e instanceof Mc?e._forEach(t):t(e)}),this}_setAll(t,e){this._forEach(s=>{s[t]=e})}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):t.state==="stopped"&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach(e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)})}get loopEnd(){return new qe(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopEnd=t,this._testLoopBoundries(e)})}get loopStart(){return new qe(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(e=>{e.loopStart=this.loopStart,this._testLoopBoundries(e)})}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class wO extends Pt{constructor(){const t=xt(wO.getDefaults(),arguments,["pan"]);super(t),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new ne({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",be(this,"pan")}static getDefaults(){return Object.assign(Pt.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const v7="bit-crusher",_7=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;tS(v7,_7);class Re extends Pt{constructor(){const t=xt(Re.getDefaults(),arguments,["solo"]);super(t),this.name="Solo",this.input=this.output=new Be({context:this.context}),Re._allSolos.has(this.context)||Re._allSolos.set(this.context,new Set),Re._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Pt.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Re._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Re._soloed.has(this.context)||Re._soloed.set(this.context,new Set),Re._soloed.get(this.context).add(this)}_removeSolo(){Re._soloed.has(this.context)&&Re._soloed.get(this.context).delete(this)}_isSoloed(){return Re._soloed.has(this.context)&&Re._soloed.get(this.context).has(this)}_noSolos(){return!Re._soloed.has(this.context)||Re._soloed.has(this.context)&&Re._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Re._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Re._allSolos=new Map;Re._soloed=new Map;class kO extends Pt{constructor(){const t=xt(kO.getDefaults(),arguments,["pan","volume"]);super(t),this.name="PanVol",this._panner=this.input=new wO({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new sl({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,be(this,["pan","volume"])}static getDefaults(){return Object.assign(Pt.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class pa extends Pt{constructor(){const t=xt(pa.getDefaults(),arguments,["volume","pan"]);super(t),this.name="Channel",this._solo=this.input=new Re({solo:t.solo,context:this.context}),this._panVol=this.output=new kO({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),be(this,["pan","volume"])}static getDefaults(){return Object.assign(Pt.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return pa.buses.has(t)||pa.buses.set(t,new Be({context:this.context})),pa.buses.get(t)}send(t,e=0){const s=this._getBus(t),n=new Be({context:this.context,units:"decibels",gain:e});return this.connect(n),n.connect(s),n}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}pa.buses=new Map;const ai=bs().transport;bs().destination;bs().destination;bs().listener;bs().draw;bs();const x7=Math.PI/180;function S7(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const _o=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},rt={_global:_o,version:"10.0.2",isBrowser:S7(),isUnminified:/param/.test((function(i){}).toString()),dblClickWindow:400,getAngle(i){return rt.angleDeg?i*x7:i},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return rt.DD.isDragging},isTransforming(){var i,t;return(t=(i=rt.Transformer)===null||i===void 0?void 0:i.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!rt.DD.node},releaseCanvasOnDestroy:!0,document:_o.document,_injectGlobal(i){typeof _o.Konva<"u"&&console.error("Severa Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),_o.Konva=i}},ke=i=>{rt[i.prototype.getClassName()]=i};rt._injectGlobal(rt);const w7=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Ay=()=>{if(typeof document>"u")throw new Error(w7)};class rs{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new rs(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),n=this.m[0]*e+this.m[2]*s,r=this.m[1]*e+this.m[3]*s,o=this.m[0]*-s+this.m[2]*e,a=this.m[1]*-s+this.m[3]*e;return this.m[0]=n,this.m[1]=r,this.m[2]=o,this.m[3]=a,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){const s=this.m[0]+this.m[2]*e,n=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,o=this.m[3]+this.m[1]*t;return this.m[0]=s,this.m[1]=n,this.m[2]=r,this.m[3]=o,this}multiply(t){const e=this.m[0]*t.m[0]+this.m[2]*t.m[1],s=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],o=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],a=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=s,this.m[2]=n,this.m[3]=r,this.m[4]=o,this.m[5]=a,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,s=-this.m[1]*t,n=-this.m[2]*t,r=this.m[0]*t,o=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=s,this.m[2]=n,this.m[3]=r,this.m[4]=o,this.m[5]=a,this}getMatrix(){return this.m}decompose(){const t=this.m[0],e=this.m[1],s=this.m[2],n=this.m[3],r=this.m[4],o=this.m[5],a=t*n-e*s,l={x:r,y:o,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const c=Math.sqrt(t*t+e*e);l.rotation=e>0?Math.acos(t/c):-Math.acos(t/c),l.scaleX=c,l.scaleY=a/c,l.skewX=(t*s+e*n)/a,l.skewY=0}else if(s!=0||n!=0){const c=Math.sqrt(s*s+n*n);l.rotation=Math.PI/2-(n>0?Math.acos(-s/c):-Math.acos(s/c)),l.scaleX=a/c,l.scaleY=c,l.skewX=0,l.skewY=(t*s+e*n)/a}return l.rotation=D._getRotation(l.rotation),l}}const k7="[object Array]",C7="[object Number]",T7="[object String]",P7="[object Boolean]",A7=Math.PI/180,M7=180/Math.PI,Ep="#",E7="",R7="0",Q7="Konva warning: ",My="Konva error: ",I7="rgb(",Rp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},$7=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let Wh=[];const N7=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(i){setTimeout(i,60)},D={_isElement(i){return!!(i&&i.nodeType==1)},_isFunction(i){return!!(i&&i.constructor&&i.call&&i.apply)},_isPlainObject(i){return!!i&&i.constructor===Object},_isArray(i){return Object.prototype.toString.call(i)===k7},_isNumber(i){return Object.prototype.toString.call(i)===C7&&!isNaN(i)&&isFinite(i)},_isString(i){return Object.prototype.toString.call(i)===T7},_isBoolean(i){return Object.prototype.toString.call(i)===P7},isObject(i){return i instanceof Object},isValidSelector(i){if(typeof i!="string")return!1;const t=i[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(i){return i===0||i>0?1:-1},requestAnimFrame(i){Wh.push(i),Wh.length===1&&N7(function(){const t=Wh;Wh=[],t.forEach(function(e){e()})})},createCanvasElement(){Ay();const i=document.createElement("canvas");try{i.style=i.style||{}}catch{}return i},createImageElement(){return Ay(),document.createElement("img")},_isInDocument(i){for(;i=i.parentNode;)if(i==document)return!0;return!1},_urlToImage(i,t){const e=D.createImageElement();e.onload=function(){t(e)},e.src=i},_rgbToHex(i,t,e){return((1<<24)+(i<<16)+(t<<8)+e).toString(16).slice(1)},_hexToRgb(i){i=i.replace(Ep,E7);const t=parseInt(i,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let i=(Math.random()*16777215<<0).toString(16);for(;i.length<6;)i=R7+i;return Ep+i},getRGB(i){let t;return i in Rp?(t=Rp[i],{r:t[0],g:t[1],b:t[2]}):i[0]===Ep?this._hexToRgb(i.substring(1)):i.substr(0,4)===I7?(t=$7.exec(i.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(i){return i=i||"black",D._namedColorToRBA(i)||D._hex3ColorToRGBA(i)||D._hex4ColorToRGBA(i)||D._hex6ColorToRGBA(i)||D._hex8ColorToRGBA(i)||D._rgbColorToRGBA(i)||D._rgbaColorToRGBA(i)||D._hslColorToRGBA(i)},_namedColorToRBA(i){const t=Rp[i.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(i){if(i.indexOf("rgb(")===0){i=i.match(/rgb\(([^)]+)\)/)[1];const t=i.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(i){if(i.indexOf("rgba(")===0){i=i.match(/rgba\(([^)]+)\)/)[1];const t=i.split(/ *, */).map((e,s)=>e.slice(-1)==="%"?s===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(i){if(i[0]==="#"&&i.length===9)return{r:parseInt(i.slice(1,3),16),g:parseInt(i.slice(3,5),16),b:parseInt(i.slice(5,7),16),a:parseInt(i.slice(7,9),16)/255}},_hex6ColorToRGBA(i){if(i[0]==="#"&&i.length===7)return{r:parseInt(i.slice(1,3),16),g:parseInt(i.slice(3,5),16),b:parseInt(i.slice(5,7),16),a:1}},_hex4ColorToRGBA(i){if(i[0]==="#"&&i.length===5)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16),a:parseInt(i[4]+i[4],16)/255}},_hex3ColorToRGBA(i){if(i[0]==="#"&&i.length===4)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16),a:1}},_hslColorToRGBA(i){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(i)){const[t,...e]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(i),s=Number(e[0])/360,n=Number(e[1])/100,r=Number(e[2])/100;let o,a,l;if(n===0)return l=r*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};r<.5?o=r*(1+n):o=r+n-r*n;const c=2*r-o,h=[0,0,0];for(let u=0;u<3;u++)a=s+1/3*-(u-1),a<0&&a++,a>1&&a--,6*a<1?l=c+(o-c)*6*a:2*a<1?l=o:3*a<2?l=c+(o-c)*(2/3-a)*6:l=c,h[u]=l*255;return{r:Math.round(h[0]),g:Math.round(h[1]),b:Math.round(h[2]),a:1}}},haveIntersection(i,t){return!(t.x>i.x+i.width||t.x+t.width<i.x||t.y>i.y+i.height||t.y+t.height<i.y)},cloneObject(i){const t={};for(const e in i)this._isPlainObject(i[e])?t[e]=this.cloneObject(i[e]):this._isArray(i[e])?t[e]=this.cloneArray(i[e]):t[e]=i[e];return t},cloneArray(i){return i.slice(0)},degToRad(i){return i*A7},radToDeg(i){return i*M7},_degToRad(i){return D.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),D.degToRad(i)},_radToDeg(i){return D.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),D.radToDeg(i)},_getRotation(i){return rt.angleDeg?D.radToDeg(i):i},_capitalize(i){return i.charAt(0).toUpperCase()+i.slice(1)},throw(i){throw new Error(My+i)},error(i){console.error(My+i)},warn(i){rt.showWarnings&&console.warn(Q7+i)},each(i,t){for(const e in i)t(e,i[e])},_inRange(i,t,e){return t<=i&&i<e},_getProjectionToSegment(i,t,e,s,n,r){let o,a,l;const c=(i-e)*(i-e)+(t-s)*(t-s);if(c==0)o=i,a=t,l=(n-e)*(n-e)+(r-s)*(r-s);else{const h=((n-i)*(e-i)+(r-t)*(s-t))/c;h<0?(o=i,a=t,l=(i-n)*(i-n)+(t-r)*(t-r)):h>1?(o=e,a=s,l=(e-n)*(e-n)+(s-r)*(s-r)):(o=i+h*(e-i),a=t+h*(s-t),l=(o-n)*(o-n)+(a-r)*(a-r))}return[o,a,l]},_getProjectionToLine(i,t,e){const s=D.cloneObject(i);let n=Number.MAX_VALUE;return t.forEach(function(r,o){if(!e&&o===t.length-1)return;const a=t[(o+1)%t.length],l=D._getProjectionToSegment(r.x,r.y,a.x,a.y,i.x,i.y),c=l[0],h=l[1],u=l[2];u<n&&(s.x=c,s.y=h,n=u)}),s},_prepareArrayForTween(i,t,e){const s=[],n=[];if(i.length>t.length){const o=t;t=i,i=o}for(let o=0;o<i.length;o+=2)s.push({x:i[o],y:i[o+1]});for(let o=0;o<t.length;o+=2)n.push({x:t[o],y:t[o+1]});const r=[];return n.forEach(function(o){const a=D._getProjectionToLine(o,s,e);r.push(a.x),r.push(a.y)}),r},_prepareToStringify(i){let t;i.visitedByCircularReferenceRemoval=!0;for(const e in i)if(i.hasOwnProperty(e)&&i[e]&&typeof i[e]=="object"){if(t=Object.getOwnPropertyDescriptor(i,e),i[e].visitedByCircularReferenceRemoval||D._isElement(i[e]))if(t.configurable)delete i[e];else return null;else if(D._prepareToStringify(i[e])===null)if(t.configurable)delete i[e];else return null}return delete i.visitedByCircularReferenceRemoval,i},_assign(i,t){for(const e in t)i[e]=t[e];return i},_getFirstPointerId(i){return i.touches?i.changedTouches[0].identifier:i.pointerId||999},releaseCanvas(...i){rt.releaseCanvasOnDestroy&&i.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(i,t,e,s){let n=t<0?t:0,r=e<0?e:0;t=Math.abs(t),e=Math.abs(e);let o=0,a=0,l=0,c=0;typeof s=="number"?o=a=l=c=Math.min(s,t/2,e/2):(o=Math.min(s[0]||0,t/2,e/2),a=Math.min(s[1]||0,t/2,e/2),c=Math.min(s[2]||0,t/2,e/2),l=Math.min(s[3]||0,t/2,e/2)),i.moveTo(n+o,r),i.lineTo(n+t-a,r),i.arc(n+t-a,r+a,a,Math.PI*3/2,0,!1),i.lineTo(n+t,r+e-c),i.arc(n+t-c,r+e-c,c,0,Math.PI/2,!1),i.lineTo(n+l,r+e),i.arc(n+l,r+e-l,l,Math.PI/2,Math.PI,!1),i.lineTo(n,r+o),i.arc(n+o,r+o,o,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(i,t,e,s,n){s=Math.abs(s);for(let r=0;r<e;r++){const o=t[(r-1+e)%e],a=t[r],l=t[(r+1)%e],c={x:a.x-o.x,y:a.y-o.y},h={x:l.x-a.x,y:l.y-a.y},u=Math.hypot(c.x,c.y),f=Math.hypot(h.x,h.y);let d;typeof n=="number"?d=n:d=r<n.length?n[r]:0,d=s*Math.cos(Math.PI/e)*Math.min(1,d/s*2);const g={x:c.x/u,y:c.y/u},m={x:h.x/f,y:h.y/f},O={x:a.x-g.x*d,y:a.y-g.y*d},b={x:a.x+m.x*d,y:a.y+m.y*d};r===0?i.moveTo(O.x,O.y):i.lineTo(O.x,O.y),i.arcTo(a.x,a.y,b.x,b.y,d)}}};function D7(i){const t=[],e=i.length,s=D;for(let n=0;n<e;n++){let r=i[n];s._isNumber(r)?r=Math.round(r*1e3)/1e3:s._isString(r)||(r=r+""),t.push(r)}return t}const Ey=",",L7="(",V7=")",B7="([",Z7="])",F7=";",W7="()",q7="=",Ry=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],X7=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],z7=100;let qh=null;function Qy(){if(qh!==null)return qh;try{const t=D.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(qh=!1,!1)}catch{return qh=!1,!1}}class Hd{constructor(t){this.canvas=t,rt.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let s=this.traceArr,n=s.length,r="",o,a,l,c;for(o=0;o<n;o++)a=s[o],l=a.method,l?(c=a.args,r+=l,t?r+=W7:D._isArray(c[0])?r+=B7+c.join(Ey)+Z7:(e&&(c=c.map(h=>typeof h=="number"?Math.floor(h):h)),r+=L7+c.join(Ey)+V7)):(r+=a.property,t||(r+=q7+a.val)),r+=F7;return r}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr,s;e.push(t),s=e.length,s>=z7&&e.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){const e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}_applyMiterLimit(t){const e=t.attrs.miterLimit;e!=null&&this.setAttr("miterLimit",e)}setAttr(t,e){this._context[t]=e}arc(t,e,s,n,r,o){this._context.arc(t,e,s,n,r,o)}arcTo(t,e,s,n,r){this._context.arcTo(t,e,s,n,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,s,n,r,o){this._context.bezierCurveTo(t,e,s,n,r,o)}clearRect(t,e,s,n){this._context.clearRect(t,e,s,n)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){const s=arguments;if(s.length===2)return this._context.createImageData(t,e);if(s.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,s,n){return this._context.createLinearGradient(t,e,s,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,s,n,r,o){return this._context.createRadialGradient(t,e,s,n,r,o)}drawImage(t,e,s,n,r,o,a,l,c){const h=arguments,u=this._context;h.length===3?u.drawImage(t,e,s):h.length===5?u.drawImage(t,e,s,n,r):h.length===9&&u.drawImage(t,e,s,n,r,o,a,l,c)}ellipse(t,e,s,n,r,o,a,l){this._context.ellipse(t,e,s,n,r,o,a,l)}isPointInPath(t,e,s,n){return s?this._context.isPointInPath(s,t,e,n):this._context.isPointInPath(t,e,n)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,s,n){this._context.fillRect(t,e,s,n)}strokeRect(t,e,s,n){this._context.strokeRect(t,e,s,n)}fillText(t,e,s,n){n?this._context.fillText(t,e,s,n):this._context.fillText(t,e,s)}measureText(t){return this._context.measureText(t)}getImageData(t,e,s,n){return this._context.getImageData(t,e,s,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,s,n){this._context.rect(t,e,s,n)}roundRect(t,e,s,n,r){this._context.roundRect(t,e,s,n,r)}putImageData(t,e,s){this._context.putImageData(t,e,s)}quadraticCurveTo(t,e,s,n){this._context.quadraticCurveTo(t,e,s,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,s,n,r,o){this._context.setTransform(t,e,s,n,r,o)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,s,n){this._context.strokeText(t,e,s,n)}transform(t,e,s,n,r,o){this._context.transform(t,e,s,n,r,o)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=Ry.length,s=this.setAttr,n,r;const o=function(a){let l=t[a],c;t[a]=function(){return r=D7(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:a,args:r}),c}};for(n=0;n<e;n++)o(Ry[n]);t.setAttr=function(){s.apply(t,arguments);const a=arguments[0];let l=arguments[1];(a==="shadowOffsetX"||a==="shadowOffsetY"||a==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:a,val:l})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||e==="source-over"||this.setAttr("globalCompositeOperation",e)}}X7.forEach(function(i){Object.defineProperty(Hd.prototype,i,{get(){return this._context[i]},set(t){this._context[i]=t}})});class j7 extends Hd{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){const e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),s=t.getFillPriority();if(e&&s==="color"){this._fillColor(t);return}const n=t.getFillPatternImage();if(n&&s==="pattern"){this._fillPattern(t);return}const r=t.getFillLinearGradientColorStops();if(r&&s==="linear-gradient"){this._fillLinearGradient(t);return}const o=t.getFillRadialGradientColorStops();if(o&&s==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):n?this._fillPattern(t):r?this._fillLinearGradient(t):o&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),s=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,s.x,s.y);if(n){for(let o=0;o<n.length;o+=2)r.addColorStop(n[o],n[o+1]);this.setAttr("strokeStyle",r)}}_stroke(t){const e=t.dash(),s=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!s){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),s||this.restore()}}_applyShadow(t){var e,s,n;const r=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",o=(s=t.getShadowBlur())!==null&&s!==void 0?s:5,a=(n=t.getShadowOffset())!==null&&n!==void 0?n:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),h=l.x*c,u=l.y*c;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",o*Math.min(Math.abs(h),Math.abs(u))),this.setAttr("shadowOffsetX",a.x*h),this.setAttr("shadowOffsetY",a.y*u)}}class G7 extends Hd{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const e=t.getStrokeScaleEnabled();if(!e){this.save();const r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t);const s=t.hitStrokeWidth(),n=s==="auto"?t.strokeWidth():s;this.setAttr("lineWidth",n),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}let Xh;function Y7(){if(Xh)return Xh;const i=D.createCanvasElement(),t=i.getContext("2d");return Xh=(function(){const e=rt._global.devicePixelRatio||1,s=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/s})(),D.releaseCanvas(i),Xh}class CO{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const s=(t||{}).pixelRatio||rt.pixelRatio||Y7();this.pixelRatio=s,this._canvas=D.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(n){return D.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class Tr extends CO{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new j7(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}function Iy(){const i=D.createCanvasElement();i.width=1,i.height=1;const t=i.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,1,1),t.fillStyle="rgba(255,0,255,1)",t.fillRect(0,0,1,1);const e=t.getImageData(0,0,1,1).data;return!(e[0]===255&&e[1]===0&&e[2]===255&&e[3]===255)}function $y(){var i,t;return typeof navigator>"u"?!1:(t=(i=navigator.brave)===null||i===void 0?void 0:i.isBrave())!==null&&t!==void 0?t:!1}let Ny=!1;function U7(){return $y()&&Iy()&&!Ny&&(Ny=!0,D.error('Looks like you have "Brave shield" enabled in your browser. It breaks KonvaJS internals. Please disable it. You may need to ask your users to do the same.')),$y()&&Iy()}class TO extends CO{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new G7(this),this.setSize(t.width,t.height),U7()}}const Yt={get isDragging(){let i=!1;return Yt._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(i=!0)}),i},justDragged:!1,get node(){let i;return Yt._dragElements.forEach(t=>{i=t.node}),i},_dragElements:new Map,_drag(i){const t=[];Yt._dragElements.forEach((e,s)=>{const{node:n}=e,r=n.getStage();r.setPointersPositions(i),e.pointerId===void 0&&(e.pointerId=D._getFirstPointerId(i));const o=r._changedPointerPositions.find(a=>a.id===e.pointerId);if(o){if(e.dragStatus!=="dragging"){const a=n.dragDistance();if(Math.max(Math.abs(o.x-e.startPointerPos.x),Math.abs(o.y-e.startPointerPos.y))<a||(n.startDrag({evt:i}),!n.isDragging()))return}n._setDragPosition(i,e),t.push(n)}}),t.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:i},!0)})},_endDragBefore(i){const t=[];Yt._dragElements.forEach(e=>{const{node:s}=e,n=s.getStage();if(i&&n.setPointersPositions(i),!n._changedPointerPositions.find(a=>a.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(Yt.justDragged=!0,rt._mouseListenClick=!1,rt._touchListenClick=!1,rt._pointerListenClick=!1,e.dragStatus="stopped");const o=e.node.getLayer()||e.node instanceof rt.Stage&&e.node;o&&t.indexOf(o)===-1&&t.push(o)}),t.forEach(e=>{e.draw()})},_endDragAfter(i){Yt._dragElements.forEach((t,e)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:i},!0),t.dragStatus!=="dragging"&&Yt._dragElements.delete(e)})}};rt.isBrowser&&(window.addEventListener("mouseup",Yt._endDragBefore,!0),window.addEventListener("touchend",Yt._endDragBefore,!0),window.addEventListener("touchcancel",Yt._endDragBefore,!0),window.addEventListener("mousemove",Yt._drag),window.addEventListener("touchmove",Yt._drag),window.addEventListener("mouseup",Yt._endDragAfter,!1),window.addEventListener("touchend",Yt._endDragAfter,!1),window.addEventListener("touchcancel",Yt._endDragAfter,!1));function to(i){return D._isString(i)?'"'+i+'"':Object.prototype.toString.call(i)==="[object Number]"||D._isBoolean(i)?i:Object.prototype.toString.call(i)}function eS(i){return i>255?255:i<0?0:Math.round(i)}function it(){if(rt.isUnminified)return function(i,t){return D._isNumber(i)||D.warn(to(i)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),i}}function Kd(i){if(rt.isUnminified)return function(t,e){let s=D._isNumber(t),n=D._isArray(t)&&t.length==i;return!s&&!n&&D.warn(to(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+i+")"),t}}function PO(){if(rt.isUnminified)return function(i,t){return D._isNumber(i)||i==="auto"||D.warn(to(i)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),i}}function Wo(){if(rt.isUnminified)return function(i,t){return D._isString(i)||D.warn(to(i)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),i}}function iS(){if(rt.isUnminified)return function(i,t){const e=D._isString(i),s=Object.prototype.toString.call(i)==="[object CanvasGradient]"||i&&i.addColorStop;return e||s||D.warn(to(i)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),i}}function H7(){if(rt.isUnminified)return function(i,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&i instanceof e||(D._isArray(i)?i.forEach(function(s){D._isNumber(s)||D.warn('"'+t+'" attribute has non numeric element '+s+". Make sure that all elements are numbers.")}):D.warn(to(i)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),i}}function Gs(){if(rt.isUnminified)return function(i,t){return i===!0||i===!1||D.warn(to(i)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),i}}function K7(i){if(rt.isUnminified)return function(t,e){return t==null||D.isObject(t)||D.warn(to(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+i),t}}const yl="get",bl="set",T={addGetterSetter(i,t,e,s,n){T.addGetter(i,t,e),T.addSetter(i,t,s,n),T.addOverloadedGetterSetter(i,t)},addGetter(i,t,e){const s=yl+D._capitalize(t);i.prototype[s]=i.prototype[s]||function(){const n=this.attrs[t];return n===void 0?e:n}},addSetter(i,t,e,s){const n=bl+D._capitalize(t);i.prototype[n]||T.overWriteSetter(i,t,e,s)},overWriteSetter(i,t,e,s){const n=bl+D._capitalize(t);i.prototype[n]=function(r){return e&&r!==void 0&&r!==null&&(r=e.call(this,r,t)),this._setAttr(t,r),s&&s.call(this),this}},addComponentsGetterSetter(i,t,e,s,n){const r=e.length,o=D._capitalize,a=yl+o(t),l=bl+o(t);i.prototype[a]=function(){const h={};for(let u=0;u<r;u++){const f=e[u];h[f]=this.getAttr(t+o(f))}return h};const c=K7(e);i.prototype[l]=function(h){const u=this.attrs[t];s&&(h=s.call(this,h,t)),c&&c.call(this,h,t);for(const f in h)h.hasOwnProperty(f)&&this._setAttr(t+o(f),h[f]);return h||e.forEach(f=>{this._setAttr(t+o(f),void 0)}),this._fireChangeEvent(t,u,h),n&&n.call(this),this},T.addOverloadedGetterSetter(i,t)},addOverloadedGetterSetter(i,t){const e=D._capitalize(t),s=bl+e,n=yl+e;i.prototype[t]=function(){return arguments.length?(this[s](arguments[0]),this):this[n]()}},addDeprecatedGetterSetter(i,t,e,s){D.error("Adding deprecated "+t);const n=yl+D._capitalize(t),r=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";i.prototype[n]=function(){D.error(r);const o=this.attrs[t];return o===void 0?e:o},T.addSetter(i,t,s,function(){D.error(r)}),T.addOverloadedGetterSetter(i,t)},backCompat(i,t){D.each(t,function(e,s){const n=i.prototype[s],r=yl+D._capitalize(e),o=bl+D._capitalize(e);function a(){n.apply(this,arguments),D.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+s+'" instead.')}i.prototype[e]=a,i.prototype[r]=a,i.prototype[o]=a})},afterSetFilter(){this._filterUpToDate=!1}};function J7(i){const t=/(\w+)\(([^)]+)\)/g;let e;for(;(e=t.exec(i))!==null;){const[,s,n]=e;switch(s){case"blur":{const r=parseFloat(n.replace("px",""));return function(o){this.blurRadius(r*.5);const a=rt.Filters;a&&a.Blur&&a.Blur.call(this,o)}}case"brightness":{const r=n.includes("%")?parseFloat(n)/100:parseFloat(n);return function(o){this.brightness(r);const a=rt.Filters;a&&a.Brightness&&a.Brightness.call(this,o)}}case"contrast":{const r=parseFloat(n);return function(o){const a=100*(Math.sqrt(r)-1);this.contrast(a);const l=rt.Filters;l&&l.Contrast&&l.Contrast.call(this,o)}}case"grayscale":return function(r){const o=rt.Filters;o&&o.Grayscale&&o.Grayscale.call(this,r)};case"sepia":return function(r){const o=rt.Filters;o&&o.Sepia&&o.Sepia.call(this,r)};case"invert":return function(r){const o=rt.Filters;o&&o.Invert&&o.Invert.call(this,r)};default:D.warn(`CSS filter "${s}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const ju="absoluteOpacity",zh="allEventListeners",Nn="absoluteTransform",Dy="absoluteScale",co="canvas",tM="Change",eM="children",iM="konva",Kg="listening",sM="mouseenter",nM="mouseleave",rM="pointerenter",oM="pointerleave",aM="touchenter",lM="touchleave",Ly="set",Vy="Shape",Gu=" ",By="stage",yr="transform",cM="Stage",Jg="visible",hM=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Gu);let uM=1,st=class tm{constructor(t){this._id=uM++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===yr||t===Nn)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let s=this._cache.get(t);return(s===void 0||(t===yr||t===Nn)&&s.dirty===!0)&&(s=e.call(this),this._cache.set(t,s)),s}_calculate(t,e,s){if(!this._attachedDepsListeners.get(t)){const n=e.map(r=>r+"Change.konva").join(Gu);this.on(n,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,s)}_getCanvasCache(){return this._cache.get(co)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Nn&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(co)){const{scene:t,filter:e,hit:s,buffer:n}=this._cache.get(co);D.releaseCanvas(t,e,s,n),this._cache.delete(co)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const e=t||{};let s={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(s=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let n=Math.ceil(e.width||s.width),r=Math.ceil(e.height||s.height),o=e.pixelRatio,a=e.x===void 0?Math.floor(s.x):e.x,l=e.y===void 0?Math.floor(s.y):e.y,c=e.offset||0,h=e.drawBorder||!1,u=e.hitCanvasPixelRatio||1;if(!n||!r){D.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const f=Math.abs(Math.round(s.x)-a)>.5?1:0,d=Math.abs(Math.round(s.y)-l)>.5?1:0;n+=c*2+f,r+=c*2+d,a-=c,l-=c;const p=new Tr({pixelRatio:o,width:n,height:r}),g=new Tr({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),m=new TO({pixelRatio:u,width:n,height:r}),O=p.getContext(),b=m.getContext(),x=new Tr({width:p.width/p.pixelRatio+Math.abs(a),height:p.height/p.pixelRatio+Math.abs(l),pixelRatio:p.pixelRatio}),v=x.getContext();return m.isCache=!0,p.isCache=!0,this._cache.delete(co),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(p.getContext()._context.imageSmoothingEnabled=!1,g.getContext()._context.imageSmoothingEnabled=!1),O.save(),b.save(),v.save(),O.translate(-a,-l),b.translate(-a,-l),v.translate(-a,-l),x.x=a,x.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(ju),this._clearSelfAndDescendantCache(Dy),this.drawScene(p,this,x),this.drawHit(m,this),this._isUnderCache=!1,O.restore(),b.restore(),h&&(O.save(),O.beginPath(),O.rect(0,0,n,r),O.closePath(),O.setAttr("strokeStyle","red"),O.setAttr("lineWidth",5),O.stroke(),O.restore()),this._cache.set(co,{scene:p,filter:g,hit:m,buffer:x,x:a,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(co)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){const s=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let n=1/0,r=1/0,o=-1/0,a=-1/0;const l=this.getAbsoluteTransform(e);return s.forEach(function(c){const h=l.point(c);n===void 0&&(n=o=h.x,r=a=h.y),n=Math.min(n,h.x),r=Math.min(r,h.y),o=Math.max(o,h.x),a=Math.max(a,h.y)}),{x:n,y:r,width:o-n,height:a-r}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);const s=this._getCachedSceneCanvas(),n=s.pixelRatio;t.drawImage(s._canvas,0,0,s.width/n,s.height/n),t.restore()}_drawCachedHitCanvas(t){const e=this._getCanvasCache(),s=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(s._canvas,0,0,s.width/s.pixelRatio,s.height/s.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),s=e.scene,n=e.filter,r=n.getContext(),o,a,l,c;if(!t||t.length===0)return s;if(this._filterUpToDate)return n;let h=!0;for(let f=0;f<t.length;f++)if(typeof t[f]=="string"&&Qy(),typeof t[f]!="string"||!Qy()){h=!1;break}const u=s.pixelRatio;if(n.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio),h){const f=t.join(" ");return r.save(),r.setAttr("filter",f),r.drawImage(s._canvas,0,0,s.getWidth()/u,s.getHeight()/u),r.restore(),this._filterUpToDate=!0,n}try{for(o=t.length,r.clear(),r.drawImage(s._canvas,0,0,s.getWidth()/u,s.getHeight()/u),a=r.getImageData(0,0,n.getWidth(),n.getHeight()),l=0;l<o;l++)c=t[l],typeof c=="string"&&(c=J7(c)),c.call(this,a),r.putImageData(a,0,0)}catch(f){D.error("Unable to apply filter. "+f.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,n}on(t,e){if(this._cache&&this._cache.delete(zh),arguments.length===3)return this._delegate.apply(this,arguments);const s=t.split(Gu);for(let n=0;n<s.length;n++){const o=s[n].split("."),a=o[0],l=o[1]||"";this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:l,handler:e})}return this}off(t,e){let s=(t||"").split(Gu),n=s.length,r,o,a,l,c,h;if(this._cache&&this._cache.delete(zh),!t)for(o in this.eventListeners)this._off(o);for(r=0;r<n;r++)if(a=s[r],l=a.split("."),c=l[0],h=l[1],c)this.eventListeners[c]&&this._off(c,h,e);else for(o in this.eventListeners)this._off(o,h,e);return this}dispatchEvent(t){const e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(s){e.call(this,s.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,s){const n=this;this.on(t,function(r){const o=r.target.findAncestors(e,!0,n);for(let a=0;a<o.length;a++)r=D.cloneObject(r),r.currentTarget=o[a],s.call(o[a],r)})}remove(){return this.isDragging()&&this.stopDrag(),Yt._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Nn),this._clearSelfAndDescendantCache(ju),this._clearSelfAndDescendantCache(Dy),this._clearSelfAndDescendantCache(By),this._clearSelfAndDescendantCache(Jg),this._clearSelfAndDescendantCache(Kg)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const e="get"+D._capitalize(t);return D._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,s;if(!t)return this;for(e in t)e!==eM&&(s=Ly+D._capitalize(e),D._isFunction(this[s])?this[s](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(Kg,this._isListening)}_isListening(t){if(!this.listening())return!1;const s=this.getParent();return s&&s!==t&&this!==t?s._isListening(t):!0}isVisible(){return this._getCache(Jg,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const s=this.getParent();return s&&s!==t&&this!==t?s._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);const s=this.getLayer();let n=!1;Yt._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===s)&&(n=!0)});const r=!e&&!rt.hitOnDragEnabled&&(n||rt.isTransforming());return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,s=0,n,r,o,a;function l(h){for(n=[],r=h.length,o=0;o<r;o++)a=h[o],s++,a.nodeType!==Vy&&(n=n.concat(a.getChildren().slice())),a._id===e._id&&(o=r);n.length>0&&n[0].getDepth()<=t&&l(n)}const c=this.getStage();return e.nodeType!==cM&&c&&l(c.getChildren()),s}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(yr),this._clearSelfAndDescendantCache(Nn)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const e=t.getPointerPosition();if(!e)return null;const s=this.getAbsoluteTransform().copy();return s.invert(),s.point(e)}getAbsolutePosition(t){let e=!1,s=this.parent;for(;s;){if(s.isCached()){e=!0;break}s=s.parent}e&&!t&&(t=!0);const n=this.getAbsoluteTransform(t).getMatrix(),r=new rs,o=this.offset();return r.m=n.slice(),r.translate(o.x,o.y),r.getTranslation()}setAbsolutePosition(t){const{x:e,y:s,...n}=this._clearTransform();this.attrs.x=e,this.attrs.y=s,this._clearCache(yr);const r=this._getAbsoluteTransform().copy();return r.invert(),r.translate(t.x,t.y),t={x:this.attrs.x+r.getTranslation().x,y:this.attrs.y+r.getTranslation().y},this._setTransform(n),this.setPosition({x:t.x,y:t.y}),this._clearCache(yr),this._clearSelfAndDescendantCache(Nn),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,s=t.y,n=this.x(),r=this.y();return e!==void 0&&(n+=e),s!==void 0&&(r+=s),this.setPosition({x:n,y:r}),this}_eachAncestorReverse(t,e){let s=[],n=this.getParent(),r,o;if(!(e&&e._id===this._id)){for(s.unshift(this);n&&(!e||n._id!==e._id);)s.unshift(n),n=n.parent;for(r=s.length,o=0;o<r;o++)t(s[o])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return D.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return D.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return D.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return D.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return D.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&D.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(ju,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,s,n,r,o;const a={attrs:{},className:this.getClassName()};for(e in t)s=t[e],o=D.isObject(s)&&!D._isPlainObject(s)&&!D._isArray(s),!o&&(n=typeof this[e]=="function"&&this[e],delete t[e],r=n?n.call(this):null,t[e]=s,r!==s&&(a.attrs[e]=s));return D._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,s){const n=[];e&&this._isMatch(t)&&n.push(this);let r=this.parent;for(;r;){if(r===s)return n;r._isMatch(t)&&n.push(r),r=r.parent}return n}isAncestorOf(t){return!1}findAncestor(t,e,s){return this.findAncestors(t,e,s)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let e=t.replace(/ /g,"").split(","),s=e.length,n,r;for(n=0;n<s;n++)if(r=e[n],D.isValidSelector(r)||(D.warn('Selector "'+r+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),D.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),D.warn("Konva is awesome, right?")),r.charAt(0)==="#"){if(this.id()===r.slice(1))return!0}else if(r.charAt(0)==="."){if(this.hasName(r.slice(1)))return!0}else if(this.className===r||this.nodeType===r)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(By,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,e={},s){return e.target=e.target||this,s?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Nn,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new rs,this._eachAncestorReverse(function(s){const n=s.transformsEnabled();n==="all"?e.multiply(s.getTransform()):n==="position"&&e.translate(s.x()-s.offsetX(),s.y()-s.offsetY())},t),e;{e=this._cache.get(Nn)||new rs,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();const s=this.transformsEnabled();if(s==="all")e.multiply(this.getTransform());else if(s==="position"){const n=this.attrs.x||0,r=this.attrs.y||0,o=this.attrs.offsetX||0,a=this.attrs.offsetY||0;e.translate(n-o,r-a)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();const n=this.getAbsoluteTransform(t).decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(yr,this._getTransform)}_getTransform(){var t,e;const s=this._cache.get(yr)||new rs;s.reset();const n=this.x(),r=this.y(),o=rt.getAngle(this.rotation()),a=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,h=this.attrs.skewY||0,u=this.attrs.offsetX||0,f=this.attrs.offsetY||0;return(n!==0||r!==0)&&s.translate(n,r),o!==0&&s.rotate(o),(c!==0||h!==0)&&s.skew(c,h),(a!==1||l!==1)&&s.scale(a,l),(u!==0||f!==0)&&s.translate(-1*u,-1*f),s.dirty=!1,s}clone(t){let e=D.cloneObject(this.attrs),s,n,r,o,a;for(s in t)e[s]=t[s];const l=new this.constructor(e);for(s in this.eventListeners)for(n=this.eventListeners[s],r=n.length,o=0;o<r;o++)a=n[o],a.name.indexOf(iM)<0&&(l.eventListeners[s]||(l.eventListeners[s]=[]),l.eventListeners[s].push(a));return l}_toKonvaCanvas(t){t=t||{};const e=this.getClientRect(),s=this.getStage(),n=t.x!==void 0?t.x:Math.floor(e.x),r=t.y!==void 0?t.y:Math.floor(e.y),o=t.pixelRatio||1,a=new Tr({width:t.width||Math.ceil(e.width)||(s?s.width():0),height:t.height||Math.ceil(e.height)||(s?s.height():0),pixelRatio:o}),l=a.getContext(),c=new Tr({width:a.width/a.pixelRatio+Math.abs(n),height:a.height/a.pixelRatio+Math.abs(r),pixelRatio:a.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(n||r)&&l.translate(-1*n,-1*r),this.drawScene(a,void 0,c),l.restore(),a}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const e=t.mimeType||null,s=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,s);return t.callback&&t.callback(n),n}toImage(t){return new Promise((e,s)=>{try{const n=t?.callback;n&&delete t.callback,D._urlToImage(this.toDataURL(t),function(r){e(r),n?.(r)})}catch(n){s(n)}})}toBlob(t){return new Promise((e,s)=>{try{const n=t?.callback;n&&delete t.callback,this.toCanvas(t).toBlob(r=>{e(r),n?.(r)},t?.mimeType,t?.quality)}catch(n){s(n)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():rt.dragDistance}_off(t,e,s){let n=this.eventListeners[t],r,o,a;for(r=0;r<n.length;r++)if(o=n[r].name,a=n[r].handler,(o!=="konva"||e==="konva")&&(!e||o===e)&&(!s||s===a)){if(n.splice(r,1),n.length===0){delete this.eventListeners[t];break}r--}}_fireChangeEvent(t,e,s){this._fire(t+tM,{oldVal:e,newVal:s})}addName(t){if(!this.hasName(t)){const e=this.name(),s=e?e+" "+t:t;this.name(s)}return this}hasName(t){if(!t)return!1;const e=this.name();return e?(e||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const e=(this.name()||"").split(/\s/g),s=e.indexOf(t);return s!==-1&&(e.splice(s,1),this.name(e.join(" "))),this}setAttr(t,e){const s=this[Ly+D._capitalize(t)];return D._isFunction(s)?s.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(rt.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){const s=this.attrs[t];s===e&&!D.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,s,e),this._requestDraw())}_setComponentAttr(t,e,s){let n;s!==void 0&&(n=this.attrs[t],n||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=s,this._fireChangeEvent(t,n,s))}_fireAndBubble(t,e,s){e&&this.nodeType===Vy&&(e.target=this);const n=[sM,nM,rM,oM,aM,lM];if(!(n.indexOf(t)!==-1&&(s&&(this===s||this.isAncestorOf&&this.isAncestorOf(s))||this.nodeType==="Stage"&&!s))){this._fire(t,e);const o=n.indexOf(t)!==-1&&s&&s.isAncestorOf&&s.isAncestorOf(this)&&!s.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!o&&(s&&s.parent?this._fireAndBubble.call(this.parent,t,e,s):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,s,n;const r=(e=this._cache.get(zh))!==null&&e!==void 0?e:{};let o=r?.[t];if(o===void 0){o=[];let a=Object.getPrototypeOf(this);for(;a;){const l=(n=(s=a.eventListeners)===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:[];o.push(...l),a=Object.getPrototypeOf(a)}r[t]=o,this._cache.set(zh,r)}return o}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const s=this._getProtoListeners(t);if(s)for(let r=0;r<s.length;r++)s[r].handler.call(this,e);const n=this.eventListeners[t];if(n)for(let r=0;r<n.length;r++)n[r].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const e=t?t.pointerId:void 0,s=this.getStage(),n=this.getAbsolutePosition();if(!s)return;const r=s._getPointerById(e)||s._changedPointerPositions[0]||n;Yt._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-n.x,y:r.y-n.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){Yt._dragElements.has(this._id)||this._createDragElement(t);const s=Yt._dragElements.get(this._id);s.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const s=this.getStage()._getPointerById(e.pointerId);if(!s)return;let n={x:s.x-e.offset.x,y:s.y-e.offset.y};const r=this.dragBoundFunc();if(r!==void 0){const o=r.call(this,n,t);o?n=o:D.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==n.x||this._lastPos.y!==n.y)&&(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}stopDrag(t){const e=Yt._dragElements.get(this._id);e&&(e.dragStatus="stopped"),Yt._endDragBefore(t),Yt._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=Yt._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||rt.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let n=!1;Yt._dragElements.forEach(r=>{this.isAncestorOf(r.node)&&(n=!0)}),n||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const e=Yt._dragElements.get(this._id),s=e&&e.dragStatus==="dragging",n=e&&e.dragStatus==="ready";s?this.stopDrag():n&&Yt._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const s={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return D.haveIntersection(s,this.getClientRect())}static create(t,e){return D._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let s=tm.prototype.getClassName.call(t),n=t.children,r,o,a;e&&(t.attrs.container=e),rt[s]||(D.warn('Can not find a node with class name "'+s+'". Fallback to "Shape".'),s="Shape");const l=rt[s];if(r=new l(t.attrs),n)for(o=n.length,a=0;a<o;a++)r.add(tm._createNode(n[a]));return r}};st.prototype.nodeType="Node";st.prototype._attrsAffectingSize=[];st.prototype.eventListeners={};st.prototype.on.call(st.prototype,hM,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(yr),this._clearSelfAndDescendantCache(Nn)});st.prototype.on.call(st.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(Jg)});st.prototype.on.call(st.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(Kg)});st.prototype.on.call(st.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(ju)});const le=T.addGetterSetter;le(st,"zIndex");le(st,"absolutePosition");le(st,"position");le(st,"x",0,it());le(st,"y",0,it());le(st,"globalCompositeOperation","source-over",Wo());le(st,"opacity",1,it());le(st,"name","",Wo());le(st,"id","",Wo());le(st,"rotation",0,it());T.addComponentsGetterSetter(st,"scale",["x","y"]);le(st,"scaleX",1,it());le(st,"scaleY",1,it());T.addComponentsGetterSetter(st,"skew",["x","y"]);le(st,"skewX",0,it());le(st,"skewY",0,it());T.addComponentsGetterSetter(st,"offset",["x","y"]);le(st,"offsetX",0,it());le(st,"offsetY",0,it());le(st,"dragDistance",void 0,it());le(st,"width",0,it());le(st,"height",0,it());le(st,"listening",!0,Gs());le(st,"preventDefault",!0,Gs());le(st,"filters",void 0,function(i){return this._filterUpToDate=!1,i});le(st,"visible",!0,Gs());le(st,"transformsEnabled","all",Wo());le(st,"size");le(st,"dragBoundFunc");le(st,"draggable",!1,Gs());T.backCompat(st,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class cs extends st{constructor(){super(...arguments),this.children=[]}getChildren(t){const e=this.children||[];return t?e.filter(t):e}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let s=0;s<t.length;s++)this.add(t[s]);return this}const e=t[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){const s=[];return this._descendants(n=>{const r=n._isMatch(t);return r&&s.push(n),!!(r&&e)}),s}_descendants(t){let e=!1;const s=this.getChildren();for(const n of s){if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1}toObject(){const t=st.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){const e=st.prototype.clone.call(this,t);return this.getChildren().forEach(function(s){e.add(s.clone())}),e}getAllIntersections(t){const e=[];return this.find("Shape").forEach(s=>{s.isVisible()&&s.intersects(t)&&e.push(s)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(s){s._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,s){e.index=s}),this._requestDraw()}drawScene(t,e,s){const n=this.getLayer(),r=t||n&&n.getCanvas(),o=r&&r.getContext(),a=this._getCanvasCache(),l=a&&a.scene,c=r&&r.isCache;if(!this.isVisible()&&!c)return this;if(l){o.save();const h=this.getAbsoluteTransform(e).getMatrix();o.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",r,e,s);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;const s=this.getLayer(),n=t||s&&s.hitCanvas,r=n&&n.getContext(),o=this._getCanvasCache();if(o&&o.hit){r.save();const l=this.getAbsoluteTransform(e).getMatrix();r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,s,n){var r;const o=e&&e.getContext(),a=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),h=typeof a=="number"&&typeof l=="number"||c,u=s===this;if(h){o.save();const d=this.getAbsoluteTransform(s);let p=d.getMatrix();o.transform(p[0],p[1],p[2],p[3],p[4],p[5]),o.beginPath();let g;if(c)g=c.call(this,o,this);else{const m=this.clipX(),O=this.clipY();o.rect(m||0,O||0,a,l)}o.clip.apply(o,g),p=d.copy().invert().getMatrix(),o.transform(p[0],p[1],p[2],p[3],p[4],p[5])}const f=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";f&&(o.save(),o._applyGlobalCompositeOperation(this)),(r=this.children)===null||r===void 0||r.forEach(function(d){d[t](e,s,n)}),f&&o.restore(),h&&o.restore()}getClientRect(t={}){var e;const s=t.skipTransform,n=t.relativeTo;let r,o,a,l,c={x:1/0,y:1/0,width:0,height:0};const h=this;(e=this.children)===null||e===void 0||e.forEach(function(d){if(!d.visible())return;const p=d.getClientRect({relativeTo:h,skipShadow:t.skipShadow,skipStroke:t.skipStroke});p.width===0&&p.height===0||(r===void 0?(r=p.x,o=p.y,a=p.x+p.width,l=p.y+p.height):(r=Math.min(r,p.x),o=Math.min(o,p.y),a=Math.max(a,p.x+p.width),l=Math.max(l,p.y+p.height)))});const u=this.find("Shape");let f=!1;for(let d=0;d<u.length;d++)if(u[d]._isVisible(this)){f=!0;break}return f&&r!==void 0?c={x:r,y:o,width:a-r,height:l-o}:c={x:0,y:0,width:0,height:0},s?c:this._transformedRect(c,n)}}T.addComponentsGetterSetter(cs,"clip",["x","y","width","height"]);T.addGetterSetter(cs,"clipX",void 0,it());T.addGetterSetter(cs,"clipY",void 0,it());T.addGetterSetter(cs,"clipWidth",void 0,it());T.addGetterSetter(cs,"clipHeight",void 0,it());T.addGetterSetter(cs,"clipFunc");const Ec=new Map,sS=rt._global.PointerEvent!==void 0;function Qp(i){return Ec.get(i)}function AO(i){return{evt:i,pointerId:i.pointerId}}function nS(i,t){return Ec.get(i)===t}function rS(i,t){lc(i),t.getStage()&&(Ec.set(i,t),sS&&t._fire("gotpointercapture",AO(new PointerEvent("gotpointercapture"))))}function lc(i,t){const e=Ec.get(i);if(!e)return;const s=e.getStage();s&&s.content,Ec.delete(i),sS&&e._fire("lostpointercapture",AO(new PointerEvent("lostpointercapture")))}const fM="Stage",dM="string",Zy="px",pM="mouseout",oS="mouseleave",aS="mouseover",lS="mouseenter",cS="mousemove",hS="mousedown",uS="mouseup",Fl="pointermove",Wl="pointerdown",ga="pointerup",ql="pointercancel",gM="lostpointercapture",jh="pointerout",Xl="pointerleave",Gh="pointerover",Yh="pointerenter",em="contextmenu",fS="touchstart",dS="touchend",pS="touchmove",gS="touchcancel",im="wheel",mM=5,OM=[[lS,"_pointerenter"],[hS,"_pointerdown"],[cS,"_pointermove"],[uS,"_pointerup"],[oS,"_pointerleave"],[fS,"_pointerdown"],[pS,"_pointermove"],[dS,"_pointerup"],[gS,"_pointercancel"],[aS,"_pointerover"],[im,"_wheel"],[em,"_contextmenu"],[Wl,"_pointerdown"],[Fl,"_pointermove"],[ga,"_pointerup"],[ql,"_pointercancel"],[Xl,"_pointerleave"],[gM,"_lostpointercapture"]],Ip={mouse:{[jh]:pM,[Xl]:oS,[Gh]:aS,[Yh]:lS,[Fl]:cS,[Wl]:hS,[ga]:uS,[ql]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[jh]:"touchout",[Xl]:"touchleave",[Gh]:"touchover",[Yh]:"touchenter",[Fl]:pS,[Wl]:fS,[ga]:dS,[ql]:gS,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[jh]:jh,[Xl]:Xl,[Gh]:Gh,[Yh]:Yh,[Fl]:Fl,[Wl]:Wl,[ga]:ga,[ql]:ql,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},zl=i=>i.indexOf("pointer")>=0?"pointer":i.indexOf("touch")>=0?"touch":"mouse",Ho=i=>{const t=zl(i);if(t==="pointer")return rt.pointerEventsEnabled&&Ip.pointer;if(t==="touch")return Ip.touch;if(t==="mouse")return Ip.mouse};function Fy(i={}){return(i.clipFunc||i.clipWidth||i.clipHeight)&&D.warn("Stage does not support clipping. Please use clip for Layers or Groups."),i}const yM="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",cc=[];class Jd extends cs{constructor(t){super(Fy(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),cc.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{Fy(this.attrs)}),this._checkVisibility()}_validateAdd(t){const e=t.getType()==="Layer",s=t.getType()==="FastLayer";e||s||D.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===dM){let e;if(t.charAt(0)==="."){const s=t.slice(1);t=document.getElementsByClassName(s)[0]}else t.charAt(0)!=="#"?e=t:e=t.slice(1),t=document.getElementById(e);if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,e=t.length;for(let s=0;s<e;s++)t[s].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),cs.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&D._isInDocument(t)&&this.container().removeChild(t);const e=cc.indexOf(this);return e>-1&&cc.splice(e,1),D.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(D.warn(yM),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const e=new Tr({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),s=e.getContext()._context,n=this.children;return(t.x||t.y)&&s.translate(-1*t.x,-1*t.y),n.forEach(function(r){if(!r.isVisible())return;const o=r._toKonvaCanvas(t);s.drawImage(o._canvas,t.x,t.y,o.getWidth()/o.getPixelRatio(),o.getHeight()/o.getPixelRatio())}),e}getIntersection(t){if(!t)return null;const e=this.children,s=e.length,n=s-1;for(let r=n;r>=0;r--){const o=e[r].getIntersection(t);if(o)return o}return null}_resizeDOM(){const t=this.width(),e=this.height();this.content&&(this.content.style.width=t+Zy,this.content.style.height=e+Zy),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(s=>{s.setSize({width:t,height:e}),s.draw()})}add(t,...e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}super.add(t);const s=this.children.length;return s>mM&&D.warn("The stage has "+s+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),rt.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return nS(t,this)}setPointerCapture(t){rS(t,this)}releaseCapture(t){lc(t)}getLayers(){return this.children}_bindContentEvents(){rt.isBrowser&&OM.forEach(([t,e])=>{this.content.addEventListener(t,s=>{this[e](s)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const e=Ho(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=Ho(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=Ho(t.type),s=zl(t.type);if(!e)return;this.setPointersPositions(t);const n=this._getTargetShape(s),r=!(rt.isDragging()||rt.isTransforming())||rt.hitOnDragEnabled;n&&r?(n._fireAndBubble(e.pointerout,{evt:t}),n._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[s+"targetShape"]=null):r&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const e=Ho(t.type),s=zl(t.type);if(!e)return;this.setPointersPositions(t);let n=!1;this._changedPointerPositions.forEach(r=>{const o=this.getIntersection(r);if(Yt.justDragged=!1,rt["_"+s+"ListenClick"]=!0,!o||!o.isListening()){this[s+"ClickStartShape"]=void 0;return}rt.capturePointerEventsEnabled&&o.setPointerCapture(r.id),this[s+"ClickStartShape"]=o,o._fireAndBubble(e.pointerdown,{evt:t,pointerId:r.id}),n=!0;const a=t.type.indexOf("touch")>=0;o.preventDefault()&&t.cancelable&&a&&t.preventDefault()}),n||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const e=Ho(t.type),s=zl(t.type);if(!e)return;const n=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(rt.isDragging()&&Yt.node.preventDefault()&&t.cancelable&&n&&t.preventDefault(),this.setPointersPositions(t),!(!(rt.isDragging()||rt.isTransforming())||rt.hitOnDragEnabled))return;const o={};let a=!1;const l=this._getTargetShape(s);this._changedPointerPositions.forEach(c=>{const h=Qp(c.id)||this.getIntersection(c),u=c.id,f={evt:t,pointerId:u},d=l!==h;if(d&&l&&(l._fireAndBubble(e.pointerout,{...f},h),l._fireAndBubble(e.pointerleave,{...f},h)),h){if(o[h._id])return;o[h._id]=!0}h&&h.isListening()?(a=!0,d&&(h._fireAndBubble(e.pointerover,{...f},l),h._fireAndBubble(e.pointerenter,{...f},l),this[s+"targetShape"]=h),h._fireAndBubble(e.pointermove,{...f})):l&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:u}),this[s+"targetShape"]=null)}),a||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=Ho(t.type),s=zl(t.type);if(!e)return;this.setPointersPositions(t);const n=this[s+"ClickStartShape"],r=this[s+"ClickEndShape"],o={};let a=!1;this._changedPointerPositions.forEach(l=>{const c=Qp(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),o[c._id])return;o[c._id]=!0}const h=l.id,u={evt:t,pointerId:h};let f=!1;rt["_"+s+"InDblClickWindow"]?(f=!0,clearTimeout(this[s+"DblTimeout"])):Yt.justDragged||(rt["_"+s+"InDblClickWindow"]=!0,clearTimeout(this[s+"DblTimeout"])),this[s+"DblTimeout"]=setTimeout(function(){rt["_"+s+"InDblClickWindow"]=!1},rt.dblClickWindow),c&&c.isListening()?(a=!0,this[s+"ClickEndShape"]=c,c._fireAndBubble(e.pointerup,{...u}),rt["_"+s+"ListenClick"]&&n&&n===c&&(c._fireAndBubble(e.pointerclick,{...u}),f&&r&&r===c&&c._fireAndBubble(e.pointerdblclick,{...u}))):(this[s+"ClickEndShape"]=null,a||(this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a=!0),rt["_"+s+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:h}),f&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:h}))}),a||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),rt["_"+s+"ListenClick"]=!1,t.cancelable&&s!=="touch"&&s!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(em,{evt:t}):this._fire(em,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(im,{evt:t}):this._fire(im,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=Qp(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(ga,AO(t)),lc(t.pointerId)}_lostpointercapture(t){lc(t.pointerId)}setPointersPositions(t){const e=this._getContentPosition();let s=null,n=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,r=>{this._pointerPositions.push({id:r.identifier,x:(r.clientX-e.left)/e.scaleX,y:(r.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,r=>{this._changedPointerPositions.push({id:r.identifier,x:(r.clientX-e.left)/e.scaleX,y:(r.clientY-e.top)/e.scaleY})})):(s=(t.clientX-e.left)/e.scaleX,n=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:s,y:n},this._pointerPositions=[{x:s,y:n,id:D._getFirstPointerId(t)}],this._changedPointerPositions=[{x:s,y:n,id:D._getFirstPointerId(t)}])}_setPointerPosition(t){D.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Tr({width:this.width(),height:this.height()}),this.bufferHitCanvas=new TO({pixelRatio:1,width:this.width(),height:this.height()}),!rt.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return D.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}}Jd.prototype.nodeType=fM;ke(Jd);T.addGetterSetter(Jd,"container");rt.isBrowser&&document.addEventListener("visibilitychange",()=>{cc.forEach(i=>{i.batchDraw()})});const mS="hasShadow",OS="shadowRGBA",yS="patternImage",bS="linearGradient",vS="radialGradient";let Uh;function $p(){return Uh||(Uh=D.createCanvasElement().getContext("2d"),Uh)}const hc={};function bM(i){const t=this.attrs.fillRule;t?i.fill(t):i.fill()}function vM(i){i.stroke()}function _M(i){const t=this.attrs.fillRule;t?i.fill(t):i.fill()}function xM(i){i.stroke()}function SM(){this._clearCache(mS)}function wM(){this._clearCache(OS)}function kM(){this._clearCache(yS)}function CM(){this._clearCache(bS)}function TM(){this._clearCache(vS)}class J extends st{constructor(t){super(t);let e;for(;e=D.getRandomColor(),!(e&&!(e in hc)););this.colorKey=e,hc[e]=this}getContext(){return D.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return D.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(mS,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(yS,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=$p().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const s=new rs;s.translate(this.fillPatternX(),this.fillPatternY()),s.rotate(rt.getAngle(this.fillPatternRotation())),s.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),s.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const n=s.getMatrix(),r=typeof DOMMatrix>"u"?{a:n[0],b:n[1],c:n[2],d:n[3],e:n[4],f:n[5]}:new DOMMatrix(n);e.setTransform(r)}return e}}_getLinearGradient(){return this._getCache(bS,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const e=$p(),s=this.fillLinearGradientStartPoint(),n=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(s.x,s.y,n.x,n.y);for(let o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}}_getRadialGradient(){return this._getCache(vS,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const e=$p(),s=this.fillRadialGradientStartPoint(),n=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(s.x,s.y,this.fillRadialGradientStartRadius(),n.x,n.y,this.fillRadialGradientEndRadius());for(let o=0;o<t.length;o+=2)r.addColorStop(t[o],t[o+1]);return r}}getShadowRGBA(){return this._getCache(OS,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=D.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const e=this.getStage();if(!e)return!1;const s=e.bufferHitCanvas;return s.getContext().clear(),this.drawHit(s,void 0,!0),s.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return st.prototype.destroy.call(this),delete hc[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!((e=this.attrs.perfectDrawEnabled)!==null&&e!==void 0?e:!0))return!1;const n=t||this.hasFill(),r=this.hasStroke(),o=this.getAbsoluteOpacity()!==1;if(n&&r&&o)return!0;const a=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(n&&r&&a&&l)}setStrokeHitEnabled(t){D.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,s=this.getParent();for(;s;){if(s.isCached()){e=!0;break}s=s.getParent()}const n=t.skipTransform,r=t.relativeTo||e&&this.getStage()||void 0,o=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=o.width+l,h=o.height+l,u=!t.skipShadow&&this.hasShadow(),f=u?this.shadowOffsetX():0,d=u?this.shadowOffsetY():0,p=c+Math.abs(f),g=h+Math.abs(d),m=u&&this.shadowBlur()||0,O=p+m*2,b=g+m*2,x={width:O,height:b,x:-(l/2+m)+Math.min(f,0)+o.x,y:-(l/2+m)+Math.min(d,0)+o.y};return n?x:this._transformedRect(x,r)}drawScene(t,e,s){const n=this.getLayer(),r=t||n.getCanvas(),o=r.getContext(),a=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow();let h;const u=e===this;if(!this.isVisible()&&!u)return this;if(a){o.save();const f=this.getAbsoluteTransform(e).getMatrix();return o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(o),o.restore(),this}if(!l)return this;if(o.save(),this._useBufferCanvas()){h=this.getStage();const f=s||h.bufferCanvas,d=f.getContext();d.clear(),d.save(),d._applyLineJoin(this),d._applyMiterLimit(this);const p=this.getAbsoluteTransform(e).getMatrix();d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.call(this,d,this),d.restore();const g=f.pixelRatio;c&&o._applyShadow(this),o._applyOpacity(this),o._applyGlobalCompositeOperation(this),o.drawImage(f._canvas,f.x||0,f.y||0,f.width/g,f.height/g)}else{if(o._applyLineJoin(this),o._applyMiterLimit(this),!u){const f=this.getAbsoluteTransform(e).getMatrix();o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),o._applyOpacity(this),o._applyGlobalCompositeOperation(this)}c&&o._applyShadow(this),l.call(this,o,this)}return o.restore(),this}drawHit(t,e,s=!1){if(!this.shouldDrawHit(e,s))return this;const n=this.getLayer(),r=t||n.hitCanvas,o=r&&r.getContext(),a=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||D.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){o.save();const u=this.getAbsoluteTransform(e).getMatrix();return o.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!a)return this;if(o.save(),o._applyLineJoin(this),o._applyMiterLimit(this),!(this===e)){const u=this.getAbsoluteTransform(e).getMatrix();o.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return a.call(this,o,this),o.restore(),this}drawHitFromCache(t=0){const e=this._getCanvasCache(),s=this._getCachedSceneCanvas(),n=e.hit,r=n.getContext(),o=n.getWidth(),a=n.getHeight();r.clear(),r.drawImage(s._canvas,0,0,o,a);try{const l=r.getImageData(0,0,o,a),c=l.data,h=c.length,u=D._hexToRgb(this.colorKey);for(let f=0;f<h;f+=4)c[f+3]>t?(c[f]=u.r,c[f+1]=u.g,c[f+2]=u.b,c[f+3]=255):c[f+3]=0;r.putImageData(l,0,0)}catch(l){D.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return nS(t,this)}setPointerCapture(t){rS(t,this)}releaseCapture(t){lc(t)}}J.prototype._fillFunc=bM;J.prototype._strokeFunc=vM;J.prototype._fillFuncHit=_M;J.prototype._strokeFuncHit=xM;J.prototype._centroid=!1;J.prototype.nodeType="Shape";ke(J);J.prototype.eventListeners={};J.prototype.on.call(J.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",SM);J.prototype.on.call(J.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",wM);J.prototype.on.call(J.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",kM);J.prototype.on.call(J.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",CM);J.prototype.on.call(J.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",TM);T.addGetterSetter(J,"stroke",void 0,iS());T.addGetterSetter(J,"strokeWidth",2,it());T.addGetterSetter(J,"fillAfterStrokeEnabled",!1);T.addGetterSetter(J,"hitStrokeWidth","auto",PO());T.addGetterSetter(J,"strokeHitEnabled",!0,Gs());T.addGetterSetter(J,"perfectDrawEnabled",!0,Gs());T.addGetterSetter(J,"shadowForStrokeEnabled",!0,Gs());T.addGetterSetter(J,"lineJoin");T.addGetterSetter(J,"lineCap");T.addGetterSetter(J,"miterLimit");T.addGetterSetter(J,"sceneFunc");T.addGetterSetter(J,"hitFunc");T.addGetterSetter(J,"dash");T.addGetterSetter(J,"dashOffset",0,it());T.addGetterSetter(J,"shadowColor",void 0,Wo());T.addGetterSetter(J,"shadowBlur",0,it());T.addGetterSetter(J,"shadowOpacity",1,it());T.addComponentsGetterSetter(J,"shadowOffset",["x","y"]);T.addGetterSetter(J,"shadowOffsetX",0,it());T.addGetterSetter(J,"shadowOffsetY",0,it());T.addGetterSetter(J,"fillPatternImage");T.addGetterSetter(J,"fill",void 0,iS());T.addGetterSetter(J,"fillPatternX",0,it());T.addGetterSetter(J,"fillPatternY",0,it());T.addGetterSetter(J,"fillLinearGradientColorStops");T.addGetterSetter(J,"strokeLinearGradientColorStops");T.addGetterSetter(J,"fillRadialGradientStartRadius",0);T.addGetterSetter(J,"fillRadialGradientEndRadius",0);T.addGetterSetter(J,"fillRadialGradientColorStops");T.addGetterSetter(J,"fillPatternRepeat","repeat");T.addGetterSetter(J,"fillEnabled",!0);T.addGetterSetter(J,"strokeEnabled",!0);T.addGetterSetter(J,"shadowEnabled",!0);T.addGetterSetter(J,"dashEnabled",!0);T.addGetterSetter(J,"strokeScaleEnabled",!0);T.addGetterSetter(J,"fillPriority","color");T.addComponentsGetterSetter(J,"fillPatternOffset",["x","y"]);T.addGetterSetter(J,"fillPatternOffsetX",0,it());T.addGetterSetter(J,"fillPatternOffsetY",0,it());T.addComponentsGetterSetter(J,"fillPatternScale",["x","y"]);T.addGetterSetter(J,"fillPatternScaleX",1,it());T.addGetterSetter(J,"fillPatternScaleY",1,it());T.addComponentsGetterSetter(J,"fillLinearGradientStartPoint",["x","y"]);T.addComponentsGetterSetter(J,"strokeLinearGradientStartPoint",["x","y"]);T.addGetterSetter(J,"fillLinearGradientStartPointX",0);T.addGetterSetter(J,"strokeLinearGradientStartPointX",0);T.addGetterSetter(J,"fillLinearGradientStartPointY",0);T.addGetterSetter(J,"strokeLinearGradientStartPointY",0);T.addComponentsGetterSetter(J,"fillLinearGradientEndPoint",["x","y"]);T.addComponentsGetterSetter(J,"strokeLinearGradientEndPoint",["x","y"]);T.addGetterSetter(J,"fillLinearGradientEndPointX",0);T.addGetterSetter(J,"strokeLinearGradientEndPointX",0);T.addGetterSetter(J,"fillLinearGradientEndPointY",0);T.addGetterSetter(J,"strokeLinearGradientEndPointY",0);T.addComponentsGetterSetter(J,"fillRadialGradientStartPoint",["x","y"]);T.addGetterSetter(J,"fillRadialGradientStartPointX",0);T.addGetterSetter(J,"fillRadialGradientStartPointY",0);T.addComponentsGetterSetter(J,"fillRadialGradientEndPoint",["x","y"]);T.addGetterSetter(J,"fillRadialGradientEndPointX",0);T.addGetterSetter(J,"fillRadialGradientEndPointY",0);T.addGetterSetter(J,"fillPatternRotation",0);T.addGetterSetter(J,"fillRule",void 0,Wo());T.backCompat(J,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const PM="#",AM="beforeDraw",MM="draw",_S=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],EM=_S.length;class qo extends cs{constructor(t){super(t),this.canvas=new Tr,this.hitCanvas=new TO({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){st.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!st.prototype.moveUp.call(this))return!1;const e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(st.prototype.moveDown.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(st.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return st.prototype.remove.call(this),t&&t.parentNode&&D._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&D.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),st.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){D.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){D.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,D.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,s=!1;for(;;){for(let n=0;n<EM;n++){const r=_S[n],o=this._getIntersection({x:t.x+r.x*e,y:t.y+r.y*e}),a=o.shape;if(a)return a;if(s=!!o.antialiased,!o.antialiased)break}if(s)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,s=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=s[3];if(n===255){const r=D._rgbToHex(s[0],s[1],s[2]),o=hc[PM+r];return o?{shape:o}:{antialiased:!0}}else if(n>0)return{antialiased:!0};return{}}drawScene(t,e,s){const n=this.getLayer(),r=t||n&&n.getCanvas();return this._fire(AM,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),cs.prototype.drawScene.call(this,r,e,s),this._fire(MM,{node:this}),this}drawHit(t,e){const s=this.getLayer(),n=t||s&&s.hitCanvas;return s&&s.clearBeforeDraw()&&s.getHitCanvas().getContext().clear(),cs.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){D.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return D.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return D.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}qo.prototype.nodeType="Layer";ke(qo);T.addGetterSetter(qo,"imageSmoothingEnabled",!0);T.addGetterSetter(qo,"clearBeforeDraw",!0);T.addGetterSetter(qo,"hitGraphEnabled",!0,Gs());class MO extends qo{constructor(t){super(t),this.listening(!1),D.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}MO.prototype.nodeType="FastLayer";ke(MO);class Va extends cs{_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&D.throw("You may only add groups and shapes to groups.")}}Va.prototype.nodeType="Group";ke(Va);const Np=(function(){return _o.performance&&_o.performance.now?function(){return _o.performance.now()}:function(){return new Date().getTime()}})();class ms{constructor(t,e){this.id=ms.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Np(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,s=e.length;for(let n=0;n<s;n++)if(e[n]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=ms.animations,s=e.length;for(let n=0;n<s;n++)if(e[n].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Np(),ms._addAnimation(this),this}stop(){return ms._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,s=this.animations,n=s.length;for(let r=0;r<n;r++)if(s[r].id===e){this.animations.splice(r,1);break}}static _runFrames(){const t={},e=this.animations;for(let s=0;s<e.length;s++){const n=e[s],r=n.layers,o=n.func;n._updateFrameObject(Np());const a=r.length;let l;if(o?l=o.call(n,n.frame)!==!1:l=!0,!!l)for(let c=0;c<a;c++){const h=r[c];h._id!==void 0&&(t[h._id]=h)}}for(const s in t)t.hasOwnProperty(s)&&t[s].batchDraw()}static _animationLoop(){const t=ms;t.animations.length?(t._runFrames(),D.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,D.requestAnimFrame(this._animationLoop))}}ms.animations=[];ms.animIdCounter=0;ms.animRunning=!1;const RM={node:1,duration:1,easing:1,onFinish:1,yoyo:1},QM=1,Wy=2,qy=3,Xy=["fill","stroke","shadowColor"];let IM=0;class $M{constructor(t,e,s,n,r,o,a){this.prop=t,this.propFunc=e,this.begin=n,this._pos=n,this.duration=o,this._change=0,this.prevPos=0,this.yoyo=a,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=s,this._change=r-this.begin,this.pause()}fire(t){const e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=Wy,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=qy,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===Wy?this.setTime(t):this.state===qy&&this.setTime(this.duration-t)}pause(){this.state=QM,this.fire("onPause")}getTimer(){return new Date().getTime()}}class he{constructor(t){const e=this,s=t.node,n=s._id,r=t.easing||uc.Linear,o=!!t.yoyo;let a,l;typeof t.duration>"u"?a=.3:t.duration===0?a=.001:a=t.duration,this.node=s,this._id=IM++;const c=s.getLayer()||(s instanceof rt.Stage?s.getLayers():null);c||D.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new ms(function(){e.tween.onEnterFrame()},c),this.tween=new $M(l,function(h){e._tweenFunc(h)},r,0,1,a*1e3,o),this._addListeners(),he.attrs[n]||(he.attrs[n]={}),he.attrs[n][this._id]||(he.attrs[n][this._id]={}),he.tweens[n]||(he.tweens[n]={});for(l in t)RM[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){const s=this.node,n=s._id;let r,o,a,l,c;const h=he.tweens[n][t];h&&delete he.attrs[n][h][t];let u=s.getAttr(t);if(D._isArray(e))if(r=[],o=Math.max(e.length,u.length),t==="points"&&e.length!==u.length&&(e.length>u.length?(l=u,u=D._prepareArrayForTween(u,e,s.closed())):(a=e,e=D._prepareArrayForTween(e,u,s.closed()))),t.indexOf("fill")===0)for(let f=0;f<o;f++)if(f%2===0)r.push(e[f]-u[f]);else{const d=D.colorToRGBA(u[f]);c=D.colorToRGBA(e[f]),u[f]=d,r.push({r:c.r-d.r,g:c.g-d.g,b:c.b-d.b,a:c.a-d.a})}else for(let f=0;f<o;f++)r.push(e[f]-u[f]);else Xy.indexOf(t)!==-1?(u=D.colorToRGBA(u),c=D.colorToRGBA(e),r={r:c.r-u.r,g:c.g-u.g,b:c.b-u.b,a:c.a-u.a}):r=e-u;he.attrs[n][this._id][t]={start:u,diff:r,end:e,trueEnd:a,trueStart:l},he.tweens[n][t]=this._id}_tweenFunc(t){const e=this.node,s=he.attrs[e._id][this._id];let n,r,o,a,l,c,h,u;for(n in s){if(r=s[n],o=r.start,a=r.diff,u=r.end,D._isArray(o))if(l=[],h=Math.max(o.length,u.length),n.indexOf("fill")===0)for(c=0;c<h;c++)c%2===0?l.push((o[c]||0)+a[c]*t):l.push("rgba("+Math.round(o[c].r+a[c].r*t)+","+Math.round(o[c].g+a[c].g*t)+","+Math.round(o[c].b+a[c].b*t)+","+(o[c].a+a[c].a*t)+")");else for(c=0;c<h;c++)l.push((o[c]||0)+a[c]*t);else Xy.indexOf(n)!==-1?l="rgba("+Math.round(o.r+a.r*t)+","+Math.round(o.g+a.g*t)+","+Math.round(o.b+a.b*t)+","+(o.a+a.a*t)+")":l=o+a*t;e.setAttr(n,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,e=he.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,e=he.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,e=this._id,s=he.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const n in s)delete he.tweens[t][n];delete he.attrs[t][e],he.tweens[t]&&(Object.keys(he.tweens[t]).length===0&&delete he.tweens[t],Object.keys(he.attrs[t]).length===0&&delete he.attrs[t])}}he.attrs={};he.tweens={};st.prototype.to=function(i){const t=i.onFinish;i.node=this,i.onFinish=function(){this.destroy(),t&&t()},new he(i).play()};const uc={BackEaseIn(i,t,e,s){return e*(i/=s)*i*((1.70158+1)*i-1.70158)+t},BackEaseOut(i,t,e,s){return e*((i=i/s-1)*i*((1.70158+1)*i+1.70158)+1)+t},BackEaseInOut(i,t,e,s){let n=1.70158;return(i/=s/2)<1?e/2*(i*i*(((n*=1.525)+1)*i-n))+t:e/2*((i-=2)*i*(((n*=1.525)+1)*i+n)+2)+t},ElasticEaseIn(i,t,e,s,n,r){let o=0;return i===0?t:(i/=s)===1?t+e:(r||(r=s*.3),!n||n<Math.abs(e)?(n=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/n),-(n*Math.pow(2,10*(i-=1))*Math.sin((i*s-o)*(2*Math.PI)/r))+t)},ElasticEaseOut(i,t,e,s,n,r){let o=0;return i===0?t:(i/=s)===1?t+e:(r||(r=s*.3),!n||n<Math.abs(e)?(n=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/n),n*Math.pow(2,-10*i)*Math.sin((i*s-o)*(2*Math.PI)/r)+e+t)},ElasticEaseInOut(i,t,e,s,n,r){let o=0;return i===0?t:(i/=s/2)===2?t+e:(r||(r=s*(.3*1.5)),!n||n<Math.abs(e)?(n=e,o=r/4):o=r/(2*Math.PI)*Math.asin(e/n),i<1?-.5*(n*Math.pow(2,10*(i-=1))*Math.sin((i*s-o)*(2*Math.PI)/r))+t:n*Math.pow(2,-10*(i-=1))*Math.sin((i*s-o)*(2*Math.PI)/r)*.5+e+t)},BounceEaseOut(i,t,e,s){return(i/=s)<1/2.75?e*(7.5625*i*i)+t:i<2/2.75?e*(7.5625*(i-=1.5/2.75)*i+.75)+t:i<2.5/2.75?e*(7.5625*(i-=2.25/2.75)*i+.9375)+t:e*(7.5625*(i-=2.625/2.75)*i+.984375)+t},BounceEaseIn(i,t,e,s){return e-uc.BounceEaseOut(s-i,0,e,s)+t},BounceEaseInOut(i,t,e,s){return i<s/2?uc.BounceEaseIn(i*2,0,e,s)*.5+t:uc.BounceEaseOut(i*2-s,0,e,s)*.5+e*.5+t},EaseIn(i,t,e,s){return e*(i/=s)*i+t},EaseOut(i,t,e,s){return-e*(i/=s)*(i-2)+t},EaseInOut(i,t,e,s){return(i/=s/2)<1?e/2*i*i+t:-e/2*(--i*(i-2)-1)+t},StrongEaseIn(i,t,e,s){return e*(i/=s)*i*i*i*i+t},StrongEaseOut(i,t,e,s){return e*((i=i/s-1)*i*i*i*i+1)+t},StrongEaseInOut(i,t,e,s){return(i/=s/2)<1?e/2*i*i*i*i*i+t:e/2*((i-=2)*i*i*i*i+2)+t},Linear(i,t,e,s){return e*i/s+t}},zy=D._assign(rt,{Util:D,Transform:rs,Node:st,Container:cs,Stage:Jd,stages:cc,Layer:qo,FastLayer:MO,Group:Va,DD:Yt,Shape:J,shapes:hc,Animation:ms,Tween:he,Easings:uc,Context:Hd,Canvas:CO});class lr extends J{_sceneFunc(t){const e=rt.getAngle(this.angle()),s=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,s),t.arc(0,0,this.innerRadius(),e,0,!s),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),s=this.clockwise(),n=rt.getAngle(s?360-this.angle():this.angle()),r=Math.cos(Math.min(n,Math.PI)),o=1,a=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),l=Math.sin(Math.min(n,Math.PI/2)),c=r*(r>0?t:e),h=o*e,u=a*(a>0?t:e),f=l*(l>0?e:t);return{x:c,y:s?-1*f:u,width:h-c,height:f-u}}}lr.prototype._centroid=!0;lr.prototype.className="Arc";lr.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];ke(lr);T.addGetterSetter(lr,"innerRadius",0,it());T.addGetterSetter(lr,"outerRadius",0,it());T.addGetterSetter(lr,"angle",0,it());T.addGetterSetter(lr,"clockwise",!1,Gs());function sm(i,t,e,s,n,r,o){const a=Math.sqrt(Math.pow(e-i,2)+Math.pow(s-t,2)),l=Math.sqrt(Math.pow(n-e,2)+Math.pow(r-s,2)),c=o*a/(a+l),h=o*l/(a+l),u=e-c*(n-i),f=s-c*(r-t),d=e+h*(n-i),p=s+h*(r-t);return[u,f,d,p]}function jy(i,t){const e=i.length,s=[];for(let n=2;n<e-2;n+=2){const r=sm(i[n-2],i[n-1],i[n],i[n+1],i[n+2],i[n+3],t);isNaN(r[0])||(s.push(r[0]),s.push(r[1]),s.push(i[n]),s.push(i[n+1]),s.push(r[2]),s.push(r[3]))}return s}let cr=class extends J{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const e=this.points(),s=e.length,n=this.tension(),r=this.closed(),o=this.bezier();if(!s)return;let a=0;if(t.beginPath(),t.moveTo(e[0],e[1]),n!==0&&s>4){const l=this.getTensionPoints(),c=l.length;for(a=r?0:4,r||t.quadraticCurveTo(l[0],l[1],l[2],l[3]);a<c-2;)t.bezierCurveTo(l[a++],l[a++],l[a++],l[a++],l[a++],l[a++]);r||t.quadraticCurveTo(l[c-2],l[c-1],e[s-2],e[s-1])}else if(o)for(a=2;a<s;)t.bezierCurveTo(e[a++],e[a++],e[a++],e[a++],e[a++],e[a++]);else for(a=2;a<s;a+=2)t.lineTo(e[a],e[a+1]);r?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():jy(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),e=t.length,s=this.tension(),n=sm(t[e-2],t[e-1],t[0],t[1],t[2],t[3],s),r=sm(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],s),o=jy(t,s);return[n[2],n[3]].concat(o).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],n[0],n[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:t=this.points();let e=t[0],s=t[0],n=t[1],r=t[1],o,a;for(let l=0;l<t.length/2;l++)o=t[l*2],a=t[l*2+1],e=Math.min(e,o),s=Math.max(s,o),n=Math.min(n,a),r=Math.max(r,a);return{x:e,y:n,width:s-e,height:r-n}}};cr.prototype.className="Line";cr.prototype._attrsAffectingSize=["points","bezier","tension"];ke(cr);T.addGetterSetter(cr,"closed",!1);T.addGetterSetter(cr,"bezier",!1);T.addGetterSetter(cr,"tension",0,it());T.addGetterSetter(cr,"points",[],H7());const NM=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],DM=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],LM=[[1],[1,1],[1,2,1],[1,3,3,1]],Gy=(i,t,e)=>{let s,n;const o=e/2;s=0;for(let a=0;a<20;a++)n=o*NM[20][a]+o,s+=DM[20][a]*VM(i,t,n);return o*s},Yy=(i,t,e)=>{e===void 0&&(e=1);const s=i[0]-2*i[1]+i[2],n=t[0]-2*t[1]+t[2],r=2*i[1]-2*i[0],o=2*t[1]-2*t[0],a=4*(s*s+n*n),l=4*(s*r+n*o),c=r*r+o*o;if(a===0)return e*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(t[2]-t[0],2));const h=l/(2*a),u=c/a,f=e+h,d=u-h*h,p=f*f+d>0?Math.sqrt(f*f+d):0,g=h*h+d>0?Math.sqrt(h*h+d):0,m=h+Math.sqrt(h*h+d)!==0?d*Math.log(Math.abs((f+p)/(h+g))):0;return Math.sqrt(a)/2*(f*p-h*g+m)};function VM(i,t,e){const s=nm(1,e,i),n=nm(1,e,t),r=s*s+n*n;return Math.sqrt(r)}const nm=(i,t,e)=>{const s=e.length-1;let n,r;if(s===0)return 0;if(i===0){r=0;for(let o=0;o<=s;o++)r+=LM[s][o]*Math.pow(1-t,s-o)*Math.pow(t,o)*e[o];return r}else{n=new Array(s);for(let o=0;o<s;o++)n[o]=s*(e[o+1]-e[o]);return nm(i-1,t,n)}},Uy=(i,t,e)=>{let s=1,n=i/t,r=(i-e(n))/t,o=0;for(;s>.001;){const a=e(n+r),l=Math.abs(i-a)/t;if(l<s)s=l,n+=r;else{const c=e(n-r),h=Math.abs(i-c)/t;h<s?(s=h,n-=r):r/=2}if(o++,o>500)break}return n};class fe extends J{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=fe.parsePathData(this.data()),this.pathLength=fe.getPathLength(this.dataArray)}_sceneFunc(t){const e=this.dataArray;t.beginPath();let s=!1;for(let n=0;n<e.length;n++){const r=e[n].command,o=e[n].points;switch(r){case"L":t.lineTo(o[0],o[1]);break;case"M":t.moveTo(o[0],o[1]);break;case"C":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":t.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":const a=o[0],l=o[1],c=o[2],h=o[3],u=o[4],f=o[5],d=o[6],p=o[7],g=c>h?c:h,m=c>h?1:c/h,O=c>h?h/c:1;t.translate(a,l),t.rotate(d),t.scale(m,O),t.arc(0,0,g,u,u+f,1-p),t.scale(1/m,1/O),t.rotate(-d),t.translate(-a,-l);break;case"z":s=!0,t.closePath();break}}!s&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(l){if(l.command==="A"){const c=l.points[4],h=l.points[5],u=l.points[4]+h;let f=Math.PI/180;if(Math.abs(c-u)<f&&(f=Math.abs(c-u)),h<0)for(let d=c-f;d>u;d-=f){const p=fe.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],d,0);t.push(p.x,p.y)}else for(let d=c+f;d<u;d+=f){const p=fe.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],d,0);t.push(p.x,p.y)}}else if(l.command==="C")for(let c=0;c<=1;c+=.01){const h=fe.getPointOnCubicBezier(c,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);t.push(h.x,h.y)}else t=t.concat(l.points)});let e=t[0],s=t[0],n=t[1],r=t[1],o,a;for(let l=0;l<t.length/2;l++)o=t[l*2],a=t[l*2+1],isNaN(o)||(e=Math.min(e,o),s=Math.max(s,o)),isNaN(a)||(n=Math.min(n,a),r=Math.max(r,a));return{x:e,y:n,width:s-e,height:r-n}}getLength(){return this.pathLength}getPointAtLength(t){return fe.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,s,n){return Math.sqrt((s-t)*(s-t)+(n-e)*(n-e))}static getPathLength(t){let e=0;for(let s=0;s<t.length;++s)e+=t[s].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let s,n=0,r=e.length;if(!r)return null;for(;n<r&&t>e[n].pathLength;)t-=e[n].pathLength,++n;if(n===r)return s=e[n-1].points.slice(-2),{x:s[0],y:s[1]};if(t<.01)return e[n].command==="M"?(s=e[n].points.slice(0,2),{x:s[0],y:s[1]}):{x:e[n].start.x,y:e[n].start.y};const o=e[n],a=o.points;switch(o.command){case"L":return fe.getPointOnLine(t,o.start.x,o.start.y,a[0],a[1]);case"C":return fe.getPointOnCubicBezier(Uy(t,fe.getPathLength(e),g=>Gy([o.start.x,a[0],a[2],a[4]],[o.start.y,a[1],a[3],a[5]],g)),o.start.x,o.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return fe.getPointOnQuadraticBezier(Uy(t,fe.getPathLength(e),g=>Yy([o.start.x,a[0],a[2]],[o.start.y,a[1],a[3]],g)),o.start.x,o.start.y,a[0],a[1],a[2],a[3]);case"A":const l=a[0],c=a[1],h=a[2],u=a[3],f=a[5],d=a[6];let p=a[4];return p+=f*t/o.pathLength,fe.getPointOnEllipticalArc(l,c,h,u,p,d)}return null}static getPointOnLine(t,e,s,n,r,o,a){o=o??e,a=a??s;const l=this.getLineLength(e,s,n,r);if(l<1e-10)return{x:e,y:s};if(n===e)return{x:o,y:a+(r>s?t:-t)};const c=(r-s)/(n-e),h=Math.sqrt(t*t/(1+c*c))*(n<e?-1:1),u=c*h;if(Math.abs(a-s-c*(o-e))<1e-10)return{x:o+h,y:a+u};const f=((o-e)*(n-e)+(a-s)*(r-s))/(l*l),d=e+f*(n-e),p=s+f*(r-s),g=this.getLineLength(o,a,d,p),m=Math.sqrt(t*t-g*g),O=Math.sqrt(m*m/(1+c*c))*(n<e?-1:1),b=c*O;return{x:d+O,y:p+b}}static getPointOnCubicBezier(t,e,s,n,r,o,a,l,c){function h(m){return m*m*m}function u(m){return 3*m*m*(1-m)}function f(m){return 3*m*(1-m)*(1-m)}function d(m){return(1-m)*(1-m)*(1-m)}const p=l*h(t)+o*u(t)+n*f(t)+e*d(t),g=c*h(t)+a*u(t)+r*f(t)+s*d(t);return{x:p,y:g}}static getPointOnQuadraticBezier(t,e,s,n,r,o,a){function l(d){return d*d}function c(d){return 2*d*(1-d)}function h(d){return(1-d)*(1-d)}const u=o*l(t)+n*c(t)+e*h(t),f=a*l(t)+r*c(t)+s*h(t);return{x:u,y:f}}static getPointOnEllipticalArc(t,e,s,n,r,o){const a=Math.cos(o),l=Math.sin(o),c={x:s*Math.cos(r),y:n*Math.sin(r)};return{x:t+(c.x*a-c.y*l),y:e+(c.x*l+c.y*a)}}static parsePathData(t){if(!t)return[];let e=t;const s=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let u=0;u<s.length;u++)e=e.replace(new RegExp(s[u],"g"),"|"+s[u]);const n=e.split("|"),r=[],o=[];let a=0,l=0;const c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let h;for(let u=1;u<n.length;u++){let f=n[u],d=f.charAt(0);for(f=f.slice(1),o.length=0;h=c.exec(f);)o.push(h[0]);let p=[],g=d==="A"||d==="a"?0:-1;for(let m=0,O=o.length;m<O;m++){const b=o[m];if(b==="00"){p.push(0,0),g>=0&&(g+=2,g>=7&&(g-=7));continue}if(g>=0){if(g===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(b)){p.push(parseInt(b[0],10)),p.push(parseInt(b[1],10)),p.push(parseFloat(b.slice(2))),g+=3,g>=7&&(g-=7);continue}if(b==="11"||b==="10"||b==="01"){p.push(parseInt(b[0],10)),p.push(parseInt(b[1],10)),g+=2,g>=7&&(g-=7);continue}if(b==="0"||b==="1"){p.push(parseInt(b,10)),g+=1,g>=7&&(g-=7);continue}}else if(g===4){if(/^[01]\d+(?:\.\d+)?$/.test(b)){p.push(parseInt(b[0],10)),p.push(parseFloat(b.slice(1))),g+=2,g>=7&&(g-=7);continue}if(b==="0"||b==="1"){p.push(parseInt(b,10)),g+=1,g>=7&&(g-=7);continue}}const x=parseFloat(b);isNaN(x)?p.push(0):p.push(x),g+=1,g>=7&&(g-=7)}else{const x=parseFloat(b);isNaN(x)?p.push(0):p.push(x)}}for(;p.length>0&&!isNaN(p[0]);){let m="",O=[];const b=a,x=l;let v,y,_,S,k,A,M,R,C,$;switch(d){case"l":a+=p.shift(),l+=p.shift(),m="L",O.push(a,l);break;case"L":a=p.shift(),l=p.shift(),O.push(a,l);break;case"m":const N=p.shift(),L=p.shift();if(a+=N,l+=L,m="M",r.length>2&&r[r.length-1].command==="z"){for(let I=r.length-2;I>=0;I--)if(r[I].command==="M"){a=r[I].points[0]+N,l=r[I].points[1]+L;break}}O.push(a,l),d="l";break;case"M":a=p.shift(),l=p.shift(),m="M",O.push(a,l),d="L";break;case"h":a+=p.shift(),m="L",O.push(a,l);break;case"H":a=p.shift(),m="L",O.push(a,l);break;case"v":l+=p.shift(),m="L",O.push(a,l);break;case"V":l=p.shift(),m="L",O.push(a,l);break;case"C":O.push(p.shift(),p.shift(),p.shift(),p.shift()),a=p.shift(),l=p.shift(),O.push(a,l);break;case"c":O.push(a+p.shift(),l+p.shift(),a+p.shift(),l+p.shift()),a+=p.shift(),l+=p.shift(),m="C",O.push(a,l);break;case"S":y=a,_=l,v=r[r.length-1],v.command==="C"&&(y=a+(a-v.points[2]),_=l+(l-v.points[3])),O.push(y,_,p.shift(),p.shift()),a=p.shift(),l=p.shift(),m="C",O.push(a,l);break;case"s":y=a,_=l,v=r[r.length-1],v.command==="C"&&(y=a+(a-v.points[2]),_=l+(l-v.points[3])),O.push(y,_,a+p.shift(),l+p.shift()),a+=p.shift(),l+=p.shift(),m="C",O.push(a,l);break;case"Q":O.push(p.shift(),p.shift()),a=p.shift(),l=p.shift(),O.push(a,l);break;case"q":O.push(a+p.shift(),l+p.shift()),a+=p.shift(),l+=p.shift(),m="Q",O.push(a,l);break;case"T":y=a,_=l,v=r[r.length-1],v.command==="Q"&&(y=a+(a-v.points[0]),_=l+(l-v.points[1])),a=p.shift(),l=p.shift(),m="Q",O.push(y,_,a,l);break;case"t":y=a,_=l,v=r[r.length-1],v.command==="Q"&&(y=a+(a-v.points[0]),_=l+(l-v.points[1])),a+=p.shift(),l+=p.shift(),m="Q",O.push(y,_,a,l);break;case"A":S=p.shift(),k=p.shift(),A=p.shift(),M=p.shift(),R=p.shift(),C=a,$=l,a=p.shift(),l=p.shift(),m="A",O=this.convertEndpointToCenterParameterization(C,$,a,l,M,R,S,k,A);break;case"a":S=p.shift(),k=p.shift(),A=p.shift(),M=p.shift(),R=p.shift(),C=a,$=l,a+=p.shift(),l+=p.shift(),m="A",O=this.convertEndpointToCenterParameterization(C,$,a,l,M,R,S,k,A);break}r.push({command:m||d,points:O,start:{x:b,y:x},pathLength:this.calcLength(b,x,m||d,O)})}(d==="z"||d==="Z")&&r.push({command:"z",points:[],start:void 0,pathLength:0})}return r}static calcLength(t,e,s,n){let r,o,a,l;const c=fe;switch(s){case"L":return c.getLineLength(t,e,n[0],n[1]);case"C":return Gy([t,n[0],n[2],n[4]],[e,n[1],n[3],n[5]],1);case"Q":return Yy([t,n[0],n[2]],[e,n[1],n[3]],1);case"A":r=0;const h=n[4],u=n[5],f=n[4]+u;let d=Math.PI/180;if(Math.abs(h-f)<d&&(d=Math.abs(h-f)),o=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],h,0),u<0)for(l=h-d;l>f;l-=d)a=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),o=a;else for(l=h+d;l<f;l+=d)a=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],l,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),o=a;return a=c.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],f,0),r+=c.getLineLength(o.x,o.y,a.x,a.y),r}return 0}static convertEndpointToCenterParameterization(t,e,s,n,r,o,a,l,c){const h=c*(Math.PI/180),u=Math.cos(h)*(t-s)/2+Math.sin(h)*(e-n)/2,f=-1*Math.sin(h)*(t-s)/2+Math.cos(h)*(e-n)/2,d=u*u/(a*a)+f*f/(l*l);d>1&&(a*=Math.sqrt(d),l*=Math.sqrt(d));let p=Math.sqrt((a*a*(l*l)-a*a*(f*f)-l*l*(u*u))/(a*a*(f*f)+l*l*(u*u)));r===o&&(p*=-1),isNaN(p)&&(p=0);const g=p*a*f/l,m=p*-l*u/a,O=(t+s)/2+Math.cos(h)*g-Math.sin(h)*m,b=(e+n)/2+Math.sin(h)*g+Math.cos(h)*m,x=function(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])},v=function(M,R){return(M[0]*R[0]+M[1]*R[1])/(x(M)*x(R))},y=function(M,R){return(M[0]*R[1]<M[1]*R[0]?-1:1)*Math.acos(v(M,R))},_=y([1,0],[(u-g)/a,(f-m)/l]),S=[(u-g)/a,(f-m)/l],k=[(-1*u-g)/a,(-1*f-m)/l];let A=y(S,k);return v(S,k)<=-1&&(A=Math.PI),v(S,k)>=1&&(A=0),o===0&&A>0&&(A=A-2*Math.PI),o===1&&A<0&&(A=A+2*Math.PI),[O,b,a,l,_,A,h,o]}}fe.prototype.className="Path";fe.prototype._attrsAffectingSize=["data"];ke(fe);T.addGetterSetter(fe,"data");class Xo extends cr{_sceneFunc(t){super._sceneFunc(t);const e=Math.PI*2,s=this.points();let n=s;const r=this.tension()!==0&&s.length>4;r&&(n=this.getTensionPoints());const o=this.pointerLength(),a=s.length;let l,c;if(r){const f=[n[n.length-4],n[n.length-3],n[n.length-2],n[n.length-1],s[a-2],s[a-1]],d=fe.calcLength(n[n.length-4],n[n.length-3],"C",f),p=fe.getPointOnQuadraticBezier(Math.min(1,1-o/d),f[0],f[1],f[2],f[3],f[4],f[5]);l=s[a-2]-p.x,c=s[a-1]-p.y}else l=s[a-2]-s[a-4],c=s[a-1]-s[a-3];const h=(Math.atan2(c,l)+e)%e,u=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(s[a-2],s[a-1]),t.rotate(h),t.moveTo(0,0),t.lineTo(-o,u/2),t.lineTo(-o,-u/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(s[0],s[1]),r?(l=(n[0]+n[2])/2-s[0],c=(n[1]+n[3])/2-s[1]):(l=s[2]-s[0],c=s[3]-s[1]),t.rotate((Math.atan2(-c,-l)+e)%e),t.moveTo(0,0),t.lineTo(-o,u/2),t.lineTo(-o,-u/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x,y:t.y-e,width:t.width,height:t.height+e*2}}}Xo.prototype.className="Arrow";ke(Xo);T.addGetterSetter(Xo,"pointerLength",10,it());T.addGetterSetter(Xo,"pointerWidth",10,it());T.addGetterSetter(Xo,"pointerAtBeginning",!1);T.addGetterSetter(Xo,"pointerAtEnding",!0);class nl extends J{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}nl.prototype._centroid=!0;nl.prototype.className="Circle";nl.prototype._attrsAffectingSize=["radius"];ke(nl);T.addGetterSetter(nl,"radius",0,it());class eo extends J{_sceneFunc(t){const e=this.radiusX(),s=this.radiusY();t.beginPath(),t.save(),e!==s&&t.scale(1,s/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}eo.prototype.className="Ellipse";eo.prototype._centroid=!0;eo.prototype._attrsAffectingSize=["radiusX","radiusY"];ke(eo);T.addComponentsGetterSetter(eo,"radius",["x","y"]);T.addGetterSetter(eo,"radiusX",0,it());T.addGetterSetter(eo,"radiusY",0,it());class Ts extends J{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),e=this.hasShadow();return t&&e?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),s=this.getHeight(),n=this.cornerRadius(),r=this.attrs.image;let o;if(r){const a=this.attrs.cropWidth,l=this.attrs.cropHeight;a&&l?o=[r,this.cropX(),this.cropY(),a,l,0,0,e,s]:o=[r,0,0,e,s]}(this.hasFill()||this.hasStroke()||n)&&(t.beginPath(),n?D.drawRoundedRectPath(t,e,s,n):t.rect(0,0,e,s),t.closePath(),t.fillStrokeShape(this)),r&&(n&&t.clip(),t.drawImage.apply(t,o))}_hitFunc(t){const e=this.width(),s=this.height(),n=this.cornerRadius();t.beginPath(),n?D.drawRoundedRectPath(t,e,s,n):t.rect(0,0,e,s),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width}getHeight(){var t,e;return(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height}static fromURL(t,e,s=null){const n=D.createImageElement();n.onload=function(){const r=new Ts({image:n});e(r)},n.onerror=s,n.crossOrigin="Anonymous",n.src=t}}Ts.prototype.className="Image";ke(Ts);T.addGetterSetter(Ts,"cornerRadius",0,Kd(4));T.addGetterSetter(Ts,"image");T.addComponentsGetterSetter(Ts,"crop",["x","y","width","height"]);T.addGetterSetter(Ts,"cropX",0,it());T.addGetterSetter(Ts,"cropY",0,it());T.addGetterSetter(Ts,"cropWidth",0,it());T.addGetterSetter(Ts,"cropHeight",0,it());const xS=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],BM="Change.konva",ZM="none",rm="up",om="right",am="down",lm="left",FM=xS.length;class EO extends Va{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,s;const n=function(){e._sync()};for(s=0;s<FM;s++)t.on(xS[s]+BM,n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),s,n,r,o,a,l,c;if(t&&e){switch(s=t.width(),n=t.height(),r=e.pointerDirection(),o=e.pointerWidth(),c=e.pointerHeight(),a=0,l=0,r){case rm:a=s/2,l=-1*c;break;case om:a=s+o,l=n/2;break;case am:a=s/2,l=n+c;break;case lm:a=-1*o,l=n/2;break}e.setAttrs({x:-1*a,y:-1*l,width:s,height:n}),t.setAttrs({x:-1*a,y:-1*l})}}}EO.prototype.className="Label";ke(EO);let zo=class extends J{_sceneFunc(t){const e=this.width(),s=this.height(),n=this.pointerDirection(),r=this.pointerWidth(),o=this.pointerHeight(),a=this.cornerRadius();let l=0,c=0,h=0,u=0;typeof a=="number"?l=c=h=u=Math.min(a,e/2,s/2):(l=Math.min(a[0]||0,e/2,s/2),c=Math.min(a[1]||0,e/2,s/2),u=Math.min(a[2]||0,e/2,s/2),h=Math.min(a[3]||0,e/2,s/2)),t.beginPath(),t.moveTo(l,0),n===rm&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*o),t.lineTo((e+r)/2,0)),t.lineTo(e-c,0),t.arc(e-c,c,c,Math.PI*3/2,0,!1),n===om&&(t.lineTo(e,(s-o)/2),t.lineTo(e+r,s/2),t.lineTo(e,(s+o)/2)),t.lineTo(e,s-u),t.arc(e-u,s-u,u,0,Math.PI/2,!1),n===am&&(t.lineTo((e+r)/2,s),t.lineTo(e/2,s+o),t.lineTo((e-r)/2,s)),t.lineTo(h,s),t.arc(h,s-h,h,Math.PI/2,Math.PI,!1),n===lm&&(t.lineTo(0,(s+o)/2),t.lineTo(-1*r,s/2),t.lineTo(0,(s-o)/2)),t.lineTo(0,l),t.arc(l,l,l,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,s=this.pointerWidth(),n=this.pointerHeight(),r=this.pointerDirection(),o=this.width(),a=this.height();return r===rm?(e-=n,a+=n):r===am?a+=n:r===lm?(t-=s*1.5,o+=s):r===om&&(o+=s*1.5),{x:t,y:e,width:o,height:a}}};zo.prototype.className="Tag";ke(zo);T.addGetterSetter(zo,"pointerDirection",ZM);T.addGetterSetter(zo,"pointerWidth",0,it());T.addGetterSetter(zo,"pointerHeight",0,it());T.addGetterSetter(zo,"cornerRadius",0,Kd(4));class dh extends J{_sceneFunc(t){const e=this.cornerRadius(),s=this.width(),n=this.height();t.beginPath(),e?D.drawRoundedRectPath(t,s,n,e):t.rect(0,0,s,n),t.closePath(),t.fillStrokeShape(this)}}dh.prototype.className="Rect";ke(dh);T.addGetterSetter(dh,"cornerRadius",0,Kd(4));class io extends J{_sceneFunc(t){const e=this._getPoints(),s=this.radius(),n=this.sides(),r=this.cornerRadius();if(t.beginPath(),r)D.drawRoundedPolygonPath(t,e,n,s,r);else{t.moveTo(e[0].x,e[0].y);for(let o=1;o<e.length;o++)t.lineTo(e[o].x,e[o].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,s=[];for(let n=0;n<t;n++)s.push({x:e*Math.sin(n*2*Math.PI/t),y:-1*e*Math.cos(n*2*Math.PI/t)});return s}getSelfRect(){const t=this._getPoints();let e=t[0].x,s=t[0].y,n=t[0].x,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),s=Math.max(s,o.x),n=Math.min(n,o.y),r=Math.max(r,o.y)}),{x:e,y:n,width:s-e,height:r-n}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}io.prototype.className="RegularPolygon";io.prototype._centroid=!0;io.prototype._attrsAffectingSize=["radius"];ke(io);T.addGetterSetter(io,"radius",0,it());T.addGetterSetter(io,"sides",0,it());T.addGetterSetter(io,"cornerRadius",0,Kd(4));const Hy=Math.PI*2;class jo extends J{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Hy,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Hy,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}jo.prototype.className="Ring";jo.prototype._centroid=!0;jo.prototype._attrsAffectingSize=["innerRadius","outerRadius"];ke(jo);T.addGetterSetter(jo,"innerRadius",0,it());T.addGetterSetter(jo,"outerRadius",0,it());class Pn extends J{constructor(t){super(t),this._updated=!0,this.anim=new ms(()=>{const e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const e=this.animation(),s=this.frameIndex(),n=s*4,r=this.animations()[e],o=this.frameOffsets(),a=r[n+0],l=r[n+1],c=r[n+2],h=r[n+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,c,h),t.closePath(),t.fillStrokeShape(this)),u)if(o){const f=o[e],d=s*2;t.drawImage(u,a,l,c,h,f[d+0],f[d+1],c,h)}else t.drawImage(u,a,l,c,h,0,0,c,h)}_hitFunc(t){const e=this.animation(),s=this.frameIndex(),n=s*4,r=this.animations()[e],o=this.frameOffsets(),a=r[n+2],l=r[n+3];if(t.beginPath(),o){const c=o[e],h=s*2;t.rect(c[h+0],c[h+1],a,l)}else t.rect(0,0,a,l);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),e=this.animation(),s=this.animations(),n=s[e],r=n.length/4;t<r-1?this.frameIndex(t+1):this.frameIndex(0)}}Pn.prototype.className="Sprite";ke(Pn);T.addGetterSetter(Pn,"animation");T.addGetterSetter(Pn,"animations");T.addGetterSetter(Pn,"frameOffsets");T.addGetterSetter(Pn,"image");T.addGetterSetter(Pn,"frameIndex",0,it());T.addGetterSetter(Pn,"frameRate",17,it());T.backCompat(Pn,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class so extends J{_sceneFunc(t){const e=this.innerRadius(),s=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-s);for(let r=1;r<n*2;r++){const o=r%2===0?s:e,a=o*Math.sin(r*Math.PI/n),l=-1*o*Math.cos(r*Math.PI/n);t.lineTo(a,l)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}so.prototype.className="Star";so.prototype._centroid=!0;so.prototype._attrsAffectingSize=["innerRadius","outerRadius"];ke(so);T.addGetterSetter(so,"numPoints",5,it());T.addGetterSetter(so,"innerRadius",0,it());T.addGetterSetter(so,"outerRadius",0,it());function br(i){return[...i].reduce((t,e,s,n)=>{if(new RegExp("\\p{Emoji}","u").test(e)){const r=n[s+1];r&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(r)?(t.push(e+r),n[s+1]=""):t.push(e)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(e+(n[s+1]||""))?t.push(e+n[s+1]):s>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(e)?t[t.length-1]+=e:e&&t.push(e);return t},[])}const Ko="auto",WM="center",SS="inherit",Jo="justify",qM="Change.konva",XM="2d",Ky="-",wS="left",zM="text",jM="Text",GM="top",YM="bottom",Jy="middle",kS="normal",UM="px ",Hh=" ",HM="right",tb="rtl",KM="word",JM="char",eb="none",Dp="",CS=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],tE=CS.length;function eE(i){return i.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,s=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!s&&(t=`"${t}"`),t}).join(", ")}let Kh;function Lp(){return Kh||(Kh=D.createCanvasElement().getContext(XM),Kh)}function iE(i){i.fillText(this._partialText,this._partialTextX,this._partialTextY)}function sE(i){i.setAttr("miterLimit",2),i.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function nE(i){return i=i||{},!i.fillLinearGradientColorStops&&!i.fillRadialGradientColorStops&&!i.fillPatternImage&&(i.fill=i.fill||"black"),i}let ve=class extends J{constructor(t){super(nE(t)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<tE;e++)this.on(CS[e]+qM,this._setTextData);this._setTextData()}_sceneFunc(t){var e,s;const n=this.textArr,r=n.length;if(!this.text())return;let o=this.padding(),a=this.fontSize(),l=this.lineHeight()*a,c=this.verticalAlign(),h=this.direction(),u=0,f=this.align(),d=this.getWidth(),p=this.letterSpacing(),g=this.charRenderFunc(),m=this.fill(),O=this.textDecoration(),b=O.indexOf("underline")!==-1,x=O.indexOf("line-through")!==-1,v;h=h===SS?t.direction:h;let y=l/2,_=Jy;if(!rt.legacyTextRendering){const S=this.measureSize("M");_="alphabetic";const k=(e=S.fontBoundingBoxAscent)!==null&&e!==void 0?e:S.actualBoundingBoxAscent,A=(s=S.fontBoundingBoxDescent)!==null&&s!==void 0?s:S.actualBoundingBoxDescent;y=(k-A)/2+l/2}for(h===tb&&t.setAttr("direction",h),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",_),t.setAttr("textAlign",wS),c===Jy?u=(this.getHeight()-r*l-o*2)/2:c===YM&&(u=this.getHeight()-r*l-o*2),t.translate(o,u+o),v=0;v<r;v++){let S=0,k=0;const A=n[v],M=A.text,R=A.width,C=A.lastInParagraph;if(t.save(),f===HM?S+=d-R-o*2:f===WM&&(S+=(d-R-o*2)/2),b){t.save(),t.beginPath();const $=rt.legacyTextRendering?Math.round(a/2):Math.round(a/4),N=S,L=y+k+$;t.moveTo(N,L);const I=f===Jo&&!C?d-o*2:R;t.lineTo(N+Math.round(I),L),t.lineWidth=a/15;const Z=this._getLinearGradient();t.strokeStyle=Z||m,t.stroke(),t.restore()}if(h!==tb&&(p!==0||f===Jo||g)){const $=M.split(" ").length-1,N=br(M);for(let L=0;L<N.length;L++){const I=N[L];if(I===" "&&!C&&f===Jo&&(S+=(d-o*2-R)/$),this._partialTextX=S,this._partialTextY=y+k,this._partialText=I,g){t.save();const F=n.slice(0,v).reduce((et,K)=>et+br(K.text).length,0),z=L+F;g({char:I,index:z,x:S,y:y+k,lineIndex:v,column:L,isLastInLine:C,width:this.measureSize(I).width,context:t})}t.fillStrokeShape(this),g&&t.restore(),S+=this.measureSize(I).width+p}}else p!==0&&t.setAttr("letterSpacing",`${p}px`),this._partialTextX=S,this._partialTextY=y+k,this._partialText=M,t.fillStrokeShape(this);if(x){t.save(),t.beginPath();const $=rt.legacyTextRendering?0:-Math.round(a/4),N=f===Jo?0:S;t.moveTo(N,y+k+$);const L=f===Jo&&!C?d-o*2:R;t.lineTo(N+Math.round(L),y+k+$),t.lineWidth=a/15;const I=this._getLinearGradient();t.strokeStyle=I||m,t.stroke(),t.restore()}t.restore(),r>1&&(y+=l)}}_hitFunc(t){const e=this.getWidth(),s=this.getHeight();t.beginPath(),t.rect(0,0,e,s),t.closePath(),t.fillStrokeShape(this)}setText(t){const e=D._isString(t)?t:t==null?"":t+"";return this._setAttr(zM,e),this}getWidth(){return this.attrs.width===Ko||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Ko||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return D.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,s,n,r,o,a,l,c,h,u,f;let d=Lp(),p=this.fontSize(),g;d.save(),d.font=this._getContextFont(),g=d.measureText(t),d.restore();const m=p/100;return{actualBoundingBoxAscent:(e=g.actualBoundingBoxAscent)!==null&&e!==void 0?e:71.58203125*m,actualBoundingBoxDescent:(s=g.actualBoundingBoxDescent)!==null&&s!==void 0?s:0,actualBoundingBoxLeft:(n=g.actualBoundingBoxLeft)!==null&&n!==void 0?n:-7.421875*m,actualBoundingBoxRight:(r=g.actualBoundingBoxRight)!==null&&r!==void 0?r:75.732421875*m,alphabeticBaseline:(o=g.alphabeticBaseline)!==null&&o!==void 0?o:0,emHeightAscent:(a=g.emHeightAscent)!==null&&a!==void 0?a:100*m,emHeightDescent:(l=g.emHeightDescent)!==null&&l!==void 0?l:-20*m,fontBoundingBoxAscent:(c=g.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*m,fontBoundingBoxDescent:(h=g.fontBoundingBoxDescent)!==null&&h!==void 0?h:21*m,hangingBaseline:(u=g.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*m,ideographicBaseline:(f=g.ideographicBaseline)!==null&&f!==void 0?f:-21*m,width:g.width,height:p}}_getContextFont(){return this.fontStyle()+Hh+this.fontVariant()+Hh+(this.fontSize()+UM)+eE(this.fontFamily())}_addTextLine(t){this.align()===Jo&&(t=t.trim());const s=this._getTextWidth(t);return this.textArr.push({text:t,width:s,lastInParagraph:!1})}_getTextWidth(t){const e=this.letterSpacing(),s=t.length;return Lp().measureText(t).width+e*s}_setTextData(){let t=this.text().split(`
`),e=+this.fontSize(),s=0,n=this.lineHeight()*e,r=this.attrs.width,o=this.attrs.height,a=r!==Ko&&r!==void 0,l=o!==Ko&&o!==void 0,c=this.padding(),h=r-c*2,u=o-c*2,f=0,d=this.wrap(),p=d!==eb,g=d!==JM&&p,m=this.ellipsis();this.textArr=[],Lp().font=this._getContextFont();const O=m?this._getTextWidth(Dp):0;for(let b=0,x=t.length;b<x;++b){let v=t[b],y=this._getTextWidth(v);if(a&&y>h)for(;v.length>0;){let _=0,S=br(v).length,k="",A=0;for(;_<S;){const M=_+S>>>1,R=br(v),C=R.slice(0,M+1).join(""),$=this._getTextWidth(C);(m&&l&&f+n>u?$+O:$)<=h?(_=M+1,k=C,A=$):S=M}if(k){if(g){const C=br(v),$=br(k),N=C[$.length],L=N===Hh||N===Ky;let I;if(L&&A<=h)I=$.length;else{const Z=$.lastIndexOf(Hh),F=$.lastIndexOf(Ky);I=Math.max(Z,F)+1}I>0&&(_=I,k=C.slice(0,_).join(""),A=this._getTextWidth(k))}if(k=k.trimRight(),this._addTextLine(k),s=Math.max(s,A),f+=n,this._shouldHandleEllipsis(f)){this._tryToAddEllipsisToLastLine();break}if(v=br(v).slice(_).join("").trimLeft(),v.length>0&&(y=this._getTextWidth(v),y<=h)){this._addTextLine(v),f+=n,s=Math.max(s,y);break}}else break}else this._addTextLine(v),f+=n,s=Math.max(s,y),this._shouldHandleEllipsis(f)&&b<x-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&f+n>u)break}this.textHeight=e,this.textWidth=s}_shouldHandleEllipsis(t){const e=+this.fontSize(),s=this.lineHeight()*e,n=this.attrs.height,r=n!==Ko&&n!==void 0,o=this.padding(),a=n-o*2;return!(this.wrap()!==eb)||r&&t+s>a}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,e=t!==Ko&&t!==void 0,s=this.padding(),n=t-s*2,r=this.ellipsis(),o=this.textArr[this.textArr.length-1];!o||!r||(e&&(this._getTextWidth(o.text+Dp)<n||(o.text=o.text.slice(0,o.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+Dp))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}};ve.prototype._fillFunc=iE;ve.prototype._strokeFunc=sE;ve.prototype.className=jM;ve.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];ke(ve);T.overWriteSetter(ve,"width",PO());T.overWriteSetter(ve,"height",PO());T.addGetterSetter(ve,"direction",SS);T.addGetterSetter(ve,"fontFamily","Arial");T.addGetterSetter(ve,"fontSize",12,it());T.addGetterSetter(ve,"fontStyle",kS);T.addGetterSetter(ve,"fontVariant",kS);T.addGetterSetter(ve,"padding",0,it());T.addGetterSetter(ve,"align",wS);T.addGetterSetter(ve,"verticalAlign",GM);T.addGetterSetter(ve,"lineHeight",1,it());T.addGetterSetter(ve,"wrap",KM);T.addGetterSetter(ve,"ellipsis",!1,Gs());T.addGetterSetter(ve,"letterSpacing",0,it());T.addGetterSetter(ve,"text","",Wo());T.addGetterSetter(ve,"textDecoration","");T.addGetterSetter(ve,"charRenderFunc",void 0);const rE="",TS="normal";function PS(i){i.fillText(this.partialText,0,0)}function AS(i){i.strokeText(this.partialText,0,0)}class Ue extends J{constructor(t){super(t),this.dummyCanvas=D.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return fe.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t>e?null:fe.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=fe.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const e=this.textDecoration(),s=this.fill(),n=this.fontSize(),r=this.glyphInfo;e==="underline"&&t.beginPath();for(let o=0;o<r.length;o++){t.save();const a=r[o].p0;t.translate(a.x,a.y),t.rotate(r[o].rotation),this.partialText=r[o].text,t.fillStrokeShape(this),e==="underline"&&(o===0&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}e==="underline"&&(t.strokeStyle=s,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();const e=this.glyphInfo;if(e.length>=1){const s=e[0].p0;t.moveTo(s.x,s.y)}for(let s=0;s<e.length;s++){const n=e[s].p1;t.lineTo(n.x,n.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return D.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return ve.prototype.setText.call(this,t)}_getContextFont(){return ve.prototype._getContextFont.call(this)}_getTextSize(t){const s=this.dummyCanvas.getContext("2d");s.save(),s.font=this._getContextFont();const n=s.measureText(t);return s.restore(),{width:n.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=br(this.text()),e=[];let s=0;for(let u=0;u<t.length;u++)e.push({char:t[u],width:this._getTextSize(t[u]).width}),s+=e[u].width;const{height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=s,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),o=this.align(),a=this.kerningFunc(),l=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let c=0;o==="center"&&(c=Math.max(0,this.pathLength/2-l/2)),o==="right"&&(c=Math.max(0,this.pathLength-l));let h=c;for(let u=0;u<e.length;u++){const f=this._getPointAtLength(h);if(!f)return;const d=e[u].char;let p=e[u].width+r;if(d===" "&&o==="justify"){const v=this.text().split(" ").length-1;p+=(this.pathLength-l)/v}const g=this._getPointAtLength(h+p);if(!g)return;const m=fe.getLineLength(f.x,f.y,g.x,g.y);let O=0;if(a)try{O=a(e[u-1].char,d)*this.fontSize()}catch{O=0}f.x+=O,g.x+=O,this.textWidth+=O;const b=fe.getPointOnLine(O+m/2,f.x,f.y,g.x,g.y),x=Math.atan2(g.y-f.y,g.x-f.x);this.glyphInfo.push({transposeX:b.x,transposeY:b.y,text:t[u],rotation:x,p0:f,p1:g}),h+=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(c){t.push(c.p0.x),t.push(c.p0.y),t.push(c.p1.x),t.push(c.p1.y)});let e=t[0]||0,s=t[0]||0,n=t[1]||0,r=t[1]||0,o,a;for(let c=0;c<t.length/2;c++)o=t[c*2],a=t[c*2+1],e=Math.min(e,o),s=Math.max(s,o),n=Math.min(n,a),r=Math.max(r,a);const l=this.fontSize();return{x:e-l/2,y:n-l/2,width:s-e+l,height:r-n+l}}destroy(){return D.releaseCanvas(this.dummyCanvas),super.destroy()}}Ue.prototype._fillFunc=PS;Ue.prototype._strokeFunc=AS;Ue.prototype._fillFuncHit=PS;Ue.prototype._strokeFuncHit=AS;Ue.prototype.className="TextPath";Ue.prototype._attrsAffectingSize=["text","fontSize","data"];ke(Ue);T.addGetterSetter(Ue,"data");T.addGetterSetter(Ue,"fontFamily","Arial");T.addGetterSetter(Ue,"fontSize",12,it());T.addGetterSetter(Ue,"fontStyle",TS);T.addGetterSetter(Ue,"align","left");T.addGetterSetter(Ue,"letterSpacing",0,it());T.addGetterSetter(Ue,"textBaseline","middle");T.addGetterSetter(Ue,"fontVariant",TS);T.addGetterSetter(Ue,"text",rE);T.addGetterSetter(Ue,"textDecoration","");T.addGetterSetter(Ue,"kerningFunc",void 0);const MS="tr-konva",oE=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(i=>i+`.${MS}`).join(" "),ib="nodesRect",aE=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],lE={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},cE="ontouchstart"in rt._global;function hE(i,t,e){if(i==="rotater")return e;t+=D.degToRad(lE[i]||0);const s=(D.radToDeg(t)%360+360)%360;return D._inRange(s,315+22.5,360)||D._inRange(s,0,22.5)?"ns-resize":D._inRange(s,45-22.5,45+22.5)?"nesw-resize":D._inRange(s,90-22.5,90+22.5)?"ew-resize":D._inRange(s,135-22.5,135+22.5)?"nwse-resize":D._inRange(s,180-22.5,180+22.5)?"ns-resize":D._inRange(s,225-22.5,225+22.5)?"nesw-resize":D._inRange(s,270-22.5,270+22.5)?"ew-resize":D._inRange(s,315-22.5,315+22.5)?"nwse-resize":(D.error("Transformer has unknown angle for cursor detection: "+s),"pointer")}const Nf=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function uE(i){return{x:i.x+i.width/2*Math.cos(i.rotation)+i.height/2*Math.sin(-i.rotation),y:i.y+i.height/2*Math.cos(i.rotation)+i.width/2*Math.sin(i.rotation)}}function ES(i,t,e){const s=e.x+(i.x-e.x)*Math.cos(t)-(i.y-e.y)*Math.sin(t),n=e.y+(i.x-e.x)*Math.sin(t)+(i.y-e.y)*Math.cos(t);return{...i,rotation:i.rotation+t,x:s,y:n}}function fE(i,t){const e=uE(i);return ES(i,t,e)}function dE(i,t,e){let s=t;for(let n=0;n<i.length;n++){const r=rt.getAngle(i[n]),o=Math.abs(r-t)%(Math.PI*2);Math.min(o,Math.PI*2-o)<e&&(s=r)}return s}let cm=0;class Ft extends Va{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(oE,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return D.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return MS+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(n=>n.isAncestorOf(this)?(D.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(n=>{const r=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(n._attrsAffectingSize.length){const o=n._attrsAffectingSize.map(a=>a+"Change."+this._getEventNamespace()).join(" ");n.on(o,r)}n.on(aE.map(o=>o+`.${this._getEventNamespace()}`).join(" "),r),n.on(`absoluteTransformChange.${this._getEventNamespace()}`,r),this._proxyDrag(n)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,s=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(s,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,s=>{if(!e)return;const n=t.getAbsolutePosition(),r=n.x-e.x,o=n.y-e.y;this.nodes().forEach(a=>{if(a===t||a.isDragging())return;const l=a.getAbsolutePosition();a.setAbsolutePosition({x:l.x+r,y:l.y+o}),a.startDrag(s)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(ib),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(ib,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),s){const n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(s),o=t.getAbsolutePosition(s),a=n.x*r.x-t.offsetX()*r.x,l=n.y*r.y-t.offsetY()*r.y,c=(rt.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),h={x:o.x+a*Math.cos(c)+l*Math.sin(-c),y:o.y+l*Math.cos(c)+a*Math.sin(c),width:n.width*r.x,height:n.height*r.y,rotation:c};return ES(h,-rt.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const e=[];this.nodes().map(c=>{const h=c.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),u=[{x:h.x,y:h.y},{x:h.x+h.width,y:h.y},{x:h.x+h.width,y:h.y+h.height},{x:h.x,y:h.y+h.height}],f=c.getAbsoluteTransform();u.forEach(function(d){const p=f.point(d);e.push(p)})});const s=new rs;s.rotate(-rt.getAngle(this.rotation()));let n=1/0,r=1/0,o=-1/0,a=-1/0;e.forEach(function(c){const h=s.point(c);n===void 0&&(n=o=h.x,r=a=h.y),n=Math.min(n,h.x),r=Math.min(r,h.y),o=Math.max(o,h.x),a=Math.max(a,h.y)}),s.invert();const l=s.point({x:n,y:r});return{x:l.x,y:l.y,width:o-n,height:a-r,rotation:rt.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Nf.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const e=new dh({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:cE?10:"auto"}),s=this;e.on("mousedown touchstart",function(n){s._handleMouseDown(n)}),e.on("dragstart",n=>{e.stopDrag(),n.cancelBubble=!0}),e.on("dragend",n=>{n.cancelBubble=!0}),e.on("mouseenter",()=>{const n=rt.getAngle(this.rotation()),r=this.rotateAnchorCursor(),o=hE(t,n,r);e.getStage().content&&(e.getStage().content.style.cursor=o),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){const t=new J({name:"back",width:0,height:0,sceneFunc(e,s){const n=s.getParent(),r=n.padding();e.beginPath(),e.rect(-r,-r,s.width()+r*2,s.height()+r*2),e.moveTo(s.width()/2,-r),n.rotateEnabled()&&n.rotateLineVisible()&&e.lineTo(s.width()/2,-n.rotateAnchorOffset()*D._sign(s.height())-r),e.fillStrokeShape(s)},hitFunc:(e,s)=>{if(!this.shouldOverdrawWholeArea())return;const n=this.padding();e.beginPath(),e.rect(-n,-n,s.width()+n*2,s.height()+n*2),e.fillStrokeShape(s)}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const e=this._getNodeRect(),s=e.width,n=e.height,r=Math.sqrt(Math.pow(s,2)+Math.pow(n,2));this.sin=Math.abs(n/r),this.cos=Math.abs(s/r),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const o=t.target.getAbsolutePosition(),a=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:a.x-o.x,y:a.y-o.y},cm++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:t.evt,target:l})})}_handleMouseMove(t){let e,s,n;const r=this.findOne("."+this._movingAnchorName),o=r.getStage();o.setPointersPositions(t);const a=o.getPointerPosition();let l={x:a.x-this._anchorDragOffset.x,y:a.y-this._anchorDragOffset.y};const c=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(c,l,t)),r.setAbsolutePosition(l);const h=r.getAbsolutePosition();if(c.x===h.x&&c.y===h.y)return;if(this._movingAnchorName==="rotater"){const b=this._getNodeRect();e=r.x()-b.width/2,s=-r.y()+b.height/2;let x=Math.atan2(-s,e)+Math.PI/2;b.height<0&&(x-=Math.PI);const y=rt.getAngle(this.rotation())+x,_=rt.getAngle(this.rotationSnapTolerance()),k=dE(this.rotationSnaps(),y,_)-b.rotation,A=fE(b,k);this._fitNodesInto(A,t);return}const u=this.shiftBehavior();let f;u==="inverted"?f=this.keepRatio()&&!t.shiftKey:u==="none"?f=this.keepRatio():f=this.keepRatio()||t.shiftKey;let d=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(f){const b=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(b.x-r.x(),2)+Math.pow(b.y-r.y(),2));const x=this.findOne(".top-left").x()>b.x?-1:1,v=this.findOne(".top-left").y()>b.y?-1:1;e=n*this.cos*x,s=n*this.sin*v,this.findOne(".top-left").x(b.x-e),this.findOne(".top-left").y(b.y-s)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(r.y());else if(this._movingAnchorName==="top-right"){if(f){const b=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(r.x()-b.x,2)+Math.pow(b.y-r.y(),2));const x=this.findOne(".top-right").x()<b.x?-1:1,v=this.findOne(".top-right").y()>b.y?-1:1;e=n*this.cos*x,s=n*this.sin*v,this.findOne(".top-right").x(b.x+e),this.findOne(".top-right").y(b.y-s)}var p=r.position();this.findOne(".top-left").y(p.y),this.findOne(".bottom-right").x(p.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(r.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(r.x());else if(this._movingAnchorName==="bottom-left"){if(f){const b=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(b.x-r.x(),2)+Math.pow(r.y()-b.y,2));const x=b.x<r.x()?-1:1,v=r.y()<b.y?-1:1;e=n*this.cos*x,s=n*this.sin*v,r.x(b.x-e),r.y(b.y+s)}p=r.position(),this.findOne(".top-left").x(p.x),this.findOne(".bottom-right").y(p.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(r.y());else if(this._movingAnchorName==="bottom-right"){if(f){const b=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(r.x()-b.x,2)+Math.pow(r.y()-b.y,2));const x=this.findOne(".bottom-right").x()<b.x?-1:1,v=this.findOne(".bottom-right").y()<b.y?-1:1;e=n*this.cos*x,s=n*this.sin*v,this.findOne(".bottom-right").x(b.x+e),this.findOne(".bottom-right").y(b.y+s)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(d=this.centeredScaling()||t.altKey,d){const b=this.findOne(".top-left"),x=this.findOne(".bottom-right"),v=b.x(),y=b.y(),_=this.getWidth()-x.x(),S=this.getHeight()-x.y();x.move({x:-v,y:-y}),b.move({x:_,y:S})}const g=this.findOne(".top-left").getAbsolutePosition();e=g.x,s=g.y;const m=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),O=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:s,width:m,height:O,rotation:rt.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const s=this.getNode();cm--,this._fire("transformend",{evt:t,target:s}),(e=this.getLayer())===null||e===void 0||e.batchDraw(),s&&this._nodes.forEach(n=>{var r;n._fire("transformend",{evt:t,target:n}),(r=n.getLayer())===null||r===void 0||r.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,e){const s=this._getNodeRect(),n=1;if(D._inRange(t.width,-this.padding()*2-n,n)){this.update();return}if(D._inRange(t.height,-this.padding()*2-n,n)){this.update();return}const r=new rs;if(r.rotate(rt.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const f=r.point({x:-this.padding()*2,y:0});t.x+=f.x,t.y+=f.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const f=r.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const f=r.point({x:0,y:-this.padding()*2});t.x+=f.x,t.y+=f.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const f=r.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=f.x,this._anchorDragOffset.y-=f.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const f=this.boundBoxFunc()(s,t);f?t=f:D.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,a=new rs;a.translate(s.x,s.y),a.rotate(s.rotation),a.scale(s.width/o,s.height/o);const l=new rs,c=t.width/o,h=t.height/o;this.flipEnabled()===!1?(l.translate(t.x,t.y),l.rotate(t.rotation),l.translate(t.width<0?t.width:0,t.height<0?t.height:0),l.scale(Math.abs(c),Math.abs(h))):(l.translate(t.x,t.y),l.rotate(t.rotation),l.scale(c,h));const u=l.multiply(a.invert());this._nodes.forEach(f=>{var d;if(!f.getStage())return;const p=f.getParent().getAbsoluteTransform(),g=f.getTransform().copy();g.translate(f.offsetX(),f.offsetY());const m=new rs;m.multiply(p.copy().invert()).multiply(u).multiply(p).multiply(g);const O=m.decompose();f.setAttrs(O),(d=f.getLayer())===null||d===void 0||d.batchDraw()}),this.rotation(D._getRotation(t.rotation)),this._nodes.forEach(f=>{this._fire("transform",{evt:e,target:f}),f._fire("transform",{evt:e,target:f})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t;const e=this._getNodeRect();this.rotation(D._getRotation(e.rotation));const s=e.width,n=e.height,r=this.enabledAnchors(),o=this.resizeEnabled(),a=this.padding(),l=this.anchorSize(),c=this.find("._anchor");c.forEach(u=>{u.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+a,offsetY:l/2+a,visible:o&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:s/2,y:0,offsetY:l/2+a,visible:o&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:s,y:0,offsetX:l/2-a,offsetY:l/2+a,visible:o&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:l/2+a,visible:o&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:s,y:n/2,offsetX:l/2-a,visible:o&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:l/2+a,offsetY:l/2-a,visible:o&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:s/2,y:n,offsetY:l/2-a,visible:o&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:s,y:n,offsetX:l/2-a,offsetY:l/2-a,visible:o&&r.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:s/2,y:-this.rotateAnchorOffset()*D._sign(n)-a,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:s,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(u=>u.draggable()),x:0,y:0});const h=this.anchorStyleFunc();h&&c.forEach(u=>{h(u)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),Va.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return st.prototype.toObject.call(this)}clone(t){return st.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Ft.isTransforming=()=>cm>0;function pE(i){return i instanceof Array||D.warn("enabledAnchors value should be an array"),i instanceof Array&&i.forEach(function(t){Nf.indexOf(t)===-1&&D.warn("Unknown anchor name: "+t+". Available names are: "+Nf.join(", "))}),i||[]}Ft.prototype.className="Transformer";ke(Ft);T.addGetterSetter(Ft,"enabledAnchors",Nf,pE);T.addGetterSetter(Ft,"flipEnabled",!0,Gs());T.addGetterSetter(Ft,"resizeEnabled",!0);T.addGetterSetter(Ft,"anchorSize",10,it());T.addGetterSetter(Ft,"rotateEnabled",!0);T.addGetterSetter(Ft,"rotateLineVisible",!0);T.addGetterSetter(Ft,"rotationSnaps",[]);T.addGetterSetter(Ft,"rotateAnchorOffset",50,it());T.addGetterSetter(Ft,"rotateAnchorCursor","crosshair");T.addGetterSetter(Ft,"rotationSnapTolerance",5,it());T.addGetterSetter(Ft,"borderEnabled",!0);T.addGetterSetter(Ft,"anchorStroke","rgb(0, 161, 255)");T.addGetterSetter(Ft,"anchorStrokeWidth",1,it());T.addGetterSetter(Ft,"anchorFill","white");T.addGetterSetter(Ft,"anchorCornerRadius",0,it());T.addGetterSetter(Ft,"borderStroke","rgb(0, 161, 255)");T.addGetterSetter(Ft,"borderStrokeWidth",1,it());T.addGetterSetter(Ft,"borderDash");T.addGetterSetter(Ft,"keepRatio",!0);T.addGetterSetter(Ft,"shiftBehavior","default");T.addGetterSetter(Ft,"centeredScaling",!1);T.addGetterSetter(Ft,"ignoreStroke",!1);T.addGetterSetter(Ft,"padding",0,it());T.addGetterSetter(Ft,"nodes");T.addGetterSetter(Ft,"node");T.addGetterSetter(Ft,"boundBoxFunc");T.addGetterSetter(Ft,"anchorDragBoundFunc");T.addGetterSetter(Ft,"anchorStyleFunc");T.addGetterSetter(Ft,"shouldOverdrawWholeArea",!1);T.addGetterSetter(Ft,"useSingleNodeRotation",!0);T.backCompat(Ft,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class hr extends J{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,rt.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}hr.prototype.className="Wedge";hr.prototype._centroid=!0;hr.prototype._attrsAffectingSize=["radius"];ke(hr);T.addGetterSetter(hr,"radius",0,it());T.addGetterSetter(hr,"angle",0,it());T.addGetterSetter(hr,"clockwise",!1);T.backCompat(hr,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function sb(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const gE=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],mE=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function OE(i,t){const e=i.data,s=i.width,n=i.height;let r,o,a,l,c,h,u,f,d,p,g,m,O,b,x,v,y,_,S,k;const A=t+t+1,M=s-1,R=n-1,C=t+1,$=C*(C+1)/2,N=new sb,L=gE[t],I=mE[t];let Z=null,F=N,z=null,et=null;for(let K=1;K<A;K++)F=F.next=new sb,K===C&&(Z=F);F.next=N,a=o=0;for(let K=0;K<n;K++){m=O=b=x=l=c=h=u=0,f=C*(v=e[o]),d=C*(y=e[o+1]),p=C*(_=e[o+2]),g=C*(S=e[o+3]),l+=$*v,c+=$*y,h+=$*_,u+=$*S,F=N;for(let ot=0;ot<C;ot++)F.r=v,F.g=y,F.b=_,F.a=S,F=F.next;for(let ot=1;ot<C;ot++)r=o+((M<ot?M:ot)<<2),l+=(F.r=v=e[r])*(k=C-ot),c+=(F.g=y=e[r+1])*k,h+=(F.b=_=e[r+2])*k,u+=(F.a=S=e[r+3])*k,m+=v,O+=y,b+=_,x+=S,F=F.next;z=N,et=Z;for(let ot=0;ot<s;ot++)e[o+3]=S=u*L>>I,S!==0?(S=255/S,e[o]=(l*L>>I)*S,e[o+1]=(c*L>>I)*S,e[o+2]=(h*L>>I)*S):e[o]=e[o+1]=e[o+2]=0,l-=f,c-=d,h-=p,u-=g,f-=z.r,d-=z.g,p-=z.b,g-=z.a,r=a+((r=ot+t+1)<M?r:M)<<2,m+=z.r=e[r],O+=z.g=e[r+1],b+=z.b=e[r+2],x+=z.a=e[r+3],l+=m,c+=O,h+=b,u+=x,z=z.next,f+=v=et.r,d+=y=et.g,p+=_=et.b,g+=S=et.a,m-=v,O-=y,b-=_,x-=S,et=et.next,o+=4;a+=s}for(let K=0;K<s;K++){O=b=x=m=c=h=u=l=0,o=K<<2,f=C*(v=e[o]),d=C*(y=e[o+1]),p=C*(_=e[o+2]),g=C*(S=e[o+3]),l+=$*v,c+=$*y,h+=$*_,u+=$*S,F=N;for(let Mt=0;Mt<C;Mt++)F.r=v,F.g=y,F.b=_,F.a=S,F=F.next;let ot=s;for(let Mt=1;Mt<=t;Mt++)o=ot+K<<2,l+=(F.r=v=e[o])*(k=C-Mt),c+=(F.g=y=e[o+1])*k,h+=(F.b=_=e[o+2])*k,u+=(F.a=S=e[o+3])*k,m+=v,O+=y,b+=_,x+=S,F=F.next,Mt<R&&(ot+=s);o=K,z=N,et=Z;for(let Mt=0;Mt<n;Mt++)r=o<<2,e[r+3]=S=u*L>>I,S>0?(S=255/S,e[r]=(l*L>>I)*S,e[r+1]=(c*L>>I)*S,e[r+2]=(h*L>>I)*S):e[r]=e[r+1]=e[r+2]=0,l-=f,c-=d,h-=p,u-=g,f-=z.r,d-=z.g,p-=z.b,g-=z.a,r=K+((r=Mt+C)<R?r:R)*s<<2,l+=m+=z.r=e[r],c+=O+=z.g=e[r+1],h+=b+=z.b=e[r+2],u+=x+=z.a=e[r+3],z=z.next,f+=v=et.r,d+=y=et.g,p+=_=et.b,g+=S=et.a,m-=v,O-=y,b-=_,x-=S,et=et.next,o+=s}}const yE=function(t){const e=Math.round(this.blurRadius());e>0&&OE(t,e)};T.addGetterSetter(st,"blurRadius",0,it(),T.afterSetFilter);const bE=function(i){const t=this.brightness()*255,e=i.data,s=e.length;for(let n=0;n<s;n+=4)e[n]+=t,e[n+1]+=t,e[n+2]+=t};T.addGetterSetter(st,"brightness",0,it(),T.afterSetFilter);const vE=function(i){const t=this.brightness(),e=i.data,s=e.length;for(let n=0;n<s;n+=4)e[n]=Math.min(255,e[n]*t),e[n+1]=Math.min(255,e[n+1]*t),e[n+2]=Math.min(255,e[n+2]*t)},_E=function(i){const t=Math.pow((this.contrast()+100)/100,2),e=i.data,s=e.length;let n=150,r=150,o=150;for(let a=0;a<s;a+=4)n=e[a],r=e[a+1],o=e[a+2],n/=255,n-=.5,n*=t,n+=.5,n*=255,r/=255,r-=.5,r*=t,r+=.5,r*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,n=n<0?0:n>255?255:n,r=r<0?0:r>255?255:r,o=o<0?0:o>255?255:o,e[a]=n,e[a+1]=r,e[a+2]=o};T.addGetterSetter(st,"contrast",0,it(),T.afterSetFilter);const xE=function(i){var t,e,s,n,r,o,a,l,c;const h=i.data,u=i.width,f=i.height,d=Math.min(1,Math.max(0,(e=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&e!==void 0?e:.5)),p=Math.min(1,Math.max(0,(n=(s=this.embossWhiteLevel)===null||s===void 0?void 0:s.call(this))!==null&&n!==void 0?n:.5)),m=(a={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(o=(r=this.embossDirection)===null||r===void 0?void 0:r.call(this))!==null&&o!==void 0?o:"top-left"])!==null&&a!==void 0?a:315,O=!!((c=(l=this.embossBlend)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0&&c),b=d*10,x=p*255,v=m*Math.PI/180,y=Math.cos(v),_=Math.sin(v),S=128/1020*b,k=new Uint8ClampedArray(h),A=new Float32Array(u*f);for(let N=0,L=0;L<h.length;L+=4,N++)A[N]=.2126*k[L]+.7152*k[L+1]+.0722*k[L+2];const M=[-1,0,1,-2,0,2,-1,0,1],R=[-1,-2,-1,0,0,0,1,2,1],C=[-u-1,-u,-u+1,-1,0,1,u-1,u,u+1],$=N=>N<0?0:N>255?255:N;for(let N=1;N<f-1;N++)for(let L=1;L<u-1;L++){const I=N*u+L;let Z=0,F=0;Z+=A[I+C[0]]*M[0],F+=A[I+C[0]]*R[0],Z+=A[I+C[1]]*M[1],F+=A[I+C[1]]*R[1],Z+=A[I+C[2]]*M[2],F+=A[I+C[2]]*R[2],Z+=A[I+C[3]]*M[3],F+=A[I+C[3]]*R[3],Z+=A[I+C[5]]*M[5],F+=A[I+C[5]]*R[5],Z+=A[I+C[6]]*M[6],F+=A[I+C[6]]*R[6],Z+=A[I+C[7]]*M[7],F+=A[I+C[7]]*R[7],Z+=A[I+C[8]]*M[8],F+=A[I+C[8]]*R[8];const z=y*Z+_*F,et=$(x+z*S),K=I*4;if(O){const ot=et-x;h[K]=$(k[K]+ot),h[K+1]=$(k[K+1]+ot),h[K+2]=$(k[K+2]+ot),h[K+3]=k[K+3]}else h[K]=h[K+1]=h[K+2]=et,h[K+3]=k[K+3]}for(let N=0;N<u;N++){let L=N*4,I=((f-1)*u+N)*4;h[L]=k[L],h[L+1]=k[L+1],h[L+2]=k[L+2],h[L+3]=k[L+3],h[I]=k[I],h[I+1]=k[I+1],h[I+2]=k[I+2],h[I+3]=k[I+3]}for(let N=1;N<f-1;N++){let L=N*u*4,I=(N*u+(u-1))*4;h[L]=k[L],h[L+1]=k[L+1],h[L+2]=k[L+2],h[L+3]=k[L+3],h[I]=k[I],h[I+1]=k[I+1],h[I+2]=k[I+2],h[I+3]=k[I+3]}return i};T.addGetterSetter(st,"embossStrength",.5,it(),T.afterSetFilter);T.addGetterSetter(st,"embossWhiteLevel",.5,it(),T.afterSetFilter);T.addGetterSetter(st,"embossDirection","top-left",void 0,T.afterSetFilter);T.addGetterSetter(st,"embossBlend",!1,void 0,T.afterSetFilter);function Vp(i,t,e,s,n){const r=e-t,o=n-s;if(r===0)return s+o/2;if(o===0)return s;let a=(i-t)/r;return a=o*a+s,a}const SE=function(i){const t=i.data,e=t.length;let s=t[0],n=s,r,o=t[1],a=o,l,c=t[2],h=c,u;const f=this.enhance();if(f===0)return;for(let x=0;x<e;x+=4)r=t[x+0],r<s?s=r:r>n&&(n=r),l=t[x+1],l<o?o=l:l>a&&(a=l),u=t[x+2],u<c?c=u:u>h&&(h=u);n===s&&(n=255,s=0),a===o&&(a=255,o=0),h===c&&(h=255,c=0);let d,p,g,m,O,b;if(f>0)d=n+f*(255-n),p=s-f*(s-0),g=a+f*(255-a),m=o-f*(o-0),O=h+f*(255-h),b=c-f*(c-0);else{const x=(n+s)*.5;d=n+f*(n-x),p=s+f*(s-x);const v=(a+o)*.5;g=a+f*(a-v),m=o+f*(o-v);const y=(h+c)*.5;O=h+f*(h-y),b=c+f*(c-y)}for(let x=0;x<e;x+=4)t[x+0]=Vp(t[x+0],s,n,p,d),t[x+1]=Vp(t[x+1],o,a,m,g),t[x+2]=Vp(t[x+2],c,h,b,O)};T.addGetterSetter(st,"enhance",0,it(),T.afterSetFilter);const wE=function(i){const t=i.data,e=t.length;for(let s=0;s<e;s+=4){const n=.34*t[s]+.5*t[s+1]+.16*t[s+2];t[s]=n,t[s+1]=n,t[s+2]=n}};T.addGetterSetter(st,"hue",0,it(),T.afterSetFilter);T.addGetterSetter(st,"saturation",0,it(),T.afterSetFilter);T.addGetterSetter(st,"luminance",0,it(),T.afterSetFilter);const kE=function(i){const t=i.data,e=t.length,s=1,n=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,o=this.luminance()*127,a=s*n*Math.cos(r*Math.PI/180),l=s*n*Math.sin(r*Math.PI/180),c=.299*s+.701*a+.167*l,h=.587*s-.587*a+.33*l,u=.114*s-.114*a-.497*l,f=.299*s-.299*a-.328*l,d=.587*s+.413*a+.035*l,p=.114*s-.114*a+.293*l,g=.299*s-.3*a+1.25*l,m=.587*s-.586*a-1.05*l,O=.114*s+.886*a-.2*l;let b,x,v,y;for(let _=0;_<e;_+=4)b=t[_+0],x=t[_+1],v=t[_+2],y=t[_+3],t[_+0]=c*b+h*x+u*v+o,t[_+1]=f*b+d*x+p*v+o,t[_+2]=g*b+m*x+O*v+o,t[_+3]=y},CE=function(i){const t=i.data,e=t.length,s=Math.pow(2,this.value()),n=Math.pow(2,this.saturation()),r=Math.abs(this.hue()+360)%360,o=s*n*Math.cos(r*Math.PI/180),a=s*n*Math.sin(r*Math.PI/180),l=.299*s+.701*o+.167*a,c=.587*s-.587*o+.33*a,h=.114*s-.114*o-.497*a,u=.299*s-.299*o-.328*a,f=.587*s+.413*o+.035*a,d=.114*s-.114*o+.293*a,p=.299*s-.3*o+1.25*a,g=.587*s-.586*o-1.05*a,m=.114*s+.886*o-.2*a;for(let O=0;O<e;O+=4){const b=t[O+0],x=t[O+1],v=t[O+2],y=t[O+3];t[O+0]=l*b+c*x+h*v,t[O+1]=u*b+f*x+d*v,t[O+2]=p*b+g*x+m*v,t[O+3]=y}};T.addGetterSetter(st,"hue",0,it(),T.afterSetFilter);T.addGetterSetter(st,"saturation",0,it(),T.afterSetFilter);T.addGetterSetter(st,"value",0,it(),T.afterSetFilter);const TE=function(i){const t=i.data,e=t.length;for(let s=0;s<e;s+=4)t[s]=255-t[s],t[s+1]=255-t[s+1],t[s+2]=255-t[s+2]},PE=function(i,t,e){const s=i.data,n=t.data,r=i.width,o=i.height,a=e.polarCenterX||r/2,l=e.polarCenterY||o/2;let c=Math.sqrt(a*a+l*l),h=r-a,u=o-l;const f=Math.sqrt(h*h+u*u);c=f>c?f:c;const d=o,p=r,g=360/p*Math.PI/180;for(let m=0;m<p;m+=1){const O=Math.sin(m*g),b=Math.cos(m*g);for(let x=0;x<d;x+=1){h=Math.floor(a+c*x/d*b),u=Math.floor(l+c*x/d*O);let v=(u*r+h)*4;const y=s[v+0],_=s[v+1],S=s[v+2],k=s[v+3];v=(m+x*r)*4,n[v+0]=y,n[v+1]=_,n[v+2]=S,n[v+3]=k}}},AE=function(i,t,e){const s=i.data,n=t.data,r=i.width,o=i.height,a=e.polarCenterX||r/2,l=e.polarCenterY||o/2;let c=Math.sqrt(a*a+l*l),h=r-a,u=o-l;const f=Math.sqrt(h*h+u*u);c=f>c?f:c;const d=o,p=r,g=0;let m,O;for(h=0;h<r;h+=1)for(u=0;u<o;u+=1){const b=h-a,x=u-l,v=Math.sqrt(b*b+x*x)*d/c;let y=(Math.atan2(x,b)*180/Math.PI+360+g)%360;y=y*p/360,m=Math.floor(y),O=Math.floor(v);let _=(O*r+m)*4;const S=s[_+0],k=s[_+1],A=s[_+2],M=s[_+3];_=(u*r+h)*4,n[_+0]=S,n[_+1]=k,n[_+2]=A,n[_+3]=M}},ME=function(i){const t=i.width,e=i.height;let s,n,r,o,a,l,c,h,u,f,d=Math.round(this.kaleidoscopePower());const p=Math.round(this.kaleidoscopeAngle()),g=Math.floor(t*(p%360)/360);if(d<1)return;const m=D.createCanvasElement();m.width=t,m.height=e;const O=m.getContext("2d").getImageData(0,0,t,e);D.releaseCanvas(m),PE(i,O,{polarCenterX:t/2,polarCenterY:e/2});let b=t/Math.pow(2,d);for(;b<=8;)b=b*2,d-=1;b=Math.ceil(b);let x=b,v=0,y=x,_=1;for(g+b>t&&(v=x,y=0,_=-1),n=0;n<e;n+=1)for(s=v;s!==y;s+=_)r=Math.round(s+g)%t,u=(t*n+r)*4,a=O.data[u+0],l=O.data[u+1],c=O.data[u+2],h=O.data[u+3],f=(t*n+s)*4,O.data[f+0]=a,O.data[f+1]=l,O.data[f+2]=c,O.data[f+3]=h;for(n=0;n<e;n+=1)for(x=Math.floor(b),o=0;o<d;o+=1){for(s=0;s<x+1;s+=1)u=(t*n+s)*4,a=O.data[u+0],l=O.data[u+1],c=O.data[u+2],h=O.data[u+3],f=(t*n+x*2-s-1)*4,O.data[f+0]=a,O.data[f+1]=l,O.data[f+2]=c,O.data[f+3]=h;x*=2}AE(O,i,{})};T.addGetterSetter(st,"kaleidoscopePower",2,it(),T.afterSetFilter);T.addGetterSetter(st,"kaleidoscopeAngle",0,it(),T.afterSetFilter);function Jh(i,t,e){let s=(e*i.width+t)*4;const n=[];return n.push(i.data[s++],i.data[s++],i.data[s++],i.data[s++]),n}function vl(i,t){return Math.sqrt(Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)+Math.pow(i[2]-t[2],2))}function EE(i){const t=[0,0,0];for(let e=0;e<i.length;e++)t[0]+=i[e][0],t[1]+=i[e][1],t[2]+=i[e][2];return t[0]/=i.length,t[1]/=i.length,t[2]/=i.length,t}function RE(i,t){const e=Jh(i,0,0),s=Jh(i,i.width-1,0),n=Jh(i,0,i.height-1),r=Jh(i,i.width-1,i.height-1),o=t||10;if(vl(e,s)<o&&vl(s,r)<o&&vl(r,n)<o&&vl(n,e)<o){const a=EE([s,e,r,n]),l=[];for(let c=0;c<i.width*i.height;c++){const h=vl(a,[i.data[c*4],i.data[c*4+1],i.data[c*4+2]]);l[c]=h<o?0:255}return l}}function QE(i,t){for(let e=0;e<i.width*i.height;e++)i.data[4*e+3]=t[e]}function IE(i,t,e){const s=[1,1,1,1,0,1,1,1,1],n=Math.round(Math.sqrt(s.length)),r=Math.floor(n/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let u=0;u<n;u++)for(let f=0;f<n;f++){const d=a+u-r,p=l+f-r;if(d>=0&&d<e&&p>=0&&p<t){const g=d*t+p,m=s[u*n+f];h+=i[g]*m}}o[c]=h===2040?255:0}return o}function $E(i,t,e){const s=[1,1,1,1,1,1,1,1,1],n=Math.round(Math.sqrt(s.length)),r=Math.floor(n/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let u=0;u<n;u++)for(let f=0;f<n;f++){const d=a+u-r,p=l+f-r;if(d>=0&&d<e&&p>=0&&p<t){const g=d*t+p,m=s[u*n+f];h+=i[g]*m}}o[c]=h>=1020?255:0}return o}function NE(i,t,e){const s=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],n=Math.round(Math.sqrt(s.length)),r=Math.floor(n/2),o=[];for(let a=0;a<e;a++)for(let l=0;l<t;l++){const c=a*t+l;let h=0;for(let u=0;u<n;u++)for(let f=0;f<n;f++){const d=a+u-r,p=l+f-r;if(d>=0&&d<e&&p>=0&&p<t){const g=d*t+p,m=s[u*n+f];h+=i[g]*m}}o[c]=h}return o}const DE=function(i){const t=this.threshold();let e=RE(i,t);return e&&(e=IE(e,i.width,i.height),e=$E(e,i.width,i.height),e=NE(e,i.width,i.height),QE(i,e)),i};T.addGetterSetter(st,"threshold",0,it(),T.afterSetFilter);const LE=function(i){const t=this.noise()*255,e=i.data,s=e.length,n=t/2;for(let r=0;r<s;r+=4)e[r+0]+=n-2*n*Math.random(),e[r+1]+=n-2*n*Math.random(),e[r+2]+=n-2*n*Math.random()};T.addGetterSetter(st,"noise",.2,it(),T.afterSetFilter);const VE=function(i){let t=Math.ceil(this.pixelSize()),e=i.width,s=i.height,n=Math.ceil(e/t),r=Math.ceil(s/t),o=i.data;if(t<=0){D.error("pixelSize value can not be <= 0");return}for(let a=0;a<n;a+=1)for(let l=0;l<r;l+=1){let c=0,h=0,u=0,f=0;const d=a*t,p=d+t,g=l*t,m=g+t;let O=0;for(let b=d;b<p;b+=1)if(!(b>=e))for(let x=g;x<m;x+=1){if(x>=s)continue;const v=(e*x+b)*4;c+=o[v+0],h+=o[v+1],u+=o[v+2],f+=o[v+3],O+=1}c=c/O,h=h/O,u=u/O,f=f/O;for(let b=d;b<p;b+=1)if(!(b>=e))for(let x=g;x<m;x+=1){if(x>=s)continue;const v=(e*x+b)*4;o[v+0]=c,o[v+1]=h,o[v+2]=u,o[v+3]=f}}};T.addGetterSetter(st,"pixelSize",8,it(),T.afterSetFilter);const BE=function(i){const t=Math.round(this.levels()*254)+1,e=i.data,s=e.length,n=255/t;for(let r=0;r<s;r+=1)e[r]=Math.floor(e[r]/n)*n};T.addGetterSetter(st,"levels",.5,it(),T.afterSetFilter);const ZE=function(i){const t=i.data,e=t.length,s=this.red(),n=this.green(),r=this.blue();for(let o=0;o<e;o+=4){const a=(.34*t[o]+.5*t[o+1]+.16*t[o+2])/255;t[o]=a*s,t[o+1]=a*n,t[o+2]=a*r,t[o+3]=t[o+3]}};T.addGetterSetter(st,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});T.addGetterSetter(st,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});T.addGetterSetter(st,"blue",0,eS,T.afterSetFilter);const FE=function(i){const t=i.data,e=t.length,s=this.red(),n=this.green(),r=this.blue(),o=this.alpha();for(let a=0;a<e;a+=4){const l=1-o;t[a]=s*o+t[a]*l,t[a+1]=n*o+t[a+1]*l,t[a+2]=r*o+t[a+2]*l}};T.addGetterSetter(st,"red",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});T.addGetterSetter(st,"green",0,function(i){return this._filterUpToDate=!1,i>255?255:i<0?0:Math.round(i)});T.addGetterSetter(st,"blue",0,eS,T.afterSetFilter);T.addGetterSetter(st,"alpha",1,function(i){return this._filterUpToDate=!1,i>1?1:i<0?0:i});const WE=function(i){const t=i.data,e=t.length;for(let s=0;s<e;s+=4){const n=t[s+0],r=t[s+1],o=t[s+2];t[s+0]=Math.min(255,n*.393+r*.769+o*.189),t[s+1]=Math.min(255,n*.349+r*.686+o*.168),t[s+2]=Math.min(255,n*.272+r*.534+o*.131)}},qE=function(i){const e=i.data;for(let s=0;s<e.length;s+=4){const n=e[s],r=e[s+1],o=e[s+2];.2126*n+.7152*r+.0722*o>=128&&(e[s]=255-n,e[s+1]=255-r,e[s+2]=255-o)}return i},XE=function(i){const t=this.threshold()*255,e=i.data,s=e.length;for(let n=0;n<s;n+=1)e[n]=e[n]<t?0:255};T.addGetterSetter(st,"threshold",.5,it(),T.afterSetFilter);const hi=zy.Util._assign(zy,{Arc:lr,Arrow:Xo,Circle:nl,Ellipse:eo,Image:Ts,Label:EO,Tag:zo,Line:cr,Path:fe,Rect:dh,RegularPolygon:io,Ring:jo,Sprite:Pn,Star:so,Text:ve,TextPath:Ue,Transformer:Ft,Wedge:hr,Filters:{Blur:yE,Brightness:vE,Brighten:bE,Contrast:_E,Emboss:xE,Enhance:SE,Grayscale:wE,HSL:kE,HSV:CE,Invert:TE,Kaleidoscope:ME,Mask:DE,Noise:LE,Pixelate:VE,Posterize:BE,RGB:ZE,RGBA:FE,Sepia:WE,Solarize:qE,Threshold:XE}}),zE=()=>({stage:void 0,konvaContainer:void 0,notes:new Map,selection:{selectedIds:new Set,selectionRect:void 0},viewport:{scrollX:0,scrollY:1100,zoomX:1,zoomY:1},grid:{quarterNoteWidth:120,noteHeight:20,baseQuarterNoteWidth:120,baseNoteHeight:20,subdivision:16,numMeasures:100,timeSignature:4,maxLength:64,backgroundColor1:"#ddd",backgroundColor2:"#bbb",noteColor:"#f23",selectedNoteColor:"#2ee"},interaction:{isDragging:!1,dragStartPos:void 0,draggedNoteInitialStates:new Map,quantDragActivated:!1,dragBeforeState:void 0,isResizing:!1,resizeTargetId:void 0,resizeIsEnd:!1,resizeInitialStates:new Map,quantResizeActivated:!1,resizeBeforeState:void 0,isMarqueeSelecting:!1,marqueeStart:void 0,marqueeCurrent:void 0,marqueeIsShift:!1,hiddenNoteIds:new Set,truncatedNotes:new Map,createEmptyOverlapAdjustments:()=>({toDelete:new Set,toTruncate:new Map})},command:{stack:void 0},layers:{grid:void 0,notes:void 0,overlay:void 0},renderCache:{grid:{lastScrollX:-1,lastScrollY:-1,lastSubdivision:-1,lastQuarterNoteWidth:-1,lastNoteHeight:-1}},needsRedraw:!1,rafHandle:void 0,queuePlayhead:{position:0,element:void 0},livePlayhead:{position:0,element:void 0},notifyExternalChange:void 0}),jE=(i="note_")=>`${i}${Date.now()}_${Math.random().toString(36).substr(2,9)}`;function nb(i,t){const{scrollX:e,scrollY:s}=t.viewport,{quarterNoteWidth:n,noteHeight:r}=t.grid,o=i.x+e,a=i.y+s,l=o/n;return{pitch:127-Math.floor(a/r),position:l}}function Df(i,t,e){const{scrollX:s,scrollY:n}=e.viewport,{quarterNoteWidth:r,noteHeight:o}=e.grid,a=t*r,l=(127-i)*o;return{x:a-s,y:l-n}}function rb(i,t){const e=t/4;return Math.floor(i*e)/e}function RS(i){return i.grid.quarterNoteWidth*(4/i.grid.subdivision)}function QS(i,t){const{scrollX:e,scrollY:s}=t.viewport,{quarterNoteWidth:n,noteHeight:r}=t.grid,o=t.stage;if(!o)return!1;const a=o.width(),l=o.height(),c=e/n,h=(e+a)/n,u=Math.floor(s/r),f=Math.ceil((s+l)/r),d=i.position+i.duration,p=127-i.pitch;return!(d<c||i.position>h||p<u||p>f)}function GE(i,t){const{quarterNoteWidth:e,noteHeight:s}=i.grid,n=[];return i.notes.forEach((r,o)=>{const a=Df(r.pitch,r.position,i),l=r.duration*e,c=a.x+l,h=a.y+s,u=t.x+t.width,f=t.y+t.height;!(c<t.x||a.x>u||h<t.y||a.y>f)&&n.push(o)}),n}function IS(i,t){const e=new Set(t);if(e.size===0)return i.interaction.createEmptyOverlapAdjustments();const s=new Set,n=new Map;return e.forEach(r=>{const o=i.notes.get(r);if(!o)return;const a=o.position+o.duration;i.notes.forEach((l,c)=>{if(e.has(c)||l.pitch!==o.pitch)return;const h=l.position+l.duration;if(l.position<o.position&&o.position<h){const u=o.position-l.position;u>0?s.has(c)||n.set(c,u):(s.add(c),n.delete(c))}else o.position<=l.position&&l.position<a&&(s.add(c),n.delete(c))})}),s.size===0&&n.size===0?i.interaction.createEmptyOverlapAdjustments():{toDelete:s,toTruncate:n}}function $S(i){i.interaction.hiddenNoteIds.clear(),i.interaction.truncatedNotes.clear();const t=IS(i,i.selection.selectedIds);t.toDelete.forEach(e=>i.interaction.hiddenNoteIds.add(e)),t.toTruncate.forEach((e,s)=>i.interaction.truncatedNotes.set(s,e))}function YE(i,t,e){return i.interaction.truncatedNotes.get(t)??e}function RO(i,t){let e=null,s=!1;if(!t&&(i.interaction.hiddenNoteIds.size>0||i.interaction.truncatedNotes.size>0))e={toDelete:new Set(i.interaction.hiddenNoteIds),toTruncate:new Map(i.interaction.truncatedNotes)},s=!0;else{const n=t??i.selection.selectedIds;e=IS(i,n)}return e.toDelete.size===0&&e.toTruncate.size===0?(s||(i.interaction.hiddenNoteIds.clear(),i.interaction.truncatedNotes.clear()),e):(e.toDelete.forEach(n=>{i.notes.delete(n),i.selection.selectedIds.delete(n)}),e.toTruncate.forEach((n,r)=>{const o=i.notes.get(r);o&&(o.duration=Math.max(n,0))}),i.needsRedraw=!0,s||(i.interaction.hiddenNoteIds.clear(),i.interaction.truncatedNotes.clear()),e)}function NS(i){i.interaction.truncatedNotes.clear(),i.interaction.hiddenNoteIds.clear()}function UE(i){let e=null;for(const s of i.selection.selectedIds){const n=i.notes.get(s);if(!n)continue;let r=1/0,o=null;if(i.notes.forEach((a,l)=>{if(i.selection.selectedIds.has(l))return;const c=Math.abs(n.position-a.position);c<r&&c<.1&&(r=c,o=a.position)}),o!==null){e=o-n.position;break}}e!==null&&i.selection.selectedIds.forEach(s=>{const n=i.notes.get(s);n&&(n.position+=e)})}const HE=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function ob(i){const t=(i%12+12)%12;return(HE[t]??"C")+(Math.floor(i/12)-2)}class KE{constructor(t,e,s){this.captureState=t,this.restoreState=e,this.onChangeCallback=s}stack=[];currentIndex=-1;onChangeCallback;executeCommand(t,e){const s=this.captureState();e();const n=this.captureState();s!==n&&this.pushCommand(t,s,n)}pushCommand(t,e,s){this.stack=this.stack.slice(0,this.currentIndex+1),this.stack.push({name:t,beforeState:e,afterState:s}),this.currentIndex++,this.onChangeCallback?.()}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.stack.length-1}undo(){if(!this.canUndo())return;const t=this.stack[this.currentIndex];this.restoreState(t.beforeState),this.currentIndex--,this.onChangeCallback?.()}redo(){if(!this.canRedo())return;this.currentIndex++;const t=this.stack[this.currentIndex];this.restoreState(t.afterState),this.onChangeCallback?.()}clear(){this.stack=[],this.currentIndex=-1,this.onChangeCallback?.()}}function ph(i){return JSON.stringify({notes:Array.from(i.notes.entries()),selection:Array.from(i.selection.selectedIds)})}function JE(i,t){const e=JSON.parse(t);i.notes=new Map(e.notes),i.selection.selectedIds=new Set(e.selection),i.needsRedraw=!0}function tR(i,t){if(i.size!==t.size)return!0;for(const e of i)if(!t.has(e))return!0;return!1}function Bp(i,t){const e=new Set(i.selection.selectedIds);t();const s=tR(e,i.selection.selectedIds);return s&&i.notifyExternalChange?.(),s}function eR(i,t,e){const s=new hi.Layer({listening:!1,name:"grid-layer"});t.add(s),i.layers.grid=s;const n=new hi.Layer({name:"notes-layer"});t.add(n),i.layers.notes=n;const r=new hi.Layer({name:"overlay-layer"});t.add(r),i.layers.overlay=r,i.selection.selectionRect=new hi.Rect({stroke:"#4A90E2",strokeWidth:1,dash:[3,3],fill:"rgba(74, 144, 226, 0.1)",listening:!1,visible:!1}),r.add(i.selection.selectionRect);const o=128*i.grid.noteHeight;i.livePlayhead.element=new hi.Line({points:[0,0,0,o],stroke:"#ff8800",strokeWidth:2,listening:!1}),r.add(i.livePlayhead.element),i.queuePlayhead.element=new hi.Line({points:[0,0,0,o],stroke:"#33dd00",strokeWidth:2,listening:!1}),r.add(i.queuePlayhead.element),i.command.stack=new KE(()=>ph(i),a=>JE(i,a),()=>{i.needsRedraw=!0,e?.()})}function iR(i){const t=i.layers.grid;if(!t||!i.stage)return;const e=i.renderCache.grid;if(e.lastScrollX===i.viewport.scrollX&&e.lastScrollY===i.viewport.scrollY&&e.lastSubdivision===i.grid.subdivision&&e.lastQuarterNoteWidth===i.grid.quarterNoteWidth&&e.lastNoteHeight===i.grid.noteHeight)return;e.lastScrollX=i.viewport.scrollX,e.lastScrollY=i.viewport.scrollY,e.lastSubdivision=i.grid.subdivision,e.lastQuarterNoteWidth=i.grid.quarterNoteWidth,e.lastNoteHeight=i.grid.noteHeight,t.destroyChildren();const{scrollX:s,scrollY:n}=i.viewport,{quarterNoteWidth:r,noteHeight:o,numMeasures:a,timeSignature:l}=i.grid,c=i.stage,h=c.width(),u=c.height(),f=128*o,d=l*4,p=r*d,g=Math.floor(s/p),m=Math.ceil((s+h)/p);for(let S=g;S<=m&&S<a;S++){const k=S%2===0?i.grid.backgroundColor1:i.grid.backgroundColor2,A=S*p-s;t.add(new hi.Rect({x:A,y:-n,width:p,height:f,fill:k,listening:!1}))}const O=a*d*(i.grid.subdivision/4),b=r*(4/i.grid.subdivision),x=Math.floor(s/b),v=Math.ceil((s+h)/b);for(let S=x;S<=v&&S<O;S++){const k=S*b-s,M=S*b%r===0?1.8:1;t.add(new hi.Line({points:[k,-n,k,f-n],stroke:"#000",strokeWidth:M,listening:!1}))}const y=Math.floor(n/o),_=Math.ceil((n+u)/o);for(let S=y;S<=_&&S<128;S++){const k=S*o-n;t.add(new hi.Line({points:[0-s,k,a*p-s,k],stroke:"#000",strokeWidth:1,listening:!1}))}t.batchDraw()}function sR(i){const t=i.layers.notes;if(!t||!i.stage)return;t.destroyChildren();const{quarterNoteWidth:e,noteHeight:s}=i.grid,n=[],r=[];i.notes.forEach((o,a)=>{QS(o,i)&&(i.selection.selectedIds.has(a)?r.push([a,o]):n.push([a,o]))}),n.forEach(([o,a])=>{const l=Df(a.pitch,a.position,i),h=YE(i,o,a.duration)*e,u=i.interaction.hiddenNoteIds.has(o),f=new hi.Rect({x:l.x,y:l.y,width:h,height:s,fill:i.grid.noteColor,stroke:"#000",strokeWidth:1,opacity:u?.3:1,listening:!0});f.setAttr("noteId",o),t.add(f);const d=ob(a.pitch),p=new hi.Text({x:l.x+4,y:l.y+2,text:d,fontSize:14,fill:"#000",listening:!1});t.add(p)}),r.forEach(([o,a])=>{const l=Df(a.pitch,a.position,i),c=a.duration*e,h=i.interaction.hiddenNoteIds.has(o),u=new hi.Rect({x:l.x,y:l.y,width:c,height:s,fill:i.grid.selectedNoteColor,stroke:"#000",strokeWidth:1,opacity:h?.3:1,listening:!0});u.setAttr("noteId",o),t.add(u);const f=ob(a.pitch),d=new hi.Text({x:l.x+4,y:l.y+2,text:f,fontSize:14,fill:"#000",listening:!1});t.add(d)}),t.batchDraw()}function nR(i){const t=i.layers.notes;if(!t)return;const{quarterNoteWidth:e,noteHeight:s}=i.grid,n=5;t.find(".resize-handle").forEach(r=>r.destroy()),i.selection.selectedIds.forEach(r=>{const o=i.notes.get(r);if(!o||!QS(o,i))return;const a=Df(o.pitch,o.position,i),l=o.duration*e,c=new hi.Circle({x:a.x,y:a.y+s/2,radius:n,fill:"#000",listening:!0,name:"resize-handle"});c.setAttr("handleNoteId",r),c.setAttr("handleIsEnd",!1),t.add(c);const h=new hi.Circle({x:a.x+l,y:a.y+s/2,radius:n,fill:"#000",listening:!0,name:"resize-handle"});h.setAttr("handleNoteId",r),h.setAttr("handleIsEnd",!0),t.add(h)}),t.batchDraw()}function rR(i){if(!i.selection.selectionRect||!i.interaction.marqueeStart||!i.interaction.marqueeCurrent)return;const t=i.interaction.marqueeStart,e=i.interaction.marqueeCurrent,s=Math.min(t.x,e.x),n=Math.min(t.y,e.y),r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);i.selection.selectionRect.setAttrs({x:s,y:n,width:r,height:o,visible:r>5||o>5}),i.layers.overlay?.batchDraw()}function oR(i){if(!i.queuePlayhead.element)return;const{scrollX:t}=i.viewport,e=i.queuePlayhead.position*i.grid.quarterNoteWidth-t;i.queuePlayhead.element.x(e),i.layers.overlay?.batchDraw()}function aR(i){if(!i.livePlayhead.element)return;const{scrollX:t}=i.viewport,e=i.livePlayhead.position*i.grid.quarterNoteWidth-t;i.livePlayhead.element.x(e),i.layers.overlay?.batchDraw()}function lR(i,t){const e=i.layers.grid;t.on("dblclick",s=>{if(s.target===t||s.target.getLayer()===e){const n=t.getPointerPosition();if(!n)return;const{pitch:r,position:o}=nb(n,i),a=rb(o,i.grid.subdivision),l=Math.round(r);i.command.stack?.executeCommand("Add Note",()=>{const c={id:jE(),pitch:l,position:a,duration:4/i.grid.subdivision,velocity:.8};i.notes.set(c.id,c),i.needsRedraw=!0})}}),t.on("mousedown touchstart",s=>{const n=s.target,r=n.getAttr?.("handleNoteId");if(r){const a=n.getAttr("handleIsEnd");fR(i,t,r,a);return}const o=n.getAttr?.("noteId");if(o){const a=s.evt.shiftKey||s.evt.ctrlKey,l=i.selection.selectedIds.has(o);Bp(i,()=>{a?l?i.selection.selectedIds.delete(o):i.selection.selectedIds.add(o):(!l||i.selection.selectedIds.size>1)&&(i.selection.selectedIds.clear(),i.selection.selectedIds.add(o))}),cR(i,t),i.needsRedraw=!0;return}if(n===t||n.getLayer()===e){const a=t.getPointerPosition();if(!a)return;i.interaction.isMarqueeSelecting=!0,i.interaction.marqueeStart=a,i.interaction.marqueeCurrent=a,i.interaction.marqueeIsShift=s.evt.shiftKey||s.evt.ctrlKey,i.interaction.marqueeIsShift||Bp(i,()=>{i.selection.selectedIds.clear()}),i.needsRedraw=!0}}),t.on("mousemove touchmove",s=>{const n=t.getPointerPosition();if(n){if(i.interaction.isDragging){hR(i,t);return}if(i.interaction.isResizing){dR(i,t);return}if(i.interaction.isMarqueeSelecting){i.interaction.marqueeCurrent=n,rR(i);const r={x:Math.min(i.interaction.marqueeStart.x,n.x),y:Math.min(i.interaction.marqueeStart.y,n.y),width:Math.abs(n.x-i.interaction.marqueeStart.x),height:Math.abs(n.y-i.interaction.marqueeStart.y)},o=GE(i,r);Bp(i,()=>{i.interaction.marqueeIsShift?o.forEach(a=>{i.selection.selectedIds.add(a)}):(i.selection.selectedIds.clear(),o.forEach(a=>{i.selection.selectedIds.add(a)}))}),i.needsRedraw=!0}}}),t.on("mouseup touchend",s=>{if(i.interaction.isDragging){uR(i);return}if(i.interaction.isResizing){pR(i);return}if(i.interaction.isMarqueeSelecting){const n=i.interaction.marqueeStart&&i.interaction.marqueeCurrent&&Math.abs(i.interaction.marqueeStart.x-i.interaction.marqueeCurrent.x)<5&&Math.abs(i.interaction.marqueeStart.y-i.interaction.marqueeCurrent.y)<5;if(i.interaction.isMarqueeSelecting=!1,i.selection.selectionRect&&(i.selection.selectionRect.visible(!1),i.layers.overlay?.batchDraw()),n&&s.target===t||s.target.getLayer()===e){const r=t.getPointerPosition();if(r){const{position:o}=nb(r,i),a=rb(o,i.grid.subdivision);i.queuePlayhead.position=Math.max(0,Math.min(a,i.grid.maxLength)),i.needsRedraw=!0,i.notifyExternalChange?.()}}}})}function cR(i,t){const e=t.getPointerPosition();e&&(i.interaction.isDragging=!0,i.interaction.dragStartPos=e,i.interaction.quantDragActivated=!1,i.interaction.dragBeforeState=ph(i),i.interaction.draggedNoteInitialStates.clear(),i.selection.selectedIds.forEach(s=>{const n=i.notes.get(s);n&&i.interaction.draggedNoteInitialStates.set(s,{position:n.position,pitch:n.pitch})}))}function hR(i,t){const e=t.getPointerPosition();if(!e||!i.interaction.dragStartPos)return;const s=e.x-i.interaction.dragStartPos.x,n=e.y-i.interaction.dragStartPos.y,r=RS(i);let o;Math.abs(s)<r*.9&&!i.interaction.quantDragActivated?o=s:(o=Math.round(s/r)*r,i.interaction.quantDragActivated=!0);const a=Math.round(n/i.grid.noteHeight);i.interaction.draggedNoteInitialStates.forEach((l,c)=>{const h=i.notes.get(c);h&&(h.position=l.position+o/i.grid.quarterNoteWidth,h.pitch=Math.max(0,Math.min(127,l.pitch-a)))}),UE(i),$S(i),i.needsRedraw=!0}function uR(i){RO(i);const t=ph(i);i.interaction.dragBeforeState&&i.interaction.dragBeforeState!==t&&i.command.stack?.pushCommand("Move Notes",i.interaction.dragBeforeState,t),i.interaction.isDragging=!1,NS(i),i.needsRedraw=!0}function fR(i,t,e,s){const n=t.getPointerPosition();n&&(i.interaction.isResizing=!0,i.interaction.resizeTargetId=e,i.interaction.resizeIsEnd=s,i.interaction.quantResizeActivated=!1,i.interaction.dragStartPos=n,i.interaction.resizeBeforeState=ph(i),i.interaction.resizeInitialStates.clear(),i.selection.selectedIds.forEach(r=>{const o=i.notes.get(r);o&&i.interaction.resizeInitialStates.set(r,{position:o.position,duration:o.duration})}))}function dR(i,t){const e=t.getPointerPosition();if(!e||!i.interaction.dragStartPos)return;const s=e.x-i.interaction.dragStartPos.x,n=RS(i);let r;Math.abs(s)<n*.9&&!i.interaction.quantResizeActivated?r=s:(r=Math.round(s/n)*n,i.interaction.quantResizeActivated=!0);const o=r/i.grid.quarterNoteWidth;i.interaction.resizeInitialStates.forEach((a,l)=>{const c=i.notes.get(l);c&&(i.interaction.resizeIsEnd?c.duration=Math.max(.25,a.duration+o):(c.position=a.position+o,c.duration=Math.max(.25,a.duration-o)))}),$S(i),i.needsRedraw=!0}function pR(i){RO(i);const t=ph(i);i.interaction.resizeBeforeState&&i.interaction.resizeBeforeState!==t&&i.command.stack?.pushCommand("Resize Notes",i.interaction.resizeBeforeState,t),i.interaction.isResizing=!1,NS(i),i.needsRedraw=!0}const ta=.25,ea=1,_i=128,ab=4,lb=12,gR=55,se=(i,t,e)=>e<t?t:Math.min(Math.max(i,t),e),Ba=(i,t)=>i.stage?.width()??t,Za=(i,t)=>i.stage?.height()??t,mR=i=>i.grid.maxLength*i.grid.quarterNoteWidth,OR=i=>_i*i.grid.noteHeight,yR=(i,t)=>{i.grid.quarterNoteWidth=t,i.viewport.zoomX=t/i.grid.baseQuarterNoteWidth},bR=(i,t)=>{i.grid.noteHeight=t,i.viewport.zoomY=t/i.grid.baseNoteHeight},vR=(i,t)=>{const e=i.grid.quarterNoteWidth,s=Ba(i,t),n=e===0?0:i.viewport.scrollX/e,r=n+s/(e||1);return{startQuarter:n,endQuarter:r}},_R=(i,t)=>{const e=i.grid.noteHeight,s=Za(i,t),n=e===0?0:i.viewport.scrollY/e,r=n+s/(e||1);return{topIndex:n,bottomIndex:r}},QO=(i,t,e,s)=>{const n=Ba(i,t),r=Za(i,e),o=Math.max(0,mR(i)-n),a=se(i.viewport.scrollX,0,o);a!==i.viewport.scrollX&&(i.viewport.scrollX=a,i.needsRedraw=!0,s());const l=Math.max(0,OR(i)-r),c=se(i.viewport.scrollY,0,l);c!==i.viewport.scrollY&&(i.viewport.scrollY=c,i.needsRedraw=!0,s())},hm=(i,t,e,s,n,r)=>{if(!Number.isFinite(t)||t<=0)return;yR(i,t);const a=Ba(i,s)/i.grid.quarterNoteWidth,l=Math.max(0,i.grid.maxLength-a),c=se(e,0,l);i.viewport.scrollX=c*i.grid.quarterNoteWidth,QO(i,s,n,r),i.needsRedraw=!0,r()},um=(i,t,e,s,n,r)=>{if(!Number.isFinite(t)||t<=0)return;bR(i,t);const a=Za(i,n)/i.grid.noteHeight,l=Math.max(0,_i-a),c=se(e,0,l);i.viewport.scrollY=c*i.grid.noteHeight,QO(i,s,n,r),i.needsRedraw=!0,r()},xR=(i,t,e,s,n=!1)=>{const r=Ba(i,t),o=Za(i,e);if(r<=0||o<=0)return;const a=Array.from(i.notes.values());if(a.length===0){const $=r/ab;hm(i,$,0,t,e,s);const N=lb,L=o/N,I=127-gR,Z=Math.max(0,_i-N),F=se(I-(N-1),0,Z);um(i,L,F,t,e,s);return}const l=a.reduce((C,$)=>Math.min(C,$.position),Number.POSITIVE_INFINITY),c=a.reduce((C,$)=>Math.max(C,$.position+$.duration),Number.NEGATIVE_INFINITY),h=n?c:Math.max(c-l,0),u=Math.max(h,ab),f=r/u,d=Math.max(0,i.grid.maxLength-u),p=Math.max(u-h,0),g=n?0:l-p/2,m=se(g,0,d);hm(i,f,m,t,e,s);const O=a.reduce((C,$)=>Math.max(C,$.pitch),Number.NEGATIVE_INFINITY),b=a.reduce((C,$)=>Math.min(C,$.pitch),Number.POSITIVE_INFINITY),x=127-O,v=127-b,y=Math.max(v-x+1,1),_=Math.max(y,lb),S=o/_,k=Math.max(_-y,0),A=x-k/2,M=Math.max(0,_i-_),R=se(A,0,M);um(i,S,R,t,e,s)};class SR{constructor(t){this.options=t}dragState=null;getThumbMetrics=()=>{const t=this.options.state.grid.maxLength;if(t<=0)return{start:0,size:1};const e=this.options.state.grid.quarterNoteWidth,s=Ba(this.options.state,this.options.getFallbackWidth());if(e<=0||s<=0)return{start:0,size:1};const n=this.options.state.viewport.scrollX/e,r=s/e,o=Math.min(1,r/t);if(o>=1)return{start:0,size:1};const a=n/t;return{start:se(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:t,size:e}=this.getThumbMetrics(),s=se(e,0,1),n=Math.min(1,Math.max(s,.01));return{left:`${se(t,0,1-n)*100}%`,width:`${n*100}%`}};startDrag=(t,e)=>{if(!this.options.isInteractive())return;const s=this.options.horizontalTrack.value;if(!s)return;this.stopDrag();const n=s.getBoundingClientRect();if(n.width<=0)return;const{startQuarter:r,endQuarter:o}=this.options.getViewportRange(),a=Math.max(ta,o-r),l=Ba(this.options.state,this.options.getFallbackWidth()),c=this.options.state.grid.maxLength;if(l<=0||c<=0)return;const h=r/c,u=o/c;let f=0;t==="resize-start"?f=e.clientX-(n.left+h*n.width):t==="resize-end"&&(f=e.clientX-(n.left+u*n.width)),this.dragState={mode:t,pointerId:e.pointerId,pointerStart:e.clientX,trackRect:n,startQuarter:r,endQuarter:o,anchorQuarter:t==="resize-start"?o:r,spanQuarter:a,stageWidth:l,pointerOffset:f},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),e.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=t=>{const e=this.dragState;if(!e||t.pointerId!==e.pointerId)return;const s=this.options.state.grid.maxLength,n=e.trackRect;if(s<=0||n.width<=0||e.stageWidth<=0)return;if(t.preventDefault(),e.mode==="move"){const c=(t.clientX-e.pointerStart)/n.width*s,h=Math.max(0,s-e.spanQuarter),u=se(e.startQuarter+c,0,h);this.options.state.viewport.scrollX=u*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const r=se(t.clientX,n.left,n.right),a=(se(r-e.pointerOffset,n.left,n.right)-n.left)/n.width;if(e.mode==="resize-start"){let l=a*s;const c=e.anchorQuarter-ta;l=se(l,0,Math.max(0,c));const h=Math.max(ta,e.anchorQuarter-l),u=e.stageWidth/h;this.options.applyHorizontalZoom(u,l),e.startQuarter=l,e.spanQuarter=h;return}if(e.mode==="resize-end"){let l=a*s;const c=e.anchorQuarter+ta;l=se(l,Math.min(c,s),s);const h=Math.max(ta,l-e.anchorQuarter),u=e.stageWidth/h;this.options.applyHorizontalZoom(u,e.anchorQuarter),e.endQuarter=l,e.spanQuarter=h}};onTrackPointerDown=t=>{if(!this.options.isInteractive())return;const e=this.options.horizontalTrack.value;if(!e)return;const s=e.getBoundingClientRect();if(s.width<=0)return;const n=se((t.clientX-s.left)/s.width,0,1),{startQuarter:r,endQuarter:o}=this.options.getViewportRange(),a=Math.max(ta,o-r),l=this.options.state.grid.maxLength,c=Math.max(0,l-a),h=se(n*l-a/2,0,c);this.options.state.viewport.scrollX=h*this.options.state.grid.quarterNoteWidth,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}class wR{constructor(t){this.options=t}dragState=null;getThumbMetrics=()=>{const t=_i,e=this.options.state.grid.noteHeight,s=Za(this.options.state,this.options.getFallbackHeight());if(e<=0||s<=0)return{start:0,size:1};const n=this.options.state.viewport.scrollY/e,r=s/e,o=Math.min(1,r/t);if(o>=1)return{start:0,size:1};const a=n/t;return{start:se(a,0,1-o),size:o}};getThumbStyle=()=>{const{start:t,size:e}=this.getThumbMetrics(),s=se(e,0,1),n=Math.min(1,Math.max(s,.01));return{top:`${se(t,0,1-n)*100}%`,height:`${n*100}%`}};startDrag=(t,e)=>{if(!this.options.isInteractive())return;const s=this.options.verticalTrack.value;if(!s)return;this.stopDrag();const n=s.getBoundingClientRect();if(n.height<=0)return;const{topIndex:r,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(ea,o-r),l=Za(this.options.state,this.options.getFallbackHeight());if(l<=0)return;const c=r/_i,h=o/_i;let u=0;t==="resize-start"?u=e.clientY-(n.top+c*n.height):t==="resize-end"&&(u=e.clientY-(n.top+h*n.height)),this.dragState={mode:t,pointerId:e.pointerId,pointerStart:e.clientY,trackRect:n,topIndex:r,bottomIndex:o,anchorIndex:t==="resize-start"?o:r,span:a,stageHeight:l,pointerOffset:u},window.addEventListener("pointermove",this.handlePointerMove),window.addEventListener("pointerup",this.stopDrag),e.preventDefault()};stopDrag=()=>{this.dragState&&(window.removeEventListener("pointermove",this.handlePointerMove),window.removeEventListener("pointerup",this.stopDrag),this.dragState=null)};handlePointerMove=t=>{const e=this.dragState;if(!e||t.pointerId!==e.pointerId)return;const s=e.trackRect;if(s.height<=0||e.stageHeight<=0)return;if(t.preventDefault(),e.mode==="move"){const l=(t.clientY-e.pointerStart)/s.height*_i,c=Math.max(0,_i-e.span),h=se(e.topIndex+l,0,c);this.options.state.viewport.scrollY=h*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange();return}const n=se(t.clientY,s.top,s.bottom),o=(se(n-e.pointerOffset,s.top,s.bottom)-s.top)/s.height;if(e.mode==="resize-start"){let a=o*_i;const l=e.anchorIndex-ea;a=se(a,0,Math.max(0,l));const c=Math.max(ea,e.anchorIndex-a),h=e.stageHeight/c;this.options.applyVerticalZoom(h,a),e.topIndex=a,e.span=c;return}if(e.mode==="resize-end"){let a=o*_i;const l=e.anchorIndex+ea;a=se(a,Math.min(l,_i),_i);const c=Math.max(ea,a-e.anchorIndex),h=e.stageHeight/c;this.options.applyVerticalZoom(h,e.anchorIndex),e.bottomIndex=a,e.span=c}};onTrackPointerDown=t=>{if(!this.options.isInteractive())return;const e=this.options.verticalTrack.value;if(!e)return;const s=e.getBoundingClientRect();if(s.height<=0)return;const n=se((t.clientY-s.top)/s.height,0,1),{topIndex:r,bottomIndex:o}=this.options.getViewportRange(),a=Math.max(ea,o-r),l=Math.max(0,_i-a),c=se(n*_i-a/2,0,l);this.options.state.viewport.scrollY=c*this.options.state.grid.noteHeight,this.options.enforceScrollBounds(),this.options.state.needsRedraw=!0,this.options.notifyViewportChange()}}const kR=({state:i,canUndo:t,canRedo:e,emitStateUpdate:s})=>{const n=()=>{t.value=i.command.stack?.canUndo()??!1,e.value=i.command.stack?.canRedo()??!1};return{undo:()=>{i.command.stack?.undo(),n()},redo:()=>{i.command.stack?.redo(),n()},deleteSelected:()=>{i.selection.selectedIds.size!==0&&(i.command.stack?.executeCommand("Delete Selected",()=>{i.selection.selectedIds.forEach(c=>i.notes.delete(c)),i.selection.selectedIds.clear(),i.needsRedraw=!0}),n())},updateCommandStackButtons:n,handleCommandStackUpdate:()=>{n(),s()}}},CR=({state:i,isInteractive:t,undo:e,redo:s,deleteSelected:n,updateCommandStackButtons:r,executeOverlapChanges:o,getContainer:a})=>{let l=!1;const c=f=>{if(t()){if((f.metaKey||f.ctrlKey)&&f.key==="z"&&!f.shiftKey){f.preventDefault(),e();return}if((f.metaKey||f.ctrlKey)&&f.key==="z"&&f.shiftKey){f.preventDefault(),s();return}if(f.key==="Backspace"||f.key==="Delete"){f.preventDefault(),n();return}if(f.key.startsWith("Arrow")&&i.selection.selectedIds.size>0){f.preventDefault(),i.command.stack?.executeCommand("Move Selection",()=>{i.selection.selectedIds.forEach(d=>{const p=i.notes.get(d);if(p)switch(f.key){case"ArrowUp":p.pitch=Math.min(127,p.pitch+1);break;case"ArrowDown":p.pitch=Math.max(0,p.pitch-1);break;case"ArrowLeft":p.position=Math.max(0,p.position-.25);break;case"ArrowRight":p.position+=.25;break}}),o(i,i.selection.selectedIds),i.needsRedraw=!0}),r();return}if((f.metaKey||f.ctrlKey)&&f.key==="c"&&i.selection.selectedIds.size>0){f.preventDefault();const d=Array.from(i.selection.selectedIds).map(g=>{const m=i.notes.get(g);return m?{...m}:null}).filter(g=>g!==null);if(d.length===0)return;const p=Math.min(...d.map(g=>g.position));sessionStorage.setItem("copiedPianoRollNotes",JSON.stringify({notes:d.map(g=>({...g,position:g.position-p}))}));return}if((f.metaKey||f.ctrlKey)&&f.key==="v"){f.preventDefault();const d=sessionStorage.getItem("copiedPianoRollNotes");if(!d)return;try{const{notes:p}=JSON.parse(d);i.command.stack?.executeCommand("Paste Notes",()=>{i.selection.selectedIds.clear(),p.forEach(g=>{const m={...g,id:`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,position:i.queuePlayhead.position+g.position};i.notes.set(m.id,m),i.selection.selectedIds.add(m.id)}),o(i,i.selection.selectedIds),i.needsRedraw=!0}),r()}catch(p){console.error("Failed to paste notes",p)}}}};return{attach:()=>{if(l)return;const f=a();f&&(f.setAttribute("tabindex","0"),f.addEventListener("keydown",c),l=!0)},detach:()=>{if(!l)return;const f=a();f&&f.removeEventListener("keydown",c),l=!1},isAttached:()=>l}};class TR{constructor(t){this.deps=t}eventHandlersInitialized=!1;keyboardAttached=!1;renderFrame=()=>{this.deps.state.needsRedraw&&(this.deps.renderGrid(this.deps.state),this.deps.renderVisibleNotes(this.deps.state),this.deps.renderResizeHandles(this.deps.state),this.deps.updateQueuePlayheadPosition(this.deps.state),this.deps.updateLivePlayheadPosition(this.deps.state),this.deps.state.needsRedraw=!1),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)};startRenderLoop(){this.stopRenderLoop(),this.deps.state.rafHandle=requestAnimationFrame(this.renderFrame)}stopRenderLoop(){this.deps.state.rafHandle&&(cancelAnimationFrame(this.deps.state.rafHandle),this.deps.state.rafHandle=void 0)}enableInteractivity(){this.deps.state.stage&&(this.eventHandlersInitialized||(this.deps.setupEventHandlers(this.deps.state,this.deps.state.stage),this.eventHandlersInitialized=!0),this.deps.state.stage.listening(!0),this.keyboardAttached||(this.deps.attachKeyboard(),this.keyboardAttached=!0))}disableInteractivity(){this.deps.state.stage&&(this.deps.state.stage.listening(!1),this.deps.state.interaction.isDragging=!1,this.deps.state.interaction.isResizing=!1,this.deps.state.interaction.isMarqueeSelecting=!1,this.deps.state.selection.selectionRect?.visible(!1),this.keyboardAttached&&(this.deps.detachKeyboard(),this.keyboardAttached=!1),this.deps.state.layers.overlay?.batchDraw(),this.deps.syncUiCounters())}mount({width:t,height:e,interactive:s,initialNotes:n}){if(!this.deps.konvaContainer.value){console.error("Konva container ref not found");return}const r=new hi.Stage({container:this.deps.konvaContainer.value,width:t,height:e});this.deps.state.stage=r,this.deps.state.konvaContainer=this.deps.konvaContainer.value,this.deps.initializeLayers(this.deps.state,r,this.deps.handleCommandStackUpdate),s?this.enableInteractivity():this.disableInteractivity(),n.length>0&&(this.deps.state.notes=new Map(n),this.deps.state.needsRedraw=!0,this.deps.syncUiCounters()),this.startRenderLoop(),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds(),this.deps.handleCommandStackUpdate()}unmount(){this.stopRenderLoop(),this.disableInteractivity(),this.deps.state.stage?.destroy(),this.deps.state.stage=void 0,this.deps.state.konvaContainer=void 0,this.eventHandlersInitialized=!1}setInteractive(t){this.deps.state.stage&&(t?this.enableInteractivity():this.disableInteractivity())}resize(t,e){this.deps.state.stage&&(this.deps.state.stage.width(t),this.deps.state.stage.height(e),this.deps.state.needsRedraw=!0,this.deps.enforceScrollBounds())}}const PR={class:"piano-roll-root"},AR={key:0,class:"control-panel"},MR=["disabled"],ER=["disabled"],RR=["disabled"],QR=["disabled"],IR={class:"info"},$R={class:"piano-roll-layout"},NR={class:"stage-wrapper"},DR=Vo({__name:"PianoRollRoot",props:{width:{default:640},height:{default:360},initialNotes:{default:()=>[]},syncState:{},showControlPanel:{type:Boolean,default:!0},interactive:{type:Boolean,default:!0}},emits:["notes-update"],setup(i,{expose:t,emit:e}){const s=i,n=e,r=zE();r.viewport=Mo(r.viewport),r.grid=Mo(r.grid);const o=Xt(),a=Xt(),l=Xt(),c=Xt(!1),h=Xt(!1),u=Xt(r.grid.subdivision),f=Xt(r.notes.size),d=Xt(r.selection.selectedIds.size),p=Rs(()=>s.interactive),g=Rs(()=>s.showControlPanel),m=()=>{f.value=r.notes.size,d.value=r.selection.selectedIds.size},O=()=>{s.syncState?.(r)},b=(mt=!1)=>{xR(r,s.width,s.height,O,mt)},x=()=>{QO(r,s.width,s.height,O)},v=(mt,nt)=>{hm(r,mt,nt,s.width,s.height,O)},y=(mt,nt)=>{um(r,mt,nt,s.width,s.height,O)},_=()=>vR(r,s.width),S=()=>_R(r,s.height),k=new SR({state:r,horizontalTrack:a,isInteractive:()=>s.interactive,getViewportRange:_,applyHorizontalZoom:v,enforceScrollBounds:x,notifyViewportChange:O,getFallbackWidth:()=>s.width}),A=new wR({state:r,verticalTrack:l,isInteractive:()=>s.interactive,getViewportRange:S,applyVerticalZoom:y,enforceScrollBounds:x,notifyViewportChange:O,getFallbackHeight:()=>s.height}),M=Rs(()=>k.getThumbStyle()),R=Rs(()=>A.getThumbStyle()),C=(mt,nt)=>{k.startDrag(mt,nt)},$=()=>{k.stopDrag()},N=(mt,nt)=>{A.startDrag(mt,nt)},L=()=>{A.stopDrag()},I=mt=>{k.onTrackPointerDown(mt)},Z=mt=>{A.onTrackPointerDown(mt)};We(u,mt=>{r.grid.subdivision=mt,r.needsRedraw=!0,s.syncState?.(r)});const F=()=>{m(),n("notes-update",Array.from(r.notes.entries())),s.syncState?.(r)};r.notifyExternalChange=()=>{F()};const{undo:z,redo:et,deleteSelected:K,updateCommandStackButtons:ot,handleCommandStackUpdate:Mt}=kR({state:r,canUndo:c,canRedo:h,emitStateUpdate:F}),jt=CR({state:r,isInteractive:()=>s.interactive,undo:z,redo:et,deleteSelected:K,updateCommandStackButtons:ot,executeOverlapChanges:RO,getContainer:()=>o.value||null}),yt=new TR({state:r,konvaContainer:o,initializeLayers:eR,setupEventHandlers:lR,renderGrid:iR,renderVisibleNotes:sR,renderResizeHandles:nR,updateQueuePlayheadPosition:oR,updateLivePlayheadPosition:aR,handleCommandStackUpdate:Mt,syncUiCounters:m,enforceScrollBounds:x,attachKeyboard:()=>jt.attach(),detachKeyboard:()=>jt.detach()});return Jc(()=>{yt.mount({width:s.width,height:s.height,interactive:s.interactive,initialNotes:s.initialNotes??[]})}),kd(()=>{$(),L(),yt.unmount()}),We(()=>s.interactive,mt=>{yt.setInteractive(mt),mt||($(),L())}),We(()=>s.width,mt=>{yt.resize(mt,s.height)}),We(()=>s.height,mt=>{yt.resize(s.width,mt)}),t({setNotes:mt=>{r.command.stack?.executeCommand("Set Notes",()=>{const nt=new Set;r.notes.clear(),mt.forEach((Qt,P)=>{let Q=Qt.id||`note_${Date.now()}_${P}`;for(;nt.has(Q);)Q=`note_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;nt.add(Q);const q={...Qt,id:Q,velocity:Qt.velocity??100};r.notes.set(Q,q)}),r.needsRedraw=!0}),ot(),F()},setLivePlayheadPosition:mt=>{r.livePlayhead.position=Math.max(0,Math.min(mt,r.grid.maxLength)),r.needsRedraw=!0},getPlayStartPosition:()=>r.queuePlayhead.position,fitZoomToNotes:b}),(mt,nt)=>(Tt(),Rt("div",PR,[g.value?(Tt(),Rt("div",AR,[X("button",{onClick:nt[0]||(nt[0]=(...Qt)=>Te(z)&&Te(z)(...Qt)),disabled:!p.value||!c.value}," Undo",8,MR),X("button",{onClick:nt[1]||(nt[1]=(...Qt)=>Te(et)&&Te(et)(...Qt)),disabled:!p.value||!h.value}," Redo",8,ER),nt[12]||(nt[12]=X("span",{class:"separator"},"|",-1)),X("label",null,[nt[11]||(nt[11]=Fi(" Grid: ",-1)),Ar(X("select",{"onUpdate:modelValue":nt[2]||(nt[2]=Qt=>u.value=Qt),disabled:!p.value},[...nt[10]||(nt[10]=[X("option",{value:4},"Quarter",-1),X("option",{value:8},"Eighth",-1),X("option",{value:16},"16th",-1),X("option",{value:32},"32nd",-1)])],8,RR),[[V0,u.value,void 0,{number:!0}]])]),nt[13]||(nt[13]=X("span",{class:"separator"},"|",-1)),X("button",{onClick:nt[3]||(nt[3]=(...Qt)=>Te(K)&&Te(K)(...Qt)),disabled:!p.value||d.value===0},"  Delete ",8,QR),nt[14]||(nt[14]=X("span",{class:"separator"},"|",-1)),X("span",IR,Ie(f.value)+" notes, "+Ie(d.value)+" selected",1)])):Ae("",!0),X("div",$R,[X("div",NR,[X("div",{ref_key:"konvaContainer",ref:o,class:Ds(["piano-roll-container",{"is-disabled":!p.value}]),style:kr({width:s.width+"px",height:s.height+"px"})},null,6),X("div",{ref_key:"horizontalTrack",ref:a,class:Ds(["scrollbar horizontal",{"is-disabled":!p.value}]),style:kr({width:s.width+"px"}),onPointerdown:ln(I,["self"])},[X("div",{class:"scrollbar-thumb horizontal-thumb",style:kr(M.value)},[X("div",{class:"scrollbar-handle handle-left",onPointerdown:nt[4]||(nt[4]=ln(Qt=>C("resize-start",Qt),["stop","prevent"]))},null,32),X("div",{class:"scrollbar-body",onPointerdown:nt[5]||(nt[5]=ln(Qt=>C("move",Qt),["stop","prevent"]))},null,32),X("div",{class:"scrollbar-handle handle-right",onPointerdown:nt[6]||(nt[6]=ln(Qt=>C("resize-end",Qt),["stop","prevent"]))},null,32)],4)],38)]),X("div",{ref_key:"verticalTrack",ref:l,class:Ds(["scrollbar vertical",{"is-disabled":!p.value}]),style:kr({height:s.height+"px"}),onPointerdown:ln(Z,["self"])},[X("div",{class:"scrollbar-thumb vertical-thumb",style:kr(R.value)},[X("div",{class:"scrollbar-handle handle-top",onPointerdown:nt[7]||(nt[7]=ln(Qt=>N("resize-start",Qt),["stop","prevent"]))},null,32),X("div",{class:"scrollbar-body vertical-body",onPointerdown:nt[8]||(nt[8]=ln(Qt=>N("move",Qt),["stop","prevent"]))},null,32),X("div",{class:"scrollbar-handle handle-bottom",onPointerdown:nt[9]||(nt[9]=ln(Qt=>N("resize-end",Qt),["stop","prevent"]))},null,32)],4)],38)])]))}}),rl=(i,t)=>{const e=i.__vccOpts||i;for(const[s,n]of t)e[s]=n;return e},DS=rl(DR,[["__scopeId","data-v-28e11346"]]),LR={key:0,class:"controls"},VR={key:0,class:"editing-badge"},BR={class:"queue-checkbox"},ZR={class:"loop-toggle"},FR=Vo({__name:"PianoRollItem",props:{id:{},notes:{},width:{default:300},height:{default:170},interactive:{type:Boolean,default:!1},showControls:{type:Boolean,default:!0},includeInQueue:{type:Boolean,default:!1},isEditing:{type:Boolean,default:!1},coordinator:{}},emits:["edit","update:includeInQueue"],setup(i,{emit:t}){const e=i,s=t,n=Xt(null),r=Xt("poly"),o=Xt(!1),a=Xt(1),l=Xt(e.includeInQueue);let c=null;const h=O=>{},u=()=>{e.coordinator.playRoll(e.id)},f=()=>{e.coordinator.stop()},d=()=>{s("edit")},p=()=>{e.coordinator.setInstrument(e.id,r.value)},g=()=>{e.coordinator.setLoop(e.id,{enabled:o.value,count:o.value?a.value:1})},m=()=>{s("update:includeInQueue",l.value)};return We(()=>e.includeInQueue,O=>{l.value=O}),We(()=>e.notes,O=>{n.value?.setNotes(O)}),We(o,g),We(a,g),Jc(()=>{n.value&&(c=e.coordinator.registerRoll({id:e.id,getNotes:()=>[...e.notes],getQueueStart:()=>n.value?.getPlayStartPosition()??0,setLivePlayhead:O=>n.value?.setLivePlayheadPosition(O),getGrid:()=>({maxLength:16,timeSignature:4,subdivision:16})}),n.value.setNotes(e.notes),n.value.fitZoomToNotes(!0))}),kd(()=>{c?.()}),(O,b)=>(Tt(),Rt("div",{class:Ds(["piano-roll-item",{editing:e.isEditing}])},[i.showControls?(Tt(),Rt("div",LR,[e.isEditing?(Tt(),Rt("span",VR,"Editing")):Ae("",!0),X("label",BR,[Ar(X("input",{type:"checkbox","onUpdate:modelValue":b[0]||(b[0]=x=>l.value=x),onChange:m},null,544),[[Zg,l.value]]),b[4]||(b[4]=Fi(" Queue ",-1))]),Ar(X("select",{"onUpdate:modelValue":b[1]||(b[1]=x=>r.value=x),onChange:p,class:"instrument-select"},[...b[5]||(b[5]=[X("option",{value:"poly"},"Poly",-1),X("option",{value:"fm"},"FM",-1),X("option",{value:"am"},"AM",-1),X("option",{value:"mono"},"Mono",-1)])],544),[[V0,r.value]]),X("label",ZR,[Ar(X("input",{type:"checkbox","onUpdate:modelValue":b[2]||(b[2]=x=>o.value=x)},null,512),[[Zg,o.value]]),b[6]||(b[6]=Fi(" Loop ",-1))]),o.value?Ar((Tt(),Rt("input",{key:1,type:"number","onUpdate:modelValue":b[3]||(b[3]=x=>a.value=x),min:"1",max:"10",class:"loop-count"},null,512)),[[vf,a.value,void 0,{number:!0}]]):Ae("",!0),X("button",{onClick:u,class:"play-btn"},""),X("button",{onClick:f,class:"stop-btn"},""),i.interactive?Ae("",!0):(Tt(),Rt("button",{key:2,onClick:d,class:Ds(["edit-btn",{active:e.isEditing}])},Ie(e.isEditing?" Stop Editing":" Edit"),3))])):Ae("",!0),Ne(DS,{ref_key:"pianoRollRef",ref:n,width:i.width,height:i.height,"show-control-panel":!1,interactive:i.interactive,"sync-state":h},null,8,["width","height","interactive"])],2))}}),WR=rl(FR,[["__scopeId","data-v-d91c0698"]]),cb=.05;function qR(){const i=new Map,t=new Map,e=new Map,s=Xt(!1),n=Xt(null),r=Xt(null);let o=new Map,a=new Map,l=null,c=new Map,h=[],u=!1;const f=()=>60/ai.bpm.value,d=()=>ai.bpm.value/60,p=C=>{a.forEach($=>cancelAnimationFrame($)),a.clear()},g=()=>{l!==null&&(ai.clear(l),l=null),ai.cancel()},m=C=>{const $=t.get(C);$&&($.dispose(),t.delete(C))},O=C=>{switch(C){case"poly":return new $f(Kn).toDestination();case"fm":return new xO().toDestination();case"am":return new vO().toDestination();case"mono":return new _O().toDestination();default:return new $f(Kn).toDestination()}},b=C=>(i.set(C.id,C),t.set(C.id,O("poly")),e.set(C.id,{enabled:!1,count:1}),()=>{i.delete(C.id),m(C.id),e.delete(C.id)}),x=(C,$)=>{m(C),t.set(C,O($))},v=(C,$)=>{e.set(C,$)},y=C=>{const $=i.get(C);if(!$)return;const N=c.get(C)||0,L=()=>{if(!s.value||!u&&n.value!==C||u&&!h.includes(C))return;const Z=ai.seconds,F=N+Z*d();$.setLivePlayhead(F);const z=requestAnimationFrame(L);a.set(C,z)},I=requestAnimationFrame(L);a.set(C,I)},_=async C=>{const $=i.get(C),N=t.get(C),L=e.get(C);if(!$||!N)return;await Hg();const I=$.getQueueStart();c.set(C,I);const F=$.getNotes().filter(mt=>mt.position+mt.duration>I).map(mt=>({note:mt,offset:Math.max(0,mt.position-I)}));if(!F.length){$.setLivePlayhead(I);return}const z=Math.max(...F.map(mt=>mt.note.position+mt.note.duration)),K=Math.max(1,Math.ceil(z-I)),ot=f(),Mt=F.map(mt=>{const nt=Math.max(0,Math.min(1,(mt.note.velocity??100)/127));return{pitch:mt.note.pitch,time:mt.offset*ot,velocity:nt,duration:Math.max(mt.note.duration,.0625)*ot}}),jt=o.get(C);jt&&(jt.stop(0),jt.dispose()),g();const yt=new Mc((mt,nt)=>{const Qt=Ty(nt.pitch,"midi").toNote();N.triggerAttackRelease(Qt,nt.duration,mt,nt.velocity)},Mt);o.set(C,yt),yt.start(0);let wt=1;L?.enabled&&(u?wt=Math.min(L.count||1,10):wt=L.count===1/0?1/0:L.count||1,(wt>1||wt===1/0)&&(yt.loop=!0,yt.loopEnd=K*ot)),ai.stop(),ai.position=0,ai.start(`+${cb.toFixed(3)}`),n.value=C,s.value=!0,$.setLivePlayhead(I);const Ut=Mt.reduce((mt,nt)=>Math.max(mt,nt.time+nt.duration),0),gt=wt===1/0?Number.MAX_SAFE_INTEGER:Ut*wt;return y(C),new Promise(mt=>{if(wt===1/0){mt();return}l=ai.scheduleOnce(()=>{n.value===C&&S(!0),mt()},gt+.1)})},S=(C=!0)=>{if(!s.value&&o.size===0)return;ai.stop(),g(),o.forEach(N=>{N.stop(0),N.dispose()}),o.clear(),p();const $=n.value;if(n.value=null,s.value=!1,C){if(u)h.forEach(N=>{const L=i.get(N);if(L){const I=L.getQueueStart();L.setLivePlayhead(I)}});else if($){const N=i.get($);if(N){const L=N.getQueueStart();N.setLivePlayhead(L)}}}c.clear(),r.value=null},k=async C=>{s.value&&S(!1),u=!1,h=[],await _(C)},A=async C=>{if(s.value&&S(!1),u=!0,h=C.filter(L=>i.has(L)),h.length===0)return;await Hg();const $=f();let N=0;for(const L of h){const I=i.get(L),Z=t.get(L),F=e.get(L);if(!I||!Z)continue;const z=I.getQueueStart();c.set(L,z);const K=I.getNotes().filter(nt=>nt.position+nt.duration>z).map(nt=>({note:nt,offset:Math.max(0,nt.position-z)}));if(!K.length){I.setLivePlayhead(z);continue}const ot=Math.max(...K.map(nt=>nt.note.position+nt.note.duration)),jt=Math.max(1,Math.ceil(ot-z)),yt=K.map(nt=>{const Qt=Math.max(0,Math.min(1,(nt.note.velocity??100)/127));return{pitch:nt.note.pitch,time:nt.offset*$,velocity:Qt,duration:Math.max(nt.note.duration,.0625)*$}}),wt=new Mc((nt,Qt)=>{const P=Ty(Qt.pitch,"midi").toNote();Z.triggerAttackRelease(P,Qt.duration,nt,Qt.velocity)},yt);o.set(L,wt),wt.start(0);let Ut=1;F?.enabled&&(Ut=Math.min(F.count||1,10),Ut>1&&(wt.loop=!0,wt.loopEnd=jt*$)),I.setLivePlayhead(z);const mt=yt.reduce((nt,Qt)=>Math.max(nt,Qt.time+Qt.duration),0)*Ut;N=Math.max(N,mt),y(L)}ai.stop(),ai.position=0,ai.start(`+${cb.toFixed(3)}`),s.value=!0,r.value={rollId:h.join(","),index:h.length,total:h.length},l=ai.scheduleOnce(()=>{S(!0)},N+.1)},M=()=>{u=!1,h=[],S(!0)};return{registerRoll:b,setInstrument:x,setLoop:v,playRoll:k,playQueue:A,stop:M,dispose:()=>{M(),t.forEach((C,$)=>C.dispose()),t.clear(),i.clear(),e.clear()},isPlaying:Rs(()=>s.value),currentRollId:Rs(()=>n.value),queueState:Rs(()=>r)}}function Ot(i,t,e,s,n){if(typeof t=="function"?i!==t||!0:!t.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(i,e),e}function W(i,t,e,s){if(e==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?i!==t||!s:!t.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?s:e==="a"?s.call(i):s?s.value:t.get(i)}let LS=function(){const{crypto:i}=globalThis;if(i?.randomUUID)return LS=i.randomUUID.bind(i),i.randomUUID();const t=new Uint8Array(1),e=i?()=>i.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^e()&15>>+s/4).toString(16))};function Rc(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const fm=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const t=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(t.stack=i.stack),i.cause&&!t.cause&&(t.cause=i.cause),i.name&&(t.name=i.name),t}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};class $t extends Error{}class Oi extends $t{constructor(t,e,s,n){super(`${Oi.makeMessage(t,e,s)}`),this.status=t,this.headers=n,this.requestID=n?.get("request-id"),this.error=e}static makeMessage(t,e,s){const n=e?.message?typeof e.message=="string"?e.message:JSON.stringify(e.message):e?JSON.stringify(e):s;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,e,s,n){if(!t||!n)return new tp({message:s,cause:fm(e)});const r=e;return t===400?new BS(t,r,s,n):t===401?new ZS(t,r,s,n):t===403?new FS(t,r,s,n):t===404?new WS(t,r,s,n):t===409?new qS(t,r,s,n):t===422?new XS(t,r,s,n):t===429?new zS(t,r,s,n):t>=500?new jS(t,r,s,n):new Oi(t,r,s,n)}}class $s extends Oi{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class tp extends Oi{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),e&&(this.cause=e)}}class VS extends tp{constructor({message:t}={}){super({message:t??"Request timed out."})}}class BS extends Oi{}class ZS extends Oi{}class FS extends Oi{}class WS extends Oi{}class qS extends Oi{}class XS extends Oi{}class zS extends Oi{}class jS extends Oi{}const XR=/^[a-z][a-z0-9+.-]*:/i,zR=i=>XR.test(i);let dm=i=>(dm=Array.isArray,dm(i)),hb=dm;function ub(i){return typeof i!="object"?{}:i??{}}function jR(i){if(!i)return!0;for(const t in i)return!1;return!0}function GR(i,t){return Object.prototype.hasOwnProperty.call(i,t)}const YR=(i,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new $t(`${i} must be an integer`);if(t<0)throw new $t(`${i} must be a positive integer`);return t},GS=i=>{try{return JSON.parse(i)}catch{return}},UR=i=>new Promise(t=>setTimeout(t,i)),aa="0.65.0",HR=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function KR(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const JR=()=>{const i=KR();if(i==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aa,"X-Stainless-OS":db(Deno.build.os),"X-Stainless-Arch":fb(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(i==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aa,"X-Stainless-OS":db(globalThis.process.platform??"unknown"),"X-Stainless-Arch":fb(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=tQ();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":aa,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function tQ(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:e}of i){const s=e.exec(navigator.userAgent);if(s){const n=s[1]||0,r=s[2]||0,o=s[3]||0;return{browser:t,version:`${n}.${r}.${o}`}}}return null}const fb=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",db=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let pb;const eQ=()=>pb??(pb=JR());function iQ(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function YS(...i){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...i)}function US(i){let t=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return YS({start(){},async pull(e){const{done:s,value:n}=await t.next();s?e.close():e.enqueue(n)},async cancel(){await t.return?.()}})}function IO(i){if(i[Symbol.asyncIterator])return i;const t=i.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function sQ(i){if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await i[Symbol.asyncIterator]().return?.();return}const t=i.getReader(),e=t.cancel();t.releaseLock(),await e}const nQ=({headers:i,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});function rQ(i){let t=0;for(const n of i)t+=n.length;const e=new Uint8Array(t);let s=0;for(const n of i)e.set(n,s),s+=n.length;return e}let gb;function $O(i){let t;return(gb??(t=new globalThis.TextEncoder,gb=t.encode.bind(t)))(i)}let mb;function Ob(i){let t;return(mb??(t=new globalThis.TextDecoder,mb=t.decode.bind(t)))(i)}var ts,es;class gh{constructor(){ts.set(this,void 0),es.set(this,void 0),Ot(this,ts,new Uint8Array),Ot(this,es,null)}decode(t){if(t==null)return[];const e=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?$O(t):t;Ot(this,ts,rQ([W(this,ts,"f"),e]));const s=[];let n;for(;(n=oQ(W(this,ts,"f"),W(this,es,"f")))!=null;){if(n.carriage&&W(this,es,"f")==null){Ot(this,es,n.index);continue}if(W(this,es,"f")!=null&&(n.index!==W(this,es,"f")+1||n.carriage)){s.push(Ob(W(this,ts,"f").subarray(0,W(this,es,"f")-1))),Ot(this,ts,W(this,ts,"f").subarray(W(this,es,"f"))),Ot(this,es,null);continue}const r=W(this,es,"f")!==null?n.preceding-1:n.preceding,o=Ob(W(this,ts,"f").subarray(0,r));s.push(o),Ot(this,ts,W(this,ts,"f").subarray(n.index)),Ot(this,es,null)}return s}flush(){return W(this,ts,"f").length?this.decode(`
`):[]}}ts=new WeakMap,es=new WeakMap;gh.NEWLINE_CHARS=new Set([`
`,"\r"]);gh.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function oQ(i,t){for(let n=t??0;n<i.length;n++){if(i[n]===10)return{preceding:n,index:n+1,carriage:!1};if(i[n]===13)return{preceding:n,index:n+1,carriage:!0}}return null}function aQ(i){for(let s=0;s<i.length-1;s++){if(i[s]===10&&i[s+1]===10||i[s]===13&&i[s+1]===13)return s+2;if(i[s]===13&&i[s+1]===10&&s+3<i.length&&i[s+2]===13&&i[s+3]===10)return s+4}return-1}const Lf={off:0,error:200,warn:300,info:400,debug:500},yb=(i,t,e)=>{if(i){if(GR(Lf,i))return i;xi(e).warn(`${t} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(Lf))}`)}};function jl(){}function tu(i,t,e){return!t||Lf[i]>Lf[e]?jl:t[i].bind(t)}const lQ={error:jl,warn:jl,info:jl,debug:jl};let bb=new WeakMap;function xi(i){const t=i.logger,e=i.logLevel??"off";if(!t)return lQ;const s=bb.get(t);if(s&&s[0]===e)return s[1];const n={error:tu("error",t,e),warn:tu("warn",t,e),info:tu("info",t,e),debug:tu("debug",t,e)};return bb.set(t,[e,n]),n}const po=i=>(i.options&&(i.options={...i.options},delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([t,e])=>[t,t.toLowerCase()==="x-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":e]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);var _l;class dn{constructor(t,e,s){this.iterator=t,_l.set(this,void 0),this.controller=e,Ot(this,_l,s)}static fromSSEResponse(t,e,s){let n=!1;const r=s?xi(s):console;async function*o(){if(n)throw new $t("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const l of cQ(t,e)){if(l.event==="completion")try{yield JSON.parse(l.data)}catch(c){throw r.error("Could not parse message into JSON:",l.data),r.error("From chunk:",l.raw),c}if(l.event==="message_start"||l.event==="message_delta"||l.event==="message_stop"||l.event==="content_block_start"||l.event==="content_block_delta"||l.event==="content_block_stop")try{yield JSON.parse(l.data)}catch(c){throw r.error("Could not parse message into JSON:",l.data),r.error("From chunk:",l.raw),c}if(l.event!=="ping"&&l.event==="error")throw new Oi(void 0,GS(l.data)??l.data,void 0,t.headers)}a=!0}catch(l){if(Rc(l))return;throw l}finally{a||e.abort()}}return new dn(o,e,s)}static fromReadableStream(t,e,s){let n=!1;async function*r(){const a=new gh,l=IO(t);for await(const c of l)for(const h of a.decode(c))yield h;for(const c of a.flush())yield c}async function*o(){if(n)throw new $t("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const l of r())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(Rc(l))return;throw l}finally{a||e.abort()}}return new dn(o,e,s)}[(_l=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],e=[],s=this.iterator(),n=r=>({next:()=>{if(r.length===0){const o=s.next();t.push(o),e.push(o)}return r.shift()}});return[new dn(()=>n(t),this.controller,W(this,_l,"f")),new dn(()=>n(e),this.controller,W(this,_l,"f"))]}toReadableStream(){const t=this;let e;return YS({async start(){e=t[Symbol.asyncIterator]()},async pull(s){try{const{value:n,done:r}=await e.next();if(r)return s.close();const o=$O(JSON.stringify(n)+`
`);s.enqueue(o)}catch(n){s.error(n)}},async cancel(){await e.return?.()}})}}async function*cQ(i,t){if(!i.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new $t("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new $t("Attempted to iterate over a response with no body");const e=new uQ,s=new gh,n=IO(i.body);for await(const r of hQ(n))for(const o of s.decode(r)){const a=e.decode(o);a&&(yield a)}for(const r of s.flush()){const o=e.decode(r);o&&(yield o)}}async function*hQ(i){let t=new Uint8Array;for await(const e of i){if(e==null)continue;const s=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?$O(e):e;let n=new Uint8Array(t.length+s.length);n.set(t),n.set(s,t.length),t=n;let r;for(;(r=aQ(t))!==-1;)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}class uQ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,s,n]=fQ(t,":");return n.startsWith(" ")&&(n=n.substring(1)),e==="event"?this.event=n:e==="data"&&this.data.push(n),null}}function fQ(i,t){const e=i.indexOf(t);return e!==-1?[i.substring(0,e),t,i.substring(e+t.length)]:[i,"",""]}async function HS(i,t){const{response:e,requestLogID:s,retryOfRequestLogID:n,startTime:r}=t,o=await(async()=>{if(t.options.stream)return xi(i).debug("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):dn.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const l=e.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){const u=await e.json();return KS(u,e)}return await e.text()})();return xi(i).debug(`[${s}] response parsed`,po({retryOfRequestLogID:n,url:e.url,status:e.status,body:o,durationMs:Date.now()-r})),o}function KS(i,t){return!i||typeof i!="object"||Array.isArray(i)?i:Object.defineProperty(i,"_request_id",{value:t.headers.get("request-id"),enumerable:!1})}var Gl;class ep extends Promise{constructor(t,e,s=HS){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=s,Gl.set(this,void 0),Ot(this,Gl,t)}_thenUnwrap(t){return new ep(W(this,Gl,"f"),this.responsePromise,async(e,s)=>KS(t(await this.parseResponse(e,s),s),s.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e,request_id:e.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(W(this,Gl,"f"),t))),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}Gl=new WeakMap;var eu;class dQ{constructor(t,e,s,n){eu.set(this,void 0),Ot(this,eu,t),this.options=n,this.response=e,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new $t("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await W(this,eu,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(eu=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class pQ extends ep{constructor(t,e,s){super(t,e,async(n,r)=>new s(n,r.response,await HS(n,r),r.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const e of t)yield e}}class mh extends dQ{constructor(t,e,s,n){super(t,e,s,n),this.data=s.data||[],this.has_more=s.has_more||!1,this.first_id=s.first_id||null,this.last_id=s.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){const e=this.first_id;return e?{...this.options,query:{...ub(this.options.query),before_id:e}}:null}const t=this.last_id;return t?{...this.options,query:{...ub(this.options.query),after_id:t}}:null}}const JS=()=>{if(typeof File>"u"){const{process:i}=globalThis,t=typeof i?.versions?.node=="string"&&parseInt(i.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ca(i,t,e){return JS(),new File(i,t??"unknown_file",e)}function Yu(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const tw=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function",gQ=async(i,t)=>({...i,body:await OQ(i.body,t)}),vb=new WeakMap;function mQ(i){const t=typeof i=="function"?i:i.fetch,e=vb.get(t);if(e)return e;const s=(async()=>{try{const n="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;return r.toString()!==await new n(r).text()}catch{return!0}})();return vb.set(t,s),s}const OQ=async(i,t)=>{if(!await mQ(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const e=new FormData;return await Promise.all(Object.entries(i||{}).map(([s,n])=>pm(e,s,n))),e},yQ=i=>i instanceof Blob&&"name"in i,pm=async(i,t,e)=>{if(e!==void 0){if(e==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof e=="string"||typeof e=="number"||typeof e=="boolean")i.append(t,String(e));else if(e instanceof Response){let s={};const n=e.headers.get("Content-Type");n&&(s={type:n}),i.append(t,Ca([await e.blob()],Yu(e),s))}else if(tw(e))i.append(t,Ca([await new Response(US(e)).blob()],Yu(e)));else if(yQ(e))i.append(t,Ca([e],Yu(e),{type:e.type}));else if(Array.isArray(e))await Promise.all(e.map(s=>pm(i,t+"[]",s)));else if(typeof e=="object")await Promise.all(Object.entries(e).map(([s,n])=>pm(i,`${t}[${s}]`,n)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${e} instead`)}},ew=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",bQ=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&ew(i),vQ=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function _Q(i,t,e){if(JS(),i=await i,t||(t=Yu(i)),bQ(i))return i instanceof File&&t==null&&e==null?i:Ca([await i.arrayBuffer()],t??i.name,{type:i.type,lastModified:i.lastModified,...e});if(vQ(i)){const n=await i.blob();return t||(t=new URL(i.url).pathname.split(/[\\/]/).pop()),Ca(await gm(n),t,e)}const s=await gm(i);if(!e?.type){const n=s.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof n=="string"&&(e={...e,type:n})}return Ca(s,t,e)}async function gm(i){let t=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)t.push(i);else if(ew(i))t.push(i instanceof Blob?i:await i.arrayBuffer());else if(tw(i))for await(const e of i)t.push(...await gm(e));else{const e=i?.constructor?.name;throw new Error(`Unexpected data type: ${typeof i}${e?`; constructor: ${e}`:""}${xQ(i)}`)}return t}function xQ(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(e=>`"${e}"`).join(", ")}]`}class ur{constructor(t){this._client=t}}const iw=Symbol.for("brand.privateNullableHeaders");function*SQ(i){if(!i)return;if(iw in i){const{values:s,nulls:n}=i;yield*s.entries();for(const r of n)yield[r,null];return}let t=!1,e;i instanceof Headers?e=i.entries():hb(i)?e=i:(t=!0,e=Object.entries(i??{}));for(let s of e){const n=s[0];if(typeof n!="string")throw new TypeError("expected header name to be a string");const r=hb(s[1])?s[1]:[s[1]];let o=!1;for(const a of r)a!==void 0&&(t&&!o&&(o=!0,yield[n,null]),yield[n,a])}}const me=i=>{const t=new Headers,e=new Set;for(const s of i){const n=new Set;for(const[r,o]of SQ(s)){const a=r.toLowerCase();n.has(a)||(t.delete(r),n.add(a)),o===null?(t.delete(r),e.add(a)):(t.append(r,o),e.delete(a))}}return{[iw]:!0,values:t,nulls:e}};function sw(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const _b=Object.freeze(Object.create(null)),wQ=(i=sw)=>function(e,...s){if(e.length===1)return e[0];let n=!1;const r=[],o=e.reduce((h,u,f)=>{/[?#]/.test(u)&&(n=!0);const d=s[f];let p=(n?encodeURIComponent:i)(""+d);return f!==s.length&&(d==null||typeof d=="object"&&d.toString===Object.getPrototypeOf(Object.getPrototypeOf(d.hasOwnProperty??_b)??_b)?.toString)&&(p=d+"",r.push({start:h.length+u.length,length:p.length,error:`Value of type ${Object.prototype.toString.call(d).slice(8,-1)} is not a valid path parameter`})),h+u+(f===s.length?"":p)},""),a=o.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let c;for(;(c=l.exec(a))!==null;)r.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(r.sort((h,u)=>h.start-u.start),r.length>0){let h=0;const u=r.reduce((f,d)=>{const p=" ".repeat(d.start-h),g="^".repeat(d.length);return h=d.start+d.length,f+p+g},"");throw new $t(`Path parameters result in path with invalid segments:
${r.map(f=>f.error).join(`
`)}
${o}
${u}`)}return o},Vs=wQ(sw);class nw extends ur{list(t={},e){const{betas:s,...n}=t??{};return this._client.getAPIList("/v1/files",mh,{query:n,...e,headers:me([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},e?.headers])})}delete(t,e={},s){const{betas:n}=e??{};return this._client.delete(Vs`/v1/files/${t}`,{...s,headers:me([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString()},s?.headers])})}download(t,e={},s){const{betas:n}=e??{};return this._client.get(Vs`/v1/files/${t}/content`,{...s,headers:me([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}retrieveMetadata(t,e={},s){const{betas:n}=e??{};return this._client.get(Vs`/v1/files/${t}`,{...s,headers:me([{"anthropic-beta":[...n??[],"files-api-2025-04-14"].toString()},s?.headers])})}upload(t,e){const{betas:s,...n}=t;return this._client.post("/v1/files",gQ({body:n,...e,headers:me([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},e?.headers])},this._client))}}let rw=class extends ur{retrieve(t,e={},s){const{betas:n}=e??{};return this._client.get(Vs`/v1/models/${t}?beta=true`,{...s,headers:me([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},s?.headers])})}list(t={},e){const{betas:s,...n}=t??{};return this._client.getAPIList("/v1/models?beta=true",mh,{query:n,...e,headers:me([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},e?.headers])})}};class ip{constructor(t,e){this.iterator=t,this.controller=e}async*decoder(){const t=new gh;for await(const e of this.iterator)for(const s of t.decode(e))yield JSON.parse(s);for(const e of t.flush())yield JSON.parse(e)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new $t("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new $t("Attempted to iterate over a response with no body");return new ip(IO(t.body),e)}}let ow=class extends ur{create(t,e){const{betas:s,...n}=t;return this._client.post("/v1/messages/batches?beta=true",{body:n,...e,headers:me([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},e?.headers])})}retrieve(t,e={},s){const{betas:n}=e??{};return this._client.get(Vs`/v1/messages/batches/${t}?beta=true`,{...s,headers:me([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},s?.headers])})}list(t={},e){const{betas:s,...n}=t??{};return this._client.getAPIList("/v1/messages/batches?beta=true",mh,{query:n,...e,headers:me([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},e?.headers])})}delete(t,e={},s){const{betas:n}=e??{};return this._client.delete(Vs`/v1/messages/batches/${t}?beta=true`,{...s,headers:me([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},s?.headers])})}cancel(t,e={},s){const{betas:n}=e??{};return this._client.post(Vs`/v1/messages/batches/${t}/cancel?beta=true`,{...s,headers:me([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString()},s?.headers])})}async results(t,e={},s){const n=await this.retrieve(t);if(!n.results_url)throw new $t(`No batch \`results_url\`; Has it finished processing? ${n.processing_status} - ${n.id}`);const{betas:r}=e??{};return this._client.get(n.results_url,{...s,headers:me([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},s?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((o,a)=>ip.fromResponse(a.response,a.controller))}};const kQ=i=>{let t=0,e=[];for(;t<i.length;){let s=i[t];if(s==="\\"){t++;continue}if(s==="{"){e.push({type:"brace",value:"{"}),t++;continue}if(s==="}"){e.push({type:"brace",value:"}"}),t++;continue}if(s==="["){e.push({type:"paren",value:"["}),t++;continue}if(s==="]"){e.push({type:"paren",value:"]"}),t++;continue}if(s===":"){e.push({type:"separator",value:":"}),t++;continue}if(s===","){e.push({type:"delimiter",value:","}),t++;continue}if(s==='"'){let a="",l=!1;for(s=i[++t];s!=='"';){if(t===i.length){l=!0;break}if(s==="\\"){if(t++,t===i.length){l=!0;break}a+=s+i[t],s=i[++t]}else a+=s,s=i[++t]}s=i[++t],l||e.push({type:"string",value:a});continue}if(s&&/\s/.test(s)){t++;continue}let r=/[0-9]/;if(s&&r.test(s)||s==="-"||s==="."){let a="";for(s==="-"&&(a+=s,s=i[++t]);s&&r.test(s)||s===".";)a+=s,s=i[++t];e.push({type:"number",value:a});continue}let o=/[a-z]/i;if(s&&o.test(s)){let a="";for(;s&&o.test(s)&&t!==i.length;)a+=s,s=i[++t];if(a=="true"||a=="false"||a==="null")e.push({type:"name",value:a});else{t++;continue}continue}t++}return e},la=i=>{if(i.length===0)return i;let t=i[i.length-1];switch(t.type){case"separator":return i=i.slice(0,i.length-1),la(i);case"number":let e=t.value[t.value.length-1];if(e==="."||e==="-")return i=i.slice(0,i.length-1),la(i);case"string":let s=i[i.length-2];if(s?.type==="delimiter")return i=i.slice(0,i.length-1),la(i);if(s?.type==="brace"&&s.value==="{")return i=i.slice(0,i.length-1),la(i);break;case"delimiter":return i=i.slice(0,i.length-1),la(i)}return i},CQ=i=>{let t=[];return i.map(e=>{e.type==="brace"&&(e.value==="{"?t.push("}"):t.splice(t.lastIndexOf("}"),1)),e.type==="paren"&&(e.value==="["?t.push("]"):t.splice(t.lastIndexOf("]"),1))}),t.length>0&&t.reverse().map(e=>{e==="}"?i.push({type:"brace",value:"}"}):e==="]"&&i.push({type:"paren",value:"]"})}),i},TQ=i=>{let t="";return i.map(e=>{switch(e.type){case"string":t+='"'+e.value+'"';break;default:t+=e.value;break}}),t},aw=i=>JSON.parse(TQ(CQ(la(kQ(i)))));var us,gr,xl,iu,Sl,wl,su,kl,In,Cl,nu,ru,ia,ou,au,Zp,xb,lu,Fp,Wp,qp,Sb;const wb="__json_buf";function kb(i){return i.type==="tool_use"||i.type==="server_tool_use"||i.type==="mcp_tool_use"}class Vf{constructor(){us.add(this),this.messages=[],this.receivedMessages=[],gr.set(this,void 0),this.controller=new AbortController,xl.set(this,void 0),iu.set(this,()=>{}),Sl.set(this,()=>{}),wl.set(this,void 0),su.set(this,()=>{}),kl.set(this,()=>{}),In.set(this,{}),Cl.set(this,!1),nu.set(this,!1),ru.set(this,!1),ia.set(this,!1),ou.set(this,void 0),au.set(this,void 0),lu.set(this,t=>{if(Ot(this,nu,!0),Rc(t)&&(t=new $s),t instanceof $s)return Ot(this,ru,!0),this._emit("abort",t);if(t instanceof $t)return this._emit("error",t);if(t instanceof Error){const e=new $t(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new $t(String(t)))}),Ot(this,xl,new Promise((t,e)=>{Ot(this,iu,t,"f"),Ot(this,Sl,e,"f")})),Ot(this,wl,new Promise((t,e)=>{Ot(this,su,t,"f"),Ot(this,kl,e,"f")})),W(this,xl,"f").catch(()=>{}),W(this,wl,"f").catch(()=>{})}get response(){return W(this,ou,"f")}get request_id(){return W(this,au,"f")}async withResponse(){const t=await W(this,xl,"f");if(!t)throw new Error("Could not resolve a `Response` object");return{data:this,response:t,request_id:t.headers.get("request-id")}}static fromReadableStream(t){const e=new Vf;return e._run(()=>e._fromReadableStream(t)),e}static createMessage(t,e,s){const n=new Vf;for(const r of e.messages)n._addMessageParam(r);return n._run(()=>n._createMessage(t,{...e,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}_run(t){t().then(()=>{this._emitFinal(),this._emit("end")},W(this,lu,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,e=!0){this.receivedMessages.push(t),e&&this._emit("message",t)}async _createMessage(t,e,s){const n=s?.signal;let r;n&&(n.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),n.addEventListener("abort",r));try{W(this,us,"m",Fp).call(this);const{response:o,data:a}=await t.create({...e,stream:!0},{...s,signal:this.controller.signal}).withResponse();this._connected(o);for await(const l of a)W(this,us,"m",Wp).call(this,l);if(a.controller.signal?.aborted)throw new $s;W(this,us,"m",qp).call(this)}finally{n&&r&&n.removeEventListener("abort",r)}}_connected(t){this.ended||(Ot(this,ou,t),Ot(this,au,t?.headers.get("request-id")),W(this,iu,"f").call(this,t),this._emit("connect"))}get ended(){return W(this,Cl,"f")}get errored(){return W(this,nu,"f")}get aborted(){return W(this,ru,"f")}abort(){this.controller.abort()}on(t,e){return(W(this,In,"f")[t]||(W(this,In,"f")[t]=[])).push({listener:e}),this}off(t,e){const s=W(this,In,"f")[t];if(!s)return this;const n=s.findIndex(r=>r.listener===e);return n>=0&&s.splice(n,1),this}once(t,e){return(W(this,In,"f")[t]||(W(this,In,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise((e,s)=>{Ot(this,ia,!0),t!=="error"&&this.once("error",s),this.once(t,e)})}async done(){Ot(this,ia,!0),await W(this,wl,"f")}get currentMessage(){return W(this,gr,"f")}async finalMessage(){return await this.done(),W(this,us,"m",Zp).call(this)}async finalText(){return await this.done(),W(this,us,"m",xb).call(this)}_emit(t,...e){if(W(this,Cl,"f"))return;t==="end"&&(Ot(this,Cl,!0),W(this,su,"f").call(this));const s=W(this,In,"f")[t];if(s&&(W(this,In,"f")[t]=s.filter(n=>!n.once),s.forEach(({listener:n})=>n(...e))),t==="abort"){const n=e[0];!W(this,ia,"f")&&!s?.length&&Promise.reject(n),W(this,Sl,"f").call(this,n),W(this,kl,"f").call(this,n),this._emit("end");return}if(t==="error"){const n=e[0];!W(this,ia,"f")&&!s?.length&&Promise.reject(n),W(this,Sl,"f").call(this,n),W(this,kl,"f").call(this,n),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",W(this,us,"m",Zp).call(this))}async _fromReadableStream(t,e){const s=e?.signal;let n;s&&(s.aborted&&this.controller.abort(),n=this.controller.abort.bind(this.controller),s.addEventListener("abort",n));try{W(this,us,"m",Fp).call(this),this._connected(null);const r=dn.fromReadableStream(t,this.controller);for await(const o of r)W(this,us,"m",Wp).call(this,o);if(r.controller.signal?.aborted)throw new $s;W(this,us,"m",qp).call(this)}finally{s&&n&&s.removeEventListener("abort",n)}}[(gr=new WeakMap,xl=new WeakMap,iu=new WeakMap,Sl=new WeakMap,wl=new WeakMap,su=new WeakMap,kl=new WeakMap,In=new WeakMap,Cl=new WeakMap,nu=new WeakMap,ru=new WeakMap,ia=new WeakMap,ou=new WeakMap,au=new WeakMap,lu=new WeakMap,us=new WeakSet,Zp=function(){if(this.receivedMessages.length===0)throw new $t("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},xb=function(){if(this.receivedMessages.length===0)throw new $t("stream ended without producing a Message with role=assistant");const e=this.receivedMessages.at(-1).content.filter(s=>s.type==="text").map(s=>s.text);if(e.length===0)throw new $t("stream ended without producing a content block with type=text");return e.join(" ")},Fp=function(){this.ended||Ot(this,gr,void 0)},Wp=function(e){if(this.ended)return;const s=W(this,us,"m",Sb).call(this,e);switch(this._emit("streamEvent",e,s),e.type){case"content_block_delta":{const n=s.content.at(-1);switch(e.delta.type){case"text_delta":{n.type==="text"&&this._emit("text",e.delta.text,n.text||"");break}case"citations_delta":{n.type==="text"&&this._emit("citation",e.delta.citation,n.citations??[]);break}case"input_json_delta":{kb(n)&&n.input&&this._emit("inputJson",e.delta.partial_json,n.input);break}case"thinking_delta":{n.type==="thinking"&&this._emit("thinking",e.delta.thinking,n.thinking);break}case"signature_delta":{n.type==="thinking"&&this._emit("signature",n.signature);break}default:e.delta}break}case"message_stop":{this._addMessageParam(s),this._addMessage(s,!0);break}case"content_block_stop":{this._emit("contentBlock",s.content.at(-1));break}case"message_start":{Ot(this,gr,s);break}}},qp=function(){if(this.ended)throw new $t("stream has ended, this shouldn't happen");const e=W(this,gr,"f");if(!e)throw new $t("request ended without sending any chunks");return Ot(this,gr,void 0),e},Sb=function(e){let s=W(this,gr,"f");if(e.type==="message_start"){if(s)throw new $t(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!s)throw new $t(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":return s;case"message_delta":return s.container=e.delta.container,s.stop_reason=e.delta.stop_reason,s.stop_sequence=e.delta.stop_sequence,s.usage.output_tokens=e.usage.output_tokens,s.context_management=e.context_management,e.usage.input_tokens!=null&&(s.usage.input_tokens=e.usage.input_tokens),e.usage.cache_creation_input_tokens!=null&&(s.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),e.usage.cache_read_input_tokens!=null&&(s.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),e.usage.server_tool_use!=null&&(s.usage.server_tool_use=e.usage.server_tool_use),s;case"content_block_start":return s.content.push(e.content_block),s;case"content_block_delta":{const n=s.content.at(e.index);switch(e.delta.type){case"text_delta":{n?.type==="text"&&(s.content[e.index]={...n,text:(n.text||"")+e.delta.text});break}case"citations_delta":{n?.type==="text"&&(s.content[e.index]={...n,citations:[...n.citations??[],e.delta.citation]});break}case"input_json_delta":{if(n&&kb(n)){let r=n[wb]||"";r+=e.delta.partial_json;const o={...n};if(Object.defineProperty(o,wb,{value:r,enumerable:!1,writable:!0}),r)try{o.input=aw(r)}catch(a){const l=new $t(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${a}. JSON: ${r}`);W(this,lu,"f").call(this,l)}s.content[e.index]=o}break}case"thinking_delta":{n?.type==="thinking"&&(s.content[e.index]={...n,thinking:n.thinking+e.delta.thinking});break}case"signature_delta":{n?.type==="thinking"&&(s.content[e.index]={...n,signature:e.delta.signature});break}default:e.delta}return s}case"content_block_stop":return s}},Symbol.asyncIterator)](){const t=[],e=[];let s=!1;return this.on("streamEvent",n=>{const r=e.shift();r?r.resolve(n):t.push(n)}),this.on("end",()=>{s=!0;for(const n of e)n.resolve(void 0);e.length=0}),this.on("abort",n=>{s=!0;for(const r of e)r.reject(n);e.length=0}),this.on("error",n=>{s=!0;for(const r of e)r.reject(n);e.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((r,o)=>e.push({resolve:r,reject:o})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new dn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}const lw={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192,"claude-opus-4-1-20250805":8192,"anthropic.claude-opus-4-1-20250805-v1:0":8192,"claude-opus-4-1@20250805":8192};var cu,sa,ho,Ni,Tl,en,Wn,mr,Pl,mm;function Cb(){let i,t;return{promise:new Promise((s,n)=>{i=s,t=n}),resolve:i,reject:t}}class cw{constructor(t,e,s){cu.add(this),this.client=t,sa.set(this,!1),ho.set(this,!1),Ni.set(this,void 0),Tl.set(this,void 0),en.set(this,void 0),Wn.set(this,void 0),mr.set(this,void 0),Pl.set(this,0),Ot(this,Ni,{params:{...e,messages:structuredClone(e.messages)}}),Ot(this,Tl,{...s,headers:me([{"x-stainless-helper":"BetaToolRunner"},s?.headers])}),Ot(this,mr,Cb())}async*[(sa=new WeakMap,ho=new WeakMap,Ni=new WeakMap,Tl=new WeakMap,en=new WeakMap,Wn=new WeakMap,mr=new WeakMap,Pl=new WeakMap,cu=new WeakSet,Symbol.asyncIterator)](){var t;if(W(this,sa,"f"))throw new $t("Cannot iterate over a consumed stream");Ot(this,sa,!0),Ot(this,ho,!0),Ot(this,Wn,void 0);try{for(;;){let e;try{if(W(this,Ni,"f").params.max_iterations&&W(this,Pl,"f")>=W(this,Ni,"f").params.max_iterations)break;Ot(this,ho,!1,"f"),Ot(this,en,void 0,"f"),Ot(this,Wn,void 0,"f"),Ot(this,Pl,(t=W(this,Pl,"f"),t++,t),"f");const{max_iterations:s,...n}=W(this,Ni,"f").params;if(n.stream?(e=this.client.beta.messages.stream({...n},W(this,Tl,"f")),Ot(this,en,e.finalMessage(),"f"),yield e):(Ot(this,en,this.client.beta.messages.create({...n,stream:!1},W(this,Tl,"f")),"f"),yield W(this,en,"f")),!W(this,ho,"f")){const{role:o,content:a}=await W(this,en,"f");W(this,Ni,"f").params.messages.push({role:o,content:a})}const r=await W(this,cu,"m",mm).call(this,W(this,Ni,"f").params.messages.at(-1));if(r&&W(this,Ni,"f").params.messages.push(r),!r&&!W(this,ho,"f"))break}finally{e&&e.abort()}}if(!W(this,en,"f"))throw new $t("ToolRunner concluded without a message from the server");W(this,mr,"f").resolve(await W(this,en,"f"))}catch(e){throw Ot(this,sa,!1),W(this,mr,"f").promise.catch(()=>{}),W(this,mr,"f").reject(e),Ot(this,mr,Cb()),e}}setMessagesParams(t){typeof t=="function"?W(this,Ni,"f").params=t(W(this,Ni,"f").params):W(this,Ni,"f").params=t,Ot(this,ho,!0),Ot(this,Wn,void 0)}async generateToolResponse(){const t=await W(this,en,"f")??this.params.messages.at(-1);return t?W(this,cu,"m",mm).call(this,t):null}done(){return W(this,mr,"f").promise}async runUntilDone(){if(!W(this,sa,"f"))for await(const t of this);return this.done()}get params(){return W(this,Ni,"f").params}pushMessages(...t){this.setMessagesParams(e=>({...e,messages:[...e.messages,...t]}))}then(t,e){return this.runUntilDone().then(t,e)}}mm=async function(t){return W(this,Wn,"f")!==void 0?W(this,Wn,"f"):(Ot(this,Wn,PQ(W(this,Ni,"f").params,t)),W(this,Wn,"f"))};async function PQ(i,t=i.messages.at(-1)){if(!t||t.role!=="assistant"||!t.content||typeof t.content=="string")return null;const e=t.content.filter(n=>n.type==="tool_use");return e.length===0?null:{role:"user",content:await Promise.all(e.map(async n=>{const r=i.tools.find(o=>o.name===n.name);if(!r||!("run"in r))return{type:"tool_result",tool_use_id:n.id,content:`Error: Tool '${n.name}' not found`,is_error:!0};try{let o=n.input;"parse"in r&&r.parse&&(o=r.parse(o));const a=await r.run(o);return{type:"tool_result",tool_use_id:n.id,content:a}}catch(o){return{type:"tool_result",tool_use_id:n.id,content:`Error: ${o instanceof Error?o.message:String(o)}`,is_error:!0}}}))}}const Tb={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-5-sonnet-20241022":"October 22, 2025","claude-3-5-sonnet-20240620":"October 22, 2025"};let sp=class extends ur{constructor(){super(...arguments),this.batches=new ow(this._client)}create(t,e){const{betas:s,...n}=t;n.model in Tb&&console.warn(`The model '${n.model}' is deprecated and will reach end-of-life on ${Tb[n.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let r=this._client._options.timeout;if(!n.stream&&r==null){const o=lw[n.model]??void 0;r=this._client.calculateNonstreamingTimeout(n.max_tokens,o)}return this._client.post("/v1/messages?beta=true",{body:n,timeout:r??6e5,...e,headers:me([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},e?.headers]),stream:t.stream??!1})}stream(t,e){return Vf.createMessage(this,t,e)}countTokens(t,e){const{betas:s,...n}=t;return this._client.post("/v1/messages/count_tokens?beta=true",{body:n,...e,headers:me([{"anthropic-beta":[...s??[],"token-counting-2024-11-01"].toString()},e?.headers])})}toolRunner(t,e){return new cw(this._client,t,e)}};sp.Batches=ow;sp.BetaToolRunner=cw;class Oh extends ur{constructor(){super(...arguments),this.models=new rw(this._client),this.messages=new sp(this._client),this.files=new nw(this._client)}}Oh.Models=rw;Oh.Messages=sp;Oh.Files=nw;class hw extends ur{create(t,e){const{betas:s,...n}=t;return this._client.post("/v1/complete",{body:n,timeout:this._client._options.timeout??6e5,...e,headers:me([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},e?.headers]),stream:t.stream??!1})}}var fs,Or,Al,hu,Ml,El,uu,Rl,$n,Ql,fu,du,na,pu,gu,Xp,Pb,zp,jp,Gp,Yp,Ab;const Mb="__json_buf";function Eb(i){return i.type==="tool_use"||i.type==="server_tool_use"}class Bf{constructor(){fs.add(this),this.messages=[],this.receivedMessages=[],Or.set(this,void 0),this.controller=new AbortController,Al.set(this,void 0),hu.set(this,()=>{}),Ml.set(this,()=>{}),El.set(this,void 0),uu.set(this,()=>{}),Rl.set(this,()=>{}),$n.set(this,{}),Ql.set(this,!1),fu.set(this,!1),du.set(this,!1),na.set(this,!1),pu.set(this,void 0),gu.set(this,void 0),zp.set(this,t=>{if(Ot(this,fu,!0),Rc(t)&&(t=new $s),t instanceof $s)return Ot(this,du,!0),this._emit("abort",t);if(t instanceof $t)return this._emit("error",t);if(t instanceof Error){const e=new $t(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new $t(String(t)))}),Ot(this,Al,new Promise((t,e)=>{Ot(this,hu,t,"f"),Ot(this,Ml,e,"f")})),Ot(this,El,new Promise((t,e)=>{Ot(this,uu,t,"f"),Ot(this,Rl,e,"f")})),W(this,Al,"f").catch(()=>{}),W(this,El,"f").catch(()=>{})}get response(){return W(this,pu,"f")}get request_id(){return W(this,gu,"f")}async withResponse(){const t=await W(this,Al,"f");if(!t)throw new Error("Could not resolve a `Response` object");return{data:this,response:t,request_id:t.headers.get("request-id")}}static fromReadableStream(t){const e=new Bf;return e._run(()=>e._fromReadableStream(t)),e}static createMessage(t,e,s){const n=new Bf;for(const r of e.messages)n._addMessageParam(r);return n._run(()=>n._createMessage(t,{...e,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}_run(t){t().then(()=>{this._emitFinal(),this._emit("end")},W(this,zp,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,e=!0){this.receivedMessages.push(t),e&&this._emit("message",t)}async _createMessage(t,e,s){const n=s?.signal;let r;n&&(n.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),n.addEventListener("abort",r));try{W(this,fs,"m",jp).call(this);const{response:o,data:a}=await t.create({...e,stream:!0},{...s,signal:this.controller.signal}).withResponse();this._connected(o);for await(const l of a)W(this,fs,"m",Gp).call(this,l);if(a.controller.signal?.aborted)throw new $s;W(this,fs,"m",Yp).call(this)}finally{n&&r&&n.removeEventListener("abort",r)}}_connected(t){this.ended||(Ot(this,pu,t),Ot(this,gu,t?.headers.get("request-id")),W(this,hu,"f").call(this,t),this._emit("connect"))}get ended(){return W(this,Ql,"f")}get errored(){return W(this,fu,"f")}get aborted(){return W(this,du,"f")}abort(){this.controller.abort()}on(t,e){return(W(this,$n,"f")[t]||(W(this,$n,"f")[t]=[])).push({listener:e}),this}off(t,e){const s=W(this,$n,"f")[t];if(!s)return this;const n=s.findIndex(r=>r.listener===e);return n>=0&&s.splice(n,1),this}once(t,e){return(W(this,$n,"f")[t]||(W(this,$n,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise((e,s)=>{Ot(this,na,!0),t!=="error"&&this.once("error",s),this.once(t,e)})}async done(){Ot(this,na,!0),await W(this,El,"f")}get currentMessage(){return W(this,Or,"f")}async finalMessage(){return await this.done(),W(this,fs,"m",Xp).call(this)}async finalText(){return await this.done(),W(this,fs,"m",Pb).call(this)}_emit(t,...e){if(W(this,Ql,"f"))return;t==="end"&&(Ot(this,Ql,!0),W(this,uu,"f").call(this));const s=W(this,$n,"f")[t];if(s&&(W(this,$n,"f")[t]=s.filter(n=>!n.once),s.forEach(({listener:n})=>n(...e))),t==="abort"){const n=e[0];!W(this,na,"f")&&!s?.length&&Promise.reject(n),W(this,Ml,"f").call(this,n),W(this,Rl,"f").call(this,n),this._emit("end");return}if(t==="error"){const n=e[0];!W(this,na,"f")&&!s?.length&&Promise.reject(n),W(this,Ml,"f").call(this,n),W(this,Rl,"f").call(this,n),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",W(this,fs,"m",Xp).call(this))}async _fromReadableStream(t,e){const s=e?.signal;let n;s&&(s.aborted&&this.controller.abort(),n=this.controller.abort.bind(this.controller),s.addEventListener("abort",n));try{W(this,fs,"m",jp).call(this),this._connected(null);const r=dn.fromReadableStream(t,this.controller);for await(const o of r)W(this,fs,"m",Gp).call(this,o);if(r.controller.signal?.aborted)throw new $s;W(this,fs,"m",Yp).call(this)}finally{s&&n&&s.removeEventListener("abort",n)}}[(Or=new WeakMap,Al=new WeakMap,hu=new WeakMap,Ml=new WeakMap,El=new WeakMap,uu=new WeakMap,Rl=new WeakMap,$n=new WeakMap,Ql=new WeakMap,fu=new WeakMap,du=new WeakMap,na=new WeakMap,pu=new WeakMap,gu=new WeakMap,zp=new WeakMap,fs=new WeakSet,Xp=function(){if(this.receivedMessages.length===0)throw new $t("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},Pb=function(){if(this.receivedMessages.length===0)throw new $t("stream ended without producing a Message with role=assistant");const e=this.receivedMessages.at(-1).content.filter(s=>s.type==="text").map(s=>s.text);if(e.length===0)throw new $t("stream ended without producing a content block with type=text");return e.join(" ")},jp=function(){this.ended||Ot(this,Or,void 0)},Gp=function(e){if(this.ended)return;const s=W(this,fs,"m",Ab).call(this,e);switch(this._emit("streamEvent",e,s),e.type){case"content_block_delta":{const n=s.content.at(-1);switch(e.delta.type){case"text_delta":{n.type==="text"&&this._emit("text",e.delta.text,n.text||"");break}case"citations_delta":{n.type==="text"&&this._emit("citation",e.delta.citation,n.citations??[]);break}case"input_json_delta":{Eb(n)&&n.input&&this._emit("inputJson",e.delta.partial_json,n.input);break}case"thinking_delta":{n.type==="thinking"&&this._emit("thinking",e.delta.thinking,n.thinking);break}case"signature_delta":{n.type==="thinking"&&this._emit("signature",n.signature);break}default:e.delta}break}case"message_stop":{this._addMessageParam(s),this._addMessage(s,!0);break}case"content_block_stop":{this._emit("contentBlock",s.content.at(-1));break}case"message_start":{Ot(this,Or,s);break}}},Yp=function(){if(this.ended)throw new $t("stream has ended, this shouldn't happen");const e=W(this,Or,"f");if(!e)throw new $t("request ended without sending any chunks");return Ot(this,Or,void 0),e},Ab=function(e){let s=W(this,Or,"f");if(e.type==="message_start"){if(s)throw new $t(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!s)throw new $t(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":return s;case"message_delta":return s.stop_reason=e.delta.stop_reason,s.stop_sequence=e.delta.stop_sequence,s.usage.output_tokens=e.usage.output_tokens,e.usage.input_tokens!=null&&(s.usage.input_tokens=e.usage.input_tokens),e.usage.cache_creation_input_tokens!=null&&(s.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),e.usage.cache_read_input_tokens!=null&&(s.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),e.usage.server_tool_use!=null&&(s.usage.server_tool_use=e.usage.server_tool_use),s;case"content_block_start":return s.content.push({...e.content_block}),s;case"content_block_delta":{const n=s.content.at(e.index);switch(e.delta.type){case"text_delta":{n?.type==="text"&&(s.content[e.index]={...n,text:(n.text||"")+e.delta.text});break}case"citations_delta":{n?.type==="text"&&(s.content[e.index]={...n,citations:[...n.citations??[],e.delta.citation]});break}case"input_json_delta":{if(n&&Eb(n)){let r=n[Mb]||"";r+=e.delta.partial_json;const o={...n};Object.defineProperty(o,Mb,{value:r,enumerable:!1,writable:!0}),r&&(o.input=aw(r)),s.content[e.index]=o}break}case"thinking_delta":{n?.type==="thinking"&&(s.content[e.index]={...n,thinking:n.thinking+e.delta.thinking});break}case"signature_delta":{n?.type==="thinking"&&(s.content[e.index]={...n,signature:e.delta.signature});break}default:e.delta}return s}case"content_block_stop":return s}},Symbol.asyncIterator)](){const t=[],e=[];let s=!1;return this.on("streamEvent",n=>{const r=e.shift();r?r.resolve(n):t.push(n)}),this.on("end",()=>{s=!0;for(const n of e)n.resolve(void 0);e.length=0}),this.on("abort",n=>{s=!0;for(const r of e)r.reject(n);e.length=0}),this.on("error",n=>{s=!0;for(const r of e)r.reject(n);e.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((r,o)=>e.push({resolve:r,reject:o})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new dn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class uw extends ur{create(t,e){return this._client.post("/v1/messages/batches",{body:t,...e})}retrieve(t,e){return this._client.get(Vs`/v1/messages/batches/${t}`,e)}list(t={},e){return this._client.getAPIList("/v1/messages/batches",mh,{query:t,...e})}delete(t,e){return this._client.delete(Vs`/v1/messages/batches/${t}`,e)}cancel(t,e){return this._client.post(Vs`/v1/messages/batches/${t}/cancel`,e)}async results(t,e){const s=await this.retrieve(t);if(!s.results_url)throw new $t(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);return this._client.get(s.results_url,{...e,headers:me([{Accept:"application/binary"},e?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((n,r)=>ip.fromResponse(r.response,r.controller))}}class NO extends ur{constructor(){super(...arguments),this.batches=new uw(this._client)}create(t,e){t.model in Rb&&console.warn(`The model '${t.model}' is deprecated and will reach end-of-life on ${Rb[t.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let s=this._client._options.timeout;if(!t.stream&&s==null){const n=lw[t.model]??void 0;s=this._client.calculateNonstreamingTimeout(t.max_tokens,n)}return this._client.post("/v1/messages",{body:t,timeout:s??6e5,...e,stream:t.stream??!1})}stream(t,e){return Bf.createMessage(this,t,e)}countTokens(t,e){return this._client.post("/v1/messages/count_tokens",{body:t,...e})}}const Rb={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-5-sonnet-20241022":"October 22, 2025","claude-3-5-sonnet-20240620":"October 22, 2025"};NO.Batches=uw;class fw extends ur{retrieve(t,e={},s){const{betas:n}=e??{};return this._client.get(Vs`/v1/models/${t}`,{...s,headers:me([{...n?.toString()!=null?{"anthropic-beta":n?.toString()}:void 0},s?.headers])})}list(t={},e){const{betas:s,...n}=t??{};return this._client.getAPIList("/v1/models",mh,{query:n,...e,headers:me([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},e?.headers])})}}var AQ={};const mu=i=>{if(typeof globalThis.process<"u")return AQ?.[i]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(i)?.trim()};var Om,DO,Uu,dw;const MQ="\\n\\nHuman:",EQ="\\n\\nAssistant:";class Fe{constructor({baseURL:t=mu("ANTHROPIC_BASE_URL"),apiKey:e=mu("ANTHROPIC_API_KEY")??null,authToken:s=mu("ANTHROPIC_AUTH_TOKEN")??null,...n}={}){Om.add(this),Uu.set(this,void 0);const r={apiKey:e,authToken:s,...n,baseURL:t||"https://api.anthropic.com"};if(!r.dangerouslyAllowBrowser&&HR())throw new $t(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });
`);this.baseURL=r.baseURL,this.timeout=r.timeout??DO.DEFAULT_TIMEOUT,this.logger=r.logger??console;const o="warn";this.logLevel=o,this.logLevel=yb(r.logLevel,"ClientOptions.logLevel",this)??yb(mu("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??o,this.fetchOptions=r.fetchOptions,this.maxRetries=r.maxRetries??2,this.fetch=r.fetch??iQ(),Ot(this,Uu,nQ),this._options=r,this.apiKey=e,this.authToken=s}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:e}){if(!(this.apiKey&&t.get("x-api-key"))&&!e.has("x-api-key")&&!(this.authToken&&t.get("authorization"))&&!e.has("authorization"))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(t){return me([await this.apiKeyAuth(t),await this.bearerAuth(t)])}async apiKeyAuth(t){if(this.apiKey!=null)return me([{"X-Api-Key":this.apiKey}])}async bearerAuth(t){if(this.authToken!=null)return me([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(t){return Object.entries(t).filter(([e,s])=>typeof s<"u").map(([e,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(e)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(e)}=`;throw new $t(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${aa}`}defaultIdempotencyKey(){return`stainless-node-retry-${LS()}`}makeStatusError(t,e,s,n){return Oi.generate(t,e,s,n)}buildURL(t,e,s){const n=!W(this,Om,"m",dw).call(this)&&s||this.baseURL,r=zR(t)?new URL(t):new URL(n+(n.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return jR(o)||(e={...o,...e}),typeof e=="object"&&e&&!Array.isArray(e)&&(r.search=this.stringifyQuery(e)),r.toString()}_calculateNonstreamingTimeout(t){if(3600*t/128e3>600)throw new $t("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 600*1e3}async prepareOptions(t){}async prepareRequest(t,{url:e,options:s}){}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,s){return this.request(Promise.resolve(s).then(n=>({method:t,path:e,...n})))}request(t,e=null){return new ep(this,this.makeRequest(t,e,void 0))}async makeRequest(t,e,s){const n=await t,r=n.maxRetries??this.maxRetries;e==null&&(e=r),await this.prepareOptions(n);const{req:o,url:a,timeout:l}=await this.buildRequest(n,{retryCount:r-e});await this.prepareRequest(o,{url:a,options:n});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),h=s===void 0?"":`, retryOf: ${s}`,u=Date.now();if(xi(this).debug(`[${c}] sending request`,po({retryOfRequestLogID:s,method:n.method,url:a,options:n,headers:o.headers})),n.signal?.aborted)throw new $s;const f=new AbortController,d=await this.fetchWithTimeout(a,o,l,f).catch(fm),p=Date.now();if(d instanceof globalThis.Error){const O=`retrying, ${e} attempts remaining`;if(n.signal?.aborted)throw new $s;const b=Rc(d)||/timed? ?out/i.test(String(d)+("cause"in d?String(d.cause):""));if(e)return xi(this).info(`[${c}] connection ${b?"timed out":"failed"} - ${O}`),xi(this).debug(`[${c}] connection ${b?"timed out":"failed"} (${O})`,po({retryOfRequestLogID:s,url:a,durationMs:p-u,message:d.message})),this.retryRequest(n,e,s??c);throw xi(this).info(`[${c}] connection ${b?"timed out":"failed"} - error; no more retries left`),xi(this).debug(`[${c}] connection ${b?"timed out":"failed"} (error; no more retries left)`,po({retryOfRequestLogID:s,url:a,durationMs:p-u,message:d.message})),b?new VS:new tp({cause:d})}const g=[...d.headers.entries()].filter(([O])=>O==="request-id").map(([O,b])=>", "+O+": "+JSON.stringify(b)).join(""),m=`[${c}${h}${g}] ${o.method} ${a} ${d.ok?"succeeded":"failed"} with status ${d.status} in ${p-u}ms`;if(!d.ok){const O=await this.shouldRetry(d);if(e&&O){const S=`retrying, ${e} attempts remaining`;return await sQ(d.body),xi(this).info(`${m} - ${S}`),xi(this).debug(`[${c}] response error (${S})`,po({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,durationMs:p-u})),this.retryRequest(n,e,s??c,d.headers)}const b=O?"error; no more retries left":"error; not retryable";xi(this).info(`${m} - ${b}`);const x=await d.text().catch(S=>fm(S).message),v=GS(x),y=v?void 0:x;throw xi(this).debug(`[${c}] response error (${b})`,po({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,message:y,durationMs:Date.now()-u})),this.makeStatusError(d.status,v,y,d.headers)}return xi(this).info(m),xi(this).debug(`[${c}] response start`,po({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,durationMs:p-u})),{response:d,options:n,controller:f,requestLogID:c,retryOfRequestLogID:s,startTime:u}}getAPIList(t,e,s){return this.requestAPIList(e,{method:"get",path:t,...s})}requestAPIList(t,e){const s=this.makeRequest(e,null,void 0);return new pQ(this,s,t)}async fetchWithTimeout(t,e,s,n){const{signal:r,method:o,...a}=e||{};r&&r.addEventListener("abort",()=>n.abort());const l=setTimeout(()=>n.abort(),s),c=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,h={signal:n.signal,...c?{duplex:"half"}:{},method:"GET",...a};o&&(h.method=o.toUpperCase());try{return await this.fetch.call(void 0,t,h)}finally{clearTimeout(l)}}async shouldRetry(t){const e=t.headers.get("x-should-retry");return e==="true"?!0:e==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,e,s,n){let r;const o=n?.get("retry-after-ms");if(o){const l=parseFloat(o);Number.isNaN(l)||(r=l)}const a=n?.get("retry-after");if(a&&!r){const l=parseFloat(a);Number.isNaN(l)?r=Date.parse(a)-Date.now():r=l*1e3}if(!(r&&0<=r&&r<60*1e3)){const l=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(e,l)}return await UR(r),this.makeRequest(t,e-1,s)}calculateDefaultRetryTimeoutMillis(t,e){const r=e-t,o=Math.min(.5*Math.pow(2,r),8),a=1-Math.random()*.25;return o*a*1e3}calculateNonstreamingTimeout(t,e){if(36e5*t/128e3>6e5||e!=null&&t>e)throw new $t("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(t,{retryCount:e=0}={}){const s={...t},{method:n,path:r,query:o,defaultBaseURL:a}=s,l=this.buildURL(r,o,a);"timeout"in s&&YR("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:c,body:h}=this.buildBody({options:s}),u=await this.buildHeaders({options:t,method:n,bodyHeaders:c,retryCount:e});return{req:{method:n,headers:u,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&h instanceof globalThis.ReadableStream&&{duplex:"half"},...h&&{body:h},...this.fetchOptions??{},...s.fetchOptions??{}},url:l,timeout:s.timeout}}async buildHeaders({options:t,method:e,bodyHeaders:s,retryCount:n}){let r={};this.idempotencyHeader&&e!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=t.idempotencyKey);const o=me([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(n),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...eQ(),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(t),this._options.defaultHeaders,s,t.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:t,headers:e}}){if(!t)return{bodyHeaders:void 0,body:void 0};const s=me([e]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&s.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:US(t)}:W(this,Uu,"f").call(this,{body:t,headers:s})}}DO=Fe,Uu=new WeakMap,Om=new WeakSet,dw=function(){return this.baseURL!=="https://api.anthropic.com"};Fe.Anthropic=DO;Fe.HUMAN_PROMPT=MQ;Fe.AI_PROMPT=EQ;Fe.DEFAULT_TIMEOUT=6e5;Fe.AnthropicError=$t;Fe.APIError=Oi;Fe.APIConnectionError=tp;Fe.APIConnectionTimeoutError=VS;Fe.APIUserAbortError=$s;Fe.NotFoundError=WS;Fe.ConflictError=qS;Fe.RateLimitError=zS;Fe.BadRequestError=BS;Fe.AuthenticationError=ZS;Fe.InternalServerError=jS;Fe.PermissionDeniedError=FS;Fe.UnprocessableEntityError=XS;Fe.toFile=_Q;class yh extends Fe{constructor(){super(...arguments),this.completions=new hw(this),this.messages=new NO(this),this.models=new fw(this),this.beta=new Oh(this)}}yh.Completions=hw;yh.Messages=NO;yh.Models=fw;yh.Beta=Oh;const RQ=512,QQ=10,Qb="claude-sonnet-4-5";function IQ(i,t){return i.slice(0,RQ).map((s,n)=>{const r=Math.max(0,Math.min(127,Math.round(s.pitch??60))),o=Math.max(0,s.position??0),a=1/t.subdivision,l=Math.max(a,s.duration??.25),c=Math.max(0,Math.min(127,s.velocity??100)),h=Math.max(a,t.maxLength-o);return{id:s.id||`note-${Date.now()}-${n}`,pitch:r,position:o,duration:Math.min(l,h),velocity:c}})}function $Q(i){const{getNotes:t,setNotes:e,getGrid:s,registry:n,listRolls:r,getNotesByRoll:o,setNotesByRoll:a,getGridByRoll:l,getSelectedRollId:c}=i,h=!!o&&!!r,u=Xt([]),f=Xt(!1),d=Xt(null),g=(()=>{const y={action:{type:"string",enum:["read","write"],description:"Whether to read current notes or write new notes"},notes:{type:"array",description:"Array of MIDI notes to write (only for 'write' action)",items:{type:"object",properties:{id:{type:"string",description:"Optional unique identifier"},pitch:{type:"number",minimum:0,maximum:127,description:"MIDI pitch (0-127, 60=middle C)"},position:{type:"number",minimum:0,description:"Note start position in quarter notes"},duration:{type:"number",minimum:0,description:"Note duration in quarter notes"},velocity:{type:"number",minimum:0,maximum:127,description:"Note velocity (0-127, default 100)"}},required:["pitch","position","duration"]}}};if(h&&r){const S=r().map(k=>`"${k.id}"${k.label?` (${k.label})`:""}`).join(", ");y.rollId={type:"string",description:`Optional roll ID to target. Available rolls: ${S}. Defaults to selected roll if omitted.`}}return{name:"midi_notes",description:"Read or write the piano roll MIDI notes. Use action='read' to fetch all notes. Use action='write' with a notes array to replace the current notes.",input_schema:{type:"object",properties:y,required:["action"]}}})(),m={name:"write_transform_function",description:"Create or overwrite a transform function in a given slot (0-7). Provide complete JavaScript code with a function named 'transform' that takes notes as first parameter, followed by numeric parameters. Include JSDoc comments with one line per parameter.",input_schema:{type:"object",properties:{slotIndex:{type:"number",minimum:0,maximum:7,description:"Slot index (0-7) where to write the transform"},code:{type:"string",description:"Complete JavaScript code defining the transform function"}},required:["slotIndex","code"]}};function O(){let y;if(h&&r&&l){const S=r();y=S.length>0?l(S[0].id):{maxLength:16,timeSignature:4,subdivision:16}}else s?y=s():y={maxLength:16,timeSignature:4,subdivision:16};let _=`You are a music composition assistant for a MIDI piano roll editor.

IMPORTANT RULES:
- Always use the midi_notes tool to read or write notes - never hallucinate note data
- Grid constraints: maxLength=${y.maxLength} quarter notes, timeSignature=${y.timeSignature}/4, subdivision=1/${y.subdivision}
- Time units: 1.0 represents one quarter note across all positions and durations
- When writing notes:
  - Pitch must be 0-127 (60=middle C, 62=D, 64=E, 65=F, 67=G, 69=A, 71=B, 72=high C)
  - Position must be >= 0 and position+duration should stay within maxLength
  - Duration must be > 0 (minimum 1/${y.subdivision} quarter notes recommended)
  - Velocity defaults to 100 if not specified (range 0-127)
- Keep responses concise and acknowledge changes after writing
- Consider musical context when suggesting edits (key, rhythm, harmony)
- When creating chords, use simultaneous notes at the same position`;if(h&&r){const k=r().map(A=>`"${A.id}"${A.label?` (${A.label})`:""}`).join(", ");_+=`

MULTI-ROLL MODE:
- Multiple piano rolls available: ${k}
- Always include the 'rollId' parameter when calling midi_notes to specify which roll to read/write
- If rollId is omitted, the currently selected roll will be used
- You can work with different rolls simultaneously by specifying the appropriate rollId`}return n&&(_+=`

TRANSFORM FUNCTIONS:
Before modifying notes, determine the best approach:
- For simple operations (add/remove individual notes, simple pitch/position changes), use midi_notes tool directly
- For pattern-based operations (transpose all notes, quantize, humanize), check if an existing transform tool matches
- For complex multi-step operations, consider combining multiple transform tools in sequence
- Only create new transforms if no existing tool or combination fits the need

Available transform tools:
${n.summarizeTransforms()}

When using a transform tool:
1. First, determine if you have all required parameter values
2. If any required parameter is missing and cannot be reasonably inferred from context, ask the user for it
3. Do NOT invoke the tool with placeholder or guessed values for missing required parameters
4. Optional parameters can be omitted if not provided

CREATING NEW TRANSFORMS:
Use write_transform_function(code, slotIndex) only when:
- The user explicitly asks you to create a transform function
- No existing transform or combination can accomplish the task
- The operation would be reusable for future requests

Transform code requirements:
- Must define a function with notes as the first parameter, followed by numeric parameters
- Function can have any name (e.g., transpose, quantize, humanize)
- First parameter must be 'notes' (the input array)
- Additional parameters must be numbers that configure the transformation
- Must include JSDoc with @param tags for each parameter
- Should return a new array, not modify input array

Example transform structure:
/**
 * Brief description of what this does.
 * @param {Note[]} notes - Input notes array
 * @param {number} paramName - Description and recommended range (e.g., 0-127, -12 to +12)
 * * ... - more parameters, as long as they are all numbers (and you need a description line for each)
 */
function myTransform(notes, paramName) {
  const newNotes = notes.map(n => ({...n}));
  // transform newNotes here
  return newNotes;
}`),_}async function b(y){let _=y.rollId,S,k,A;if(h&&o&&a&&l&&r){if(!_&&c&&(_=c()),!_){const M=r();_=M.length>0?M[0].id:"editor"}S=l(_),k=o(_),A=M=>a(_,M)}else if(t&&e&&s)S=s(),k=t(),A=e;else return{error:"Invalid configuration"};if(y.action==="read")return{notes:k,grid:S,rollId:_};if(y.action==="write"){const M=IQ(y.notes||[],S);return A(M),{status:"ok",count:M.length,grid:S,rollId:_}}return{error:"Invalid action"}}async function x(y,_){if(!_.trim()){d.value="Please provide an API key";return}if(y.trim()){u.value.push({role:"user",text:y,timestamp:Date.now()}),f.value=!0,d.value=null;try{const S=new yh({apiKey:_,dangerouslyAllowBrowser:!0}),k=[g],A=new Map;if(A.set("midi_notes",b),n){k.push(m),A.set("write_transform_function",async I=>{const Z=n.writeTransformFunction(I.slotIndex,I.code);return{status:Z.valid?"validated":"invalid",errors:Z.errors,toolName:Z.valid?`transform_slot_${I.slotIndex+1}`:void 0,params:Z.params}});const N=n.getToolDefs();k.push(...N),n.getToolHandlers().forEach((I,Z)=>{A.set(Z,I)})}const M=[{role:"user",content:y}];let R=await S.messages.create({model:Qb,system:O(),tools:k,max_tokens:1e3,messages:M});const C=[];for(let N=0;N<QQ;N++){const L=R.content.filter(Z=>Z.type==="tool_use");if(L.length===0)break;for(const Z of L){let F=Z.name;if(Z.name.startsWith("transform_slot_")&&n){const z=parseInt(Z.name.replace("transform_slot_",""))-1,et=n.slots[z];et&&et.functionName&&(F=et.functionName)}C.push({name:Z.name,displayName:F,input:Z.input})}M.push({role:"assistant",content:R.content});const I=[];for(const Z of L){const F=A.get(Z.name);if(F){const z=await F(Z.input);I.push({type:"tool_result",tool_use_id:Z.id,content:JSON.stringify(z)})}}M.push({role:"user",content:I}),R=await S.messages.create({model:Qb,system:O(),tools:k,max_tokens:1e3,messages:M})}const $=R.content.filter(N=>N.type==="text").map(N=>N.text).join(`
`);u.value.push({role:"assistant",text:$||"No response",timestamp:Date.now(),toolCalls:C.length>0?C:void 0})}catch(S){d.value=S.message||"Failed to communicate with Claude",console.error("Claude API error:",S)}finally{f.value=!1}}}function v(){u.value=[],d.value=null,f.value=!1}return{messages:u,isWaiting:f,error:d,send:x,reset:v}}const NQ={class:"claude-chat"},DQ={class:"chat-header"},LQ=["disabled"],VQ={class:"api-key-section"},BQ={class:"api-key-label-row"},ZQ=["type"],FQ={key:0,class:"warning"},WQ={class:"warning-content"},qQ={class:"modal-header"},XQ={class:"modal-footer"},zQ={key:0,class:"empty-state"},jQ={class:"message-header"},GQ={class:"role-label"},YQ={class:"timestamp"},UQ={key:0,class:"tool-calls"},HQ={class:"tool-name"},KQ={key:0,class:"tool-params"},JQ={class:"message-text"},tI={key:1,class:"message assistant waiting"},eI={key:1,class:"error-message"},iI={class:"input-container"},sI=["disabled"],nI=["disabled"],rI=Vo({__name:"ClaudeChat",props:{getNotes:{type:Function},setNotes:{type:Function},getGrid:{type:Function},listRolls:{type:Function},getNotesByRoll:{type:Function},setNotesByRoll:{type:Function},getGridByRoll:{type:Function},getSelectedRollId:{type:Function},registry:{}},setup(i){const t=i,e=$Q({getNotes:t.getNotes,setNotes:t.setNotes,getGrid:t.getGrid,listRolls:t.listRolls,getNotesByRoll:t.getNotesByRoll,setNotesByRoll:t.setNotesByRoll,getGridByRoll:t.getGridByRoll,getSelectedRollId:t.getSelectedRollId,registry:t.registry}),s=Xt(""),n=Xt(""),r=Xt(null),o=Xt(!0),a=Xt(!1),l=Xt(!1),c=async()=>{await Sd(),r.value&&(r.value.scrollTop=r.value.scrollHeight)},h=async()=>{if(!n.value.trim()||e.isWaiting.value)return;const d=n.value;n.value="",await e.send(d,s.value),await c()},u=d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),h())},f=d=>new Date(d).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(d,p)=>(Tt(),Rt("div",NQ,[X("div",DQ,[p[10]||(p[10]=X("h3",null,"AI Music Assistant",-1)),Te(e).messages.value.length>0?(Tt(),Rt("button",{key:0,onClick:p[0]||(p[0]=g=>Te(e).reset()),class:"reset-btn",disabled:Te(e).isWaiting.value}," Clear Chat ",8,LQ)):Ae("",!0)]),X("div",VQ,[X("div",BQ,[p[11]||(p[11]=X("label",{for:"api-key"},[Fi(" Claude API Key "),X("span",{class:"required"},"*")],-1)),X("button",{type:"button",onClick:p[1]||(p[1]=g=>a.value=!a.value),class:"toggle-visibility-btn"},Ie(a.value?" Hide":" Show"),1)]),Ar(X("input",{id:"api-key","onUpdate:modelValue":p[2]||(p[2]=g=>s.value=g),type:a.value?"text":"password",placeholder:"sk-ant-...",class:"api-key-input",autocomplete:"off",spellcheck:"false"},null,8,ZQ),[[k4,s.value]]),o.value?(Tt(),Rt("div",FQ,[p[14]||(p[14]=X("span",{class:"warning-icon"},"",-1)),X("div",WQ,[p[12]||(p[12]=X("strong",null,"Security Warning:",-1)),p[13]||(p[13]=Fi(" This API key is exposed in your browser. Use a limited, revocable key. Never use production keys. ",-1)),X("a",{href:"#",onClick:p[3]||(p[3]=ln(g=>l.value=!0,["prevent"])),class:"learn-more-link"},"Click here to learn more"),X("button",{onClick:p[4]||(p[4]=g=>o.value=!1),class:"dismiss-btn"},"Dismiss")])])):Ae("",!0)]),l.value?(Tt(),Rt("div",{key:0,class:"modal-overlay",onClick:p[8]||(p[8]=g=>l.value=!1)},[X("div",{class:"modal-content",onClick:p[7]||(p[7]=ln(()=>{},["stop"]))},[X("div",qQ,[p[15]||(p[15]=X("h2",null," Important notice about your API key",-1)),X("button",{onClick:p[5]||(p[5]=g=>l.value=!1),class:"modal-close"},"")]),p[16]||(p[16]=XT('<div class="modal-body" data-v-1eceb5bc><section data-v-1eceb5bc><h3 data-v-1eceb5bc>Where your key lives:</h3><p data-v-1eceb5bc>This app runs entirely in your browser. Your API key is kept in memory only and is not saved to localStorage, cookies, or our servers. When you close or refresh the page, the key is discarded.</p></section><section data-v-1eceb5bc><h3 data-v-1eceb5bc>What that still means in practice:</h3><p data-v-1eceb5bc>Even without storage, a key used in the browser can be exposed in several ways:</p><ul data-v-1eceb5bc><li data-v-1eceb5bc><strong data-v-1eceb5bc>Browser extensions</strong>  Any extension with permission to run on this page can read the DOM, intercept network requests, or capture keystrokes. Malicious or over-permissive extensions can exfiltrate your key and chat data.</li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Developer tools &amp; logs</strong>  Authorization headers and request bodies may be visible in the Network tab. Copy/paste history, crash reports, debugging overlays, or third-party analytics/debug scripts could capture sensitive data.</li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Clipboard &amp; screenshots</strong>  Some clipboard managers keep history; screen recorders or &quot;share your screen&quot; sessions can reveal the key or responses.</li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Malware or shared devices</strong>  Keyloggers and remote-control tools can grab what you type. Anyone with access to your machine or account profile could view active sessions.</li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Third-party scripts</strong>  If you enable content blockers or load-helper scripts, be aware that any third-party script running on the page could read page memory.</li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Network visibility</strong>  We use HTTPS, but corporate proxies, antivirus, or traffic-capturing tools on your device/network could still inspect requests.</li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Usage risk</strong>  If your key leaks, someone else can spend your credits, hit your rate limits, or access models/features under your account until you revoke it.</li></ul></section><section data-v-1eceb5bc><h3 data-v-1eceb5bc>How to reduce your risk (recommended):</h3><ul data-v-1eceb5bc><li data-v-1eceb5bc><strong data-v-1eceb5bc>Use a limited, revocable key:</strong><p data-v-1eceb5bc>Create a non-production key with the lowest possible permissions, strict quotas/spend caps, and model/endpoint allow-lists (if supported). Be ready to revoke it at any time.</p></li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Prefer a clean browser session:</strong><p data-v-1eceb5bc>Use a private/incognito window with extensions disabled. Don&#39;t save the key between sessions. Avoid pasting it into multiple tabs.</p></li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Keep it off the clipboard:</strong><p data-v-1eceb5bc>Paste once if needed, then clear it. Disable clipboard history managers while using the app.</p></li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Don&#39;t open DevTools while using the key:</strong><p data-v-1eceb5bc>This reduces the chance of accidental logging or copying of request data.</p></li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Verify the site:</strong><p data-v-1eceb5bc>Make sure you&#39;re on the correct domain (HTTPS lock icon, expected URL). Don&#39;t use the app from untrusted links or if your browser shows security warnings.</p></li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Rotate and monitor:</strong><p data-v-1eceb5bc>Rotate keys periodically, and keep an eye on your provider&#39;s usage/billing dashboard for unexpected spikes.</p></li><li data-v-1eceb5bc><strong data-v-1eceb5bc>Prefer a server-side proxy for production:</strong><p data-v-1eceb5bc>For real projects, use a backend that keeps provider keys on the server and issues short-lived, scoped tokens to the browser. That&#39;s the only robust way to protect a production key.</p></li></ul></section><section data-v-1eceb5bc><h3 data-v-1eceb5bc>By proceeding, you acknowledge:</h3><ul data-v-1eceb5bc><li data-v-1eceb5bc>You understand your key is used client-side and may be visible to software on your device (including extensions) and in browser tools.</li><li data-v-1eceb5bc>You accept the risk of unintended exposure and potential charges if the key is leaked.</li><li data-v-1eceb5bc>You agree to use a limited, revocable, non-production key and to revoke it immediately if you suspect misuse.</li></ul></section></div>',1)),X("div",XQ,[X("button",{onClick:p[6]||(p[6]=g=>l.value=!1),class:"modal-ok-btn"},"I Understand")])])])):Ae("",!0),X("div",{class:"messages-container",ref_key:"messagesContainer",ref:r},[Te(e).messages.value.length===0?(Tt(),Rt("div",zQ,[...p[17]||(p[17]=[X("p",null," Ask me to create, modify, or analyze the music in your piano roll!",-1),X("div",{class:"examples"},[X("p",null,[X("strong",null,"Try:")]),X("ul",null,[X("li",null,'"What notes are currently in the piano roll?"'),X("li",null,'"Create a C major chord at beat 0"'),X("li",null,'"Add a simple melody starting at beat 4"')])],-1)])])):Ae("",!0),(Tt(!0),Rt(ii,null,Cr(Te(e).messages.value,(g,m)=>(Tt(),Rt("div",{key:m,class:Ds(["message",g.role])},[X("div",jQ,[X("span",GQ,Ie(g.role==="user"?"You":"AI Assistant"),1),X("span",YQ,Ie(f(g.timestamp)),1)]),g.toolCalls&&g.toolCalls.length>0?(Tt(),Rt("div",UQ,[p[18]||(p[18]=X("div",{class:"tool-call-header"}," Tools used:",-1)),(Tt(!0),Rt(ii,null,Cr(g.toolCalls,(O,b)=>(Tt(),Rt("div",{key:b,class:"tool-call"},[X("span",HQ,Ie(O.displayName||O.name),1),Object.keys(O.input).length>0?(Tt(),Rt("span",KQ," ("+Ie(Object.entries(O.input).map(([x,v])=>`${x}: ${v}`).join(", "))+") ",1)):Ae("",!0)]))),128))])):Ae("",!0),X("div",JQ,Ie(g.text),1)],2))),128)),Te(e).isWaiting.value?(Tt(),Rt("div",tI,[...p[19]||(p[19]=[X("div",{class:"message-header"},[X("span",{class:"role-label"},"AI Assistant")],-1),X("div",{class:"message-text"},[X("span",{class:"loading-dots"},"Thinking")],-1)])])):Ae("",!0)],512),Te(e).error.value?(Tt(),Rt("div",eI,[p[20]||(p[20]=X("strong",null,"Error:",-1)),Fi(" "+Ie(Te(e).error.value),1)])):Ae("",!0),X("div",iI,[Ar(X("textarea",{"onUpdate:modelValue":p[9]||(p[9]=g=>n.value=g),onKeydown:u,placeholder:"Ask me to create or modify music...",class:"user-input",rows:"2",disabled:Te(e).isWaiting.value||!s.value},null,40,sI),[[vf,n.value]]),X("button",{onClick:h,class:"send-btn",disabled:Te(e).isWaiting.value||!n.value.trim()||!s.value}," Send ",8,nI)])]))}}),oI=rl(rI,[["__scopeId","data-v-1eceb5bc"]]);let ym=[],pw=[];(()=>{let i="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=0,e=0;t<i.length;t++)(t%2?pw:ym).push(e=e+i[t])})();function aI(i){if(i<768)return!1;for(let t=0,e=ym.length;;){let s=t+e>>1;if(i<ym[s])e=s;else if(i>=pw[s])t=s+1;else return!0;if(t==e)return!1}}function Ib(i){return i>=127462&&i<=127487}const $b=8205;function lI(i,t,e=!0,s=!0){return(e?gw:cI)(i,t,s)}function gw(i,t,e){if(t==i.length)return t;t&&mw(i.charCodeAt(t))&&Ow(i.charCodeAt(t-1))&&t--;let s=Up(i,t);for(t+=Nb(s);t<i.length;){let n=Up(i,t);if(s==$b||n==$b||e&&aI(n))t+=Nb(n),s=n;else if(Ib(n)){let r=0,o=t-2;for(;o>=0&&Ib(Up(i,o));)r++,o-=2;if(r%2==0)break;t+=2}else break}return t}function cI(i,t,e){for(;t>0;){let s=gw(i,t-2,e);if(s<t)return s;t--}return 0}function Up(i,t){let e=i.charCodeAt(t);if(!Ow(e)||t+1==i.length)return e;let s=i.charCodeAt(t+1);return mw(s)?(e-55296<<10)+(s-56320)+65536:e}function mw(i){return i>=56320&&i<57344}function Ow(i){return i>=55296&&i<56320}function Nb(i){return i<65536?1:2}class Wt{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,s){[t,e]=Fa(this,t,e);let n=[];return this.decompose(0,t,n,2),s.length&&s.decompose(0,s.length,n,3),this.decompose(e,this.length,n,1),hn.from(n,this.length-(e-t)+s.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=Fa(this,t,e);let s=[];return this.decompose(t,e,s,0),hn.from(s,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),s=this.length-this.scanIdentical(t,-1),n=new fc(this),r=new fc(t);for(let o=e,a=e;;){if(n.next(o),r.next(o),o=0,n.lineBreak!=r.lineBreak||n.done!=r.done||n.value!=r.value)return!1;if(a+=n.value.length,n.done||a>=s)return!0}}iter(t=1){return new fc(this,t)}iterRange(t,e=this.length){return new yw(this,t,e)}iterLines(t,e){let s;if(t==null)s=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;s=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new bw(s)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?Wt.empty:t.length<=32?new Pe(t):hn.from(Pe.split(t,[]))}}class Pe extends Wt{constructor(t,e=hI(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,s,n){for(let r=0;;r++){let o=this.text[r],a=n+o.length;if((e?s:a)>=t)return new uI(n,a,s,o);n=a+1,s++}}decompose(t,e,s,n){let r=t<=0&&e>=this.length?this:new Pe(Db(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let o=s.pop(),a=Hu(r.text,o.text.slice(),0,r.length);if(a.length<=32)s.push(new Pe(a,o.length+r.length));else{let l=a.length>>1;s.push(new Pe(a.slice(0,l)),new Pe(a.slice(l)))}}else s.push(r)}replace(t,e,s){if(!(s instanceof Pe))return super.replace(t,e,s);[t,e]=Fa(this,t,e);let n=Hu(this.text,Hu(s.text,Db(this.text,0,t)),e),r=this.length+s.length-(e-t);return n.length<=32?new Pe(n,r):hn.from(Pe.split(n,[]),r)}sliceString(t,e=this.length,s=`
`){[t,e]=Fa(this,t,e);let n="";for(let r=0,o=0;r<=e&&o<this.text.length;o++){let a=this.text[o],l=r+a.length;r>t&&o&&(n+=s),t<l&&e>r&&(n+=a.slice(Math.max(0,t-r),e-r)),r=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let s=[],n=-1;for(let r of t)s.push(r),n+=r.length+1,s.length==32&&(e.push(new Pe(s,n)),s=[],n=-1);return n>-1&&e.push(new Pe(s,n)),e}}class hn extends Wt{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let s of t)this.lines+=s.lines}lineInner(t,e,s,n){for(let r=0;;r++){let o=this.children[r],a=n+o.length,l=s+o.lines-1;if((e?l:a)>=t)return o.lineInner(t,e,s,n);n=a+1,s=l+1}}decompose(t,e,s,n){for(let r=0,o=0;o<=e&&r<this.children.length;r++){let a=this.children[r],l=o+a.length;if(t<=l&&e>=o){let c=n&((o<=t?1:0)|(l>=e?2:0));o>=t&&l<=e&&!c?s.push(a):a.decompose(t-o,e-o,s,c)}o=l+1}}replace(t,e,s){if([t,e]=Fa(this,t,e),s.lines<this.lines)for(let n=0,r=0;n<this.children.length;n++){let o=this.children[n],a=r+o.length;if(t>=r&&e<=a){let l=o.replace(t-r,e-r,s),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let h=this.children.slice();return h[n]=l,new hn(h,this.length-(e-t)+s.length)}return super.replace(r,a,l)}r=a+1}return super.replace(t,e,s)}sliceString(t,e=this.length,s=`
`){[t,e]=Fa(this,t,e);let n="";for(let r=0,o=0;r<this.children.length&&o<=e;r++){let a=this.children[r],l=o+a.length;o>t&&r&&(n+=s),t<l&&e>o&&(n+=a.sliceString(t-o,e-o,s)),o=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof hn))return 0;let s=0,[n,r,o,a]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,r+=e){if(n==o||r==a)return s;let l=this.children[n],c=t.children[r];if(l!=c)return s+l.scanIdentical(c,e);s+=l.length+1}}static from(t,e=t.reduce((s,n)=>s+n.length+1,-1)){let s=0;for(let d of t)s+=d.lines;if(s<32){let d=[];for(let p of t)p.flatten(d);return new Pe(d,e)}let n=Math.max(32,s>>5),r=n<<1,o=n>>1,a=[],l=0,c=-1,h=[];function u(d){let p;if(d.lines>r&&d instanceof hn)for(let g of d.children)u(g);else d.lines>o&&(l>o||!l)?(f(),a.push(d)):d instanceof Pe&&l&&(p=h[h.length-1])instanceof Pe&&d.lines+p.lines<=32?(l+=d.lines,c+=d.length+1,h[h.length-1]=new Pe(p.text.concat(d.text),p.length+1+d.length)):(l+d.lines>n&&f(),l+=d.lines,c+=d.length+1,h.push(d))}function f(){l!=0&&(a.push(h.length==1?h[0]:hn.from(h,c)),c=-1,l=h.length=0)}for(let d of t)u(d);return f(),a.length==1?a[0]:new hn(a,e)}}Wt.empty=new Pe([""],0);function hI(i){let t=-1;for(let e of i)t+=e.length+1;return t}function Hu(i,t,e=0,s=1e9){for(let n=0,r=0,o=!0;r<i.length&&n<=s;r++){let a=i[r],l=n+a.length;l>=e&&(l>s&&(a=a.slice(0,s-n)),n<e&&(a=a.slice(e-n)),o?(t[t.length-1]+=a,o=!1):t.push(a)),n=l+1}return t}function Db(i,t,e){return Hu(i,[""],t,e)}class fc{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof Pe?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let s=this.nodes.length-1,n=this.nodes[s],r=this.offsets[s],o=r>>1,a=n instanceof Pe?n.text.length:n.children.length;if(o==(e>0?a:0)){if(s==0)return this.done=!0,this.value="",this;e>0&&this.offsets[s-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(e>0?0:1)){if(this.offsets[s]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(n instanceof Pe){let l=n.text[o+(e<0?-1:0)];if(this.offsets[s]+=e,l.length>Math.max(0,t))return this.value=t==0?l:e>0?l.slice(t):l.slice(0,l.length-t),this;t-=l.length}else{let l=n.children[o+(e<0?-1:0)];t>l.length?(t-=l.length,this.offsets[s]+=e):(e<0&&this.offsets[s]--,this.nodes.push(l),this.offsets.push(e>0?1:(l instanceof Pe?l.text.length:l.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class yw{constructor(t,e,s){this.value="",this.done=!1,this.cursor=new fc(t,e>s?-1:1),this.pos=e>s?t.length:0,this.from=Math.min(e,s),this.to=Math.max(e,s)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let s=e<0?this.pos-this.from:this.to-this.pos;t>s&&(t=s),s-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=s?n:e<0?n.slice(n.length-s):n.slice(0,s),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class bw{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:s,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):s?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Wt.prototype[Symbol.iterator]=function(){return this.iter()},fc.prototype[Symbol.iterator]=yw.prototype[Symbol.iterator]=bw.prototype[Symbol.iterator]=function(){return this});class uI{constructor(t,e,s,n){this.from=t,this.to=e,this.number=s,this.text=n}get length(){return this.to-this.from}}function Fa(i,t,e){return t=Math.max(0,Math.min(i.length,t)),[t,Math.max(t,Math.min(i.length,e))]}function ri(i,t,e=!0,s=!0){return lI(i,t,e,s)}function fI(i){return i>=56320&&i<57344}function dI(i){return i>=55296&&i<56320}function Bi(i,t){let e=i.charCodeAt(t);if(!dI(e)||t+1==i.length)return e;let s=i.charCodeAt(t+1);return fI(s)?(e-55296<<10)+(s-56320)+65536:e}function LO(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}function un(i){return i<65536?1:2}const bm=/\r\n?|\n/;var ni=(function(i){return i[i.Simple=0]="Simple",i[i.TrackDel=1]="TrackDel",i[i.TrackBefore=2]="TrackBefore",i[i.TrackAfter=3]="TrackAfter",i})(ni||(ni={}));class bn{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let s=this.sections[e+1];t+=s<0?this.sections[e]:s}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,s=0,n=0;e<this.sections.length;){let r=this.sections[e++],o=this.sections[e++];o<0?(t(s,n,r),n+=r):n+=o,s+=r}}iterChangedRanges(t,e=!1){vm(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let s=this.sections[e++],n=this.sections[e++];n<0?t.push(s,n):t.push(n,s)}return new bn(t)}composeDesc(t){return this.empty?t:t.empty?this:vw(this,t)}mapDesc(t,e=!1){return t.empty?this:_m(this,t,e)}mapPos(t,e=-1,s=ni.Simple){let n=0,r=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],c=n+a;if(l<0){if(c>t)return r+(t-n);r+=a}else{if(s!=ni.Simple&&c>=t&&(s==ni.TrackDel&&n<t&&c>t||s==ni.TrackBefore&&n<t||s==ni.TrackAfter&&c>t))return null;if(c>t||c==t&&e<0&&!a)return t==n||e<0?r:r+l;r+=l}n=c}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return r}touchesRange(t,e=t){for(let s=0,n=0;s<this.sections.length&&n<=e;){let r=this.sections[s++],o=this.sections[s++],a=n+r;if(o>=0&&n<=e&&a>=t)return n<t&&a>e?"cover":!0;n=a}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let s=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+s+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bn(t)}static create(t){return new bn(t)}}class Xe extends bn{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return vm(this,(e,s,n,r,o)=>t=t.replace(n,n+(s-e),o),!1),t}mapDesc(t,e=!1){return _m(this,t,e,!0)}invert(t){let e=this.sections.slice(),s=[];for(let n=0,r=0;n<e.length;n+=2){let o=e[n],a=e[n+1];if(a>=0){e[n]=a,e[n+1]=o;let l=n>>1;for(;s.length<l;)s.push(Wt.empty);s.push(o?t.slice(r,r+o):Wt.empty)}r+=o}return new Xe(e,s)}compose(t){return this.empty?t:t.empty?this:vw(this,t,!0)}map(t,e=!1){return t.empty?this:_m(this,t,e,!0)}iterChanges(t,e=!1){vm(this,t,e)}get desc(){return bn.create(this.sections)}filter(t){let e=[],s=[],n=[],r=new Qc(this);t:for(let o=0,a=0;;){let l=o==t.length?1e9:t[o++];for(;a<l||a==l&&r.len==0;){if(r.done)break t;let h=Math.min(r.len,l-a);li(n,h,-1);let u=r.ins==-1?-1:r.off==0?r.ins:0;li(e,h,u),u>0&&Mr(s,e,r.text),r.forward(h),a+=h}let c=t[o++];for(;a<c;){if(r.done)break t;let h=Math.min(r.len,c-a);li(e,h,-1),li(n,h,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(h),a+=h}}return{changes:new Xe(e,s),filtered:bn.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let s=this.sections[e],n=this.sections[e+1];n<0?t.push(s):n==0?t.push([s]):t.push([s].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,s){let n=[],r=[],o=0,a=null;function l(h=!1){if(!h&&!n.length)return;o<e&&li(n,e-o,-1);let u=new Xe(n,r);a=a?a.compose(u.map(a)):u,n=[],r=[],o=0}function c(h){if(Array.isArray(h))for(let u of h)c(u);else if(h instanceof Xe){if(h.length!=e)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${e})`);l(),a=a?a.compose(h.map(a)):h}else{let{from:u,to:f=u,insert:d}=h;if(u>f||u<0||f>e)throw new RangeError(`Invalid change range ${u} to ${f} (in doc of length ${e})`);let p=d?typeof d=="string"?Wt.of(d.split(s||bm)):d:Wt.empty,g=p.length;if(u==f&&g==0)return;u<o&&l(),u>o&&li(n,u-o,-1),li(n,f-u,g),Mr(r,n,p),o=f}}return c(t),l(!a),a}static empty(t){return new Xe(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],s=[];for(let n=0;n<t.length;n++){let r=t[n];if(typeof r=="number")e.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)e.push(r[0],0);else{for(;s.length<n;)s.push(Wt.empty);s[n]=Wt.of(r.slice(1)),e.push(r[0],s[n].length)}}}return new Xe(e,s)}static createSet(t,e){return new Xe(t,e)}}function li(i,t,e,s=!1){if(t==0&&e<=0)return;let n=i.length-2;n>=0&&e<=0&&e==i[n+1]?i[n]+=t:n>=0&&t==0&&i[n]==0?i[n+1]+=e:s?(i[n]+=t,i[n+1]+=e):i.push(t,e)}function Mr(i,t,e){if(e.length==0)return;let s=t.length-2>>1;if(s<i.length)i[i.length-1]=i[i.length-1].append(e);else{for(;i.length<s;)i.push(Wt.empty);i.push(e)}}function vm(i,t,e){let s=i.inserted;for(let n=0,r=0,o=0;o<i.sections.length;){let a=i.sections[o++],l=i.sections[o++];if(l<0)n+=a,r+=a;else{let c=n,h=r,u=Wt.empty;for(;c+=a,h+=l,l&&s&&(u=u.append(s[o-2>>1])),!(e||o==i.sections.length||i.sections[o+1]<0);)a=i.sections[o++],l=i.sections[o++];t(n,c,r,h,u),n=c,r=h}}}function _m(i,t,e,s=!1){let n=[],r=s?[]:null,o=new Qc(i),a=new Qc(t);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let c=Math.min(o.len,a.len);li(n,c,-1),o.forward(c),a.forward(c)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!e))){let c=a.len;for(li(n,a.ins,-1);c;){let h=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=h&&(li(n,0,o.ins),r&&Mr(r,n,o.text),l=o.i),o.forward(h),c-=h}a.next()}else if(o.ins>=0){let c=0,h=o.len;for(;h;)if(a.ins==-1){let u=Math.min(h,a.len);c+=u,h-=u,a.forward(u)}else if(a.ins==0&&a.len<h)h-=a.len,a.next();else break;li(n,c,l<o.i?o.ins:0),r&&l<o.i&&Mr(r,n,o.text),l=o.i,o.forward(o.len-h)}else{if(o.done&&a.done)return r?Xe.createSet(n,r):bn.create(n);throw new Error("Mismatched change set lengths")}}}function vw(i,t,e=!1){let s=[],n=e?[]:null,r=new Qc(i),o=new Qc(t);for(let a=!1;;){if(r.done&&o.done)return n?Xe.createSet(s,n):bn.create(s);if(r.ins==0)li(s,r.len,0,a),r.next();else if(o.len==0&&!o.done)li(s,0,o.ins,a),n&&Mr(n,s,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(r.len2,o.len),c=s.length;if(r.ins==-1){let h=o.ins==-1?-1:o.off?0:o.ins;li(s,l,h,a),n&&h&&Mr(n,s,o.text)}else o.ins==-1?(li(s,r.off?0:r.len,l,a),n&&Mr(n,s,r.textBit(l))):(li(s,r.off?0:r.len,o.off?0:o.ins,a),n&&!o.off&&Mr(n,s,o.text));a=(r.ins>l||o.ins>=0&&o.len>l)&&(a||s.length>c),r.forward2(l),o.forward(l)}}}}class Qc{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?Wt.empty:t[e]}textBit(t){let{inserted:e}=this.set,s=this.i-2>>1;return s>=e.length&&!t?Wt.empty:e[s].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class xo{constructor(t,e,s){this.from=t,this.to=e,this.flags=s}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let t=this.flags&7;return t==7?null:t}get goalColumn(){let t=this.flags>>6;return t==16777215?void 0:t}map(t,e=-1){let s,n;return this.empty?s=n=t.mapPos(this.from,e):(s=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),s==this.from&&n==this.to?this:new xo(s,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return G.range(t,e);let s=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return G.range(this.anchor,s)}eq(t,e=!1){return this.anchor==t.anchor&&this.head==t.head&&(!e||!this.empty||this.assoc==t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return G.range(t.anchor,t.head)}static create(t,e,s){return new xo(t,e,s)}}class G{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:G.create(this.ranges.map(s=>s.map(t,e)),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let s=0;s<this.ranges.length;s++)if(!this.ranges[s].eq(t.ranges[s],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new G([this.main],0)}addRange(t,e=!0){return G.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let s=this.ranges.slice();return s[e]=t,G.create(s,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new G(t.ranges.map(e=>xo.fromJSON(e)),t.main)}static single(t,e=t){return new G([G.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let s=0,n=0;n<t.length;n++){let r=t[n];if(r.empty?r.from<=s:r.from<s)return G.normalized(t.slice(),e);s=r.to}return new G(t,e)}static cursor(t,e=0,s,n){return xo.create(t,t,(e==0?0:e<0?8:16)|(s==null?7:Math.min(6,s))|(n??16777215)<<6)}static range(t,e,s,n){let r=(s??16777215)<<6|(n==null?7:Math.min(6,n));return e<t?xo.create(e,t,48|r):xo.create(t,e,(e>t?8:0)|r)}static normalized(t,e=0){let s=t[e];t.sort((n,r)=>n.from-r.from),e=t.indexOf(s);for(let n=1;n<t.length;n++){let r=t[n],o=t[n-1];if(r.empty?r.from<=o.to:r.from<o.to){let a=o.from,l=Math.max(r.to,o.to);n<=e&&e--,t.splice(--n,2,r.anchor>r.head?G.range(l,a):G.range(a,l))}}return new G(t,e)}}function _w(i,t){for(let e of i.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let VO=0;class ft{constructor(t,e,s,n,r){this.combine=t,this.compareInput=e,this.compare=s,this.isStatic=n,this.id=VO++,this.default=t([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(t={}){return new ft(t.combine||(e=>e),t.compareInput||((e,s)=>e===s),t.compare||(t.combine?(e,s)=>e===s:BO),!!t.static,t.enables)}of(t){return new Ku([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ku(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ku(t,this,2,e)}from(t,e){return e||(e=s=>s),this.compute([t],s=>e(s.field(t)))}}function BO(i,t){return i==t||i.length==t.length&&i.every((e,s)=>e===t[s])}class Ku{constructor(t,e,s,n){this.dependencies=t,this.facet=e,this.type=s,this.value=n,this.id=VO++}dynamicSlot(t){var e;let s=this.value,n=this.facet.compareInput,r=this.id,o=t[r]>>1,a=this.type==2,l=!1,c=!1,h=[];for(let u of this.dependencies)u=="doc"?l=!0:u=="selection"?c=!0:(((e=t[u.id])!==null&&e!==void 0?e:1)&1)==0&&h.push(t[u.id]);return{create(u){return u.values[o]=s(u),1},update(u,f){if(l&&f.docChanged||c&&(f.docChanged||f.selection)||xm(u,h)){let d=s(u);if(a?!Lb(d,u.values[o],n):!n(d,u.values[o]))return u.values[o]=d,1}return 0},reconfigure:(u,f)=>{let d,p=f.config.address[r];if(p!=null){let g=Ff(f,p);if(this.dependencies.every(m=>m instanceof ft?f.facet(m)===u.facet(m):m instanceof Je?f.field(m,!1)==u.field(m,!1):!0)||(a?Lb(d=s(u),g,n):n(d=s(u),g)))return u.values[o]=g,0}else d=s(u);return u.values[o]=d,1}}}}function Lb(i,t,e){if(i.length!=t.length)return!1;for(let s=0;s<i.length;s++)if(!e(i[s],t[s]))return!1;return!0}function xm(i,t){let e=!1;for(let s of t)dc(i,s)&1&&(e=!0);return e}function pI(i,t,e){let s=e.map(l=>i[l.id]),n=e.map(l=>l.type),r=s.filter(l=>!(l&1)),o=i[t.id]>>1;function a(l){let c=[];for(let h=0;h<s.length;h++){let u=Ff(l,s[h]);if(n[h]==2)for(let f of u)c.push(f);else c.push(u)}return t.combine(c)}return{create(l){for(let c of s)dc(l,c);return l.values[o]=a(l),1},update(l,c){if(!xm(l,r))return 0;let h=a(l);return t.compare(h,l.values[o])?0:(l.values[o]=h,1)},reconfigure(l,c){let h=xm(l,s),u=c.config.facets[t.id],f=c.facet(t);if(u&&!h&&BO(e,u))return l.values[o]=f,0;let d=a(l);return t.compare(d,f)?(l.values[o]=f,0):(l.values[o]=d,1)}}}const Ou=ft.define({static:!0});class Je{constructor(t,e,s,n,r){this.id=t,this.createF=e,this.updateF=s,this.compareF=n,this.spec=r,this.provides=void 0}static define(t){let e=new Je(VO++,t.create,t.update,t.compare||((s,n)=>s===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Ou).find(s=>s.field==this);return(e?.create||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:s=>(s.values[e]=this.create(s),1),update:(s,n)=>{let r=s.values[e],o=this.updateF(r,n);return this.compareF(r,o)?0:(s.values[e]=o,1)},reconfigure:(s,n)=>{let r=s.facet(Ou),o=n.facet(Ou),a;return(a=r.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(s.values[e]=a.create(s),1):n.config.address[this.id]!=null?(s.values[e]=n.field(this),0):(s.values[e]=this.create(s),1)}}}init(t){return[this,Ou.of({field:this,create:t})]}get extension(){return this}}const mo={lowest:4,low:3,default:2,high:1,highest:0};function Il(i){return t=>new xw(t,i)}const no={highest:Il(mo.highest),high:Il(mo.high),default:Il(mo.default),low:Il(mo.low),lowest:Il(mo.lowest)};class xw{constructor(t,e){this.inner=t,this.prec=e}}class bh{of(t){return new Sm(this,t)}reconfigure(t){return bh.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class Sm{constructor(t,e){this.compartment=t,this.inner=e}}class Zf{constructor(t,e,s,n,r,o){for(this.base=t,this.compartments=e,this.dynamicSlots=s,this.address=n,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<s.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,s){let n=[],r=Object.create(null),o=new Map;for(let f of gI(t,e,o))f instanceof Je?n.push(f):(r[f.facet.id]||(r[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],c=[];for(let f of n)a[f.id]=c.length<<1,c.push(d=>f.slot(d));let h=s?.config.facets;for(let f in r){let d=r[f],p=d[0].facet,g=h&&h[f]||[];if(d.every(m=>m.type==0))if(a[p.id]=l.length<<1|1,BO(g,d))l.push(s.facet(p));else{let m=p.combine(d.map(O=>O.value));l.push(s&&p.compare(m,s.facet(p))?s.facet(p):m)}else{for(let m of d)m.type==0?(a[m.id]=l.length<<1|1,l.push(m.value)):(a[m.id]=c.length<<1,c.push(O=>m.dynamicSlot(O)));a[p.id]=c.length<<1,c.push(m=>pI(m,p,d))}}let u=c.map(f=>f(a));return new Zf(t,o,u,a,l,r)}}function gI(i,t,e){let s=[[],[],[],[],[]],n=new Map;function r(o,a){let l=n.get(o);if(l!=null){if(l<=a)return;let c=s[l].indexOf(o);c>-1&&s[l].splice(c,1),o instanceof Sm&&e.delete(o.compartment)}if(n.set(o,a),Array.isArray(o))for(let c of o)r(c,a);else if(o instanceof Sm){if(e.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=t.get(o.compartment)||o.inner;e.set(o.compartment,c),r(c,a)}else if(o instanceof xw)r(o.inner,o.prec);else if(o instanceof Je)s[a].push(o),o.provides&&r(o.provides,a);else if(o instanceof Ku)s[a].push(o),o.facet.extensions&&r(o.facet.extensions,mo.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(c,a)}}return r(i,mo.default),s.reduce((o,a)=>o.concat(a))}function dc(i,t){if(t&1)return 2;let e=t>>1,s=i.status[e];if(s==4)throw new Error("Cyclic dependency between fields and/or facets");if(s&2)return s;i.status[e]=4;let n=i.computeSlot(i,i.config.dynamicSlots[e]);return i.status[e]=2|n}function Ff(i,t){return t&1?i.config.staticValues[t>>1]:i.values[t>>1]}const Sw=ft.define(),wm=ft.define({combine:i=>i.some(t=>t),static:!0}),ww=ft.define({combine:i=>i.length?i[0]:void 0,static:!0}),kw=ft.define(),Cw=ft.define(),Tw=ft.define(),Pw=ft.define({combine:i=>i.length?i[0]:!1});class fr{constructor(t,e){this.type=t,this.value=e}static define(){return new mI}}class mI{of(t){return new fr(this,t)}}class OI{constructor(t){this.map=t}of(t){return new Et(this,t)}}class Et{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new Et(this.type,e)}is(t){return this.type==t}static define(t={}){return new OI(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let s=[];for(let n of t){let r=n.map(e);r&&s.push(r)}return s}}Et.reconfigure=Et.define();Et.appendConfig=Et.define();class Le{constructor(t,e,s,n,r,o){this.startState=t,this.changes=e,this.selection=s,this.effects=n,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,s&&_w(s,e.newLength),r.some(a=>a.type==Le.time)||(this.annotations=r.concat(Le.time.of(Date.now())))}static create(t,e,s,n,r,o){return new Le(t,e,s,n,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Le.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Le.time=fr.define();Le.userEvent=fr.define();Le.addToHistory=fr.define();Le.remote=fr.define();function yI(i,t){let e=[];for(let s=0,n=0;;){let r,o;if(s<i.length&&(n==t.length||t[n]>=i[s]))r=i[s++],o=i[s++];else if(n<t.length)r=t[n++],o=t[n++];else return e;!e.length||e[e.length-1]<r?e.push(r,o):e[e.length-1]<o&&(e[e.length-1]=o)}}function Aw(i,t,e){var s;let n,r,o;return e?(n=t.changes,r=Xe.empty(t.changes.length),o=i.changes.compose(t.changes)):(n=t.changes.map(i.changes),r=i.changes.mapDesc(t.changes,!0),o=i.changes.compose(n)),{changes:o,selection:t.selection?t.selection.map(r):(s=i.selection)===null||s===void 0?void 0:s.map(n),effects:Et.mapEffects(i.effects,n).concat(Et.mapEffects(t.effects,r)),annotations:i.annotations.length?i.annotations.concat(t.annotations):t.annotations,scrollIntoView:i.scrollIntoView||t.scrollIntoView}}function km(i,t,e){let s=t.selection,n=Ta(t.annotations);return t.userEvent&&(n=n.concat(Le.userEvent.of(t.userEvent))),{changes:t.changes instanceof Xe?t.changes:Xe.of(t.changes||[],e,i.facet(ww)),selection:s&&(s instanceof G?s:G.single(s.anchor,s.head)),effects:Ta(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function Mw(i,t,e){let s=km(i,t.length?t[0]:{},i.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let r=1;r<t.length;r++){t[r].filter===!1&&(e=!1);let o=!!t[r].sequential;s=Aw(s,km(i,t[r],o?s.changes.newLength:i.doc.length),o)}let n=Le.create(i,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return vI(e?bI(n):n)}function bI(i){let t=i.startState,e=!0;for(let n of t.facet(kw)){let r=n(i);if(r===!1){e=!1;break}Array.isArray(r)&&(e=e===!0?r:yI(e,r))}if(e!==!0){let n,r;if(e===!1)r=i.changes.invertedDesc,n=Xe.empty(t.doc.length);else{let o=i.changes.filter(e);n=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}i=Le.create(t,n,i.selection&&i.selection.map(r),Et.mapEffects(i.effects,r),i.annotations,i.scrollIntoView)}let s=t.facet(Cw);for(let n=s.length-1;n>=0;n--){let r=s[n](i);r instanceof Le?i=r:Array.isArray(r)&&r.length==1&&r[0]instanceof Le?i=r[0]:i=Mw(t,Ta(r),!1)}return i}function vI(i){let t=i.startState,e=t.facet(Tw),s=i;for(let n=e.length-1;n>=0;n--){let r=e[n](i);r&&Object.keys(r).length&&(s=Aw(s,km(t,r,i.changes.newLength),!0))}return s==i?i:Le.create(t,i.changes,i.selection,s.effects,s.annotations,s.scrollIntoView)}const _I=[];function Ta(i){return i==null?_I:Array.isArray(i)?i:[i]}var we=(function(i){return i[i.Word=0]="Word",i[i.Space=1]="Space",i[i.Other=2]="Other",i})(we||(we={}));const xI=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Cm;try{Cm=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function SI(i){if(Cm)return Cm.test(i);for(let t=0;t<i.length;t++){let e=i[t];if(/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||xI.test(e)))return!0}return!1}function wI(i){return t=>{if(!/\S/.test(t))return we.Space;if(SI(t))return we.Word;for(let e=0;e<i.length;e++)if(t.indexOf(i[e])>-1)return we.Word;return we.Other}}class Vt{constructor(t,e,s,n,r,o){this.config=t,this.doc=e,this.selection=s,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)dc(this,a<<1);this.computeSlot=null}field(t,e=!0){let s=this.config.address[t.id];if(s==null){if(e)throw new RangeError("Field is not present in this state");return}return dc(this,s),Ff(this,s)}update(...t){return Mw(this,t,!0)}applyTransaction(t){let e=this.config,{base:s,compartments:n}=e;for(let a of t.effects)a.is(bh.reconfigure)?(e&&(n=new Map,e.compartments.forEach((l,c)=>n.set(c,l)),e=null),n.set(a.value.compartment,a.value.extension)):a.is(Et.reconfigure)?(e=null,s=a.value):a.is(Et.appendConfig)&&(e=null,s=Ta(s).concat(a.value));let r;e?r=t.startState.values.slice():(e=Zf.resolve(s,n,this),r=new Vt(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=t.startState.facet(wm)?t.newSelection:t.newSelection.asSingle();new Vt(e,t.newDoc,o,r,(a,l)=>l.update(a,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:G.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,s=t(e.ranges[0]),n=this.changes(s.changes),r=[s.range],o=Ta(s.effects);for(let a=1;a<e.ranges.length;a++){let l=t(e.ranges[a]),c=this.changes(l.changes),h=c.map(n);for(let f=0;f<a;f++)r[f]=r[f].map(h);let u=n.mapDesc(c,!0);r.push(l.range.map(u)),n=n.compose(h),o=Et.mapEffects(o,h).concat(Et.mapEffects(Ta(l.effects),u))}return{changes:n,selection:G.create(r,e.mainIndex),effects:o}}changes(t=[]){return t instanceof Xe?t:Xe.of(t,this.doc.length,this.facet(Vt.lineSeparator))}toText(t){return Wt.of(t.split(this.facet(Vt.lineSeparator)||bm))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(dc(this,e),Ff(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let s in t){let n=t[s];n instanceof Je&&this.config.address[n.id]!=null&&(e[s]=n.spec.toJSON(this.field(t[s]),this))}return e}static fromJSON(t,e={},s){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(s){for(let r in s)if(Object.prototype.hasOwnProperty.call(t,r)){let o=s[r],a=t[r];n.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Vt.create({doc:t.doc,selection:G.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Zf.resolve(t.extensions||[],new Map),s=t.doc instanceof Wt?t.doc:Wt.of((t.doc||"").split(e.staticFacet(Vt.lineSeparator)||bm)),n=t.selection?t.selection instanceof G?t.selection:G.single(t.selection.anchor,t.selection.head):G.single(0);return _w(n,s.length),e.staticFacet(wm)||(n=n.asSingle()),new Vt(e,s,n,e.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(Vt.tabSize)}get lineBreak(){return this.facet(Vt.lineSeparator)||`
`}get readOnly(){return this.facet(Pw)}phrase(t,...e){for(let s of this.facet(Vt.phrases))if(Object.prototype.hasOwnProperty.call(s,t)){t=s[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(s,n)=>{if(n=="$")return"$";let r=+(n||1);return!r||r>e.length?s:e[r-1]})),t}languageDataAt(t,e,s=-1){let n=[];for(let r of this.facet(Sw))for(let o of r(this,e,s))Object.prototype.hasOwnProperty.call(o,t)&&n.push(o[t]);return n}charCategorizer(t){return wI(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:s,length:n}=this.doc.lineAt(t),r=this.charCategorizer(t),o=t-s,a=t-s;for(;o>0;){let l=ri(e,o,!1);if(r(e.slice(l,o))!=we.Word)break;o=l}for(;a<n;){let l=ri(e,a);if(r(e.slice(a,l))!=we.Word)break;a=l}return o==a?null:G.range(o+s,a+s)}}Vt.allowMultipleSelections=wm;Vt.tabSize=ft.define({combine:i=>i.length?i[0]:4});Vt.lineSeparator=ww;Vt.readOnly=Pw;Vt.phrases=ft.define({compare(i,t){let e=Object.keys(i),s=Object.keys(t);return e.length==s.length&&e.every(n=>i[n]==t[n])}});Vt.languageData=Sw;Vt.changeFilter=kw;Vt.transactionFilter=Cw;Vt.transactionExtender=Tw;bh.reconfigure=Et.define();function An(i,t,e={}){let s={};for(let n of i)for(let r of Object.keys(n)){let o=n[r],a=s[r];if(a===void 0)s[r]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(e,r))s[r]=e[r](a,o);else throw new Error("Config merge conflict for field "+r)}for(let n in t)s[n]===void 0&&(s[n]=t[n]);return s}class Qo{eq(t){return this==t}range(t,e=t){return Tm.create(t,e,this)}}Qo.prototype.startSide=Qo.prototype.endSide=0;Qo.prototype.point=!1;Qo.prototype.mapMode=ni.TrackDel;let Tm=class Ew{constructor(t,e,s){this.from=t,this.to=e,this.value=s}static create(t,e,s){return new Ew(t,e,s)}};function Pm(i,t){return i.from-t.from||i.value.startSide-t.value.startSide}class ZO{constructor(t,e,s,n){this.from=t,this.to=e,this.value=s,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,s,n=0){let r=s?this.to:this.from;for(let o=n,a=r.length;;){if(o==a)return o;let l=o+a>>1,c=r[l]-t||(s?this.value[l].endSide:this.value[l].startSide)-e;if(l==o)return c>=0?o:a;c>=0?a=l:o=l+1}}between(t,e,s,n){for(let r=this.findIndex(e,-1e9,!0),o=this.findIndex(s,1e9,!1,r);r<o;r++)if(n(this.from[r]+t,this.to[r]+t,this.value[r])===!1)return!1}map(t,e){let s=[],n=[],r=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],h=this.from[l]+t,u=this.to[l]+t,f,d;if(h==u){let p=e.mapPos(h,c.startSide,c.mapMode);if(p==null||(f=d=p,c.startSide!=c.endSide&&(d=e.mapPos(h,c.endSide),d<f)))continue}else if(f=e.mapPos(h,c.startSide),d=e.mapPos(u,c.endSide),f>d||f==d&&c.startSide>0&&c.endSide<=0)continue;(d-f||c.endSide-c.startSide)<0||(o<0&&(o=f),c.point&&(a=Math.max(a,d-f)),s.push(c),n.push(f-o),r.push(d-o))}return{mapped:s.length?new ZO(n,r,s,a):null,pos:o}}}class zt{constructor(t,e,s,n){this.chunkPos=t,this.chunk=e,this.nextLayer=s,this.maxPoint=n}static create(t,e,s,n){return new zt(t,e,s,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:s=!1,filterFrom:n=0,filterTo:r=this.length}=t,o=t.filter;if(e.length==0&&!o)return this;if(s&&(e=e.slice().sort(Pm)),this.isEmpty)return e.length?zt.of(e):this;let a=new Rw(this,null,-1).goto(0),l=0,c=[],h=new Jn;for(;a.value||l<e.length;)if(l<e.length&&(a.from-e[l].from||a.startSide-e[l].value.startSide)>=0){let u=e[l++];h.addInner(u.from,u.to,u.value)||c.push(u)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(a.chunkIndex)<e[l].from)&&(!o||n>this.chunkEnd(a.chunkIndex)||r<this.chunkPos[a.chunkIndex])&&h.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||n>a.to||r<a.from||o(a.from,a.to,a.value))&&(h.addInner(a.from,a.to,a.value)||c.push(Tm.create(a.from,a.to,a.value))),a.next());return h.finishInner(this.nextLayer.isEmpty&&!c.length?zt.empty:this.nextLayer.update({add:c,filter:o,filterFrom:n,filterTo:r}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],s=[],n=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],c=t.touchesRange(a,a+l.length);if(c===!1)n=Math.max(n,l.maxPoint),e.push(l),s.push(t.mapPos(a));else if(c===!0){let{mapped:h,pos:u}=l.map(a,t);h&&(n=Math.max(n,h.maxPoint),e.push(h),s.push(u))}}let r=this.nextLayer.map(t);return e.length==0?r:new zt(s,e,r||zt.empty,n)}between(t,e,s){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let r=this.chunkPos[n],o=this.chunk[n];if(e>=r&&t<=r+o.length&&o.between(r,t-r,e-r,s)===!1)return}this.nextLayer.between(t,e,s)}}iter(t=0){return Ic.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Ic.from(t).goto(e)}static compare(t,e,s,n,r=-1){let o=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),a=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=r),l=Vb(o,a,s),c=new $l(o,l,r),h=new $l(a,l,r);s.iterGaps((u,f,d)=>Bb(c,u,h,f,d,n)),s.empty&&s.length==0&&Bb(c,0,h,0,0,n)}static eq(t,e,s=0,n){n==null&&(n=999999999);let r=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0),o=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let a=Vb(r,o),l=new $l(r,a,0).goto(s),c=new $l(o,a,0).goto(s);for(;;){if(l.to!=c.to||!Am(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>n)return!0;l.next(),c.next()}}static spans(t,e,s,n,r=-1){let o=new $l(t,null,r).goto(e),a=e,l=o.openStart;for(;;){let c=Math.min(o.to,s);if(o.point){let h=o.activeForPoint(o.to),u=o.pointFrom<e?h.length+1:o.point.startSide<0?h.length:Math.min(h.length,l);n.point(a,c,o.point,h,u,o.pointRank),l=Math.min(o.openEnd(c),h.length)}else c>a&&(n.span(a,c,o.active,l),l=o.openEnd(c));if(o.to>s)return l+(o.point&&o.to>s?1:0);a=o.to,o.next()}}static of(t,e=!1){let s=new Jn;for(let n of t instanceof Tm?[t]:e?kI(t):t)s.add(n.from,n.to,n.value);return s.finish()}static join(t){if(!t.length)return zt.empty;let e=t[t.length-1];for(let s=t.length-2;s>=0;s--)for(let n=t[s];n!=zt.empty;n=n.nextLayer)e=new zt(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}zt.empty=new zt([],[],null,-1);function kI(i){if(i.length>1)for(let t=i[0],e=1;e<i.length;e++){let s=i[e];if(Pm(t,s)>0)return i.slice().sort(Pm);t=s}return i}zt.empty.nextLayer=zt.empty;class Jn{finishChunk(t){this.chunks.push(new ZO(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,s){this.addInner(t,e,s)||(this.nextLayer||(this.nextLayer=new Jn)).add(t,e,s)}addInner(t,e,s){let n=t-this.lastTo||s.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||s.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=s,this.lastFrom=t,this.lastTo=e,this.value.push(s),s.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let s=e.value.length-1;return this.last=e.value[s],this.lastFrom=e.from[s]+t,this.lastTo=e.to[s]+t,!0}finish(){return this.finishInner(zt.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=zt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Vb(i,t,e){let s=new Map;for(let r of i)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&s.set(r.chunk[o],r.chunkPos[o]);let n=new Set;for(let r of t)for(let o=0;o<r.chunk.length;o++){let a=s.get(r.chunk[o]);a!=null&&(e?e.mapPos(a):a)==r.chunkPos[o]&&!e?.touchesRange(a,a+r.chunk[o].length)&&n.add(r.chunk[o])}return n}class Rw{constructor(t,e,s,n=0){this.layer=t,this.skip=e,this.minPoint=s,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,s){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,s=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!s||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],s=t+e.from[this.rangeIndex];if(this.from=s,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Ic{constructor(t){this.heap=t}static from(t,e=null,s=-1){let n=[];for(let r=0;r<t.length;r++)for(let o=t[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=s&&n.push(new Rw(o,e,s,r));return n.length==1?n[0]:new Ic(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let s of this.heap)s.goto(t,e);for(let s=this.heap.length>>1;s>=0;s--)Hp(this.heap,s);return this.next(),this}forward(t,e){for(let s of this.heap)s.forward(t,e);for(let s=this.heap.length>>1;s>=0;s--)Hp(this.heap,s);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),Hp(this.heap,0)}}}function Hp(i,t){for(let e=i[t];;){let s=(t<<1)+1;if(s>=i.length)break;let n=i[s];if(s+1<i.length&&n.compare(i[s+1])>=0&&(n=i[s+1],s++),e.compare(n)<0)break;i[s]=e,i[t]=n,t=s}}class $l{constructor(t,e,s){this.minPoint=s,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Ic.from(t,e,s)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){yu(this.active,t),yu(this.activeTo,t),yu(this.activeRank,t),this.minActive=Zb(this.active,this.activeTo)}addActive(t){let e=0,{value:s,to:n,rank:r}=this.cursor;for(;e<this.activeRank.length&&(r-this.activeRank[e]||n-this.activeTo[e])>0;)e++;bu(this.active,e,s),bu(this.activeTo,e,n),bu(this.activeRank,e,r),t&&bu(t,e,this.cursor.from),this.minActive=Zb(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let s=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),s&&yu(s,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(s),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(s){this.openStart=0;for(let n=s.length-1;n>=0&&s[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let s=this.active.length-1;s>=0&&!(this.activeRank[s]<this.pointRank);s--)(this.activeTo[s]>t||this.activeTo[s]==t&&this.active[s].endSide>=this.point.endSide)&&e.push(this.active[s]);return e.reverse()}openEnd(t){let e=0;for(let s=this.activeTo.length-1;s>=0&&this.activeTo[s]>t;s--)e++;return e}}function Bb(i,t,e,s,n,r){i.goto(t),e.goto(s);let o=s+n,a=s,l=s-t;for(;;){let c=i.to+l-e.to,h=c||i.endSide-e.endSide,u=h<0?i.to+l:e.to,f=Math.min(u,o);if(i.point||e.point?i.point&&e.point&&(i.point==e.point||i.point.eq(e.point))&&Am(i.activeForPoint(i.to),e.activeForPoint(e.to))||r.comparePoint(a,f,i.point,e.point):f>a&&!Am(i.active,e.active)&&r.compareRange(a,f,i.active,e.active),u>o)break;(c||i.openEnd!=e.openEnd)&&r.boundChange&&r.boundChange(u),a=u,h<=0&&i.next(),h>=0&&e.next()}}function Am(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++)if(i[e]!=t[e]&&!i[e].eq(t[e]))return!1;return!0}function yu(i,t){for(let e=t,s=i.length-1;e<s;e++)i[e]=i[e+1];i.pop()}function bu(i,t,e){for(let s=i.length-1;s>=t;s--)i[s+1]=i[s];i[t]=e}function Zb(i,t){let e=-1,s=1e9;for(let n=0;n<t.length;n++)(t[n]-s||i[n].endSide-i[e].endSide)<0&&(e=n,s=t[n]);return e}function ol(i,t,e=i.length){let s=0;for(let n=0;n<e&&n<i.length;)i.charCodeAt(n)==9?(s+=t-s%t,n++):(s++,n=ri(i,n));return s}function Mm(i,t,e,s){for(let n=0,r=0;;){if(r>=t)return n;if(n==i.length)break;r+=i.charCodeAt(n)==9?e-r%e:1,n=ri(i,n)}return s===!0?-1:i.length}const Em="",Fb=typeof Symbol>"u"?"__"+Em:Symbol.for(Em),Rm=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Wb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class zr{constructor(t,e){this.rules=[];let{finish:s}=e||{};function n(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,a,l,c){let h=[],u=/^@(\w+)\b/.exec(o[0]),f=u&&u[1]=="keyframes";if(u&&a==null)return l.push(o[0]+";");for(let d in a){let p=a[d];if(/&/.test(d))r(d.split(/,\s*/).map(g=>o.map(m=>g.replace(/&/,m))).reduce((g,m)=>g.concat(m)),p,l);else if(p&&typeof p=="object"){if(!u)throw new RangeError("The value of a property ("+d+") should be a primitive value.");r(n(d),p,h,f)}else p!=null&&h.push(d.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+p+";")}(h.length||f)&&l.push((s&&!u&&!c?o.map(s):o).join(", ")+" {"+h.join(" ")+"}")}for(let o in t)r(n(o),t[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=Wb[Fb]||1;return Wb[Fb]=t+1,Em+t.toString(36)}static mount(t,e,s){let n=t[Rm],r=s&&s.nonce;n?r&&n.setNonce(r):n=new CI(t,r),n.mount(Array.isArray(e)?e:[e],t)}}let qb=new Map;class CI{constructor(t,e){let s=t.ownerDocument||t,n=s.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let r=qb.get(s);if(r)return t[Rm]=r;this.sheet=new n.CSSStyleSheet,qb.set(s,this)}else this.styleTag=s.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[Rm]=this}mount(t,e){let s=this.sheet,n=0,r=0;for(let o=0;o<t.length;o++){let a=t[o],l=this.modules.indexOf(a);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,a),s)for(let c=0;c<a.rules.length;c++)s.insertRule(a.rules[c],n++)}else{for(;r<l;)n+=this.modules[r++].rules.length;n+=a.rules.length,r++}}if(s)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=e.head||e;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var jr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},$c={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},TI=typeof navigator<"u"&&/Mac/.test(navigator.platform),PI=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var si=0;si<10;si++)jr[48+si]=jr[96+si]=String(si);for(var si=1;si<=24;si++)jr[si+111]="F"+si;for(var si=65;si<=90;si++)jr[si]=String.fromCharCode(si+32),$c[si]=String.fromCharCode(si);for(var Kp in jr)$c.hasOwnProperty(Kp)||($c[Kp]=jr[Kp]);function AI(i){var t=TI&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||PI&&i.shiftKey&&i.key&&i.key.length==1||i.key=="Unidentified",e=!t&&i.key||(i.shiftKey?$c:jr)[i.keyCode]||i.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function ie(){var i=arguments[0];typeof i=="string"&&(i=document.createElement(i));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var n=e[s];typeof n=="string"?i.setAttribute(s,n):n!=null&&(i[s]=n)}t++}for(;t<arguments.length;t++)Qw(i,arguments[t]);return i}function Qw(i,t){if(typeof t=="string")i.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)i.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)Qw(i,t[e]);else throw new RangeError("Unsupported child node: "+t)}let Si=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Qm=typeof document<"u"?document:{documentElement:{style:{}}};const Im=/Edge\/(\d+)/.exec(Si.userAgent),Iw=/MSIE \d/.test(Si.userAgent),$m=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Si.userAgent),np=!!(Iw||$m||Im),Xb=!np&&/gecko\/(\d+)/i.test(Si.userAgent),Jp=!np&&/Chrome\/(\d+)/.exec(Si.userAgent),MI="webkitFontSmoothing"in Qm.documentElement.style,Nm=!np&&/Apple Computer/.test(Si.vendor),zb=Nm&&(/Mobile\/\w+/.test(Si.userAgent)||Si.maxTouchPoints>2);var ut={mac:zb||/Mac/.test(Si.platform),windows:/Win/.test(Si.platform),linux:/Linux|X11/.test(Si.platform),ie:np,ie_version:Iw?Qm.documentMode||6:$m?+$m[1]:Im?+Im[1]:0,gecko:Xb,gecko_version:Xb?+(/Firefox\/(\d+)/.exec(Si.userAgent)||[0,0])[1]:0,chrome:!!Jp,chrome_version:Jp?+Jp[1]:0,ios:zb,android:/Android\b/.test(Si.userAgent),webkit_version:MI?+(/\bAppleWebKit\/(\d+)/.exec(Si.userAgent)||[0,0])[1]:0,safari:Nm,safari_version:Nm?+(/\bVersion\/(\d+(\.\d+)?)/.exec(Si.userAgent)||[0,0])[1]:0,tabSize:Qm.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Nc(i){let t;return i.nodeType==11?t=i.getSelection?i:i.ownerDocument:t=i,t.getSelection()}function Dm(i,t){return t?i==t||i.contains(t.nodeType!=1?t.parentNode:t):!1}function Ju(i,t){if(!t.anchorNode)return!1;try{return Dm(i,t.anchorNode)}catch{return!1}}function Wa(i){return i.nodeType==3?$o(i,0,i.nodeValue.length).getClientRects():i.nodeType==1?i.getClientRects():[]}function pc(i,t,e,s){return e?jb(i,t,e,s,-1)||jb(i,t,e,s,1):!1}function Io(i){for(var t=0;;t++)if(i=i.previousSibling,!i)return t}function Wf(i){return i.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(i.nodeName)}function jb(i,t,e,s,n){for(;;){if(i==e&&t==s)return!0;if(t==(n<0?0:Sn(i))){if(i.nodeName=="DIV")return!1;let r=i.parentNode;if(!r||r.nodeType!=1)return!1;t=Io(i)+(n<0?0:1),i=r}else if(i.nodeType==1){if(i=i.childNodes[t+(n<0?-1:0)],i.nodeType==1&&i.contentEditable=="false")return!1;t=n<0?Sn(i):0}else return!1}}function Sn(i){return i.nodeType==3?i.nodeValue.length:i.childNodes.length}function vh(i,t){let e=t?i.left:i.right;return{left:e,right:e,top:i.top,bottom:i.bottom}}function EI(i){let t=i.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:i.innerWidth,top:0,bottom:i.innerHeight}}function $w(i,t){let e=t.width/i.offsetWidth,s=t.height/i.offsetHeight;return(e>.995&&e<1.005||!isFinite(e)||Math.abs(t.width-i.offsetWidth)<1)&&(e=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(t.height-i.offsetHeight)<1)&&(s=1),{scaleX:e,scaleY:s}}function RI(i,t,e,s,n,r,o,a){let l=i.ownerDocument,c=l.defaultView||window;for(let h=i,u=!1;h&&!u;)if(h.nodeType==1){let f,d=h==l.body,p=1,g=1;if(d)f=EI(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(u=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let b=h.getBoundingClientRect();({scaleX:p,scaleY:g}=$w(h,b)),f={left:b.left,right:b.left+h.clientWidth*p,top:b.top,bottom:b.top+h.clientHeight*g}}let m=0,O=0;if(n=="nearest")t.top<f.top?(O=t.top-(f.top+o),e>0&&t.bottom>f.bottom+O&&(O=t.bottom-f.bottom+o)):t.bottom>f.bottom&&(O=t.bottom-f.bottom+o,e<0&&t.top-O<f.top&&(O=t.top-(f.top+o)));else{let b=t.bottom-t.top,x=f.bottom-f.top;O=(n=="center"&&b<=x?t.top+b/2-x/2:n=="start"||n=="center"&&e<0?t.top-o:t.bottom-x+o)-f.top}if(s=="nearest"?t.left<f.left?(m=t.left-(f.left+r),e>0&&t.right>f.right+m&&(m=t.right-f.right+r)):t.right>f.right&&(m=t.right-f.right+r,e<0&&t.left<f.left+m&&(m=t.left-(f.left+r))):m=(s=="center"?t.left+(t.right-t.left)/2-(f.right-f.left)/2:s=="start"==a?t.left-r:t.right-(f.right-f.left)+r)-f.left,m||O)if(d)c.scrollBy(m,O);else{let b=0,x=0;if(O){let v=h.scrollTop;h.scrollTop+=O/g,x=(h.scrollTop-v)*g}if(m){let v=h.scrollLeft;h.scrollLeft+=m/p,b=(h.scrollLeft-v)*p}t={left:t.left-b,top:t.top-x,right:t.right-b,bottom:t.bottom-x},b&&Math.abs(b-m)<1&&(s="nearest"),x&&Math.abs(x-O)<1&&(n="nearest")}if(d)break;(t.top<f.top||t.bottom>f.bottom||t.left<f.left||t.right>f.right)&&(t={left:Math.max(t.left,f.left),right:Math.min(t.right,f.right),top:Math.max(t.top,f.top),bottom:Math.min(t.bottom,f.bottom)}),h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}function QI(i){let t=i.ownerDocument,e,s;for(let n=i.parentNode;n&&!(n==t.body||e&&s);)if(n.nodeType==1)!s&&n.scrollHeight>n.clientHeight&&(s=n),!e&&n.scrollWidth>n.clientWidth&&(e=n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;return{x:e,y:s}}class II{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:s}=t;this.set(e,Math.min(t.anchorOffset,e?Sn(e):0),s,Math.min(t.focusOffset,s?Sn(s):0))}set(t,e,s,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=s,this.focusOffset=n}}let go=null;ut.safari&&ut.safari_version>=26&&(go=!1);function Nw(i){if(i.setActive)return i.setActive();if(go)return i.focus(go);let t=[];for(let e=i;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(i.focus(go==null?{get preventScroll(){return go={preventScroll:!0},!0}}:void 0),!go){go=!1;for(let e=0;e<t.length;){let s=t[e++],n=t[e++],r=t[e++];s.scrollTop!=n&&(s.scrollTop=n),s.scrollLeft!=r&&(s.scrollLeft=r)}}}let Gb;function $o(i,t,e=t){let s=Gb||(Gb=document.createRange());return s.setEnd(i,e),s.setStart(i,t),s}function Pa(i,t,e,s){let n={key:t,code:t,keyCode:e,which:e,cancelable:!0};s&&({altKey:n.altKey,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,metaKey:n.metaKey}=s);let r=new KeyboardEvent("keydown",n);r.synthetic=!0,i.dispatchEvent(r);let o=new KeyboardEvent("keyup",n);return o.synthetic=!0,i.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function $I(i){for(;i;){if(i&&(i.nodeType==9||i.nodeType==11&&i.host))return i;i=i.assignedSlot||i.parentNode}return null}function Dw(i){for(;i.attributes.length;)i.removeAttributeNode(i.attributes[0])}function NI(i,t){let e=t.focusNode,s=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=s)return!1;for(s=Math.min(s,Sn(e));;)if(s){if(e.nodeType!=1)return!1;let n=e.childNodes[s-1];n.contentEditable=="false"?s--:(e=n,s=Sn(e))}else{if(e==i)return!0;s=Io(e),e=e.parentNode}}function Lw(i){return i.scrollTop>Math.max(1,i.scrollHeight-i.clientHeight-4)}function Vw(i,t){for(let e=i,s=t;;){if(e.nodeType==3&&s>0)return{node:e,offset:s};if(e.nodeType==1&&s>0){if(e.contentEditable=="false")return null;e=e.childNodes[s-1],s=Sn(e)}else if(e.parentNode&&!Wf(e))s=Io(e),e=e.parentNode;else return null}}function Bw(i,t){for(let e=i,s=t;;){if(e.nodeType==3&&s<e.nodeValue.length)return{node:e,offset:s};if(e.nodeType==1&&s<e.childNodes.length){if(e.contentEditable=="false")return null;e=e.childNodes[s],s=0}else if(e.parentNode&&!Wf(e))s=Io(e)+1,e=e.parentNode;else return null}}class fi{constructor(t,e,s=!0){this.node=t,this.offset=e,this.precise=s}static before(t,e){return new fi(t.parentNode,Io(t),e)}static after(t,e){return new fi(t.parentNode,Io(t)+1,e)}}const FO=[];class te{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let s of this.children){if(s==t)return e;e+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(this.flags&2){let s=this.dom,n=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=n?n.nextSibling:s.firstChild)){let a=te.get(r);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(t,e),o.flags&=-8}if(r=n?n.nextSibling:s.firstChild,e&&!e.written&&e.node==s&&r!=o.dom&&(e.written=!0),o.dom.parentNode==s)for(;r&&r!=o.dom;)r=Yb(r);else s.insertBefore(o.dom,r);n=o.dom}for(r=n?n.nextSibling:s.firstChild,r&&e&&e.node==s&&(e.written=!0);r;)r=Yb(r)}else if(this.flags&1)for(let s of this.children)s.flags&7&&(s.sync(t,e),s.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let s;if(t==this.dom)s=this.dom.childNodes[e];else{let n=Sn(t)==0?0:e==0?-1:1;for(;;){let r=t.parentNode;if(r==this.dom)break;n==0&&r.firstChild!=r.lastChild&&(t==r.firstChild?n=-1:n=1),t=r}n<0?s=t:s=t.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!te.get(s);)s=s.nextSibling;if(!s)return this.length;for(let n=0,r=0;;n++){let o=this.children[n];if(o.dom==s)return r;r+=o.length+o.breakAfter}}domBoundsAround(t,e,s=0){let n=-1,r=-1,o=-1,a=-1;for(let l=0,c=s,h=s;l<this.children.length;l++){let u=this.children[l],f=c+u.length;if(c<t&&f>e)return u.domBoundsAround(t,e,c);if(f>=t&&n==-1&&(n=l,r=c),c>e&&u.dom.parentNode==this.dom){o=l,a=h;break}h=f,c=f+u.breakAfter}return{from:r,to:a<0?s+this.length:a,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),e.flags&1)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,s=FO){this.markDirty();for(let n=t;n<e;n++){let r=this.children[n];r.parent==this&&s.indexOf(r)<0&&r.destroy()}s.length<250?this.children.splice(t,e-t,...s):this.children=[].concat(this.children.slice(0,t),s,this.children.slice(e));for(let n=0;n<s.length;n++)s[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Zw(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,s,n,r,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}te.prototype.breakAfter=0;function Yb(i){let t=i.nextSibling;return i.parentNode.removeChild(i),t}class Zw{constructor(t,e,s){this.children=t,this.pos=e,this.i=s,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function Fw(i,t,e,s,n,r,o,a,l){let{children:c}=i,h=c.length?c[t]:null,u=r.length?r[r.length-1]:null,f=u?u.breakAfter:o;if(!(t==s&&h&&!o&&!f&&r.length<2&&h.merge(e,n,r.length?u:null,e==0,a,l))){if(s<c.length){let d=c[s];d&&(n<d.length||d.breakAfter&&u?.breakAfter)?(t==s&&(d=d.split(n),n=0),!f&&u&&d.merge(0,n,u,!0,0,l)?r[r.length-1]=d:((n||d.children.length&&!d.children[0].length)&&d.merge(0,n,null,!1,0,l),r.push(d))):d?.breakAfter&&(u?u.breakAfter=1:o=1),s++}for(h&&(h.breakAfter=o,e>0&&(!o&&r.length&&h.merge(e,h.length,r[0],!1,a,0)?h.breakAfter=r.shift().breakAfter:(e<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(e,h.length,null,!1,a,0),t++));t<s&&r.length;)if(c[s-1].become(r[r.length-1]))s--,r.pop(),l=r.length?0:a;else if(c[t].become(r[0]))t++,r.shift(),a=r.length?0:l;else break;!r.length&&t&&s<c.length&&!c[t-1].breakAfter&&c[s].merge(0,0,c[t-1],!1,a,l)&&t--,(t<s||r.length)&&i.replaceChildren(t,s,r)}}function Ww(i,t,e,s,n,r){let o=i.childCursor(),{i:a,off:l}=o.findPos(e,1),{i:c,off:h}=o.findPos(t,-1),u=t-e;for(let f of s)u+=f.length;i.length+=u,Fw(i,c,h,a,l,s,0,n,r)}const DI=256;class Ws extends te{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,s){return this.flags&8||s&&(!(s instanceof Ws)||this.length-(e-t)+s.length>DI||s.flags&8)?!1:(this.text=this.text.slice(0,t)+(s?s.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new Ws(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=this.flags&8,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new fi(this.dom,t)}domBoundsAround(t,e,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return LI(this.dom,t,e)}}class tr extends te{constructor(t,e=[],s=0){super(),this.mark=t,this.children=e,this.length=s;for(let n of e)n.setParent(this)}setAttrs(t){if(Dw(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,s,n,r,o){return s&&(!(s instanceof tr&&s.mark.eq(this.mark))||t&&r<=0||e<this.length&&o<=0)?!1:(Ww(this,t,e,s?s.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(t){let e=[],s=0,n=-1,r=0;for(let a of this.children){let l=s+a.length;l>t&&e.push(s<t?a.split(t-s):a),n<0&&s>=t&&(n=r),s=l,r++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new tr(this.mark,e,o)}domAtPos(t){return qw(this,t)}coordsAt(t,e){return zw(this,t,e)}}function LI(i,t,e){let s=i.nodeValue.length;t>s&&(t=s);let n=t,r=t,o=0;t==0&&e<0||t==s&&e>=0?ut.chrome||ut.gecko||(t?(n--,o=1):r<s&&(r++,o=-1)):e<0?n--:r<s&&r++;let a=$o(i,n,r).getClientRects();if(!a.length)return null;let l=a[(o?o<0:e>=0)?0:a.length-1];return ut.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),o?vh(l,o<0):l||null}class Er extends te{static create(t,e,s){return new Er(t,e,s)}constructor(t,e,s){super(),this.widget=t,this.length=e,this.side=s,this.prevWidget=null}split(t){let e=Er.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,s,n,r,o){return s&&(!(s instanceof Er)||!this.widget.compare(s.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(s?s.length:0)+(this.length-e),!0)}become(t){return t instanceof Er&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return Wt.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,s=e&&e.state.doc,n=this.posAtStart;return s?s.slice(n,n+this.length):Wt.empty}domAtPos(t){return(this.length?t==0:this.side>0)?fi.before(this.dom):fi.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let s=this.widget.coordsAt(this.dom,t,e);if(s)return s;let n=this.dom.getClientRects(),r=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let a=o?n.length-1:0;r=n[a],!(t>0?a==0:a==n.length-1||r.top<r.bottom);a+=o?-1:1);return vh(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class qa extends te{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof qa&&t.side==this.side}split(){return new qa(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?fi.before(this.dom):fi.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Wt.empty}get isHidden(){return!0}}Ws.prototype.children=Er.prototype.children=qa.prototype.children=FO;function qw(i,t){let e=i.dom,{children:s}=i,n=0;for(let r=0;n<s.length;n++){let o=s[n],a=r+o.length;if(!(a==r&&o.getSide()<=0)){if(t>r&&t<a&&o.dom.parentNode==e)return o.domAtPos(t-r);if(t<=r)break;r=a}}for(let r=n;r>0;r--){let o=s[r-1];if(o.dom.parentNode==e)return o.domAtPos(o.length)}for(let r=n;r<s.length;r++){let o=s[r];if(o.dom.parentNode==e)return o.domAtPos(0)}return new fi(e,0)}function Xw(i,t,e){let s,{children:n}=i;e>0&&t instanceof tr&&n.length&&(s=n[n.length-1])instanceof tr&&s.mark.eq(t.mark)?Xw(s,t.children[0],e-1):(n.push(t),t.setParent(i)),i.length+=t.length}function zw(i,t,e){let s=null,n=-1,r=null,o=-1;function a(c,h){for(let u=0,f=0;u<c.children.length&&f<=h;u++){let d=c.children[u],p=f+d.length;p>=h&&(d.children.length?a(d,h-f):(!r||r.isHidden&&(e>0||BI(r,d)))&&(p>h||f==p&&d.getSide()>0)?(r=d,o=h-f):(f<h||f==p&&d.getSide()<0&&!d.isHidden)&&(s=d,n=h-f)),f=p}}a(i,t);let l=(e<0?s:r)||s||r;return l?l.coordsAt(Math.max(0,l==s?n:o),e):VI(i)}function VI(i){let t=i.dom.lastChild;if(!t)return i.dom.getBoundingClientRect();let e=Wa(t);return e[e.length-1]||null}function BI(i,t){let e=i.coordsAt(0,1),s=t.coordsAt(0,1);return e&&s&&s.top<e.bottom}function Lm(i,t){for(let e in i)e=="class"&&t.class?t.class+=" "+i.class:e=="style"&&t.style?t.style+=";"+i.style:t[e]=i[e];return t}const Ub=Object.create(null);function qf(i,t,e){if(i==t)return!0;i||(i=Ub),t||(t=Ub);let s=Object.keys(i),n=Object.keys(t);if(s.length-(e&&s.indexOf(e)>-1?1:0)!=n.length-(e&&n.indexOf(e)>-1?1:0))return!1;for(let r of s)if(r!=e&&(n.indexOf(r)==-1||i[r]!==t[r]))return!1;return!0}function Vm(i,t,e){let s=!1;if(t)for(let n in t)e&&n in e||(s=!0,n=="style"?i.style.cssText="":i.removeAttribute(n));if(e)for(let n in e)t&&t[n]==e[n]||(s=!0,n=="style"?i.style.cssText=e[n]:i.setAttribute(n,e[n]));return s}function ZI(i){let t=Object.create(null);for(let e=0;e<i.attributes.length;e++){let s=i.attributes[e];t[s.name]=s.value}return t}class Mn{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var Ai=(function(i){return i[i.Text=0]="Text",i[i.WidgetBefore=1]="WidgetBefore",i[i.WidgetAfter=2]="WidgetAfter",i[i.WidgetRange=3]="WidgetRange",i})(Ai||(Ai={}));class vt extends Qo{constructor(t,e,s,n){super(),this.startSide=t,this.endSide=e,this.widget=s,this.spec=n}get heightRelevant(){return!1}static mark(t){return new _h(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),s=!!t.block;return e+=s&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new Gr(t,e,e,s,t.widget||null,!1)}static replace(t){let e=!!t.block,s,n;if(t.isBlockGap)s=-5e8,n=4e8;else{let{start:r,end:o}=jw(t,e);s=(r?e?-3e8:-1:5e8)-1,n=(o?e?2e8:1:-6e8)+1}return new Gr(t,s,n,e,t.widget||null,!0)}static line(t){return new xh(t)}static set(t,e=!1){return zt.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}vt.none=zt.empty;class _h extends vt{constructor(t){let{start:e,end:s}=jw(t);super(e?-1:5e8,s?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,s;return this==t||t instanceof _h&&this.tagName==t.tagName&&(this.class||((e=this.attrs)===null||e===void 0?void 0:e.class))==(t.class||((s=t.attrs)===null||s===void 0?void 0:s.class))&&qf(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}_h.prototype.point=!1;class xh extends vt{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof xh&&this.spec.class==t.spec.class&&qf(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}xh.prototype.mapMode=ni.TrackBefore;xh.prototype.point=!0;class Gr extends vt{constructor(t,e,s,n,r,o){super(e,s,r,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?ni.TrackBefore:ni.TrackAfter:ni.TrackDel}get type(){return this.startSide!=this.endSide?Ai.WidgetRange:this.startSide<=0?Ai.WidgetBefore:Ai.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Gr&&FI(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}Gr.prototype.point=!0;function jw(i,t=!1){let{inclusiveStart:e,inclusiveEnd:s}=i;return e==null&&(e=i.inclusive),s==null&&(s=i.inclusive),{start:e??t,end:s??t}}function FI(i,t){return i==t||!!(i&&t&&i.compare(t))}function tf(i,t,e,s=0){let n=e.length-1;n>=0&&e[n]+s>=i?e[n]=Math.max(e[n],t):e.push(i,t)}class Qe extends te{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,s,n,r,o){if(s){if(!(s instanceof Qe))return!1;this.dom||s.transferDOM(this)}return n&&this.setDeco(s?s.attrs:null),Ww(this,t,e,s?s.children.slice():[],r,o),!0}split(t){let e=new Qe;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i:s,off:n}=this.childPos(t);n&&(e.append(this.children[s].split(n),0),this.children[s].merge(n,this.children[s].length,null,!1,0,0),s++);for(let r=s;r<this.children.length;r++)e.append(this.children[r],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){qf(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Xw(this,t,e)}addLineDeco(t){let e=t.spec.attributes,s=t.spec.class;e&&(this.attrs=Lm(e,this.attrs||{})),s&&(this.attrs=Lm({class:s},this.attrs||{}))}domAtPos(t){return qw(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,e){var s;this.dom?this.flags&4&&(Dw(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Vm(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&te.get(n)instanceof tr;)n=n.lastChild;if(!n||!this.length||n.nodeName!="BR"&&((s=te.get(n))===null||s===void 0?void 0:s.isEditable)==!1&&(!ut.ios||!this.children.some(r=>r instanceof Ws))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,e;for(let s of this.children){if(!(s instanceof Ws)||/[^ -~]/.test(s.text))return null;let n=Wa(s.dom);if(n.length!=1)return null;t+=n[0].width,e=n[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(t,e){let s=zw(this,t,e);if(!this.children.length&&s&&this.parent){let{heightOracle:n}=this.parent.view.viewState,r=s.bottom-s.top;if(Math.abs(r-n.lineHeight)<2&&n.textHeight<r){let o=(r-n.textHeight)/2;return{top:s.top+o,bottom:s.bottom-o,left:s.left,right:s.left}}}return s}become(t){return t instanceof Qe&&this.children.length==0&&t.children.length==0&&qf(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let s=0,n=0;s<t.children.length;s++){let r=t.children[s],o=n+r.length;if(o>=e){if(r instanceof Qe)return r;if(o>e)break}n=o+r.breakAfter}return null}}class zn extends te{constructor(t,e,s){super(),this.widget=t,this.length=e,this.deco=s,this.breakAfter=0,this.prevWidget=null}merge(t,e,s,n,r,o){return s&&(!(s instanceof zn)||!this.widget.compare(s.widget)||t>0&&r<=0||e<this.length&&o<=0)?!1:(this.length=t+(s?s.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?fi.before(this.dom):fi.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let s=new zn(this.widget,e,this.deco);return s.breakAfter=this.breakAfter,s}get children(){return FO}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Wt.empty}domBoundsAround(){return null}become(t){return t instanceof zn&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){let s=this.widget.coordsAt(this.dom,t,e);return s||(this.widget instanceof Bm?null:vh(this.dom.getBoundingClientRect(),this.length?t==0:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:s}=this.deco;return e==s?!1:t<0?e<0:s>0}}class Bm extends Mn{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class gc{constructor(t,e,s,n){this.doc=t,this.pos=e,this.end=s,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof zn&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Qe),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(vu(new qa(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof zn)&&this.getLine()}buildText(t,e,s){for(;t>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:a,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=o,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t),r=Math.min(n,512);this.flushBuffer(e.slice(e.length-s)),this.getLine().append(vu(new Ws(this.text.slice(this.textOff,this.textOff+r)),e),s),this.atCursorPos=!0,this.textOff+=r,t-=r,s=n<=r?0:e.length}}span(t,e,s,n){this.buildText(e-t,s,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,s,n,r,o){if(this.disallowBlockEffectsFor[o]&&s instanceof Gr){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=e-t;if(s instanceof Gr)if(s.block)s.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new zn(s.widget||Xa.block,a,s));else{let l=Er.create(s.widget||Xa.inline,a,a?0:s.startSide),c=this.atCursorPos&&!l.isEditable&&r<=n.length&&(t<e||s.startSide>0),h=!l.isEditable&&(t<e||r>n.length||s.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(n),c&&(u.append(vu(new qa(1),n),r),r=n.length+Math.max(0,r-n.length)),u.append(vu(l,n),r),this.atCursorPos=h,this.pendingBuffer=h?t<e||r>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=r)}static build(t,e,s,n,r){let o=new gc(t,e,s,r);return o.openEnd=zt.spans(n,e,s,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function vu(i,t){for(let e of t)i=new tr(e,[i],i.length);return i}class Xa extends Mn{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Xa.inline=new Xa("span");Xa.block=new Xa("div");var Oe=(function(i){return i[i.LTR=0]="LTR",i[i.RTL=1]="RTL",i})(Oe||(Oe={}));const No=Oe.LTR,WO=Oe.RTL;function Gw(i){let t=[];for(let e=0;e<i.length;e++)t.push(1<<+i[e]);return t}const WI=Gw("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),qI=Gw("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Zm=Object.create(null),sn=[];for(let i of["()","[]","{}"]){let t=i.charCodeAt(0),e=i.charCodeAt(1);Zm[t]=e,Zm[e]=-t}function Yw(i){return i<=247?WI[i]:1424<=i&&i<=1524?2:1536<=i&&i<=1785?qI[i-1536]:1774<=i&&i<=2220?4:8192<=i&&i<=8204?256:64336<=i&&i<=65023?4:1}const XI=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Rr{get dir(){return this.level%2?WO:No}constructor(t,e,s){this.from=t,this.to=e,this.level=s}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,s,n){let r=-1;for(let o=0;o<t.length;o++){let a=t[o];if(a.from<=e&&a.to>=e){if(a.level==s)return o;(r<0||(n!=0?n<0?a.from<e:a.to>e:t[r].level>a.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}function Uw(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++){let s=i[e],n=t[e];if(s.from!=n.from||s.to!=n.to||s.direction!=n.direction||!Uw(s.inner,n.inner))return!1}return!0}const re=[];function zI(i,t,e,s,n){for(let r=0;r<=s.length;r++){let o=r?s[r-1].to:t,a=r<s.length?s[r].from:e,l=r?256:n;for(let c=o,h=l,u=l;c<a;c++){let f=Yw(i.charCodeAt(c));f==512?f=h:f==8&&u==4&&(f=16),re[c]=f==4?2:f,f&7&&(u=f),h=f}for(let c=o,h=l,u=l;c<a;c++){let f=re[c];if(f==128)c<a-1&&h==re[c+1]&&h&24?f=re[c]=h:re[c]=256;else if(f==64){let d=c+1;for(;d<a&&re[d]==64;)d++;let p=c&&h==8||d<e&&re[d]==8?u==1?1:8:256;for(let g=c;g<d;g++)re[g]=p;c=d-1}else f==8&&u==1&&(re[c]=1);h=f,f&7&&(u=f)}}}function jI(i,t,e,s,n){let r=n==1?2:1;for(let o=0,a=0,l=0;o<=s.length;o++){let c=o?s[o-1].to:t,h=o<s.length?s[o].from:e;for(let u=c,f,d,p;u<h;u++)if(d=Zm[f=i.charCodeAt(u)])if(d<0){for(let g=a-3;g>=0;g-=3)if(sn[g+1]==-d){let m=sn[g+2],O=m&2?n:m&4?m&1?r:n:0;O&&(re[u]=re[sn[g]]=O),a=g;break}}else{if(sn.length==189)break;sn[a++]=u,sn[a++]=f,sn[a++]=l}else if((p=re[u])==2||p==1){let g=p==n;l=g?0:1;for(let m=a-3;m>=0;m-=3){let O=sn[m+2];if(O&2)break;if(g)sn[m+2]|=2;else{if(O&4)break;sn[m+2]|=4}}}}}function GI(i,t,e,s){for(let n=0,r=s;n<=e.length;n++){let o=n?e[n-1].to:i,a=n<e.length?e[n].from:t;for(let l=o;l<a;){let c=re[l];if(c==256){let h=l+1;for(;;)if(h==a){if(n==e.length)break;h=e[n++].to,a=n<e.length?e[n].from:t}else if(re[h]==256)h++;else break;let u=r==1,f=(h<t?re[h]:s)==1,d=u==f?u?1:2:s;for(let p=h,g=n,m=g?e[g-1].to:i;p>l;)p==m&&(p=e[--g].from,m=g?e[g-1].to:i),re[--p]=d;l=h}else r=c,l++}}}function Fm(i,t,e,s,n,r,o){let a=s%2?2:1;if(s%2==n%2)for(let l=t,c=0;l<e;){let h=!0,u=!1;if(c==r.length||l<r[c].from){let g=re[l];g!=a&&(h=!1,u=g==16)}let f=!h&&a==1?[]:null,d=h?s:s+1,p=l;t:for(;;)if(c<r.length&&p==r[c].from){if(u)break t;let g=r[c];if(!h)for(let m=g.to,O=c+1;;){if(m==e)break t;if(O<r.length&&r[O].from==m)m=r[O++].to;else{if(re[m]==a)break t;break}}if(c++,f)f.push(g);else{g.from>l&&o.push(new Rr(l,g.from,d));let m=g.direction==No!=!(d%2);Wm(i,m?s+1:s,n,g.inner,g.from,g.to,o),l=g.to}p=g.to}else{if(p==e||(h?re[p]!=a:re[p]==a))break;p++}f?Fm(i,l,p,s+1,n,f,o):l<p&&o.push(new Rr(l,p,d)),l=p}else for(let l=e,c=r.length;l>t;){let h=!0,u=!1;if(!c||l>r[c-1].to){let g=re[l-1];g!=a&&(h=!1,u=g==16)}let f=!h&&a==1?[]:null,d=h?s:s+1,p=l;t:for(;;)if(c&&p==r[c-1].to){if(u)break t;let g=r[--c];if(!h)for(let m=g.from,O=c;;){if(m==t)break t;if(O&&r[O-1].to==m)m=r[--O].from;else{if(re[m-1]==a)break t;break}}if(f)f.push(g);else{g.to<l&&o.push(new Rr(g.to,l,d));let m=g.direction==No!=!(d%2);Wm(i,m?s+1:s,n,g.inner,g.from,g.to,o),l=g.from}p=g.from}else{if(p==t||(h?re[p-1]!=a:re[p-1]==a))break;p--}f?Fm(i,p,l,s+1,n,f,o):p<l&&o.push(new Rr(p,l,d)),l=p}}function Wm(i,t,e,s,n,r,o){let a=t%2?2:1;zI(i,n,r,s,a),jI(i,n,r,s,a),GI(n,r,s,a),Fm(i,n,r,t,e,s,o)}function YI(i,t,e){if(!i)return[new Rr(0,0,t==WO?1:0)];if(t==No&&!e.length&&!XI.test(i))return Hw(i.length);if(e.length)for(;i.length>re.length;)re[re.length]=256;let s=[],n=t==No?0:1;return Wm(i,n,n,e,0,i.length,s),s}function Hw(i){return[new Rr(0,i,0)]}let Kw="";function UI(i,t,e,s,n){var r;let o=s.head-i.from,a=Rr.find(t,o,(r=s.bidiLevel)!==null&&r!==void 0?r:-1,s.assoc),l=t[a],c=l.side(n,e);if(o==c){let f=a+=n?1:-1;if(f<0||f>=t.length)return null;l=t[a=f],o=l.side(!n,e),c=l.side(n,e)}let h=ri(i.text,o,l.forward(n,e));(h<l.from||h>l.to)&&(h=c),Kw=i.text.slice(Math.min(o,h),Math.max(o,h));let u=a==(n?t.length-1:0)?null:t[a+(n?1:-1)];return u&&h==c&&u.level+(n?0:1)<l.level?G.cursor(u.side(!n,e)+i.from,u.forward(n,e)?1:-1,u.level):G.cursor(h+i.from,l.forward(n,e)?-1:1,l.level)}function HI(i,t,e){for(let s=t;s<e;s++){let n=Yw(i.charCodeAt(s));if(n==1)return No;if(n==2||n==4)return WO}return No}const Jw=ft.define(),tk=ft.define(),ek=ft.define(),ik=ft.define(),qm=ft.define(),sk=ft.define(),nk=ft.define(),qO=ft.define(),XO=ft.define(),rk=ft.define({combine:i=>i.some(t=>t)}),ok=ft.define({combine:i=>i.some(t=>t)}),ak=ft.define();class Aa{constructor(t,e="nearest",s="nearest",n=5,r=5,o=!1){this.range=t,this.y=e,this.x=s,this.yMargin=n,this.xMargin=r,this.isSnapshot=o}map(t){return t.empty?this:new Aa(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Aa(G.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const _u=Et.define({map:(i,t)=>i.map(t)}),lk=Et.define();function qi(i,t,e){let s=i.facet(ik);s.length?s[0](t):window.onerror&&window.onerror(String(t),e,void 0,void 0,t)||(e?console.error(e+":",t):console.error(t))}const qn=ft.define({combine:i=>i.length?i[0]:!0});let KI=0;const ma=ft.define({combine(i){return i.filter((t,e)=>{for(let s=0;s<e;s++)if(i[s].plugin==t.plugin)return!1;return!0})}});class Me{constructor(t,e,s,n,r){this.id=t,this.create=e,this.domEventHandlers=s,this.domEventObservers=n,this.baseExtensions=r(this),this.extension=this.baseExtensions.concat(ma.of({plugin:this,arg:void 0}))}of(t){return this.baseExtensions.concat(ma.of({plugin:this,arg:t}))}static define(t,e){const{eventHandlers:s,eventObservers:n,provide:r,decorations:o}=e||{};return new Me(KI++,t,s,n,a=>{let l=[];return o&&l.push(Dc.of(c=>{let h=c.plugin(a);return h?o(h):vt.none})),r&&l.push(r(a)),l})}static fromClass(t,e){return Me.define((s,n)=>new t(s,n),e)}}class tg{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(s){if(qi(e.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(t,this.spec.arg)}catch(e){qi(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(s){qi(t.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const ck=ft.define(),zO=ft.define(),Dc=ft.define(),hk=ft.define(),Sh=ft.define(),uk=ft.define();function Hb(i,t){let e=i.state.facet(uk);if(!e.length)return e;let s=e.map(r=>r instanceof Function?r(i):r),n=[];return zt.spans(s,t.from,t.to,{point(){},span(r,o,a,l){let c=r-t.from,h=o-t.from,u=n;for(let f=a.length-1;f>=0;f--,l--){let d=a[f].spec.bidiIsolate,p;if(d==null&&(d=HI(t.text,c,h)),l>0&&u.length&&(p=u[u.length-1]).to==c&&p.direction==d)p.to=h,u=p.inner;else{let g={from:c,to:h,direction:d,inner:[]};u.push(g),u=g.inner}}}}),n}const fk=ft.define();function jO(i){let t=0,e=0,s=0,n=0;for(let r of i.state.facet(fk)){let o=r(i);o&&(o.left!=null&&(t=Math.max(t,o.left)),o.right!=null&&(e=Math.max(e,o.right)),o.top!=null&&(s=Math.max(s,o.top)),o.bottom!=null&&(n=Math.max(n,o.bottom)))}return{left:t,right:e,top:s,bottom:n}}const Yl=ft.define();class ks{constructor(t,e,s,n){this.fromA=t,this.toA=e,this.fromB=s,this.toB=n}join(t){return new ks(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,s=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>s.toA)){if(n.toA<s.fromA)break;s=s.join(n),t.splice(e-1,1)}}return t.splice(e,0,s),t}static extendWithRanges(t,e){if(e.length==0)return t;let s=[];for(let n=0,r=0,o=0,a=0;;n++){let l=n==t.length?null:t[n],c=o-a,h=l?l.fromB:1e9;for(;r<e.length&&e[r]<h;){let u=e[r],f=e[r+1],d=Math.max(a,u),p=Math.min(h,f);if(d<=p&&new ks(d+c,p+c,d,p).addToSet(s),f>h)break;r+=2}if(!l)return s;new ks(l.fromA,l.toA,l.fromB,l.toB).addToSet(s),o=l.toA,a=l.toB}}}class Xf{constructor(t,e,s){this.view=t,this.state=e,this.transactions=s,this.flags=0,this.startState=t.state,this.changes=Xe.empty(this.startState.doc.length);for(let r of s)this.changes=this.changes.compose(r.changes);let n=[];this.changes.iterChangedRanges((r,o,a,l)=>n.push(new ks(r,o,a,l))),this.changedRanges=n}static create(t,e,s){return new Xf(t,e,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Kb extends te{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=vt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Qe],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ks(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let s=t.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:c,toA:h})=>h<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((e=this.domChanged)===null||e===void 0)&&e.newSel?n=this.domChanged.newSel.head:!r$(t.changes,this.hasComposition)&&!t.selectionSet&&(n=t.state.selection.main.head));let r=n>-1?t$(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:h}=this.hasComposition;s=new ks(c,h,t.changes.mapPos(c,-1),t.changes.mapPos(h,1)).addToSet(s.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(ut.ie||ut.chrome)&&!r&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=s$(o,a,t.changes);return s=ks.extendWithRanges(s,l),!(this.flags&7)&&s.length==0?!1:(this.updateInner(s,t.startState.doc.length,r),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,s){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,s);let{observer:n}=this.view;n.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=ut.chrome||ut.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||n.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof zn&&o.widget instanceof Bm&&r.push(o.dom);n.updateGaps(r)}updateChildren(t,e,s){let n=s?s.range.addToSet(t.slice()):t,r=this.childCursor(e);for(let o=n.length-1;;o--){let a=o>=0?n[o]:null;if(!a)break;let{fromA:l,toA:c,fromB:h,toB:u}=a,f,d,p,g;if(s&&s.range.fromB<u&&s.range.toB>h){let v=gc.build(this.view.state.doc,h,s.range.fromB,this.decorations,this.dynamicDecorationMap),y=gc.build(this.view.state.doc,s.range.toB,u,this.decorations,this.dynamicDecorationMap);d=v.breakAtStart,p=v.openStart,g=y.openEnd;let _=this.compositionView(s);y.breakAtStart?_.breakAfter=1:y.content.length&&_.merge(_.length,_.length,y.content[0],!1,y.openStart,0)&&(_.breakAfter=y.content[0].breakAfter,y.content.shift()),v.content.length&&_.merge(0,0,v.content[v.content.length-1],!0,0,v.openEnd)&&v.content.pop(),f=v.content.concat(_).concat(y.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:g}=gc.build(this.view.state.doc,h,u,this.decorations,this.dynamicDecorationMap));let{i:m,off:O}=r.findPos(c,1),{i:b,off:x}=r.findPos(l,-1);Fw(this,b,x,m,O,f,d,p,g)}s&&this.fixCompositionDOM(s)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let s of e.effects)s.is(lk)&&(this.editContextFormatting=s.value)}compositionView(t){let e=new Ws(t.text.nodeValue);e.flags|=8;for(let{deco:n}of t.marks)e=new tr(n,[e],e.length);let s=new Qe;return s.append(e,0),s}fixCompositionDOM(t){let e=(r,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=te.get(r);a&&a!=o&&(a.dom=null),o.setDOM(r)},s=this.childPos(t.range.fromB,1),n=this.children[s.i];e(t.line,n);for(let r=t.marks.length-1;r>=-1;r--)s=n.childPos(s.off,1),n=n.children[s.i],e(r>=0?t.marks[r].node:t.text,n)}updateSelection(t=!1,e=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let s=this.view.root.activeElement,n=s==this.dom,r=!n&&!(this.view.state.facet(qn)||this.dom.tabIndex>-1)&&Ju(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(!(n||e||r))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(ut.gecko&&a.empty&&!this.hasComposition&&JI(l)){let u=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(u,l.node.childNodes[l.offset]||null)),l=c=new fi(u,0),o=!0}let h=this.view.observer.selectionRange;(o||!h.focusNode||(!pc(l.node,l.offset,h.anchorNode,h.anchorOffset)||!pc(c.node,c.offset,h.focusNode,h.focusOffset))&&!this.suppressWidgetCursorChange(h,a))&&(this.view.observer.ignore(()=>{ut.android&&ut.chrome&&this.dom.contains(h.focusNode)&&n$(h.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let u=Nc(this.view.root);if(u)if(a.empty){if(ut.gecko){let f=e$(l.node,l.offset);if(f&&f!=3){let d=(f==1?Vw:Bw)(l.node,l.offset);d&&(l=new fi(d.node,d.offset))}}u.collapse(l.node,l.offset),a.bidiLevel!=null&&u.caretBidiLevel!==void 0&&(u.caretBidiLevel=a.bidiLevel)}else if(u.extend){u.collapse(l.node,l.offset);try{u.extend(c.node,c.offset)}catch{}}else{let f=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),f.setEnd(c.node,c.offset),f.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(f)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new fi(h.anchorNode,h.anchorOffset),this.impreciseHead=c.precise?null:new fi(h.focusNode,h.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&pc(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,s=Nc(t.root),{anchorNode:n,anchorOffset:r}=t.observer.selectionRange;if(!s||!e.empty||!e.assoc||!s.modify)return;let o=Qe.find(this,e.head);if(!o)return;let a=o.posAtStart;if(e.head==a||e.head==a+o.length)return;let l=this.coordsAt(e.head,-1),c=this.coordsAt(e.head,1);if(!l||!c||l.bottom>c.top)return;let h=this.domAtPos(e.head+e.assoc);s.collapse(h.node,h.offset),s.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let u=t.observer.selectionRange;t.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=e.from&&s.collapse(n,r)}moveToLine(t){let e=this.dom,s;if(t.node!=e)return t;for(let n=t.offset;!s&&n<e.childNodes.length;n++){let r=te.get(e.childNodes[n]);r instanceof Qe&&(s=r.domAtPos(0))}for(let n=t.offset-1;!s&&n>=0;n--){let r=te.get(e.childNodes[n]);r instanceof Qe&&(s=r.domAtPos(r.length))}return s?new fi(s.node,s.offset,!0):t}nearest(t){for(let e=t;e;){let s=te.get(e);if(s&&s.rootView==this)return s;e=e.parentNode}return null}posFromDOM(t,e){let s=this.nearest(t);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(t,e)+s.posAtStart}domAtPos(t){let{i:e,off:s}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(s<n.length||n instanceof Qe)break;e++,s=0}return this.children[e].domAtPos(s)}coordsAt(t,e){let s=null,n=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=r-a.breakAfter,c=l-a.length;if(l<t)break;if(c<=t&&(c<t||a.covers(-1))&&(l>t||a.covers(1))&&(!s||a instanceof Qe&&!(s instanceof Qe&&e>=0)))s=a,n=c;else if(s&&c==t&&l==t&&a instanceof zn&&Math.abs(e)<2){if(a.deco.startSide<0)break;o&&(s=null)}r=c}return s?s.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:s}=this.childPos(t,1),n=this.children[e];if(!(n instanceof Qe))return null;for(;n.children.length;){let{i:a,off:l}=n.childPos(s,1);for(;;a++){if(a==n.children.length)return null;if((n=n.children[a]).length)break}s=l}if(!(n instanceof Ws))return null;let r=ri(n.text,s);if(r==s)return null;let o=$o(n.dom,s,r).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(t){let e=[],{from:s,to:n}=t,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Oe.LTR;for(let c=0,h=0;h<this.children.length;h++){let u=this.children[h],f=c+u.length;if(f>n)break;if(c>=s){let d=u.dom.getBoundingClientRect();if(e.push(d.height),o){let p=u.dom.lastChild,g=p?Wa(p):[];if(g.length){let m=g[g.length-1],O=l?m.right-d.left:d.right-m.left;O>a&&(a=O,this.minWidth=r,this.minWidthFrom=c,this.minWidthTo=f)}}}c=f+u.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?Oe.RTL:Oe.LTR}measureTextSize(){for(let r of this.children)if(r instanceof Qe){let o=r.measureTextSize();if(o)return o}let t=document.createElement("div"),e,s,n;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let r=Wa(t.firstChild)[0];e=t.getBoundingClientRect().height,s=r?r.width/27:7,n=r?r.height:e,t.remove()}),{lineHeight:e,charWidth:s,textHeight:n}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Zw(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let s=0,n=0;;n++){let r=n==e.viewports.length?null:e.viewports[n],o=r?r.from-1:this.length;if(o>s){let a=(e.lineBlockAt(o).bottom-e.lineBlockAt(s).top)/this.view.scaleY;t.push(vt.replace({widget:new Bm(a),block:!0,inclusive:!0,isBlockGap:!0}).range(s,o))}if(!r)break;s=r.to+1}return vt.set(t)}updateDeco(){let t=1,e=this.view.state.facet(Dc).map(r=>(this.dynamicDecorationMap[t++]=typeof r=="function")?r(this.view):r),s=!1,n=this.view.state.facet(hk).map((r,o)=>{let a=typeof r=="function";return a&&(s=!0),a?r(this.view):r});for(n.length&&(this.dynamicDecorationMap[t++]=s,e.push(zt.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let c=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=c.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let c of this.view.state.facet(ak))try{if(c(this.view,t.range,t))return!0}catch(h){qi(this.view.state,h,"scroll handler")}let{range:e}=t,s=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!s)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(s={left:Math.min(s.left,n.left),top:Math.min(s.top,n.top),right:Math.max(s.right,n.right),bottom:Math.max(s.bottom,n.bottom)});let r=jO(this.view),o={left:s.left-r.left,top:s.top-r.top,right:s.right+r.right,bottom:s.bottom+r.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;RI(this.view.scrollDOM,o,e.head<e.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,a),-a),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==Oe.LTR)}}function JI(i){return i.node.nodeType==1&&i.node.firstChild&&(i.offset==0||i.node.childNodes[i.offset-1].contentEditable=="false")&&(i.offset==i.node.childNodes.length||i.node.childNodes[i.offset].contentEditable=="false")}function dk(i,t){let e=i.observer.selectionRange;if(!e.focusNode)return null;let s=Vw(e.focusNode,e.focusOffset),n=Bw(e.focusNode,e.focusOffset),r=s||n;if(n&&s&&n.node!=s.node){let a=te.get(n.node);if(!a||a instanceof Ws&&a.text!=n.node.nodeValue)r=n;else if(i.docView.lastCompositionAfterCursor){let l=te.get(s.node);!l||l instanceof Ws&&l.text!=s.node.nodeValue||(r=n)}}if(i.docView.lastCompositionAfterCursor=r!=s,!r)return null;let o=t-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function t$(i,t,e){let s=dk(i,e);if(!s)return null;let{node:n,from:r,to:o}=s,a=n.nodeValue;if(/[\n\r]/.test(a)||i.state.doc.sliceString(s.from,s.to)!=a)return null;let l=t.invertedDesc,c=new ks(l.mapPos(r),l.mapPos(o),r,o),h=[];for(let u=n.parentNode;;u=u.parentNode){let f=te.get(u);if(f instanceof tr)h.push({node:u,deco:f.mark});else{if(f instanceof Qe||u.nodeName=="DIV"&&u.parentNode==i.contentDOM)return{range:c,text:n,marks:h,line:u};if(u!=i.contentDOM)h.push({node:u,deco:new _h({inclusive:!0,attributes:ZI(u),tagName:u.tagName.toLowerCase()})});else return null}}}function e$(i,t){return i.nodeType!=1?0:(t&&i.childNodes[t-1].contentEditable=="false"?1:0)|(t<i.childNodes.length&&i.childNodes[t].contentEditable=="false"?2:0)}let i$=class{constructor(){this.changes=[]}compareRange(t,e){tf(t,e,this.changes)}comparePoint(t,e){tf(t,e,this.changes)}boundChange(t){tf(t,t,this.changes)}};function s$(i,t,e){let s=new i$;return zt.compare(i,t,e,s),s.changes}function n$(i,t){for(let e=i;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function r$(i,t){let e=!1;return t&&i.iterChangedRanges((s,n)=>{s<t.to&&n>t.from&&(e=!0)}),e}function o$(i,t,e=1){let s=i.charCategorizer(t),n=i.doc.lineAt(t),r=t-n.from;if(n.length==0)return G.cursor(t);r==0?e=1:r==n.length&&(e=-1);let o=r,a=r;e<0?o=ri(n.text,r,!1):a=ri(n.text,r);let l=s(n.text.slice(o,a));for(;o>0;){let c=ri(n.text,o,!1);if(s(n.text.slice(c,o))!=l)break;o=c}for(;a<n.length;){let c=ri(n.text,a);if(s(n.text.slice(a,c))!=l)break;a=c}return G.range(o+n.from,a+n.from)}function a$(i,t){return t.left>i?t.left-i:Math.max(0,i-t.right)}function l$(i,t){return t.top>i?t.top-i:Math.max(0,i-t.bottom)}function eg(i,t){return i.top<t.bottom-1&&i.bottom>t.top+1}function Jb(i,t){return t<i.top?{top:t,left:i.left,right:i.right,bottom:i.bottom}:i}function tv(i,t){return t>i.bottom?{top:i.top,left:i.left,right:i.right,bottom:t}:i}function Xm(i,t,e){let s,n,r,o,a=!1,l,c,h,u;for(let p=i.firstChild;p;p=p.nextSibling){let g=Wa(p);for(let m=0;m<g.length;m++){let O=g[m];n&&eg(n,O)&&(O=Jb(tv(O,n.bottom),n.top));let b=a$(t,O),x=l$(e,O);if(b==0&&x==0)return p.nodeType==3?ev(p,t,e):Xm(p,t,e);(!s||o>x||o==x&&r>b)&&(s=p,n=O,r=b,o=x,a=b?t<O.left?m>0:m<g.length-1:!0),b==0?e>O.bottom&&(!h||h.bottom<O.bottom)?(l=p,h=O):e<O.top&&(!u||u.top>O.top)&&(c=p,u=O):h&&eg(h,O)?h=tv(h,O.bottom):u&&eg(u,O)&&(u=Jb(u,O.top))}}if(h&&h.bottom>=e?(s=l,n=h):u&&u.top<=e&&(s=c,n=u),!s)return{node:i,offset:0};let f=Math.max(n.left,Math.min(n.right,t));if(s.nodeType==3)return ev(s,f,e);if(a&&s.contentEditable!="false")return Xm(s,f,e);let d=Array.prototype.indexOf.call(i.childNodes,s)+(t>=(n.left+n.right)/2?1:0);return{node:i,offset:d}}function ev(i,t,e){let s=i.nodeValue.length,n=-1,r=1e9,o=0;for(let a=0;a<s;a++){let l=$o(i,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let h=l[c];if(h.top==h.bottom)continue;o||(o=t-h.left);let u=(h.top>e?h.top-e:e-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&u<r){let f=t>=(h.left+h.right)/2,d=f;if((ut.chrome||ut.gecko)&&$o(i,a).getBoundingClientRect().left==h.right&&(d=!f),u<=0)return{node:i,offset:a+(d?1:0)};n=a+(d?1:0),r=u}}}return{node:i,offset:n>-1?n:o>0?i.nodeValue.length:0}}function pk(i,t,e,s=-1){var n,r;let o=i.contentDOM.getBoundingClientRect(),a=o.top+i.viewState.paddingTop,l,{docHeight:c}=i.viewState,{x:h,y:u}=t,f=u-a;if(f<0)return 0;if(f>c)return i.state.doc.length;for(let v=i.viewState.heightOracle.textHeight/2,y=!1;l=i.elementAtHeight(f),l.type!=Ai.Text;)for(;f=s>0?l.bottom+v:l.top-v,!(f>=0&&f<=c);){if(y)return e?null:0;y=!0,s=-s}u=a+f;let d=l.from;if(d<i.viewport.from)return i.viewport.from==0?0:e?null:iv(i,o,l,h,u);if(d>i.viewport.to)return i.viewport.to==i.state.doc.length?i.state.doc.length:e?null:iv(i,o,l,h,u);let p=i.dom.ownerDocument,g=i.root.elementFromPoint?i.root:p,m=g.elementFromPoint(h,u);m&&!i.contentDOM.contains(m)&&(m=null),m||(h=Math.max(o.left+1,Math.min(o.right-1,h)),m=g.elementFromPoint(h,u),m&&!i.contentDOM.contains(m)&&(m=null));let O,b=-1;if(m&&((n=i.docView.nearest(m))===null||n===void 0?void 0:n.isEditable)!=!1){if(p.caretPositionFromPoint){let v=p.caretPositionFromPoint(h,u);v&&({offsetNode:O,offset:b}=v)}else if(p.caretRangeFromPoint){let v=p.caretRangeFromPoint(h,u);v&&({startContainer:O,startOffset:b}=v)}O&&(!i.contentDOM.contains(O)||ut.safari&&c$(O,b,h)||ut.chrome&&h$(O,b,h))&&(O=void 0),O&&(b=Math.min(Sn(O),b))}if(!O||!i.docView.dom.contains(O)){let v=Qe.find(i.docView,d);if(!v)return f>l.top+l.height/2?l.to:l.from;({node:O,offset:b}=Xm(v.dom,h,u))}let x=i.docView.nearest(O);if(!x)return null;if(x.isWidget&&((r=x.dom)===null||r===void 0?void 0:r.nodeType)==1){let v=x.dom.getBoundingClientRect();return t.y<v.top||t.y<=v.bottom&&t.x<=(v.left+v.right)/2?x.posAtStart:x.posAtEnd}else return x.localPosFromDOM(O,b)+x.posAtStart}function iv(i,t,e,s,n){let r=Math.round((s-t.left)*i.defaultCharacterWidth);if(i.lineWrapping&&e.height>i.defaultLineHeight*1.5){let a=i.viewState.heightOracle.textHeight,l=Math.floor((n-e.top-(i.defaultLineHeight-a)*.5)/a);r+=l*i.viewState.heightOracle.lineLength}let o=i.state.sliceDoc(e.from,e.to);return e.from+Mm(o,r,i.state.tabSize)}function gk(i,t,e){let s,n=i;if(i.nodeType!=3||t!=(s=i.nodeValue.length))return!1;for(;;){let r=n.nextSibling;if(r){if(r.nodeName=="BR")break;return!1}else{let o=n.parentNode;if(!o||o.nodeName=="DIV")break;n=o}}return $o(i,s-1,s).getBoundingClientRect().right>e}function c$(i,t,e){return gk(i,t,e)}function h$(i,t,e){if(t!=0)return gk(i,t,e);for(let n=i;;){let r=n.parentNode;if(!r||r.nodeType!=1||r.firstChild!=n)return!1;if(r.classList.contains("cm-line"))break;n=r}let s=i.nodeType==1?i.getBoundingClientRect():$o(i,0,Math.max(i.nodeValue.length,1)).getBoundingClientRect();return e-s.left>5}function zm(i,t,e){let s=i.lineBlockAt(t);if(Array.isArray(s.type)){let n;for(let r of s.type){if(r.from>t)break;if(!(r.to<t)){if(r.from<t&&r.to>t)return r;(!n||r.type==Ai.Text&&(n.type!=r.type||(e<0?r.from<t:r.to>t)))&&(n=r)}}return n||s}return s}function u$(i,t,e,s){let n=zm(i,t.head,t.assoc||-1),r=!s||n.type!=Ai.Text||!(i.lineWrapping||n.widgetLineBreaks)?null:i.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(r){let o=i.dom.getBoundingClientRect(),a=i.textDirectionAt(n.from),l=i.posAtCoords({x:e==(a==Oe.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(l!=null)return G.cursor(l,e?-1:1)}return G.cursor(e?n.to:n.from,e?-1:1)}function sv(i,t,e,s){let n=i.state.doc.lineAt(t.head),r=i.bidiSpans(n),o=i.textDirectionAt(n.from);for(let a=t,l=null;;){let c=UI(n,r,o,a,e),h=Kw;if(!c){if(n.number==(e?i.state.doc.lines:1))return a;h=`
`,n=i.state.doc.line(n.number+(e?1:-1)),r=i.bidiSpans(n),c=i.visualLineSide(n,!e)}if(l){if(!l(h))return a}else{if(!s)return c;l=s(h)}a=c}}function f$(i,t,e){let s=i.state.charCategorizer(t),n=s(e);return r=>{let o=s(r);return n==we.Space&&(n=o),n==o}}function d$(i,t,e,s){let n=t.head,r=e?1:-1;if(n==(e?i.state.doc.length:0))return G.cursor(n,t.assoc);let o=t.goalColumn,a,l=i.contentDOM.getBoundingClientRect(),c=i.coordsAtPos(n,t.assoc||-1),h=i.documentTop;if(c)o==null&&(o=c.left-l.left),a=r<0?c.top:c.bottom;else{let d=i.viewState.lineBlockAt(n);o==null&&(o=Math.min(l.right-l.left,i.defaultCharacterWidth*(n-d.from))),a=(r<0?d.top:d.bottom)+h}let u=l.left+o,f=s??i.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=a+(f+d)*r,g=pk(i,{x:u,y:p},!1,r);if(p<l.top||p>l.bottom||(r<0?g<n:g>n)){let m=i.docView.coordsForChar(g),O=!m||p<m.top?-1:1;return G.cursor(g,O,void 0,o)}}}function mc(i,t,e){for(;;){let s=0;for(let n of i)n.between(t-1,t+1,(r,o,a)=>{if(t>r&&t<o){let l=s||e||(t-r<o-t?-1:1);t=l<0?r:o,s=l}});if(!s)return t}}function mk(i,t){let e=null;for(let s=0;s<t.ranges.length;s++){let n=t.ranges[s],r=null;if(n.empty){let o=mc(i,n.from,0);o!=n.from&&(r=G.cursor(o,-1))}else{let o=mc(i,n.from,-1),a=mc(i,n.to,1);(o!=n.from||a!=n.to)&&(r=G.range(n.from==n.anchor?o:a,n.from==n.head?o:a))}r&&(e||(e=t.ranges.slice()),e[s]=r)}return e?G.create(e,t.mainIndex):t}function ig(i,t,e){let s=mc(i.state.facet(Sh).map(n=>n(i)),e.from,t.head>e.from?-1:1);return s==e.from?e:G.cursor(s,s<e.from?1:-1)}const Ul="";class p${constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Vt.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Ul}readRange(t,e){if(!t)return this;let s=t.parentNode;for(let n=t;;){this.findPointBefore(s,n);let r=this.text.length;this.readNode(n);let o=n.nextSibling;if(o==e)break;let a=te.get(n),l=te.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:Wf(n))||Wf(o)&&(n.nodeName!="BR"||n.cmIgnore)&&this.text.length>r)&&!m$(o,e)&&this.lineBreak(),n=o}return this.findPointBefore(s,e),this}readTextNode(t){let e=t.nodeValue;for(let s of this.points)s.node==t&&(s.pos=this.text.length+Math.min(s.offset,e.length));for(let s=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,a;if(this.lineSeparator?(r=e.indexOf(this.lineSeparator,s),o=this.lineSeparator.length):(a=n.exec(e))&&(r=a.index,o=a[0].length),this.append(e.slice(s,r<0?e.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==t&&l.pos>this.text.length&&(l.pos-=o-1);s=r+o}}readNode(t){if(t.cmIgnore)return;let e=te.get(t),s=e&&e.overrideDOMText;if(s!=null){this.findPointInside(t,s.length);for(let n=s.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let s of this.points)s.node==t&&t.childNodes[s.offset]==e&&(s.pos=this.text.length)}findPointInside(t,e){for(let s of this.points)(t.nodeType==3?s.node==t:t.contains(s.node))&&(s.pos=this.text.length+(g$(t,s.node,s.offset)?e:0))}}function g$(i,t,e){for(;;){if(!t||e<Sn(t))return!1;if(t==i)return!0;e=Io(t)+1,t=t.parentNode}}function m$(i,t){let e;for(;!(i==t||!i);i=i.nextSibling){let s=te.get(i);if(!(s?.isWidget||i.cmIgnore))return!1;s&&(e||(e=[])).push(s)}if(e)for(let s of e){let n=s.overrideDOMText;if(n?.length)return!1}return!0}class nv{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class O${constructor(t,e,s,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:r,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,s,0))){let a=r||o?[]:b$(t),l=new p$(a,t.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=v$(a,this.bounds.from)}else{let a=t.observer.selectionRange,l=r&&r.node==a.focusNode&&r.offset==a.focusOffset||!Dm(t.contentDOM,a.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(a.focusNode,a.focusOffset),c=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!Dm(t.contentDOM,a.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(a.anchorNode,a.anchorOffset),h=t.viewport;if((ut.ios||ut.chrome)&&t.state.selection.main.empty&&l!=c&&(h.from>0||h.to<t.state.doc.length)){let u=Math.min(l,c),f=Math.max(l,c),d=h.from-u,p=h.to-f;(d==0||d==1||u==0)&&(p==0||p==-1||f==t.state.doc.length)&&(l=0,c=t.state.doc.length)}this.newSel=G.single(c,l)}}}function Ok(i,t){let e,{newSel:s}=t,n=i.state.selection.main,r=i.inputState.lastKeyTime>Date.now()-100?i.inputState.lastKeyCode:-1;if(t.bounds){let{from:o,to:a}=t.bounds,l=n.from,c=null;(r===8||ut.android&&t.text.length<a-o)&&(l=n.to,c="end");let h=yk(i.state.doc.sliceString(o,a,Ul),t.text,l-o,c);h&&(ut.chrome&&r==13&&h.toB==h.from+2&&t.text.slice(h.from,h.toB)==Ul+Ul&&h.toB--,e={from:o+h.from,to:o+h.toA,insert:Wt.of(t.text.slice(h.from,h.toB).split(Ul))})}else s&&(!i.hasFocus&&i.state.facet(qn)||s.main.eq(n))&&(s=null);if(!e&&!s)return!1;if(!e&&t.typeOver&&!n.empty&&s&&s.main.empty?e={from:n.from,to:n.to,insert:i.state.doc.slice(n.from,n.to)}:(ut.mac||ut.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\. ?$/.test(e.insert.toString())&&i.contentDOM.getAttribute("autocorrect")=="off"?(s&&e.insert.length==2&&(s=G.single(s.main.anchor-1,s.main.head-1)),e={from:e.from,to:e.to,insert:Wt.of([e.insert.toString().replace("."," ")])}):e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:i.state.doc.slice(n.from,e.from).append(e.insert).append(i.state.doc.slice(e.to,n.to))}:ut.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`
 `&&i.lineWrapping&&(s&&(s=G.single(s.main.anchor-1,s.main.head-1)),e={from:n.from,to:n.to,insert:Wt.of([" "])}),e)return GO(i,e,s,r);if(s&&!s.main.eq(n)){let o=!1,a="select";return i.inputState.lastSelectionTime>Date.now()-50&&(i.inputState.lastSelectionOrigin=="select"&&(o=!0),a=i.inputState.lastSelectionOrigin,a=="select.pointer"&&(s=mk(i.state.facet(Sh).map(l=>l(i)),s))),i.dispatch({selection:s,scrollIntoView:o,userEvent:a}),!0}else return!1}function GO(i,t,e,s=-1){if(ut.ios&&i.inputState.flushIOSKey(t))return!0;let n=i.state.selection.main;if(ut.android&&(t.to==n.to&&(t.from==n.from||t.from==n.from-1&&i.state.sliceDoc(t.from,n.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&Pa(i.contentDOM,"Enter",13)||(t.from==n.from-1&&t.to==n.to&&t.insert.length==0||s==8&&t.insert.length<t.to-t.from&&t.to>n.head)&&Pa(i.contentDOM,"Backspace",8)||t.from==n.from&&t.to==n.to+1&&t.insert.length==0&&Pa(i.contentDOM,"Delete",46)))return!0;let r=t.insert.toString();i.inputState.composing>=0&&i.inputState.composing++;let o,a=()=>o||(o=y$(i,t,e));return i.state.facet(sk).some(l=>l(i,t.from,t.to,r,a))||i.dispatch(a()),!0}function y$(i,t,e){let s,n=i.state,r=n.selection.main,o=-1;if(t.from==t.to&&t.from<r.from||t.from>r.to){let l=t.from<r.from?-1:1,c=l<0?r.from:r.to,h=mc(n.facet(Sh).map(u=>u(i)),c,l);t.from==h&&(o=h)}if(o>-1)s={changes:t,selection:G.cursor(t.from+t.insert.length,-1)};else if(t.from>=r.from&&t.to<=r.to&&t.to-t.from>=(r.to-r.from)/3&&(!e||e.main.empty&&e.main.from==t.from+t.insert.length)&&i.inputState.composing<0){let l=r.from<t.from?n.sliceDoc(r.from,t.from):"",c=r.to>t.to?n.sliceDoc(t.to,r.to):"";s=n.replaceSelection(i.state.toText(l+t.insert.sliceString(0,void 0,i.state.lineBreak)+c))}else{let l=n.changes(t),c=e&&e.main.to<=l.newLength?e.main:void 0;if(n.selection.ranges.length>1&&i.inputState.composing>=0&&t.to<=r.to&&t.to>=r.to-10){let h=i.state.sliceDoc(t.from,t.to),u,f=e&&dk(i,e.main.head);if(f){let g=t.insert.length-(t.to-t.from);u={from:f.from,to:f.to-g}}else u=i.state.doc.lineAt(r.head);let d=r.to-t.to,p=r.to-r.from;s=n.changeByRange(g=>{if(g.from==r.from&&g.to==r.to)return{changes:l,range:c||g.map(l)};let m=g.to-d,O=m-h.length;if(g.to-g.from!=p||i.state.sliceDoc(O,m)!=h||g.to>=u.from&&g.from<=u.to)return{range:g};let b=n.changes({from:O,to:m,insert:t.insert}),x=g.to-r.to;return{changes:b,range:c?G.range(Math.max(0,c.anchor+x),Math.max(0,c.head+x)):g.map(b)}})}else s={changes:l,selection:c&&n.selection.replaceRange(c)}}let a="input.type";return(i.composing||i.inputState.compositionPendingChange&&i.inputState.compositionEndedAt>Date.now()-50)&&(i.inputState.compositionPendingChange=!1,a+=".compose",i.inputState.compositionFirstChange&&(a+=".start",i.inputState.compositionFirstChange=!1)),n.update(s,{userEvent:a,scrollIntoView:!0})}function yk(i,t,e,s){let n=Math.min(i.length,t.length),r=0;for(;r<n&&i.charCodeAt(r)==t.charCodeAt(r);)r++;if(r==n&&i.length==t.length)return null;let o=i.length,a=t.length;for(;o>0&&a>0&&i.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;if(s=="end"){let l=Math.max(0,r-Math.min(o,a));e-=o+l-r}if(o<r&&i.length<t.length){let l=e<=r&&e>=o?r-e:0;r-=l,a=r+(a-o),o=r}else if(a<r){let l=e<=r&&e>=a?r-e:0;r-=l,o=r+(o-a),a=r}return{from:r,toA:o,toB:a}}function b$(i){let t=[];if(i.root.activeElement!=i.contentDOM)return t;let{anchorNode:e,anchorOffset:s,focusNode:n,focusOffset:r}=i.observer.selectionRange;return e&&(t.push(new nv(e,s)),(n!=e||r!=s)&&t.push(new nv(n,r))),t}function v$(i,t){if(i.length==0)return null;let e=i[0].pos,s=i.length==2?i[1].pos:e;return e>-1&&s>-1?G.single(e+t,s+t):null}class _${setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,ut.safari&&t.contentDOM.addEventListener("input",()=>null),ut.gecko&&D$(t.contentDOM.ownerDocument)}handleEvent(t){!A$(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,e){let s=this.handlers[t];if(s){for(let n of s.observers)n(this.view,e);for(let n of s.handlers){if(e.defaultPrevented)break;if(n(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=x$(t),s=this.handlers,n=this.view.contentDOM;for(let r in e)if(r!="scroll"){let o=!e[r].handlers.length,a=s[r];a&&o!=!a.handlers.length&&(n.removeEventListener(r,this.handleEvent),a=null),a||n.addEventListener(r,this.handleEvent,{passive:o})}for(let r in s)r!="scroll"&&!e[r]&&n.removeEventListener(r,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&vk.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),ut.android&&ut.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return ut.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((e=bk.find(s=>s.keyCode==t.keyCode))&&!t.ctrlKey||S$.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=e||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let e=this.pendingIOSKey;return!e||e.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,Pa(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!/^key/.test(t.type)||t.synthetic?!1:this.composing>0?!0:ut.safari&&!ut.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function rv(i,t){return(e,s)=>{try{return t.call(i,s,e)}catch(n){qi(e.state,n)}}}function x$(i){let t=Object.create(null);function e(s){return t[s]||(t[s]={observers:[],handlers:[]})}for(let s of i){let n=s.spec,r=n&&n.plugin.domEventHandlers,o=n&&n.plugin.domEventObservers;if(r)for(let a in r){let l=r[a];l&&e(a).handlers.push(rv(s.value,l))}if(o)for(let a in o){let l=o[a];l&&e(a).observers.push(rv(s.value,l))}}for(let s in qs)e(s).handlers.push(qs[s]);for(let s in Cs)e(s).observers.push(Cs[s]);return t}const bk=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],S$="dthko",vk=[16,17,18,20,91,92,224,225],xu=6;function Su(i){return Math.max(0,i)*.7+8}function w$(i,t){return Math.max(Math.abs(i.clientX-t.clientX),Math.abs(i.clientY-t.clientY))}class k${constructor(t,e,s,n){this.view=t,this.startEvent=e,this.style=s,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=QI(t.contentDOM),this.atoms=t.state.facet(Sh).map(o=>o(t));let r=t.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Vt.allowMultipleSelections)&&C$(t,e),this.dragging=P$(t,e)&&Sk(e)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&w$(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let e=0,s=0,n=0,r=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:n,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=jO(this.view);t.clientX-l.left<=n+xu?e=-Su(n-t.clientX):t.clientX+l.right>=o-xu&&(e=Su(t.clientX-o)),t.clientY-l.top<=r+xu?s=-Su(r-t.clientY):t.clientY+l.bottom>=a-xu&&(s=Su(t.clientY-a)),this.setScrollSpeed(e,s)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),this.dragging===!1&&this.select(this.lastEvent)}select(t){let{view:e}=this,s=mk(this.atoms,this.style.get(t,this.extend,this.multiple));(this.mustSelect||!s.eq(e.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(e=>e.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function C$(i,t){let e=i.state.facet(Jw);return e.length?e[0](t):ut.mac?t.metaKey:t.ctrlKey}function T$(i,t){let e=i.state.facet(tk);return e.length?e[0](t):ut.mac?!t.altKey:!t.ctrlKey}function P$(i,t){let{main:e}=i.state.selection;if(e.empty)return!1;let s=Nc(i.root);if(!s||s.rangeCount==0)return!0;let n=s.getRangeAt(0).getClientRects();for(let r=0;r<n.length;r++){let o=n[r];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return!0}return!1}function A$(i,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,s;e!=i.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(s=te.get(e))&&s.ignoreEvent(t))return!1;return!0}const qs=Object.create(null),Cs=Object.create(null),_k=ut.ie&&ut.ie_version<15||ut.ios&&ut.webkit_version<604;function M$(i){let t=i.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{i.focus(),e.remove(),xk(i,e.value)},50)}function rp(i,t,e){for(let s of i.facet(t))e=s(e,i);return e}function xk(i,t){t=rp(i.state,qO,t);let{state:e}=i,s,n=1,r=e.toText(t),o=r.lines==e.selection.ranges.length;if(jm!=null&&e.selection.ranges.every(l=>l.empty)&&jm==r.toString()){let l=-1;s=e.changeByRange(c=>{let h=e.doc.lineAt(c.from);if(h.from==l)return{range:c};l=h.from;let u=e.toText((o?r.line(n++).text:t)+e.lineBreak);return{changes:{from:h.from,insert:u},range:G.cursor(c.from+u.length)}})}else o?s=e.changeByRange(l=>{let c=r.line(n++);return{changes:{from:l.from,to:l.to,insert:c.text},range:G.cursor(l.from+c.length)}}):s=e.replaceSelection(r);i.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}Cs.scroll=i=>{i.inputState.lastScrollTop=i.scrollDOM.scrollTop,i.inputState.lastScrollLeft=i.scrollDOM.scrollLeft};qs.keydown=(i,t)=>(i.inputState.setSelectionOrigin("select"),t.keyCode==27&&i.inputState.tabFocusMode!=0&&(i.inputState.tabFocusMode=Date.now()+2e3),!1);Cs.touchstart=(i,t)=>{i.inputState.lastTouchTime=Date.now(),i.inputState.setSelectionOrigin("select.pointer")};Cs.touchmove=i=>{i.inputState.setSelectionOrigin("select.pointer")};qs.mousedown=(i,t)=>{if(i.observer.flush(),i.inputState.lastTouchTime>Date.now()-2e3)return!1;let e=null;for(let s of i.state.facet(ek))if(e=s(i,t),e)break;if(!e&&t.button==0&&(e=Q$(i,t)),e){let s=!i.hasFocus;i.inputState.startMouseSelection(new k$(i,t,e,s)),s&&i.observer.ignore(()=>{Nw(i.contentDOM);let r=i.root.activeElement;r&&!r.contains(i.contentDOM)&&r.blur()});let n=i.inputState.mouseSelection;if(n)return n.start(t),n.dragging===!1}else i.inputState.setSelectionOrigin("select.pointer");return!1};function ov(i,t,e,s){if(s==1)return G.cursor(t,e);if(s==2)return o$(i.state,t,e);{let n=Qe.find(i.docView,t),r=i.state.doc.lineAt(n?n.posAtEnd:t),o=n?n.posAtStart:r.from,a=n?n.posAtEnd:r.to;return a<i.state.doc.length&&a==r.to&&a++,G.range(o,a)}}let av=(i,t,e)=>t>=e.top&&t<=e.bottom&&i>=e.left&&i<=e.right;function E$(i,t,e,s){let n=Qe.find(i.docView,t);if(!n)return 1;let r=t-n.posAtStart;if(r==0)return 1;if(r==n.length)return-1;let o=n.coordsAt(r,-1);if(o&&av(e,s,o))return-1;let a=n.coordsAt(r,1);return a&&av(e,s,a)?1:o&&o.bottom>=s?-1:1}function lv(i,t){let e=i.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:E$(i,e,t.clientX,t.clientY)}}const R$=ut.ie&&ut.ie_version<=11;let cv=null,hv=0,uv=0;function Sk(i){if(!R$)return i.detail;let t=cv,e=uv;return cv=i,uv=Date.now(),hv=!t||e>Date.now()-400&&Math.abs(t.clientX-i.clientX)<2&&Math.abs(t.clientY-i.clientY)<2?(hv+1)%3:1}function Q$(i,t){let e=lv(i,t),s=Sk(t),n=i.state.selection;return{update(r){r.docChanged&&(e.pos=r.changes.mapPos(e.pos),n=n.map(r.changes))},get(r,o,a){let l=lv(i,r),c,h=ov(i,l.pos,l.bias,s);if(e.pos!=l.pos&&!o){let u=ov(i,e.pos,e.bias,s),f=Math.min(u.from,h.from),d=Math.max(u.to,h.to);h=f<h.from?G.range(f,d):G.range(d,f)}return o?n.replaceRange(n.main.extend(h.from,h.to)):a&&s==1&&n.ranges.length>1&&(c=I$(n,l.pos))?c:a?n.addRange(h):G.create([h])}}}function I$(i,t){for(let e=0;e<i.ranges.length;e++){let{from:s,to:n}=i.ranges[e];if(s<=t&&n>=t)return G.create(i.ranges.slice(0,e).concat(i.ranges.slice(e+1)),i.mainIndex==e?0:i.mainIndex-(i.mainIndex>e?1:0))}return null}qs.dragstart=(i,t)=>{let{selection:{main:e}}=i.state;if(t.target.draggable){let n=i.docView.nearest(t.target);if(n&&n.isWidget){let r=n.posAtStart,o=r+n.length;(r>=e.to||o<=e.from)&&(e=G.range(r,o))}}let{inputState:s}=i;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=e,t.dataTransfer&&(t.dataTransfer.setData("Text",rp(i.state,XO,i.state.sliceDoc(e.from,e.to))),t.dataTransfer.effectAllowed="copyMove"),!1};qs.dragend=i=>(i.inputState.draggedContent=null,!1);function fv(i,t,e,s){if(e=rp(i.state,qO,e),!e)return;let n=i.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:r}=i.inputState,o=s&&r&&T$(i,t)?{from:r.from,to:r.to}:null,a={from:n,insert:e},l=i.state.changes(o?[o,a]:a);i.focus(),i.dispatch({changes:l,selection:{anchor:l.mapPos(n,-1),head:l.mapPos(n,1)},userEvent:o?"move.drop":"input.drop"}),i.inputState.draggedContent=null}qs.drop=(i,t)=>{if(!t.dataTransfer)return!1;if(i.state.readOnly)return!0;let e=t.dataTransfer.files;if(e&&e.length){let s=Array(e.length),n=0,r=()=>{++n==e.length&&fv(i,t,s.filter(o=>o!=null).join(i.state.lineBreak),!1)};for(let o=0;o<e.length;o++){let a=new FileReader;a.onerror=r,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(s[o]=a.result),r()},a.readAsText(e[o])}return!0}else{let s=t.dataTransfer.getData("Text");if(s)return fv(i,t,s,!0),!0}return!1};qs.paste=(i,t)=>{if(i.state.readOnly)return!0;i.observer.flush();let e=_k?null:t.clipboardData;return e?(xk(i,e.getData("text/plain")||e.getData("text/uri-list")),!0):(M$(i),!1)};function $$(i,t){let e=i.dom.parentNode;if(!e)return;let s=e.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=t,s.focus(),s.selectionEnd=t.length,s.selectionStart=0,setTimeout(()=>{s.remove(),i.focus()},50)}function N$(i){let t=[],e=[],s=!1;for(let n of i.selection.ranges)n.empty||(t.push(i.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:r}of i.selection.ranges){let o=i.doc.lineAt(r);o.number>n&&(t.push(o.text),e.push({from:o.from,to:Math.min(i.doc.length,o.to+1)})),n=o.number}s=!0}return{text:rp(i,XO,t.join(i.lineBreak)),ranges:e,linewise:s}}let jm=null;qs.copy=qs.cut=(i,t)=>{let{text:e,ranges:s,linewise:n}=N$(i.state);if(!e&&!n)return!1;jm=n?e:null,t.type=="cut"&&!i.state.readOnly&&i.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let r=_k?null:t.clipboardData;return r?(r.clearData(),r.setData("text/plain",e),!0):($$(i,e),!1)};const wk=fr.define();function kk(i,t){let e=[];for(let s of i.facet(nk)){let n=s(i,t);n&&e.push(n)}return e.length?i.update({effects:e,annotations:wk.of(!0)}):null}function Ck(i){setTimeout(()=>{let t=i.hasFocus;if(t!=i.inputState.notifiedFocused){let e=kk(i.state,t);e?i.dispatch(e):i.update([])}},10)}Cs.focus=i=>{i.inputState.lastFocusTime=Date.now(),!i.scrollDOM.scrollTop&&(i.inputState.lastScrollTop||i.inputState.lastScrollLeft)&&(i.scrollDOM.scrollTop=i.inputState.lastScrollTop,i.scrollDOM.scrollLeft=i.inputState.lastScrollLeft),Ck(i)};Cs.blur=i=>{i.observer.clearSelectionRange(),Ck(i)};Cs.compositionstart=Cs.compositionupdate=i=>{i.observer.editContext||(i.inputState.compositionFirstChange==null&&(i.inputState.compositionFirstChange=!0),i.inputState.composing<0&&(i.inputState.composing=0))};Cs.compositionend=i=>{i.observer.editContext||(i.inputState.composing=-1,i.inputState.compositionEndedAt=Date.now(),i.inputState.compositionPendingKey=!0,i.inputState.compositionPendingChange=i.observer.pendingRecords().length>0,i.inputState.compositionFirstChange=null,ut.chrome&&ut.android?i.observer.flushSoon():i.inputState.compositionPendingChange?Promise.resolve().then(()=>i.observer.flush()):setTimeout(()=>{i.inputState.composing<0&&i.docView.hasComposition&&i.update([])},50))};Cs.contextmenu=i=>{i.inputState.lastContextMenu=Date.now()};qs.beforeinput=(i,t)=>{var e,s;if(t.inputType=="insertReplacementText"&&i.observer.editContext){let r=(e=t.dataTransfer)===null||e===void 0?void 0:e.getData("text/plain"),o=t.getTargetRanges();if(r&&o.length){let a=o[0],l=i.posAtDOM(a.startContainer,a.startOffset),c=i.posAtDOM(a.endContainer,a.endOffset);return GO(i,{from:l,to:c,insert:i.state.toText(r)},null),!0}}let n;if(ut.chrome&&ut.android&&(n=bk.find(r=>r.inputType==t.inputType))&&(i.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&i.hasFocus&&(i.contentDOM.blur(),i.focus())},100)}return ut.ios&&t.inputType=="deleteContentForward"&&i.observer.flushSoon(),ut.safari&&t.inputType=="insertText"&&i.inputState.composing>=0&&setTimeout(()=>Cs.compositionend(i,t),20),!1};const dv=new Set;function D$(i){dv.has(i)||(dv.add(i),i.addEventListener("copy",()=>{}),i.addEventListener("cut",()=>{}))}const pv=["pre-wrap","normal","pre-line","break-spaces"];let za=!1;function gv(){za=!1}class L${constructor(t){this.lineWrapping=t,this.doc=Wt.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let s=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((e-t-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return pv.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let s=0;s<t.length;s++){let n=t[s];n<0?s++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,s,n,r,o){let a=pv.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=e,this.charWidth=s,this.textHeight=n,this.lineLength=r,l){this.heightSamples={};for(let c=0;c<o.length;c++){let h=o[c];h<0?c++:this.heightSamples[Math.floor(h*10)]=!0}}return l}}class V${constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class fn{constructor(t,e,s,n,r){this.from=t,this.length=e,this.top=s,this.height=n,this._content=r}get type(){return typeof this._content=="number"?Ai.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Gr?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new fn(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var ge=(function(i){return i[i.ByPos=0]="ByPos",i[i.ByHeight=1]="ByHeight",i[i.ByPosNoHeight=2]="ByPosNoHeight",i})(ge||(ge={}));const ef=.001;class Mi{constructor(t,e,s=2){this.length=t,this.height=e,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>ef&&(za=!0),this.height=t)}replace(t,e,s){return Mi.of(s)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,s,n){let r=this,o=s.doc;for(let a=n.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:h,toB:u}=n[a],f=r.lineAt(l,ge.ByPosNoHeight,s.setDoc(e),0,0),d=f.to>=c?f:r.lineAt(c,ge.ByPosNoHeight,s,0,0);for(u+=d.to-c,c=d.to;a>0&&f.from<=n[a-1].toA;)l=n[a-1].fromA,h=n[a-1].fromB,a--,l<f.from&&(f=r.lineAt(l,ge.ByPosNoHeight,s,0,0));h+=f.from-l,l=f.from;let p=YO.build(s.setDoc(o),t,h,u);r=zf(r,r.replace(l,c,p))}return r.updateHeight(s,0)}static empty(){return new ss(0,0)}static of(t){if(t.length==1)return t[0];let e=0,s=t.length,n=0,r=0;for(;;)if(e==s)if(n>r*2){let a=t[e-1];a.break?t.splice(--e,1,a.left,null,a.right):t.splice(--e,1,a.left,a.right),s+=1+a.break,n-=a.size}else if(r>n*2){let a=t[s];a.break?t.splice(s,1,a.left,null,a.right):t.splice(s,1,a.left,a.right),s+=2+a.break,r-=a.size}else break;else if(n<r){let a=t[e++];a&&(n+=a.size)}else{let a=t[--s];a&&(r+=a.size)}let o=0;return t[e-1]==null?(o=1,e--):t[e]==null&&(o=1,s++),new B$(Mi.of(t.slice(0,e)),o,Mi.of(t.slice(s)))}}function zf(i,t){return i==t?i:(i.constructor!=t.constructor&&(za=!0),t)}Mi.prototype.size=1;class Tk extends Mi{constructor(t,e,s){super(t,e),this.deco=s}blockAt(t,e,s,n){return new fn(n,this.length,s,this.height,this.deco||0)}lineAt(t,e,s,n,r){return this.blockAt(0,s,n,r)}forEachLine(t,e,s,n,r,o){t<=r+this.length&&e>=r&&o(this.blockAt(0,s,n,r))}updateHeight(t,e=0,s=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ss extends Tk{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,s,n){return new fn(n,this.length,s,this.height,this.breaks)}replace(t,e,s){let n=s[0];return s.length==1&&(n instanceof ss||n instanceof ti&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof ti?n=new ss(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):Mi.of(s)}updateHeight(t,e=0,s=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(s||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ti extends Mi{constructor(t){super(t,0)}heightMetrics(t,e){let s=t.doc.lineAt(e).number,n=t.doc.lineAt(e+this.length).number,r=n-s+1,o,a=0;if(t.lineWrapping){let l=Math.min(this.height,t.lineHeight*r);o=l/r,this.length>r+1&&(a=(this.height-l)/(this.length-r-1))}else o=this.height/r;return{firstLine:s,lastLine:n,perLine:o,perChar:a}}blockAt(t,e,s,n){let{firstLine:r,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let c=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-s)/this.height))*this.length)),h=e.doc.lineAt(c),u=a+h.length*l,f=Math.max(s,t-u/2);return new fn(h.from,h.length,f,u,0)}else{let c=Math.max(0,Math.min(o-r,Math.floor((t-s)/a))),{from:h,length:u}=e.doc.line(r+c);return new fn(h,u,s+a*c,a,0)}}lineAt(t,e,s,n,r){if(e==ge.ByHeight)return this.blockAt(t,s,n,r);if(e==ge.ByPosNoHeight){let{from:d,to:p}=s.doc.lineAt(t);return new fn(d,p-d,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(s,r),c=s.doc.lineAt(t),h=a+c.length*l,u=c.number-o,f=n+a*u+l*(c.from-r-u);return new fn(c.from,c.length,Math.max(n,Math.min(f,n+this.height-h)),h,0)}forEachLine(t,e,s,n,r,o){t=Math.max(t,r),e=Math.min(e,r+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(s,r);for(let h=t,u=n;h<=e;){let f=s.doc.lineAt(h);if(h==t){let p=f.number-a;u+=l*p+c*(t-r-p)}let d=l+c*f.length;o(new fn(f.from,f.length,u,d,0)),u+=d,h=f.to+1}}replace(t,e,s){let n=this.length-e;if(n>0){let r=s[s.length-1];r instanceof ti?s[s.length-1]=new ti(r.length+n):s.push(null,new ti(n-1))}if(t>0){let r=s[0];r instanceof ti?s[0]=new ti(t+r.length):s.unshift(new ti(t-1),null)}return Mi.of(s)}decomposeLeft(t,e){e.push(new ti(t-1),null)}decomposeRight(t,e){e.push(null,new ti(this.length-t-1))}updateHeight(t,e=0,s=!1,n){let r=e+this.length;if(n&&n.from<=e+this.length&&n.more){let o=[],a=Math.max(e,n.from),l=-1;for(n.from>e&&o.push(new ti(n.from-e-1).updateHeight(t,e));a<=r&&n.more;){let h=t.doc.lineAt(a).length;o.length&&o.push(null);let u=n.heights[n.index++];l==-1?l=u:Math.abs(u-l)>=ef&&(l=-2);let f=new ss(h,u);f.outdated=!1,o.push(f),a+=h+1}a<=r&&o.push(null,new ti(r-a).updateHeight(t,a));let c=Mi.of(o);return(l<0||Math.abs(c.height-this.height)>=ef||Math.abs(l-this.heightMetrics(t,e).perLine)>=ef)&&(za=!0),zf(this,c)}else(s||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class B$ extends Mi{constructor(t,e,s){super(t.length+e+s.length,t.height+s.height,e|(t.outdated||s.outdated?2:0)),this.left=t,this.right=s,this.size=t.size+s.size}get break(){return this.flags&1}blockAt(t,e,s,n){let r=s+this.left.height;return t<r?this.left.blockAt(t,e,s,n):this.right.blockAt(t,e,r,n+this.left.length+this.break)}lineAt(t,e,s,n,r){let o=n+this.left.height,a=r+this.left.length+this.break,l=e==ge.ByHeight?t<o:t<a,c=l?this.left.lineAt(t,e,s,n,r):this.right.lineAt(t,e,s,o,a);if(this.break||(l?c.to<a:c.from>a))return c;let h=e==ge.ByPosNoHeight?ge.ByPosNoHeight:ge.ByPos;return l?c.join(this.right.lineAt(a,h,s,o,a)):this.left.lineAt(a,h,s,n,r).join(c)}forEachLine(t,e,s,n,r,o){let a=n+this.left.height,l=r+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,s,n,r,o),e>=l&&this.right.forEachLine(t,e,s,a,l,o);else{let c=this.lineAt(l,ge.ByPos,s,n,r);t<c.from&&this.left.forEachLine(t,c.from-1,s,n,r,o),c.to>=t&&c.from<=e&&o(c),e>c.to&&this.right.forEachLine(c.to+1,e,s,a,l,o)}}replace(t,e,s){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,s),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,s));let r=[];t>0&&this.decomposeLeft(t,r);let o=r.length;for(let a of s)r.push(a);if(t>0&&mv(r,o-1),e<this.length){let a=r.length;this.decomposeRight(e,r),mv(r,a)}return Mi.of(r)}decomposeLeft(t,e){let s=this.left.length;if(t<=s)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(s++,t>=s&&e.push(null)),t>s&&this.right.decomposeLeft(t-s,e)}decomposeRight(t,e){let s=this.left.length,n=s+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<s&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?Mi.of(this.break?[t,null,e]:[t,e]):(this.left=zf(this.left,t),this.right=zf(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,s=!1,n){let{left:r,right:o}=this,a=e+r.length+this.break,l=null;return n&&n.from<=e+r.length&&n.more?l=r=r.updateHeight(t,e,s,n):r.updateHeight(t,e,s),n&&n.from<=a+o.length&&n.more?l=o=o.updateHeight(t,a,s,n):o.updateHeight(t,a,s),l?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mv(i,t){let e,s;i[t]==null&&(e=i[t-1])instanceof ti&&(s=i[t+1])instanceof ti&&i.splice(t-1,3,new ti(e.length+1+s.length))}const Z$=5;class YO{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let s=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof ss?n.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new ss(s-this.pos,-1)),this.writtenTo=s,e>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,s){if(t<e||s.heightRelevant){let n=s.widget?s.widget.estimatedHeight:0,r=s.widget?s.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;s.block?this.addBlock(new Tk(o,n,s)):(o||r||n>=Z$)&&this.addLineDeco(n,r,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new ss(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let s=new ti(e-t);return this.oracle.doc.lineAt(t).to==e&&(s.flags|=4),s}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof ss)return t;let e=new ss(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,s){let n=this.ensureLine();n.length+=s,n.collapsed+=s,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+s}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof ss)&&!this.isCovered?this.nodes.push(new ss(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=t;for(let n of this.nodes)n instanceof ss&&n.updateHeight(this.oracle,s),s+=n?n.length:1;return this.nodes}static build(t,e,s,n){let r=new YO(s,t);return zt.spans(e,s,n,r,0),r.finish(s)}}function F$(i,t,e){let s=new W$;return zt.compare(i,t,e,s,0),s.changes}class W${constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,s,n){(t<e||s&&s.heightRelevant||n&&n.heightRelevant)&&tf(t,e,this.changes,5)}}function q$(i,t){let e=i.getBoundingClientRect(),s=i.ownerDocument,n=s.defaultView||window,r=Math.max(0,e.left),o=Math.min(n.innerWidth,e.right),a=Math.max(0,e.top),l=Math.min(n.innerHeight,e.bottom);for(let c=i.parentNode;c&&c!=s.body;)if(c.nodeType==1){let h=c,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let f=h.getBoundingClientRect();r=Math.max(r,f.left),o=Math.min(o,f.right),a=Math.max(a,f.top),l=Math.min(c==i.parentNode?n.innerHeight:l,f.bottom)}c=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:r-e.left,right:Math.max(r,o)-e.left,top:a-(e.top+t),bottom:Math.max(a,l)-(e.top+t)}}function X$(i){let t=i.getBoundingClientRect(),e=i.ownerDocument.defaultView||window;return t.left<e.innerWidth&&t.right>0&&t.top<e.innerHeight&&t.bottom>0}function z$(i,t){let e=i.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class sg{constructor(t,e,s,n){this.from=t,this.to=e,this.size=s,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let s=0;s<t.length;s++){let n=t[s],r=e[s];if(n.from!=r.from||n.to!=r.to||n.size!=r.size)return!1}return!0}draw(t,e){return vt.replace({widget:new j$(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class j$ extends Mn{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Ov{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=yv,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Oe.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(zO).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new L$(e),this.stateDeco=t.facet(Dc).filter(s=>typeof s!="function"),this.heightMap=Mi.empty().applyChanges(this.stateDeco,Wt.empty,this.heightOracle.setDoc(t.doc),[new ks(0,0,0,t.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=vt.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let s=0;s<=1;s++){let n=s?e.head:e.anchor;if(!t.some(({from:r,to:o})=>n>=r&&n<=o)){let{from:r,to:o}=this.lineBlockAt(n);t.push(new wu(r,o))}}return this.viewports=t.sort((s,n)=>s.from-n.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?yv:new UO(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push(Hl(t,this.scaler))})}update(t,e=null){this.state=t.state;let s=this.stateDeco;this.stateDeco=this.state.facet(Dc).filter(h=>typeof h!="function");let n=t.changedRanges,r=ks.extendWithRanges(n,F$(s,this.stateDeco,t?t.changes:Xe.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);gv(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||za)&&(t.flags|=2),a?(this.scrollAnchorPos=t.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=r.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(c||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(ok)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,s=window.getComputedStyle(e),n=this.heightOracle,r=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?Oe.RTL:Oe.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),a=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,h=0;if(a.width&&a.height){let{scaleX:v,scaleY:y}=$w(e,a);(v>.005&&Math.abs(this.scaleX-v)>.005||y>.005&&Math.abs(this.scaleY-y)>.005)&&(this.scaleX=v,this.scaleY=y,c|=16,o=l=!0)}let u=(parseInt(s.paddingTop)||0)*this.scaleY,f=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=u||this.paddingBottom!=f)&&(this.paddingTop=u,this.paddingBottom=f,c|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,c|=16);let d=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=Lw(t.scrollDOM);let p=(this.printing?z$:q$)(e,this.paddingTop),g=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let O=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(O!=this.inView&&(this.inView=O,O&&(l=!0)),!this.inView&&!this.scrollTarget&&!X$(t.dom))return 0;let b=a.width;if((this.contentDOMWidth!=b||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=t.scrollDOM.clientHeight,c|=16),l){let v=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(v)&&(o=!0),o||n.lineWrapping&&Math.abs(b-this.contentDOMWidth)>n.charWidth){let{lineHeight:y,charWidth:_,textHeight:S}=t.docView.measureTextSize();o=y>0&&n.refresh(r,y,_,S,Math.max(5,b/_),v),o&&(t.docView.minWidth=0,c|=16)}g>0&&m>0?h=Math.max(g,m):g<0&&m<0&&(h=Math.min(g,m)),gv();for(let y of this.viewports){let _=y.from==this.viewport.from?v:t.docView.measureVisibleLineHeights(y);this.heightMap=(o?Mi.empty().applyChanges(this.stateDeco,Wt.empty,this.heightOracle,[new ks(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new V$(y.from,_))}za&&(c|=2)}let x=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return x&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),c|=this.updateForViewport()),(c&2||x)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let s=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new wu(n.lineAt(o-s*1e3,ge.ByHeight,r,0,0).from,n.lineAt(a+(1-s)*1e3,ge.ByHeight,r,0,0).to);if(e){let{head:c}=e.range;if(c<l.from||c>l.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=n.lineAt(c,ge.ByPos,r,0,0),f;e.y=="center"?f=(u.top+u.bottom)/2-h/2:e.y=="start"||e.y=="nearest"&&c<l.from?f=u.top:f=u.bottom-h,l=new wu(n.lineAt(f-1e3/2,ge.ByHeight,r,0,0).from,n.lineAt(f+h+1e3/2,ge.ByHeight,r,0,0).to)}}return l}mapViewport(t,e){let s=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new wu(this.heightMap.lineAt(s,ge.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,ge.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},s=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,ge.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(e,ge.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(t==0||n<=o-Math.max(10,Math.min(-s,250)))&&(e==this.state.doc.length||r>=a+Math.max(10,Math.min(s,250)))&&n>o-2*1e3&&r<a+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let s=[];for(let n of t)e.touchesRange(n.from,n.to)||s.push(new sg(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return s}ensureLineGaps(t,e){let s=this.heightOracle.lineWrapping,n=s?1e4:2e3,r=n>>1,o=n<<1;if(this.defaultTextDirection!=Oe.LTR&&!s)return[];let a=[],l=(h,u,f,d)=>{if(u-h<r)return;let p=this.state.selection.main,g=[p.from];p.empty||g.push(p.to);for(let O of g)if(O>h&&O<u){l(h,O-10,f,d),l(O+10,u,f,d);return}let m=Y$(t,O=>O.from>=f.from&&O.to<=f.to&&Math.abs(O.from-h)<r&&Math.abs(O.to-u)<r&&!g.some(b=>O.from<b&&O.to>b));if(!m){if(u<f.to&&e&&s&&e.visibleRanges.some(x=>x.from<=u&&x.to>=u)){let x=e.moveToLineBoundary(G.cursor(u),!1,!0).head;x>h&&(u=x)}let O=this.gapSize(f,h,u,d),b=s||O<2e6?O:2e6;m=new sg(h,u,O,b)}a.push(m)},c=h=>{if(h.length<o||h.type!=Ai.Text)return;let u=G$(h.from,h.to,this.stateDeco);if(u.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(s){let g=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,O;if(f!=null){let b=Cu(u,f),x=((this.visibleBottom-this.visibleTop)/2+g)/h.height;m=b-x,O=b+x}else m=(this.visibleTop-h.top-g)/h.height,O=(this.visibleBottom-h.top+g)/h.height;d=ku(u,m),p=ku(u,O)}else{let g=u.total*this.heightOracle.charWidth,m=n*this.heightOracle.charWidth,O=0;if(g>2e6)for(let _ of t)_.from>=h.from&&_.from<h.to&&_.size!=_.displaySize&&_.from*this.heightOracle.charWidth+O<this.pixelViewport.left&&(O=_.size-_.displaySize);let b=this.pixelViewport.left+O,x=this.pixelViewport.right+O,v,y;if(f!=null){let _=Cu(u,f),S=((x-b)/2+m)/g;v=_-S,y=_+S}else v=(b-m)/g,y=(x+m)/g;d=ku(u,v),p=ku(u,y)}d>h.from&&l(h.from,d,h,u),p<h.to&&l(p,h.to,h,u)};for(let h of this.viewportLines)Array.isArray(h.type)?h.type.forEach(c):c(h);return a}gapSize(t,e,s,n){let r=Cu(n,s)-Cu(n,e);return this.heightOracle.lineWrapping?t.height*r:n.total*this.heightOracle.charWidth*r}updateLineGaps(t){sg.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=vt.set(t.map(e=>e.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let s=[];zt.spans(e,this.viewport.from,this.viewport.to,{span(r,o){s.push({from:r,to:o})},point(){}},20);let n=0;if(s.length!=this.visibleRanges.length)n=12;else for(let r=0;r<s.length&&!(n&8);r++){let o=this.visibleRanges[r],a=s[r];(o.from!=a.from||o.to!=a.to)&&(n|=4,t&&t.mapPos(o.from,-1)==a.from&&t.mapPos(o.to,1)==a.to||(n|=8))}return this.visibleRanges=s,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||Hl(this.heightMap.lineAt(t,ge.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(e=>e.top<=t&&e.bottom>=t)||Hl(this.heightMap.lineAt(this.scaler.fromDOM(t),ge.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Hl(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class wu{constructor(t,e){this.from=t,this.to=e}}function G$(i,t,e){let s=[],n=i,r=0;return zt.spans(e,i,t,{span(){},point(o,a){o>n&&(s.push({from:n,to:o}),r+=o-n),n=a}},20),n<t&&(s.push({from:n,to:t}),r+=t-n),{total:r,ranges:s}}function ku({total:i,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let s=Math.floor(i*e);for(let n=0;;n++){let{from:r,to:o}=t[n],a=o-r;if(s<=a)return r+s;s-=a}}function Cu(i,t){let e=0;for(let{from:s,to:n}of i.ranges){if(t<=n){e+=t-s;break}e+=n-s}return e/i.total}function Y$(i,t){for(let e of i)if(t(e))return e}const yv={toDOM(i){return i},fromDOM(i){return i},scale:1,eq(i){return i==this}};class UO{constructor(t,e,s){let n=0,r=0,o=0;this.viewports=s.map(({from:a,to:l})=>{let c=e.lineAt(a,ge.ByPos,t,0,0).top,h=e.lineAt(l,ge.ByPos,t,0,0).bottom;return n+=h-c,{from:a,to:l,top:c,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let a of this.viewports)a.domTop=o+(a.top-r)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),r=a.bottom}toDOM(t){for(let e=0,s=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.top)return n+(t-s)*this.scale;if(t<=r.bottom)return r.domTop+(t-r.top);s=r.bottom,n=r.domBottom}}fromDOM(t){for(let e=0,s=0,n=0;;e++){let r=e<this.viewports.length?this.viewports[e]:null;if(!r||t<r.domTop)return s+(t-n)/this.scale;if(t<=r.domBottom)return r.top+(t-r.domTop);s=r.bottom,n=r.domBottom}}eq(t){return t instanceof UO?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((e,s)=>e.from==t.viewports[s].from&&e.to==t.viewports[s].to):!1}}function Hl(i,t){if(t.scale==1)return i;let e=t.toDOM(i.top),s=t.toDOM(i.bottom);return new fn(i.from,i.length,e,s-e,Array.isArray(i._content)?i._content.map(n=>Hl(n,t)):i._content)}const Tu=ft.define({combine:i=>i.join(" ")}),Gm=ft.define({combine:i=>i.indexOf(!0)>-1}),Ym=zr.newName(),Pk=zr.newName(),Ak=zr.newName(),Mk={"&light":"."+Pk,"&dark":"."+Ak};function Um(i,t,e){return new zr(t,{finish(s){return/&/.test(s)?s.replace(/&\w*/,n=>{if(n=="&")return i;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):i+" "+s}})}const U$=Um("."+Ym,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Mk),H$={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ng=ut.ie&&ut.ie_version<=11;class K${constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new II,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let s of e)this.queue.push(s);(ut.ie&&ut.ie_version<=11||ut.ios&&t.composing)&&e.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&ut.android&&t.constructor.EDIT_CONTEXT!==!1&&!(ut.chrome&&ut.chrome_version<126)&&(this.editContext=new tN(t),t.state.facet(qn)&&(t.contentDOM.editContext=this.editContext.editContext)),ng&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,s)=>e!=t[s]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,n=this.selectionRange;if(s.state.facet(qn)?s.root.activeElement!=this.dom:!Ju(this.dom,n))return;let r=n.anchorNode&&s.docView.nearest(n.anchorNode);if(r&&r.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(ut.ie&&ut.ie_version<=11||ut.android&&ut.chrome)&&!s.state.selection.main.empty&&n.focusNode&&pc(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Nc(t.root);if(!e)return!1;let s=ut.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&J$(this.view,e)||e;if(!s||this.selectionRange.eq(s))return!1;let n=Ju(this.dom,s);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&NI(this.dom,s)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(s),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let s=this.dom;s;)if(s.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==s?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=e)s.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,H$),ng&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ng&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var s;if(!this.delayedAndroidKey){let n=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&Pa(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,s=-1,n=!1;for(let r of t){let o=this.readMutation(r);o&&(o.typeOver&&(n=!0),e==-1?{from:e,to:s}=o:(e=Math.min(o.from,e),s=Math.max(o.to,s)))}return{from:e,to:s,typeOver:n}}readChange(){let{from:t,to:e,typeOver:s}=this.processRecords(),n=this.selectionChanged&&Ju(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new O$(this.view,t,e,s);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let s=this.view.state,n=Ok(this.view,e);return this.view.state==s&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.flags|=4),t.type=="childList"){let s=bv(e,t.previousSibling||t.target.previousSibling,-1),n=bv(e,t.nextSibling||t.target.nextSibling,1);return{from:s?e.posAfter(s):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(qn)!=t.state.facet(qn)&&(t.view.contentDOM.editContext=t.state.facet(qn)?this.editContext.editContext:null))}destroy(){var t,e,s;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function bv(i,t,e){for(;t;){let s=te.get(t);if(s&&s.parent==i)return s;let n=t.parentNode;t=n!=i.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function vv(i,t){let e=t.startContainer,s=t.startOffset,n=t.endContainer,r=t.endOffset,o=i.docView.domAtPos(i.state.selection.main.anchor);return pc(o.node,o.offset,n,r)&&([e,s,n,r]=[n,r,e,s]),{anchorNode:e,anchorOffset:s,focusNode:n,focusOffset:r}}function J$(i,t){if(t.getComposedRanges){let n=t.getComposedRanges(i.root)[0];if(n)return vv(i,n)}let e=null;function s(n){n.preventDefault(),n.stopImmediatePropagation(),e=n.getTargetRanges()[0]}return i.contentDOM.addEventListener("beforeinput",s,!0),i.dom.ownerDocument.execCommand("indent"),i.contentDOM.removeEventListener("beforeinput",s,!0),e?vv(i,e):null}class tN{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=s=>{let n=t.state.selection.main,{anchor:r,head:o}=n,a=this.toEditorPos(s.updateRangeStart),l=this.toEditorPos(s.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:a,drifted:!1});let c=l-a>s.text.length;a==this.from&&r<this.from?a=r:l==this.to&&r>this.to&&(l=r);let h=yk(t.state.sliceDoc(a,l),s.text,(c?n.from:n.to)-a,c?"end":null);if(!h){let f=G.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));f.main.eq(n)||t.dispatch({selection:f,userEvent:"select"});return}let u={from:h.from+a,to:h.toA+a,insert:Wt.of(s.text.slice(h.from,h.toB).split(`
`))};if((ut.mac||ut.android)&&u.from==o-1&&/^\. ?$/.test(s.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(u={from:a,to:l,insert:Wt.of([s.text.replace("."," ")])}),this.pendingContextChange=u,!t.state.readOnly){let f=this.to-this.from+(u.to-u.from+u.insert.length);GO(t,u,G.single(this.toEditorPos(s.selectionStart,f),this.toEditorPos(s.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state)),u.from<u.to&&!u.insert.length&&t.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(e.text.slice(Math.max(0,s.updateRangeStart-1),Math.min(e.text.length,s.updateRangeStart+1)))&&this.handlers.compositionend(s)},this.handlers.characterboundsupdate=s=>{let n=[],r=null;for(let o=this.toEditorPos(s.rangeStart),a=this.toEditorPos(s.rangeEnd);o<a;o++){let l=t.coordsForChar(o);r=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||r||new DOMRect,n.push(r)}e.updateCharacterBounds(s.rangeStart,n)},this.handlers.textformatupdate=s=>{let n=[];for(let r of s.getTextFormats()){let o=r.underlineStyle,a=r.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(a)){let l=this.toEditorPos(r.rangeStart),c=this.toEditorPos(r.rangeEnd);if(l<c){let h=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(a)?1:2}px`;n.push(vt.mark({attributes:{style:h}}).range(l,c))}}}t.dispatch({effects:lk.of(vt.set(n))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(t.state)}};for(let s in this.handlers)e.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let n=Nc(s.root);n&&n.rangeCount&&this.editContext.updateSelectionBounds(n.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,s=!1,n=this.pendingContextChange;return t.changes.iterChanges((r,o,a,l,c)=>{if(s)return;let h=c.length-(o-r);if(n&&o>=n.to)if(n.from==r&&n.to==o&&n.insert.eq(c)){n=this.pendingContextChange=null,e+=h,this.to+=h;return}else n=null,this.revertPending(t.state);if(r+=e,o+=e,o<=this.from)this.from+=h,this.to+=h;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+c.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),c.toString()),this.to+=h}e+=h}),n&&!s&&this.revertPending(t.state),!s}update(t){let e=this.pendingContextChange,s=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(s.from,s.to)&&t.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=n)&&this.editContext.updateSelection(s,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>1e4*3)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let s=this.composing;return s&&s.drifted?s.editorBase+(t-s.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class ht{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:s}=t;this.dispatchTransactions=t.dispatchTransactions||s&&(n=>n.forEach(r=>s(r,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=t.root||$I(t.parent)||document,this.viewState=new Ov(t.state||Vt.create(t)),t.scrollTo&&t.scrollTo.is(_u)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(ma).map(n=>new tg(n));for(let n of this.plugins)n.update(this);this.observer=new K$(this),this.inputState=new _$(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Kb(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((e=document.fonts)===null||e===void 0)&&e.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let e=t.length==1&&t[0]instanceof Le?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,s=!1,n,r=this.state;for(let f of t){if(f.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=f.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,a=0,l=null;t.some(f=>f.annotation(wk))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=kk(r,o),l||(a=1));let c=this.observer.delayedAndroidKey,h=null;if(c?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(h=null)):this.observer.clear(),r.facet(Vt.phrases)!=this.state.facet(Vt.phrases))return this.setState(r);n=Xf.create(this,r,t),n.flags|=a;let u=this.viewState.scrollTarget;try{this.updateState=2;for(let f of t){if(u&&(u=u.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;u=new Aa(d.empty?d:G.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(_u)&&(u=d.value.clip(this.state))}this.viewState.update(n,u),this.bidiCache=jf.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet(Yl)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(Tu)!=n.state.facet(Tu)&&(this.viewState.mustMeasureContent=!0),(e||s||u||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),e&&this.docViewUpdate(),!n.empty)for(let f of this.state.facet(qm))try{f(n)}catch(d){qi(this.state,d,"update listener")}(l||h)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!Ok(this,h)&&c.force&&Pa(this.contentDOM,c.key,c.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new Ov(t),this.plugins=t.facet(ma).map(s=>new tg(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new Kb(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(ma),s=t.state.facet(ma);if(e!=s){let n=[];for(let r of s){let o=e.indexOf(r);if(o<0)n.push(new tg(r));else{let a=this.plugins[o];a.mustUpdate=t,n.push(a)}}for(let r of this.plugins)r.mustUpdate!=t&&r.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this);e!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(s){qi(this.state,s,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,s=this.scrollDOM,n=s.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(Lw(s))r=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(n);r=d.from,o=d.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let h=c.map(d=>{try{return d.read(this)}catch(p){return qi(this.state,p),_v}}),u=Xf.create(this,this.state,[]),f=!1;u.flags|=l,e?e.flags|=l:e=u,this.updateState=2,u.empty||(this.updatePlugins(u),this.inputState.update(u),this.updateAttrs(),f=this.docView.update(u),f&&this.docViewUpdate());for(let d=0;d<c.length;d++)if(h[d]!=_v)try{let p=c[d];p.write&&p.write(h[d],this)}catch(p){qi(this.state,p)}if(f&&this.docView.updateSelection(!0),!u.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(p>1||p<-1){n=n+p,s.scrollTop=n/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let a of this.state.facet(qm))a(e)}get themeClasses(){return Ym+" "+(this.state.facet(Gm)?Ak:Pk)+" "+this.state.facet(Tu)}updateAttrs(){let t=xv(this,ck,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(qn)?"true":"false",class:"cm-content",style:`${ut.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),xv(this,zO,e);let s=this.observer.ignore(()=>{let n=Vm(this.contentDOM,this.contentAttrs,e),r=Vm(this.dom,this.editorAttrs,t);return n||r});return this.editorAttrs=t,this.contentAttrs=e,s}showAnnouncements(t){let e=!0;for(let s of t)for(let n of s.effects)if(n.is(ht.announce)){e&&(this.announceDOM.textContent=""),e=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet(Yl);let t=this.state.facet(ht.cspNonce);zr.mount(this.root,this.styleModules.concat(U$).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.plugin!=t)&&this.pluginMap.set(t,e=this.plugins.find(s=>s.plugin==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,s){return ig(this,t,sv(this,t,e,s))}moveByGroup(t,e){return ig(this,t,sv(this,t,e,s=>f$(this,t.head,s)))}visualLineSide(t,e){let s=this.bidiSpans(t),n=this.textDirectionAt(t.from),r=s[e?s.length-1:0];return G.cursor(r.side(e,n)+t.from,r.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,s=!0){return u$(this,t,e,s)}moveVertically(t,e,s){return ig(this,t,d$(this,t,e,s))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),pk(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let s=this.docView.coordsAt(t,e);if(!s||s.left==s.right)return s;let n=this.state.doc.lineAt(t),r=this.bidiSpans(n),o=r[Rr.find(r,t-n.from,-1,e)];return vh(s,o.dir==Oe.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(rk)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>eN)return Hw(t.length);let e=this.textDirectionAt(t.from),s;for(let r of this.bidiCache)if(r.from==t.from&&r.dir==e&&(r.fresh||Uw(r.isolates,s=Hb(this,t))))return r.order;s||(s=Hb(this,t));let n=YI(t.text,e,s);return this.bidiCache.push(new jf(t.from,t.to,e,s,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||ut.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Nw(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return _u.of(new Aa(typeof t=="number"?G.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,s=this.viewState.scrollAnchorAt(t);return _u.of(new Aa(G.cursor(s.from),"start","start",s.top-t,e,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Me.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return Me.define(()=>({}),{eventObservers:t})}static theme(t,e){let s=zr.newName(),n=[Tu.of(s),Yl.of(Um(`.${s}`,t))];return e&&e.dark&&n.push(Gm.of(!0)),n}static baseTheme(t){return no.lowest(Yl.of(Um("."+Ym,t,Mk)))}static findFromDOM(t){var e;let s=t.querySelector(".cm-content"),n=s&&te.get(s)||te.get(t);return((e=n?.rootView)===null||e===void 0?void 0:e.view)||null}}ht.styleModule=Yl;ht.inputHandler=sk;ht.clipboardInputFilter=qO;ht.clipboardOutputFilter=XO;ht.scrollHandler=ak;ht.focusChangeEffect=nk;ht.perLineTextDirection=rk;ht.exceptionSink=ik;ht.updateListener=qm;ht.editable=qn;ht.mouseSelectionStyle=ek;ht.dragMovesSelection=tk;ht.clickAddsSelectionRange=Jw;ht.decorations=Dc;ht.outerDecorations=hk;ht.atomicRanges=Sh;ht.bidiIsolatedRanges=uk;ht.scrollMargins=fk;ht.darkTheme=Gm;ht.cspNonce=ft.define({combine:i=>i.length?i[0]:""});ht.contentAttributes=zO;ht.editorAttributes=ck;ht.lineWrapping=ht.contentAttributes.of({class:"cm-lineWrapping"});ht.announce=Et.define();const eN=4096,_v={};class jf{constructor(t,e,s,n,r,o){this.from=t,this.to=e,this.dir=s,this.isolates=n,this.fresh=r,this.order=o}static update(t,e){if(e.empty&&!t.some(r=>r.fresh))return t;let s=[],n=t.length?t[t.length-1].dir:Oe.LTR;for(let r=Math.max(0,t.length-10);r<t.length;r++){let o=t[r];o.dir==n&&!e.touchesRange(o.from,o.to)&&s.push(new jf(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return s}}function xv(i,t,e){for(let s=i.state.facet(t),n=s.length-1;n>=0;n--){let r=s[n],o=typeof r=="function"?r(i):r;o&&Lm(o,e)}return e}const iN=ut.mac?"mac":ut.windows?"win":ut.linux?"linux":"key";function sN(i,t){const e=i.split(/-(?!$)/);let s=e[e.length-1];s=="Space"&&(s=" ");let n,r,o,a;for(let l=0;l<e.length-1;++l){const c=e[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))n=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))t=="mac"?a=!0:r=!0;else throw new Error("Unrecognized modifier name: "+c)}return n&&(s="Alt-"+s),r&&(s="Ctrl-"+s),a&&(s="Meta-"+s),o&&(s="Shift-"+s),s}function Pu(i,t,e){return t.altKey&&(i="Alt-"+i),t.ctrlKey&&(i="Ctrl-"+i),t.metaKey&&(i="Meta-"+i),e!==!1&&t.shiftKey&&(i="Shift-"+i),i}const nN=no.default(ht.domEventHandlers({keydown(i,t){return Rk(Ek(t.state),i,t,"editor")}})),wh=ft.define({enables:nN}),Sv=new WeakMap;function Ek(i){let t=i.facet(wh),e=Sv.get(t);return e||Sv.set(t,e=aN(t.reduce((s,n)=>s.concat(n),[]))),e}function rN(i,t,e){return Rk(Ek(i.state),t,i,e)}let Pr=null;const oN=4e3;function aN(i,t=iN){let e=Object.create(null),s=Object.create(null),n=(o,a)=>{let l=s[o];if(l==null)s[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,a,l,c,h)=>{var u,f;let d=e[o]||(e[o]=Object.create(null)),p=a.split(/ (?!$)/).map(O=>sN(O,t));for(let O=1;O<p.length;O++){let b=p.slice(0,O).join(" ");n(b,!0),d[b]||(d[b]={preventDefault:!0,stopPropagation:!1,run:[x=>{let v=Pr={view:x,prefix:b,scope:o};return setTimeout(()=>{Pr==v&&(Pr=null)},oN),!0}]})}let g=p.join(" ");n(g,!1);let m=d[g]||(d[g]={preventDefault:!1,stopPropagation:!1,run:((f=(u=d._any)===null||u===void 0?void 0:u.run)===null||f===void 0?void 0:f.slice())||[]});l&&m.run.push(l),c&&(m.preventDefault=!0),h&&(m.stopPropagation=!0)};for(let o of i){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of a){let h=e[c]||(e[c]=Object.create(null));h._any||(h._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:u}=o;for(let f in h)h[f].run.push(d=>u(d,Hm))}let l=o[t]||o.key;if(l)for(let c of a)r(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return e}let Hm=null;function Rk(i,t,e,s){Hm=t;let n=AI(t),r=Bi(n,0),o=un(r)==n.length&&n!=" ",a="",l=!1,c=!1,h=!1;Pr&&Pr.view==e&&Pr.scope==s&&(a=Pr.prefix+" ",vk.indexOf(t.keyCode)<0&&(c=!0,Pr=null));let u=new Set,f=m=>{if(m){for(let O of m.run)if(!u.has(O)&&(u.add(O),O(e)))return m.stopPropagation&&(h=!0),!0;m.preventDefault&&(m.stopPropagation&&(h=!0),c=!0)}return!1},d=i[s],p,g;return d&&(f(d[a+Pu(n,t,!o)])?l=!0:o&&(t.altKey||t.metaKey||t.ctrlKey)&&!(ut.windows&&t.ctrlKey&&t.altKey)&&!(ut.mac&&t.altKey&&!(t.ctrlKey||t.metaKey))&&(p=jr[t.keyCode])&&p!=n?(f(d[a+Pu(p,t,!0)])||t.shiftKey&&(g=$c[t.keyCode])!=n&&g!=p&&f(d[a+Pu(g,t,!1)]))&&(l=!0):o&&t.shiftKey&&f(d[a+Pu(n,t,!0)])&&(l=!0),!l&&f(d._any)&&(l=!0)),c&&(l=!0),l&&h&&t.stopPropagation(),Hm=null,l}class kh{constructor(t,e,s,n,r){this.className=t,this.left=e,this.top=s,this.width=n,this.height=r}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,s){if(s.empty){let n=t.coordsAtPos(s.head,s.assoc||1);if(!n)return[];let r=Qk(t);return[new kh(e,n.left-r.left,n.top-r.top,null,n.bottom-n.top)]}else return lN(t,e,s)}}function Qk(i){let t=i.scrollDOM.getBoundingClientRect();return{left:(i.textDirection==Oe.LTR?t.left:t.right-i.scrollDOM.clientWidth*i.scaleX)-i.scrollDOM.scrollLeft*i.scaleX,top:t.top-i.scrollDOM.scrollTop*i.scaleY}}function wv(i,t,e,s){let n=i.coordsAtPos(t,e*2);if(!n)return s;let r=i.dom.getBoundingClientRect(),o=(n.top+n.bottom)/2,a=i.posAtCoords({x:r.left+1,y:o}),l=i.posAtCoords({x:r.right-1,y:o});return a==null||l==null?s:{from:Math.max(s.from,Math.min(a,l)),to:Math.min(s.to,Math.max(a,l))}}function lN(i,t,e){if(e.to<=i.viewport.from||e.from>=i.viewport.to)return[];let s=Math.max(e.from,i.viewport.from),n=Math.min(e.to,i.viewport.to),r=i.textDirection==Oe.LTR,o=i.contentDOM,a=o.getBoundingClientRect(),l=Qk(i),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),u=a.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),f=a.right-(h?parseInt(h.paddingRight):0),d=zm(i,s,1),p=zm(i,n,-1),g=d.type==Ai.Text?d:null,m=p.type==Ai.Text?p:null;if(g&&(i.lineWrapping||d.widgetLineBreaks)&&(g=wv(i,s,1,g)),m&&(i.lineWrapping||p.widgetLineBreaks)&&(m=wv(i,n,-1,m)),g&&m&&g.from==m.from&&g.to==m.to)return b(x(e.from,e.to,g));{let y=g?x(e.from,null,g):v(d,!1),_=m?x(null,e.to,m):v(p,!0),S=[];return(g||d).to<(m||p).from-(g&&m?1:0)||d.widgetLineBreaks>1&&y.bottom+i.defaultLineHeight/2<_.top?S.push(O(u,y.bottom,f,_.top)):y.bottom<_.top&&i.elementAtHeight((y.bottom+_.top)/2).type==Ai.Text&&(y.bottom=_.top=(y.bottom+_.top)/2),b(y).concat(S).concat(b(_))}function O(y,_,S,k){return new kh(t,y-l.left,_-l.top,S-y,k-_)}function b({top:y,bottom:_,horizontal:S}){let k=[];for(let A=0;A<S.length;A+=2)k.push(O(S[A],y,S[A+1],_));return k}function x(y,_,S){let k=1e9,A=-1e9,M=[];function R(N,L,I,Z,F){let z=i.coordsAtPos(N,N==S.to?-2:2),et=i.coordsAtPos(I,I==S.from?2:-2);!z||!et||(k=Math.min(z.top,et.top,k),A=Math.max(z.bottom,et.bottom,A),F==Oe.LTR?M.push(r&&L?u:z.left,r&&Z?f:et.right):M.push(!r&&Z?u:et.left,!r&&L?f:z.right))}let C=y??S.from,$=_??S.to;for(let N of i.visibleRanges)if(N.to>C&&N.from<$)for(let L=Math.max(N.from,C),I=Math.min(N.to,$);;){let Z=i.state.doc.lineAt(L);for(let F of i.bidiSpans(Z)){let z=F.from+Z.from,et=F.to+Z.from;if(z>=I)break;et>L&&R(Math.max(z,L),y==null&&z<=C,Math.min(et,I),_==null&&et>=$,F.dir)}if(L=Z.to+1,L>=I)break}return M.length==0&&R(C,y==null,$,_==null,i.textDirection),{top:k,bottom:A,horizontal:M}}function v(y,_){let S=a.top+(_?y.top:y.bottom);return{top:S,bottom:S,horizontal:[]}}}function cN(i,t){return i.constructor==t.constructor&&i.eq(t)}class hN{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(sf)!=t.state.facet(sf)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,s=t.facet(sf);for(;e<s.length&&s[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;(t!=this.scaleX||e!=this.scaleY)&&(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some((e,s)=>!cN(e,this.drawn[s]))){let e=this.dom.firstChild,s=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[s].constructor&&n.update(e,this.drawn[s])?(e=e.nextSibling,s++):this.dom.insertBefore(n.draw(),e);for(;e;){let n=e.nextSibling;e.remove(),e=n}this.drawn=t,ut.ios&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const sf=ft.define();function Ik(i){return[Me.define(t=>new hN(t,i)),sf.of(i)]}const Lc=ft.define({combine(i){return An(i,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function uN(i={}){return[Lc.of(i),fN,dN,pN,ok.of(!0)]}function $k(i){return i.startState.facet(Lc)!=i.state.facet(Lc)}const fN=Ik({above:!0,markers(i){let{state:t}=i,e=t.facet(Lc),s=[];for(let n of t.selection.ranges){let r=n==t.selection.main;if(n.empty||e.drawRangeCursor){let o=r?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=n.empty?n:G.cursor(n.head,n.head>n.anchor?-1:1);for(let l of kh.forRange(i,o,a))s.push(l)}}return s},update(i,t){i.transactions.some(s=>s.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let e=$k(i);return e&&kv(i.state,t),i.docChanged||i.selectionSet||e},mount(i,t){kv(t.state,i)},class:"cm-cursorLayer"});function kv(i,t){t.style.animationDuration=i.facet(Lc).cursorBlinkRate+"ms"}const dN=Ik({above:!1,markers(i){return i.state.selection.ranges.map(t=>t.empty?[]:kh.forRange(i,"cm-selectionBackground",t)).reduce((t,e)=>t.concat(e))},update(i,t){return i.docChanged||i.selectionSet||i.viewportChanged||$k(i)},class:"cm-selectionLayer"}),pN=no.highest(ht.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Nk=Et.define({map(i,t){return i==null?null:t.mapPos(i)}}),Kl=Je.define({create(){return null},update(i,t){return i!=null&&(i=t.changes.mapPos(i)),t.effects.reduce((e,s)=>s.is(Nk)?s.value:e,i)}}),gN=Me.fromClass(class{constructor(i){this.view=i,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(i){var t;let e=i.state.field(Kl);e==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(i.startState.field(Kl)!=e||i.docChanged||i.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:i}=this,t=i.state.field(Kl),e=t!=null&&i.coordsAtPos(t);if(!e)return null;let s=i.scrollDOM.getBoundingClientRect();return{left:e.left-s.left+i.scrollDOM.scrollLeft*i.scaleX,top:e.top-s.top+i.scrollDOM.scrollTop*i.scaleY,height:e.bottom-e.top}}drawCursor(i){if(this.cursor){let{scaleX:t,scaleY:e}=this.view;i?(this.cursor.style.left=i.left/t+"px",this.cursor.style.top=i.top/e+"px",this.cursor.style.height=i.height/e+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(i){this.view.state.field(Kl)!=i&&this.view.dispatch({effects:Nk.of(i)})}},{eventObservers:{dragover(i){this.setDropPos(this.view.posAtCoords({x:i.clientX,y:i.clientY}))},dragleave(i){(i.target==this.view.contentDOM||!this.view.contentDOM.contains(i.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function mN(){return[Kl,gN]}function Cv(i,t,e,s,n){t.lastIndex=0;for(let r=i.iterRange(e,s),o=e,a;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;a=t.exec(r.value);)n(o+a.index,a)}function ON(i,t){let e=i.visibleRanges;if(e.length==1&&e[0].from==i.viewport.from&&e[0].to==i.viewport.to)return e;let s=[];for(let{from:n,to:r}of e)n=Math.max(i.state.doc.lineAt(n).from,n-t),r=Math.min(i.state.doc.lineAt(r).to,r+t),s.length&&s[s.length-1].to>=n?s[s.length-1].to=r:s.push({from:n,to:r});return s}class yN{constructor(t){const{regexp:e,decoration:s,decorate:n,boundary:r,maxLength:o=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(a,l,c,h)=>n(h,c,c+a[0].length,a,l);else if(typeof s=="function")this.addMatch=(a,l,c,h)=>{let u=s(a,l,c);u&&h(c,c+a[0].length,u)};else if(s)this.addMatch=(a,l,c,h)=>h(c,c+a[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=r,this.maxLength=o}createDeco(t){let e=new Jn,s=e.add.bind(e);for(let{from:n,to:r}of ON(t,this.maxLength))Cv(t.state.doc,this.regexp,n,r,(o,a)=>this.addMatch(a,t,o,s));return e.finish()}updateDeco(t,e){let s=1e9,n=-1;return t.docChanged&&t.changes.iterChanges((r,o,a,l)=>{l>=t.view.viewport.from&&a<=t.view.viewport.to&&(s=Math.min(a,s),n=Math.max(l,n))}),t.viewportMoved||n-s>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),s,n):e}updateRange(t,e,s,n){for(let r of t.visibleRanges){let o=Math.max(r.from,s),a=Math.min(r.to,n);if(a>=o){let l=t.state.doc.lineAt(o),c=l.to<a?t.state.doc.lineAt(a):l,h=Math.max(r.from,l.from),u=Math.min(r.to,c.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){h=o;break}for(;a<c.to;a++)if(this.boundary.test(c.text[a-c.from])){u=a;break}}let f=[],d,p=(g,m,O)=>f.push(O.range(g,m));if(l==c)for(this.regexp.lastIndex=h-l.from;(d=this.regexp.exec(l.text))&&d.index<u-l.from;)this.addMatch(d,t,d.index+l.from,p);else Cv(t.state.doc,this.regexp,h,u,(g,m)=>this.addMatch(m,t,g,p));e=e.update({filterFrom:h,filterTo:u,filter:(g,m)=>g<h||m>u,add:f})}}return e}}const Km=/x/.unicode!=null?"gu":"g",bN=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Km),vN={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let rg=null;function _N(){var i;if(rg==null&&typeof document<"u"&&document.body){let t=document.body.style;rg=((i=t.tabSize)!==null&&i!==void 0?i:t.MozTabSize)!=null}return rg||!1}const nf=ft.define({combine(i){let t=An(i,{render:null,specialChars:bN,addSpecialChars:null});return(t.replaceTabs=!_N())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,Km)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Km)),t}});function xN(i={}){return[nf.of(i),SN()]}let Tv=null;function SN(){return Tv||(Tv=Me.fromClass(class{constructor(i){this.view=i,this.decorations=vt.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(i.state.facet(nf)),this.decorations=this.decorator.createDeco(i)}makeDecorator(i){return new yN({regexp:i.specialChars,decoration:(t,e,s)=>{let{doc:n}=e.state,r=Bi(t[0],0);if(r==9){let o=n.lineAt(s),a=e.state.tabSize,l=ol(o.text,a,s-o.from);return vt.replace({widget:new TN((a-l%a)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[r]||(this.decorationCache[r]=vt.replace({widget:new CN(i,r)}))},boundary:i.replaceTabs?void 0:/[^]/})}update(i){let t=i.state.facet(nf);i.startState.facet(nf)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(i.view)):this.decorations=this.decorator.updateDeco(i,this.decorations)}},{decorations:i=>i.decorations}))}const wN="";function kN(i){return i>=32?wN:i==10?"":String.fromCharCode(9216+i)}class CN extends Mn{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=kN(this.code),s=t.state.phrase("Control character")+" "+(vN[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,s,e);if(n)return n;let r=document.createElement("span");return r.textContent=e,r.title=s,r.setAttribute("aria-label",s),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class TN extends Mn{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function PN(){return MN}const AN=vt.line({class:"cm-activeLine"}),MN=Me.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.docChanged||i.selectionSet)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let t=-1,e=[];for(let s of i.state.selection.ranges){let n=i.lineBlockAt(s.head);n.from>t&&(e.push(AN.range(n.from)),t=n.from)}return vt.set(e)}},{decorations:i=>i.decorations});class EN extends Mn{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?Wa(t.firstChild):[];if(!e.length)return null;let s=window.getComputedStyle(t.parentNode),n=vh(e[0],s.direction!="rtl"),r=parseInt(s.lineHeight);return n.bottom-n.top>r*1.5?{left:n.left,right:n.right,top:n.top,bottom:n.top+r}:n}ignoreEvent(){return!1}}function RN(i){let t=Me.fromClass(class{constructor(e){this.view=e,this.placeholder=i?vt.set([vt.widget({widget:new EN(i),side:1}).range(0)]):vt.none}get decorations(){return this.view.state.doc.length?vt.none:this.placeholder}},{decorations:e=>e.decorations});return typeof i=="string"?[t,ht.contentAttributes.of({"aria-placeholder":i})]:t}const Jm=2e3;function QN(i,t,e){let s=Math.min(t.line,e.line),n=Math.max(t.line,e.line),r=[];if(t.off>Jm||e.off>Jm||t.col<0||e.col<0){let o=Math.min(t.off,e.off),a=Math.max(t.off,e.off);for(let l=s;l<=n;l++){let c=i.doc.line(l);c.length<=a&&r.push(G.range(c.from+o,c.to+a))}}else{let o=Math.min(t.col,e.col),a=Math.max(t.col,e.col);for(let l=s;l<=n;l++){let c=i.doc.line(l),h=Mm(c.text,o,i.tabSize,!0);if(h<0)r.push(G.cursor(c.to));else{let u=Mm(c.text,a,i.tabSize);r.push(G.range(c.from+h,c.from+u))}}}return r}function IN(i,t){let e=i.coordsAtPos(i.viewport.from);return e?Math.round(Math.abs((e.left-t)/i.defaultCharacterWidth)):-1}function Pv(i,t){let e=i.posAtCoords({x:t.clientX,y:t.clientY},!1),s=i.state.doc.lineAt(e),n=e-s.from,r=n>Jm?-1:n==s.length?IN(i,t.clientX):ol(s.text,i.state.tabSize,e-s.from);return{line:s.number,col:r,off:n}}function $N(i,t){let e=Pv(i,t),s=i.state.selection;return e?{update(n){if(n.docChanged){let r=n.changes.mapPos(n.startState.doc.line(e.line).from),o=n.state.doc.lineAt(r);e={line:o.number,col:e.col,off:Math.min(e.off,o.length)},s=s.map(n.changes)}},get(n,r,o){let a=Pv(i,n);if(!a)return s;let l=QN(i.state,e,a);return l.length?o?G.create(l.concat(s.ranges)):G.create(l):s}}:null}function NN(i){let t=(e=>e.altKey&&e.button==0);return ht.mouseSelectionStyle.of((e,s)=>t(s)?$N(e,s):null)}const DN={Alt:[18,i=>!!i.altKey],Control:[17,i=>!!i.ctrlKey],Shift:[16,i=>!!i.shiftKey],Meta:[91,i=>!!i.metaKey]},LN={style:"cursor: crosshair"};function VN(i={}){let[t,e]=DN[i.key||"Alt"],s=Me.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventObservers:{keydown(n){this.set(n.keyCode==t||e(n))},keyup(n){(n.keyCode==t||!e(n))&&this.set(!1)},mousemove(n){this.set(e(n))}}});return[s,ht.contentAttributes.of(n=>{var r;return!((r=n.plugin(s))===null||r===void 0)&&r.isDown?LN:null})]}const Nl="-10000px";class Dk{constructor(t,e,s,n){this.facet=e,this.createTooltipView=s,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter(o=>o);let r=null;this.tooltipViews=this.tooltips.map(o=>r=s(o,r))}update(t,e){var s;let n=t.state.facet(this.facet),r=n.filter(l=>l);if(n===this.input){for(let l of this.tooltipViews)l.update&&l.update(t);return!1}let o=[],a=e?[]:null;for(let l=0;l<r.length;l++){let c=r[l],h=-1;if(c){for(let u=0;u<this.tooltips.length;u++){let f=this.tooltips[u];f&&f.create==c.create&&(h=u)}if(h<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),a&&(a[l]=!!c.above);else{let u=o[l]=this.tooltipViews[h];a&&(a[l]=e[h]),u.update&&u.update(t)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(s=l.destroy)===null||s===void 0||s.call(l));return e&&(a.forEach((l,c)=>e[c]=l),e.length=a.length),this.input=n,this.tooltips=r,this.tooltipViews=o,!0}}function BN(i){let t=i.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const og=ft.define({combine:i=>{var t,e,s;return{position:ut.ios?"absolute":((t=i.find(n=>n.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=i.find(n=>n.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((s=i.find(n=>n.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||BN}}}),Av=new WeakMap,HO=Me.fromClass(class{constructor(i){this.view=i,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=i.state.facet(og);this.position=t.position,this.parent=t.parent,this.classes=i.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Dk(i,KO,(e,s)=>this.createTooltip(e,s),e=>{this.resizeObserver&&this.resizeObserver.unobserve(e.dom),e.dom.remove()}),this.above=this.manager.tooltips.map(e=>!!e.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),i.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let i of this.manager.tooltipViews)this.intersectionObserver.observe(i.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(i){i.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(i,this.above);t&&this.observeIntersection();let e=t||i.geometryChanged,s=i.state.facet(og);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;e=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(i,t){let e=i.create(this.view),s=t?t.dom:null;if(e.dom.classList.add("cm-tooltip"),i.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",e.dom.appendChild(n)}return e.dom.style.position=this.position,e.dom.style.top=Nl,e.dom.style.left="0px",this.container.insertBefore(e.dom,s),e.mount&&e.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(e.dom),e}destroy(){var i,t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(i=s.destroy)===null||i===void 0||i.call(s);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let i=1,t=1,e=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(ut.gecko)e=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==Nl&&r.style.left=="0px"){let o=r.getBoundingClientRect();e=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(e||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(i=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:i,scaleY:t}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),n=jO(this.view);return{visible:{left:s.left+n.left,top:s.top+n.top,right:s.right-n.right,bottom:s.bottom-n.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((r,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(og).tooltipSpace(this.view),scaleX:i,scaleY:t,makeAbsolute:e}}writeMeasure(i){var t;if(i.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:e,space:s,scaleX:n,scaleY:r}=i,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:h}=c,u=i.pos[a],f=i.size[a];if(!u||l.clip!==!1&&(u.bottom<=Math.max(e.top,s.top)||u.top>=Math.min(e.bottom,s.bottom)||u.right<Math.max(e.left,s.left)-.1||u.left>Math.min(e.right,s.right)+.1)){h.style.top=Nl;continue}let d=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,g=f.right-f.left,m=(t=Av.get(c))!==null&&t!==void 0?t:f.bottom-f.top,O=c.offset||FN,b=this.view.textDirection==Oe.LTR,x=f.width>s.right-s.left?b?s.left:s.right-f.width:b?Math.max(s.left,Math.min(u.left-(d?14:0)+O.x,s.right-g)):Math.min(Math.max(s.left,u.left-g+(d?14:0)-O.x),s.right-g),v=this.above[a];!l.strictSide&&(v?u.top-m-p-O.y<s.top:u.bottom+m+p+O.y>s.bottom)&&v==s.bottom-u.bottom>u.top-s.top&&(v=this.above[a]=!v);let y=(v?u.top-s.top:s.bottom-u.bottom)-p;if(y<m&&c.resize!==!1){if(y<this.view.defaultLineHeight){h.style.top=Nl;continue}Av.set(c,m),h.style.height=(m=y)/r+"px"}else h.style.height&&(h.style.height="");let _=v?u.top-m-p-O.y:u.bottom+p+O.y,S=x+g;if(c.overlap!==!0)for(let k of o)k.left<S&&k.right>x&&k.top<_+m&&k.bottom>_&&(_=v?k.top-m-2-p:k.bottom+p+2);if(this.position=="absolute"?(h.style.top=(_-i.parent.top)/r+"px",Mv(h,(x-i.parent.left)/n)):(h.style.top=_/r+"px",Mv(h,x/n)),d){let k=u.left+(b?O.x:-O.x)-(x+14-7);d.style.left=k/n+"px"}c.overlap!==!0&&o.push({left:x,top:_,right:S,bottom:_+m}),h.classList.toggle("cm-tooltip-above",v),h.classList.toggle("cm-tooltip-below",!v),c.positioned&&c.positioned(i.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let i of this.manager.tooltipViews)i.dom.style.top=Nl}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Mv(i,t){let e=parseInt(i.style.left,10);(isNaN(e)||Math.abs(t-e)>1)&&(i.style.left=t+"px")}const ZN=ht.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),FN={x:0,y:0},KO=ft.define({enables:[HO,ZN]}),Gf=ft.define({combine:i=>i.reduce((t,e)=>t.concat(e),[])});class op{static create(t){return new op(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Dk(t,Gf,(e,s)=>this.createHostedView(e,s),e=>e.dom.remove())}createHostedView(t,e){let s=t.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(s.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&s.mount&&s.mount(this.view),s}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)(t=e.destroy)===null||t===void 0||t.call(e)}passProp(t){let e;for(let s of this.manager.tooltipViews){let n=s[t];if(n!==void 0){if(e===void 0)e=n;else if(e!==n)return}}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const WN=KO.compute([Gf],i=>{let t=i.facet(Gf);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.map(e=>{var s;return(s=e.end)!==null&&s!==void 0?s:e.pos})),create:op.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class qN{constructor(t,e,s,n,r){this.view=t,this.source=e,this.field=s,this.setHover=n,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,s=t.docView.nearest(e.target);if(!s)return;let n,r=1;if(s instanceof Er)n=s.posAtStart;else{if(n=t.posAtCoords(e),n==null)return;let a=t.coordsAtPos(n);if(!a||e.y<a.top||e.y>a.bottom||e.x<a.left-t.defaultCharacterWidth||e.x>a.right+t.defaultCharacterWidth)return;let l=t.bidiSpans(t.state.doc.lineAt(n)).find(h=>h.from<=n&&h.to>=n),c=l&&l.dir==Oe.RTL?-1:1;r=e.x<a.left?-c:c}let o=this.source(t,n,r);if(o?.then){let a=this.pending={pos:n};o.then(l=>{this.pending==a&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>qi(t.state,l,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let t=this.view.plugin(HO),e=t?t.manager.tooltips.findIndex(s=>s.create==op.create):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,s;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:r}=this;if(n.length&&r&&!XN(r.dom,t)||this.pending){let{pos:o}=n[0]||this.pending,a=(s=(e=n[0])===null||e===void 0?void 0:e.end)!==null&&s!==void 0?s:o;(o==a?this.view.posAtCoords(this.lastMove)!=o:!zN(this.view,o,a,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:s}=this;s&&s.dom.contains(t.relatedTarget)?this.watchTooltipLeave(s.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=s=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(s.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Au=4;function XN(i,t){let{left:e,right:s,top:n,bottom:r}=i.getBoundingClientRect(),o;if(o=i.querySelector(".cm-tooltip-arrow")){let a=o.getBoundingClientRect();n=Math.min(a.top,n),r=Math.max(a.bottom,r)}return t.clientX>=e-Au&&t.clientX<=s+Au&&t.clientY>=n-Au&&t.clientY<=r+Au}function zN(i,t,e,s,n,r){let o=i.scrollDOM.getBoundingClientRect(),a=i.documentTop+i.documentPadding.top+i.contentHeight;if(o.left>s||o.right<s||o.top>n||Math.min(o.bottom,a)<n)return!1;let l=i.posAtCoords({x:s,y:n},!1);return l>=t&&l<=e}function jN(i,t={}){let e=Et.define(),s=Je.define({create(){return[]},update(n,r){if(n.length&&(t.hideOnChange&&(r.docChanged||r.selection)?n=[]:t.hideOn&&(n=n.filter(o=>!t.hideOn(r,o))),r.docChanged)){let o=[];for(let a of n){let l=r.changes.mapPos(a.pos,-1,ni.TrackDel);if(l!=null){let c=Object.assign(Object.create(null),a);c.pos=l,c.end!=null&&(c.end=r.changes.mapPos(c.end)),o.push(c)}}n=o}for(let o of r.effects)o.is(e)&&(n=o.value),o.is(GN)&&(n=[]);return n},provide:n=>Gf.from(n)});return{active:s,extension:[s,Me.define(n=>new qN(n,i,s,e,t.hoverTime||300)),WN]}}function Lk(i,t){let e=i.plugin(HO);if(!e)return null;let s=e.manager.tooltips.indexOf(t);return s<0?null:e.manager.tooltipViews[s]}const GN=Et.define(),Ev=ft.define({combine(i){let t,e;for(let s of i)t=t||s.topContainer,e=e||s.bottomContainer;return{topContainer:t,bottomContainer:e}}});function Vc(i,t){let e=i.plugin(Vk),s=e?e.specs.indexOf(t):-1;return s>-1?e.panels[s]:null}const Vk=Me.fromClass(class{constructor(i){this.input=i.state.facet(Bc),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(i));let t=i.state.facet(Ev);this.top=new Mu(i,!0,t.topContainer),this.bottom=new Mu(i,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(i){let t=i.state.facet(Ev);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Mu(i.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Mu(i.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=i.state.facet(Bc);if(e!=this.input){let s=e.filter(l=>l),n=[],r=[],o=[],a=[];for(let l of s){let c=this.specs.indexOf(l),h;c<0?(h=l(i.view),a.push(h)):(h=this.panels[c],h.update&&h.update(i)),n.push(h),(h.top?r:o).push(h)}this.specs=s,this.panels=n,this.top.sync(r),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let s of this.panels)s.update&&s.update(i)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:i=>ht.scrollMargins.of(t=>{let e=t.plugin(i);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class Mu{constructor(t,e,s){this.view=t,this.top=e,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=Rv(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=Rv(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Rv(i){let t=i.nextSibling;return i.remove(),t}const Bc=ft.define({enables:Vk});class er extends Qo{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}er.prototype.elementClass="";er.prototype.toDOM=void 0;er.prototype.mapMode=ni.TrackBefore;er.prototype.startSide=er.prototype.endSide=-1;er.prototype.point=!0;const rf=ft.define(),YN=ft.define(),UN={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>zt.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Oc=ft.define();function HN(i){return[Bk(),Oc.of({...UN,...i})]}const Qv=ft.define({combine:i=>i.some(t=>t)});function Bk(i){return[KN]}const KN=Me.fromClass(class{constructor(i){this.view=i,this.domAfter=null,this.prevViewport=i.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=i.state.facet(Oc).map(t=>new $v(i,t)),this.fixed=!i.state.facet(Qv);for(let t of this.gutters)t.config.side=="after"?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),i.scrollDOM.insertBefore(this.dom,i.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(i){if(this.updateGutters(i)){let t=this.prevViewport,e=i.view.viewport,s=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(s<(e.to-e.from)*.8)}if(i.geometryChanged){let t=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=t,this.domAfter&&(this.domAfter.style.minHeight=t)}this.view.state.facet(Qv)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=i.view.viewport}syncGutters(i){let t=this.dom.nextSibling;i&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let e=zt.iter(this.view.state.facet(rf),this.view.viewport.from),s=[],n=this.gutters.map(r=>new JN(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(r.type)){let o=!0;for(let a of r.type)if(a.type==Ai.Text&&o){t0(e,s,a.from);for(let l of n)l.line(this.view,a,s);o=!1}else if(a.widget)for(let l of n)l.widget(this.view,a)}else if(r.type==Ai.Text){t0(e,s,r.from);for(let o of n)o.line(this.view,r,s)}else if(r.widget)for(let o of n)o.widget(this.view,r);for(let r of n)r.finish();i&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(i){let t=i.startState.facet(Oc),e=i.state.facet(Oc),s=i.docChanged||i.heightChanged||i.viewportChanged||!zt.eq(i.startState.facet(rf),i.state.facet(rf),i.view.viewport.from,i.view.viewport.to);if(t==e)for(let n of this.gutters)n.update(i)&&(s=!0);else{s=!0;let n=[];for(let r of e){let o=t.indexOf(r);o<0?n.push(new $v(this.view,r)):(this.gutters[o].update(i),n.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),n.indexOf(r)<0&&r.destroy();for(let r of n)r.config.side=="after"?this.getDOMAfter().appendChild(r.dom):this.dom.appendChild(r.dom);this.gutters=n}return s}destroy(){for(let i of this.gutters)i.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:i=>ht.scrollMargins.of(t=>{let e=t.plugin(i);if(!e||e.gutters.length==0||!e.fixed)return null;let s=e.dom.offsetWidth*t.scaleX,n=e.domAfter?e.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==Oe.LTR?{left:s,right:n}:{right:s,left:n}})});function Iv(i){return Array.isArray(i)?i:[i]}function t0(i,t,e){for(;i.value&&i.from<=e;)i.from==e&&t.push(i.value),i.next()}class JN{constructor(t,e,s){this.gutter=t,this.height=s,this.i=0,this.cursor=zt.iter(t.markers,e.from)}addElement(t,e,s){let{gutter:n}=this,r=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==n.elements.length){let a=new Zk(t,o,r,s);n.elements.push(a),n.dom.appendChild(a.dom)}else n.elements[this.i].update(t,o,r,s);this.height=e.bottom,this.i++}line(t,e,s){let n=[];t0(this.cursor,n,e.from),s.length&&(n=n.concat(s));let r=this.gutter.config.lineMarker(t,e,n);r&&n.unshift(r);let o=this.gutter;n.length==0&&!o.config.renderEmptyElements||this.addElement(t,e,n)}widget(t,e){let s=this.gutter.config.widgetMarker(t,e.widget,e),n=s?[s]:null;for(let r of t.state.facet(YN)){let o=r(t,e.widget,e);o&&(n||(n=[])).push(o)}n&&this.addElement(t,e,n)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class $v{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in e.domEventHandlers)this.dom.addEventListener(s,n=>{let r=n.target,o;if(r!=this.dom&&this.dom.contains(r)){for(;r.parentNode!=this.dom;)r=r.parentNode;let l=r.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=n.clientY;let a=t.lineBlockAtHeight(o-t.documentTop);e.domEventHandlers[s](t,a,n)&&n.preventDefault()});this.markers=Iv(e.markers(t)),e.initialSpacer&&(this.spacer=new Zk(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=Iv(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],t);n!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[n])}let s=t.view.viewport;return!zt.eq(this.markers,e,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class Zk{constructor(t,e,s,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,s,n)}update(t,e,s,n){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),tD(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let s="cm-gutterElement",n=this.dom.firstChild;for(let r=0,o=0;;){let a=o,l=r<e.length?e[r++]:null,c=!1;if(l){let h=l.elementClass;h&&(s+=" "+h);for(let u=o;u<this.markers.length;u++)if(this.markers[u].compare(l)){a=u,c=!0;break}}else a=this.markers.length;for(;o<a;){let h=this.markers[o++];if(h.toDOM){h.destroy(n);let u=n.nextSibling;n.remove(),n=u}}if(!l)break;l.toDOM&&(c?n=n.nextSibling:this.dom.insertBefore(l.toDOM(t),n)),c&&o++}this.dom.className=s,this.markers=e}destroy(){this.setMarkers(null,[])}}function tD(i,t){if(i.length!=t.length)return!1;for(let e=0;e<i.length;e++)if(!i[e].compare(t[e]))return!1;return!0}const eD=ft.define(),iD=ft.define(),Oa=ft.define({combine(i){return An(i,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let s=Object.assign({},t);for(let n in e){let r=s[n],o=e[n];s[n]=r?(a,l,c)=>r(a,l,c)||o(a,l,c):o}return s}})}});class ag extends er{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function lg(i,t){return i.state.facet(Oa).formatNumber(t,i.state)}const sD=Oc.compute([Oa],i=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(eD)},lineMarker(t,e,s){return s.some(n=>n.toDOM)?null:new ag(lg(t,t.state.doc.lineAt(e.from).number))},widgetMarker:(t,e,s)=>{for(let n of t.state.facet(iD)){let r=n(t,e,s);if(r)return r}return null},lineMarkerChange:t=>t.startState.facet(Oa)!=t.state.facet(Oa),initialSpacer(t){return new ag(lg(t,Nv(t.state.doc.lines)))},updateSpacer(t,e){let s=lg(e.view,Nv(e.view.state.doc.lines));return s==t.number?t:new ag(s)},domEventHandlers:i.facet(Oa).domEventHandlers,side:"before"}));function nD(i={}){return[Oa.of(i),Bk(),sD]}function Nv(i){let t=9;for(;t<i;)t=t*10+9;return t}const rD=new class extends er{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},oD=rf.compute(["selection"],i=>{let t=[],e=-1;for(let s of i.selection.ranges){let n=i.doc.lineAt(s.head).from;n>e&&(e=n,t.push(rD.range(n)))}return zt.of(t)});function aD(){return oD}const Fk=1024;let lD=0;class cg{constructor(t,e){this.from=t,this.to=e}}class Dt{constructor(t={}){this.id=lD++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Yi.match(t)),e=>{let s=t(e);return s===void 0?null:[this,s]}}}Dt.closedBy=new Dt({deserialize:i=>i.split(" ")});Dt.openedBy=new Dt({deserialize:i=>i.split(" ")});Dt.group=new Dt({deserialize:i=>i.split(" ")});Dt.isolate=new Dt({deserialize:i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});Dt.contextHash=new Dt({perNode:!0});Dt.lookAhead=new Dt({perNode:!0});Dt.mounted=new Dt({perNode:!0});class Yf{constructor(t,e,s){this.tree=t,this.overlay=e,this.parser=s}static get(t){return t&&t.props&&t.props[Dt.mounted.id]}}const cD=Object.create(null);class Yi{constructor(t,e,s,n=0){this.name=t,this.props=e,this.id=s,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):cD,s=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new Yi(t.name||"",e,t.id,s);if(t.props){for(let r of t.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[r[0].id]=r[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(Dt.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let s in t)for(let n of s.split(" "))e[n]=t[s];return s=>{for(let n=s.prop(Dt.group),r=-1;r<(n?n.length:0);r++){let o=e[r<0?s.name:n[r]];if(o)return o}}}}Yi.none=new Yi("",Object.create(null),0,8);class JO{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let s of this.types){let n=null;for(let r of t){let o=r(s);o&&(n||(n=Object.assign({},s.props)),n[o[0].id]=o[1])}e.push(n?new Yi(s.name,n,s.id,s.flags):s)}return new JO(e)}}const Eu=new WeakMap,Dv=new WeakMap;var ze;(function(i){i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays"})(ze||(ze={}));class Ve{constructor(t,e,s,n,r){if(this.type=t,this.children=e,this.positions=s,this.length=n,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,a]of r)this.props[typeof o=="number"?o:o.id]=a}}toString(){let t=Yf.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let s of this.children){let n=s.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new i0(this.topNode,t)}cursorAt(t,e=0,s=0){let n=Eu.get(this)||this.topNode,r=new i0(n);return r.moveTo(t,e),Eu.set(this,r._tree),r}get topNode(){return new ji(this,0,0,null)}resolve(t,e=0){let s=Zc(Eu.get(this)||this.topNode,t,e,!1);return Eu.set(this,s),s}resolveInner(t,e=0){let s=Zc(Dv.get(this)||this.topNode,t,e,!0);return Dv.set(this,s),s}resolveStack(t,e=0){return fD(this,t,e)}iterate(t){let{enter:e,leave:s,from:n=0,to:r=this.length}=t,o=t.mode||0,a=(o&ze.IncludeAnonymous)>0;for(let l=this.cursor(o|ze.IncludeAnonymous);;){let c=!1;if(l.from<=r&&l.to>=n&&(!a&&l.type.isAnonymous||e(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&s&&(a||!l.type.isAnonymous)&&s(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:i1(Yi.none,this.children,this.positions,0,this.children.length,0,this.length,(e,s,n)=>new Ve(this.type,e,s,n,this.propValues),t.makeTree||((e,s,n)=>new Ve(Yi.none,e,s,n)))}static build(t){return dD(t)}}Ve.empty=new Ve(Yi.none,[],[],0);class t1{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new t1(this.buffer,this.index)}}class Yr{constructor(t,e,s){this.buffer=t,this.length=e,this.set=s}get type(){return Yi.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],s=this.buffer[t+3],n=this.set.types[e],r=n.name;if(/\W/.test(r)&&!n.isError&&(r=JSON.stringify(r)),t+=4,s==t)return r;let o=[];for(;t<s;)o.push(this.childString(t)),t=this.buffer[t+3];return r+"("+o.join(",")+")"}findChild(t,e,s,n,r){let{buffer:o}=this,a=-1;for(let l=t;l!=e&&!(Wk(r,n,o[l+1],o[l+2])&&(a=l,s>0));l=o[l+3]);return a}slice(t,e,s){let n=this.buffer,r=new Uint16Array(e-t),o=0;for(let a=t,l=0;a<e;){r[l++]=n[a++],r[l++]=n[a++]-s;let c=r[l++]=n[a++]-s;r[l++]=n[a++]-t,o=Math.max(o,c)}return new Yr(r,o,this.set)}}function Wk(i,t,e,s){switch(i){case-2:return e<t;case-1:return s>=t&&e<t;case 0:return e<t&&s>t;case 1:return e<=t&&s>t;case 2:return s>t;case 4:return!0}}function Zc(i,t,e,s){for(var n;i.from==i.to||(e<1?i.from>=t:i.from>t)||(e>-1?i.to<=t:i.to<t);){let o=!s&&i instanceof ji&&i.index<0?null:i.parent;if(!o)return i;i=o}let r=s?0:ze.IgnoreOverlays;if(s)for(let o=i,a=o.parent;a;o=a,a=o.parent)o instanceof ji&&o.index<0&&((n=a.enter(t,e,r))===null||n===void 0?void 0:n.from)!=o.from&&(i=a);for(;;){let o=i.enter(t,e,r);if(!o)return i;i=o}}class qk{cursor(t=0){return new i0(this,t)}getChild(t,e=null,s=null){let n=Lv(this,t,e,s);return n.length?n[0]:null}getChildren(t,e=null,s=null){return Lv(this,t,e,s)}resolve(t,e=0){return Zc(this,t,e,!1)}resolveInner(t,e=0){return Zc(this,t,e,!0)}matchContext(t){return e0(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),s=this;for(;e;){let n=e.lastChild;if(!n||n.to!=e.to)break;n.type.isError&&n.from==n.to?(s=e,e=n.prevSibling):e=n}return s}get node(){return this}get next(){return this.parent}}class ji extends qk{constructor(t,e,s,n){super(),this._tree=t,this.from=e,this.index=s,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,s,n,r=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,c=e>0?a.length:-1;t!=c;t+=e){let h=a[t],u=l[t]+o.from;if(Wk(n,s,u,u+h.length)){if(h instanceof Yr){if(r&ze.ExcludeBuffers)continue;let f=h.findChild(0,h.buffer.length,e,s-u,n);if(f>-1)return new pn(new hD(o,h,t,u),null,f)}else if(r&ze.IncludeAnonymous||!h.type.isAnonymous||e1(h)){let f;if(!(r&ze.IgnoreMounts)&&(f=Yf.get(h))&&!f.overlay)return new ji(f.tree,u,t,o);let d=new ji(h,u,t,o);return r&ze.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(e<0?h.children.length-1:0,e,s,n)}}}if(r&ze.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?t=o.index+e:t=e<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,s=0){let n;if(!(s&ze.IgnoreOverlays)&&(n=Yf.get(this._tree))&&n.overlay){let r=t-this.from;for(let{from:o,to:a}of n.overlay)if((e>0?o<=r:o<r)&&(e<0?a>=r:a>r))return new ji(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,s)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Lv(i,t,e,s){let n=i.cursor(),r=[];if(!n.firstChild())return r;if(e!=null){for(let o=!1;!o;)if(o=n.type.is(e),!n.nextSibling())return r}for(;;){if(s!=null&&n.type.is(s))return r;if(n.type.is(t)&&r.push(n.node),!n.nextSibling())return s==null?r:[]}}function e0(i,t,e=t.length-1){for(let s=i;e>=0;s=s.parent){if(!s)return!1;if(!s.type.isAnonymous){if(t[e]&&t[e]!=s.name)return!1;e--}}return!0}class hD{constructor(t,e,s,n){this.parent=t,this.buffer=e,this.index=s,this.start=n}}class pn extends qk{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,s){super(),this.context=t,this._parent=e,this.index=s,this.type=t.buffer.set.types[t.buffer.buffer[s]]}child(t,e,s){let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,s);return r<0?null:new pn(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,s=0){if(s&ze.ExcludeBuffers)return null;let{buffer:n}=this.context,r=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return r<0?null:new pn(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new pn(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new pn(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:s}=this.context,n=this.index+4,r=s.buffer[this.index+3];if(r>n){let o=s.buffer[this.index+1];t.push(s.slice(n,r,o)),e.push(0)}return new Ve(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Xk(i){if(!i.length)return null;let t=0,e=i[0];for(let r=1;r<i.length;r++){let o=i[r];(o.from>e.from||o.to<e.to)&&(e=o,t=r)}let s=e instanceof ji&&e.index<0?null:e.parent,n=i.slice();return s?n[t]=s:n.splice(t,1),new uD(n,e)}class uD{constructor(t,e){this.heads=t,this.node=e}get next(){return Xk(this.heads)}}function fD(i,t,e){let s=i.resolveInner(t,e),n=null;for(let r=s instanceof ji?s:s.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(n||(n=[s])).push(o.resolve(t,e)),r=o}else{let o=Yf.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=t&&o.overlay[o.overlay.length-1].to>=t){let a=new ji(o.tree,o.overlay[0].from+r.from,-1,r);(n||(n=[s])).push(Zc(a,t,e,!1))}}return n?Xk(n):s}class i0{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof ji)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let s=t._parent;s;s=s._parent)this.stack.unshift(s.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:s,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=s+n.buffer[t+1],this.to=s+n.buffer[t+2],!0}yield(t){return t?t instanceof ji?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,s){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,s,this.mode));let{buffer:n}=this.buffer,r=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,s);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,s=this.mode){return this.buffer?s&ze.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,s))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ze.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&ze.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,s=this.stack.length-1;if(t<0){let n=s<0?0:this.stack[s]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(s<0?e.buffer.length:e.buffer[this.stack[s]+3]))return this.yieldBuf(n)}return s<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,s,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(n.buffer.buffer[r+3]<this.index)return!1;({index:e,parent:s}=n)}else({index:e,_parent:s}=this._tree);for(;s;{index:e,_parent:s}=s)if(e>-1)for(let r=e+t,o=t<0?-1:s._tree.children.length;r!=o;r+=t){let a=s._tree.children[r];if(this.mode&ze.IncludeAnonymous||a instanceof Yr||!a.type.isAnonymous||e1(a))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,s=0;if(t&&t.context==this.buffer)t:for(let n=this.index,r=this.stack.length;r>=0;){for(let o=t;o;o=o._parent)if(o.index==n){if(n==this.index)return o;e=o,s=r+1;break t}n=this.stack[--r]}for(let n=s;n<this.stack.length;n++)e=new pn(this.buffer,e,this.stack[n]);return this.bufferNode=new pn(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let s=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){s++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!s)return;if(this.nextSibling())break;this.parent(),s--,n=!0}}}matchContext(t){if(!this.buffer)return e0(this.node.parent,t);let{buffer:e}=this.buffer,{types:s}=e.set;for(let n=t.length-1,r=this.stack.length-1;n>=0;r--){if(r<0)return e0(this._tree,t,n);let o=s[e.buffer[this.stack[r]]];if(!o.isAnonymous){if(t[n]&&t[n]!=o.name)return!1;n--}}return!0}}function e1(i){return i.children.some(t=>t instanceof Yr||!t.type.isAnonymous||e1(t))}function dD(i){var t;let{buffer:e,nodeSet:s,maxBufferLength:n=Fk,reused:r=[],minRepeatType:o=s.types.length}=i,a=Array.isArray(e)?new t1(e,e.length):e,l=s.types,c=0,h=0;function u(y,_,S,k,A,M){let{id:R,start:C,end:$,size:N}=a,L=h,I=c;for(;N<0;)if(a.next(),N==-1){let K=r[R];S.push(K),k.push(C-y);return}else if(N==-3){c=R;return}else if(N==-4){h=R;return}else throw new RangeError(`Unrecognized record size: ${N}`);let Z=l[R],F,z,et=C-y;if($-C<=n&&(z=m(a.pos-_,A))){let K=new Uint16Array(z.size-z.skip),ot=a.pos-z.size,Mt=K.length;for(;a.pos>ot;)Mt=O(z.start,K,Mt);F=new Yr(K,$-z.start,s),et=z.start-y}else{let K=a.pos-N;a.next();let ot=[],Mt=[],jt=R>=o?R:-1,yt=0,wt=$;for(;a.pos>K;)jt>=0&&a.id==jt&&a.size>=0?(a.end<=wt-n&&(p(ot,Mt,C,yt,a.end,wt,jt,L,I),yt=ot.length,wt=a.end),a.next()):M>2500?f(C,K,ot,Mt):u(C,K,ot,Mt,jt,M+1);if(jt>=0&&yt>0&&yt<ot.length&&p(ot,Mt,C,yt,C,wt,jt,L,I),ot.reverse(),Mt.reverse(),jt>-1&&yt>0){let Ut=d(Z,I);F=i1(Z,ot,Mt,0,ot.length,0,$-C,Ut,Ut)}else F=g(Z,ot,Mt,$-C,L-$,I)}S.push(F),k.push(et)}function f(y,_,S,k){let A=[],M=0,R=-1;for(;a.pos>_;){let{id:C,start:$,end:N,size:L}=a;if(L>4)a.next();else{if(R>-1&&$<R)break;R<0&&(R=N-n),A.push(C,$,N),M++,a.next()}}if(M){let C=new Uint16Array(M*4),$=A[A.length-2];for(let N=A.length-3,L=0;N>=0;N-=3)C[L++]=A[N],C[L++]=A[N+1]-$,C[L++]=A[N+2]-$,C[L++]=L;S.push(new Yr(C,A[2]-$,s)),k.push($-y)}}function d(y,_){return(S,k,A)=>{let M=0,R=S.length-1,C,$;if(R>=0&&(C=S[R])instanceof Ve){if(!R&&C.type==y&&C.length==A)return C;($=C.prop(Dt.lookAhead))&&(M=k[R]+C.length+$)}return g(y,S,k,A,M,_)}}function p(y,_,S,k,A,M,R,C,$){let N=[],L=[];for(;y.length>k;)N.push(y.pop()),L.push(_.pop()+S-A);y.push(g(s.types[R],N,L,M-A,C-M,$)),_.push(A-S)}function g(y,_,S,k,A,M,R){if(M){let C=[Dt.contextHash,M];R=R?[C].concat(R):[C]}if(A>25){let C=[Dt.lookAhead,A];R=R?[C].concat(R):[C]}return new Ve(y,_,S,k,R)}function m(y,_){let S=a.fork(),k=0,A=0,M=0,R=S.end-n,C={size:0,start:0,skip:0};t:for(let $=S.pos-y;S.pos>$;){let N=S.size;if(S.id==_&&N>=0){C.size=k,C.start=A,C.skip=M,M+=4,k+=4,S.next();continue}let L=S.pos-N;if(N<0||L<$||S.start<R)break;let I=S.id>=o?4:0,Z=S.start;for(S.next();S.pos>L;){if(S.size<0)if(S.size==-3)I+=4;else break t;else S.id>=o&&(I+=4);S.next()}A=Z,k+=N,M+=I}return(_<0||k==y)&&(C.size=k,C.start=A,C.skip=M),C.size>4?C:void 0}function O(y,_,S){let{id:k,start:A,end:M,size:R}=a;if(a.next(),R>=0&&k<o){let C=S;if(R>4){let $=a.pos-(R-4);for(;a.pos>$;)S=O(y,_,S)}_[--S]=C,_[--S]=M-y,_[--S]=A-y,_[--S]=k}else R==-3?c=k:R==-4&&(h=k);return S}let b=[],x=[];for(;a.pos>0;)u(i.start||0,i.bufferStart||0,b,x,-1,0);let v=(t=i.length)!==null&&t!==void 0?t:b.length?x[0]+b[0].length:0;return new Ve(l[i.topID],b.reverse(),x.reverse(),v)}const Vv=new WeakMap;function of(i,t){if(!i.isAnonymous||t instanceof Yr||t.type!=i)return 1;let e=Vv.get(t);if(e==null){e=1;for(let s of t.children){if(s.type!=i||!(s instanceof Ve)){e=1;break}e+=of(i,s)}Vv.set(t,e)}return e}function i1(i,t,e,s,n,r,o,a,l){let c=0;for(let p=s;p<n;p++)c+=of(i,t[p]);let h=Math.ceil(c*1.5/8),u=[],f=[];function d(p,g,m,O,b){for(let x=m;x<O;){let v=x,y=g[x],_=of(i,p[x]);for(x++;x<O;x++){let S=of(i,p[x]);if(_+S>=h)break;_+=S}if(x==v+1){if(_>h){let S=p[v];d(S.children,S.positions,0,S.children.length,g[v]+b);continue}u.push(p[v])}else{let S=g[x-1]+p[x-1].length-y;u.push(i1(i,p,g,v,x,y,S,null,l))}f.push(y+b-r)}}return d(t,e,s,n,0),(a||l)(u,f,o)}class pD{constructor(){this.map=new WeakMap}setBuffer(t,e,s){let n=this.map.get(t);n||this.map.set(t,n=new Map),n.set(e,s)}getBuffer(t,e){let s=this.map.get(t);return s&&s.get(e)}set(t,e){t instanceof pn?this.setBuffer(t.context.buffer,t.index,e):t instanceof ji&&this.map.set(t.tree,e)}get(t){return t instanceof pn?this.getBuffer(t.context.buffer,t.index):t instanceof ji?this.map.get(t.tree):void 0}cursorSet(t,e){t.buffer?this.setBuffer(t.buffer.buffer,t.index,e):this.map.set(t.tree,e)}cursorGet(t){return t.buffer?this.getBuffer(t.buffer.buffer,t.index):this.map.get(t.tree)}}class Co{constructor(t,e,s,n,r=!1,o=!1){this.from=t,this.to=e,this.tree=s,this.offset=n,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],s=!1){let n=[new Co(0,t.length,t,0,!1,s)];for(let r of e)r.to>t.length&&n.push(r);return n}static applyChanges(t,e,s=128){if(!e.length)return t;let n=[],r=1,o=t.length?t[0]:null;for(let a=0,l=0,c=0;;a++){let h=a<e.length?e[a]:null,u=h?h.fromA:1e9;if(u-l>=s)for(;o&&o.from<u;){let f=o;if(l>=f.from||u<=f.to||c){let d=Math.max(f.from,l)-c,p=Math.min(f.to,u)-c;f=d>=p?null:new Co(d,p,f.tree,f.offset+c,a>0,!!h)}if(f&&n.push(f),o.to>u)break;o=r<t.length?t[r++]:null}if(!h)break;l=h.toA,c=h.toA-h.toB}return n}}let zk=class{startParse(t,e,s){return typeof t=="string"&&(t=new gD(t)),s=s?s.length?s.map(n=>new cg(n.from,n.to)):[new cg(0,0)]:[new cg(0,t.length)],this.createParse(t,e||[],s)}parse(t,e,s){let n=this.startParse(t,e,s);for(;;){let r=n.advance();if(r)return r}}};class gD{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new Dt({perNode:!0});let mD=0;class gs{constructor(t,e,s,n){this.name=t,this.set=e,this.base=s,this.modified=n,this.id=mD++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let s=typeof t=="string"?t:"?";if(t instanceof gs&&(e=t),e?.base)throw new Error("Can not derive from a modified tag");let n=new gs(s,[],null,[]);if(n.set.push(n),e)for(let r of e.set)n.set.push(r);return n}static defineModifier(t){let e=new Uf(t);return s=>s.modified.indexOf(e)>-1?s:Uf.get(s.base||s,s.modified.concat(e).sort((n,r)=>n.id-r.id))}}let OD=0;class Uf{constructor(t){this.name=t,this.instances=[],this.id=OD++}static get(t,e){if(!e.length)return t;let s=e[0].instances.find(a=>a.base==t&&yD(e,a.modified));if(s)return s;let n=[],r=new gs(t.name,n,t,e);for(let a of e)a.instances.push(r);let o=bD(e);for(let a of t.set)if(!a.modified.length)for(let l of o)n.push(Uf.get(a,l));return r}}function yD(i,t){return i.length==t.length&&i.every((e,s)=>e==t[s])}function bD(i){let t=[[]];for(let e=0;e<i.length;e++)for(let s=0,n=t.length;s<n;s++)t.push(t[s].concat(i[e]));return t.sort((e,s)=>s.length-e.length)}function jk(i){let t=Object.create(null);for(let e in i){let s=i[e];Array.isArray(s)||(s=[s]);for(let n of e.split(" "))if(n){let r=[],o=2,a=n;for(let u=0;;){if(a=="..."&&u>0&&u+3==n.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+n);if(r.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),u+=f[0].length,u==n.length)break;let d=n[u++];if(u==n.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+n);a=n.slice(u)}let l=r.length-1,c=r[l];if(!c)throw new RangeError("Invalid path: "+n);let h=new Hf(s,o,l>0?r.slice(0,l):null);t[c]=h.sort(t[c])}}return Gk.add(t)}const Gk=new Dt;class Hf{constructor(t,e,s,n){this.tags=t,this.mode=e,this.context=s,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}Hf.empty=new Hf([],2,null);function Yk(i,t){let e=Object.create(null);for(let r of i)if(!Array.isArray(r.tag))e[r.tag.id]=r.class;else for(let o of r.tag)e[o.id]=r.class;let{scope:s,all:n=null}=t||{};return{style:r=>{let o=n;for(let a of r)for(let l of a.set){let c=e[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:s}}function vD(i,t){let e=null;for(let s of i){let n=s.style(t);n&&(e=e?e+" "+n:n)}return e}function _D(i,t,e,s=0,n=i.length){let r=new xD(s,Array.isArray(t)?t:[t],e);r.highlightRange(i.cursor(),s,n,"",r.highlighters),r.flush(n)}class xD{constructor(t,e,s){this.at=t,this.highlighters=e,this.span=s,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,s,n,r){let{type:o,from:a,to:l}=t;if(a>=s||l<=e)return;o.isTop&&(r=this.highlighters.filter(d=>!d.scope||d.scope(o)));let c=n,h=SD(t)||Hf.empty,u=vD(r,h.tags);if(u&&(c&&(c+=" "),c+=u,h.mode==1&&(n+=(n?" ":"")+u)),this.startSpan(Math.max(e,a),c),h.opaque)return;let f=t.tree&&t.tree.prop(Dt.mounted);if(f&&f.overlay){let d=t.node.enter(f.overlay[0].from+a,1),p=this.highlighters.filter(m=>!m.scope||m.scope(f.tree.type)),g=t.firstChild();for(let m=0,O=a;;m++){let b=m<f.overlay.length?f.overlay[m]:null,x=b?b.from+a:l,v=Math.max(e,O),y=Math.min(s,x);if(v<y&&g)for(;t.from<y&&(this.highlightRange(t,v,y,n,r),this.startSpan(Math.min(y,t.to),c),!(t.to>=x||!t.nextSibling())););if(!b||x>s)break;O=b.to+a,O>e&&(this.highlightRange(d.cursor(),Math.max(e,b.from+a),Math.min(s,O),"",p),this.startSpan(Math.min(s,O),c))}g&&t.parent()}else if(t.firstChild()){f&&(n="");do if(!(t.to<=e)){if(t.from>=s)break;this.highlightRange(t,e,s,n,r),this.startSpan(Math.min(s,t.to),c)}while(t.nextSibling());t.parent()}}}function SD(i){let t=i.type.prop(Gk);for(;t&&t.context&&!i.matchContext(t.context);)t=t.next;return t||null}const lt=gs.define,Ru=lt(),Sr=lt(),Bv=lt(Sr),Zv=lt(Sr),wr=lt(),Qu=lt(wr),hg=lt(wr),on=lt(),uo=lt(on),nn=lt(),rn=lt(),s0=lt(),Dl=lt(s0),Iu=lt(),E={comment:Ru,lineComment:lt(Ru),blockComment:lt(Ru),docComment:lt(Ru),name:Sr,variableName:lt(Sr),typeName:Bv,tagName:lt(Bv),propertyName:Zv,attributeName:lt(Zv),className:lt(Sr),labelName:lt(Sr),namespace:lt(Sr),macroName:lt(Sr),literal:wr,string:Qu,docString:lt(Qu),character:lt(Qu),attributeValue:lt(Qu),number:hg,integer:lt(hg),float:lt(hg),bool:lt(wr),regexp:lt(wr),escape:lt(wr),color:lt(wr),url:lt(wr),keyword:nn,self:lt(nn),null:lt(nn),atom:lt(nn),unit:lt(nn),modifier:lt(nn),operatorKeyword:lt(nn),controlKeyword:lt(nn),definitionKeyword:lt(nn),moduleKeyword:lt(nn),operator:rn,derefOperator:lt(rn),arithmeticOperator:lt(rn),logicOperator:lt(rn),bitwiseOperator:lt(rn),compareOperator:lt(rn),updateOperator:lt(rn),definitionOperator:lt(rn),typeOperator:lt(rn),controlOperator:lt(rn),punctuation:s0,separator:lt(s0),bracket:Dl,angleBracket:lt(Dl),squareBracket:lt(Dl),paren:lt(Dl),brace:lt(Dl),content:on,heading:uo,heading1:lt(uo),heading2:lt(uo),heading3:lt(uo),heading4:lt(uo),heading5:lt(uo),heading6:lt(uo),contentSeparator:lt(on),list:lt(on),quote:lt(on),emphasis:lt(on),strong:lt(on),link:lt(on),monospace:lt(on),strikethrough:lt(on),inserted:lt(),deleted:lt(),changed:lt(),invalid:lt(),meta:Iu,documentMeta:lt(Iu),annotation:lt(Iu),processingInstruction:lt(Iu),definition:gs.defineModifier("definition"),constant:gs.defineModifier("constant"),function:gs.defineModifier("function"),standard:gs.defineModifier("standard"),local:gs.defineModifier("local"),special:gs.defineModifier("special")};for(let i in E){let t=E[i];t instanceof gs&&(t.name=i)}Yk([{tag:E.link,class:"tok-link"},{tag:E.heading,class:"tok-heading"},{tag:E.emphasis,class:"tok-emphasis"},{tag:E.strong,class:"tok-strong"},{tag:E.keyword,class:"tok-keyword"},{tag:E.atom,class:"tok-atom"},{tag:E.bool,class:"tok-bool"},{tag:E.url,class:"tok-url"},{tag:E.labelName,class:"tok-labelName"},{tag:E.inserted,class:"tok-inserted"},{tag:E.deleted,class:"tok-deleted"},{tag:E.literal,class:"tok-literal"},{tag:E.string,class:"tok-string"},{tag:E.number,class:"tok-number"},{tag:[E.regexp,E.escape,E.special(E.string)],class:"tok-string2"},{tag:E.variableName,class:"tok-variableName"},{tag:E.local(E.variableName),class:"tok-variableName tok-local"},{tag:E.definition(E.variableName),class:"tok-variableName tok-definition"},{tag:E.special(E.variableName),class:"tok-variableName2"},{tag:E.definition(E.propertyName),class:"tok-propertyName tok-definition"},{tag:E.typeName,class:"tok-typeName"},{tag:E.namespace,class:"tok-namespace"},{tag:E.className,class:"tok-className"},{tag:E.macroName,class:"tok-macroName"},{tag:E.propertyName,class:"tok-propertyName"},{tag:E.operator,class:"tok-operator"},{tag:E.comment,class:"tok-comment"},{tag:E.meta,class:"tok-meta"},{tag:E.invalid,class:"tok-invalid"},{tag:E.punctuation,class:"tok-punctuation"}]);var ug;const ya=new Dt;function Uk(i){return ft.define({combine:i?t=>t.concat(i):void 0})}const s1=new Dt;class Ns{constructor(t,e,s=[],n=""){this.data=t,this.name=n,Vt.prototype.hasOwnProperty("tree")||Object.defineProperty(Vt.prototype,"tree",{get(){return Ge(this)}}),this.parser=e,this.extension=[Ur.of(this),Vt.languageData.of((r,o,a)=>{let l=Fv(r,o,a),c=l.type.prop(ya);if(!c)return[];let h=r.facet(c),u=l.type.prop(s1);if(u){let f=l.resolve(o-l.from,a);for(let d of u)if(d.test(f,r)){let p=r.facet(d.facet);return d.type=="replace"?p:p.concat(h)}}return h})].concat(s)}isActiveAt(t,e,s=-1){return Fv(t,e,s).type.prop(ya)==this.data}findRegions(t){let e=t.facet(Ur);if(e?.data==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let s=[],n=(r,o)=>{if(r.prop(ya)==this.data){s.push({from:o,to:o+r.length});return}let a=r.prop(Dt.mounted);if(a){if(a.tree.prop(ya)==this.data){if(a.overlay)for(let l of a.overlay)s.push({from:l.from+o,to:l.to+o});else s.push({from:o,to:o+r.length});return}else if(a.overlay){let l=s.length;if(n(a.tree,a.overlay[0].from+o),s.length>l)return}}for(let l=0;l<r.children.length;l++){let c=r.children[l];c instanceof Ve&&n(c,r.positions[l]+o)}};return n(Ge(t),0),s}get allowsNesting(){return!0}}Ns.setState=Et.define();function Fv(i,t,e){let s=i.facet(Ur),n=Ge(i).topNode;if(!s||s.allowsNesting)for(let r=n;r;r=r.enter(t,e,ze.ExcludeBuffers))r.type.isTop&&(n=r);return n}class Kf extends Ns{constructor(t,e,s){super(t,e,[],s),this.parser=e}static define(t){let e=Uk(t.languageData);return new Kf(e,t.parser.configure({props:[ya.add(s=>s.isTop?e:void 0)]}),t.name)}configure(t,e){return new Kf(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ge(i){let t=i.field(Ns.state,!1);return t?t.tree:Ve.empty}class wD{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let s=this.cursorPos-this.string.length;return t<s||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-s,e-s)}}let Ll=null;class Jf{constructor(t,e,s=[],n,r,o,a,l){this.parser=t,this.state=e,this.fragments=s,this.tree=n,this.treeLen=r,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,s){return new Jf(t,e,[],Ve.empty,0,s,[],null)}startParse(){return this.parser.startParse(new wD(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=Ve.empty&&this.isDone(e??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var s;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(Co.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(s=this.parse.stoppedAt)!==null&&s!==void 0?s:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e??this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(Co.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=Ll;Ll=this;try{return t()}finally{Ll=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Wv(t,e.from,e.to);return t}changes(t,e){let{fragments:s,tree:n,treeLen:r,viewport:o,skipped:a}=this;if(this.takeTree(),!t.empty){let l=[];if(t.iterChangedRanges((c,h,u,f)=>l.push({fromA:c,toA:h,fromB:u,toB:f})),s=Co.applyChanges(s,l),n=Ve.empty,r=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let h=t.mapPos(c.from,1),u=t.mapPos(c.to,-1);h<u&&a.push({from:h,to:u})}}}return new Jf(this.parser,e,s,n,r,o,a,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let s=0;s<this.skipped.length;s++){let{from:n,to:r}=this.skipped[s];n<t.to&&r>t.from&&(this.fragments=Wv(this.fragments,n,r),this.skipped.splice(s--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends zk{createParse(e,s,n){let r=n[0].from,o=n[n.length-1].to;return{parsedPos:r,advance(){let l=Ll;if(l){for(let c of n)l.tempSkipped.push(c);t&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,t]):t)}return this.parsedPos=o,new Ve(Yi.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return Ll}}function Wv(i,t,e){return Co.applyChanges(i,[{fromA:t,toA:e,fromB:t,toB:e}])}class ja{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),s=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,s)||e.takeTree(),new ja(e)}static init(t){let e=Math.min(3e3,t.doc.length),s=Jf.create(t.facet(Ur).parser,t,{from:0,to:e});return s.work(20,e)||s.takeTree(),new ja(s)}}Ns.state=Je.define({create:ja.init,update(i,t){for(let e of t.effects)if(e.is(Ns.setState))return e.value;return t.startState.facet(Ur)!=t.state.facet(Ur)?ja.init(t.state):i.apply(t)}});let Hk=i=>{let t=setTimeout(()=>i(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(Hk=i=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(i,{timeout:400})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const fg=typeof navigator<"u"&&(!((ug=navigator.scheduling)===null||ug===void 0)&&ug.isInputPending)?()=>navigator.scheduling.isInputPending():null,kD=Me.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Ns.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Ns.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=Hk(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:s,viewport:{to:n}}=this.view,r=s.field(Ns.state);if(r.tree==r.context.tree&&r.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!fg?Math.max(25,t.timeRemaining()-5):1e9),a=r.context.treeLen<n&&s.doc.length>n+1e3,l=r.context.work(()=>fg&&fg()||Date.now()>o,n+(a?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Ns.setState.of(new ja(r.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>qi(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ur=ft.define({combine(i){return i.length?i[0]:null},enables:i=>[Ns.state,kD,ht.contentAttributes.compute([i],t=>{let e=t.facet(i);return e&&e.name?{"data-language":e.name}:{}})]});class CD{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const TD=ft.define(),Ch=ft.define({combine:i=>{if(!i.length)return"  ";let t=i[0];if(!t||/\S/.test(t)||Array.from(t).some(e=>e!=t[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return t}});function td(i){let t=i.facet(Ch);return t.charCodeAt(0)==9?i.tabSize*t.length:t.length}function Fc(i,t){let e="",s=i.tabSize,n=i.facet(Ch)[0];if(n=="	"){for(;t>=s;)e+="	",t-=s;n=" "}for(let r=0;r<t;r++)e+=n;return e}function n1(i,t){i instanceof Vt&&(i=new ap(i));for(let s of i.state.facet(TD)){let n=s(i,t);if(n!==void 0)return n}let e=Ge(i.state);return e.length>=t?PD(i,e,t):null}class ap{constructor(t,e={}){this.state=t,this.options=e,this.unit=td(t)}lineAt(t,e=1){let s=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:r}=this.options;return n!=null&&n>=s.from&&n<=s.to?r&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:s.text.slice(n-s.from),from:n}:{text:s.text.slice(0,n-s.from),from:s.from}:s}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:s,from:n}=this.lineAt(t,e);return s.slice(t-n,Math.min(s.length,t+100-n))}column(t,e=1){let{text:s,from:n}=this.lineAt(t,e),r=this.countColumn(s,t-n),o=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return o>-1&&(r+=o-this.countColumn(s,s.search(/\S|$/))),r}countColumn(t,e=t.length){return ol(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:s,from:n}=this.lineAt(t,e),r=this.options.overrideIndentation;if(r){let o=r(n);if(o>-1)return o}return this.countColumn(s,s.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Kk=new Dt;function PD(i,t,e){let s=t.resolveStack(e),n=t.resolveInner(e,-1).resolve(e,0).enterUnfinishedNodesBefore(e);if(n!=s.node){let r=[];for(let o=n;o&&!(o.from<s.node.from||o.to>s.node.to||o.from==s.node.from&&o.type==s.node.type);o=o.parent)r.push(o);for(let o=r.length-1;o>=0;o--)s={node:r[o],next:s}}return Jk(s,i,e)}function Jk(i,t,e){for(let s=i;s;s=s.next){let n=MD(s.node);if(n)return n(r1.create(t,e,s))}return 0}function AD(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function MD(i){let t=i.type.prop(Kk);if(t)return t;let e=i.firstChild,s;if(e&&(s=e.type.prop(Dt.closedBy))){let n=i.lastChild,r=n&&s.indexOf(n.name)>-1;return o=>t5(o,!0,1,void 0,r&&!AD(o)?n.from:void 0)}return i.parent==null?ED:null}function ED(){return 0}class r1 extends ap{constructor(t,e,s){super(t.state,t.options),this.base=t,this.pos=e,this.context=s}get node(){return this.context.node}static create(t,e,s){return new r1(t,e,s)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let s=t.resolve(e.from);for(;s.parent&&s.parent.from==s.from;)s=s.parent;if(RD(s,t))break;e=this.state.doc.lineAt(s.from)}return this.lineIndent(e.from)}continue(){return Jk(this.context.next,this.base,this.pos)}}function RD(i,t){for(let e=t;e;e=e.parent)if(i==e)return!0;return!1}function QD(i){let t=i.node,e=t.childAfter(t.from),s=t.lastChild;if(!e)return null;let n=i.options.simulateBreak,r=i.state.doc.lineAt(e.from),o=n==null||n<=r.from?r.to:Math.min(r.to,n);for(let a=e.to;;){let l=t.childAfter(a);if(!l||l==s)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(r.text.slice(e.to-r.from))[0].length;return{from:e.from,to:e.to+c}}a=l.to}}function ID({closing:i,align:t=!0,units:e=1}){return s=>t5(s,t,e,i)}function t5(i,t,e,s,n){let r=i.textAfter,o=r.match(/^\s*/)[0].length,a=s&&r.slice(o,o+s.length)==s||n==i.pos+o,l=t?QD(i):null;return l?a?i.column(l.from):i.column(l.to):i.baseIndent+(a?0:i.unit*e)}const $D=i=>i.baseIndent;function dg({except:i,units:t=1}={}){return e=>{let s=i&&i.test(e.textAfter);return e.baseIndent+(s?0:t*e.unit)}}const ND=200;function DD(){return Vt.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let t=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!t.length)return i;let e=i.newDoc,{head:s}=i.newSelection.main,n=e.lineAt(s);if(s>n.from+ND)return i;let r=e.sliceString(n.from,s);if(!t.some(c=>c.test(r)))return i;let{state:o}=i,a=-1,l=[];for(let{head:c}of o.selection.ranges){let h=o.doc.lineAt(c);if(h.from==a)continue;a=h.from;let u=n1(o,h.from);if(u==null)continue;let f=/^\s*/.exec(h.text)[0],d=Fc(o,u);f!=d&&l.push({from:h.from,to:h.from+f.length,insert:d})}return l.length?[i,{changes:l,sequential:!0}]:i})}const LD=ft.define(),e5=new Dt;function VD(i){let t=i.firstChild,e=i.lastChild;return t&&t.to<e.from?{from:t.to,to:e.type.isError?i.to:e.from}:null}function BD(i,t,e){let s=Ge(i);if(s.length<e)return null;let n=s.resolveStack(e,1),r=null;for(let o=n;o;o=o.next){let a=o.node;if(a.to<=e||a.from>e)continue;if(r&&a.from<t)break;let l=a.type.prop(e5);if(l&&(a.to<s.length-50||s.length==i.doc.length||!ZD(a))){let c=l(a,i);c&&c.from<=e&&c.from>=t&&c.to>e&&(r=c)}}return r}function ZD(i){let t=i.lastChild;return t&&t.to==i.to&&t.type.isError}function ed(i,t,e){for(let s of i.facet(LD)){let n=s(i,t,e);if(n)return n}return BD(i,t,e)}function i5(i,t){let e=t.mapPos(i.from,1),s=t.mapPos(i.to,-1);return e>=s?void 0:{from:e,to:s}}const lp=Et.define({map:i5}),Th=Et.define({map:i5});function s5(i){let t=[];for(let{head:e}of i.state.selection.ranges)t.some(s=>s.from<=e&&s.to>=e)||t.push(i.lineBlockAt(e));return t}const Do=Je.define({create(){return vt.none},update(i,t){t.isUserEvent("delete")&&t.changes.iterChangedRanges((e,s)=>i=qv(i,e,s)),i=i.map(t.changes);for(let e of t.effects)if(e.is(lp)&&!FD(i,e.value.from,e.value.to)){let{preparePlaceholder:s}=t.state.facet(o5),n=s?vt.replace({widget:new YD(s(t.state,e.value))}):Xv;i=i.update({add:[n.range(e.value.from,e.value.to)]})}else e.is(Th)&&(i=i.update({filter:(s,n)=>e.value.from!=s||e.value.to!=n,filterFrom:e.value.from,filterTo:e.value.to}));return t.selection&&(i=qv(i,t.selection.main.head)),i},provide:i=>ht.decorations.from(i),toJSON(i,t){let e=[];return i.between(0,t.doc.length,(s,n)=>{e.push(s,n)}),e},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<i.length;){let s=i[e++],n=i[e++];if(typeof s!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");t.push(Xv.range(s,n))}return vt.set(t,!0)}});function qv(i,t,e=t){let s=!1;return i.between(t,e,(n,r)=>{n<e&&r>t&&(s=!0)}),s?i.update({filterFrom:t,filterTo:e,filter:(n,r)=>n>=e||r<=t}):i}function id(i,t,e){var s;let n=null;return(s=i.field(Do,!1))===null||s===void 0||s.between(t,e,(r,o)=>{(!n||n.from>r)&&(n={from:r,to:o})}),n}function FD(i,t,e){let s=!1;return i.between(t,t,(n,r)=>{n==t&&r==e&&(s=!0)}),s}function n5(i,t){return i.field(Do,!1)?t:t.concat(Et.appendConfig.of(a5()))}const WD=i=>{for(let t of s5(i)){let e=ed(i.state,t.from,t.to);if(e)return i.dispatch({effects:n5(i.state,[lp.of(e),r5(i,e)])}),!0}return!1},qD=i=>{if(!i.state.field(Do,!1))return!1;let t=[];for(let e of s5(i)){let s=id(i.state,e.from,e.to);s&&t.push(Th.of(s),r5(i,s,!1))}return t.length&&i.dispatch({effects:t}),t.length>0};function r5(i,t,e=!0){let s=i.state.doc.lineAt(t.from).number,n=i.state.doc.lineAt(t.to).number;return ht.announce.of(`${i.state.phrase(e?"Folded lines":"Unfolded lines")} ${s} ${i.state.phrase("to")} ${n}.`)}const XD=i=>{let{state:t}=i,e=[];for(let s=0;s<t.doc.length;){let n=i.lineBlockAt(s),r=ed(t,n.from,n.to);r&&e.push(lp.of(r)),s=(r?i.lineBlockAt(r.to):n).to+1}return e.length&&i.dispatch({effects:n5(i.state,e)}),!!e.length},zD=i=>{let t=i.state.field(Do,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,i.state.doc.length,(s,n)=>{e.push(Th.of({from:s,to:n}))}),i.dispatch({effects:e}),!0},jD=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:WD},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:qD},{key:"Ctrl-Alt-[",run:XD},{key:"Ctrl-Alt-]",run:zD}],GD={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},o5=ft.define({combine(i){return An(i,GD)}});function a5(i){return[Do,KD]}function l5(i,t){let{state:e}=i,s=e.facet(o5),n=o=>{let a=i.lineBlockAt(i.posAtDOM(o.target)),l=id(i.state,a.from,a.to);l&&i.dispatch({effects:Th.of(l)}),o.preventDefault()};if(s.placeholderDOM)return s.placeholderDOM(i,n,t);let r=document.createElement("span");return r.textContent=s.placeholderText,r.setAttribute("aria-label",e.phrase("folded code")),r.title=e.phrase("unfold"),r.className="cm-foldPlaceholder",r.onclick=n,r}const Xv=vt.replace({widget:new class extends Mn{toDOM(i){return l5(i,null)}}});class YD extends Mn{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return l5(t,this.value)}}const UD={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class pg extends er{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function HD(i={}){let t={...UD,...i},e=new pg(t,!0),s=new pg(t,!1),n=Me.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Ur)!=o.state.facet(Ur)||o.startState.field(Do,!1)!=o.state.field(Do,!1)||Ge(o.startState)!=Ge(o.state)||t.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new Jn;for(let l of o.viewportLineBlocks){let c=id(o.state,l.from,l.to)?s:ed(o.state,l.from,l.to)?e:null;c&&a.add(l.from,l.from,c)}return a.finish()}}),{domEventHandlers:r}=t;return[n,HN({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(n))===null||a===void 0?void 0:a.markers)||zt.empty},initialSpacer(){return new pg(t,!1)},domEventHandlers:{...r,click:(o,a,l)=>{if(r.click&&r.click(o,a,l))return!0;let c=id(o.state,a.from,a.to);if(c)return o.dispatch({effects:Th.of(c)}),!0;let h=ed(o.state,a.from,a.to);return h?(o.dispatch({effects:lp.of(h)}),!0):!1}}}),a5()]}const KD=ht.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ph{constructor(t,e){this.specs=t;let s;function n(a){let l=zr.newName();return(s||(s=Object.create(null)))["."+l]=a,l}const r=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,o=e.scope;this.scope=o instanceof Ns?a=>a.prop(ya)==o.data:o?a=>a==o:void 0,this.style=Yk(t.map(a=>({tag:a.tag,class:a.class||n(Object.assign({},a,{tag:null}))})),{all:r}).style,this.module=s?new zr(s):null,this.themeType=e.themeType}static define(t,e){return new Ph(t,e||{})}}const n0=ft.define(),c5=ft.define({combine(i){return i.length?[i[0]]:null}});function gg(i){let t=i.facet(n0);return t.length?t:i.facet(c5)}function h5(i,t){let e=[tL],s;return i instanceof Ph&&(i.module&&e.push(ht.styleModule.of(i.module)),s=i.themeType),t?.fallback?e.push(c5.of(i)):s?e.push(n0.computeN([ht.darkTheme],n=>n.facet(ht.darkTheme)==(s=="dark")?[i]:[])):e.push(n0.of(i)),e}class JD{constructor(t){this.markCache=Object.create(null),this.tree=Ge(t.state),this.decorations=this.buildDeco(t,gg(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=Ge(t.state),s=gg(t.state),n=s!=gg(t.startState),{viewport:r}=t.view,o=t.changes.mapPos(this.decoratedTo,1);e.length<r.to&&!n&&e.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=o):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,s),this.decoratedTo=r.to)}buildDeco(t,e){if(!e||!this.tree.length)return vt.none;let s=new Jn;for(let{from:n,to:r}of t.visibleRanges)_D(this.tree,e,(o,a,l)=>{s.add(o,a,this.markCache[l]||(this.markCache[l]=vt.mark({class:l})))},n,r);return s.finish()}}const tL=no.high(Me.fromClass(JD,{decorations:i=>i.decorations})),eL=Ph.define([{tag:E.meta,color:"#404740"},{tag:E.link,textDecoration:"underline"},{tag:E.heading,textDecoration:"underline",fontWeight:"bold"},{tag:E.emphasis,fontStyle:"italic"},{tag:E.strong,fontWeight:"bold"},{tag:E.strikethrough,textDecoration:"line-through"},{tag:E.keyword,color:"#708"},{tag:[E.atom,E.bool,E.url,E.contentSeparator,E.labelName],color:"#219"},{tag:[E.literal,E.inserted],color:"#164"},{tag:[E.string,E.deleted],color:"#a11"},{tag:[E.regexp,E.escape,E.special(E.string)],color:"#e40"},{tag:E.definition(E.variableName),color:"#00f"},{tag:E.local(E.variableName),color:"#30a"},{tag:[E.typeName,E.namespace],color:"#085"},{tag:E.className,color:"#167"},{tag:[E.special(E.variableName),E.macroName],color:"#256"},{tag:E.definition(E.propertyName),color:"#00c"},{tag:E.comment,color:"#940"},{tag:E.invalid,color:"#f00"}]),iL=ht.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),u5=1e4,f5="()[]{}",d5=ft.define({combine(i){return An(i,{afterCursor:!0,brackets:f5,maxScanDistance:u5,renderMatch:rL})}}),sL=vt.mark({class:"cm-matchingBracket"}),nL=vt.mark({class:"cm-nonmatchingBracket"});function rL(i){let t=[],e=i.matched?sL:nL;return t.push(e.range(i.start.from,i.start.to)),i.end&&t.push(e.range(i.end.from,i.end.to)),t}const oL=Je.define({create(){return vt.none},update(i,t){if(!t.docChanged&&!t.selection)return i;let e=[],s=t.state.facet(d5);for(let n of t.state.selection.ranges){if(!n.empty)continue;let r=gn(t.state,n.head,-1,s)||n.head>0&&gn(t.state,n.head-1,1,s)||s.afterCursor&&(gn(t.state,n.head,1,s)||n.head<t.state.doc.length&&gn(t.state,n.head+1,-1,s));r&&(e=e.concat(s.renderMatch(r,t.state)))}return vt.set(e,!0)},provide:i=>ht.decorations.from(i)}),aL=[oL,iL];function lL(i={}){return[d5.of(i),aL]}const cL=new Dt;function r0(i,t,e){let s=i.prop(t<0?Dt.openedBy:Dt.closedBy);if(s)return s;if(i.name.length==1){let n=e.indexOf(i.name);if(n>-1&&n%2==(t<0?1:0))return[e[n+t]]}return null}function o0(i){let t=i.type.prop(cL);return t?t(i.node):i}function gn(i,t,e,s={}){let n=s.maxScanDistance||u5,r=s.brackets||f5,o=Ge(i),a=o.resolveInner(t,e);for(let l=a;l;l=l.parent){let c=r0(l.type,e,r);if(c&&l.from<l.to){let h=o0(l);if(h&&(e>0?t>=h.from&&t<h.to:t>h.from&&t<=h.to))return hL(i,t,e,l,h,c,r)}}return uL(i,t,e,o,a.type,n,r)}function hL(i,t,e,s,n,r,o){let a=s.parent,l={from:n.from,to:n.to},c=0,h=a?.cursor();if(h&&(e<0?h.childBefore(s.from):h.childAfter(s.to)))do if(e<0?h.to<=s.from:h.from>=s.to){if(c==0&&r.indexOf(h.type.name)>-1&&h.from<h.to){let u=o0(h);return{start:l,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(r0(h.type,e,o))c++;else if(r0(h.type,-e,o)){if(c==0){let u=o0(h);return{start:l,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}c--}}while(e<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function uL(i,t,e,s,n,r,o){let a=e<0?i.sliceDoc(t-1,t):i.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=e>0)return null;let c={from:e<0?t-1:t,to:e>0?t+1:t},h=i.doc.iterRange(t,e>0?i.doc.length:0),u=0;for(let f=0;!h.next().done&&f<=r;){let d=h.value;e<0&&(f+=d.length);let p=t+f*e;for(let g=e>0?0:d.length-1,m=e>0?d.length:-1;g!=m;g+=e){let O=o.indexOf(d[g]);if(!(O<0||s.resolveInner(p+g,1).type!=n))if(O%2==0==e>0)u++;else{if(u==1)return{start:c,end:{from:p+g,to:p+g+1},matched:O>>1==l>>1};u--}}e>0&&(f+=d.length)}return h.done?{start:c,matched:!1}:null}const fL=Object.create(null),zv=[Yi.none],jv=[],Gv=Object.create(null),dL=Object.create(null);for(let[i,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])dL[i]=pL(fL,t);function mg(i,t){jv.indexOf(i)>-1||(jv.push(i),console.warn(t))}function pL(i,t){let e=[];for(let a of t.split(" ")){let l=[];for(let c of a.split(".")){let h=i[c]||E[c];h?typeof h=="function"?l.length?l=l.map(h):mg(c,`Modifier ${c} used at start of tag`):l.length?mg(c,`Tag ${c} used as modifier`):l=Array.isArray(h)?h:[h]:mg(c,`Unknown highlighting tag ${c}`)}for(let c of l)e.push(c)}if(!e.length)return 0;let s=t.replace(/ /g,"_"),n=s+" "+e.map(a=>a.id),r=Gv[n];if(r)return r.id;let o=Gv[n]=Yi.define({id:zv.length,name:s,props:[jk({[s]:e})]});return zv.push(o),o.id}Oe.RTL,Oe.LTR;const gL=i=>{let{state:t}=i,e=t.doc.lineAt(t.selection.main.from),s=a1(i.state,e.from);return s.line?mL(i):s.block?yL(i):!1};function o1(i,t){return({state:e,dispatch:s})=>{if(e.readOnly)return!1;let n=i(t,e);return n?(s(e.update(n)),!0):!1}}const mL=o1(_L,0),OL=o1(p5,0),yL=o1((i,t)=>p5(i,t,vL(t)),0);function a1(i,t){let e=i.languageDataAt("commentTokens",t,1);return e.length?e[0]:{}}const Vl=50;function bL(i,{open:t,close:e},s,n){let r=i.sliceDoc(s-Vl,s),o=i.sliceDoc(n,n+Vl),a=/\s*$/.exec(r)[0].length,l=/^\s*/.exec(o)[0].length,c=r.length-a;if(r.slice(c-t.length,c)==t&&o.slice(l,l+e.length)==e)return{open:{pos:s-a,margin:a&&1},close:{pos:n+l,margin:l&&1}};let h,u;n-s<=2*Vl?h=u=i.sliceDoc(s,n):(h=i.sliceDoc(s,s+Vl),u=i.sliceDoc(n-Vl,n));let f=/^\s*/.exec(h)[0].length,d=/\s*$/.exec(u)[0].length,p=u.length-d-e.length;return h.slice(f,f+t.length)==t&&u.slice(p,p+e.length)==e?{open:{pos:s+f+t.length,margin:/\s/.test(h.charAt(f+t.length))?1:0},close:{pos:n-d-e.length,margin:/\s/.test(u.charAt(p-1))?1:0}}:null}function vL(i){let t=[];for(let e of i.selection.ranges){let s=i.doc.lineAt(e.from),n=e.to<=s.to?s:i.doc.lineAt(e.to);n.from>s.from&&n.from==e.to&&(n=e.to==s.to+1?s:i.doc.lineAt(e.to-1));let r=t.length-1;r>=0&&t[r].to>s.from?t[r].to=n.to:t.push({from:s.from+/^\s*/.exec(s.text)[0].length,to:n.to})}return t}function p5(i,t,e=t.selection.ranges){let s=e.map(r=>a1(t,r.from).block);if(!s.every(r=>r))return null;let n=e.map((r,o)=>bL(t,s[o],r.from,r.to));if(i!=2&&!n.every(r=>r))return{changes:t.changes(e.map((r,o)=>n[o]?[]:[{from:r.from,insert:s[o].open+" "},{from:r.to,insert:" "+s[o].close}]))};if(i!=1&&n.some(r=>r)){let r=[];for(let o=0,a;o<n.length;o++)if(a=n[o]){let l=s[o],{open:c,close:h}=a;r.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:h.pos-h.margin,to:h.pos+l.close.length})}return{changes:r}}return null}function _L(i,t,e=t.selection.ranges){let s=[],n=-1;for(let{from:r,to:o}of e){let a=s.length,l=1e9,c=a1(t,r).line;if(c){for(let h=r;h<=o;){let u=t.doc.lineAt(h);if(u.from>n&&(r==o||o>u.from)){n=u.from;let f=/^\s*/.exec(u.text)[0].length,d=f==u.length,p=u.text.slice(f,f+c.length)==c?f:-1;f<u.text.length&&f<l&&(l=f),s.push({line:u,comment:p,token:c,indent:f,empty:d,single:!1})}h=u.to+1}if(l<1e9)for(let h=a;h<s.length;h++)s[h].indent<s[h].line.text.length&&(s[h].indent=l);s.length==a+1&&(s[a].single=!0)}}if(i!=2&&s.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:a,token:l,indent:c,empty:h,single:u}of s)(u||!h)&&r.push({from:a.from+c,insert:l+" "});let o=t.changes(r);return{changes:o,selection:t.selection.map(o,1)}}else if(i!=1&&s.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:a,token:l}of s)if(a>=0){let c=o.from+a,h=c+l.length;o.text[h-o.from]==" "&&h++,r.push({from:c,to:h})}return{changes:r}}return null}const a0=fr.define(),xL=fr.define(),SL=ft.define(),g5=ft.define({combine(i){return An(i,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(s,n)=>t(s,n)||e(s,n)})}}),m5=Je.define({create(){return mn.empty},update(i,t){let e=t.state.facet(g5),s=t.annotation(a0);if(s){let l=Xi.fromTransaction(t,s.selection),c=s.side,h=c==0?i.undone:i.done;return l?h=sd(h,h.length,e.minDepth,l):h=b5(h,t.startState.selection),new mn(c==0?s.rest:h,c==0?h:s.rest)}let n=t.annotation(xL);if((n=="full"||n=="before")&&(i=i.isolate()),t.annotation(Le.addToHistory)===!1)return t.changes.empty?i:i.addMapping(t.changes.desc);let r=Xi.fromTransaction(t),o=t.annotation(Le.time),a=t.annotation(Le.userEvent);return r?i=i.addChanges(r,o,a,e,t):t.selection&&(i=i.addSelection(t.startState.selection,o,a,e.newGroupDelay)),(n=="full"||n=="after")&&(i=i.isolate()),i},toJSON(i){return{done:i.done.map(t=>t.toJSON()),undone:i.undone.map(t=>t.toJSON())}},fromJSON(i){return new mn(i.done.map(Xi.fromJSON),i.undone.map(Xi.fromJSON))}});function wL(i={}){return[m5,g5.of(i),ht.domEventHandlers({beforeinput(t,e){let s=t.inputType=="historyUndo"?O5:t.inputType=="historyRedo"?l0:null;return s?(t.preventDefault(),s(e)):!1}})]}function cp(i,t){return function({state:e,dispatch:s}){if(!t&&e.readOnly)return!1;let n=e.field(m5,!1);if(!n)return!1;let r=n.pop(i,e,t);return r?(s(r),!0):!1}}const O5=cp(0,!1),l0=cp(1,!1),kL=cp(0,!0),CL=cp(1,!0);class Xi{constructor(t,e,s,n,r){this.changes=t,this.effects=e,this.mapped=s,this.startSelection=n,this.selectionsAfter=r}setSelAfter(t){return new Xi(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,s;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(s=this.startSelection)===null||s===void 0?void 0:s.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(t){return new Xi(t.changes&&Xe.fromJSON(t.changes),[],t.mapped&&bn.fromJSON(t.mapped),t.startSelection&&G.fromJSON(t.startSelection),t.selectionsAfter.map(G.fromJSON))}static fromTransaction(t,e){let s=vs;for(let n of t.startState.facet(SL)){let r=n(t);r.length&&(s=s.concat(r))}return!s.length&&t.changes.empty?null:new Xi(t.changes.invert(t.startState.doc),s,void 0,e||t.startState.selection,vs)}static selection(t){return new Xi(void 0,vs,void 0,void 0,t)}}function sd(i,t,e,s){let n=t+1>e+20?t-e-1:0,r=i.slice(n,t);return r.push(s),r}function TL(i,t){let e=[],s=!1;return i.iterChangedRanges((n,r)=>e.push(n,r)),t.iterChangedRanges((n,r,o,a)=>{for(let l=0;l<e.length;){let c=e[l++],h=e[l++];a>=c&&o<=h&&(s=!0)}}),s}function PL(i,t){return i.ranges.length==t.ranges.length&&i.ranges.filter((e,s)=>e.empty!=t.ranges[s].empty).length===0}function y5(i,t){return i.length?t.length?i.concat(t):i:t}const vs=[],AL=200;function b5(i,t){if(i.length){let e=i[i.length-1],s=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-AL));return s.length&&s[s.length-1].eq(t)?i:(s.push(t),sd(i,i.length-1,1e9,e.setSelAfter(s)))}else return[Xi.selection([t])]}function ML(i){let t=i[i.length-1],e=i.slice();return e[i.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function Og(i,t){if(!i.length)return i;let e=i.length,s=vs;for(;e;){let n=EL(i[e-1],t,s);if(n.changes&&!n.changes.empty||n.effects.length){let r=i.slice(0,e);return r[e-1]=n,r}else t=n.mapped,e--,s=n.selectionsAfter}return s.length?[Xi.selection(s)]:vs}function EL(i,t,e){let s=y5(i.selectionsAfter.length?i.selectionsAfter.map(a=>a.map(t)):vs,e);if(!i.changes)return Xi.selection(s);let n=i.changes.map(t),r=t.mapDesc(i.changes,!0),o=i.mapped?i.mapped.composeDesc(r):r;return new Xi(n,Et.mapEffects(i.effects,t),o,i.startSelection.map(r),s)}const RL=/^(input\.type|delete)($|\.)/;class mn{constructor(t,e,s=0,n=void 0){this.done=t,this.undone=e,this.prevTime=s,this.prevUserEvent=n}isolate(){return this.prevTime?new mn(this.done,this.undone):this}addChanges(t,e,s,n,r){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&t.changes&&(!s||RL.test(s))&&(!a.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(r,TL(a.changes,t.changes))||s=="input.type.compose")?o=sd(o,o.length-1,n.minDepth,new Xi(t.changes.compose(a.changes),y5(Et.mapEffects(t.effects,a.changes),a.effects),a.mapped,a.startSelection,vs)):o=sd(o,o.length,n.minDepth,t),new mn(o,vs,e,s)}addSelection(t,e,s,n){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:vs;return r.length>0&&e-this.prevTime<n&&s==this.prevUserEvent&&s&&/^select($|\.)/.test(s)&&PL(r[r.length-1],t)?this:new mn(b5(this.done,t),this.undone,e,s)}addMapping(t){return new mn(Og(this.done,t),Og(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,s){let n=t==0?this.done:this.undone;if(n.length==0)return null;let r=n[n.length-1],o=r.selectionsAfter[0]||e.selection;if(s&&r.selectionsAfter.length)return e.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:a0.of({side:t,rest:ML(n),selection:o}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let a=n.length==1?vs:n.slice(0,n.length-1);return r.mapped&&(a=Og(a,r.mapped)),e.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:a0.of({side:t,rest:a,selection:o}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}mn.empty=new mn(vs,vs);const QL=[{key:"Mod-z",run:O5,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:l0,preventDefault:!0},{linux:"Ctrl-Shift-z",run:l0,preventDefault:!0},{key:"Mod-u",run:kL,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:CL,preventDefault:!0}];function al(i,t){return G.create(i.ranges.map(t),i.mainIndex)}function Ys(i,t){return i.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function Us({state:i,dispatch:t},e){let s=al(i.selection,e);return s.eq(i.selection,!0)?!1:(t(Ys(i,s)),!0)}function hp(i,t){return G.cursor(t?i.to:i.from)}function v5(i,t){return Us(i,e=>e.empty?i.moveByChar(e,t):hp(e,t))}function bi(i){return i.textDirectionAt(i.state.selection.main.head)==Oe.LTR}const _5=i=>v5(i,!bi(i)),x5=i=>v5(i,bi(i));function S5(i,t){return Us(i,e=>e.empty?i.moveByGroup(e,t):hp(e,t))}const IL=i=>S5(i,!bi(i)),$L=i=>S5(i,bi(i));function NL(i,t,e){if(t.type.prop(e))return!0;let s=t.to-t.from;return s&&(s>2||/[^\s,.;:]/.test(i.sliceDoc(t.from,t.to)))||t.firstChild}function up(i,t,e){let s=Ge(i).resolveInner(t.head),n=e?Dt.closedBy:Dt.openedBy;for(let l=t.head;;){let c=e?s.childAfter(l):s.childBefore(l);if(!c)break;NL(i,c,n)?s=c:l=e?c.to:c.from}let r=s.type.prop(n),o,a;return r&&(o=e?gn(i,s.from,1):gn(i,s.to,-1))&&o.matched?a=e?o.end.to:o.end.from:a=e?s.to:s.from,G.cursor(a,e?-1:1)}const DL=i=>Us(i,t=>up(i.state,t,!bi(i))),LL=i=>Us(i,t=>up(i.state,t,bi(i)));function w5(i,t){return Us(i,e=>{if(!e.empty)return hp(e,t);let s=i.moveVertically(e,t);return s.head!=e.head?s:i.moveToLineBoundary(e,t)})}const k5=i=>w5(i,!1),C5=i=>w5(i,!0);function T5(i){let t=i.scrollDOM.clientHeight<i.scrollDOM.scrollHeight-2,e=0,s=0,n;if(t){for(let r of i.state.facet(ht.scrollMargins)){let o=r(i);o?.top&&(e=Math.max(o?.top,e)),o?.bottom&&(s=Math.max(o?.bottom,s))}n=i.scrollDOM.clientHeight-e-s}else n=(i.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:e,marginBottom:s,selfScroll:t,height:Math.max(i.defaultLineHeight,n-5)}}function P5(i,t){let e=T5(i),{state:s}=i,n=al(s.selection,o=>o.empty?i.moveVertically(o,t,e.height):hp(o,t));if(n.eq(s.selection))return!1;let r;if(e.selfScroll){let o=i.coordsAtPos(s.selection.main.head),a=i.scrollDOM.getBoundingClientRect(),l=a.top+e.marginTop,c=a.bottom-e.marginBottom;o&&o.top>l&&o.bottom<c&&(r=ht.scrollIntoView(n.main.head,{y:"start",yMargin:o.top-l}))}return i.dispatch(Ys(s,n),{effects:r}),!0}const Yv=i=>P5(i,!1),c0=i=>P5(i,!0);function ro(i,t,e){let s=i.lineBlockAt(t.head),n=i.moveToLineBoundary(t,e);if(n.head==t.head&&n.head!=(e?s.to:s.from)&&(n=i.moveToLineBoundary(t,e,!1)),!e&&n.head==s.from&&s.length){let r=/^\s*/.exec(i.state.sliceDoc(s.from,Math.min(s.from+100,s.to)))[0].length;r&&t.head!=s.from+r&&(n=G.cursor(s.from+r))}return n}const VL=i=>Us(i,t=>ro(i,t,!0)),BL=i=>Us(i,t=>ro(i,t,!1)),ZL=i=>Us(i,t=>ro(i,t,!bi(i))),FL=i=>Us(i,t=>ro(i,t,bi(i))),WL=i=>Us(i,t=>G.cursor(i.lineBlockAt(t.head).from,1)),qL=i=>Us(i,t=>G.cursor(i.lineBlockAt(t.head).to,-1));function XL(i,t,e){let s=!1,n=al(i.selection,r=>{let o=gn(i,r.head,-1)||gn(i,r.head,1)||r.head>0&&gn(i,r.head-1,1)||r.head<i.doc.length&&gn(i,r.head+1,-1);if(!o||!o.end)return r;s=!0;let a=o.start.from==r.head?o.end.to:o.end.from;return G.cursor(a)});return s?(t(Ys(i,n)),!0):!1}const zL=({state:i,dispatch:t})=>XL(i,t);function Ps(i,t){let e=al(i.state.selection,s=>{let n=t(s);return G.range(s.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)});return e.eq(i.state.selection)?!1:(i.dispatch(Ys(i.state,e)),!0)}function A5(i,t){return Ps(i,e=>i.moveByChar(e,t))}const M5=i=>A5(i,!bi(i)),E5=i=>A5(i,bi(i));function R5(i,t){return Ps(i,e=>i.moveByGroup(e,t))}const jL=i=>R5(i,!bi(i)),GL=i=>R5(i,bi(i)),YL=i=>Ps(i,t=>up(i.state,t,!bi(i))),UL=i=>Ps(i,t=>up(i.state,t,bi(i)));function Q5(i,t){return Ps(i,e=>i.moveVertically(e,t))}const I5=i=>Q5(i,!1),$5=i=>Q5(i,!0);function N5(i,t){return Ps(i,e=>i.moveVertically(e,t,T5(i).height))}const Uv=i=>N5(i,!1),Hv=i=>N5(i,!0),HL=i=>Ps(i,t=>ro(i,t,!0)),KL=i=>Ps(i,t=>ro(i,t,!1)),JL=i=>Ps(i,t=>ro(i,t,!bi(i))),tV=i=>Ps(i,t=>ro(i,t,bi(i))),eV=i=>Ps(i,t=>G.cursor(i.lineBlockAt(t.head).from)),iV=i=>Ps(i,t=>G.cursor(i.lineBlockAt(t.head).to)),Kv=({state:i,dispatch:t})=>(t(Ys(i,{anchor:0})),!0),Jv=({state:i,dispatch:t})=>(t(Ys(i,{anchor:i.doc.length})),!0),t_=({state:i,dispatch:t})=>(t(Ys(i,{anchor:i.selection.main.anchor,head:0})),!0),e_=({state:i,dispatch:t})=>(t(Ys(i,{anchor:i.selection.main.anchor,head:i.doc.length})),!0),sV=({state:i,dispatch:t})=>(t(i.update({selection:{anchor:0,head:i.doc.length},userEvent:"select"})),!0),nV=({state:i,dispatch:t})=>{let e=fp(i).map(({from:s,to:n})=>G.range(s,Math.min(n+1,i.doc.length)));return t(i.update({selection:G.create(e),userEvent:"select"})),!0},rV=({state:i,dispatch:t})=>{let e=al(i.selection,s=>{let n=Ge(i),r=n.resolveStack(s.from,1);if(s.empty){let o=n.resolveStack(s.from,-1);o.node.from>=r.node.from&&o.node.to<=r.node.to&&(r=o)}for(let o=r;o;o=o.next){let{node:a}=o;if((a.from<s.from&&a.to>=s.to||a.to>s.to&&a.from<=s.from)&&o.next)return G.range(a.to,a.from)}return s});return e.eq(i.selection)?!1:(t(Ys(i,e)),!0)};function D5(i,t){let{state:e}=i,s=e.selection,n=e.selection.ranges.slice();for(let r of e.selection.ranges){let o=e.doc.lineAt(r.head);if(t?o.to<i.state.doc.length:o.from>0)for(let a=r;;){let l=i.moveVertically(a,t);if(l.head<o.from||l.head>o.to){n.some(c=>c.head==l.head)||n.push(l);break}else{if(l.head==a.head)break;a=l}}}return n.length==s.ranges.length?!1:(i.dispatch(Ys(e,G.create(n,n.length-1))),!0)}const oV=i=>D5(i,!1),aV=i=>D5(i,!0),lV=({state:i,dispatch:t})=>{let e=i.selection,s=null;return e.ranges.length>1?s=G.create([e.main]):e.main.empty||(s=G.create([G.cursor(e.main.head)])),s?(t(Ys(i,s)),!0):!1};function Ah(i,t){if(i.state.readOnly)return!1;let e="delete.selection",{state:s}=i,n=s.changeByRange(r=>{let{from:o,to:a}=r;if(o==a){let l=t(r);l<o?(e="delete.backward",l=$u(i,l,!1)):l>o&&(e="delete.forward",l=$u(i,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=$u(i,o,!1),a=$u(i,a,!0);return o==a?{range:r}:{changes:{from:o,to:a},range:G.cursor(o,o<r.head?-1:1)}});return n.changes.empty?!1:(i.dispatch(s.update(n,{scrollIntoView:!0,userEvent:e,effects:e=="delete.selection"?ht.announce.of(s.phrase("Selection deleted")):void 0})),!0)}function $u(i,t,e){if(i instanceof ht)for(let s of i.state.facet(ht.atomicRanges).map(n=>n(i)))s.between(t,t,(n,r)=>{n<t&&r>t&&(t=e?r:n)});return t}const L5=(i,t,e)=>Ah(i,s=>{let n=s.from,{state:r}=i,o=r.doc.lineAt(n),a,l;if(e&&!t&&n>o.from&&n<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,n-o.from))){if(a[a.length-1]=="	")return n-1;let c=ol(a,r.tabSize),h=c%td(r)||td(r);for(let u=0;u<h&&a[a.length-1-u]==" ";u++)n--;l=n}else l=ri(o.text,n-o.from,t,t)+o.from,l==n&&o.number!=(t?r.doc.lines:1)?l+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,n-o.from))&&(l=ri(o.text,l-o.from,!1,!1)+o.from);return l}),h0=i=>L5(i,!1,!0),V5=i=>L5(i,!0,!1),B5=(i,t)=>Ah(i,e=>{let s=e.head,{state:n}=i,r=n.doc.lineAt(s),o=n.charCategorizer(s);for(let a=null;;){if(s==(t?r.to:r.from)){s==e.head&&r.number!=(t?n.doc.lines:1)&&(s+=t?1:-1);break}let l=ri(r.text,s-r.from,t)+r.from,c=r.text.slice(Math.min(s,l)-r.from,Math.max(s,l)-r.from),h=o(c);if(a!=null&&h!=a)break;(c!=" "||s!=e.head)&&(a=h),s=l}return s}),Z5=i=>B5(i,!1),cV=i=>B5(i,!0),hV=i=>Ah(i,t=>{let e=i.lineBlockAt(t.head).to;return t.head<e?e:Math.min(i.state.doc.length,t.head+1)}),uV=i=>Ah(i,t=>{let e=i.moveToLineBoundary(t,!1).head;return t.head>e?e:Math.max(0,t.head-1)}),fV=i=>Ah(i,t=>{let e=i.moveToLineBoundary(t,!0).head;return t.head<e?e:Math.min(i.state.doc.length,t.head+1)}),dV=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=i.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:Wt.of(["",""])},range:G.cursor(s.from)}));return t(i.update(e,{scrollIntoView:!0,userEvent:"input"})),!0},pV=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=i.changeByRange(s=>{if(!s.empty||s.from==0||s.from==i.doc.length)return{range:s};let n=s.from,r=i.doc.lineAt(n),o=n==r.from?n-1:ri(r.text,n-r.from,!1)+r.from,a=n==r.to?n+1:ri(r.text,n-r.from,!0)+r.from;return{changes:{from:o,to:a,insert:i.doc.slice(n,a).append(i.doc.slice(o,n))},range:G.cursor(a)}});return e.changes.empty?!1:(t(i.update(e,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function fp(i){let t=[],e=-1;for(let s of i.selection.ranges){let n=i.doc.lineAt(s.from),r=i.doc.lineAt(s.to);if(!s.empty&&s.to==r.from&&(r=i.doc.lineAt(s.to-1)),e>=n.number){let o=t[t.length-1];o.to=r.to,o.ranges.push(s)}else t.push({from:n.from,to:r.to,ranges:[s]});e=r.number+1}return t}function F5(i,t,e){if(i.readOnly)return!1;let s=[],n=[];for(let r of fp(i)){if(e?r.to==i.doc.length:r.from==0)continue;let o=i.doc.lineAt(e?r.to+1:r.from-1),a=o.length+1;if(e){s.push({from:r.to,to:o.to},{from:r.from,insert:o.text+i.lineBreak});for(let l of r.ranges)n.push(G.range(Math.min(i.doc.length,l.anchor+a),Math.min(i.doc.length,l.head+a)))}else{s.push({from:o.from,to:r.from},{from:r.to,insert:i.lineBreak+o.text});for(let l of r.ranges)n.push(G.range(l.anchor-a,l.head-a))}}return s.length?(t(i.update({changes:s,scrollIntoView:!0,selection:G.create(n,i.selection.mainIndex),userEvent:"move.line"})),!0):!1}const gV=({state:i,dispatch:t})=>F5(i,t,!1),mV=({state:i,dispatch:t})=>F5(i,t,!0);function W5(i,t,e){if(i.readOnly)return!1;let s=[];for(let n of fp(i))e?s.push({from:n.from,insert:i.doc.slice(n.from,n.to)+i.lineBreak}):s.push({from:n.to,insert:i.lineBreak+i.doc.slice(n.from,n.to)});return t(i.update({changes:s,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const OV=({state:i,dispatch:t})=>W5(i,t,!1),yV=({state:i,dispatch:t})=>W5(i,t,!0),bV=i=>{if(i.state.readOnly)return!1;let{state:t}=i,e=t.changes(fp(t).map(({from:n,to:r})=>(n>0?n--:r<t.doc.length&&r++,{from:n,to:r}))),s=al(t.selection,n=>{let r;if(i.lineWrapping){let o=i.lineBlockAt(n.head),a=i.coordsAtPos(n.head,n.assoc||1);a&&(r=o.bottom+i.documentTop-a.bottom+i.defaultLineHeight/2)}return i.moveVertically(n,!0,r)}).map(e);return i.dispatch({changes:e,selection:s,scrollIntoView:!0,userEvent:"delete.line"}),!0};function vV(i,t){if(/\(\)|\[\]|\{\}/.test(i.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=Ge(i).resolveInner(t),s=e.childBefore(t),n=e.childAfter(t),r;return s&&n&&s.to<=t&&n.from>=t&&(r=s.type.prop(Dt.closedBy))&&r.indexOf(n.name)>-1&&i.doc.lineAt(s.to).from==i.doc.lineAt(n.from).from&&!/\S/.test(i.sliceDoc(s.to,n.from))?{from:s.to,to:n.from}:null}const i_=q5(!1),_V=q5(!0);function q5(i){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let s=t.changeByRange(n=>{let{from:r,to:o}=n,a=t.doc.lineAt(r),l=!i&&r==o&&vV(t,r);i&&(r=o=(o<=a.to?a:t.doc.lineAt(o)).to);let c=new ap(t,{simulateBreak:r,simulateDoubleBreak:!!l}),h=n1(c,r);for(h==null&&(h=ol(/^\s*/.exec(t.doc.lineAt(r).text)[0],t.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:r,to:o}=l:r>a.from&&r<a.from+100&&!/\S/.test(a.text.slice(0,r))&&(r=a.from);let u=["",Fc(t,h)];return l&&u.push(Fc(t,c.lineIndent(a.from,-1))),{changes:{from:r,to:o,insert:Wt.of(u)},range:G.cursor(r+1+u[1].length)}});return e(t.update(s,{scrollIntoView:!0,userEvent:"input"})),!0}}function l1(i,t){let e=-1;return i.changeByRange(s=>{let n=[];for(let o=s.from;o<=s.to;){let a=i.doc.lineAt(o);a.number>e&&(s.empty||s.to>a.from)&&(t(a,n,s),e=a.number),o=a.to+1}let r=i.changes(n);return{changes:n,range:G.range(r.mapPos(s.anchor,1),r.mapPos(s.head,1))}})}const xV=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let e=Object.create(null),s=new ap(i,{overrideIndentation:r=>{let o=e[r];return o??-1}}),n=l1(i,(r,o,a)=>{let l=n1(s,r.from);if(l==null)return;/\S/.test(r.text)||(l=0);let c=/^\s*/.exec(r.text)[0],h=Fc(i,l);(c!=h||a.from<r.from+c.length)&&(e[r.from]=l,o.push({from:r.from,to:r.from+c.length,insert:h}))});return n.changes.empty||t(i.update(n,{userEvent:"indent"})),!0},X5=({state:i,dispatch:t})=>i.readOnly?!1:(t(i.update(l1(i,(e,s)=>{s.push({from:e.from,insert:i.facet(Ch)})}),{userEvent:"input.indent"})),!0),z5=({state:i,dispatch:t})=>i.readOnly?!1:(t(i.update(l1(i,(e,s)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let r=ol(n,i.tabSize),o=0,a=Fc(i,Math.max(0,r-td(i)));for(;o<n.length&&o<a.length&&n.charCodeAt(o)==a.charCodeAt(o);)o++;s.push({from:e.from+o,to:e.from+n.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),SV=i=>(i.setTabFocusMode(),!0),wV=[{key:"Ctrl-b",run:_5,shift:M5,preventDefault:!0},{key:"Ctrl-f",run:x5,shift:E5},{key:"Ctrl-p",run:k5,shift:I5},{key:"Ctrl-n",run:C5,shift:$5},{key:"Ctrl-a",run:WL,shift:eV},{key:"Ctrl-e",run:qL,shift:iV},{key:"Ctrl-d",run:V5},{key:"Ctrl-h",run:h0},{key:"Ctrl-k",run:hV},{key:"Ctrl-Alt-h",run:Z5},{key:"Ctrl-o",run:dV},{key:"Ctrl-t",run:pV},{key:"Ctrl-v",run:c0}],kV=[{key:"ArrowLeft",run:_5,shift:M5,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:IL,shift:jL,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:ZL,shift:JL,preventDefault:!0},{key:"ArrowRight",run:x5,shift:E5,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:$L,shift:GL,preventDefault:!0},{mac:"Cmd-ArrowRight",run:FL,shift:tV,preventDefault:!0},{key:"ArrowUp",run:k5,shift:I5,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Kv,shift:t_},{mac:"Ctrl-ArrowUp",run:Yv,shift:Uv},{key:"ArrowDown",run:C5,shift:$5,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Jv,shift:e_},{mac:"Ctrl-ArrowDown",run:c0,shift:Hv},{key:"PageUp",run:Yv,shift:Uv},{key:"PageDown",run:c0,shift:Hv},{key:"Home",run:BL,shift:KL,preventDefault:!0},{key:"Mod-Home",run:Kv,shift:t_},{key:"End",run:VL,shift:HL,preventDefault:!0},{key:"Mod-End",run:Jv,shift:e_},{key:"Enter",run:i_,shift:i_},{key:"Mod-a",run:sV},{key:"Backspace",run:h0,shift:h0,preventDefault:!0},{key:"Delete",run:V5,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Z5,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:cV,preventDefault:!0},{mac:"Mod-Backspace",run:uV,preventDefault:!0},{mac:"Mod-Delete",run:fV,preventDefault:!0}].concat(wV.map(i=>({mac:i.key,run:i.run,shift:i.shift}))),CV=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:DL,shift:YL},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:LL,shift:UL},{key:"Alt-ArrowUp",run:gV},{key:"Shift-Alt-ArrowUp",run:OV},{key:"Alt-ArrowDown",run:mV},{key:"Shift-Alt-ArrowDown",run:yV},{key:"Mod-Alt-ArrowUp",run:oV},{key:"Mod-Alt-ArrowDown",run:aV},{key:"Escape",run:lV},{key:"Mod-Enter",run:_V},{key:"Alt-l",mac:"Ctrl-l",run:nV},{key:"Mod-i",run:rV,preventDefault:!0},{key:"Mod-[",run:z5},{key:"Mod-]",run:X5},{key:"Mod-Alt-\\",run:xV},{key:"Shift-Mod-k",run:bV},{key:"Shift-Mod-\\",run:zL},{key:"Mod-/",run:gL},{key:"Alt-A",run:OL},{key:"Ctrl-m",mac:"Shift-Alt-m",run:SV}].concat(kV),TV={key:"Tab",run:X5,shift:z5},s_=typeof String.prototype.normalize=="function"?i=>i.normalize("NFKD"):i=>i;class Ga{constructor(t,e,s=0,n=t.length,r,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(s,n),this.bufferStart=s,this.normalize=r?a=>r(s_(a)):s_,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Bi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=LO(t),s=this.bufferStart+this.bufferPos;this.bufferPos+=un(t);let n=this.normalize(e);if(n.length)for(let r=0,o=s;;r++){let a=n.charCodeAt(r),l=this.match(a,o,this.bufferPos+this.bufferStart);if(r==n.length-1){if(l)return this.value=l,this;break}o==s&&r<e.length&&e.charCodeAt(r)==a&&o++}}}match(t,e,s){let n=null;for(let r=0;r<this.matches.length;r+=2){let o=this.matches[r],a=!1;this.query.charCodeAt(o)==t&&(o==this.query.length-1?n={from:this.matches[r+1],to:s}:(this.matches[r]++,a=!0)),a||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==t&&(this.query.length==1?n={from:e,to:s}:this.matches.push(1,e)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}typeof Symbol<"u"&&(Ga.prototype[Symbol.iterator]=function(){return this});const j5={from:-1,to:-1,match:/.*/.exec("")},c1="gm"+(/x/.unicode==null?"":"u");class G5{constructor(t,e,s,n=0,r=t.length){if(this.text=t,this.to=r,this.curLine="",this.done=!1,this.value=j5,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new Y5(t,e,s,n,r);this.re=new RegExp(e,c1+(s?.ignoreCase?"i":"")),this.test=s?.test,this.iter=t.iter();let o=t.lineAt(n);this.curLineStart=o.from,this.matchPos=nd(t,n),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let s=this.curLineStart+e.index,n=s+e[0].length;if(this.matchPos=nd(this.text,n+(s==n?1:0)),s==this.curLineStart+this.curLine.length&&this.nextLine(),(s<n||s>this.value.to)&&(!this.test||this.test(s,n,e)))return this.value={from:s,to:n,match:e},this;t=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),t=0;else return this.done=!0,this}}}const yg=new WeakMap;class Ma{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,s){let n=yg.get(t);if(!n||n.from>=s||n.to<=e){let a=new Ma(e,t.sliceString(e,s));return yg.set(t,a),a}if(n.from==e&&n.to==s)return n;let{text:r,from:o}=n;return o>e&&(r=t.sliceString(e,o)+r,o=e),n.to<s&&(r+=t.sliceString(n.to,s)),yg.set(t,new Ma(o,r)),new Ma(e,r.slice(e-o,s-o))}}class Y5{constructor(t,e,s,n,r){this.text=t,this.to=r,this.done=!1,this.value=j5,this.matchPos=nd(t,n),this.re=new RegExp(e,c1+(s?.ignoreCase?"i":"")),this.test=s?.test,this.flat=Ma.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let s=this.flat.from+e.index,n=s+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(s,n,e)))return this.value={from:s,to:n,match:e},this.matchPos=nd(this.text,n+(s==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ma.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(G5.prototype[Symbol.iterator]=Y5.prototype[Symbol.iterator]=function(){return this});function PV(i){try{return new RegExp(i,c1),!0}catch{return!1}}function nd(i,t){if(t>=i.length)return t;let e=i.lineAt(t),s;for(;t<e.to&&(s=e.text.charCodeAt(t-e.from))>=56320&&s<57344;)t++;return t}function u0(i){let t=String(i.state.doc.lineAt(i.state.selection.main.head).number),e=ie("input",{class:"cm-textfield",name:"line",value:t}),s=ie("form",{class:"cm-gotoLine",onkeydown:r=>{r.keyCode==27?(r.preventDefault(),i.dispatch({effects:yc.of(!1)}),i.focus()):r.keyCode==13&&(r.preventDefault(),n())},onsubmit:r=>{r.preventDefault(),n()}},ie("label",i.state.phrase("Go to line"),": ",e)," ",ie("button",{class:"cm-button",type:"submit"},i.state.phrase("go")),ie("button",{name:"close",onclick:()=>{i.dispatch({effects:yc.of(!1)}),i.focus()},"aria-label":i.state.phrase("close"),type:"button"},[""]));function n(){let r=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!r)return;let{state:o}=i,a=o.doc.lineAt(o.selection.main.head),[,l,c,h,u]=r,f=h?+h.slice(1):0,d=c?+c:a.number;if(c&&u){let m=d/100;l&&(m=m*(l=="-"?-1:1)+a.number/o.doc.lines),d=Math.round(o.doc.lines*m)}else c&&l&&(d=d*(l=="-"?-1:1)+a.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),g=G.cursor(p.from+Math.max(0,Math.min(f,p.length)));i.dispatch({effects:[yc.of(!1),ht.scrollIntoView(g.from,{y:"center"})],selection:g}),i.focus()}return{dom:s}}const yc=Et.define(),n_=Je.define({create(){return!0},update(i,t){for(let e of t.effects)e.is(yc)&&(i=e.value);return i},provide:i=>Bc.from(i,t=>t?u0:null)}),AV=i=>{let t=Vc(i,u0);if(!t){let e=[yc.of(!0)];i.state.field(n_,!1)==null&&e.push(Et.appendConfig.of([n_,MV])),i.dispatch({effects:e}),t=Vc(i,u0)}return t&&t.dom.querySelector("input").select(),!0},MV=ht.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),EV={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},RV=ft.define({combine(i){return An(i,EV,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})}});function QV(i){return[LV,DV]}const IV=vt.mark({class:"cm-selectionMatch"}),$V=vt.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function r_(i,t,e,s){return(e==0||i(t.sliceDoc(e-1,e))!=we.Word)&&(s==t.doc.length||i(t.sliceDoc(s,s+1))!=we.Word)}function NV(i,t,e,s){return i(t.sliceDoc(e,e+1))==we.Word&&i(t.sliceDoc(s-1,s))==we.Word}const DV=Me.fromClass(class{constructor(i){this.decorations=this.getDeco(i)}update(i){(i.selectionSet||i.docChanged||i.viewportChanged)&&(this.decorations=this.getDeco(i.view))}getDeco(i){let t=i.state.facet(RV),{state:e}=i,s=e.selection;if(s.ranges.length>1)return vt.none;let n=s.main,r,o=null;if(n.empty){if(!t.highlightWordAroundCursor)return vt.none;let l=e.wordAt(n.head);if(!l)return vt.none;o=e.charCategorizer(n.head),r=e.sliceDoc(l.from,l.to)}else{let l=n.to-n.from;if(l<t.minSelectionLength||l>200)return vt.none;if(t.wholeWords){if(r=e.sliceDoc(n.from,n.to),o=e.charCategorizer(n.head),!(r_(o,e,n.from,n.to)&&NV(o,e,n.from,n.to)))return vt.none}else if(r=e.sliceDoc(n.from,n.to),!r)return vt.none}let a=[];for(let l of i.visibleRanges){let c=new Ga(e.doc,r,l.from,l.to);for(;!c.next().done;){let{from:h,to:u}=c.value;if((!o||r_(o,e,h,u))&&(n.empty&&h<=n.from&&u>=n.to?a.push($V.range(h,u)):(h>=n.to||u<=n.from)&&a.push(IV.range(h,u)),a.length>t.maxMatches))return vt.none}}return vt.set(a)}},{decorations:i=>i.decorations}),LV=ht.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),VV=({state:i,dispatch:t})=>{let{selection:e}=i,s=G.create(e.ranges.map(n=>i.wordAt(n.head)||G.cursor(n.head)),e.mainIndex);return s.eq(e)?!1:(t(i.update({selection:s})),!0)};function BV(i,t){let{main:e,ranges:s}=i.selection,n=i.wordAt(e.head),r=n&&n.from==e.from&&n.to==e.to;for(let o=!1,a=new Ga(i.doc,t,s[s.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new Ga(i.doc,t,0,Math.max(0,s[s.length-1].from-1)),o=!0}else{if(o&&s.some(l=>l.from==a.value.from))continue;if(r){let l=i.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const ZV=({state:i,dispatch:t})=>{let{ranges:e}=i.selection;if(e.some(r=>r.from===r.to))return VV({state:i,dispatch:t});let s=i.sliceDoc(e[0].from,e[0].to);if(i.selection.ranges.some(r=>i.sliceDoc(r.from,r.to)!=s))return!1;let n=BV(i,s);return n?(t(i.update({selection:i.selection.addRange(G.range(n.from,n.to),!1),effects:ht.scrollIntoView(n.to)})),!0):!1},ll=ft.define({combine(i){return An(i,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:t=>new JV(t),scrollToMatch:t=>ht.scrollIntoView(t)})}});class U5{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||PV(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,(e,s)=>s=="n"?`
`:s=="r"?"\r":s=="t"?"	":"\\")}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new XV(this):new WV(this)}getCursor(t,e=0,s){let n=t.doc?t:Vt.create({doc:t});return s==null&&(s=n.doc.length),this.regexp?ha(this,n,e,s):ca(this,n,e,s)}}class H5{constructor(t){this.spec=t}}function ca(i,t,e,s){return new Ga(t.doc,i.unquoted,e,s,i.caseSensitive?void 0:n=>n.toLowerCase(),i.wholeWord?FV(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function FV(i,t){return(e,s,n,r)=>((r>e||r+n.length<s)&&(r=Math.max(0,e-2),n=i.sliceString(r,Math.min(i.length,s+2))),(t(rd(n,e-r))!=we.Word||t(od(n,e-r))!=we.Word)&&(t(od(n,s-r))!=we.Word||t(rd(n,s-r))!=we.Word))}class WV extends H5{constructor(t){super(t)}nextMatch(t,e,s){let n=ca(this.spec,t,s,t.doc.length).nextOverlapping();if(n.done){let r=Math.min(t.doc.length,e+this.spec.unquoted.length);n=ca(this.spec,t,0,r).nextOverlapping()}return n.done||n.value.from==e&&n.value.to==s?null:n.value}prevMatchInRange(t,e,s){for(let n=s;;){let r=Math.max(e,n-1e4-this.spec.unquoted.length),o=ca(this.spec,t,r,n),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(r==e)return null;n-=1e4}}prevMatch(t,e,s){let n=this.prevMatchInRange(t,0,e);return n||(n=this.prevMatchInRange(t,Math.max(0,s-this.spec.unquoted.length),t.doc.length)),n&&(n.from!=e||n.to!=s)?n:null}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let s=ca(this.spec,t,0,t.doc.length),n=[];for(;!s.next().done;){if(n.length>=e)return null;n.push(s.value)}return n}highlight(t,e,s,n){let r=ca(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(s+this.spec.unquoted.length,t.doc.length));for(;!r.next().done;)n(r.value.from,r.value.to)}}function ha(i,t,e,s){return new G5(t.doc,i.search,{ignoreCase:!i.caseSensitive,test:i.wholeWord?qV(t.charCategorizer(t.selection.main.head)):void 0},e,s)}function rd(i,t){return i.slice(ri(i,t,!1),t)}function od(i,t){return i.slice(t,ri(i,t))}function qV(i){return(t,e,s)=>!s[0].length||(i(rd(s.input,s.index))!=we.Word||i(od(s.input,s.index))!=we.Word)&&(i(od(s.input,s.index+s[0].length))!=we.Word||i(rd(s.input,s.index+s[0].length))!=we.Word)}class XV extends H5{nextMatch(t,e,s){let n=ha(this.spec,t,s,t.doc.length).next();return n.done&&(n=ha(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,s){for(let n=1;;n++){let r=Math.max(e,s-n*1e4),o=ha(this.spec,t,r,s),a=null;for(;!o.next().done;)a=o.value;if(a&&(r==e||a.from>r+10))return a;if(r==e)return null}}prevMatch(t,e,s){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,s,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(e,s)=>{if(s=="&")return t.match[0];if(s=="$")return"$";for(let n=s.length;n>0;n--){let r=+s.slice(0,n);if(r>0&&r<t.match.length)return t.match[r]+s.slice(n)}return e})}matchAll(t,e){let s=ha(this.spec,t,0,t.doc.length),n=[];for(;!s.next().done;){if(n.length>=e)return null;n.push(s.value)}return n}highlight(t,e,s,n){let r=ha(this.spec,t,Math.max(0,e-250),Math.min(s+250,t.doc.length));for(;!r.next().done;)n(r.value.from,r.value.to)}}const Wc=Et.define(),h1=Et.define(),Dr=Je.define({create(i){return new bg(f0(i).create(),null)},update(i,t){for(let e of t.effects)e.is(Wc)?i=new bg(e.value.create(),i.panel):e.is(h1)&&(i=new bg(i.query,e.value?u1:null));return i},provide:i=>Bc.from(i,t=>t.panel)});class bg{constructor(t,e){this.query=t,this.panel=e}}const zV=vt.mark({class:"cm-searchMatch"}),jV=vt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),GV=Me.fromClass(class{constructor(i){this.view=i,this.decorations=this.highlight(i.state.field(Dr))}update(i){let t=i.state.field(Dr);(t!=i.startState.field(Dr)||i.docChanged||i.selectionSet||i.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:i,panel:t}){if(!t||!i.spec.valid)return vt.none;let{view:e}=this,s=new Jn;for(let n=0,r=e.visibleRanges,o=r.length;n<o;n++){let{from:a,to:l}=r[n];for(;n<o-1&&l>r[n+1].from-500;)l=r[++n].to;i.highlight(e.state,a,l,(c,h)=>{let u=e.state.selection.ranges.some(f=>f.from==c&&f.to==h);s.add(c,h,u?jV:zV)})}return s.finish()}},{decorations:i=>i.decorations});function Mh(i){return t=>{let e=t.state.field(Dr,!1);return e&&e.query.spec.valid?i(t,e):tC(t)}}const ad=Mh((i,{query:t})=>{let{to:e}=i.state.selection.main,s=t.nextMatch(i.state,e,e);if(!s)return!1;let n=G.single(s.from,s.to),r=i.state.facet(ll);return i.dispatch({selection:n,effects:[f1(i,s),r.scrollToMatch(n.main,i)],userEvent:"select.search"}),J5(i),!0}),ld=Mh((i,{query:t})=>{let{state:e}=i,{from:s}=e.selection.main,n=t.prevMatch(e,s,s);if(!n)return!1;let r=G.single(n.from,n.to),o=i.state.facet(ll);return i.dispatch({selection:r,effects:[f1(i,n),o.scrollToMatch(r.main,i)],userEvent:"select.search"}),J5(i),!0}),YV=Mh((i,{query:t})=>{let e=t.matchAll(i.state,1e3);return!e||!e.length?!1:(i.dispatch({selection:G.create(e.map(s=>G.range(s.from,s.to))),userEvent:"select.search.matches"}),!0)}),UV=({state:i,dispatch:t})=>{let e=i.selection;if(e.ranges.length>1||e.main.empty)return!1;let{from:s,to:n}=e.main,r=[],o=0;for(let a=new Ga(i.doc,i.sliceDoc(s,n));!a.next().done;){if(r.length>1e3)return!1;a.value.from==s&&(o=r.length),r.push(G.range(a.value.from,a.value.to))}return t(i.update({selection:G.create(r,o),userEvent:"select.search.matches"})),!0},o_=Mh((i,{query:t})=>{let{state:e}=i,{from:s,to:n}=e.selection.main;if(e.readOnly)return!1;let r=t.nextMatch(e,s,s);if(!r)return!1;let o=r,a=[],l,c,h=[];o.from==s&&o.to==n&&(c=e.toText(t.getReplacement(o)),a.push({from:o.from,to:o.to,insert:c}),o=t.nextMatch(e,o.from,o.to),h.push(ht.announce.of(e.phrase("replaced match on line $",e.doc.lineAt(s).number)+".")));let u=i.state.changes(a);return o&&(l=G.single(o.from,o.to).map(u),h.push(f1(i,o)),h.push(e.facet(ll).scrollToMatch(l.main,i))),i.dispatch({changes:u,selection:l,effects:h,userEvent:"input.replace"}),!0}),HV=Mh((i,{query:t})=>{if(i.state.readOnly)return!1;let e=t.matchAll(i.state,1e9).map(n=>{let{from:r,to:o}=n;return{from:r,to:o,insert:t.getReplacement(n)}});if(!e.length)return!1;let s=i.state.phrase("replaced $ matches",e.length)+".";return i.dispatch({changes:e,effects:ht.announce.of(s),userEvent:"input.replace.all"}),!0});function u1(i){return i.state.facet(ll).createPanel(i)}function f0(i,t){var e,s,n,r,o;let a=i.selection.main,l=a.empty||a.to>a.from+100?"":i.sliceDoc(a.from,a.to);if(t&&!l)return t;let c=i.facet(ll);return new U5({search:((e=t?.literal)!==null&&e!==void 0?e:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(s=t?.caseSensitive)!==null&&s!==void 0?s:c.caseSensitive,literal:(n=t?.literal)!==null&&n!==void 0?n:c.literal,regexp:(r=t?.regexp)!==null&&r!==void 0?r:c.regexp,wholeWord:(o=t?.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function K5(i){let t=Vc(i,u1);return t&&t.dom.querySelector("[main-field]")}function J5(i){let t=K5(i);t&&t==i.root.activeElement&&t.select()}const tC=i=>{let t=i.state.field(Dr,!1);if(t&&t.panel){let e=K5(i);if(e&&e!=i.root.activeElement){let s=f0(i.state,t.query.spec);s.valid&&i.dispatch({effects:Wc.of(s)}),e.focus(),e.select()}}else i.dispatch({effects:[h1.of(!0),t?Wc.of(f0(i.state,t.query.spec)):Et.appendConfig.of(eB)]});return!0},eC=i=>{let t=i.state.field(Dr,!1);if(!t||!t.panel)return!1;let e=Vc(i,u1);return e&&e.dom.contains(i.root.activeElement)&&i.focus(),i.dispatch({effects:h1.of(!1)}),!0},KV=[{key:"Mod-f",run:tC,scope:"editor search-panel"},{key:"F3",run:ad,shift:ld,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:ad,shift:ld,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:eC,scope:"editor search-panel"},{key:"Mod-Shift-l",run:UV},{key:"Mod-Alt-g",run:AV},{key:"Mod-d",run:ZV,preventDefault:!0}];class JV{constructor(t){this.view=t;let e=this.query=t.state.field(Dr).query.spec;this.commit=this.commit.bind(this),this.searchField=ie("input",{value:e.search,placeholder:Ki(t,"Find"),"aria-label":Ki(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ie("input",{value:e.replace,placeholder:Ki(t,"Replace"),"aria-label":Ki(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ie("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=ie("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=ie("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit});function s(n,r,o){return ie("button",{class:"cm-button",name:n,onclick:r,type:"button"},o)}this.dom=ie("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,s("next",()=>ad(t),[Ki(t,"next")]),s("prev",()=>ld(t),[Ki(t,"previous")]),s("select",()=>YV(t),[Ki(t,"all")]),ie("label",null,[this.caseField,Ki(t,"match case")]),ie("label",null,[this.reField,Ki(t,"regexp")]),ie("label",null,[this.wordField,Ki(t,"by word")]),...t.state.readOnly?[]:[ie("br"),this.replaceField,s("replace",()=>o_(t),[Ki(t,"replace")]),s("replaceAll",()=>HV(t),[Ki(t,"replace all")])],ie("button",{name:"close",onclick:()=>eC(t),"aria-label":Ki(t,"close"),type:"button"},[""])])}commit(){let t=new U5({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:Wc.of(t)}))}keydown(t){rN(this.view,t,"search-panel")?t.preventDefault():t.keyCode==13&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?ld:ad)(this.view)):t.keyCode==13&&t.target==this.replaceField&&(t.preventDefault(),o_(this.view))}update(t){for(let e of t.transactions)for(let s of e.effects)s.is(Wc)&&!s.value.eq(this.query)&&this.setQuery(s.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ll).top}}function Ki(i,t){return i.state.phrase(t)}const Nu=30,Du=/[\s\.,:;?!]/;function f1(i,{from:t,to:e}){let s=i.state.doc.lineAt(t),n=i.state.doc.lineAt(e).to,r=Math.max(s.from,t-Nu),o=Math.min(n,e+Nu),a=i.state.sliceDoc(r,o);if(r!=s.from){for(let l=0;l<Nu;l++)if(!Du.test(a[l+1])&&Du.test(a[l])){a=a.slice(l);break}}if(o!=n){for(let l=a.length-1;l>a.length-Nu;l--)if(!Du.test(a[l-1])&&Du.test(a[l])){a=a.slice(0,l);break}}return ht.announce.of(`${i.state.phrase("current match")}. ${a} ${i.state.phrase("on line")} ${s.number}.`)}const tB=ht.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),eB=[Dr,no.low(GV),tB];class iC{constructor(t,e,s,n){this.state=t,this.pos=e,this.explicit=s,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=Ge(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),s=Math.max(e.from,this.pos-250),n=e.text.slice(s-e.from,this.pos-e.from),r=n.search(nC(t,!1));return r<0?null:{from:s+r,to:this.pos,text:n.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(t,e,s){t=="abort"&&this.abortListeners&&(this.abortListeners.push(e),s&&s.onDocChange&&(this.abortOnDocChange=!0))}}function a_(i){let t=Object.keys(i).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function iB(i){let t=Object.create(null),e=Object.create(null);for(let{label:n}of i){t[n[0]]=!0;for(let r=1;r<n.length;r++)e[n[r]]=!0}let s=a_(t)+a_(e)+"*$";return[new RegExp("^"+s),new RegExp(s)]}function sC(i){let t=i.map(n=>typeof n=="string"?{label:n}:n),[e,s]=t.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:iB(t);return n=>{let r=n.matchBefore(s);return r||n.explicit?{from:r?r.from:n.pos,options:t,validFor:e}:null}}function sB(i,t){return e=>{for(let s=Ge(e.state).resolveInner(e.pos,-1);s;s=s.parent){if(i.indexOf(s.name)>-1)return null;if(s.type.isTop)break}return t(e)}}class l_{constructor(t,e,s,n){this.completion=t,this.source=e,this.match=s,this.score=n}}function To(i){return i.selection.main.from}function nC(i,t){var e;let{source:s}=i,n=t&&s[0]!="^",r=s[s.length-1]!="$";return!n&&!r?i:new RegExp(`${n?"^":""}(?:${s})${r?"$":""}`,(e=i.flags)!==null&&e!==void 0?e:i.ignoreCase?"i":"")}const d1=fr.define();function nB(i,t,e,s){let{main:n}=i.selection,r=e-n.from,o=s-n.from;return{...i.changeByRange(a=>{if(a!=n&&e!=s&&i.sliceDoc(a.from+r,a.from+o)!=i.sliceDoc(e,s))return{range:a};let l=i.toText(t);return{changes:{from:a.from+r,to:s==n.from?a.to:a.from+o,insert:l},range:G.cursor(a.from+r+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const c_=new WeakMap;function rB(i){if(!Array.isArray(i))return i;let t=c_.get(i);return t||c_.set(i,t=sC(i)),t}const cd=Et.define(),qc=Et.define();class oB{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let s=Bi(t,e),n=un(s);this.chars.push(s);let r=t.slice(e,e+n),o=r.toUpperCase();this.folded.push(Bi(o==r?r.toLowerCase():o,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(this.pattern.length==0)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:s,any:n,precise:r,byWord:o}=this;if(e.length==1){let b=Bi(t,0),x=un(b),v=x==t.length?0:-100;if(b!=e[0])if(b==s[0])v+=-200;else return null;return this.ret(v,[0,x])}let a=t.indexOf(this.pattern);if(a==0)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=e.length,c=0;if(a<0){for(let b=0,x=Math.min(t.length,200);b<x&&c<l;){let v=Bi(t,b);(v==e[c]||v==s[c])&&(n[c++]=b),b+=un(v)}if(c<l)return null}let h=0,u=0,f=!1,d=0,p=-1,g=-1,m=/[a-z]/.test(t),O=!0;for(let b=0,x=Math.min(t.length,200),v=0;b<x&&u<l;){let y=Bi(t,b);a<0&&(h<l&&y==e[h]&&(r[h++]=b),d<l&&(y==e[d]||y==s[d]?(d==0&&(p=b),g=b+1,d++):d=0));let _,S=y<255?y>=48&&y<=57||y>=97&&y<=122?2:y>=65&&y<=90?1:0:(_=LO(y))!=_.toLowerCase()?1:_!=_.toUpperCase()?2:0;(!b||S==1&&m||v==0&&S!=0)&&(e[u]==y||s[u]==y&&(f=!0)?o[u++]=b:o.length&&(O=!1)),v=S,b+=un(y)}return u==l&&o[0]==0&&O?this.result(-100+(f?-200:0),o,t):d==l&&p==0?this.ret(-200-t.length+(g==t.length?0:-100),[0,g]):a>-1?this.ret(-700-t.length,[a,a+this.pattern.length]):d==l?this.ret(-900-t.length,[p,g]):u==l?this.result(-100+(f?-200:0)+-700+(O?0:-1100),o,t):e.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,s){let n=[],r=0;for(let o of e){let a=o+(this.astral?un(Bi(s,o)):1);r&&n[r-1]==o?n[r-1]=a:(n[r++]=o,n[r++]=a)}return this.ret(t-s.length,n)}}class aB{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),s=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return s==null?null:(this.matched=[0,e.length],this.score=s+(t.length==this.pattern.length?0:-100),this)}}const He=ft.define({combine(i){return An(i,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:lB,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>s=>h_(t(s),e(s)),optionClass:(t,e)=>s=>h_(t(s),e(s)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function h_(i,t){return i?t?i+" "+t:i:t}function lB(i,t,e,s,n,r){let o=i.textDirection==Oe.RTL,a=o,l=!1,c="top",h,u,f=t.left-n.left,d=n.right-t.right,p=s.right-s.left,g=s.bottom-s.top;if(a&&f<Math.min(p,d)?a=!1:!a&&d<Math.min(p,f)&&(a=!0),p<=(a?f:d))h=Math.max(n.top,Math.min(e.top,n.bottom-g))-t.top,u=Math.min(400,a?f:d);else{l=!0,u=Math.min(400,(o?t.right:n.right-t.left)-30);let b=n.bottom-t.bottom;b>=g||b>t.top?h=e.bottom-t.top:(c="bottom",h=t.bottom-e.top)}let m=(t.bottom-t.top)/r.offsetHeight,O=(t.right-t.left)/r.offsetWidth;return{style:`${c}: ${h/m}px; max-width: ${u/O}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function cB(i){let t=i.addToOptions.slice();return i.icons&&t.push({render(e){let s=document.createElement("div");return s.classList.add("cm-completionIcon"),e.type&&s.classList.add(...e.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),s.setAttribute("aria-hidden","true"),s},position:20}),t.push({render(e,s,n,r){let o=document.createElement("span");o.className="cm-completionLabel";let a=e.displayLabel||e.label,l=0;for(let c=0;c<r.length;){let h=r[c++],u=r[c++];h>l&&o.appendChild(document.createTextNode(a.slice(l,h)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(a.slice(h,u))),f.className="cm-completionMatchedText",l=u}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(e){if(!e.detail)return null;let s=document.createElement("span");return s.className="cm-completionDetail",s.textContent=e.detail,s},position:80}),t.sort((e,s)=>e.position-s.position).map(e=>e.render)}function vg(i,t,e){if(i<=e)return{from:0,to:i};if(t<0&&(t=0),t<=i>>1){let n=Math.floor(t/e);return{from:n*e,to:(n+1)*e}}let s=Math.floor((i-t)/e);return{from:i-(s+1)*e,to:i-s*e}}class hB{constructor(t,e,s){this.view=t,this.stateField=e,this.applyCompletion=s,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let n=t.state.field(e),{options:r,selected:o}=n.open,a=t.state.facet(He);this.optionContent=cB(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=vg(r.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=t.state.field(e).open;for(let h=l.target,u;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(u=/-(\d+)$/.exec(h.id))&&+u[1]<c.length){this.applyCompletion(t,c[+u[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=t.state.field(this.stateField,!1);c&&c.tooltip&&t.state.facet(He).closeOnBlur&&l.relatedTarget!=t.contentDOM&&t.dispatch({effects:qc.of(null)})}),this.showOptions(r,n.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(t){var e;let s=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),s!=n){let{options:r,selected:o,disabled:a}=s.open;(!n.open||n.open.options!=r)&&(this.range=vg(r.length,o,t.state.facet(He).maxRenderedOptions),this.showOptions(r,s.id)),this.updateSel(),a!=((e=n.open)===null||e===void 0?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let s of this.currentClass.split(" "))s&&this.dom.classList.remove(s);for(let s of e.split(" "))s&&this.dom.classList.add(s);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=vg(e.options.length,e.selected,this.view.state.facet(He).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:s}=e.options[e.selected],{info:n}=s;if(!n)return;let r=typeof n=="string"?document.createTextNode(n):n(s);if(!r)return;"then"in r?r.then(o=>{o&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(o,s)}).catch(o=>qi(this.view.state,o,"completion info")):this.addInfoPane(r,s)}}addInfoPane(t,e){this.destroyInfo();let s=this.info=document.createElement("div");if(s.className="cm-tooltip cm-completionInfo",t.nodeType!=null)s.appendChild(t),this.infoDestroy=null;else{let{dom:n,destroy:r}=t;s.appendChild(n),this.infoDestroy=r||null}this.dom.appendChild(s),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let s=this.list.firstChild,n=this.range.from;s;s=s.nextSibling,n++)s.nodeName!="LI"||!s.id?n--:n==t?s.hasAttribute("aria-selected")||(s.setAttribute("aria-selected","true"),e=s):s.hasAttribute("aria-selected")&&s.removeAttribute("aria-selected");return e&&fB(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),s=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),r=this.space;if(!r){let o=this.dom.ownerDocument.documentElement;r={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return n.top>Math.min(r.bottom,e.bottom)-10||n.bottom<Math.max(r.top,e.top)+10?null:this.view.state.facet(He).positionInfo(this.view,e,n,s,r,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,s){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",o=>{o.target==n&&o.preventDefault()});let r=null;for(let o=s.from;o<s.to;o++){let{completion:a,match:l}=t[o],{section:c}=a;if(c){let f=typeof c=="string"?c:c.name;if(f!=r&&(o>s.from||s.from==0))if(r=f,typeof c!="string"&&c.header)n.appendChild(c.header(c));else{let d=n.appendChild(document.createElement("completion-section"));d.textContent=f}}const h=n.appendChild(document.createElement("li"));h.id=e+"-"+o,h.setAttribute("role","option");let u=this.optionClass(a);u&&(h.className=u);for(let f of this.optionContent){let d=f(a,this.view.state,this.view,l);d&&h.appendChild(d)}}return s.from&&n.classList.add("cm-completionListIncompleteTop"),s.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function uB(i,t){return e=>new hB(e,i,t)}function fB(i,t){let e=i.getBoundingClientRect(),s=t.getBoundingClientRect(),n=e.height/i.offsetHeight;s.top<e.top?i.scrollTop-=(e.top-s.top)/n:s.bottom>e.bottom&&(i.scrollTop+=(s.bottom-e.bottom)/n)}function u_(i){return(i.boost||0)*100+(i.apply?10:0)+(i.info?5:0)+(i.type?1:0)}function dB(i,t){let e=[],s=null,n=null,r=h=>{e.push(h);let{section:u}=h.completion;if(u){s||(s=[]);let f=typeof u=="string"?u:u.name;s.some(d=>d.name==f)||s.push(typeof u=="string"?{name:f}:u)}},o=t.facet(He);for(let h of i)if(h.hasResult()){let u=h.result.getMatch;if(h.result.filter===!1)for(let f of h.result.options)r(new l_(f,h.source,u?u(f):[],1e9-e.length));else{let f=t.sliceDoc(h.from,h.to),d,p=o.filterStrict?new aB(f):new oB(f);for(let g of h.result.options)if(d=p.match(g.label)){let m=g.displayLabel?u?u(g,d.matched):[]:d.matched,O=d.score+(g.boost||0);if(r(new l_(g,h.source,m,O)),typeof g.section=="object"&&g.section.rank==="dynamic"){let{name:b}=g.section;n||(n=Object.create(null)),n[b]=Math.max(O,n[b]||-1e9)}}}}if(s){let h=Object.create(null),u=0,f=(d,p)=>(d.rank==="dynamic"&&p.rank==="dynamic"?n[p.name]-n[d.name]:0)||(typeof d.rank=="number"?d.rank:1e9)-(typeof p.rank=="number"?p.rank:1e9)||(d.name<p.name?-1:1);for(let d of s.sort(f))u-=1e5,h[d.name]=u;for(let d of e){let{section:p}=d.completion;p&&(d.score+=h[typeof p=="string"?p:p.name])}}let a=[],l=null,c=o.compareCompletions;for(let h of e.sort((u,f)=>f.score-u.score||c(u.completion,f.completion))){let u=h.completion;!l||l.label!=u.label||l.detail!=u.detail||l.type!=null&&u.type!=null&&l.type!=u.type||l.apply!=u.apply||l.boost!=u.boost?a.push(h):u_(h.completion)>u_(l)&&(a[a.length-1]=h),l=h.completion}return a}class ba{constructor(t,e,s,n,r,o){this.options=t,this.attrs=e,this.tooltip=s,this.timestamp=n,this.selected=r,this.disabled=o}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new ba(this.options,f_(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,s,n,r,o){if(n&&!o&&t.some(c=>c.isPending))return n.setDisabled();let a=dB(t,e);if(!a.length)return n&&t.some(c=>c.isPending)?n.setDisabled():null;let l=e.facet(He).selectOnOpen?0:-1;if(n&&n.selected!=l&&n.selected!=-1){let c=n.options[n.selected].completion;for(let h=0;h<a.length;h++)if(a[h].completion==c){l=h;break}}return new ba(a,f_(s,l),{pos:t.reduce((c,h)=>h.hasResult()?Math.min(c,h.from):c,1e8),create:bB,above:r.aboveCursor},n?n.timestamp:Date.now(),l,!1)}map(t){return new ba(this.options,this.attrs,{...this.tooltip,pos:t.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new ba(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class hd{constructor(t,e,s){this.active=t,this.id=e,this.open=s}static start(){return new hd(OB,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,s=e.facet(He),r=(s.override||e.languageDataAt("autocomplete",To(e)).map(rB)).map(l=>(this.active.find(h=>h.source==l)||new _s(l,this.active.some(h=>h.state!=0)?1:0)).update(t,s));r.length==this.active.length&&r.every((l,c)=>l==this.active[c])&&(r=this.active);let o=this.open,a=t.effects.some(l=>l.is(p1));o&&t.docChanged&&(o=o.map(t.changes)),t.selection||r.some(l=>l.hasResult()&&t.changes.touchesRange(l.from,l.to))||!pB(r,this.active)||a?o=ba.build(r,e,this.id,o,s,a):o&&o.disabled&&!r.some(l=>l.isPending)&&(o=null),!o&&r.every(l=>!l.isPending)&&r.some(l=>l.hasResult())&&(r=r.map(l=>l.hasResult()?new _s(l.source,0):l));for(let l of t.effects)l.is(oC)&&(o=o&&o.setSelected(l.value,this.id));return r==this.active&&o==this.open?this:new hd(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?gB:mB}}function pB(i,t){if(i==t)return!0;for(let e=0,s=0;;){for(;e<i.length&&!i[e].hasResult();)e++;for(;s<t.length&&!t[s].hasResult();)s++;let n=e==i.length,r=s==t.length;if(n||r)return n==r;if(i[e++].result!=t[s++].result)return!1}}const gB={"aria-autocomplete":"list"},mB={};function f_(i,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":i};return t>-1&&(e["aria-activedescendant"]=i+"-"+t),e}const OB=[];function rC(i,t){if(i.isUserEvent("input.complete")){let s=i.annotation(d1);if(s&&t.activateOnCompletion(s))return 12}let e=i.isUserEvent("input.type");return e&&t.activateOnTyping?5:e?1:i.isUserEvent("delete.backward")?2:i.selection?8:i.docChanged?16:0}class _s{constructor(t,e,s=!1){this.source=t,this.state=e,this.explicit=s}hasResult(){return!1}get isPending(){return this.state==1}update(t,e){let s=rC(t,e),n=this;(s&8||s&16&&this.touches(t))&&(n=new _s(n.source,0)),s&4&&n.state==0&&(n=new _s(this.source,1)),n=n.updateFor(t,s);for(let r of t.effects)if(r.is(cd))n=new _s(n.source,1,r.value);else if(r.is(qc))n=new _s(n.source,0);else if(r.is(p1))for(let o of r.value)o.source==n.source&&(n=o);return n}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(To(t.state))}}class Ea extends _s{constructor(t,e,s,n,r,o){super(t,3,e),this.limit=s,this.result=n,this.from=r,this.to=o}hasResult(){return!0}updateFor(t,e){var s;if(!(e&3))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let r=t.changes.mapPos(this.from),o=t.changes.mapPos(this.to,1),a=To(t.state);if(a>o||!n||e&2&&(To(t.startState)==this.from||a<this.limit))return new _s(this.source,e&4?1:0);let l=t.changes.mapPos(this.limit);return yB(n.validFor,t.state,r,o)?new Ea(this.source,this.explicit,l,n,r,o):n.update&&(n=n.update(n,r,o,new iC(t.state,a,!1)))?new Ea(this.source,this.explicit,l,n,n.from,(s=n.to)!==null&&s!==void 0?s:To(t.state)):new _s(this.source,1,this.explicit)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new Ea(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new _s(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}function yB(i,t,e,s){if(!i)return!1;let n=t.sliceDoc(e,s);return typeof i=="function"?i(n,e,s,t):nC(i,!0).test(n)}const p1=Et.define({map(i,t){return i.map(e=>e.map(t))}}),oC=Et.define(),Zi=Je.define({create(){return hd.start()},update(i,t){return i.update(t)},provide:i=>[KO.from(i,t=>t.tooltip),ht.contentAttributes.from(i,t=>t.attrs)]});function g1(i,t){const e=t.completion.apply||t.completion.label;let s=i.state.field(Zi).active.find(n=>n.source==t.source);return s instanceof Ea?(typeof e=="string"?i.dispatch({...nB(i.state,e,s.from,s.to),annotations:d1.of(t.completion)}):e(i,t.completion,s.from,s.to),!0):!1}const bB=uB(Zi,g1);function Lu(i,t="option"){return e=>{let s=e.state.field(Zi,!1);if(!s||!s.open||s.open.disabled||Date.now()-s.open.timestamp<e.state.facet(He).interactionDelay)return!1;let n=1,r;t=="page"&&(r=Lk(e,s.open.tooltip))&&(n=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=s.open.options,a=s.open.selected>-1?s.open.selected+n*(i?1:-1):i?0:o-1;return a<0?a=t=="page"?0:o-1:a>=o&&(a=t=="page"?o-1:0),e.dispatch({effects:oC.of(a)}),!0}}const vB=i=>{let t=i.state.field(Zi,!1);return i.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<i.state.facet(He).interactionDelay?!1:g1(i,t.open.options[t.open.selected])},_g=i=>i.state.field(Zi,!1)?(i.dispatch({effects:cd.of(!0)}),!0):!1,_B=i=>{let t=i.state.field(Zi,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(i.dispatch({effects:qc.of(null)}),!0)};class xB{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const SB=50,wB=1e3,kB=Me.fromClass(class{constructor(i){this.view=i,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let t of i.state.field(Zi).active)t.isPending&&this.startQuery(t)}update(i){let t=i.state.field(Zi),e=i.state.facet(He);if(!i.selectionSet&&!i.docChanged&&i.startState.field(Zi)==t)return;let s=i.transactions.some(r=>{let o=rC(r,e);return o&8||(r.selection||r.docChanged)&&!(o&3)});for(let r=0;r<this.running.length;r++){let o=this.running[r];if(s||o.context.abortOnDocChange&&i.docChanged||o.updates.length+i.transactions.length>SB&&Date.now()-o.time>wB){for(let a of o.context.abortListeners)try{a()}catch(l){qi(this.view.state,l)}o.context.abortListeners=null,this.running.splice(r--,1)}else o.updates.push(...i.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),i.transactions.some(r=>r.effects.some(o=>o.is(cd)))&&(this.pendingStart=!0);let n=this.pendingStart?50:e.activateOnTypingDelay;if(this.debounceUpdate=t.active.some(r=>r.isPending&&!this.running.some(o=>o.active.source==r.source))?setTimeout(()=>this.startUpdate(),n):-1,this.composing!=0)for(let r of i.transactions)r.isUserEvent("input.type")?this.composing=2:this.composing==2&&r.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:i}=this.view,t=i.field(Zi);for(let e of t.active)e.isPending&&!this.running.some(s=>s.active.source==e.source)&&this.startQuery(e);this.running.length&&t.open&&t.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(He).updateSyncTime))}startQuery(i){let{state:t}=this.view,e=To(t),s=new iC(t,e,i.explicit,this.view),n=new xB(i,s);this.running.push(n),Promise.resolve(i.source(s)).then(r=>{n.context.aborted||(n.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:qc.of(null)}),qi(this.view.state,r)})}scheduleAccept(){this.running.every(i=>i.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(He).updateSyncTime))}accept(){var i;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(He),s=this.view.state.field(Zi);for(let n=0;n<this.running.length;n++){let r=this.running[n];if(r.done===void 0)continue;if(this.running.splice(n--,1),r.done){let a=To(r.updates.length?r.updates[0].startState:this.view.state),l=Math.min(a,r.done.from+(r.active.explicit?0:1)),c=new Ea(r.active.source,r.active.explicit,l,r.done,r.done.from,(i=r.done.to)!==null&&i!==void 0?i:a);for(let h of r.updates)c=c.update(h,e);if(c.hasResult()){t.push(c);continue}}let o=s.active.find(a=>a.source==r.active.source);if(o&&o.isPending)if(r.done==null){let a=new _s(r.active.source,0);for(let l of r.updates)a=a.update(l,e);a.isPending||t.push(a)}else this.startQuery(o)}(t.length||s.open&&s.open.disabled)&&this.view.dispatch({effects:p1.of(t)})}},{eventHandlers:{blur(i){let t=this.view.state.field(Zi,!1);if(t&&t.tooltip&&this.view.state.facet(He).closeOnBlur){let e=t.open&&Lk(this.view,t.open.tooltip);(!e||!e.dom.contains(i.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:qc.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:cd.of(!1)}),20),this.composing=0}}}),CB=typeof navigator=="object"&&/Win/.test(navigator.platform),TB=no.highest(ht.domEventHandlers({keydown(i,t){let e=t.state.field(Zi,!1);if(!e||!e.open||e.open.disabled||e.open.selected<0||i.key.length>1||i.ctrlKey&&!(CB&&i.altKey)||i.metaKey)return!1;let s=e.open.options[e.open.selected],n=e.active.find(o=>o.source==s.source),r=s.completion.commitCharacters||n.result.commitCharacters;return r&&r.indexOf(i.key)>-1&&g1(t,s),!1}})),aC=ht.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class PB{constructor(t,e,s,n){this.field=t,this.line=e,this.from=s,this.to=n}}class m1{constructor(t,e,s){this.field=t,this.from=e,this.to=s}map(t){let e=t.mapPos(this.from,-1,ni.TrackDel),s=t.mapPos(this.to,1,ni.TrackDel);return e==null||s==null?null:new m1(this.field,e,s)}}class O1{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let s=[],n=[e],r=t.doc.lineAt(e),o=/^\s*/.exec(r.text)[0];for(let l of this.lines){if(s.length){let c=o,h=/^\t*/.exec(l)[0].length;for(let u=0;u<h;u++)c+=t.facet(Ch);n.push(e+c.length-h),l=c+l.slice(h)}s.push(l),e+=l.length+1}let a=this.fieldPositions.map(l=>new m1(l.field,n[l.line]+l.from,n[l.line]+l.to));return{text:s,ranges:a}}static parse(t){let e=[],s=[],n=[],r;for(let o of t.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let a=r[1]?+r[1]:null,l=r[2]||r[3]||"",c=-1,h=l.replace(/\\[{}]/g,u=>u[1]);for(let u=0;u<e.length;u++)(a!=null?e[u].seq==a:h&&e[u].name==h)&&(c=u);if(c<0){let u=0;for(;u<e.length&&(a==null||e[u].seq!=null&&e[u].seq<a);)u++;e.splice(u,0,{seq:a,name:h}),c=u;for(let f of n)f.field>=c&&f.field++}for(let u of n)if(u.line==s.length&&u.from>r.index){let f=r[2]?3+(r[1]||"").length:2;u.from-=f,u.to-=f}n.push(new PB(c,s.length,r.index,r.index+h.length)),o=o.slice(0,r.index)+l+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(a,l,c)=>{for(let h of n)h.line==s.length&&h.from>c&&(h.from--,h.to--);return l}),s.push(o)}return new O1(s,n)}}let AB=vt.widget({widget:new class extends Mn{toDOM(){let i=document.createElement("span");return i.className="cm-snippetFieldPosition",i}ignoreEvent(){return!1}}}),MB=vt.mark({class:"cm-snippetField"});class cl{constructor(t,e){this.ranges=t,this.active=e,this.deco=vt.set(t.map(s=>(s.from==s.to?AB:MB).range(s.from,s.to)),!0)}map(t){let e=[];for(let s of this.ranges){let n=s.map(t);if(!n)return null;e.push(n)}return new cl(e,this.active)}selectionInsideField(t){return t.ranges.every(e=>this.ranges.some(s=>s.field==this.active&&s.from<=e.from&&s.to>=e.to))}}const Eh=Et.define({map(i,t){return i&&i.map(t)}}),EB=Et.define(),Xc=Je.define({create(){return null},update(i,t){for(let e of t.effects){if(e.is(Eh))return e.value;if(e.is(EB)&&i)return new cl(i.ranges,e.value)}return i&&t.docChanged&&(i=i.map(t.changes)),i&&t.selection&&!i.selectionInsideField(t.selection)&&(i=null),i},provide:i=>ht.decorations.from(i,t=>t?t.deco:vt.none)});function y1(i,t){return G.create(i.filter(e=>e.field==t).map(e=>G.range(e.from,e.to)))}function RB(i){let t=O1.parse(i);return(e,s,n,r)=>{let{text:o,ranges:a}=t.instantiate(e.state,n),{main:l}=e.state.selection,c={changes:{from:n,to:r==l.from?l.to:r,insert:Wt.of(o)},scrollIntoView:!0,annotations:s?[d1.of(s),Le.userEvent.of("input.complete")]:void 0};if(a.length&&(c.selection=y1(a,0)),a.some(h=>h.field>0)){let h=new cl(a,0),u=c.effects=[Eh.of(h)];e.state.field(Xc,!1)===void 0&&u.push(Et.appendConfig.of([Xc,DB,LB,aC]))}e.dispatch(e.state.update(c))}}function lC(i){return({state:t,dispatch:e})=>{let s=t.field(Xc,!1);if(!s||i<0&&s.active==0)return!1;let n=s.active+i,r=i>0&&!s.ranges.some(o=>o.field==n+i);return e(t.update({selection:y1(s.ranges,n),effects:Eh.of(r?null:new cl(s.ranges,n)),scrollIntoView:!0})),!0}}const QB=({state:i,dispatch:t})=>i.field(Xc,!1)?(t(i.update({effects:Eh.of(null)})),!0):!1,IB=lC(1),$B=lC(-1),NB=[{key:"Tab",run:IB,shift:$B},{key:"Escape",run:QB}],d_=ft.define({combine(i){return i.length?i[0]:NB}}),DB=no.highest(wh.compute([d_],i=>i.facet(d_)));function Di(i,t){return{...t,apply:RB(i)}}const LB=ht.domEventHandlers({mousedown(i,t){let e=t.state.field(Xc,!1),s;if(!e||(s=t.posAtCoords({x:i.clientX,y:i.clientY}))==null)return!1;let n=e.ranges.find(r=>r.from<=s&&r.to>=s);return!n||n.field==e.active?!1:(t.dispatch({selection:y1(e.ranges,n.field),effects:Eh.of(e.ranges.some(r=>r.field>n.field)?new cl(e.ranges,n.field):null),scrollIntoView:!0}),!0)}}),zc={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},So=Et.define({map(i,t){let e=t.mapPos(i,-1,ni.TrackAfter);return e??void 0}}),b1=new class extends Qo{};b1.startSide=1;b1.endSide=-1;const cC=Je.define({create(){return zt.empty},update(i,t){if(i=i.map(t.changes),t.selection){let e=t.state.doc.lineAt(t.selection.main.head);i=i.update({filter:s=>s>=e.from&&s<=e.to})}for(let e of t.effects)e.is(So)&&(i=i.update({add:[b1.range(e.value,e.value+1)]}));return i}});function VB(){return[ZB,cC]}const xg="()[]{}<>";function hC(i){for(let t=0;t<xg.length;t+=2)if(xg.charCodeAt(t)==i)return xg.charAt(t+1);return LO(i<128?i:i+1)}function uC(i,t){return i.languageDataAt("closeBrackets",t)[0]||zc}const BB=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),ZB=ht.inputHandler.of((i,t,e,s)=>{if((BB?i.composing:i.compositionStarted)||i.state.readOnly)return!1;let n=i.state.selection.main;if(s.length>2||s.length==2&&un(Bi(s,0))==1||t!=n.from||e!=n.to)return!1;let r=qB(i.state,s);return r?(i.dispatch(r),!0):!1}),FB=({state:i,dispatch:t})=>{if(i.readOnly)return!1;let s=uC(i,i.selection.main.head).brackets||zc.brackets,n=null,r=i.changeByRange(o=>{if(o.empty){let a=XB(i.doc,o.head);for(let l of s)if(l==a&&dp(i.doc,o.head)==hC(Bi(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:G.cursor(o.head-l.length)}}return{range:n=o}});return n||t(i.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!n},WB=[{key:"Backspace",run:FB}];function qB(i,t){let e=uC(i,i.selection.main.head),s=e.brackets||zc.brackets;for(let n of s){let r=hC(Bi(n,0));if(t==n)return r==n?GB(i,n,s.indexOf(n+n+n)>-1,e):zB(i,n,r,e.before||zc.before);if(t==r&&fC(i,i.selection.main.from))return jB(i,n,r)}return null}function fC(i,t){let e=!1;return i.field(cC).between(0,i.doc.length,s=>{s==t&&(e=!0)}),e}function dp(i,t){let e=i.sliceString(t,t+2);return e.slice(0,un(Bi(e,0)))}function XB(i,t){let e=i.sliceString(t-2,t);return un(Bi(e,0))==e.length?e:e.slice(1)}function zB(i,t,e,s){let n=null,r=i.changeByRange(o=>{if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:e,from:o.to}],effects:So.of(o.to+t.length),range:G.range(o.anchor+t.length,o.head+t.length)};let a=dp(i.doc,o.head);return!a||/\s/.test(a)||s.indexOf(a)>-1?{changes:{insert:t+e,from:o.head},effects:So.of(o.head+t.length),range:G.cursor(o.head+t.length)}:{range:n=o}});return n?null:i.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function jB(i,t,e){let s=null,n=i.changeByRange(r=>r.empty&&dp(i.doc,r.head)==e?{changes:{from:r.head,to:r.head+e.length,insert:e},range:G.cursor(r.head+e.length)}:s={range:r});return s?null:i.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function GB(i,t,e,s){let n=s.stringPrefixes||zc.stringPrefixes,r=null,o=i.changeByRange(a=>{if(!a.empty)return{changes:[{insert:t,from:a.from},{insert:t,from:a.to}],effects:So.of(a.to+t.length),range:G.range(a.anchor+t.length,a.head+t.length)};let l=a.head,c=dp(i.doc,l),h;if(c==t){if(p_(i,l))return{changes:{insert:t+t,from:l},effects:So.of(l+t.length),range:G.cursor(l+t.length)};if(fC(i,l)){let f=e&&i.sliceDoc(l,l+t.length*3)==t+t+t?t+t+t:t;return{changes:{from:l,to:l+f.length,insert:f},range:G.cursor(l+f.length)}}}else{if(e&&i.sliceDoc(l-2*t.length,l)==t+t&&(h=g_(i,l-2*t.length,n))>-1&&p_(i,h))return{changes:{insert:t+t+t+t,from:l},effects:So.of(l+t.length),range:G.cursor(l+t.length)};if(i.charCategorizer(l)(c)!=we.Word&&g_(i,l,n)>-1&&!YB(i,l,t,n))return{changes:{insert:t+t,from:l},effects:So.of(l+t.length),range:G.cursor(l+t.length)}}return{range:r=a}});return r?null:i.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function p_(i,t){let e=Ge(i).resolveInner(t+1);return e.parent&&e.from==t}function YB(i,t,e,s){let n=Ge(i).resolveInner(t,-1),r=s.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=i.sliceDoc(n.from,Math.min(n.to,n.from+e.length+r)),l=a.indexOf(e);if(!l||l>-1&&s.indexOf(a.slice(0,l))>-1){let h=n.firstChild;for(;h&&h.from==n.from&&h.to-h.from>e.length+l;){if(i.sliceDoc(h.to-e.length,h.to)==e)return!1;h=h.firstChild}return!0}let c=n.to==t&&n.parent;if(!c)break;n=c}return!1}function g_(i,t,e){let s=i.charCategorizer(t);if(s(i.sliceDoc(t-1,t))!=we.Word)return t;for(let n of e){let r=t-n.length;if(i.sliceDoc(r,t)==n&&s(i.sliceDoc(r-1,r))!=we.Word)return r}return-1}function UB(i={}){return[TB,Zi,He.of(i),kB,HB,aC]}const dC=[{key:"Ctrl-Space",run:_g},{mac:"Alt-`",run:_g},{mac:"Alt-i",run:_g},{key:"Escape",run:_B},{key:"ArrowDown",run:Lu(!0)},{key:"ArrowUp",run:Lu(!1)},{key:"PageDown",run:Lu(!0,"page")},{key:"PageUp",run:Lu(!1,"page")},{key:"Enter",run:vB}],HB=no.highest(wh.computeN([He],i=>i.facet(He).defaultKeymap?[dC]:[]));class m_{constructor(t,e,s){this.from=t,this.to=e,this.diagnostic=s}}class Oo{constructor(t,e,s){this.diagnostics=t,this.panel=e,this.selected=s}static init(t,e,s){let n=s.facet(jc).markerFilter;n&&(t=n(t,s));let r=t.slice().sort((h,u)=>h.from-u.from||h.to-u.to),o=new Jn,a=[],l=0;for(let h=0;;){let u=h==r.length?null:r[h];if(!u&&!a.length)break;let f,d;for(a.length?(f=l,d=a.reduce((g,m)=>Math.min(g,m.to),u&&u.from>f?u.from:1e8)):(f=u.from,d=u.to,a.push(u),h++);h<r.length;){let g=r[h];if(g.from==f&&(g.to>g.from||g.to==f))a.push(g),h++,d=Math.min(g.to,d);else{d=Math.min(g.from,d);break}}let p=hZ(a);if(a.some(g=>g.from==g.to||g.from==g.to-1&&s.doc.lineAt(g.from).to==g.from))o.add(f,f,vt.widget({widget:new oZ(p),diagnostics:a.slice()}));else{let g=a.reduce((m,O)=>O.markClass?m+" "+O.markClass:m,"");o.add(f,d,vt.mark({class:"cm-lintRange cm-lintRange-"+p+g,diagnostics:a.slice(),inclusiveEnd:a.some(m=>m.to>d)}))}l=d;for(let g=0;g<a.length;g++)a[g].to<=l&&a.splice(g--,1)}let c=o.finish();return new Oo(c,e,Ya(c))}}function Ya(i,t=null,e=0){let s=null;return i.between(e,1e9,(n,r,{spec:o})=>{if(!(t&&o.diagnostics.indexOf(t)<0))if(!s)s=new m_(n,r,t||o.diagnostics[0]);else{if(o.diagnostics.indexOf(s.diagnostic)<0)return!1;s=new m_(s.from,r,s.diagnostic)}}),s}function KB(i,t){let e=t.pos,s=t.end||e,n=i.state.facet(jc).hideOn(i,e,s);if(n!=null)return n;let r=i.startState.doc.lineAt(t.pos);return!!(i.effects.some(o=>o.is(pC))||i.changes.touchesRange(r.from,Math.max(r.to,s)))}function JB(i,t){return i.field(as,!1)?t:t.concat(Et.appendConfig.of(uZ))}const pC=Et.define(),v1=Et.define(),gC=Et.define(),as=Je.define({create(){return new Oo(vt.none,null,null)},update(i,t){if(t.docChanged&&i.diagnostics.size){let e=i.diagnostics.map(t.changes),s=null,n=i.panel;if(i.selected){let r=t.changes.mapPos(i.selected.from,1);s=Ya(e,i.selected.diagnostic,r)||Ya(e,null,r)}!e.size&&n&&t.state.facet(jc).autoPanel&&(n=null),i=new Oo(e,n,s)}for(let e of t.effects)if(e.is(pC)){let s=t.state.facet(jc).autoPanel?e.value.length?Gc.open:null:i.panel;i=Oo.init(e.value,s,t.state)}else e.is(v1)?i=new Oo(i.diagnostics,e.value?Gc.open:null,i.selected):e.is(gC)&&(i=new Oo(i.diagnostics,i.panel,e.value));return i},provide:i=>[Bc.from(i,t=>t.panel),ht.decorations.from(i,t=>t.diagnostics)]}),tZ=vt.mark({class:"cm-lintRange cm-lintRange-active"});function eZ(i,t,e){let{diagnostics:s}=i.state.field(as),n,r=-1,o=-1;s.between(t-(e<0?1:0),t+(e>0?1:0),(l,c,{spec:h})=>{if(t>=l&&t<=c&&(l==c||(t>l||e>0)&&(t<c||e<0)))return n=h.diagnostics,r=l,o=c,!1});let a=i.state.facet(jc).tooltipFilter;return n&&a&&(n=a(n,i.state)),n?{pos:r,end:o,above:i.state.doc.lineAt(r).to<o,create(){return{dom:iZ(i,n)}}}:null}function iZ(i,t){return ie("ul",{class:"cm-tooltip-lint"},t.map(e=>OC(i,e,!1)))}const sZ=i=>{let t=i.state.field(as,!1);(!t||!t.panel)&&i.dispatch({effects:JB(i.state,[v1.of(!0)])});let e=Vc(i,Gc.open);return e&&e.dom.querySelector(".cm-panel-lint ul").focus(),!0},O_=i=>{let t=i.state.field(as,!1);return!t||!t.panel?!1:(i.dispatch({effects:v1.of(!1)}),!0)},nZ=i=>{let t=i.state.field(as,!1);if(!t)return!1;let e=i.state.selection.main,s=t.diagnostics.iter(e.to+1);return!s.value&&(s=t.diagnostics.iter(0),!s.value||s.from==e.from&&s.to==e.to)?!1:(i.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0}),!0)},rZ=[{key:"Mod-Shift-m",run:sZ,preventDefault:!0},{key:"F8",run:nZ}],jc=ft.define({combine(i){return{sources:i.map(t=>t.source).filter(t=>t!=null),...An(i.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:y_,tooltipFilter:y_,needsRefresh:(t,e)=>t?e?s=>t(s)||e(s):t:e,hideOn:(t,e)=>t?e?(s,n,r)=>t(s,n,r)||e(s,n,r):t:e,autoPanel:(t,e)=>t||e})}}});function y_(i,t){return i?t?(e,s)=>t(i(e,s),s):i:t}function mC(i){let t=[];if(i)t:for(let{name:e}of i){for(let s=0;s<e.length;s++){let n=e[s];if(/[a-zA-Z]/.test(n)&&!t.some(r=>r.toLowerCase()==n.toLowerCase())){t.push(n);continue t}}t.push("")}return t}function OC(i,t,e){var s;let n=e?mC(t.actions):[];return ie("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},ie("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(i):t.message),(s=t.actions)===null||s===void 0?void 0:s.map((r,o)=>{let a=!1,l=d=>{if(d.preventDefault(),a)return;a=!0;let p=Ya(i.state.field(as).diagnostics,t);p&&r.apply(i,p.from,p.to)},{name:c}=r,h=n[o]?c.indexOf(n[o]):-1,u=h<0?c:[c.slice(0,h),ie("u",c.slice(h,h+1)),c.slice(h+1)],f=r.markClass?" "+r.markClass:"";return ie("button",{type:"button",class:"cm-diagnosticAction"+f,onclick:l,onmousedown:l,"aria-label":` Action: ${c}${h<0?"":` (access key "${n[o]})"`}.`},u)}),t.source&&ie("div",{class:"cm-diagnosticSource"},t.source))}class oZ extends Mn{constructor(t){super(),this.sev=t}eq(t){return t.sev==this.sev}toDOM(){return ie("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class b_{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=OC(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Gc{constructor(t){this.view=t,this.items=[];let e=n=>{if(n.keyCode==27)O_(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],o=mC(r.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==n.keyCode){let l=Ya(this.view.state.field(as).diagnostics,r);l&&r.actions[a].apply(t,l.from,l.to)}}else return;n.preventDefault()},s=n=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(n.target)&&this.moveSelection(r)};this.list=ie("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:s}),this.dom=ie("div",{class:"cm-panel-lint"},this.list,ie("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>O_(this.view)},"")),this.update()}get selectedIndex(){let t=this.view.state.field(as).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(as),s=0,n=!1,r=null,o=new Set;for(t.between(0,this.view.state.doc.length,(a,l,{spec:c})=>{for(let h of c.diagnostics){if(o.has(h))continue;o.add(h);let u=-1,f;for(let d=s;d<this.items.length;d++)if(this.items[d].diagnostic==h){u=d;break}u<0?(f=new b_(this.view,h),this.items.splice(s,0,f),n=!0):(f=this.items[u],u>s&&(this.items.splice(s,u-s),n=!0)),e&&f.diagnostic==e.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),r=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),s++}});s<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new b_(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:a,panel:l})=>{let c=l.height/this.list.offsetHeight;a.top<l.top?this.list.scrollTop-=(l.top-a.top)/c:a.bottom>l.bottom&&(this.list.scrollTop+=(a.bottom-l.bottom)/c)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let s=t;t=s.nextSibling,s.remove()}for(let s of this.items)if(s.dom.parentNode==this.list){for(;t!=s.dom;)e();t=s.dom.nextSibling}else this.list.insertBefore(s.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(as),s=Ya(e.diagnostics,this.items[t].diagnostic);s&&this.view.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:gC.of(s)})}static open(t){return new Gc(t)}}function aZ(i,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(i)}</svg>')`}function Vu(i){return aZ(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${i}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const lZ=ht.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Vu("#d11")},".cm-lintRange-warning":{backgroundImage:Vu("orange")},".cm-lintRange-info":{backgroundImage:Vu("#999")},".cm-lintRange-hint":{backgroundImage:Vu("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function cZ(i){return i=="error"?4:i=="warning"?3:i=="info"?2:1}function hZ(i){let t="hint",e=1;for(let s of i){let n=cZ(s.severity);n>e&&(e=n,t=s.severity)}return t}const uZ=[as,ht.decorations.compute([as],i=>{let{selected:t,panel:e}=i.field(as);return!t||!e||t.from==t.to?vt.none:vt.set([tZ.range(t.from,t.to)])}),jN(eZ,{hideOn:KB}),lZ],fZ=[nD(),aD(),xN(),wL(),HD(),uN(),mN(),Vt.allowMultipleSelections.of(!0),DD(),h5(eL,{fallback:!0}),lL(),VB(),UB(),NN(),VN(),PN(),QV(),wh.of([...WB,...CV,...KV,...QL,...jD,...dC,...rZ])];/*!
* VueCodemirror v6.1.1
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon
*/var dZ=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[fZ]}),pZ=Symbol("vue-codemirror-global-config"),Ci,gZ=function(i){var t=i.onUpdate,e=i.onChange,s=i.onFocus,n=i.onBlur,r=(function(o,a){var l={};for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&a.indexOf(c)<0&&(l[c]=o[c]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function"){var h=0;for(c=Object.getOwnPropertySymbols(o);h<c.length;h++)a.indexOf(c[h])<0&&Object.prototype.propertyIsEnumerable.call(o,c[h])&&(l[c[h]]=o[c[h]])}return l})(i,["onUpdate","onChange","onFocus","onBlur"]);return Vt.create({doc:r.doc,selection:r.selection,extensions:(Array.isArray(r.extensions)?r.extensions:[r.extensions]).concat([ht.updateListener.of((function(o){t(o),o.docChanged&&e(o.state.doc.toString(),o),o.focusChanged&&(o.view.hasFocus?s(o):n(o))}))])})},ua=function(i){var t=new bh;return{compartment:t,run:function(e){t.get(i.state)?i.dispatch({effects:t.reconfigure(e)}):i.dispatch({effects:Et.appendConfig.of(t.of(e))})}}},v_=function(i,t){var e=ua(i),s=e.compartment,n=e.run;return function(r){var o=s.get(i.state);n(r??o!==t?t:[])}},Bu={type:Boolean,default:void 0},mZ={autofocus:Bu,disabled:Bu,indentWithTab:Bu,tabSize:Number,placeholder:String,style:Object,autoDestroy:Bu,phrases:Object,root:Object,extensions:Array,selection:Object},OZ={modelValue:{type:String,default:""}},yZ=Object.assign(Object.assign({},mZ),OZ);(function(i){i.Change="change",i.Update="update",i.Focus="focus",i.Blur="blur",i.Ready="ready",i.ModelUpdate="update:modelValue"})(Ci||(Ci={}));var yo={};yo[Ci.Change]=function(i,t){return!0},yo[Ci.Update]=function(i){return!0},yo[Ci.Focus]=function(i){return!0},yo[Ci.Blur]=function(i){return!0},yo[Ci.Ready]=function(i){return!0};var yC={};yC[Ci.ModelUpdate]=yo[Ci.Change];var bZ=Object.assign(Object.assign({},yo),yC),vZ=Vo({name:"VueCodemirror",props:Object.assign({},yZ),emits:Object.assign({},bZ),setup:function(i,t){var e=kp(),s=kp(),n=kp(),r=Object.assign(Object.assign({},dZ),oc(pZ,{})),o=Rs((function(){var a={};return Object.keys(Gt(i)).forEach((function(l){var c;l!=="modelValue"&&(a[l]=(c=i[l])!==null&&c!==void 0?c:r[l])})),a}));return Jc((function(){var a;s.value=gZ({doc:i.modelValue,selection:o.value.selection,extensions:(a=r.extensions)!==null&&a!==void 0?a:[],onFocus:function(c){return t.emit(Ci.Focus,c)},onBlur:function(c){return t.emit(Ci.Blur,c)},onUpdate:function(c){return t.emit(Ci.Update,c)},onChange:function(c,h){c!==i.modelValue&&(t.emit(Ci.Change,c,h),t.emit(Ci.ModelUpdate,c,h))}}),n.value=(function(c){return new ht(Object.assign({},c))})({state:s.value,parent:e.value,root:o.value.root});var l=(function(c){var h=function(){return c.state.doc.toString()},u=ua(c).run,f=v_(c,[ht.editable.of(!1),Vt.readOnly.of(!0)]),d=v_(c,wh.of([TV])),p=ua(c).run,g=ua(c).run,m=ua(c).run,O=ua(c).run;return{focus:function(){return c.focus()},getDoc:h,setDoc:function(b){b!==h()&&c.dispatch({changes:{from:0,to:c.state.doc.length,insert:b}})},reExtensions:u,toggleDisabled:f,toggleIndentWithTab:d,setTabSize:function(b){p([Vt.tabSize.of(b),Ch.of(" ".repeat(b))])},setPhrases:function(b){g([Vt.phrases.of(b)])},setPlaceholder:function(b){m(RN(b))},setStyle:function(b){b===void 0&&(b={}),O(ht.theme({"&":Object.assign({},b)}))}}})(n.value);We((function(){return i.modelValue}),(function(c){c!==l.getDoc()&&l.setDoc(c)})),We((function(){return i.extensions}),(function(c){return l.reExtensions(c||[])}),{immediate:!0}),We((function(){return o.value.disabled}),(function(c){return l.toggleDisabled(c)}),{immediate:!0}),We((function(){return o.value.indentWithTab}),(function(c){return l.toggleIndentWithTab(c)}),{immediate:!0}),We((function(){return o.value.tabSize}),(function(c){return l.setTabSize(c)}),{immediate:!0}),We((function(){return o.value.phrases}),(function(c){return l.setPhrases(c||{})}),{immediate:!0}),We((function(){return o.value.placeholder}),(function(c){return l.setPlaceholder(c)}),{immediate:!0}),We((function(){return o.value.style}),(function(c){return l.setStyle(c)}),{immediate:!0}),o.value.autofocus&&l.focus(),t.emit(Ci.Ready,{state:s.value,view:n.value,container:e.value})})),$0((function(){o.value.autoDestroy&&n.value&&(function(a){a.destroy()})(n.value)})),function(){return i4("div",{class:"v-codemirror",style:{display:"contents"},ref:e})}}}),_Z=vZ,__={};class ud{constructor(t,e,s,n,r,o,a,l,c,h=0,u){this.p=t,this.stack=e,this.state=s,this.reducePos=n,this.pos=r,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=c,this.lookAhead=h,this.parent=u}toString(){return`[${this.stack.filter((t,e)=>e%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,s=0){let n=t.parser.context;return new ud(t,[],e,s,s,0,[],0,n?new x_(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let s=t>>19,n=t&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let a=r.dynamicPrecedence(n);if(a&&(this.score+=a),s==0){this.pushState(r.getGoto(this.state,n,!0),this.reducePos),n<r.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(n,this.reducePos);return}let l=this.stack.length-(s-1)*3-(t&262144?6:0),c=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-c;h>=2e3&&!(!((e=this.p.parser.nodeSet.types[n])===null||e===void 0)&&e.isAnonymous)&&(c==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=c,this.p.lastBigReductionSize=h));let u=l?this.stack[l-1]:0,f=this.bufferBase+this.buffer.length-u;if(n<r.minRepeatTerm||t&131072){let d=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,c,d,f+4,!0)}if(t&262144)this.state=this.stack[l];else{let d=this.stack[l-3];this.state=r.getGoto(d,n,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(n,c)}storeNode(t,e,s,n=4,r=!1){if(t==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(e==s)return;if(o.buffer[a-2]>=e){o.buffer[a-2]=s;return}}}if(!r||this.pos==s)this.buffer.push(t,e,s,n);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let a=!1;for(let l=o;l>0&&this.buffer[l-2]>s;l-=4)if(this.buffer[l-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>s;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,n>4&&(n-=4)}this.buffer[o]=t,this.buffer[o+1]=e,this.buffer[o+2]=s,this.buffer[o+3]=n}}shift(t,e,s,n){if(t&131072)this.pushState(t&65535,this.pos);else if((t&262144)==0){let r=t,{parser:o}=this.p;(n>this.pos||e<=o.maxNode)&&(this.pos=n,o.stateFlag(r,1)||(this.reducePos=n)),this.pushState(r,s),this.shiftContext(e,s),e<=o.maxNode&&this.buffer.push(e,s,n,4)}else this.pos=n,this.shiftContext(e,s),e<=this.p.parser.maxNode&&this.buffer.push(e,s,n,4)}apply(t,e,s,n){t&65536?this.reduce(t):this.shift(t,e,s,n)}useNode(t,e){let s=this.p.reused.length-1;(s<0||this.p.reused[s]!=t)&&(this.p.reused.push(t),s++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(s,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let s=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new ud(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,s,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let s=t<=this.p.parser.maxNode;s&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,s?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new xZ(this);;){let s=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(s==0)return!1;if((s&65536)==0)return!0;e.reduce(s)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let n=[];for(let r=0,o;r<e.length;r+=2)(o=e[r+1])!=this.state&&this.p.parser.hasAction(o,t)&&n.push(e[r],o);if(this.stack.length<120)for(let r=0;n.length<8&&r<e.length;r+=2){let o=e[r+1];n.some((a,l)=>l&1&&a==o)||n.push(e[r],o)}e=n}let s=[];for(let n=0;n<e.length&&s.length<4;n+=2){let r=e[n+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(e[n],this.pos),o.reducePos=this.pos,o.score-=200,s.push(o)}return s}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if((e&65536)==0)return!1;if(!t.validAction(this.state,e)){let s=e>>19,n=e&65535,r=this.stack.length-s*3;if(r<0||t.getGoto(this.stack[r],n,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;e=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],s=(n,r)=>{if(!e.includes(n))return e.push(n),t.allActions(n,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-r;if(a>1){let l=o&65535,c=this.stack.length-a*3;if(c>=0&&t.getGoto(this.stack[c],l,!1)>=0)return a<<19|65536|l}}else{let a=s(o,r+1);if(a!=null)return a}})};return s(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:t}=this.p;return t.data[t.stateSlot(this.state,1)]==65535&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||this.buffer[t]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new x_(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class x_{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class xZ{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=t&65535,s=t>>19;s==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(s-1)*3;let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class fd{constructor(t,e,s){this.stack=t,this.pos=e,this.index=s,this.buffer=t.buffer,this.index==0&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new fd(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;t!=null&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new fd(this.stack,this.pos,this.index)}}function Jl(i,t=Uint16Array){if(typeof i!="string")return i;let e=null;for(let s=0,n=0;s<i.length;){let r=0;for(;;){let o=i.charCodeAt(s++),a=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),r+=l,a)break;r*=46}e?e[n++]=r:e=new t(r)}return e}class af{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const S_=new af;class SZ{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=S_,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let s=this.range,n=this.rangeIndex,r=this.pos+t;for(;r<s.from;){if(!n)return null;let o=this.ranges[--n];r-=s.from-o.to,s=o}for(;e<0?r>s.to:r>=s.to;){if(n==this.ranges.length-1)return null;let o=this.ranges[++n];r+=o.from-s.to,s=o}return r}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e=this.chunkOff+t,s,n;if(e>=0&&e<this.chunk.length)s=this.pos+t,n=this.chunk.charCodeAt(e);else{let r=this.resolveOffset(t,1);if(r==null)return-1;if(s=r,s>=this.chunk2Pos&&s<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(s-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=s;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=s),s+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-s)),n=this.chunk2.charCodeAt(0)}}return s>=this.token.lookAhead&&(this.token.lookAhead=s+1),n}acceptToken(t,e=0){let s=e?this.resolveOffset(e,-1):this.pos;if(s==null||s<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=s}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=S_,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let s="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(s+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return s}}class Ra{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:s}=e.p;bC(this.data,t,e,this.id,s.data,s.tokenPrecTable)}}Ra.prototype.contextual=Ra.prototype.fallback=Ra.prototype.extend=!1;class d0{constructor(t,e,s){this.precTable=e,this.elseToken=s,this.data=typeof t=="string"?Jl(t):t}token(t,e){let s=t.pos,n=0;for(;;){let r=t.next<0,o=t.resolveOffset(1,1);if(bC(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(this.elseToken==null)return;if(r||n++,o==null)break;t.reset(o,t.token)}n&&(t.reset(s,t.token),t.acceptToken(this.elseToken,n))}}d0.prototype.contextual=Ra.prototype.fallback=Ra.prototype.extend=!1;class Rh{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function bC(i,t,e,s,n,r){let o=0,a=1<<s,{dialect:l}=e.p.parser;t:for(;(a&i[o])!=0;){let c=i[o+1];for(let d=o+3;d<c;d+=2)if((i[d+1]&a)>0){let p=i[d];if(l.allows(p)&&(t.token.value==-1||t.token.value==p||wZ(p,t.token.value,n,r))){t.acceptToken(p);break}}let h=t.next,u=0,f=i[o+2];if(t.next<0&&f>u&&i[c+f*3-3]==65535){o=i[c+f*3-1];continue t}for(;u<f;){let d=u+f>>1,p=c+d+(d<<1),g=i[p],m=i[p+1]||65536;if(h<g)f=d;else if(h>=m)u=d+1;else{o=i[p+2],t.advance();continue t}}break}}function w_(i,t,e){for(let s=t,n;(n=i[s])!=65535;s++)if(n==e)return s-t;return-1}function wZ(i,t,e,s){let n=w_(e,s,t);return n<0||w_(e,s,i)<n}const Ji=typeof process<"u"&&__&&/\bparse\b/.test(__.LOG);let Sg=null;function k_(i,t,e){let s=i.cursor(ze.IncludeAnonymous);for(s.moveTo(t);;)if(!(e<0?s.childBefore(t):s.childAfter(t)))for(;;){if((e<0?s.to<t:s.from>t)&&!s.type.isError)return e<0?Math.max(0,Math.min(s.to-1,t-25)):Math.min(i.length,Math.max(s.from+1,t+25));if(e<0?s.prevSibling():s.nextSibling())break;if(!s.parent())return e<0?0:i.length}}class kZ{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?k_(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?k_(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let s=this.trees[e],n=this.index[e];if(n==s.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=s.children[n],o=this.start[e]+s.positions[n];if(o>t)return this.nextStart=o,null;if(r instanceof Ve){if(o==t){if(o<this.safeFrom)return null;let a=o+r.length;if(a<=this.safeTo){let l=r.prop(Dt.lookAhead);if(!l||a+l<this.fragment.to)return r}}this.index[e]++,o+r.length>=Math.max(this.safeFrom,t)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+r.length}}}class CZ{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map(s=>new af)}getActions(t){let e=0,s=null,{parser:n}=t.p,{tokenizers:r}=n,o=n.stateSlot(t.state,3),a=t.curContext?t.curContext.hash:0,l=0;for(let c=0;c<r.length;c++){if((1<<c&o)==0)continue;let h=r[c],u=this.tokens[c];if(!(s&&!h.fallback)&&((h.contextual||u.start!=t.pos||u.mask!=o||u.context!=a)&&(this.updateCachedToken(u,h,t),u.mask=o,u.context=a),u.lookAhead>u.end+25&&(l=Math.max(u.lookAhead,l)),u.value!=0)){let f=e;if(u.extended>-1&&(e=this.addActions(t,u.extended,u.end,e)),e=this.addActions(t,u.value,u.end,e),!h.extend&&(s=u,e>f))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),!s&&t.pos==this.stream.end&&(s=new af,s.value=t.p.parser.eofTerm,s.start=s.end=t.pos,e=this.addActions(t,s.value,s.end,e)),this.mainToken=s,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new af,{pos:s,p:n}=t;return e.start=s,e.end=Math.min(s+1,n.stream.end),e.value=s==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,s){let n=this.stream.clipPos(s.pos);if(e.token(this.stream.reset(n,t),s),t.value>-1){let{parser:r}=s.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==t.value){let a=r.specializers[o](this.stream.read(t.start,t.end),s);if(a>=0&&s.p.parser.dialect.allows(a>>1)){(a&1)==0?t.value=a>>1:t.extended=a>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,s,n){for(let r=0;r<n;r+=3)if(this.actions[r]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=s,n}addActions(t,e,s,n){let{state:r}=t,{parser:o}=t.p,{data:a}=o;for(let l=0;l<2;l++)for(let c=o.stateSlot(r,l?2:1);;c+=3){if(a[c]==65535)if(a[c+1]==1)c=Vn(a,c+2);else{n==0&&a[c+1]==2&&(n=this.putAction(Vn(a,c+2),e,s,n));break}a[c]==e&&(n=this.putAction(Vn(a,c+1),e,s,n))}return n}}class TZ{constructor(t,e,s,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new SZ(e,n),this.tokens=new CZ(t,this.stream),this.topTerm=t.top[1];let{from:r}=n[0];this.stacks=[ud.start(this,t.top[0],r)],this.fragments=s.length&&this.stream.end-r>t.bufferLength*4?new kZ(s,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t=this.stacks,e=this.minStackPos,s=this.stacks=[],n,r;if(this.bigReductionCount>300&&t.length==1){let[o]=t;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<t.length;o++){let a=t[o];for(;;){if(this.tokens.mainToken=null,a.pos>e)s.push(a);else{if(this.advanceStack(a,s,t))continue;{n||(n=[],r=[]),n.push(a);let l=this.tokens.getMainToken(a);r.push(l.value,l.end)}}break}}if(!s.length){let o=n&&MZ(n);if(o)return Ji&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Ji&&n&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&n){let o=this.stoppedAt!=null&&n[0].pos>this.stoppedAt?n[0]:this.runRecovery(n,r,s);if(o)return Ji&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(s.length>o)for(s.sort((a,l)=>l.score-a.score);s.length>o;)s.pop();s.some(a=>a.reducePos>e)&&this.recovering--}else if(s.length>1){t:for(let o=0;o<s.length-1;o++){let a=s[o];for(let l=o+1;l<s.length;l++){let c=s[l];if(a.sameState(c)||a.buffer.length>500&&c.buffer.length>500)if((a.score-c.score||a.buffer.length-c.buffer.length)>0)s.splice(l--,1);else{s.splice(o--,1);continue t}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let o=1;o<s.length;o++)s[o].pos<this.minStackPos&&(this.minStackPos=s[o].pos);return null}stopAt(t){if(this.stoppedAt!=null&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,s){let n=t.pos,{parser:r}=this,o=Ji?this.stackID(t)+" -> ":"";if(this.stoppedAt!=null&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let c=t.curContext&&t.curContext.tracker.strict,h=c?t.curContext.hash:0;for(let u=this.fragments.nodeAt(n);u;){let f=this.parser.nodeSet.types[u.type.id]==u.type?r.getGoto(t.state,u.type.id):-1;if(f>-1&&u.length&&(!c||(u.prop(Dt.contextHash)||0)==h))return t.useNode(u,f),Ji&&console.log(o+this.stackID(t)+` (via reuse of ${r.getName(u.type.id)})`),!0;if(!(u instanceof Ve)||u.children.length==0||u.positions[0]>0)break;let d=u.children[0];if(d instanceof Ve&&u.positions[0]==0)u=d;else break}}let a=r.stateSlot(t.state,4);if(a>0)return t.reduce(a),Ji&&console.log(o+this.stackID(t)+` (via always-reduce ${r.getName(a&65535)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let c=0;c<l.length;){let h=l[c++],u=l[c++],f=l[c++],d=c==l.length||!s,p=d?t:t.split(),g=this.tokens.mainToken;if(p.apply(h,u,g?g.start:p.pos,f),Ji&&console.log(o+this.stackID(p)+` (via ${(h&65536)==0?"shift":`reduce of ${r.getName(h&65535)}`} for ${r.getName(u)} @ ${n}${p==t?"":", split"})`),d)return!0;p.pos>n?e.push(p):s.push(p)}return!1}advanceFully(t,e){let s=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>s)return C_(t,e),!0}}runRecovery(t,e,s){let n=null,r=!1;for(let o=0;o<t.length;o++){let a=t[o],l=e[o<<1],c=e[(o<<1)+1],h=Ji?this.stackID(a)+" -> ":"";if(a.deadEnd&&(r||(r=!0,a.restart(),Ji&&console.log(h+this.stackID(a)+" (restarted)"),this.advanceFully(a,s))))continue;let u=a.split(),f=h;for(let d=0;u.forceReduce()&&d<10&&(Ji&&console.log(f+this.stackID(u)+" (via force-reduce)"),!this.advanceFully(u,s));d++)Ji&&(f=this.stackID(u)+" -> ");for(let d of a.recoverByInsert(l))Ji&&console.log(h+this.stackID(d)+" (via recover-insert)"),this.advanceFully(d,s);this.stream.end>a.pos?(c==a.pos&&(c++,l=0),a.recoverByDelete(l,c),Ji&&console.log(h+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),C_(a,s)):(!n||n.score<a.score)&&(n=a)}return n}stackToTree(t){return t.close(),Ve.build({buffer:fd.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(Sg||(Sg=new WeakMap)).get(t);return e||Sg.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function C_(i,t){for(let e=0;e<t.length;e++){let s=t[e];if(s.pos==i.pos&&s.sameState(i)){t[e].score<i.score&&(t[e]=i);return}}t.push(i)}class PZ{constructor(t,e,s){this.source=t,this.flags=e,this.disabled=s}allows(t){return!this.disabled||this.disabled[t]==0}}const wg=i=>i;class AZ{constructor(t){this.start=t.start,this.shift=t.shift||wg,this.reduce=t.reduce||wg,this.reuse=t.reuse||wg,this.hash=t.hash||(()=>0),this.strict=t.strict!==!1}}class dd extends zk{constructor(t){if(super(),this.wrappers=[],t.version!=14)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let a=0;a<t.repeatNodeCount;a++)e.push("");let s=Object.keys(t.topRules).map(a=>t.topRules[a][1]),n=[];for(let a=0;a<e.length;a++)n.push([]);function r(a,l,c){n[a].push([l,l.deserialize(String(c))])}if(t.nodeProps)for(let a of t.nodeProps){let l=a[0];typeof l=="string"&&(l=Dt[l]);for(let c=1;c<a.length;){let h=a[c++];if(h>=0)r(h,l,a[c++]);else{let u=a[c+-h];for(let f=-h;f>0;f--)r(a[c++],l,u);c++}}}this.nodeSet=new JO(e.map((a,l)=>Yi.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:n[l],top:s.indexOf(l)>-1,error:l==0,skipped:t.skippedNodes&&t.skippedNodes.indexOf(l)>-1}))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=Fk;let o=Jl(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(T_),this.states=Jl(t.states,Uint32Array),this.data=Jl(t.stateData),this.goto=Jl(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map(a=>typeof a=="number"?new Ra(o,a):a),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,s){let n=new TZ(this,t,e,s);for(let r of this.wrappers)n=r(n,t,e,s);return n}getGoto(t,e,s=!1){let n=this.goto;if(e>=n[0])return-1;for(let r=n[e+1];;){let o=n[r++],a=o&1,l=n[r++];if(a&&s)return l;for(let c=r+(o>>1);r<c;r++)if(n[r]==t)return l;if(a)return-1}}hasAction(t,e){let s=this.data;for(let n=0;n<2;n++)for(let r=this.stateSlot(t,n?2:1),o;;r+=3){if((o=s[r])==65535)if(s[r+1]==1)o=s[r=Vn(s,r+2)];else{if(s[r+1]==2)return Vn(s,r+2);break}if(o==e||o==0)return Vn(s,r+1)}return 0}stateSlot(t,e){return this.states[t*6+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,s=>s==e?!0:null)}allActions(t,e){let s=this.stateSlot(t,4),n=s?e(s):void 0;for(let r=this.stateSlot(t,1);n==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=Vn(this.data,r+2);else break;n=e(Vn(this.data,r+1))}return n}nextStates(t){let e=[];for(let s=this.stateSlot(t,1);;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Vn(this.data,s+2);else break;if((this.data[s+2]&1)==0){let n=this.data[s+1];e.some((r,o)=>o&1&&r==n)||e.push(this.data[s],n)}}return e}configure(t){let e=Object.assign(Object.create(dd.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let s=this.topRules[t.top];if(!s)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=s}return t.tokenizers&&(e.tokenizers=this.tokenizers.map(s=>{let n=t.tokenizers.find(r=>r.from==s);return n?n.to:s})),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map((s,n)=>{let r=t.specializers.find(a=>a.from==s.external);if(!r)return s;let o=Object.assign(Object.assign({},s),{external:r.to});return e.specializers[n]=T_(o),o})),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),t.strict!=null&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),t.bufferLength!=null&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return e==null?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),s=e.map(()=>!1);if(t)for(let r of t.split(" ")){let o=e.indexOf(r);o>=0&&(s[o]=!0)}let n=null;for(let r=0;r<e.length;r++)if(!s[r])for(let o=this.dialects[e[r]],a;(a=this.data[o++])!=65535;)(n||(n=new Uint8Array(this.maxTerm+1)))[a]=1;return new PZ(t,s,n)}static deserialize(t){return new dd(t)}}function Vn(i,t){return i[t]|i[t+1]<<16}function MZ(i){let t=null;for(let e of i){let s=e.p.stoppedAt;(e.pos==e.p.stream.end||s!=null&&e.pos>s)&&e.p.parser.stateFlag(e.state,2)&&(!t||t.score<e.score)&&(t=e)}return t}function T_(i){if(i.external){let t=i.extend?1:0;return(e,s)=>i.external(e,s)<<1|t}return i.get}const EZ=316,RZ=317,P_=1,QZ=2,IZ=3,$Z=4,NZ=318,DZ=320,LZ=321,VZ=5,BZ=6,ZZ=0,p0=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],vC=125,FZ=59,g0=47,WZ=42,qZ=43,XZ=45,zZ=60,jZ=44,GZ=63,YZ=46,UZ=91,HZ=new AZ({start:!1,shift(i,t){return t==VZ||t==BZ||t==DZ?i:t==LZ},strict:!1}),KZ=new Rh((i,t)=>{let{next:e}=i;(e==vC||e==-1||t.context)&&i.acceptToken(NZ)},{contextual:!0,fallback:!0}),JZ=new Rh((i,t)=>{let{next:e}=i,s;p0.indexOf(e)>-1||e==g0&&((s=i.peek(1))==g0||s==WZ)||e!=vC&&e!=FZ&&e!=-1&&!t.context&&i.acceptToken(EZ)},{contextual:!0}),tF=new Rh((i,t)=>{i.next==UZ&&!t.context&&i.acceptToken(RZ)},{contextual:!0}),eF=new Rh((i,t)=>{let{next:e}=i;if(e==qZ||e==XZ){if(i.advance(),e==i.next){i.advance();let s=!t.context&&t.canShift(P_);i.acceptToken(s?P_:QZ)}}else e==GZ&&i.peek(1)==YZ&&(i.advance(),i.advance(),(i.next<48||i.next>57)&&i.acceptToken(IZ))},{contextual:!0});function kg(i,t){return i>=65&&i<=90||i>=97&&i<=122||i==95||i>=192||!t&&i>=48&&i<=57}const iF=new Rh((i,t)=>{if(i.next!=zZ||!t.dialectEnabled(ZZ)||(i.advance(),i.next==g0))return;let e=0;for(;p0.indexOf(i.next)>-1;)i.advance(),e++;if(kg(i.next,!0)){for(i.advance(),e++;kg(i.next,!1);)i.advance(),e++;for(;p0.indexOf(i.next)>-1;)i.advance(),e++;if(i.next==jZ)return;for(let s=0;;s++){if(s==7){if(!kg(i.next,!0))return;break}if(i.next!="extends".charCodeAt(s))break;i.advance(),e++}}i.acceptToken($Z,-e)}),sF=jk({"get set async static":E.modifier,"for while do if else switch try catch finally return throw break continue default case defer":E.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":E.operatorKeyword,"let var const using function class extends":E.definitionKeyword,"import export from":E.moduleKeyword,"with debugger new":E.keyword,TemplateString:E.special(E.string),super:E.atom,BooleanLiteral:E.bool,this:E.self,null:E.null,Star:E.modifier,VariableName:E.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":E.function(E.variableName),VariableDefinition:E.definition(E.variableName),Label:E.labelName,PropertyName:E.propertyName,PrivatePropertyName:E.special(E.propertyName),"CallExpression/MemberExpression/PropertyName":E.function(E.propertyName),"FunctionDeclaration/VariableDefinition":E.function(E.definition(E.variableName)),"ClassDeclaration/VariableDefinition":E.definition(E.className),"NewExpression/VariableName":E.className,PropertyDefinition:E.definition(E.propertyName),PrivatePropertyDefinition:E.definition(E.special(E.propertyName)),UpdateOp:E.updateOperator,"LineComment Hashbang":E.lineComment,BlockComment:E.blockComment,Number:E.number,String:E.string,Escape:E.escape,ArithOp:E.arithmeticOperator,LogicOp:E.logicOperator,BitOp:E.bitwiseOperator,CompareOp:E.compareOperator,RegExp:E.regexp,Equals:E.definitionOperator,Arrow:E.function(E.punctuation),": Spread":E.punctuation,"( )":E.paren,"[ ]":E.squareBracket,"{ }":E.brace,"InterpolationStart InterpolationEnd":E.special(E.brace),".":E.derefOperator,", ;":E.separator,"@":E.meta,TypeName:E.typeName,TypeDefinition:E.definition(E.typeName),"type enum interface implements namespace module declare":E.definitionKeyword,"abstract global Privacy readonly override":E.modifier,"is keyof unique infer asserts":E.operatorKeyword,JSXAttributeValue:E.attributeValue,JSXText:E.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":E.angleBracket,"JSXIdentifier JSXNameSpacedName":E.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":E.attributeName,"JSXBuiltin/JSXIdentifier":E.standard(E.tagName)}),nF={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},rF={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},oF={__proto__:null,"<":193},aF=dd.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:" ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:HZ,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[sF],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[JZ,tF,eF,iF,2,3,4,5,6,7,8,9,10,11,12,13,14,KZ,new d0("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new d0("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:i=>nF[i]||-1},{term:343,get:i=>rF[i]||-1},{term:95,get:i=>oF[i]||-1}],tokenPrec:15201}),_C=[Di("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Di("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Di("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Di("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Di("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Di(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Di("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Di(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Di(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Di('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Di('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],lF=_C.concat([Di("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Di("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Di("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),A_=new pD,xC=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Bl(i){return(t,e)=>{let s=t.node.getChild("VariableDefinition");return s&&e(s,i),!0}}const cF=["FunctionDeclaration"],hF={FunctionDeclaration:Bl("function"),ClassDeclaration:Bl("class"),ClassExpression:()=>!0,EnumDeclaration:Bl("constant"),TypeAliasDeclaration:Bl("type"),NamespaceDeclaration:Bl("namespace"),VariableDefinition(i,t){i.matchContext(cF)||t(i,"variable")},TypeDefinition(i,t){t(i,"type")},__proto__:null};function SC(i,t){let e=A_.get(t);if(e)return e;let s=[],n=!0;function r(o,a){let l=i.sliceString(o.from,o.to);s.push({label:l,type:a})}return t.cursor(ze.IncludeAnonymous).iterate(o=>{if(n)n=!1;else if(o.name){let a=hF[o.name];if(a&&a(o,r)||xC.has(o.name))return!1}else if(o.to-o.from>8192){for(let a of SC(i,o.node))s.push(a);return!1}}),A_.set(t,s),s}const M_=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,wC=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function uF(i){let t=Ge(i.state).resolveInner(i.pos,-1);if(wC.indexOf(t.name)>-1)return null;let e=t.name=="VariableName"||t.to-t.from<20&&M_.test(i.state.sliceDoc(t.from,t.to));if(!e&&!i.explicit)return null;let s=[];for(let n=t;n;n=n.parent)xC.has(n.name)&&(s=s.concat(SC(i.state.doc,n)));return{options:s,from:e?t.from:i.pos,validFor:M_}}const Po=Kf.define({name:"javascript",parser:aF.configure({props:[Kk.add({IfStatement:dg({except:/^\s*({|else\b)/}),TryStatement:dg({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:$D,SwitchBody:i=>{let t=i.textAfter,e=/^\s*\}/.test(t),s=/^\s*(case|default)\b/.test(t);return i.baseIndent+(e?0:s?1:2)*i.unit},Block:ID({closing:"}"}),ArrowFunction:i=>i.baseIndent+i.unit,"TemplateString BlockComment":()=>null,"Statement Property":dg({except:/^\s*{/}),JSXElement(i){let t=/^\s*<\//.test(i.textAfter);return i.lineIndent(i.node.from)+(t?0:i.unit)},JSXEscape(i){let t=/\s*\}/.test(i.textAfter);return i.lineIndent(i.node.from)+(t?0:i.unit)},"JSXOpenTag JSXSelfClosingTag"(i){return i.column(i.node.from)+i.unit}}),e5.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":VD,BlockComment(i){return{from:i.from+2,to:i.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),kC={test:i=>/^JSX/.test(i.name),facet:Uk({commentTokens:{block:{open:"{/*",close:"*/}"}}})},fF=Po.configure({dialect:"ts"},"typescript"),dF=Po.configure({dialect:"jsx",props:[s1.add(i=>i.isTop?[kC]:void 0)]}),pF=Po.configure({dialect:"jsx ts",props:[s1.add(i=>i.isTop?[kC]:void 0)]},"typescript");let CC=i=>({label:i,type:"keyword"});const TC="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(CC),gF=TC.concat(["declare","implements","private","protected","public"].map(CC));function mF(i={}){let t=i.jsx?i.typescript?pF:dF:i.typescript?fF:Po,e=i.typescript?lF.concat(gF):_C.concat(TC);return new CD(t,[Po.data.of({autocomplete:sB(wC,sC(e))}),Po.data.of({autocomplete:uF}),i.jsx?bF:[]])}function OF(i){for(;;){if(i.name=="JSXOpenTag"||i.name=="JSXSelfClosingTag"||i.name=="JSXFragmentTag")return i;if(i.name=="JSXEscape"||!i.parent)return null;i=i.parent}}function E_(i,t,e=i.length){for(let s=t?.firstChild;s;s=s.nextSibling)if(s.name=="JSXIdentifier"||s.name=="JSXBuiltin"||s.name=="JSXNamespacedName"||s.name=="JSXMemberExpression")return i.sliceString(s.from,Math.min(s.to,e));return""}const yF=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),bF=ht.inputHandler.of((i,t,e,s,n)=>{if((yF?i.composing:i.compositionStarted)||i.state.readOnly||t!=e||s!=">"&&s!="/"||!Po.isActiveAt(i.state,t,-1))return!1;let r=n(),{state:o}=r,a=o.changeByRange(l=>{var c;let{head:h}=l,u=Ge(o).resolveInner(h-1,-1),f;if(u.name=="JSXStartTag"&&(u=u.parent),!(o.doc.sliceString(h-1,h)!=s||u.name=="JSXAttributeValue"&&u.to>h)){if(s==">"&&u.name=="JSXFragmentTag")return{range:l,changes:{from:h,insert:"</>"}};if(s=="/"&&u.name=="JSXStartCloseTag"){let d=u.parent,p=d.parent;if(p&&d.from==h-2&&((f=E_(o.doc,p.firstChild,h))||((c=p.firstChild)===null||c===void 0?void 0:c.name)=="JSXFragmentTag")){let g=`${f}>`;return{range:G.cursor(h+g.length,-1),changes:{from:h,insert:g}}}}else if(s==">"){let d=OF(u);if(d&&d.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(h,h+2))&&(f=E_(o.doc,d,h)))return{range:l,changes:{from:h,insert:`</${f}>`}}}}return{range:l}});return a.changes.empty?!1:(i.dispatch([r,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),vF="#e5c07b",R_="#e06c75",_F="#56b6c2",xF="#ffffff",lf="#abb2bf",m0="#7d8799",SF="#61afef",wF="#98c379",Q_="#d19a66",kF="#c678dd",CF="#21252b",I_="#2c313a",$_="#282c34",Cg="#353a42",TF="#3E4451",N_="#528bff",PF=ht.theme({"&":{color:lf,backgroundColor:$_},".cm-content":{caretColor:N_},".cm-cursor, .cm-dropCursor":{borderLeftColor:N_},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:TF},".cm-panels":{backgroundColor:CF,color:lf},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:$_,color:m0,border:"none"},".cm-activeLineGutter":{backgroundColor:I_},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Cg},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Cg,borderBottomColor:Cg},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:I_,color:lf}}},{dark:!0}),AF=Ph.define([{tag:E.keyword,color:kF},{tag:[E.name,E.deleted,E.character,E.propertyName,E.macroName],color:R_},{tag:[E.function(E.variableName),E.labelName],color:SF},{tag:[E.color,E.constant(E.name),E.standard(E.name)],color:Q_},{tag:[E.definition(E.name),E.separator],color:lf},{tag:[E.typeName,E.className,E.number,E.changed,E.annotation,E.modifier,E.self,E.namespace],color:vF},{tag:[E.operator,E.operatorKeyword,E.url,E.escape,E.regexp,E.link,E.special(E.string)],color:_F},{tag:[E.meta,E.comment],color:m0},{tag:E.strong,fontWeight:"bold"},{tag:E.emphasis,fontStyle:"italic"},{tag:E.strikethrough,textDecoration:"line-through"},{tag:E.link,color:m0,textDecoration:"underline"},{tag:E.heading,fontWeight:"bold",color:R_},{tag:[E.atom,E.bool,E.special(E.variableName)],color:Q_},{tag:[E.processingInstruction,E.string,E.inserted],color:wF},{tag:E.invalid,color:xF}]),MF=[PF,h5(AF)],EF={class:"transform-workbench"},RF={class:"workbench-header"},QF={class:"header-actions"},IF=["value"],$F=["value"],NF={class:"tabs"},DF=["onClick"],LF={key:0,class:"valid-indicator"},VF={class:"tab-content"},BF={class:"editor-section"},ZF={class:"editor-header"},FF={class:"status"},WF={class:"editor-wrapper"},qF={key:0,class:"errors"},XF={key:1,class:"params-info"},zF={key:0,class:"no-params"},jF={key:1},GF={key:0},YF={key:0,class:"execute-section"},UF={class:"param-inputs"},HF=["for"],KF={key:0,class:"param-hint"},JF=["id","value","onInput"],tW={class:"execute-actions"},eW=["disabled"],iW=["disabled"],sW=Vo({__name:"TransformWorkbench",props:{registry:{},rollOptions:{},targetRollId:{}},emits:["update:targetRollId"],setup(i,{emit:t}){const e=i,s=t,n=Xt(0),r=Xt({}),o=[mF(),MF],a=Rs(()=>e.registry.slots[n.value]),l=p=>{e.registry.setCode(n.value,p)},c=()=>{e.registry.validateSlot(n.value)},h=()=>{const p=a.value;if(!p||!p.isValid)return;const g=p.params.filter(O=>O.name!=="notes").map(O=>(r.value[n.value]||{})[O.name]||0),m=e.registry.applyTransform(n.value,g);m.status==="error"&&alert(`Error: ${m.error}`)},u=()=>{e.registry.setCode(n.value,`/**
 * Brief description of what this does.
 * @param {Note[]} notes - Input notes array
 * @param {number} amount - Parameter description (e.g., -12 to +12)
 * ... - more parameters, as long as they are all numbers (and you need a description line for each)
 */
function myTransform(notes, amount) {
  const newNotes = notes.map(n => ({...n}));
  // transform newNotes here
  return newNotes;
}`)},f=p=>(r.value[n.value]||(r.value[n.value]={}),r.value[n.value][p]||0),d=(p,g)=>{r.value[n.value]||(r.value[n.value]={}),r.value[n.value][p]=g};return(p,g)=>(Tt(),Rt("div",EF,[X("div",RF,[g[4]||(g[4]=X("h3",null,"Transform Functions",-1)),X("div",QF,[i.rollOptions&&i.rollOptions.length>1?(Tt(),Rt("select",{key:0,value:i.targetRollId,onChange:g[0]||(g[0]=m=>s("update:targetRollId",m.target.value)),class:"roll-selector",title:"Select target roll"},[(Tt(!0),Rt(ii,null,Cr(i.rollOptions,m=>(Tt(),Rt("option",{key:m.id,value:m.id},Ie(m.label),9,$F))),128))],40,IF)):Ae("",!0),g[3]||(g[3]=X("span",{class:"template-hint"},"Click this to see the transform function format ",-1)),X("button",{onClick:u,class:"template-btn",title:"Insert starter template"},"  Template ")])]),X("div",NF,[(Tt(!0),Rt(ii,null,Cr(i.registry.slots,(m,O)=>(Tt(),Rt("button",{key:O,onClick:b=>n.value=O,class:Ds(["tab",{active:n.value===O,valid:m.isValid}])},[Fi(Ie(m.name)+" ",1),m.isValid?(Tt(),Rt("span",LF,"")):Ae("",!0)],10,DF))),128))]),X("div",VF,[X("div",BF,[X("div",ZF,[X("div",FF,[X("span",{class:Ds(["status-badge",a.value.isValid?"valid":"invalid"])},Ie(a.value.isValid?" Valid":" Not Validated"),3),X("button",{onClick:c,class:"validate-btn"}," Validate ")])]),X("div",WF,[Ne(Te(_Z),{"model-value":a.value.code,"onUpdate:modelValue":l,extensions:o,style:{height:"300px",fontSize:"14px"},placeholder:"Write your transform function here..."},null,8,["model-value"])]),a.value.errors.length>0?(Tt(),Rt("div",qF,[g[5]||(g[5]=X("h4",null,"Validation Errors:",-1)),X("ul",null,[(Tt(!0),Rt(ii,null,Cr(a.value.errors,(m,O)=>(Tt(),Rt("li",{key:O,class:"error-item"},Ie(m),1))),128))])])):Ae("",!0),a.value.isValid?(Tt(),Rt("div",XF,[g[6]||(g[6]=X("h4",null,"Parameters:",-1)),a.value.params.filter(m=>m.name!=="notes").length===0?(Tt(),Rt("div",zF," No parameters (transform operates on notes only) ")):(Tt(),Rt("ul",jF,[(Tt(!0),Rt(ii,null,Cr(a.value.params.filter(m=>m.name!=="notes"),m=>(Tt(),Rt("li",{key:m.name},[X("strong",null,Ie(m.name),1),m.description?(Tt(),Rt("span",GF,": "+Ie(m.description),1)):Ae("",!0)]))),128))]))])):Ae("",!0)]),a.value.isValid?(Tt(),Rt("div",YF,[g[7]||(g[7]=X("h4",null,"Test Transform",-1)),X("div",UF,[(Tt(!0),Rt(ii,null,Cr(a.value.params.filter(m=>m.name!=="notes"),m=>(Tt(),Rt("div",{key:m.name,class:"param-input"},[X("label",{for:`param-${m.name}`},[Fi(Ie(m.name)+" ",1),m.description?(Tt(),Rt("span",KF,Ie(m.description),1)):Ae("",!0)],8,HF),X("input",{id:`param-${m.name}`,type:"number",value:f(m.name),onInput:O=>d(m.name,parseFloat(O.target.value)),step:"0.1"},null,40,JF)]))),128))]),X("div",tW,[X("button",{onClick:h,class:"apply-btn"}," Apply Transform "),X("button",{onClick:g[1]||(g[1]=m=>i.registry.undo()),disabled:!i.registry.canUndo(),class:"undo-btn"},"  Undo ",8,eW),X("button",{onClick:g[2]||(g[2]=m=>i.registry.redo()),disabled:!i.registry.canRedo(),class:"redo-btn"},"  Redo ",8,iW)])])):Ae("",!0)])]))}}),nW=rl(sW,[["__scopeId","data-v-dbc3bf7a"]]);var rW=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,7,9,32,4,318,1,80,3,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,68,8,2,0,3,0,2,3,2,4,2,0,15,1,83,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,7,19,58,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,343,9,54,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,10,5350,0,7,14,11465,27,2343,9,87,9,39,4,60,6,26,9,535,9,470,0,2,54,8,3,82,0,12,1,19628,1,4178,9,519,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,245,1,2,9,726,6,110,6,6,9,4759,9,787719,239],PC=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,4,51,13,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,39,27,10,22,251,41,7,1,17,2,60,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,31,9,2,0,3,0,2,37,2,0,26,0,2,0,45,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,200,32,32,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,26,3994,6,582,6842,29,1763,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,433,44,212,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,42,9,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,229,29,3,0,496,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],oW="-----------------------------------------------------------------------------------------------------------------------------------------------------",AC="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Tg={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},Pg="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",aW={5:Pg,"5module":Pg+" export import",6:Pg+" const class extends export import super"},lW=/^in(stanceof)?$/,cW=new RegExp("["+AC+"]"),hW=new RegExp("["+AC+oW+"]");function O0(i,t){for(var e=65536,s=0;s<t.length;s+=2){if(e+=t[s],e>i)return!1;if(e+=t[s+1],e>=i)return!0}return!1}function wn(i,t){return i<65?i===36:i<91?!0:i<97?i===95:i<123?!0:i<=65535?i>=170&&cW.test(String.fromCharCode(i)):t===!1?!1:O0(i,PC)}function Hr(i,t){return i<48?i===36:i<58?!0:i<65?!1:i<91?!0:i<97?i===95:i<123?!0:i<=65535?i>=170&&hW.test(String.fromCharCode(i)):t===!1?!1:O0(i,PC)||O0(i,rW)}var qt=function(t,e){e===void 0&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function ds(i,t){return new qt(i,{beforeExpr:!0,binop:t})}var ps={beforeExpr:!0},$i={startsExpr:!0},_1={};function Zt(i,t){return t===void 0&&(t={}),t.keyword=i,_1[i]=new qt(i,t)}var w={num:new qt("num",$i),regexp:new qt("regexp",$i),string:new qt("string",$i),name:new qt("name",$i),privateId:new qt("privateId",$i),eof:new qt("eof"),bracketL:new qt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new qt("]"),braceL:new qt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new qt("}"),parenL:new qt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new qt(")"),comma:new qt(",",ps),semi:new qt(";",ps),colon:new qt(":",ps),dot:new qt("."),question:new qt("?",ps),questionDot:new qt("?."),arrow:new qt("=>",ps),template:new qt("template"),invalidTemplate:new qt("invalidTemplate"),ellipsis:new qt("...",ps),backQuote:new qt("`",$i),dollarBraceL:new qt("${",{beforeExpr:!0,startsExpr:!0}),eq:new qt("=",{beforeExpr:!0,isAssign:!0}),assign:new qt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new qt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new qt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:ds("||",1),logicalAND:ds("&&",2),bitwiseOR:ds("|",3),bitwiseXOR:ds("^",4),bitwiseAND:ds("&",5),equality:ds("==/!=/===/!==",6),relational:ds("</>/<=/>=",7),bitShift:ds("<</>>/>>>",8),plusMin:new qt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:ds("%",10),star:ds("*",10),slash:ds("/",10),starstar:new qt("**",{beforeExpr:!0}),coalesce:ds("??",1),_break:Zt("break"),_case:Zt("case",ps),_catch:Zt("catch"),_continue:Zt("continue"),_debugger:Zt("debugger"),_default:Zt("default",ps),_do:Zt("do",{isLoop:!0,beforeExpr:!0}),_else:Zt("else",ps),_finally:Zt("finally"),_for:Zt("for",{isLoop:!0}),_function:Zt("function",$i),_if:Zt("if"),_return:Zt("return",ps),_switch:Zt("switch"),_throw:Zt("throw",ps),_try:Zt("try"),_var:Zt("var"),_const:Zt("const"),_while:Zt("while",{isLoop:!0}),_with:Zt("with"),_new:Zt("new",{beforeExpr:!0,startsExpr:!0}),_this:Zt("this",$i),_super:Zt("super",$i),_class:Zt("class",$i),_extends:Zt("extends",ps),_export:Zt("export"),_import:Zt("import",$i),_null:Zt("null",$i),_true:Zt("true",$i),_false:Zt("false",$i),_in:Zt("in",{beforeExpr:!0,binop:7}),_instanceof:Zt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Zt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Zt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Zt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Ui=/\r\n?|\n|\u2028|\u2029/,uW=new RegExp(Ui.source,"g");function hl(i){return i===10||i===13||i===8232||i===8233}function MC(i,t,e){e===void 0&&(e=i.length);for(var s=t;s<e;s++){var n=i.charCodeAt(s);if(hl(n))return s<e-1&&n===13&&i.charCodeAt(s+1)===10?s+2:s+1}return-1}var EC=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ui=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,RC=Object.prototype,fW=RC.hasOwnProperty,dW=RC.toString,ul=Object.hasOwn||(function(i,t){return fW.call(i,t)}),D_=Array.isArray||(function(i){return dW.call(i)==="[object Array]"}),L_=Object.create(null);function Qr(i){return L_[i]||(L_[i]=new RegExp("^(?:"+i.replace(/ /g,"|")+")$"))}function ir(i){return i<=65535?String.fromCharCode(i):(i-=65536,String.fromCharCode((i>>10)+55296,(i&1023)+56320))}var pW=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Yc=function(t,e){this.line=t,this.column=e};Yc.prototype.offset=function(t){return new Yc(this.line,this.column+t)};var pp=function(t,e,s){this.start=e,this.end=s,t.sourceFile!==null&&(this.source=t.sourceFile)};function QC(i,t){for(var e=1,s=0;;){var n=MC(i,s,t);if(n<0)return new Yc(e,t-s);++e,s=n}}var y0={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},V_=!1;function gW(i){var t={};for(var e in y0)t[e]=i&&ul(i,e)?i[e]:y0[e];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!V_&&typeof console=="object"&&console.warn&&(V_=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!i||i.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),D_(t.onToken)){var s=t.onToken;t.onToken=function(n){return s.push(n)}}return D_(t.onComment)&&(t.onComment=mW(t,t.onComment)),t}function mW(i,t){return function(e,s,n,r,o,a){var l={type:e?"Block":"Line",value:s,start:n,end:r};i.locations&&(l.loc=new pp(this,o,a)),i.ranges&&(l.range=[n,r]),t.push(l)}}var Uc=1,fl=2,x1=4,IC=8,S1=16,$C=32,gp=64,NC=128,Go=256,Qh=512,mp=Uc|fl|Go;function w1(i,t){return fl|(i?x1:0)|(t?IC:0)}var pd=0,k1=1,dr=2,DC=3,LC=4,VC=5,Ye=function(t,e,s){this.options=t=gW(t),this.sourceFile=t.sourceFile,this.keywords=Qr(aW[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var n="";t.allowReserved!==!0&&(n=Tg[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(n+=" await")),this.reservedWords=Qr(n);var r=(n?n+" ":"")+Tg.strict;this.reservedWordsStrict=Qr(r),this.reservedWordsStrictBind=Qr(r+" "+Tg.strictBind),this.input=String(e),this.containsEsc=!1,s?(this.pos=s,this.lineStart=this.input.lastIndexOf(`
`,s-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Ui).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=w.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Uc),this.regexpState=null,this.privateNameStack=[]},En={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Ye.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};En.inFunction.get=function(){return(this.currentVarScope().flags&fl)>0};En.inGenerator.get=function(){return(this.currentVarScope().flags&IC)>0};En.inAsync.get=function(){return(this.currentVarScope().flags&x1)>0};En.canAwait.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var t=this.scopeStack[i],e=t.flags;if(e&(Go|Qh))return!1;if(e&fl)return(e&x1)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};En.allowSuper.get=function(){var i=this.currentThisScope(),t=i.flags;return(t&gp)>0||this.options.allowSuperOutsideMethod};En.allowDirectSuper.get=function(){return(this.currentThisScope().flags&NC)>0};En.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};En.allowNewDotTarget.get=function(){for(var i=this.scopeStack.length-1;i>=0;i--){var t=this.scopeStack[i],e=t.flags;if(e&(Go|Qh)||e&fl&&!(e&S1))return!0}return!1};En.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Go)>0};Ye.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var s=this,n=0;n<t.length;n++)s=t[n](s);return s};Ye.parse=function(t,e){return new this(e,t).parse()};Ye.parseExpressionAt=function(t,e,s){var n=new this(s,t,e);return n.nextToken(),n.parseExpression()};Ye.tokenizer=function(t,e){return new this(e,t)};Object.defineProperties(Ye.prototype,En);var Ri=Ye.prototype,OW=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Ri.strictDirective=function(i){if(this.options.ecmaVersion<5)return!1;for(;;){ui.lastIndex=i,i+=ui.exec(this.input)[0].length;var t=OW.exec(this.input.slice(i));if(!t)return!1;if((t[1]||t[2])==="use strict"){ui.lastIndex=i+t[0].length;var e=ui.exec(this.input),s=e.index+e[0].length,n=this.input.charAt(s);return n===";"||n==="}"||Ui.test(e[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(n)||n==="!"&&this.input.charAt(s+1)==="=")}i+=t[0].length,ui.lastIndex=i,i+=ui.exec(this.input)[0].length,this.input[i]===";"&&i++}};Ri.eat=function(i){return this.type===i?(this.next(),!0):!1};Ri.isContextual=function(i){return this.type===w.name&&this.value===i&&!this.containsEsc};Ri.eatContextual=function(i){return this.isContextual(i)?(this.next(),!0):!1};Ri.expectContextual=function(i){this.eatContextual(i)||this.unexpected()};Ri.canInsertSemicolon=function(){return this.type===w.eof||this.type===w.braceR||Ui.test(this.input.slice(this.lastTokEnd,this.start))};Ri.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Ri.semicolon=function(){!this.eat(w.semi)&&!this.insertSemicolon()&&this.unexpected()};Ri.afterTrailingComma=function(i,t){if(this.type===i)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};Ri.expect=function(i){this.eat(i)||this.unexpected()};Ri.unexpected=function(i){this.raise(i??this.start,"Unexpected token")};var Op=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Ri.checkPatternErrors=function(i,t){if(i){i.trailingComma>-1&&this.raiseRecoverable(i.trailingComma,"Comma is not permitted after the rest element");var e=t?i.parenthesizedAssign:i.parenthesizedBind;e>-1&&this.raiseRecoverable(e,t?"Assigning to rvalue":"Parenthesized pattern")}};Ri.checkExpressionErrors=function(i,t){if(!i)return!1;var e=i.shorthandAssign,s=i.doubleProto;if(!t)return e>=0||s>=0;e>=0&&this.raise(e,"Shorthand property assignments are valid only in destructuring patterns"),s>=0&&this.raiseRecoverable(s,"Redefinition of __proto__ property")};Ri.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Ri.isSimpleAssignTarget=function(i){return i.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(i.expression):i.type==="Identifier"||i.type==="MemberExpression"};var pt=Ye.prototype;pt.parseTopLevel=function(i){var t=Object.create(null);for(i.body||(i.body=[]);this.type!==w.eof;){var e=this.parseStatement(null,!0,t);i.body.push(e)}if(this.inModule)for(var s=0,n=Object.keys(this.undefinedExports);s<n.length;s+=1){var r=n[s];this.raiseRecoverable(this.undefinedExports[r].start,"Export '"+r+"' is not defined")}return this.adaptDirectivePrologue(i.body),this.next(),i.sourceType=this.options.sourceType,this.finishNode(i,"Program")};var C1={kind:"loop"},yW={kind:"switch"};pt.isLet=function(i){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ui.lastIndex=this.pos;var t=ui.exec(this.input),e=this.pos+t[0].length,s=this.input.charCodeAt(e);if(s===91||s===92)return!0;if(i)return!1;if(s===123||s>55295&&s<56320)return!0;if(wn(s,!0)){for(var n=e+1;Hr(s=this.input.charCodeAt(n),!0);)++n;if(s===92||s>55295&&s<56320)return!0;var r=this.input.slice(e,n);if(!lW.test(r))return!0}return!1};pt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ui.lastIndex=this.pos;var i=ui.exec(this.input),t=this.pos+i[0].length,e;return!Ui.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(Hr(e=this.input.charCodeAt(t+8))||e>55295&&e<56320))};pt.isUsingKeyword=function(i,t){if(this.options.ecmaVersion<17||!this.isContextual(i?"await":"using"))return!1;ui.lastIndex=this.pos;var e=ui.exec(this.input),s=this.pos+e[0].length;if(Ui.test(this.input.slice(this.pos,s)))return!1;if(i){var n=s+5,r;if(this.input.slice(s,n)!=="using"||n===this.input.length||Hr(r=this.input.charCodeAt(n))||r>55295&&r<56320)return!1;ui.lastIndex=n;var o=ui.exec(this.input);if(o&&Ui.test(this.input.slice(n,n+o[0].length)))return!1}if(t){var a=s+2,l;if(this.input.slice(s,a)==="of"&&(a===this.input.length||!Hr(l=this.input.charCodeAt(a))&&!(l>55295&&l<56320)))return!1}var c=this.input.charCodeAt(s);return wn(c,!0)||c===92};pt.isAwaitUsing=function(i){return this.isUsingKeyword(!0,i)};pt.isUsing=function(i){return this.isUsingKeyword(!1,i)};pt.parseStatement=function(i,t,e){var s=this.type,n=this.startNode(),r;switch(this.isLet(i)&&(s=w._var,r="let"),s){case w._break:case w._continue:return this.parseBreakContinueStatement(n,s.keyword);case w._debugger:return this.parseDebuggerStatement(n);case w._do:return this.parseDoStatement(n);case w._for:return this.parseForStatement(n);case w._function:return i&&(this.strict||i!=="if"&&i!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(n,!1,!i);case w._class:return i&&this.unexpected(),this.parseClass(n,!0);case w._if:return this.parseIfStatement(n);case w._return:return this.parseReturnStatement(n);case w._switch:return this.parseSwitchStatement(n);case w._throw:return this.parseThrowStatement(n);case w._try:return this.parseTryStatement(n);case w._const:case w._var:return r=r||this.value,i&&r!=="var"&&this.unexpected(),this.parseVarStatement(n,r);case w._while:return this.parseWhileStatement(n);case w._with:return this.parseWithStatement(n);case w.braceL:return this.parseBlock(!0,n);case w.semi:return this.parseEmptyStatement(n);case w._export:case w._import:if(this.options.ecmaVersion>10&&s===w._import){ui.lastIndex=this.pos;var o=ui.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(l===40||l===46)return this.parseExpressionStatement(n,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),s===w._import?this.parseImport(n):this.parseExport(n,e);default:if(this.isAsyncFunction())return i&&this.unexpected(),this.next(),this.parseFunctionStatement(n,!0,!i);var c=this.isAwaitUsing(!1)?"await using":this.isUsing(!1)?"using":null;if(c)return t&&this.options.sourceType==="script"&&this.raise(this.start,"Using declaration cannot appear in the top level when source type is `script`"),c==="await using"&&(this.canAwait||this.raise(this.start,"Await using cannot appear outside of async function"),this.next()),this.next(),this.parseVar(n,!1,c),this.semicolon(),this.finishNode(n,"VariableDeclaration");var h=this.value,u=this.parseExpression();return s===w.name&&u.type==="Identifier"&&this.eat(w.colon)?this.parseLabeledStatement(n,h,u,i):this.parseExpressionStatement(n,u)}};pt.parseBreakContinueStatement=function(i,t){var e=t==="break";this.next(),this.eat(w.semi)||this.insertSemicolon()?i.label=null:this.type!==w.name?this.unexpected():(i.label=this.parseIdent(),this.semicolon());for(var s=0;s<this.labels.length;++s){var n=this.labels[s];if((i.label==null||n.name===i.label.name)&&(n.kind!=null&&(e||n.kind==="loop")||i.label&&e))break}return s===this.labels.length&&this.raise(i.start,"Unsyntactic "+t),this.finishNode(i,e?"BreakStatement":"ContinueStatement")};pt.parseDebuggerStatement=function(i){return this.next(),this.semicolon(),this.finishNode(i,"DebuggerStatement")};pt.parseDoStatement=function(i){return this.next(),this.labels.push(C1),i.body=this.parseStatement("do"),this.labels.pop(),this.expect(w._while),i.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(w.semi):this.semicolon(),this.finishNode(i,"DoWhileStatement")};pt.parseForStatement=function(i){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(C1),this.enterScope(0),this.expect(w.parenL),this.type===w.semi)return t>-1&&this.unexpected(t),this.parseFor(i,null);var e=this.isLet();if(this.type===w._var||this.type===w._const||e){var s=this.startNode(),n=e?"let":this.value;return this.next(),this.parseVar(s,!0,n),this.finishNode(s,"VariableDeclaration"),this.parseForAfterInit(i,s,t)}var r=this.isContextual("let"),o=!1,a=this.isUsing(!0)?"using":this.isAwaitUsing(!0)?"await using":null;if(a){var l=this.startNode();return this.next(),a==="await using"&&this.next(),this.parseVar(l,!0,a),this.finishNode(l,"VariableDeclaration"),this.parseForAfterInit(i,l,t)}var c=this.containsEsc,h=new Op,u=this.start,f=t>-1?this.parseExprSubscripts(h,"await"):this.parseExpression(!0,h);return this.type===w._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===w._in&&this.unexpected(t),i.await=!0):o&&this.options.ecmaVersion>=8&&(f.start===u&&!c&&f.type==="Identifier"&&f.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(i.await=!1)),r&&o&&this.raise(f.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(f,!1,h),this.checkLValPattern(f),this.parseForIn(i,f)):(this.checkExpressionErrors(h,!0),t>-1&&this.unexpected(t),this.parseFor(i,f))};pt.parseForAfterInit=function(i,t,e){return(this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&t.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===w._in?e>-1&&this.unexpected(e):i.await=e>-1),this.parseForIn(i,t)):(e>-1&&this.unexpected(e),this.parseFor(i,t))};pt.parseFunctionStatement=function(i,t,e){return this.next(),this.parseFunction(i,bc|(e?0:b0),!1,t)};pt.parseIfStatement=function(i){return this.next(),i.test=this.parseParenExpression(),i.consequent=this.parseStatement("if"),i.alternate=this.eat(w._else)?this.parseStatement("if"):null,this.finishNode(i,"IfStatement")};pt.parseReturnStatement=function(i){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(w.semi)||this.insertSemicolon()?i.argument=null:(i.argument=this.parseExpression(),this.semicolon()),this.finishNode(i,"ReturnStatement")};pt.parseSwitchStatement=function(i){this.next(),i.discriminant=this.parseParenExpression(),i.cases=[],this.expect(w.braceL),this.labels.push(yW),this.enterScope(0);for(var t,e=!1;this.type!==w.braceR;)if(this.type===w._case||this.type===w._default){var s=this.type===w._case;t&&this.finishNode(t,"SwitchCase"),i.cases.push(t=this.startNode()),t.consequent=[],this.next(),s?t.test=this.parseExpression():(e&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),e=!0,t.test=null),this.expect(w.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(i,"SwitchStatement")};pt.parseThrowStatement=function(i){return this.next(),Ui.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),i.argument=this.parseExpression(),this.semicolon(),this.finishNode(i,"ThrowStatement")};var bW=[];pt.parseCatchClauseParam=function(){var i=this.parseBindingAtom(),t=i.type==="Identifier";return this.enterScope(t?$C:0),this.checkLValPattern(i,t?LC:dr),this.expect(w.parenR),i};pt.parseTryStatement=function(i){if(this.next(),i.block=this.parseBlock(),i.handler=null,this.type===w._catch){var t=this.startNode();this.next(),this.eat(w.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),i.handler=this.finishNode(t,"CatchClause")}return i.finalizer=this.eat(w._finally)?this.parseBlock():null,!i.handler&&!i.finalizer&&this.raise(i.start,"Missing catch or finally clause"),this.finishNode(i,"TryStatement")};pt.parseVarStatement=function(i,t,e){return this.next(),this.parseVar(i,!1,t,e),this.semicolon(),this.finishNode(i,"VariableDeclaration")};pt.parseWhileStatement=function(i){return this.next(),i.test=this.parseParenExpression(),this.labels.push(C1),i.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(i,"WhileStatement")};pt.parseWithStatement=function(i){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),i.object=this.parseParenExpression(),i.body=this.parseStatement("with"),this.finishNode(i,"WithStatement")};pt.parseEmptyStatement=function(i){return this.next(),this.finishNode(i,"EmptyStatement")};pt.parseLabeledStatement=function(i,t,e,s){for(var n=0,r=this.labels;n<r.length;n+=1){var o=r[n];o.name===t&&this.raise(e.start,"Label '"+t+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===w._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var c=this.labels[l];if(c.statementStart===i.start)c.statementStart=this.start,c.kind=a;else break}return this.labels.push({name:t,kind:a,statementStart:this.start}),i.body=this.parseStatement(s?s.indexOf("label")===-1?s+"label":s:"label"),this.labels.pop(),i.label=e,this.finishNode(i,"LabeledStatement")};pt.parseExpressionStatement=function(i,t){return i.expression=t,this.semicolon(),this.finishNode(i,"ExpressionStatement")};pt.parseBlock=function(i,t,e){for(i===void 0&&(i=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(w.braceL),i&&this.enterScope(0);this.type!==w.braceR;){var s=this.parseStatement(null);t.body.push(s)}return e&&(this.strict=!1),this.next(),i&&this.exitScope(),this.finishNode(t,"BlockStatement")};pt.parseFor=function(i,t){return i.init=t,this.expect(w.semi),i.test=this.type===w.semi?null:this.parseExpression(),this.expect(w.semi),i.update=this.type===w.parenR?null:this.parseExpression(),this.expect(w.parenR),i.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(i,"ForStatement")};pt.parseForIn=function(i,t){var e=this.type===w._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!e||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(e?"for-in":"for-of")+" loop variable declaration may not have an initializer"),i.left=t,i.right=e?this.parseExpression():this.parseMaybeAssign(),this.expect(w.parenR),i.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(i,e?"ForInStatement":"ForOfStatement")};pt.parseVar=function(i,t,e,s){for(i.declarations=[],i.kind=e;;){var n=this.startNode();if(this.parseVarId(n,e),this.eat(w.eq)?n.init=this.parseMaybeAssign(t):!s&&e==="const"&&!(this.type===w._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!s&&(e==="using"||e==="await using")&&this.options.ecmaVersion>=17&&this.type!==w._in&&!this.isContextual("of")?this.raise(this.lastTokEnd,"Missing initializer in "+e+" declaration"):!s&&n.id.type!=="Identifier"&&!(t&&(this.type===w._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):n.init=null,i.declarations.push(this.finishNode(n,"VariableDeclarator")),!this.eat(w.comma))break}return i};pt.parseVarId=function(i,t){i.id=t==="using"||t==="await using"?this.parseIdent():this.parseBindingAtom(),this.checkLValPattern(i.id,t==="var"?k1:dr,!1)};var bc=1,b0=2,BC=4;pt.parseFunction=function(i,t,e,s,n){this.initFunction(i),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!s)&&(this.type===w.star&&t&b0&&this.unexpected(),i.generator=this.eat(w.star)),this.options.ecmaVersion>=8&&(i.async=!!s),t&bc&&(i.id=t&BC&&this.type!==w.name?null:this.parseIdent(),i.id&&!(t&b0)&&this.checkLValSimple(i.id,this.strict||i.generator||i.async?this.treatFunctionsAsVar?k1:dr:DC));var r=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(w1(i.async,i.generator)),t&bc||(i.id=this.type===w.name?this.parseIdent():null),this.parseFunctionParams(i),this.parseFunctionBody(i,e,!1,n),this.yieldPos=r,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(i,t&bc?"FunctionDeclaration":"FunctionExpression")};pt.parseFunctionParams=function(i){this.expect(w.parenL),i.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};pt.parseClass=function(i,t){this.next();var e=this.strict;this.strict=!0,this.parseClassId(i,t),this.parseClassSuper(i);var s=this.enterClassBody(),n=this.startNode(),r=!1;for(n.body=[],this.expect(w.braceL);this.type!==w.braceR;){var o=this.parseClassElement(i.superClass!==null);o&&(n.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(r&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),r=!0):o.key&&o.key.type==="PrivateIdentifier"&&vW(s,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=e,this.next(),i.body=this.finishNode(n,"ClassBody"),this.exitClassBody(),this.finishNode(i,t?"ClassDeclaration":"ClassExpression")};pt.parseClassElement=function(i){if(this.eat(w.semi))return null;var t=this.options.ecmaVersion,e=this.startNode(),s="",n=!1,r=!1,o="method",a=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(w.braceL))return this.parseClassStaticBlock(e),e;this.isClassElementNameStart()||this.type===w.star?a=!0:s="static"}if(e.static=a,!s&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===w.star)&&!this.canInsertSemicolon()?r=!0:s="async"),!s&&(t>=9||!r)&&this.eat(w.star)&&(n=!0),!s&&!r&&!n){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:s=l)}if(s?(e.computed=!1,e.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),e.key.name=s,this.finishNode(e.key,"Identifier")):this.parseClassElementName(e),t<13||this.type===w.parenL||o!=="method"||n||r){var c=!e.static&&gd(e,"constructor"),h=c&&i;c&&o!=="method"&&this.raise(e.key.start,"Constructor can't have get/set modifier"),e.kind=c?"constructor":o,this.parseClassMethod(e,n,r,h)}else this.parseClassField(e);return e};pt.isClassElementNameStart=function(){return this.type===w.name||this.type===w.privateId||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword};pt.parseClassElementName=function(i){this.type===w.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),i.computed=!1,i.key=this.parsePrivateIdent()):this.parsePropertyName(i)};pt.parseClassMethod=function(i,t,e,s){var n=i.key;i.kind==="constructor"?(t&&this.raise(n.start,"Constructor can't be a generator"),e&&this.raise(n.start,"Constructor can't be an async method")):i.static&&gd(i,"prototype")&&this.raise(n.start,"Classes may not have a static property named prototype");var r=i.value=this.parseMethod(t,e,s);return i.kind==="get"&&r.params.length!==0&&this.raiseRecoverable(r.start,"getter should have no params"),i.kind==="set"&&r.params.length!==1&&this.raiseRecoverable(r.start,"setter should have exactly one param"),i.kind==="set"&&r.params[0].type==="RestElement"&&this.raiseRecoverable(r.params[0].start,"Setter cannot use rest params"),this.finishNode(i,"MethodDefinition")};pt.parseClassField=function(i){return gd(i,"constructor")?this.raise(i.key.start,"Classes can't have a field named 'constructor'"):i.static&&gd(i,"prototype")&&this.raise(i.key.start,"Classes can't have a static field named 'prototype'"),this.eat(w.eq)?(this.enterScope(Qh|gp),i.value=this.parseMaybeAssign(),this.exitScope()):i.value=null,this.semicolon(),this.finishNode(i,"PropertyDefinition")};pt.parseClassStaticBlock=function(i){i.body=[];var t=this.labels;for(this.labels=[],this.enterScope(Go|gp);this.type!==w.braceR;){var e=this.parseStatement(null);i.body.push(e)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(i,"StaticBlock")};pt.parseClassId=function(i,t){this.type===w.name?(i.id=this.parseIdent(),t&&this.checkLValSimple(i.id,dr,!1)):(t===!0&&this.unexpected(),i.id=null)};pt.parseClassSuper=function(i){i.superClass=this.eat(w._extends)?this.parseExprSubscripts(null,!1):null};pt.enterClassBody=function(){var i={declared:Object.create(null),used:[]};return this.privateNameStack.push(i),i.declared};pt.exitClassBody=function(){var i=this.privateNameStack.pop(),t=i.declared,e=i.used;if(this.options.checkPrivateFields)for(var s=this.privateNameStack.length,n=s===0?null:this.privateNameStack[s-1],r=0;r<e.length;++r){var o=e[r];ul(t,o.name)||(n?n.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function vW(i,t){var e=t.key.name,s=i[e],n="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(n=(t.static?"s":"i")+t.kind),s==="iget"&&n==="iset"||s==="iset"&&n==="iget"||s==="sget"&&n==="sset"||s==="sset"&&n==="sget"?(i[e]="true",!1):s?!0:(i[e]=n,!1)}function gd(i,t){var e=i.computed,s=i.key;return!e&&(s.type==="Identifier"&&s.name===t||s.type==="Literal"&&s.value===t)}pt.parseExportAllDeclaration=function(i,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(i.exported=this.parseModuleExportName(),this.checkExport(t,i.exported,this.lastTokStart)):i.exported=null),this.expectContextual("from"),this.type!==w.string&&this.unexpected(),i.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(i,"ExportAllDeclaration")};pt.parseExport=function(i,t){if(this.next(),this.eat(w.star))return this.parseExportAllDeclaration(i,t);if(this.eat(w._default))return this.checkExport(t,"default",this.lastTokStart),i.declaration=this.parseExportDefaultDeclaration(),this.finishNode(i,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())i.declaration=this.parseExportDeclaration(i),i.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,i.declaration.declarations):this.checkExport(t,i.declaration.id,i.declaration.id.start),i.specifiers=[],i.source=null,this.options.ecmaVersion>=16&&(i.attributes=[]);else{if(i.declaration=null,i.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==w.string&&this.unexpected(),i.source=this.parseExprAtom(),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause());else{for(var e=0,s=i.specifiers;e<s.length;e+=1){var n=s[e];this.checkUnreserved(n.local),this.checkLocalExport(n.local),n.local.type==="Literal"&&this.raise(n.local.start,"A string literal cannot be used as an exported binding without `from`.")}i.source=null,this.options.ecmaVersion>=16&&(i.attributes=[])}this.semicolon()}return this.finishNode(i,"ExportNamedDeclaration")};pt.parseExportDeclaration=function(i){return this.parseStatement(null)};pt.parseExportDefaultDeclaration=function(){var i;if(this.type===w._function||(i=this.isAsyncFunction())){var t=this.startNode();return this.next(),i&&this.next(),this.parseFunction(t,bc|BC,!1,i)}else if(this.type===w._class){var e=this.startNode();return this.parseClass(e,"nullableID")}else{var s=this.parseMaybeAssign();return this.semicolon(),s}};pt.checkExport=function(i,t,e){i&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),ul(i,t)&&this.raiseRecoverable(e,"Duplicate export '"+t+"'"),i[t]=!0)};pt.checkPatternExport=function(i,t){var e=t.type;if(e==="Identifier")this.checkExport(i,t,t.start);else if(e==="ObjectPattern")for(var s=0,n=t.properties;s<n.length;s+=1){var r=n[s];this.checkPatternExport(i,r)}else if(e==="ArrayPattern")for(var o=0,a=t.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(i,l)}else e==="Property"?this.checkPatternExport(i,t.value):e==="AssignmentPattern"?this.checkPatternExport(i,t.left):e==="RestElement"&&this.checkPatternExport(i,t.argument)};pt.checkVariableExport=function(i,t){if(i)for(var e=0,s=t;e<s.length;e+=1){var n=s[e];this.checkPatternExport(i,n.id)}};pt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};pt.parseExportSpecifier=function(i){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(i,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};pt.parseExportSpecifiers=function(i){var t=[],e=!0;for(this.expect(w.braceL);!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;t.push(this.parseExportSpecifier(i))}return t};pt.parseImport=function(i){return this.next(),this.type===w.string?(i.specifiers=bW,i.source=this.parseExprAtom()):(i.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),i.source=this.type===w.string?this.parseExprAtom():this.unexpected()),this.options.ecmaVersion>=16&&(i.attributes=this.parseWithClause()),this.semicolon(),this.finishNode(i,"ImportDeclaration")};pt.parseImportSpecifier=function(){var i=this.startNode();return i.imported=this.parseModuleExportName(),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLValSimple(i.local,dr),this.finishNode(i,"ImportSpecifier")};pt.parseImportDefaultSpecifier=function(){var i=this.startNode();return i.local=this.parseIdent(),this.checkLValSimple(i.local,dr),this.finishNode(i,"ImportDefaultSpecifier")};pt.parseImportNamespaceSpecifier=function(){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLValSimple(i.local,dr),this.finishNode(i,"ImportNamespaceSpecifier")};pt.parseImportSpecifiers=function(){var i=[],t=!0;if(this.type===w.name&&(i.push(this.parseImportDefaultSpecifier()),!this.eat(w.comma)))return i;if(this.type===w.star)return i.push(this.parseImportNamespaceSpecifier()),i;for(this.expect(w.braceL);!this.eat(w.braceR);){if(t)t=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;i.push(this.parseImportSpecifier())}return i};pt.parseWithClause=function(){var i=[];if(!this.eat(w._with))return i;this.expect(w.braceL);for(var t={},e=!0;!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var s=this.parseImportAttribute(),n=s.key.type==="Identifier"?s.key.name:s.key.value;ul(t,n)&&this.raiseRecoverable(s.key.start,"Duplicate attribute key '"+n+"'"),t[n]=!0,i.push(s)}return i};pt.parseImportAttribute=function(){var i=this.startNode();return i.key=this.type===w.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never"),this.expect(w.colon),this.type!==w.string&&this.unexpected(),i.value=this.parseExprAtom(),this.finishNode(i,"ImportAttribute")};pt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===w.string){var i=this.parseLiteral(this.value);return pW.test(i.value)&&this.raise(i.start,"An export name cannot include a lone surrogate."),i}return this.parseIdent(!0)};pt.adaptDirectivePrologue=function(i){for(var t=0;t<i.length&&this.isDirectiveCandidate(i[t]);++t)i[t].directive=i[t].expression.raw.slice(1,-1)};pt.isDirectiveCandidate=function(i){return this.options.ecmaVersion>=5&&i.type==="ExpressionStatement"&&i.expression.type==="Literal"&&typeof i.expression.value=="string"&&(this.input[i.start]==='"'||this.input[i.start]==="'")};var As=Ye.prototype;As.toAssignable=function(i,t,e){if(this.options.ecmaVersion>=6&&i)switch(i.type){case"Identifier":this.inAsync&&i.name==="await"&&this.raise(i.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":i.type="ObjectPattern",e&&this.checkPatternErrors(e,!0);for(var s=0,n=i.properties;s<n.length;s+=1){var r=n[s];this.toAssignable(r,t),r.type==="RestElement"&&(r.argument.type==="ArrayPattern"||r.argument.type==="ObjectPattern")&&this.raise(r.argument.start,"Unexpected token")}break;case"Property":i.kind!=="init"&&this.raise(i.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(i.value,t);break;case"ArrayExpression":i.type="ArrayPattern",e&&this.checkPatternErrors(e,!0),this.toAssignableList(i.elements,t);break;case"SpreadElement":i.type="RestElement",this.toAssignable(i.argument,t),i.argument.type==="AssignmentPattern"&&this.raise(i.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":i.operator!=="="&&this.raise(i.left.end,"Only '=' operator can be used for specifying default value."),i.type="AssignmentPattern",delete i.operator,this.toAssignable(i.left,t);break;case"ParenthesizedExpression":this.toAssignable(i.expression,t,e);break;case"ChainExpression":this.raiseRecoverable(i.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(i.start,"Assigning to rvalue")}else e&&this.checkPatternErrors(e,!0);return i};As.toAssignableList=function(i,t){for(var e=i.length,s=0;s<e;s++){var n=i[s];n&&this.toAssignable(n,t)}if(e){var r=i[e-1];this.options.ecmaVersion===6&&t&&r&&r.type==="RestElement"&&r.argument.type!=="Identifier"&&this.unexpected(r.argument.start)}return i};As.parseSpread=function(i){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,i),this.finishNode(t,"SpreadElement")};As.parseRestBinding=function(){var i=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==w.name&&this.unexpected(),i.argument=this.parseBindingAtom(),this.finishNode(i,"RestElement")};As.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case w.bracketL:var i=this.startNode();return this.next(),i.elements=this.parseBindingList(w.bracketR,!0,!0),this.finishNode(i,"ArrayPattern");case w.braceL:return this.parseObj(!0)}return this.parseIdent()};As.parseBindingList=function(i,t,e,s){for(var n=[],r=!0;!this.eat(i);)if(r?r=!1:this.expect(w.comma),t&&this.type===w.comma)n.push(null);else{if(e&&this.afterTrailingComma(i))break;if(this.type===w.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),n.push(o),this.type===w.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(i);break}else n.push(this.parseAssignableListItem(s))}return n};As.parseAssignableListItem=function(i){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};As.parseBindingListItem=function(i){return i};As.parseMaybeDefault=function(i,t,e){if(e=e||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(w.eq))return e;var s=this.startNodeAt(i,t);return s.left=e,s.right=this.parseMaybeAssign(),this.finishNode(s,"AssignmentPattern")};As.checkLValSimple=function(i,t,e){t===void 0&&(t=pd);var s=t!==pd;switch(i.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(i.name)&&this.raiseRecoverable(i.start,(s?"Binding ":"Assigning to ")+i.name+" in strict mode"),s&&(t===dr&&i.name==="let"&&this.raiseRecoverable(i.start,"let is disallowed as a lexically bound name"),e&&(ul(e,i.name)&&this.raiseRecoverable(i.start,"Argument name clash"),e[i.name]=!0),t!==VC&&this.declareName(i.name,t,i.start));break;case"ChainExpression":this.raiseRecoverable(i.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":s&&this.raiseRecoverable(i.start,"Binding member expression");break;case"ParenthesizedExpression":return s&&this.raiseRecoverable(i.start,"Binding parenthesized expression"),this.checkLValSimple(i.expression,t,e);default:this.raise(i.start,(s?"Binding":"Assigning to")+" rvalue")}};As.checkLValPattern=function(i,t,e){switch(t===void 0&&(t=pd),i.type){case"ObjectPattern":for(var s=0,n=i.properties;s<n.length;s+=1){var r=n[s];this.checkLValInnerPattern(r,t,e)}break;case"ArrayPattern":for(var o=0,a=i.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLValInnerPattern(l,t,e)}break;default:this.checkLValSimple(i,t,e)}};As.checkLValInnerPattern=function(i,t,e){switch(t===void 0&&(t=pd),i.type){case"Property":this.checkLValInnerPattern(i.value,t,e);break;case"AssignmentPattern":this.checkLValPattern(i.left,t,e);break;case"RestElement":this.checkLValPattern(i.argument,t,e);break;default:this.checkLValPattern(i,t,e)}};var Ms=function(t,e,s,n,r){this.token=t,this.isExpr=!!e,this.preserveSpace=!!s,this.override=n,this.generator=!!r},Se={b_stat:new Ms("{",!1),b_expr:new Ms("{",!0),b_tmpl:new Ms("${",!1),p_stat:new Ms("(",!1),p_expr:new Ms("(",!0),q_tmpl:new Ms("`",!0,!0,function(i){return i.tryReadTemplateToken()}),f_stat:new Ms("function",!1),f_expr:new Ms("function",!0),f_expr_gen:new Ms("function",!0,!1,null,!0),f_gen:new Ms("function",!1,!1,null,!0)},dl=Ye.prototype;dl.initialContext=function(){return[Se.b_stat]};dl.curContext=function(){return this.context[this.context.length-1]};dl.braceIsBlock=function(i){var t=this.curContext();return t===Se.f_expr||t===Se.f_stat?!0:i===w.colon&&(t===Se.b_stat||t===Se.b_expr)?!t.isExpr:i===w._return||i===w.name&&this.exprAllowed?Ui.test(this.input.slice(this.lastTokEnd,this.start)):i===w._else||i===w.semi||i===w.eof||i===w.parenR||i===w.arrow?!0:i===w.braceL?t===Se.b_stat:i===w._var||i===w._const||i===w.name?!1:!this.exprAllowed};dl.inGeneratorContext=function(){for(var i=this.context.length-1;i>=1;i--){var t=this.context[i];if(t.token==="function")return t.generator}return!1};dl.updateContext=function(i){var t,e=this.type;e.keyword&&i===w.dot?this.exprAllowed=!1:(t=e.updateContext)?t.call(this,i):this.exprAllowed=e.beforeExpr};dl.overrideContext=function(i){this.curContext()!==i&&(this.context[this.context.length-1]=i)};w.parenR.updateContext=w.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var i=this.context.pop();i===Se.b_stat&&this.curContext().token==="function"&&(i=this.context.pop()),this.exprAllowed=!i.isExpr};w.braceL.updateContext=function(i){this.context.push(this.braceIsBlock(i)?Se.b_stat:Se.b_expr),this.exprAllowed=!0};w.dollarBraceL.updateContext=function(){this.context.push(Se.b_tmpl),this.exprAllowed=!0};w.parenL.updateContext=function(i){var t=i===w._if||i===w._for||i===w._with||i===w._while;this.context.push(t?Se.p_stat:Se.p_expr),this.exprAllowed=!0};w.incDec.updateContext=function(){};w._function.updateContext=w._class.updateContext=function(i){i.beforeExpr&&i!==w._else&&!(i===w.semi&&this.curContext()!==Se.p_stat)&&!(i===w._return&&Ui.test(this.input.slice(this.lastTokEnd,this.start)))&&!((i===w.colon||i===w.braceL)&&this.curContext()===Se.b_stat)?this.context.push(Se.f_expr):this.context.push(Se.f_stat),this.exprAllowed=!1};w.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};w.backQuote.updateContext=function(){this.curContext()===Se.q_tmpl?this.context.pop():this.context.push(Se.q_tmpl),this.exprAllowed=!1};w.star.updateContext=function(i){if(i===w._function){var t=this.context.length-1;this.context[t]===Se.f_expr?this.context[t]=Se.f_expr_gen:this.context[t]=Se.f_gen}this.exprAllowed=!0};w.name.updateContext=function(i){var t=!1;this.options.ecmaVersion>=6&&i!==w.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var At=Ye.prototype;At.checkPropClash=function(i,t,e){if(!(this.options.ecmaVersion>=9&&i.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(i.computed||i.method||i.shorthand))){var s=i.key,n;switch(s.type){case"Identifier":n=s.name;break;case"Literal":n=String(s.value);break;default:return}var r=i.kind;if(this.options.ecmaVersion>=6){n==="__proto__"&&r==="init"&&(t.proto&&(e?e.doubleProto<0&&(e.doubleProto=s.start):this.raiseRecoverable(s.start,"Redefinition of __proto__ property")),t.proto=!0);return}n="$"+n;var o=t[n];if(o){var a;r==="init"?a=this.strict&&o.init||o.get||o.set:a=o.init||o[r],a&&this.raiseRecoverable(s.start,"Redefinition of property")}else o=t[n]={init:!1,get:!1,set:!1};o[r]=!0}};At.parseExpression=function(i,t){var e=this.start,s=this.startLoc,n=this.parseMaybeAssign(i,t);if(this.type===w.comma){var r=this.startNodeAt(e,s);for(r.expressions=[n];this.eat(w.comma);)r.expressions.push(this.parseMaybeAssign(i,t));return this.finishNode(r,"SequenceExpression")}return n};At.parseMaybeAssign=function(i,t,e){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(i);this.exprAllowed=!1}var s=!1,n=-1,r=-1,o=-1;t?(n=t.parenthesizedAssign,r=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new Op,s=!0);var a=this.start,l=this.startLoc;(this.type===w.parenL||this.type===w.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=i==="await");var c=this.parseMaybeConditional(i,t);if(e&&(c=e.call(this,c,a,l)),this.type.isAssign){var h=this.startNodeAt(a,l);return h.operator=this.value,this.type===w.eq&&(c=this.toAssignable(c,!1,t)),s||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=c.start&&(t.shorthandAssign=-1),this.type===w.eq?this.checkLValPattern(c):this.checkLValSimple(c),h.left=c,this.next(),h.right=this.parseMaybeAssign(i),o>-1&&(t.doubleProto=o),this.finishNode(h,"AssignmentExpression")}else s&&this.checkExpressionErrors(t,!0);return n>-1&&(t.parenthesizedAssign=n),r>-1&&(t.trailingComma=r),c};At.parseMaybeConditional=function(i,t){var e=this.start,s=this.startLoc,n=this.parseExprOps(i,t);if(this.checkExpressionErrors(t))return n;if(this.eat(w.question)){var r=this.startNodeAt(e,s);return r.test=n,r.consequent=this.parseMaybeAssign(),this.expect(w.colon),r.alternate=this.parseMaybeAssign(i),this.finishNode(r,"ConditionalExpression")}return n};At.parseExprOps=function(i,t){var e=this.start,s=this.startLoc,n=this.parseMaybeUnary(t,!1,!1,i);return this.checkExpressionErrors(t)||n.start===e&&n.type==="ArrowFunctionExpression"?n:this.parseExprOp(n,e,s,-1,i)};At.parseExprOp=function(i,t,e,s,n){var r=this.type.binop;if(r!=null&&(!n||this.type!==w._in)&&r>s){var o=this.type===w.logicalOR||this.type===w.logicalAND,a=this.type===w.coalesce;a&&(r=w.logicalAND.binop);var l=this.value;this.next();var c=this.start,h=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,n),c,h,r,n),f=this.buildBinary(t,e,i,u,l,o||a);return(o&&this.type===w.coalesce||a&&(this.type===w.logicalOR||this.type===w.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(f,t,e,s,n)}return i};At.buildBinary=function(i,t,e,s,n,r){s.type==="PrivateIdentifier"&&this.raise(s.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(i,t);return o.left=e,o.operator=n,o.right=s,this.finishNode(o,r?"LogicalExpression":"BinaryExpression")};At.parseMaybeUnary=function(i,t,e,s){var n=this.start,r=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(s),t=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===w.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,s),this.checkExpressionErrors(i,!0),l?this.checkLValSimple(a.argument):this.strict&&a.operator==="delete"&&ZC(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):a.operator==="delete"&&v0(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===w.privateId)(s||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==w._in&&this.unexpected();else{if(o=this.parseExprSubscripts(i,s),this.checkExpressionErrors(i))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var c=this.startNodeAt(n,r);c.operator=this.value,c.prefix=!1,c.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(c,"UpdateExpression")}}if(!e&&this.eat(w.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(n,r,o,this.parseMaybeUnary(null,!1,!1,s),"**",!1);else return o};function ZC(i){return i.type==="Identifier"||i.type==="ParenthesizedExpression"&&ZC(i.expression)}function v0(i){return i.type==="MemberExpression"&&i.property.type==="PrivateIdentifier"||i.type==="ChainExpression"&&v0(i.expression)||i.type==="ParenthesizedExpression"&&v0(i.expression)}At.parseExprSubscripts=function(i,t){var e=this.start,s=this.startLoc,n=this.parseExprAtom(i,t);if(n.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return n;var r=this.parseSubscripts(n,e,s,!1,t);return i&&r.type==="MemberExpression"&&(i.parenthesizedAssign>=r.start&&(i.parenthesizedAssign=-1),i.parenthesizedBind>=r.start&&(i.parenthesizedBind=-1),i.trailingComma>=r.start&&(i.trailingComma=-1)),r};At.parseSubscripts=function(i,t,e,s,n){for(var r=this.options.ecmaVersion>=8&&i.type==="Identifier"&&i.name==="async"&&this.lastTokEnd===i.end&&!this.canInsertSemicolon()&&i.end-i.start===5&&this.potentialArrowAt===i.start,o=!1;;){var a=this.parseSubscript(i,t,e,s,r,o,n);if(a.optional&&(o=!0),a===i||a.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(t,e);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}i=a}};At.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(w.arrow)};At.parseSubscriptAsyncArrow=function(i,t,e,s){return this.parseArrowExpression(this.startNodeAt(i,t),e,!0,s)};At.parseSubscript=function(i,t,e,s,n,r,o){var a=this.options.ecmaVersion>=11,l=a&&this.eat(w.questionDot);s&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var c=this.eat(w.bracketL);if(c||l&&this.type!==w.parenL&&this.type!==w.backQuote||this.eat(w.dot)){var h=this.startNodeAt(t,e);h.object=i,c?(h.property=this.parseExpression(),this.expect(w.bracketR)):this.type===w.privateId&&i.type!=="Super"?h.property=this.parsePrivateIdent():h.property=this.parseIdent(this.options.allowReserved!=="never"),h.computed=!!c,a&&(h.optional=l),i=this.finishNode(h,"MemberExpression")}else if(!s&&this.eat(w.parenL)){var u=new Op,f=this.yieldPos,d=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var g=this.parseExprList(w.parenR,this.options.ecmaVersion>=8,!1,u);if(n&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=f,this.awaitPos=d,this.awaitIdentPos=p,this.parseSubscriptAsyncArrow(t,e,g,o);this.checkExpressionErrors(u,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=d||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var m=this.startNodeAt(t,e);m.callee=i,m.arguments=g,a&&(m.optional=l),i=this.finishNode(m,"CallExpression")}else if(this.type===w.backQuote){(l||r)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var O=this.startNodeAt(t,e);O.tag=i,O.quasi=this.parseTemplate({isTagged:!0}),i=this.finishNode(O,"TaggedTemplateExpression")}return i};At.parseExprAtom=function(i,t,e){this.type===w.slash&&this.readRegexp();var s,n=this.potentialArrowAt===this.start;switch(this.type){case w._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),s=this.startNode(),this.next(),this.type===w.parenL&&!this.allowDirectSuper&&this.raise(s.start,"super() call outside constructor of a subclass"),this.type!==w.dot&&this.type!==w.bracketL&&this.type!==w.parenL&&this.unexpected(),this.finishNode(s,"Super");case w._this:return s=this.startNode(),this.next(),this.finishNode(s,"ThisExpression");case w.name:var r=this.start,o=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(w._function))return this.overrideContext(Se.f_expr),this.parseFunction(this.startNodeAt(r,o),0,!1,!0,t);if(n&&!this.canInsertSemicolon()){if(this.eat(w.arrow))return this.parseArrowExpression(this.startNodeAt(r,o),[l],!1,t);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===w.name&&!a&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(w.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,o),[l],!0,t)}return l;case w.regexp:var c=this.value;return s=this.parseLiteral(c.value),s.regex={pattern:c.pattern,flags:c.flags},s;case w.num:case w.string:return this.parseLiteral(this.value);case w._null:case w._true:case w._false:return s=this.startNode(),s.value=this.type===w._null?null:this.type===w._true,s.raw=this.type.keyword,this.next(),this.finishNode(s,"Literal");case w.parenL:var h=this.start,u=this.parseParenAndDistinguishExpression(n,t);return i&&(i.parenthesizedAssign<0&&!this.isSimpleAssignTarget(u)&&(i.parenthesizedAssign=h),i.parenthesizedBind<0&&(i.parenthesizedBind=h)),u;case w.bracketL:return s=this.startNode(),this.next(),s.elements=this.parseExprList(w.bracketR,!0,!0,i),this.finishNode(s,"ArrayExpression");case w.braceL:return this.overrideContext(Se.b_expr),this.parseObj(!1,i);case w._function:return s=this.startNode(),this.next(),this.parseFunction(s,0);case w._class:return this.parseClass(this.startNode(),!1);case w._new:return this.parseNew();case w.backQuote:return this.parseTemplate();case w._import:return this.options.ecmaVersion>=11?this.parseExprImport(e):this.unexpected();default:return this.parseExprAtomDefault()}};At.parseExprAtomDefault=function(){this.unexpected()};At.parseExprImport=function(i){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===w.parenL&&!i)return this.parseDynamicImport(t);if(this.type===w.dot){var e=this.startNodeAt(t.start,t.loc&&t.loc.start);return e.name="import",t.meta=this.finishNode(e,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};At.parseDynamicImport=function(i){if(this.next(),i.source=this.parseMaybeAssign(),this.options.ecmaVersion>=16)this.eat(w.parenR)?i.options=null:(this.expect(w.comma),this.afterTrailingComma(w.parenR)?i.options=null:(i.options=this.parseMaybeAssign(),this.eat(w.parenR)||(this.expect(w.comma),this.afterTrailingComma(w.parenR)||this.unexpected())));else if(!this.eat(w.parenR)){var t=this.start;this.eat(w.comma)&&this.eat(w.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(i,"ImportExpression")};At.parseImportMeta=function(i){this.next();var t=this.containsEsc;return i.property=this.parseIdent(!0),i.property.name!=="meta"&&this.raiseRecoverable(i.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(i.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(i.start,"Cannot use 'import.meta' outside a module"),this.finishNode(i,"MetaProperty")};At.parseLiteral=function(i){var t=this.startNode();return t.value=i,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.value!=null?t.value.toString():t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};At.parseParenExpression=function(){this.expect(w.parenL);var i=this.parseExpression();return this.expect(w.parenR),i};At.shouldParseArrow=function(i){return!this.canInsertSemicolon()};At.parseParenAndDistinguishExpression=function(i,t){var e=this.start,s=this.startLoc,n,r=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,a=this.startLoc,l=[],c=!0,h=!1,u=new Op,f=this.yieldPos,d=this.awaitPos,p;for(this.yieldPos=0,this.awaitPos=0;this.type!==w.parenR;)if(c?c=!1:this.expect(w.comma),r&&this.afterTrailingComma(w.parenR,!0)){h=!0;break}else if(this.type===w.ellipsis){p=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===w.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,u,this.parseParenItem));var g=this.lastTokEnd,m=this.lastTokEndLoc;if(this.expect(w.parenR),i&&this.shouldParseArrow(l)&&this.eat(w.arrow))return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=f,this.awaitPos=d,this.parseParenArrowList(e,s,l,t);(!l.length||h)&&this.unexpected(this.lastTokStart),p&&this.unexpected(p),this.checkExpressionErrors(u,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=d||this.awaitPos,l.length>1?(n=this.startNodeAt(o,a),n.expressions=l,this.finishNodeAt(n,"SequenceExpression",g,m)):n=l[0]}else n=this.parseParenExpression();if(this.options.preserveParens){var O=this.startNodeAt(e,s);return O.expression=n,this.finishNode(O,"ParenthesizedExpression")}else return n};At.parseParenItem=function(i){return i};At.parseParenArrowList=function(i,t,e,s){return this.parseArrowExpression(this.startNodeAt(i,t),e,!1,s)};var _W=[];At.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var i=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===w.dot){var t=this.startNodeAt(i.start,i.loc&&i.loc.start);t.name="new",i.meta=this.finishNode(t,"Identifier"),this.next();var e=this.containsEsc;return i.property=this.parseIdent(!0),i.property.name!=="target"&&this.raiseRecoverable(i.property.start,"The only valid meta property for new is 'new.target'"),e&&this.raiseRecoverable(i.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(i.start,"'new.target' can only be used in functions and class static block"),this.finishNode(i,"MetaProperty")}var s=this.start,n=this.startLoc;return i.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),s,n,!0,!1),this.eat(w.parenL)?i.arguments=this.parseExprList(w.parenR,this.options.ecmaVersion>=8,!1):i.arguments=_W,this.finishNode(i,"NewExpression")};At.parseTemplateElement=function(i){var t=i.isTagged,e=this.startNode();return this.type===w.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),e.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):e.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),e.tail=this.type===w.backQuote,this.finishNode(e,"TemplateElement")};At.parseTemplate=function(i){i===void 0&&(i={});var t=i.isTagged;t===void 0&&(t=!1);var e=this.startNode();this.next(),e.expressions=[];var s=this.parseTemplateElement({isTagged:t});for(e.quasis=[s];!s.tail;)this.type===w.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(w.dollarBraceL),e.expressions.push(this.parseExpression()),this.expect(w.braceR),e.quasis.push(s=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(e,"TemplateLiteral")};At.isAsyncProp=function(i){return!i.computed&&i.key.type==="Identifier"&&i.key.name==="async"&&(this.type===w.name||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===w.star)&&!Ui.test(this.input.slice(this.lastTokEnd,this.start))};At.parseObj=function(i,t){var e=this.startNode(),s=!0,n={};for(e.properties=[],this.next();!this.eat(w.braceR);){if(s)s=!1;else if(this.expect(w.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(w.braceR))break;var r=this.parseProperty(i,t);i||this.checkPropClash(r,n,t),e.properties.push(r)}return this.finishNode(e,i?"ObjectPattern":"ObjectExpression")};At.parseProperty=function(i,t){var e=this.startNode(),s,n,r,o;if(this.options.ecmaVersion>=9&&this.eat(w.ellipsis))return i?(e.argument=this.parseIdent(!1),this.type===w.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(e,"RestElement")):(e.argument=this.parseMaybeAssign(!1,t),this.type===w.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(e,"SpreadElement"));this.options.ecmaVersion>=6&&(e.method=!1,e.shorthand=!1,(i||t)&&(r=this.start,o=this.startLoc),i||(s=this.eat(w.star)));var a=this.containsEsc;return this.parsePropertyName(e),!i&&!a&&this.options.ecmaVersion>=8&&!s&&this.isAsyncProp(e)?(n=!0,s=this.options.ecmaVersion>=9&&this.eat(w.star),this.parsePropertyName(e)):n=!1,this.parsePropertyValue(e,i,s,n,r,o,t,a),this.finishNode(e,"Property")};At.parseGetterSetter=function(i){var t=i.key.name;this.parsePropertyName(i),i.value=this.parseMethod(!1),i.kind=t;var e=i.kind==="get"?0:1;if(i.value.params.length!==e){var s=i.value.start;i.kind==="get"?this.raiseRecoverable(s,"getter should have no params"):this.raiseRecoverable(s,"setter should have exactly one param")}else i.kind==="set"&&i.value.params[0].type==="RestElement"&&this.raiseRecoverable(i.value.params[0].start,"Setter cannot use rest params")};At.parsePropertyValue=function(i,t,e,s,n,r,o,a){(e||s)&&this.type===w.colon&&this.unexpected(),this.eat(w.colon)?(i.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),i.kind="init"):this.options.ecmaVersion>=6&&this.type===w.parenL?(t&&this.unexpected(),i.method=!0,i.value=this.parseMethod(e,s),i.kind="init"):!t&&!a&&this.options.ecmaVersion>=5&&!i.computed&&i.key.type==="Identifier"&&(i.key.name==="get"||i.key.name==="set")&&this.type!==w.comma&&this.type!==w.braceR&&this.type!==w.eq?((e||s)&&this.unexpected(),this.parseGetterSetter(i)):this.options.ecmaVersion>=6&&!i.computed&&i.key.type==="Identifier"?((e||s)&&this.unexpected(),this.checkUnreserved(i.key),i.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=n),t?i.value=this.parseMaybeDefault(n,r,this.copyNode(i.key)):this.type===w.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),i.value=this.parseMaybeDefault(n,r,this.copyNode(i.key))):i.value=this.copyNode(i.key),i.kind="init",i.shorthand=!0):this.unexpected()};At.parsePropertyName=function(i){if(this.options.ecmaVersion>=6){if(this.eat(w.bracketL))return i.computed=!0,i.key=this.parseMaybeAssign(),this.expect(w.bracketR),i.key;i.computed=!1}return i.key=this.type===w.num||this.type===w.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};At.initFunction=function(i){i.id=null,this.options.ecmaVersion>=6&&(i.generator=i.expression=!1),this.options.ecmaVersion>=8&&(i.async=!1)};At.parseMethod=function(i,t,e){var s=this.startNode(),n=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(s),this.options.ecmaVersion>=6&&(s.generator=i),this.options.ecmaVersion>=8&&(s.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(w1(t,s.generator)|gp|(e?NC:0)),this.expect(w.parenL),s.params=this.parseBindingList(w.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(s,!1,!0,!1),this.yieldPos=n,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(s,"FunctionExpression")};At.parseArrowExpression=function(i,t,e,s){var n=this.yieldPos,r=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(w1(e,!1)|S1),this.initFunction(i),this.options.ecmaVersion>=8&&(i.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,i.params=this.toAssignableList(t,!0),this.parseFunctionBody(i,!0,!1,s),this.yieldPos=n,this.awaitPos=r,this.awaitIdentPos=o,this.finishNode(i,"ArrowFunctionExpression")};At.parseFunctionBody=function(i,t,e,s){var n=t&&this.type!==w.braceL,r=this.strict,o=!1;if(n)i.body=this.parseMaybeAssign(s),i.expression=!0,this.checkParams(i,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(i.params);(!r||a)&&(o=this.strictDirective(this.end),o&&a&&this.raiseRecoverable(i.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(i,!r&&!o&&!t&&!e&&this.isSimpleParamList(i.params)),this.strict&&i.id&&this.checkLValSimple(i.id,VC),i.body=this.parseBlock(!1,void 0,o&&!r),i.expression=!1,this.adaptDirectivePrologue(i.body.body),this.labels=l}this.exitScope()};At.isSimpleParamList=function(i){for(var t=0,e=i;t<e.length;t+=1){var s=e[t];if(s.type!=="Identifier")return!1}return!0};At.checkParams=function(i,t){for(var e=Object.create(null),s=0,n=i.params;s<n.length;s+=1){var r=n[s];this.checkLValInnerPattern(r,k1,t?null:e)}};At.parseExprList=function(i,t,e,s){for(var n=[],r=!0;!this.eat(i);){if(r)r=!1;else if(this.expect(w.comma),t&&this.afterTrailingComma(i))break;var o=void 0;e&&this.type===w.comma?o=null:this.type===w.ellipsis?(o=this.parseSpread(s),s&&this.type===w.comma&&s.trailingComma<0&&(s.trailingComma=this.start)):o=this.parseMaybeAssign(!1,s),n.push(o)}return n};At.checkUnreserved=function(i){var t=i.start,e=i.end,s=i.name;if(this.inGenerator&&s==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&s==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),!(this.currentThisScope().flags&mp)&&s==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(s==="arguments"||s==="await")&&this.raise(t,"Cannot use "+s+" in class static initialization block"),this.keywords.test(s)&&this.raise(t,"Unexpected keyword '"+s+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,e).indexOf("\\")!==-1)){var n=this.strict?this.reservedWordsStrict:this.reservedWords;n.test(s)&&(!this.inAsync&&s==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+s+"' is reserved"))}};At.parseIdent=function(i){var t=this.parseIdentNode();return this.next(!!i),this.finishNode(t,"Identifier"),i||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};At.parseIdentNode=function(){var i=this.startNode();return this.type===w.name?i.name=this.value:this.type.keyword?(i.name=this.type.keyword,(i.name==="class"||i.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=w.name):this.unexpected(),i};At.parsePrivateIdent=function(){var i=this.startNode();return this.type===w.privateId?i.name=this.value:this.unexpected(),this.next(),this.finishNode(i,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(i.start,"Private field '#"+i.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(i)),i};At.parseYield=function(i){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===w.semi||this.canInsertSemicolon()||this.type!==w.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(w.star),t.argument=this.parseMaybeAssign(i)),this.finishNode(t,"YieldExpression")};At.parseAwait=function(i){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,i),this.finishNode(t,"AwaitExpression")};var md=Ye.prototype;md.raise=function(i,t){var e=QC(this.input,i);t+=" ("+e.line+":"+e.column+")",this.sourceFile&&(t+=" in "+this.sourceFile);var s=new SyntaxError(t);throw s.pos=i,s.loc=e,s.raisedAt=this.pos,s};md.raiseRecoverable=md.raise;md.curPosition=function(){if(this.options.locations)return new Yc(this.curLine,this.pos-this.lineStart)};var oo=Ye.prototype,xW=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[]};oo.enterScope=function(i){this.scopeStack.push(new xW(i))};oo.exitScope=function(){this.scopeStack.pop()};oo.treatFunctionsAsVarInScope=function(i){return i.flags&fl||!this.inModule&&i.flags&Uc};oo.declareName=function(i,t,e){var s=!1;if(t===dr){var n=this.currentScope();s=n.lexical.indexOf(i)>-1||n.functions.indexOf(i)>-1||n.var.indexOf(i)>-1,n.lexical.push(i),this.inModule&&n.flags&Uc&&delete this.undefinedExports[i]}else if(t===LC){var r=this.currentScope();r.lexical.push(i)}else if(t===DC){var o=this.currentScope();this.treatFunctionsAsVar?s=o.lexical.indexOf(i)>-1:s=o.lexical.indexOf(i)>-1||o.var.indexOf(i)>-1,o.functions.push(i)}else for(var a=this.scopeStack.length-1;a>=0;--a){var l=this.scopeStack[a];if(l.lexical.indexOf(i)>-1&&!(l.flags&$C&&l.lexical[0]===i)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(i)>-1){s=!0;break}if(l.var.push(i),this.inModule&&l.flags&Uc&&delete this.undefinedExports[i],l.flags&mp)break}s&&this.raiseRecoverable(e,"Identifier '"+i+"' has already been declared")};oo.checkLocalExport=function(i){this.scopeStack[0].lexical.indexOf(i.name)===-1&&this.scopeStack[0].var.indexOf(i.name)===-1&&(this.undefinedExports[i.name]=i)};oo.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};oo.currentVarScope=function(){for(var i=this.scopeStack.length-1;;i--){var t=this.scopeStack[i];if(t.flags&(mp|Qh|Go))return t}};oo.currentThisScope=function(){for(var i=this.scopeStack.length-1;;i--){var t=this.scopeStack[i];if(t.flags&(mp|Qh|Go)&&!(t.flags&S1))return t}};var yp=function(t,e,s){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new pp(t,s)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},Ih=Ye.prototype;Ih.startNode=function(){return new yp(this,this.start,this.startLoc)};Ih.startNodeAt=function(i,t){return new yp(this,i,t)};function FC(i,t,e,s){return i.type=t,i.end=e,this.options.locations&&(i.loc.end=s),this.options.ranges&&(i.range[1]=e),i}Ih.finishNode=function(i,t){return FC.call(this,i,t,this.lastTokEnd,this.lastTokEndLoc)};Ih.finishNodeAt=function(i,t,e,s){return FC.call(this,i,t,e,s)};Ih.copyNode=function(i){var t=new yp(this,i.start,this.startLoc);for(var e in i)t[e]=i[e];return t};var SW="Gara Garay Gukh Gurung_Khema Hrkt Katakana_Or_Hiragana Kawi Kirat_Rai Krai Nag_Mundari Nagm Ol_Onal Onao Sunu Sunuwar Todhri Todr Tulu_Tigalari Tutg Unknown Zzzz",WC="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",qC=WC+" Extended_Pictographic",XC=qC,zC=XC+" EBase EComp EMod EPres ExtPict",jC=zC,wW=jC,kW={9:WC,10:qC,11:XC,12:zC,13:jC,14:wW},CW="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",TW={9:"",10:"",11:"",12:"",13:"",14:CW},B_="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",GC="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",YC=GC+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",UC=YC+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",HC=UC+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",KC=HC+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",PW=KC+" "+SW,AW={9:GC,10:YC,11:UC,12:HC,13:KC,14:PW},JC={};function MW(i){var t=JC[i]={binary:Qr(kW[i]+" "+B_),binaryOfStrings:Qr(TW[i]),nonBinary:{General_Category:Qr(B_),Script:Qr(AW[i])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(var Ag=0,Z_=[9,10,11,12,13,14];Ag<Z_.length;Ag+=1){var EW=Z_[Ag];MW(EW)}var dt=Ye.prototype,Od=function(t,e){this.parent=t,this.base=e||this};Od.prototype.separatedFrom=function(t){for(var e=this;e;e=e.parent)for(var s=t;s;s=s.parent)if(e.base===s.base&&e!==s)return!0;return!1};Od.prototype.sibling=function(){return new Od(this.parent,this.base)};var Rn=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=JC[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Rn.prototype.reset=function(t,e,s){var n=s.indexOf("v")!==-1,r=s.indexOf("u")!==-1;this.start=t|0,this.source=e+"",this.flags=s,n&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)};Rn.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};Rn.prototype.at=function(t,e){e===void 0&&(e=!1);var s=this.source,n=s.length;if(t>=n)return-1;var r=s.charCodeAt(t);if(!(e||this.switchU)||r<=55295||r>=57344||t+1>=n)return r;var o=s.charCodeAt(t+1);return o>=56320&&o<=57343?(r<<10)+o-56613888:r};Rn.prototype.nextIndex=function(t,e){e===void 0&&(e=!1);var s=this.source,n=s.length;if(t>=n)return n;var r=s.charCodeAt(t),o;return!(e||this.switchU)||r<=55295||r>=57344||t+1>=n||(o=s.charCodeAt(t+1))<56320||o>57343?t+1:t+2};Rn.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};Rn.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};Rn.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};Rn.prototype.eat=function(t,e){return e===void 0&&(e=!1),this.current(e)===t?(this.advance(e),!0):!1};Rn.prototype.eatChars=function(t,e){e===void 0&&(e=!1);for(var s=this.pos,n=0,r=t;n<r.length;n+=1){var o=r[n],a=this.at(s,e);if(a===-1||a!==o)return!1;s=this.nextIndex(s,e)}return this.pos=s,!0};dt.validateRegExpFlags=function(i){for(var t=i.validFlags,e=i.flags,s=!1,n=!1,r=0;r<e.length;r++){var o=e.charAt(r);t.indexOf(o)===-1&&this.raise(i.start,"Invalid regular expression flag"),e.indexOf(o,r+1)>-1&&this.raise(i.start,"Duplicate regular expression flag"),o==="u"&&(s=!0),o==="v"&&(n=!0)}this.options.ecmaVersion>=15&&s&&n&&this.raise(i.start,"Invalid regular expression flag")};function RW(i){for(var t in i)return!0;return!1}dt.validateRegExpPattern=function(i){this.regexp_pattern(i),!i.switchN&&this.options.ecmaVersion>=9&&RW(i.groupNames)&&(i.switchN=!0,this.regexp_pattern(i))};dt.regexp_pattern=function(i){i.pos=0,i.lastIntValue=0,i.lastStringValue="",i.lastAssertionIsQuantifiable=!1,i.numCapturingParens=0,i.maxBackReference=0,i.groupNames=Object.create(null),i.backReferenceNames.length=0,i.branchID=null,this.regexp_disjunction(i),i.pos!==i.source.length&&(i.eat(41)&&i.raise("Unmatched ')'"),(i.eat(93)||i.eat(125))&&i.raise("Lone quantifier brackets")),i.maxBackReference>i.numCapturingParens&&i.raise("Invalid escape");for(var t=0,e=i.backReferenceNames;t<e.length;t+=1){var s=e[t];i.groupNames[s]||i.raise("Invalid named capture referenced")}};dt.regexp_disjunction=function(i){var t=this.options.ecmaVersion>=16;for(t&&(i.branchID=new Od(i.branchID,null)),this.regexp_alternative(i);i.eat(124);)t&&(i.branchID=i.branchID.sibling()),this.regexp_alternative(i);t&&(i.branchID=i.branchID.parent),this.regexp_eatQuantifier(i,!0)&&i.raise("Nothing to repeat"),i.eat(123)&&i.raise("Lone quantifier brackets")};dt.regexp_alternative=function(i){for(;i.pos<i.source.length&&this.regexp_eatTerm(i););};dt.regexp_eatTerm=function(i){return this.regexp_eatAssertion(i)?(i.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(i)&&i.switchU&&i.raise("Invalid quantifier"),!0):(i.switchU?this.regexp_eatAtom(i):this.regexp_eatExtendedAtom(i))?(this.regexp_eatQuantifier(i),!0):!1};dt.regexp_eatAssertion=function(i){var t=i.pos;if(i.lastAssertionIsQuantifiable=!1,i.eat(94)||i.eat(36))return!0;if(i.eat(92)){if(i.eat(66)||i.eat(98))return!0;i.pos=t}if(i.eat(40)&&i.eat(63)){var e=!1;if(this.options.ecmaVersion>=9&&(e=i.eat(60)),i.eat(61)||i.eat(33))return this.regexp_disjunction(i),i.eat(41)||i.raise("Unterminated group"),i.lastAssertionIsQuantifiable=!e,!0}return i.pos=t,!1};dt.regexp_eatQuantifier=function(i,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(i,t)?(i.eat(63),!0):!1};dt.regexp_eatQuantifierPrefix=function(i,t){return i.eat(42)||i.eat(43)||i.eat(63)||this.regexp_eatBracedQuantifier(i,t)};dt.regexp_eatBracedQuantifier=function(i,t){var e=i.pos;if(i.eat(123)){var s=0,n=-1;if(this.regexp_eatDecimalDigits(i)&&(s=i.lastIntValue,i.eat(44)&&this.regexp_eatDecimalDigits(i)&&(n=i.lastIntValue),i.eat(125)))return n!==-1&&n<s&&!t&&i.raise("numbers out of order in {} quantifier"),!0;i.switchU&&!t&&i.raise("Incomplete quantifier"),i.pos=e}return!1};dt.regexp_eatAtom=function(i){return this.regexp_eatPatternCharacters(i)||i.eat(46)||this.regexp_eatReverseSolidusAtomEscape(i)||this.regexp_eatCharacterClass(i)||this.regexp_eatUncapturingGroup(i)||this.regexp_eatCapturingGroup(i)};dt.regexp_eatReverseSolidusAtomEscape=function(i){var t=i.pos;if(i.eat(92)){if(this.regexp_eatAtomEscape(i))return!0;i.pos=t}return!1};dt.regexp_eatUncapturingGroup=function(i){var t=i.pos;if(i.eat(40)){if(i.eat(63)){if(this.options.ecmaVersion>=16){var e=this.regexp_eatModifiers(i),s=i.eat(45);if(e||s){for(var n=0;n<e.length;n++){var r=e.charAt(n);e.indexOf(r,n+1)>-1&&i.raise("Duplicate regular expression modifiers")}if(s){var o=this.regexp_eatModifiers(i);!e&&!o&&i.current()===58&&i.raise("Invalid regular expression modifiers");for(var a=0;a<o.length;a++){var l=o.charAt(a);(o.indexOf(l,a+1)>-1||e.indexOf(l)>-1)&&i.raise("Duplicate regular expression modifiers")}}}}if(i.eat(58)){if(this.regexp_disjunction(i),i.eat(41))return!0;i.raise("Unterminated group")}}i.pos=t}return!1};dt.regexp_eatCapturingGroup=function(i){if(i.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(i):i.current()===63&&i.raise("Invalid group"),this.regexp_disjunction(i),i.eat(41))return i.numCapturingParens+=1,!0;i.raise("Unterminated group")}return!1};dt.regexp_eatModifiers=function(i){for(var t="",e=0;(e=i.current())!==-1&&QW(e);)t+=ir(e),i.advance();return t};function QW(i){return i===105||i===109||i===115}dt.regexp_eatExtendedAtom=function(i){return i.eat(46)||this.regexp_eatReverseSolidusAtomEscape(i)||this.regexp_eatCharacterClass(i)||this.regexp_eatUncapturingGroup(i)||this.regexp_eatCapturingGroup(i)||this.regexp_eatInvalidBracedQuantifier(i)||this.regexp_eatExtendedPatternCharacter(i)};dt.regexp_eatInvalidBracedQuantifier=function(i){return this.regexp_eatBracedQuantifier(i,!0)&&i.raise("Nothing to repeat"),!1};dt.regexp_eatSyntaxCharacter=function(i){var t=i.current();return t3(t)?(i.lastIntValue=t,i.advance(),!0):!1};function t3(i){return i===36||i>=40&&i<=43||i===46||i===63||i>=91&&i<=94||i>=123&&i<=125}dt.regexp_eatPatternCharacters=function(i){for(var t=i.pos,e=0;(e=i.current())!==-1&&!t3(e);)i.advance();return i.pos!==t};dt.regexp_eatExtendedPatternCharacter=function(i){var t=i.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(i.advance(),!0):!1};dt.regexp_groupSpecifier=function(i){if(i.eat(63)){this.regexp_eatGroupName(i)||i.raise("Invalid group");var t=this.options.ecmaVersion>=16,e=i.groupNames[i.lastStringValue];if(e)if(t)for(var s=0,n=e;s<n.length;s+=1){var r=n[s];r.separatedFrom(i.branchID)||i.raise("Duplicate capture group name")}else i.raise("Duplicate capture group name");t?(e||(i.groupNames[i.lastStringValue]=[])).push(i.branchID):i.groupNames[i.lastStringValue]=!0}};dt.regexp_eatGroupName=function(i){if(i.lastStringValue="",i.eat(60)){if(this.regexp_eatRegExpIdentifierName(i)&&i.eat(62))return!0;i.raise("Invalid capture group name")}return!1};dt.regexp_eatRegExpIdentifierName=function(i){if(i.lastStringValue="",this.regexp_eatRegExpIdentifierStart(i)){for(i.lastStringValue+=ir(i.lastIntValue);this.regexp_eatRegExpIdentifierPart(i);)i.lastStringValue+=ir(i.lastIntValue);return!0}return!1};dt.regexp_eatRegExpIdentifierStart=function(i){var t=i.pos,e=this.options.ecmaVersion>=11,s=i.current(e);return i.advance(e),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(i,e)&&(s=i.lastIntValue),IW(s)?(i.lastIntValue=s,!0):(i.pos=t,!1)};function IW(i){return wn(i,!0)||i===36||i===95}dt.regexp_eatRegExpIdentifierPart=function(i){var t=i.pos,e=this.options.ecmaVersion>=11,s=i.current(e);return i.advance(e),s===92&&this.regexp_eatRegExpUnicodeEscapeSequence(i,e)&&(s=i.lastIntValue),$W(s)?(i.lastIntValue=s,!0):(i.pos=t,!1)};function $W(i){return Hr(i,!0)||i===36||i===95||i===8204||i===8205}dt.regexp_eatAtomEscape=function(i){return this.regexp_eatBackReference(i)||this.regexp_eatCharacterClassEscape(i)||this.regexp_eatCharacterEscape(i)||i.switchN&&this.regexp_eatKGroupName(i)?!0:(i.switchU&&(i.current()===99&&i.raise("Invalid unicode escape"),i.raise("Invalid escape")),!1)};dt.regexp_eatBackReference=function(i){var t=i.pos;if(this.regexp_eatDecimalEscape(i)){var e=i.lastIntValue;if(i.switchU)return e>i.maxBackReference&&(i.maxBackReference=e),!0;if(e<=i.numCapturingParens)return!0;i.pos=t}return!1};dt.regexp_eatKGroupName=function(i){if(i.eat(107)){if(this.regexp_eatGroupName(i))return i.backReferenceNames.push(i.lastStringValue),!0;i.raise("Invalid named reference")}return!1};dt.regexp_eatCharacterEscape=function(i){return this.regexp_eatControlEscape(i)||this.regexp_eatCControlLetter(i)||this.regexp_eatZero(i)||this.regexp_eatHexEscapeSequence(i)||this.regexp_eatRegExpUnicodeEscapeSequence(i,!1)||!i.switchU&&this.regexp_eatLegacyOctalEscapeSequence(i)||this.regexp_eatIdentityEscape(i)};dt.regexp_eatCControlLetter=function(i){var t=i.pos;if(i.eat(99)){if(this.regexp_eatControlLetter(i))return!0;i.pos=t}return!1};dt.regexp_eatZero=function(i){return i.current()===48&&!bp(i.lookahead())?(i.lastIntValue=0,i.advance(),!0):!1};dt.regexp_eatControlEscape=function(i){var t=i.current();return t===116?(i.lastIntValue=9,i.advance(),!0):t===110?(i.lastIntValue=10,i.advance(),!0):t===118?(i.lastIntValue=11,i.advance(),!0):t===102?(i.lastIntValue=12,i.advance(),!0):t===114?(i.lastIntValue=13,i.advance(),!0):!1};dt.regexp_eatControlLetter=function(i){var t=i.current();return e3(t)?(i.lastIntValue=t%32,i.advance(),!0):!1};function e3(i){return i>=65&&i<=90||i>=97&&i<=122}dt.regexp_eatRegExpUnicodeEscapeSequence=function(i,t){t===void 0&&(t=!1);var e=i.pos,s=t||i.switchU;if(i.eat(117)){if(this.regexp_eatFixedHexDigits(i,4)){var n=i.lastIntValue;if(s&&n>=55296&&n<=56319){var r=i.pos;if(i.eat(92)&&i.eat(117)&&this.regexp_eatFixedHexDigits(i,4)){var o=i.lastIntValue;if(o>=56320&&o<=57343)return i.lastIntValue=(n-55296)*1024+(o-56320)+65536,!0}i.pos=r,i.lastIntValue=n}return!0}if(s&&i.eat(123)&&this.regexp_eatHexDigits(i)&&i.eat(125)&&NW(i.lastIntValue))return!0;s&&i.raise("Invalid unicode escape"),i.pos=e}return!1};function NW(i){return i>=0&&i<=1114111}dt.regexp_eatIdentityEscape=function(i){if(i.switchU)return this.regexp_eatSyntaxCharacter(i)?!0:i.eat(47)?(i.lastIntValue=47,!0):!1;var t=i.current();return t!==99&&(!i.switchN||t!==107)?(i.lastIntValue=t,i.advance(),!0):!1};dt.regexp_eatDecimalEscape=function(i){i.lastIntValue=0;var t=i.current();if(t>=49&&t<=57){do i.lastIntValue=10*i.lastIntValue+(t-48),i.advance();while((t=i.current())>=48&&t<=57);return!0}return!1};var i3=0,sr=1,Os=2;dt.regexp_eatCharacterClassEscape=function(i){var t=i.current();if(DW(t))return i.lastIntValue=-1,i.advance(),sr;var e=!1;if(i.switchU&&this.options.ecmaVersion>=9&&((e=t===80)||t===112)){i.lastIntValue=-1,i.advance();var s;if(i.eat(123)&&(s=this.regexp_eatUnicodePropertyValueExpression(i))&&i.eat(125))return e&&s===Os&&i.raise("Invalid property name"),s;i.raise("Invalid property name")}return i3};function DW(i){return i===100||i===68||i===115||i===83||i===119||i===87}dt.regexp_eatUnicodePropertyValueExpression=function(i){var t=i.pos;if(this.regexp_eatUnicodePropertyName(i)&&i.eat(61)){var e=i.lastStringValue;if(this.regexp_eatUnicodePropertyValue(i)){var s=i.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(i,e,s),sr}}if(i.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(i)){var n=i.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(i,n)}return i3};dt.regexp_validateUnicodePropertyNameAndValue=function(i,t,e){ul(i.unicodeProperties.nonBinary,t)||i.raise("Invalid property name"),i.unicodeProperties.nonBinary[t].test(e)||i.raise("Invalid property value")};dt.regexp_validateUnicodePropertyNameOrValue=function(i,t){if(i.unicodeProperties.binary.test(t))return sr;if(i.switchV&&i.unicodeProperties.binaryOfStrings.test(t))return Os;i.raise("Invalid property name")};dt.regexp_eatUnicodePropertyName=function(i){var t=0;for(i.lastStringValue="";s3(t=i.current());)i.lastStringValue+=ir(t),i.advance();return i.lastStringValue!==""};function s3(i){return e3(i)||i===95}dt.regexp_eatUnicodePropertyValue=function(i){var t=0;for(i.lastStringValue="";LW(t=i.current());)i.lastStringValue+=ir(t),i.advance();return i.lastStringValue!==""};function LW(i){return s3(i)||bp(i)}dt.regexp_eatLoneUnicodePropertyNameOrValue=function(i){return this.regexp_eatUnicodePropertyValue(i)};dt.regexp_eatCharacterClass=function(i){if(i.eat(91)){var t=i.eat(94),e=this.regexp_classContents(i);return i.eat(93)||i.raise("Unterminated character class"),t&&e===Os&&i.raise("Negated character class may contain strings"),!0}return!1};dt.regexp_classContents=function(i){return i.current()===93?sr:i.switchV?this.regexp_classSetExpression(i):(this.regexp_nonEmptyClassRanges(i),sr)};dt.regexp_nonEmptyClassRanges=function(i){for(;this.regexp_eatClassAtom(i);){var t=i.lastIntValue;if(i.eat(45)&&this.regexp_eatClassAtom(i)){var e=i.lastIntValue;i.switchU&&(t===-1||e===-1)&&i.raise("Invalid character class"),t!==-1&&e!==-1&&t>e&&i.raise("Range out of order in character class")}}};dt.regexp_eatClassAtom=function(i){var t=i.pos;if(i.eat(92)){if(this.regexp_eatClassEscape(i))return!0;if(i.switchU){var e=i.current();(e===99||o3(e))&&i.raise("Invalid class escape"),i.raise("Invalid escape")}i.pos=t}var s=i.current();return s!==93?(i.lastIntValue=s,i.advance(),!0):!1};dt.regexp_eatClassEscape=function(i){var t=i.pos;if(i.eat(98))return i.lastIntValue=8,!0;if(i.switchU&&i.eat(45))return i.lastIntValue=45,!0;if(!i.switchU&&i.eat(99)){if(this.regexp_eatClassControlLetter(i))return!0;i.pos=t}return this.regexp_eatCharacterClassEscape(i)||this.regexp_eatCharacterEscape(i)};dt.regexp_classSetExpression=function(i){var t=sr,e;if(!this.regexp_eatClassSetRange(i))if(e=this.regexp_eatClassSetOperand(i)){e===Os&&(t=Os);for(var s=i.pos;i.eatChars([38,38]);){if(i.current()!==38&&(e=this.regexp_eatClassSetOperand(i))){e!==Os&&(t=sr);continue}i.raise("Invalid character in character class")}if(s!==i.pos)return t;for(;i.eatChars([45,45]);)this.regexp_eatClassSetOperand(i)||i.raise("Invalid character in character class");if(s!==i.pos)return t}else i.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(i)){if(e=this.regexp_eatClassSetOperand(i),!e)return t;e===Os&&(t=Os)}};dt.regexp_eatClassSetRange=function(i){var t=i.pos;if(this.regexp_eatClassSetCharacter(i)){var e=i.lastIntValue;if(i.eat(45)&&this.regexp_eatClassSetCharacter(i)){var s=i.lastIntValue;return e!==-1&&s!==-1&&e>s&&i.raise("Range out of order in character class"),!0}i.pos=t}return!1};dt.regexp_eatClassSetOperand=function(i){return this.regexp_eatClassSetCharacter(i)?sr:this.regexp_eatClassStringDisjunction(i)||this.regexp_eatNestedClass(i)};dt.regexp_eatNestedClass=function(i){var t=i.pos;if(i.eat(91)){var e=i.eat(94),s=this.regexp_classContents(i);if(i.eat(93))return e&&s===Os&&i.raise("Negated character class may contain strings"),s;i.pos=t}if(i.eat(92)){var n=this.regexp_eatCharacterClassEscape(i);if(n)return n;i.pos=t}return null};dt.regexp_eatClassStringDisjunction=function(i){var t=i.pos;if(i.eatChars([92,113])){if(i.eat(123)){var e=this.regexp_classStringDisjunctionContents(i);if(i.eat(125))return e}else i.raise("Invalid escape");i.pos=t}return null};dt.regexp_classStringDisjunctionContents=function(i){for(var t=this.regexp_classString(i);i.eat(124);)this.regexp_classString(i)===Os&&(t=Os);return t};dt.regexp_classString=function(i){for(var t=0;this.regexp_eatClassSetCharacter(i);)t++;return t===1?sr:Os};dt.regexp_eatClassSetCharacter=function(i){var t=i.pos;if(i.eat(92))return this.regexp_eatCharacterEscape(i)||this.regexp_eatClassSetReservedPunctuator(i)?!0:i.eat(98)?(i.lastIntValue=8,!0):(i.pos=t,!1);var e=i.current();return e<0||e===i.lookahead()&&VW(e)||BW(e)?!1:(i.advance(),i.lastIntValue=e,!0)};function VW(i){return i===33||i>=35&&i<=38||i>=42&&i<=44||i===46||i>=58&&i<=64||i===94||i===96||i===126}function BW(i){return i===40||i===41||i===45||i===47||i>=91&&i<=93||i>=123&&i<=125}dt.regexp_eatClassSetReservedPunctuator=function(i){var t=i.current();return ZW(t)?(i.lastIntValue=t,i.advance(),!0):!1};function ZW(i){return i===33||i===35||i===37||i===38||i===44||i===45||i>=58&&i<=62||i===64||i===96||i===126}dt.regexp_eatClassControlLetter=function(i){var t=i.current();return bp(t)||t===95?(i.lastIntValue=t%32,i.advance(),!0):!1};dt.regexp_eatHexEscapeSequence=function(i){var t=i.pos;if(i.eat(120)){if(this.regexp_eatFixedHexDigits(i,2))return!0;i.switchU&&i.raise("Invalid escape"),i.pos=t}return!1};dt.regexp_eatDecimalDigits=function(i){var t=i.pos,e=0;for(i.lastIntValue=0;bp(e=i.current());)i.lastIntValue=10*i.lastIntValue+(e-48),i.advance();return i.pos!==t};function bp(i){return i>=48&&i<=57}dt.regexp_eatHexDigits=function(i){var t=i.pos,e=0;for(i.lastIntValue=0;n3(e=i.current());)i.lastIntValue=16*i.lastIntValue+r3(e),i.advance();return i.pos!==t};function n3(i){return i>=48&&i<=57||i>=65&&i<=70||i>=97&&i<=102}function r3(i){return i>=65&&i<=70?10+(i-65):i>=97&&i<=102?10+(i-97):i-48}dt.regexp_eatLegacyOctalEscapeSequence=function(i){if(this.regexp_eatOctalDigit(i)){var t=i.lastIntValue;if(this.regexp_eatOctalDigit(i)){var e=i.lastIntValue;t<=3&&this.regexp_eatOctalDigit(i)?i.lastIntValue=t*64+e*8+i.lastIntValue:i.lastIntValue=t*8+e}else i.lastIntValue=t;return!0}return!1};dt.regexp_eatOctalDigit=function(i){var t=i.current();return o3(t)?(i.lastIntValue=t-48,i.advance(),!0):(i.lastIntValue=0,!1)};function o3(i){return i>=48&&i<=55}dt.regexp_eatFixedHexDigits=function(i,t){var e=i.pos;i.lastIntValue=0;for(var s=0;s<t;++s){var n=i.current();if(!n3(n))return i.pos=e,!1;i.lastIntValue=16*i.lastIntValue+r3(n),i.advance()}return!0};var T1=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new pp(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Bt=Ye.prototype;Bt.next=function(i){!i&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new T1(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};Bt.getToken=function(){return this.next(),new T1(this)};typeof Symbol<"u"&&(Bt[Symbol.iterator]=function(){var i=this;return{next:function(){var t=i.getToken();return{done:t.type===w.eof,value:t}}}});Bt.nextToken=function(){var i=this.curContext();if((!i||!i.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(w.eof);if(i.override)return i.override(this);this.readToken(this.fullCharCodeAtPos())};Bt.readToken=function(i){return wn(i,this.options.ecmaVersion>=6)||i===92?this.readWord():this.getTokenFromCode(i)};Bt.fullCharCodeAtPos=function(){var i=this.input.charCodeAt(this.pos);if(i<=55295||i>=56320)return i;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?i:(i<<10)+t-56613888};Bt.skipBlockComment=function(){var i=this.options.onComment&&this.curPosition(),t=this.pos,e=this.input.indexOf("*/",this.pos+=2);if(e===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=e+2,this.options.locations)for(var s=void 0,n=t;(s=MC(this.input,n,this.pos))>-1;)++this.curLine,n=this.lineStart=s;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,e),t,this.pos,i,this.curPosition())};Bt.skipLineComment=function(i){for(var t=this.pos,e=this.options.onComment&&this.curPosition(),s=this.input.charCodeAt(this.pos+=i);this.pos<this.input.length&&!hl(s);)s=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+i,this.pos),t,this.pos,e,this.curPosition())};Bt.skipSpace=function(){t:for(;this.pos<this.input.length;){var i=this.input.charCodeAt(this.pos);switch(i){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(i>8&&i<14||i>=5760&&EC.test(String.fromCharCode(i)))++this.pos;else break t}}};Bt.finishToken=function(i,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var e=this.type;this.type=i,this.value=t,this.updateContext(e)};Bt.readToken_dot=function(){var i=this.input.charCodeAt(this.pos+1);if(i>=48&&i<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&i===46&&t===46?(this.pos+=3,this.finishToken(w.ellipsis)):(++this.pos,this.finishToken(w.dot))};Bt.readToken_slash=function(){var i=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):i===61?this.finishOp(w.assign,2):this.finishOp(w.slash,1)};Bt.readToken_mult_modulo_exp=function(i){var t=this.input.charCodeAt(this.pos+1),e=1,s=i===42?w.star:w.modulo;return this.options.ecmaVersion>=7&&i===42&&t===42&&(++e,s=w.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(w.assign,e+1):this.finishOp(s,e)};Bt.readToken_pipe_amp=function(i){var t=this.input.charCodeAt(this.pos+1);if(t===i){if(this.options.ecmaVersion>=12){var e=this.input.charCodeAt(this.pos+2);if(e===61)return this.finishOp(w.assign,3)}return this.finishOp(i===124?w.logicalOR:w.logicalAND,2)}return t===61?this.finishOp(w.assign,2):this.finishOp(i===124?w.bitwiseOR:w.bitwiseAND,1)};Bt.readToken_caret=function(){var i=this.input.charCodeAt(this.pos+1);return i===61?this.finishOp(w.assign,2):this.finishOp(w.bitwiseXOR,1)};Bt.readToken_plus_min=function(i){var t=this.input.charCodeAt(this.pos+1);return t===i?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Ui.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(w.incDec,2):t===61?this.finishOp(w.assign,2):this.finishOp(w.plusMin,1)};Bt.readToken_lt_gt=function(i){var t=this.input.charCodeAt(this.pos+1),e=1;return t===i?(e=i===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+e)===61?this.finishOp(w.assign,e+1):this.finishOp(w.bitShift,e)):t===33&&i===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(e=2),this.finishOp(w.relational,e))};Bt.readToken_eq_excl=function(i){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(w.equality,this.input.charCodeAt(this.pos+2)===61?3:2):i===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(w.arrow)):this.finishOp(i===61?w.eq:w.prefix,1)};Bt.readToken_question=function(){var i=this.options.ecmaVersion;if(i>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var e=this.input.charCodeAt(this.pos+2);if(e<48||e>57)return this.finishOp(w.questionDot,2)}if(t===63){if(i>=12){var s=this.input.charCodeAt(this.pos+2);if(s===61)return this.finishOp(w.assign,3)}return this.finishOp(w.coalesce,2)}}return this.finishOp(w.question,1)};Bt.readToken_numberSign=function(){var i=this.options.ecmaVersion,t=35;if(i>=13&&(++this.pos,t=this.fullCharCodeAtPos(),wn(t,!0)||t===92))return this.finishToken(w.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+ir(t)+"'")};Bt.getTokenFromCode=function(i){switch(i){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(w.parenL);case 41:return++this.pos,this.finishToken(w.parenR);case 59:return++this.pos,this.finishToken(w.semi);case 44:return++this.pos,this.finishToken(w.comma);case 91:return++this.pos,this.finishToken(w.bracketL);case 93:return++this.pos,this.finishToken(w.bracketR);case 123:return++this.pos,this.finishToken(w.braceL);case 125:return++this.pos,this.finishToken(w.braceR);case 58:return++this.pos,this.finishToken(w.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(w.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(i);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(i);case 124:case 38:return this.readToken_pipe_amp(i);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(i);case 60:case 62:return this.readToken_lt_gt(i);case 61:case 33:return this.readToken_eq_excl(i);case 63:return this.readToken_question();case 126:return this.finishOp(w.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+ir(i)+"'")};Bt.finishOp=function(i,t){var e=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(i,e)};Bt.readRegexp=function(){for(var i,t,e=this.pos;;){this.pos>=this.input.length&&this.raise(e,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(Ui.test(s)&&this.raise(e,"Unterminated regular expression"),i)i=!1;else{if(s==="[")t=!0;else if(s==="]"&&t)t=!1;else if(s==="/"&&!t)break;i=s==="\\"}++this.pos}var n=this.input.slice(e,this.pos);++this.pos;var r=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(r);var a=this.regexpState||(this.regexpState=new Rn(this));a.reset(e,n,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(n,o)}catch{}return this.finishToken(w.regexp,{pattern:n,flags:o,value:l})};Bt.readInt=function(i,t,e){for(var s=this.options.ecmaVersion>=12&&t===void 0,n=e&&this.input.charCodeAt(this.pos)===48,r=this.pos,o=0,a=0,l=0,c=t??1/0;l<c;++l,++this.pos){var h=this.input.charCodeAt(this.pos),u=void 0;if(s&&h===95){n&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),a===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=h;continue}if(h>=97?u=h-97+10:h>=65?u=h-65+10:h>=48&&h<=57?u=h-48:u=1/0,u>=i)break;a=h,o=o*i+u}return s&&a===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===r||t!=null&&this.pos-r!==t?null:o};function FW(i,t){return t?parseInt(i,8):parseFloat(i.replace(/_/g,""))}function a3(i){return typeof BigInt!="function"?null:BigInt(i.replace(/_/g,""))}Bt.readRadixNumber=function(i){var t=this.pos;this.pos+=2;var e=this.readInt(i);return e==null&&this.raise(this.start+2,"Expected number in radix "+i),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(e=a3(this.input.slice(t,this.pos)),++this.pos):wn(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,e)};Bt.readNumber=function(i){var t=this.pos;!i&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var e=this.pos-t>=2&&this.input.charCodeAt(t)===48;e&&this.strict&&this.raise(t,"Invalid number");var s=this.input.charCodeAt(this.pos);if(!e&&!i&&this.options.ecmaVersion>=11&&s===110){var n=a3(this.input.slice(t,this.pos));return++this.pos,wn(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,n)}e&&/[89]/.test(this.input.slice(t,this.pos))&&(e=!1),s===46&&!e&&(++this.pos,this.readInt(10),s=this.input.charCodeAt(this.pos)),(s===69||s===101)&&!e&&(s=this.input.charCodeAt(++this.pos),(s===43||s===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),wn(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var r=FW(this.input.slice(t,this.pos),e);return this.finishToken(w.num,r)};Bt.readCodePoint=function(){var i=this.input.charCodeAt(this.pos),t;if(i===123){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t};Bt.readString=function(i){for(var t="",e=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var s=this.input.charCodeAt(this.pos);if(s===i)break;s===92?(t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!1),e=this.pos):s===8232||s===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(hl(s)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(e,this.pos++),this.finishToken(w.string,t)};var l3={};Bt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(i){if(i===l3)this.readInvalidTemplateToken();else throw i}this.inTemplateElement=!1};Bt.invalidStringToken=function(i,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw l3;this.raise(i,t)};Bt.readTmplToken=function(){for(var i="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var e=this.input.charCodeAt(this.pos);if(e===96||e===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===w.template||this.type===w.invalidTemplate)?e===36?(this.pos+=2,this.finishToken(w.dollarBraceL)):(++this.pos,this.finishToken(w.backQuote)):(i+=this.input.slice(t,this.pos),this.finishToken(w.template,i));if(e===92)i+=this.input.slice(t,this.pos),i+=this.readEscapedChar(!0),t=this.pos;else if(hl(e)){switch(i+=this.input.slice(t,this.pos),++this.pos,e){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:i+=`
`;break;default:i+=String.fromCharCode(e);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};Bt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(w.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};Bt.readEscapedChar=function(i){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return ir(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),i){var e=this.pos-1;this.invalidStringToken(e,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],n=parseInt(s,8);return n>255&&(s=s.slice(0,-1),n=parseInt(s,8)),this.pos+=s.length-1,t=this.input.charCodeAt(this.pos),(s!=="0"||t===56||t===57)&&(this.strict||i)&&this.invalidStringToken(this.pos-1-s.length,i?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(n)}return hl(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};Bt.readHexChar=function(i){var t=this.pos,e=this.readInt(16,i);return e===null&&this.invalidStringToken(t,"Bad character escape sequence"),e};Bt.readWord1=function(){this.containsEsc=!1;for(var i="",t=!0,e=this.pos,s=this.options.ecmaVersion>=6;this.pos<this.input.length;){var n=this.fullCharCodeAtPos();if(Hr(n,s))this.pos+=n<=65535?1:2;else if(n===92){this.containsEsc=!0,i+=this.input.slice(e,this.pos);var r=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?wn:Hr)(o,s)||this.invalidStringToken(r,"Invalid Unicode escape"),i+=ir(o),e=this.pos}else break;t=!1}return i+this.input.slice(e,this.pos)};Bt.readWord=function(){var i=this.readWord1(),t=w.name;return this.keywords.test(i)&&(t=_1[i]),this.finishToken(t,i)};var WW="8.15.0";Ye.acorn={Parser:Ye,version:WW,defaultOptions:y0,Position:Yc,SourceLocation:pp,getLineInfo:QC,Node:yp,TokenType:qt,tokTypes:w,keywordTypes:_1,TokContext:Ms,tokContexts:Se,isIdentifierChar:Hr,isIdentifierStart:wn,Token:T1,isNewLine:hl,lineBreak:Ui,lineBreakG:uW,nonASCIIwhitespace:EC};function qW(i,t,e,s,n){e||(e=at),(function r(o,a,l){var c=l||o.type;e[c](o,a,r),t[c]&&t[c](o,a)})(i,s,n)}function P1(i,t,e){e(i,t)}function Yo(i,t,e){}var at={};at.Program=at.BlockStatement=at.StaticBlock=function(i,t,e){for(var s=0,n=i.body;s<n.length;s+=1){var r=n[s];e(r,t,"Statement")}};at.Statement=P1;at.EmptyStatement=Yo;at.ExpressionStatement=at.ParenthesizedExpression=at.ChainExpression=function(i,t,e){return e(i.expression,t,"Expression")};at.IfStatement=function(i,t,e){e(i.test,t,"Expression"),e(i.consequent,t,"Statement"),i.alternate&&e(i.alternate,t,"Statement")};at.LabeledStatement=function(i,t,e){return e(i.body,t,"Statement")};at.BreakStatement=at.ContinueStatement=Yo;at.WithStatement=function(i,t,e){e(i.object,t,"Expression"),e(i.body,t,"Statement")};at.SwitchStatement=function(i,t,e){e(i.discriminant,t,"Expression");for(var s=0,n=i.cases;s<n.length;s+=1){var r=n[s];e(r,t)}};at.SwitchCase=function(i,t,e){i.test&&e(i.test,t,"Expression");for(var s=0,n=i.consequent;s<n.length;s+=1){var r=n[s];e(r,t,"Statement")}};at.ReturnStatement=at.YieldExpression=at.AwaitExpression=function(i,t,e){i.argument&&e(i.argument,t,"Expression")};at.ThrowStatement=at.SpreadElement=function(i,t,e){return e(i.argument,t,"Expression")};at.TryStatement=function(i,t,e){e(i.block,t,"Statement"),i.handler&&e(i.handler,t),i.finalizer&&e(i.finalizer,t,"Statement")};at.CatchClause=function(i,t,e){i.param&&e(i.param,t,"Pattern"),e(i.body,t,"Statement")};at.WhileStatement=at.DoWhileStatement=function(i,t,e){e(i.test,t,"Expression"),e(i.body,t,"Statement")};at.ForStatement=function(i,t,e){i.init&&e(i.init,t,"ForInit"),i.test&&e(i.test,t,"Expression"),i.update&&e(i.update,t,"Expression"),e(i.body,t,"Statement")};at.ForInStatement=at.ForOfStatement=function(i,t,e){e(i.left,t,"ForInit"),e(i.right,t,"Expression"),e(i.body,t,"Statement")};at.ForInit=function(i,t,e){i.type==="VariableDeclaration"?e(i,t):e(i,t,"Expression")};at.DebuggerStatement=Yo;at.FunctionDeclaration=function(i,t,e){return e(i,t,"Function")};at.VariableDeclaration=function(i,t,e){for(var s=0,n=i.declarations;s<n.length;s+=1){var r=n[s];e(r,t)}};at.VariableDeclarator=function(i,t,e){e(i.id,t,"Pattern"),i.init&&e(i.init,t,"Expression")};at.Function=function(i,t,e){i.id&&e(i.id,t,"Pattern");for(var s=0,n=i.params;s<n.length;s+=1){var r=n[s];e(r,t,"Pattern")}e(i.body,t,i.expression?"Expression":"Statement")};at.Pattern=function(i,t,e){i.type==="Identifier"?e(i,t,"VariablePattern"):i.type==="MemberExpression"?e(i,t,"MemberPattern"):e(i,t)};at.VariablePattern=Yo;at.MemberPattern=P1;at.RestElement=function(i,t,e){return e(i.argument,t,"Pattern")};at.ArrayPattern=function(i,t,e){for(var s=0,n=i.elements;s<n.length;s+=1){var r=n[s];r&&e(r,t,"Pattern")}};at.ObjectPattern=function(i,t,e){for(var s=0,n=i.properties;s<n.length;s+=1){var r=n[s];r.type==="Property"?(r.computed&&e(r.key,t,"Expression"),e(r.value,t,"Pattern")):r.type==="RestElement"&&e(r.argument,t,"Pattern")}};at.Expression=P1;at.ThisExpression=at.Super=at.MetaProperty=Yo;at.ArrayExpression=function(i,t,e){for(var s=0,n=i.elements;s<n.length;s+=1){var r=n[s];r&&e(r,t,"Expression")}};at.ObjectExpression=function(i,t,e){for(var s=0,n=i.properties;s<n.length;s+=1){var r=n[s];e(r,t)}};at.FunctionExpression=at.ArrowFunctionExpression=at.FunctionDeclaration;at.SequenceExpression=function(i,t,e){for(var s=0,n=i.expressions;s<n.length;s+=1){var r=n[s];e(r,t,"Expression")}};at.TemplateLiteral=function(i,t,e){for(var s=0,n=i.quasis;s<n.length;s+=1){var r=n[s];e(r,t)}for(var o=0,a=i.expressions;o<a.length;o+=1){var l=a[o];e(l,t,"Expression")}};at.TemplateElement=Yo;at.UnaryExpression=at.UpdateExpression=function(i,t,e){e(i.argument,t,"Expression")};at.BinaryExpression=at.LogicalExpression=function(i,t,e){e(i.left,t,"Expression"),e(i.right,t,"Expression")};at.AssignmentExpression=at.AssignmentPattern=function(i,t,e){e(i.left,t,"Pattern"),e(i.right,t,"Expression")};at.ConditionalExpression=function(i,t,e){e(i.test,t,"Expression"),e(i.consequent,t,"Expression"),e(i.alternate,t,"Expression")};at.NewExpression=at.CallExpression=function(i,t,e){if(e(i.callee,t,"Expression"),i.arguments)for(var s=0,n=i.arguments;s<n.length;s+=1){var r=n[s];e(r,t,"Expression")}};at.MemberExpression=function(i,t,e){e(i.object,t,"Expression"),i.computed&&e(i.property,t,"Expression")};at.ExportNamedDeclaration=at.ExportDefaultDeclaration=function(i,t,e){i.declaration&&e(i.declaration,t,i.type==="ExportNamedDeclaration"||i.declaration.id?"Statement":"Expression"),i.source&&e(i.source,t,"Expression")};at.ExportAllDeclaration=function(i,t,e){i.exported&&e(i.exported,t),e(i.source,t,"Expression")};at.ImportDeclaration=function(i,t,e){for(var s=0,n=i.specifiers;s<n.length;s+=1){var r=n[s];e(r,t)}e(i.source,t,"Expression")};at.ImportExpression=function(i,t,e){e(i.source,t,"Expression")};at.ImportSpecifier=at.ImportDefaultSpecifier=at.ImportNamespaceSpecifier=at.Identifier=at.PrivateIdentifier=at.Literal=Yo;at.TaggedTemplateExpression=function(i,t,e){e(i.tag,t,"Expression"),e(i.quasi,t,"Expression")};at.ClassDeclaration=at.ClassExpression=function(i,t,e){return e(i,t,"Class")};at.Class=function(i,t,e){i.id&&e(i.id,t,"Pattern"),i.superClass&&e(i.superClass,t,"Expression"),e(i.body,t)};at.ClassBody=function(i,t,e){for(var s=0,n=i.body;s<n.length;s+=1){var r=n[s];e(r,t)}};at.MethodDefinition=at.PropertyDefinition=at.Property=function(i,t,e){i.computed&&e(i.key,t,"Expression"),i.value&&e(i.value,t,"Expression")};const XW=512,zW=20;function jW(i,t){return i.slice(0,XW).map((s,n)=>{const r=Math.max(0,Math.min(127,Math.round(s.pitch??60))),o=Math.max(0,s.position??0),a=1/t.subdivision,l=Math.max(a,s.duration??.25),c=Math.max(0,Math.min(127,s.velocity??100)),h=Math.max(a,t.maxLength-o);return{id:s.id||`note-${Date.now()}-${n}`,pitch:r,position:o,duration:Math.min(l,h),velocity:c}})}function GW(i,t){const e=t.map(n=>({name:n}));let s;for(const n of i)if(n.type==="Block"&&n.value.trim().startsWith("*")){const r=n.value.split(`
`).map(o=>o.trim());for(const o of r){const a=o.replace(/^\*\s*/,"").trim();if(a&&!a.startsWith("@")){s=a;break}}for(const o of r){const a=o.match(/@param\s*\{[^}]+\}\s*(\w+)\s*-?\s*(.*)/);if(a){const[,l,c]=a,h=e.find(u=>u.name===l);h&&c&&(h.description=c.trim())}}for(const o of e)if(o.name!=="notes"&&!o.description){for(const a of r)if(a.includes(o.name)&&!a.startsWith("function")){o.description=a.replace(/^\*\s*/,"").replace(/@param.*/,"").trim();break}}break}return{params:e,summary:s}}function YW(i){const t=[],e=[];try{const s=Ye.parse(i,{ecmaVersion:"latest",locations:!0,onComment:(d,p,g,m)=>{e.push({type:d?"Block":"Line",value:p,start:g,end:m})}});let n=null,r,o=[],a=null;if(qW(s,{FunctionDeclaration(d){if(d.id&&!n){n=d,r=d.id.name,o=d.params.map(p=>p.name);for(const p of e)p.end<d.start&&(a=p)}},VariableDeclarator(d){if(d.id&&!n&&d.init&&(d.init.type==="FunctionExpression"||d.init.type==="ArrowFunctionExpression")){n=d.init,r=d.id.name,o=d.init.params.map(g=>g.name);const p=d.start;for(const g of e)g.end<p&&(a=g)}}}),!n)return t.push("No function found. Please define a function with notes as the first parameter."),{valid:!1,errors:t};if(o.length===0)return t.push("Transform function must have at least one parameter (notes)"),{valid:!1,errors:t};if(o[0]!=="notes")return t.push('First parameter must be named "notes"'),{valid:!1,errors:t};if(!a||a.type!=="Block"||!a.value.trim().startsWith("*"))return t.push("Transform function must have a JSDoc comment"),{valid:!1,errors:t};const{params:l,summary:c}=GW([a],o);for(let d=1;d<o.length;d++){const p=o[d];a.value.includes(p)||t.push(`Parameter "${p}" is not documented in JSDoc`)}if(t.length>0)return{valid:!1,errors:t};const u=new Function(`"use strict";
`+i+`
if (typeof ${r} !== "function") throw new Error("${r} is not defined");
return ${r};`)(),f=u([]);return Array.isArray(f)?{valid:!0,errors:[],functionName:r,params:l,jsdocSummary:c,compiled:u}:(t.push("Function must return an array"),{valid:!1,errors:t})}catch(s){return t.push(`Parse error: ${s.message}`),{valid:!1,errors:t}}}function UW(i){const{getNotes:t,setNotes:e,getGrid:s,getTargetRollId:n,setTargetRollId:r}=i,o=Mo(Array.from({length:8},(v,y)=>({code:"",isValid:!1,name:`Slot ${y+1}`,params:[],errors:[],compiled:void 0,jsdocSummary:void 0}))),a=Xt([]),l=Xt([]);function c(v,y){if(v<0||v>=8)return;const _=o[v];_.code=y,_.isValid=!1,_.errors=[],_.compiled=void 0,_.params=[],_.jsdocSummary=void 0}function h(v){if(v<0||v>=8)return{valid:!1,errors:["Invalid slot index"]};const y=o[v],_=YW(y.code);return y.isValid=_.valid,y.errors=_.errors,_.valid&&_.compiled&&(y.compiled=_.compiled,y.functionName=_.functionName,y.params=_.params||[],y.jsdocSummary=_.jsdocSummary),_}function u(v,y){if(v<0||v>=8)return{status:"error",count:0,error:"Invalid slot index"};const _=o[v];if(!_.isValid||!_.compiled)return{status:"error",count:0,error:"Slot not validated"};try{const S=t();a.value.push(S),a.value.length>zW&&a.value.shift(),l.value=[];const k=_.compiled(S,...y),A=jW(k,s());return e(A),{status:"ok",count:A.length}}catch(S){return{status:"error",count:0,error:S.message}}}function f(){if(a.value.length===0)return;const v=t(),y=a.value.pop();l.value.push(v),e(y)}function d(){if(l.value.length===0)return;const v=t(),y=l.value.pop();a.value.push(v),e(y)}function p(){const v=[];for(let y=0;y<o.length;y++){const _=o[y];if(!_.isValid)continue;const S={},k=[];for(const A of _.params)A.name!=="notes"&&(S[A.name]={type:"number",description:A.description||`Parameter ${A.name}`},k.push(A.name));S.rollId={type:"string",description:"Optional roll ID to target. If omitted, uses the currently selected roll."},v.push({name:`transform_slot_${y+1}`,description:_.jsdocSummary||`User-defined transform in ${_.name}`,input_schema:{type:"object",properties:S,required:k}})}return v}function g(){const v=new Map;for(let y=0;y<o.length;y++){const _=o[y];if(!_.isValid)continue;const S=`transform_slot_${y+1}`;v.set(S,async k=>{let A;k.rollId&&r&&n&&(A=n(),r(k.rollId));try{const M=_.params.filter($=>$.name!=="notes").map($=>k[$.name]||0),R=u(y,M),C=s();return{status:R.status,count:R.count,error:R.error,grid:C,rollId:k.rollId}}finally{A!==void 0&&r&&r(A)}})}return v}function m(v,y){return c(v,y),h(v)}function O(){if(o.filter(_=>_.isValid).length===0)return"No transform tools currently available.";const y=[];for(let _=0;_<o.length;_++){const S=o[_];if(!S.isValid)continue;const k=`transform_slot_${_+1}`,A=S.functionName||"unnamed",M=S.jsdocSummary||"User-defined transform",R=S.params.filter(C=>C.name!=="notes").map(C=>`${C.name}${C.description?` (${C.description})`:""}`).join(", ");y.push(`- ${k} (${A}): ${M}${R?` | Params: ${R}`:""}`)}return y.join(`
`)}function b(){return a.value.length>0}function x(){return l.value.length>0}return{slots:o,setCode:c,validateSlot:h,applyTransform:u,undo:f,redo:d,canUndo:b,canRedo:x,getToolDefs:p,getToolHandlers:g,writeTransformFunction:m,summarizeTransforms:O}}const HW={class:"multi-piano-roll-demo"},KW={class:"previews-section"},JW={class:"preview-grid"},tq={class:"editor-section"},eq={key:0},iq={class:"tools-section"},sq={class:"tools-grid"},nq={class:"tool-panel chatbot-panel"},rq={class:"tool-panel workbench-panel"},oq=Vo({__name:"MultiPianoRollDemo",setup(i){const t=Xt(null),e=Xt([{id:"e1",pitch:60,position:0,duration:1,velocity:100},{id:"e2",pitch:64,position:1,duration:1,velocity:100},{id:"e3",pitch:67,position:2,duration:1,velocity:100}]),s=Mo([{id:"preview-1",includeInQueue:!0,notes:[{id:"p1-1",pitch:60,position:0,duration:1,velocity:110},{id:"p1-2",pitch:64,position:0,duration:1,velocity:105},{id:"p1-3",pitch:67,position:0,duration:1,velocity:108}]},{id:"preview-2",includeInQueue:!0,notes:[{id:"p2-1",pitch:62,position:0,duration:.5,velocity:100},{id:"p2-2",pitch:65,position:.5,duration:.5,velocity:98},{id:"p2-3",pitch:69,position:1,duration:1,velocity:102}]},{id:"preview-3",includeInQueue:!1,notes:[{id:"p3-1",pitch:67,position:0,duration:1.5,velocity:105},{id:"p3-2",pitch:72,position:0,duration:1.5,velocity:100},{id:"p3-3",pitch:76,position:0,duration:1.5,velocity:103}]},{id:"preview-4",includeInQueue:!1,notes:[{id:"p4-1",pitch:55,position:0,duration:2,velocity:108},{id:"p4-2",pitch:59,position:0,duration:2,velocity:105},{id:"p4-3",pitch:62,position:0,duration:2,velocity:110}]}]),n=qR(),r=Xt(null),o=Xt("editor");let a=null;const l=Rs(()=>[{id:"editor",label:"Editor"},...s.map(x=>({id:x.id,label:x.id}))]);function c(x){if(x==="editor")return[...e.value];const v=s.find(y=>y.id===x);return v?[...v.notes]:[]}function h(x,v){if(x==="editor"){if(e.value=v.map(_=>({..._})),t.value?.setNotes(e.value),r.value){const _=s.find(S=>S.id===r.value);_&&(_.notes=v.map(S=>({...S})))}return}const y=s.find(_=>_.id===x);y&&(y.notes=v.map(_=>({..._})),r.value===x&&(e.value=v.map(_=>({..._})),t.value?.setNotes(e.value)))}function u(x){return{maxLength:16,timeSignature:4,subdivision:16}}const f=UW({getNotes:()=>c(o.value),setNotes:x=>h(o.value,x),getGrid:()=>u(o.value),getTargetRollId:()=>o.value,setTargetRollId:x=>{o.value=x}}),d=x=>{if(!r.value)return;const v=Array.from(x.notes.values()).map(_=>({id:_.id,pitch:_.pitch,position:_.position,duration:_.duration,velocity:_.velocity})).sort((_,S)=>_.position-S.position);e.value=v;const y=s.find(_=>_.id===r.value);y&&(y.notes=v.map(_=>({..._}))),n.stop()},p=x=>{n.stop(),r.value=x;const v=s.find(_=>_.id===x);if(!v)return;const y=v.notes.map(_=>({..._}));e.value=y,t.value?.setNotes(y),t.value?.fitZoomToNotes(!0)},g=()=>{n.stop(),r.value=null},m=x=>{r.value===x?g():p(x)},O=async()=>{await Hg();const x=s.filter(v=>v.includeInQueue).map(v=>v.id);x.length!==0&&n.playQueue(x)},b=()=>{n.stop()};return Jc(()=>{ai.loop=!1,ai.bpm.value=120,Sd(()=>{t.value&&(a=n.registerRoll({id:"editor",getNotes:()=>[...e.value],getQueueStart:()=>t.value?.getPlayStartPosition()??0,setLivePlayhead:x=>t.value?.setLivePlayheadPosition(x),getGrid:()=>({maxLength:16,timeSignature:4,subdivision:16})}),t.value.setNotes(e.value),t.value.fitZoomToNotes(!0))})}),$0(()=>{a?.(),n.dispose()}),(x,v)=>(Tt(),Rt("div",HW,[X("section",{class:"controls-section"},[X("div",{class:"editor-controls"},[X("button",{onClick:O,class:"play-all-btn"}," Play Queue"),X("button",{onClick:b,class:"stop-all-btn"}," Stop All")])]),X("section",KW,[v[1]||(v[1]=X("h2",null,"Previews",-1)),X("div",JW,[(Tt(!0),Rt(ii,null,Cr(s,y=>(Tt(),Vx(WR,{key:y.id,id:y.id,notes:y.notes,width:300,height:170,interactive:!1,coordinator:Te(n),"include-in-queue":y.includeInQueue,"onUpdate:includeInQueue":_=>y.includeInQueue=_,"is-editing":r.value===y.id,onEdit:_=>m(y.id)},null,8,["id","notes","coordinator","include-in-queue","onUpdate:includeInQueue","is-editing","onEdit"]))),128))])]),Ar(X("section",tq,[X("h2",null,[v[2]||(v[2]=Fi("Editor ",-1)),r.value?(Tt(),Rt("small",eq," Editing: "+Ie(r.value),1)):Ae("",!0)]),Ne(DS,{ref_key:"editorRef",ref:t,width:600,height:340,"show-control-panel":!0,interactive:!0,"sync-state":d},null,512)],512),[[c4,r.value]]),X("section",iq,[X("div",sq,[X("div",nq,[Ne(oI,{"list-rolls":()=>l.value,"get-notes-by-roll":c,"set-notes-by-roll":h,"get-grid-by-roll":u,"get-selected-roll-id":()=>o.value,registry:Te(f)},null,8,["list-rolls","get-selected-roll-id","registry"])]),X("div",rq,[Ne(nW,{registry:Te(f),"roll-options":l.value,"target-roll-id":o.value,"onUpdate:targetRollId":v[0]||(v[0]=y=>o.value=y)},null,8,["registry","roll-options","target-roll-id"])])])])]))}}),aq=rl(oq,[["__scopeId","data-v-76f3c2b4"]]),lq={class:"page"},cq=Vo({__name:"App",setup(i){return(t,e)=>(Tt(),Rt("main",lq,[e[0]||(e[0]=X("h1",null,"LLM MIDI Mangler",-1)),e[1]||(e[1]=X("div",{class:"description"},[X("p",null,[Fi(" This is an LLM powered MIDI mangling workbench. A central piano roll lets you manually write out MIDI, and it is played back using "),X("a",{href:"https://tonejs.github.io/",target:"_blank",rel:"noreferrer"},"Tone.js"),Fi(". A chatbot powered by Claude Sonnet can read and write from the piano roll with tool calls. Additionally, there is a workbench at the bottom of the page that lets you define custom functions for transforming the piano roll. The chatbot can write new functions into specific slots, or can even call your functions as tools (instead of generating raw MIDI as an LLM response). You can also manually apply your transformation functions with the controls under the text editor. "),X("br"),X("br"),Fi(" The source code for this is on "),X("a",{href:"https://github.com/AvneeshSarwate/pianoRollChatbot",target:"_blank",rel:"noreferrer"},"GitHub"),Fi(". ")])],-1)),Ne(aq)]))}}),hq=rl(cq,[["__scopeId","data-v-8d9f596e"]]);E4(hq).mount("#app");
